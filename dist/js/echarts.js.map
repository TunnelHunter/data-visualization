{"version":3,"sources":["echarts.js"],"names":["global","factory","exports","module","define","amd","echarts","this","detect","ua","os","browser","firefox","match","ie","edge","weChat","test","version","node","canvasSupported","document","createElement","getContext","svgSupported","SVGRect","touchEventsSupported","window","pointerEventsSupported","$override","name","fn","_ctx","methods","clone","source","result","typeStr","objToString","call","isPrimitive","i","len","length","TYPED_ARRAY","Ctor","constructor","from","BUILTIN_OBJECT","isDom","key","hasOwnProperty","merge","target","overwrite","isObject$1","targetProp","sourceProp","isArray","isBuiltInObject","mergeAll","targetAndSources","extend","defaults","overlay","createCanvas","indexOf","array","value","inherits","clazz","baseClazz","F","clazzPrototype","prototype","prop","superClass","mixin","isArrayLike","data","each$1","obj","cb","context","forEach","nativeForEach","map","nativeMap","push","reduce","memo","nativeReduce","filter","nativeFilter","find","bind","func","args","nativeSlice","arguments","apply","concat","curry","isFunction$1","isString","type","isTypedArray","nodeType","ownerDocument","eqNaN","retrieve","values","retrieve2","value0","value1","retrieve3","value2","slice","Function","normalizeCssArray","val","assert$1","condition","message","Error","trim","str","replace","setAsPrimitive","primitiveKey","HashMap","visit","isArr","thisMap","set","each","createHashMap","concatArray","a","b","newArray","offset","noop","create","x","y","out","ArrayCtor","copy","v","clone$1","add","v1","v2","scaleAndAdd","sub","Math","sqrt","lenSquare","mul","div","dot","scale","s","normalize","d","distance","distanceSquare","negate","lerp","t","applyTransform","m","min","max","Draggable","on","_dragStart","_drag","_dragEnd","param","e","topTarget","makeEventPacket","eveType","targetInfo","event","cancelBubble","offsetX","zrX","offsetY","zrY","gestureEvent","pinchX","pinchY","pinchScale","wheelDelta","zrDelta","zrByTouch","which","EmptyProxy","isHover","displayable","rectHover","isSilent","el","clipPath","contain","silent","parent","SILENT","create$1","ArrayCtor$1","identity","copy$1","mul$1","m1","m2","out0","out1","out2","out3","out4","out5","translate","rotate","rad","aa","ac","atx","ab","ad","aty","st","sin","ct","cos","scale$1","vx","vy","invert","det","clone$2","isNotAroundZero","EPSILON","Clip","options","_target","_life","life","_delay","delay","_initialized","loop","gap","easing","onframe","ondestroy","onrestart","_pausedTime","_paused","clampCssByte","round","clampCssAngle","clampCssFloat","f","parseCssInt","charAt","parseFloat","parseInt","parseCssFloat","cssHueToRgb","h","lerpNumber","p","setRgba","r","g","copyRgba","putToCache","colorStr","rgbaArr","lastRemovedArr","colorCache","put","parse","cached","get","toLowerCase","kCSSColorTable","op","ep","fname","substr","params","split","alpha","pop","hsla2rgba","iv","hsla","rgba","l","rgba2hsla","H","S","R","G","B","vMin","vMax","delta","L","deltaR","deltaG","deltaB","lift","color","level","colorArr","stringify","toHex","toString","fastLerp","normalizedValue","colors","leftIndex","floor","rightIndex","ceil","leftColor","rightColor","dv","lerp$1","fullOutput","modifyHSL","modifyAlpha","arrColor","defaultGetter","defaultSetter","interpolateNumber","p0","p1","percent","interpolateString","interpolateArray","arrDim","len2","j","fillArr","arr0","arr1","arr0Len","arr1Len","isPreviousLarger","arraySlice","isNaN","isArraySame","catmullRomInterpolateArray","p2","p3","t2","t3","catmullRomInterpolate","v0","cloneValue","ret","rgba2String","join","getArrayDim","keyframes","lastValue","createTrackClip","animator","oneTrackDone","propName","forceAnimate","getter","_getter","setter","_setter","useSpline","trackLen","trackMaxTime","firstVal","isValueArray","isValueColor","isValueString","sort","time","kfPercents","kfValues","prevValue","isAllValueEqual","colorArray","start","w","lastFrame","lastFramePercent","frame","range","clip","_loop","BoundingRect","width","height","minRunLength","n","DEFAULT_MIN_MERGE","makeAscendingRun","lo","hi","compare","runHi","reverseRun","binaryInsertionSort","mid","pivot","left","right","gallopLeft","hint","lastOffset","maxOffset","tmp","gallopRight","TimSort","pushRun","_runStart","_runLength","runStart","stackSize","runLength","mergeRuns","mergeAt","forceMergeRuns","start1","length1","start2","length2","k","mergeLow","mergeHigh","cursor1","cursor2","dest","count1","count2","exit","_minGallop","minGallop","DEFAULT_MIN_GALLOPING","customCursor","customDest","remaining","ts","minRun","force","shapeCompareFunc","zlevel","z","z2","createLinearGradient","ctx","rect","x2","y2","canvasGradient","createRadialGradient","returnFalse","createDom","id","painter","dpr","newDom","getWidth","getHeight","newDomStyle","style","position","top","setAttribute","findExistImage","newImageOrSrc","cachedImgObj","globalImageCache","image","createOrUpdateImage","hostEl","cbPayload","__zrImageSrc","pendingWrap","isImageReady","pending","Image","onload","imageOnLoad","__cachedImgObj","src","dirty","$override$1","methods$1","text","font","DEFAULT_FONT","textWidthCache","textLines","measureText","textWidthCacheCounter","TEXT_CACHE_MAX","getBoundingRect","textAlign","textVerticalAlign","textPadding","rich","truncate","getRichTextRect","getPlainTextRect","contentBlock","parsePlainText","outerWidth","outerHeight","adjustTextX","adjustTextY","lineHeight","parseRichText","adjustTextPositionOnRect","textPosition","halfHeight","truncateText","containerWidth","ellipsis","prepareTruncateOptions","truncateSingleLine","maxIterations","minChar","cnCharWidth","ascCharWidth","placeholder","contentWidth","ellipsisWidth","textLine","lineWidth","subLength","estimateLength","charCode","charCodeAt","getLineHeight","padding","lines","truncOuterHeight","truncOuterWidth","lastIndex","STYLE_REG","exec","matchedIndex","index","pushTokens","substring","contentHeight","pendingList","stlPadding","truncateWidth","truncateHeight","line","tokens","token","tokenStyle","styleName","tokenHeight","textHeight","textLineHeight","textWidth","tokenWidth","tokenWidthNotSpecified","percentWidth","textBackgroundColor","bgImg","paddingW","remianTruncWidth","block","isEmptyStr","strs","isLineHolder","tokensLen","makeFont","fontSize","fontFamily","fontStyle","fontWeight","textFont","buildPath","shape","r1","r2","r3","r4","Array","total","moveTo","lineTo","arc","PI","normalizeTextStyle","normalizeStyle","VALID_TEXT_ALIGN","textBaseline","VALID_TEXT_VERTICAL_ALIGN","renderText","renderRichText","renderPlainText","setCtx","__textCotentBlock","__dirty","boxPos","getBoxPosition","baseX","baseY","applyTextRotation","boxY","textX","textY","needDrawBg","needDrawBackground","boxX","drawBackground","getTextXForPadding","textShadowBlur","textShadowColor","textShadowOffsetX","textShadowOffsetY","textStrokeWidth","textStroke","getStroke","textFill","getFill","strokeText","fillText","drawRichText","xLeft","lineTop","xRight","tokenCount","usedWidth","lineXLeft","lineXRight","placeToken","textRotation","origin","textOrigin","textBorderWidth","textBorderColor","isPlainBg","textBoxShadowBlur","textBoxShadowColor","textBoxShadowOffsetX","textBoxShadowOffsetY","beginPath","textBorderRadius","closePath","fill","onBgImageLoaded","drawImage","stroke","blockHeiht","parsePercent","res","textDistance","textOffset","fixShadow","colorStops","maxValue","lastIndexOf","needDrawText","Displayable","opts","Element","Style","_rect","__clipPaths","ZImage","parseInt10","isLayerValid","layer","__builtin__","isDisplayableCulled","tmpRect","transform","viewRect","intersect","isClipPathChanged","clipPaths","prevClipPaths","doClip","setTransform","restoreTransform","createRoot","domRoot","cssText","getBoundingClientRect","clientToLocal","calculate","env$1","defaultGetZrXY","layerX","layerY","box","clientX","clientY","normalizeEvent","eventType","isTouch","touch","targetTouches","changedTouches","detail","button","undefined","MOUSE_EVENT_REG","addEventListener","handler","isDomLevel2","attachEvent","removeEventListener","detachEvent","notLeftMouse","dist$1","pointPair","dx","dy","center","eventNameFix","processGesture","proxy","stage","gestureMgr","_gestureMgr","clear","gestureInfo","recognize","findHover","dom","dispatchToElement","setTouchTimer","instance","_touching","clearTimeout","_touchTimer","setTimeout","isPointerFromTouch","pointerType","initDomHandler","makeMouseHandler","touchHandlerNames","_handlers","domHandlers","pointerHandlerNames","mouseHandlerNames","HandlerDomProxy","mountHandlers","handlerNames","Eventful","GestureMgr","init$1","zr","ZRender","guid","instances$1","dispose$1","dispose","getInstance","registerPainter","painterCtors","delInstance","normalizeToArray","defaultEmphasis","opt","subOpts","emphasis","subOptName","getDataItemValue","dataItem","isObject$2","isArray$1","Date","isDataItemOption","mappingToExists","exists","newCptOptions","exist","each$2","cptOption","option","isIdInner","makeIdAndName","mapResult","idMap","item","existCpt","keyInfo","DUMMY_COMPONENT_NAME_PREFIX","idNum","isNameSpecified","componentModel","compressBatches","batchA","batchB","makeMap","sourceBatch","map$$1","otherMap","seriesId","dataIndices","dataIndex","otherDataIndices","lenj","mapToArray","isData","mapA","mapB","queryDataIndex","payload","dataIndexInside","indexOfRawIndex","indexOfName","makeInner","innerUniqueIndex","random","toFixed","hostObj","parseFinder","ecModel","finder","defaultMainType","has","parsedKey","mainType","queryType","includeMainTypes","queryParam","models","queryComponents","getAttribute","parseClassType$1","componentType","main","TYPE_DELIMITER","checkClassType","enableClassExtend","RootClass","mandatoryMethods","$constructor","proto","__DEV__","method","console","warn","ExtendedClass","superCall","superApply","enableClassCheck","Clz","classAttr","classBase","isInstance","methodName","enableClassManagement","entity","makeContainer","container","storage","IS_CONTAINER","registerClass","Clazz","getClass","componentMainType","subType","throwWhenNotFound","getClassesByMainType","o","hasClass","getAllClassMainTypes","types","hasSubTypes","parseClassType","registerWhenExtend","originalExtend","isAroundZero","EPSILON$1","isNotAroundZero$1","cubicAt","onet","cubicDerivativeAt","cubicRootAt","roots","c","A","C","t1","disc","K","discSqrt","mathSqrt$2","Y1","Y2","mathPow","ONE_THIRD","T","theta","acos","ASqrt","THREE_SQRT","cubicExtrema","extrema","cubicSubdivide","p01","p12","p23","p012","p123","p0123","cubicProjectPoint","x0","y0","x1","y1","x3","y3","prev","next","d1","d2","interval","Infinity","_v0","_t","_v1","distSquare","EPSILON_NUMERIC","_v2","quadraticAt","quadraticDerivativeAt","quadraticRootAt","quadraticExtremum","divider","quadraticSubdivide","quadraticProjectPoint","fromPoints","points","min$$1","max$$1","bottom","mathMin$3","mathMax$3","fromLine","fromCubic","cubicExtrema$$1","cubicAt$$1","xDim","yDim","fromQuadratic","quadraticExtremum$$1","quadraticAt$$1","tx","ty","fromArc","rx","ry","startAngle","endAngle","anticlockwise","vec2Min","vec2Max","diff","abs","PI2","mathCos$2","mathSin$2","end","angle","extremity","containStroke$1","_l","_a","_b","_s","containStroke$2","containStroke$3","normalizeRadian","PI2$3","containStroke$4","cx","cy","PI2$2","atan2","windingLine","dir","x_","isAroundEqual","EPSILON$2","swapExtrema","windingCubic","nRoots","y0_","y1_","nExtrema","unit","windingQuadratic","y_","windingArc","PI2$1","containPath","isStroke","xi","yi","cmd","CMD$1","M","Q","dTheta","_x","Z","pathData","containStroke","Path","path","processArc","fa","fs","psiDeg","psi","xp","mathCos","mathSin","yp","lambda","mathSqrt","cxp","cyp","vAngle","u","vRatio","addData","createPathProxyFromString","cs","cc","RegExp","prevCmd","arr","cpx","cpy","PathProxy","CMD","off","shift","ctlPtx","ctlPty","toStatic","createPathOptions","pathProxy","setData","rebuildPath","transformPath","createFromString","extendFromString","mergePath$1","pathEls","pathList","pathEl","createPathProxy","__dirtyPath","pathBundle","appendPath","interpolate","buildPath$1","smooth","controlPoints","smoothBezier","smoothConstraint","cp1","cp2","bezierCurveTo","smoothSpline","someVectorAt","isTangent","cpx2","cpy2","cpx1","cpy1","IncrementalDisplayble","_displayables","_temporaryDisplayables","_cursor","notClear","extendShape","extendPath","makePath","layout","boundingRect","centerGraphic","resizePath","makeImage","imageUrl","img","setStyle","aspect","pathRect","calculateTransform","subPixelOptimizeLine","subPixelOptimize","subPixelOptimizeRect","originX","originY","originWidth","originHeight","positiveOrNegative","doubledPosition","hasFillOrStroke","fillOrStroke","liftColor","cacheElementStl","__hoverStlDirty","hoverStyle","__hoverStl","normalStyle","__normalStl","doSingleEnterHover","__isHover","useHoverLayer","__zr","addHover","insideRollbackOpt","rollbackInsideStyle","extendFrom","applyInsideStyle","insideOriginalTextPosition","autoColor","doSingleLeaveHover","normalStl","removeHover","doEnterHover","traverse","child","doLeaveHover","setElementHoverStl","hoverStl","onElementMouseOver","__hoverSilentOnTouch","__isEmphasis","onElementMouseOut","enterEmphasis","leaveEmphasis","setHoverStyle","hoverSilentOnTouch","setLabelStyle","emphasisStyle","normalModel","emphasisModel","normalSpecified","emphasisSpecified","EMPTY_OBJ","baseText","labelFetcher","labelDataIndex","labelDimIndex","showNormal","getShallow","showEmphasis","getFormattedLabel","defaultText","normalStyleText","emphasisStyleText","setTextStyle","textStyle","textStyleModel","specifiedTextStyle","isEmphasis","setTextStyleCommon","host","setText","labelModel","defaultColor","isRectText","labelRotate","richResult","globalTextStyle","richItemNames","getRichItemNames","richTextStyle","getModel","setTokenTextStyle","forceRich","richItemNameMap","parentModel","isBlock","getAutoColor","originalTextPosition","insideRollback","textTag","disableBox","useInsideStyle","getFont","gTextStyleModel","animateOrSetProps","isUpdate","props","animatableModel","animationEnabled","isAnimationEnabled","postfix","duration","animationEasing","animationDelay","getAnimationDelayParams","animateTo","stopAnimation","attr","updateProps","initProps","getTransform","ancestor","mat","getLocalTransform","applyTransform$1","invert$$1","Transformable","transformDirection","direction","hBase","vBase","vertex","groupTransition","g1","g2","getElMap","elMap","isGroup","anid","getAnimatableProps","rotation","elMap1","oldEl","newProp","clipPointsByRect","point","mathMax$1","mathMin$1","clipRectByRect","targetRect","createIcon","iconStr","strokeNoScale","Model","doGet","pathArr","getParent","model","getParentMethod","inner","getUID","base","enableSubTypeDefaulter","subTypeDefaulters","registerSubTypeDefaulter","defaulter","determineSubType","componentTypeMain","enableTopologicalTravel","dependencyGetter","makeDepndencyGraph","fullNameList","graph","noEntryList","thisItem","createDependencyGraphItem","originalDeps","availableDeps","getAvailableDependencies","entryCount","dependentName","predecessor","thatItem","successor","dep","topologicalTravel","targetNameList","callback","removeEdge","succComponentType","stack","removeEdgeAndAdd","targetNameSet","currComponentType","currVertex","isInTargetNameSet","_trim","linearMap","domain","clamp","subDomain","subRange","parsePercent$1","all","NaN","round$1","precision","returnStr","asc","getPrecision","count","getPrecisionSafe","eIndex","dotIndex","getPixelPrecision","dataExtent","pixelExtent","log","LN10","dataQuantity","sizeQuantity","isFinite","getPercentWithPrecision","valueList","idx","sum","acc","digits","pow","votesPerQuota","targetSeats","seats","votes","currentSum","remainder","Number","NEGATIVE_INFINITY","maxId","remRadian","radian","pi2","isRadianAroundZero","RADIAN_EPSILON","parseDate","TIME_REG","hour","toUpperCase","UTC","quantity","quantityExponent","nice","nf","exponent","exp10","reformIntervals","list","littleThan","lg","close","curr","currClose","splice","isNumeric","addCommas","toCamelCase","upperCaseFirst","group1","encodeHTML","String","formatTpl","tpl","paramsList","encode","seriesLen","$vars","alias","TPL_VAR_ALIAS","wrapVar","seriesIdx","formatTplSimple","getTooltipMarker","extraCssText","pad","formatTime","isUTC","date","utc","capitalFirst","boxLayout","orient","group","maxWidth","maxHeight","currentLineMaxSize","eachChild","nextX","nextY","nextChild","childAt","nextChildRect","moveX","newline","moveY","getAvailableSize","positionInfo","containerRect","margin","containerHeight","normalizeCssArray$1","getLayoutRect","verticalMargin","horizontalMargin","positionElement","hv","boundingMode","needLocalTransform","elPos","sizeCalculable","hvIdx","HV_NAMES","mergeLayoutParam","targetOption","newOption","merge$$1","names","newParams","newValueCount","merged","mergedValueCount","enoughParamNumber","each$3","hasProp","hasValue","ignoreSize","hResult","vResult","getLayoutParams","copyLayoutParams","LOCATION_PARAMS","getDependencies","deps","ComponentModel","dependencies","unshift","getNearestColorPalette","requestColorNum","paletteNum","getCoordSysDefineBySeries","seriesModel","coordSysName","coordSysDims","axisMap","categoryAxisMap","fetch","fetchers","isCategory","axisModel","Source","fields","fromDataset","sourceFormat","SOURCE_FORMAT_KEYED_COLUMNS","SOURCE_FORMAT_UNKNOWN","seriesLayoutBy","SERIES_LAYOUT_BY_COLUMN","dimensionsDefine","encodeDefine","startIndex","dimensionsDetectCount","detectSourceFormat","datasetModel","SOURCE_FORMAT_TYPED_ARRAY","SOURCE_FORMAT_ARRAY_ROWS","SOURCE_FORMAT_OBJECT_ROWS","inner$3","getSource","resetSourceDefaulter","datasetMap","prepareSource","seriesOption","SOURCE_FORMAT_ORIGINAL","sourceHeader","dimensions","getDatasetModel","datasetOption","completeResult","completeBySourceData","makeDefaultEncode","normalizeDimensionsDefine","findPotentialName","arrayRowsTravelFirst","SERIES_LAYOUT_BY_ROW","objectRowsCollectDimensions","colArr","potentialNameDimIndex","dim","nameMap","displayName","maxLoop","firstIndex","coordSysDefine","encodeItemName","encodeSeriesName","seriesType","nSeriesMap","cSeriesMap","uid","datasetRecord","categoryWayDim","valueWayDim","coordDim","firstCategoryDimIndex","dataDim","firstNotOrdinal","doGuessOrdinal","nameDimIndex","itemName","seriesName","thisData","getComponent","datasetIndex","guessOrdinal","dimIndex","detectValue","dimName","sample","row","isNotTargetSeries","seiresIndex","componentIndex","mergeTheme","theme","notMergeColorLayer","colorLayer","themeItem","initBase","baseOption","OPTION_INNER_KEY","_componentsMap","series","_seriesIndices","_seriesIndicesMap","_theme","globalDefault","mergeOption","getComponentsByTypes","componentsMap","newCptOption","existComponent","createSeriesIndices","seriesModels","filterBySubType","components","cpt","assertSeriesInitialized","ExtensionAPI","chartInstance","echartsAPIList","CoordinateSystemManager","_coordinateSystems","OptionManager","api","_api","_timelineOptions","_mediaList","_mediaDefault","_currentMediaIndices","_optionBackup","_newBaseOption","parseRawOption","rawOption","optionPreprocessorFuncs","isNew","mediaDefault","timelineOptions","mediaList","timelineOpt","timeline","media","each$4","singleMedia","query","preProcess","applyMediaQuery","ecWidth","ecHeight","realMap","aspectratio","applicatable","matched","QUERY_REG","operator","realAttr","real","expect","indicesEquals","indices1","indices2","oldOption","newCptOpt","oldCptOpt","map$1","merge$1","compatEC2ItemStyle","itemStyleOpt","itemStyle","POSSIBLE_STYLES","normalItemStyleOpt","normal","emphasisItemStyleOpt","convertNormalEmphasis","optType","useExtend","normalOpt","emphasisOpt","removeEC3NormalStatus","compatTextStyle","labelOptSingle","isObject$3","TEXT_STYLE_OPTIONS","compatEC3CommonStyles","processSeries","seriesOpt","markPoint","markLine","markArea","nodes","edgeData","links","edges","categories","mpData","mlData","breadcrumb","levels","toArr","toObj","set$1","compatLayoutProperties","LAYOUT_PROPERTIES","calculateStack","stackInfoList","targetStackInfo","idxInStack","resultVal","resultNaN","dims","stackResultDimension","stackedOverDimension","targetData","isStackedByIndex","newData","stackedDimension","byValue","stackedDataRawIndex","getRawIndex","stackedByDimension","stackedOver","stackInfo","rawIndexOf","getByRawIndex","hostModel","DefaultDataProvider","dimSize","seriesDataToSource","_source","_data","_offset","_dimSize","providerMethods","countSimply","getItemSimply","appendDataSimply","getRawValueSimply","getDimValueSimply","converDataValue","_dimensionInfos","dimInfo","dimType","ordinalMeta","parseAndCollect","retrieveRawValue","getRawDataItem","getProvider","getDimensionInfo","rawValueGetters","retrieveRawAttr","createTask","Task","_reset","reset","_plan","plan","_count","_onDirty","onDirty","_dirty","taskIns","skip","_dueIndex","_outputDueEnd","_dueEnd","_settedOutputEnd","progress","forceFirstProgress","_progress","downstream","_downstream","autoSeriesName","getSeriesAutoName","getRawData","dataDims","mapDimension","nameArr","dataTaskCount","dataTaskReset","cloneShallow","dataTaskProgress","outputData","wrapData","CHANGABLE_METHODS","wrapMethod","onDataSelfChange","task","getCurrentTask","setOutputEnd","scheduler","pipeline","getPipeline","currentTask","agentStubMap","Chart","Group","renderTask","renderTaskPlan","renderTaskReset","view","elSetState","state","trigger","childCount","toggleHighlight","dataIdx","getItemGraphicEl","eachItemGraphicEl","renderPlanner","canProgressiveRender","pipelineContext","updateMethod","inner$5","progressMethodMap","throttle","debounce","lastExec","getTime","timer","scope","currCall","debounceNextCall","lastCall","thisDelay","thisDebounce","debounceDelay","createOrUpdate","fnAttr","rate","throttleType","originFn","ORIGIN_METHOD","lastThrottleType","THROTTLE_TYPE","lastRate","RATE","Scheduler","ecInstance","dataProcessorHandlers","visualHandlers","unfinished","_dataProcessorHandlers","_visualHandlers","_stageTaskMap","performStageTasks","stageHandlers","needSetDirty","setDirty","dirtyMap","__pipeline","stageHandler","visualType","stageHandlerRecord","seriesTaskMap","overallTask","overallNeedDirty","stub","updatePayload","performArgs","getPerformArgs","perform","pipelineId","performRawSeries","isSeriesFiltered","createSeriesStageTask","seriesTaskPlan","seriesTaskReset","seriesTaskCount","useClearVisual","isVisual","isLayout","pipe","getTargetSeries","createOnAllSeries","eachRawSeries","eachRawSeriesByType","pipelineMap","_pipelineMap","removeKey","createOverallStageTask","createStub","stubReset","stubOnDirty","overallProgress","isOverallFilter","agent","__block","overallTaskReset","overallReset","getSeries","upstreamContext","stubProgress","getDownstream","clearAllVisual","resetDefines","seriesTaskProgress","resetDefine","dataEach","head","tail","__idxInPipeline","detectSeriseType","legacyFunc","ecModelMock","apiMock","mockMethods","createRegisterEventWithLowercaseName","eventName","MessageCenter","ECharts","theme$$1","prioritySortFunc","__prio","themeStorage","_dom","defaultRenderer","__ECHARTS__DEFAULT__RENDERER__","_zr","renderer","devicePixelRatio","_throttledZrFlush","flush","backwardCompat","_chartsViews","_chartsMap","_componentsViews","_coordSysMgr","createExtensionAPI","visualFuncs","dataProcessorFuncs","_scheduler","_messageCenter","_initEvents","resize","_pendingActions","animation","_onframe","bindRenderedEvent","doConvertPixel","_model","coordSysList","getCoordinateSystems","coordSys","prepare","ecIns","restorePipelines","prepareStageTasks","prepareView","updateDirectly","callView","__alive","__model","eachComponent","__viewId","updateStreamModes","chartsMap","eachSeries","doDispatchAction","payloadType","escapeConnect","actionWrap","actions","actionInfo","cptType","update","IN_MAIN_PROCESS","payloads","batched","batch","eventObj","eventObjBatch","isHighDown","batchItem","action","OPTION_UPDATED","updateMethods","flushPendingActions","pendingActions","triggerUpdatedEvent","isFinished","doPrepare","viewId","viewMap","classType","isComponent","Component","assert","init","viewList","__id","__ecComponentInfo","remove","clearColorPalette","render","renderComponents","chart","renderSeries","dirtyList","componentView","updateZ","chartView","updateBlend","updateHoverLayerStatus","aria","performPostUpdateFuncs","postUpdateFuncs","elCount","blendMode","blend","eachPendingDisplayable","coordSysMgr","getComponentByElement","modelInfo","enableConnect","updateConnectedChartsStatus","charts","status","otherChart","STATUS_KEY","STATUS_PENDING","STATUS_UPDATING","STATUS_UPDATED","eventActionMap","actionType","connectedGroups","makeActionFromEvent","otherCharts","instances","dispatchAction","version$1","zrender","existInstance","getInstanceByDom","nodeName","clientWidth","clientHeight","idBase","DOM_ATTRIBUTE_KEY","connect","groupId","groupIdBase","disConnect","isDisposed","getInstanceById","registerTheme","registerPreprocessor","preprocessorFunc","registerProcessor","priority","processor","normalizeRegister","PRIORITY_PROCESSOR_FILTER","registerPostUpdate","postUpdateFunc","registerAction","isObject","ACTION_REG","registerCoordinateSystem","CoordinateSystem$$1","register","getCoordinateSystemDimensions","coordSysCreator","getDimensionsInfo","registerLayout","layoutTask","PRIORITY_VISUAL_LAYOUT","registerVisual","visualTask","PRIORITY_VISUAL_CHART","targetList","defaultPriority","isFunction","wrap","__raw","wrapStageHandler","registerLoading","loadingFx","loadingEffects","extendComponentModel","extendComponentView","extendSeriesModel","SeriesModel","extendChartView","setCanvasCreator","creator","registerMap","mapName","geoJson","specialAreas","features","JSON","mapDataStores","getMap","defaultKeyGetter","DataDiffer","oldArr","newArr","oldKeyGetter","newKeyGetter","_old","_new","_oldKeyGetter","_newKeyGetter","initIndexMap","keyArr","keyGetterName","dataDiffer","existence","summarizeDimensions","summary","notExtraCoordDimMap","defaultedLabel","dimItem","OTHER_DIMENSIONS","coordDimArr","coordDimIndex","isExtraCoord","mayLabelDimType","otherDim","otherDimArr","otherDims","dataDimsOnCoord","encodeFirstDimNotExtra","dimArr","encodeLabel","label","defaultedTooltip","encodeTooltip","tooltip","getDimensionTypeByAxis","axisType","getIndicesCtor","_rawCount","CtorUint32Array","CtorUint16Array","cloneChunk","originalChunk","transferProperties","TRANSFERABLE_PROPERTIES","__wrappedMethods","prepareInvertedIndex","invertedIndicesMap","_invertedIndicesMap","invertedIndices","getRawIndexWithoutIndices","getRawIndexWithIndices","_indices","getId","rawIndex","_idList","_getIdFromStore","ID_PREFIX","normalizeDimensions","validateDimensions","error","cloneListForMapAndSample","original","excludeDimensions","allDimensions","List","_storage","originalStorage","rawExtent","_rawExtent","cloneDimStore","getInitialExtent","originalDimStore","newDimStore","completeDimensions","sysDims","applyDim","resultItem","coordDimNameMap","dimsDef","encodeDef","dataDimNameMap","dimCount","getDimCount","dimDefItem","userDimName","validDataDims","resultDimIdx","availDimIdx","sysDimItem","sysDimIndex","sysDimItemDimsDef","sysDimItemOtherDims","generateCoord","generateCoordCount","fromZero","extra","genName","optDimCount","enableDataStack","dimensionInfoList","stackedByDimInfo","stackedDimInfo","byIndex","stackedCoordDimension","mayStack","dimensionInfo","createInvertedIndices","stackedDimCoordDim","stackedDimType","stackedDimCoordIndex","isCalculationCoord","isDimensionStacked","stackedDim","stackedByDim","getCalculationInfo","createListFromArray","coordSysDimDefs","registeredCoordSys","hasNameEncode","dimInfoList","createDimensions","coordDimensions","categoryAxisModel","getOrdinalMeta","stackCalculationInfo","setCalculationInfo","dimValueGetter","isNeedCompleteOrdinalData","itemOpt","defaultDimValueGetter","hasItemOption","initData","sampleItem","firstDataNotNull","Scale","setting","_setting","_extent","_interval","OrdinalMeta","_needCollect","needCollect","_deduplication","deduplication","_map","getOrCreateMap","getName","intervalScaleNiceTicks","extent","splitNumber","minInterval","maxInterval","span","intervalPrecision","getIntervalPrecision","niceTickExtent","roundNumber$1","fixExtent","intervalScaleGetTicks","ticks","safeLimit","tick","getSeriesStackId","STACK_PREFIX","seriesIndex","getAxisKey","axis","getLayoutOnAxis","baseAxis","axisKey","bandWidth","getBandWidth","stackId","widthAndOffsets","doCalBarWidthAndOffset","offsetCenter","calBarWidthAndOffset","barSeries","seriesInfoList","getData","cartesian","coordinateSystem","getBaseAxis","axisExtent","getExtent","barWidth","barMaxWidth","barGap","barCategoryGap","columnsMap","seriesInfo","columnsOnAxis","remainedWidth","autoWidthCount","categoryGap","stacks","barGapPercent","autoWidth","column","lastColumn","widthSum","eachSeriesByType","barWidthAndOffset","lastStackCoords","columnLayoutInfo","columnOffset","columnWidth","valueAxis","getOtherAxis","barMinHeight","setLayout","size","valueDim","baseDim","stacked","isValueAxisH","isHorizontal","valueAxisStart","onZero","toGlobalCoord","dataToCoord","getGlobalExtent","baseValue","sign","baseCoord","coord","dataToPoint","setItemLayout","fixRoundingError","originalVal","roundingErrorFix","getPrecisionSafe$1","getScaleExtent","axisDataLen","boundaryGap","scaleType","getMin","getMax","fixMin","fixMax","originalExtent","getCategories","setBlank","getNeedCrossZero","isBaseAxisAndHasBarSeries","barSeriesModels","adjustedScale","adjustScaleForOverflow","axisLength","baseAxisKey","barsOnCurrentAxis","minOverflow","maxOverflow","totalOverFlow","oldRange","oldRangePercentOfNew","overflowBuffer","niceScaleExtent","setExtent","niceExtent","setInterval","createScaleByModel","OrdinalScale","IntervalScale","ifAxisCrossZero","getAxisLabelInterval","tickCoords","labels","axisRotate","textSpaceTakenRect","autoLabelInterval","accumulatedLabelInterval","step","tickCoord","union","getFormattedLabels","labelFormatter","getTicksLabels","getTicks","getAxisRawValue","getLabel","symbolPathSetColor","innerColor","symbolStyle","symbolShape","symbolType","__isEmptyBrush","createSymbol","keepAspect","isEmpty","symbolPath","SymbolClz","setColor","createList","createScale","axisModelCommonMixin","mixinAxisModelCommonMethods","Model$$1","isAroundEqual$1","EPSILON$3","contain$1","Region","geometries","cp","decode","json","UTF8Encoding","encodeScale","UTF8Scale","feature","geometry","coordinates","encodeOffsets","coordinate","decodePolygon","c2","polygon","prevX","prevY","fixExtentWithBands","nTick","getDefaultLabel","labelDims","vals","getSymbolSize","symbolSize","getItemVisual","getScale","SymbolClz$1","seriesScope","updateData","driftSymbol","drift","SymbolDraw","symbolCtor","_symbolCtor","symbolNeedsDraw","isIgnore","clipShape","normalizeUpdateOpt","makeSeriesScope","getItemStyle","hoverItemStyle","symbolRotate","symbolOffset","hoverAnimation","hoverLabelModel","cursorStyle","prepareDataCoordInfo","valueOrigin","valueStart","getValueStart","baseAxisDim","valueAxisDim","baseDataOffset","dataDimsForPoint","getStackedOnPoint","dataCoordInfo","stackedData","diffData","oldData","diffResult","newIdx","oldIdx","idx1","execute","isPointNull","drawSegment","segLen","allLen","smoothMin","smoothMax","smoothMonotone","connectNulls","isMono","drawMono","drawNonMono","last","lastDiff","prevIdx","prevP","ctrlLen","v2Copy","cp0","nextIdx","nextP","ratioNextSeg","lenPrevSeg","lenNextSeg","dist","scaleAndAdd$1","getBoundingBox","ptMin","ptMax","pt","isPointsSame","points1","points2","getSmooth","getAxisExtentWithGap","onBand","halfBandWidth","getStackedOnPoints","createGridClipShape","hasAnimation","xExtent","getAxis","yExtent","expandSize","Rect","createPolarClipShape","polar","angleAxis","getAngleAxis","radiusAxis","getRadiusAxis","radiusExtent","angleExtent","RADIAN","Sector","r0","clockwise","inverse","createClipShape","turnPointsIntoStep","stepTurnAt","baseIndex","stepPoints","nextPt","stepPt","middle","stepPt2","getVisualGradient","visualMetaList","getVisual","visualMeta","dimension","stops","stop","stopLen","outerColors","reverse","tinyExtent","minCoord","maxCoord","coordSpan","gradient","LinearGradient","dimAxisMapper","_axes","Cartesian2D","Cartesian","getAxisType","axisDim","isAxisUsedInTheGrid","gridModel","getCoordSysModel","rotateTextRect","textRect","rotateRadians","boundingBox","plain","beforeWidth","beforeHeight","afterWidth","afterHeight","rotatedRect","getLabelUnionRect","axisLabelModel","labelCount","isLabelIgnored","unrotatedSingleRect","getTextRect","singleRect","Grid","_coordsMap","_coordsList","_axesMap","_axesList","_initCartesian","fixAxisOnZero","axesMap","otherAxisDim","axes","onZeroAxisIndex","otherAxis","canNotOnZeroToAxis","ifAxisCrossZero$1","updateAxisTransform","coordBase","axisExtentSum","toLocalCoord","findAxesModels","axesTypes","getReferringComponents","isCartesian2D","makeAxisEventDataBase","eventData","endTextLayout","textRotate","rotationDiff","onLeft","PI$2","tooltipOpt","show","fixMinMaxLabelShow","labelEls","tickEls","showMinLabel","showMaxLabel","firstLabel","nextLabel","lastLabel","prevLabel","firstTick","nextTick","lastTick","prevTick","ignoreEl","isTwoLabelOverlapped","ignore","current","labelLayout","firstRect","nextRect","mRotationBack","isNameLocationCenter","nameLocation","buildAxisTick","axisBuilder","isBlank","tickModel","lineStyleModel","tickLen","tickInterval","getInterval$1","labelInterval","ticksCoords","getTicksCoords","pt1","pt2","matrix","_transform","ticksCnt","ifIgnoreOnTick$1","tickDirection","tickEl","Line","getLineStyle","buildAxisLabel","axisLabelShow","labelMargin","labelRotation","innerTextLayout","labelDirection","categoryData","triggerEvent","tickVal","itemLabelModel","textColor","getTextColor","pos","labelOffset","labelStr","textEl","Text","targetType","_dumbGroup","updateTransform","decomposeTransform","collect","axesInfo","seriesInvolved","coordSysAxesInfo","coordSysMap","collectAxesInfo","collectSeriesInfo","globalTooltipModel","globalAxisPointerModel","linksOption","linkGroups","each$7","saveTooltipAxisInfo","fromTooltip","triggerTooltip","axisPointerModel","axisPointerShow","isHandleTrigger","makeAxisPointerModel","baseTooltipModel","snap","makeKey","involveSeries","axisInfo","useHandle","axesInfoInCoordSys","groupIndex","getLinkGroupIndex","linkGroup","mapper","axisPointerEnabled","coordSysKey","coordSysModel","getAxes","curry$1","getTooltipAxes","triggerAxis","cross","tooltipAxes","baseAxes","otherAxes","tooltipAxisPointerModel","volatileOption","field","labelOption","tooltipAxisPointerLabelShow","crossStyle","lineStyle","seriesTooltipTrigger","seriesTooltipShow","seriesDataCount","linkOption","checkPropInLink","linkPropValue","axisPropValue","fixValue","getAxisInfo","getAxisPointerModel","updateAxisPointer","axisView","forceRender","AxisView","getAxisPointerClass","axisPointerClass","_axisPointer","disposeAxisPointer","axisPointer","layout$1","grid","rawAxisPosition","axisPosition","getRect","rectBound","axisOffset","posBound","onZeroCoord","dirMap","nameDirection","labelInside","getLabelInterval","setLabel","itemModel","labelPositionOutside","fixPosition","removeRect","animationModel","removeSector","updateStyle","isPolar","opacity","itemStyleModel","getBarItemStyle","setShape","useStyle","getLineWidth","rawLayout","BAR_BORDER_WIDTH_QUERY","updateDataSelected","selectedOffset","toggleItemSelected","getItemLayout","isSelected","midAngle","animate","when","PiePiece","onEmphasis","polyline","hoverIgnore","onNormal","normalIgnore","sector","Polyline","adjustSingleSide","viewWidth","viewHeight","shiftDown","shiftUp","changeX","isDownList","lastDeltaX","MAX_VALUE","deltaY","deltaX","lastY","upList","downList","avoidOverlap","labelLayoutList","leftList","rightList","linePoints","LargeSymbolDraw","IndicatorAxis","Axis","Radar","radarModel","_indicatorAxes","getIndicatorModels","indicatorModel","indicatorAxis","defaultsShow","normalizeSymbolSize","TransformDummy","View","zoomLimit","_roamTransformable","_rawTransformable","_center","_zoom","doConvert$1","Geo","_nameCoordMap","loadGeoJson","doConvert","geoModel","resizeGeo","boundingCoords","leftTop","rightBottom","setBoundingRect","boxLayoutOption","aspectScale","useCenterAndSize","getBoxLayoutParams","setViewRect","setCenter","setZoom","setGeoCoords","geo","geoCoord","addGeoCoord","take","resourceKey","userKey","store","getStore","release","uKey","isTaken","ATTR","RoamController","pointerChecker","_opt","bind$$1","mousedownHandler","mousedown","mousemoveHandler","mousemove","mouseupHandler","mouseup","mousewheelHandler","mousewheel","pinchHandler","pinch","setPointerChecker","enable","controlType","disable","zoomOnMouseWheel","moveOnMouseMove","preventDefaultMouseMove","isDragging","_dragging","isPinching","_pinching","draggable","_y","checkKeyBinding","oldX","oldY","zoomDelta","zoom","zoomX","zoomY","roamController","updateViewOnPan","controllerHost","updateViewOnZoom","newZoom","zoomMin","zoomMax","zoomScale","onIrrelevantElement","targetCoordSysModel","IRRELEVANT_EXCLUDES","getFixedItemStyle","areaColor","updateMapSelectHandler","mapDraw","mapOrGeoModel","fromView","_mouseDownFlag","__regions","region","updateMapSelected","otherRegionEl","MapDraw","updateGroup","_controller","getZr","_controllerHost","_updateGroup","updateCenterAndZoom","previousZoom","getZoom","getCenter","pointToData","fixX","fixY","dataStatistics","datas","statisticType","dataNameMap","mapKey","linkList","mainData","datasAttr","linkAll","each$8","TRANSFERABLE_METHODS","transferInjection","cloneShallowInjection","changeInjection","dataType","isMainData","DATAS","linkSingle","MAIN_DATA","struct","getLinkedData","structAttr","Tree","levelOptions","leavesOption","root","_nodes","levelModels","levelDefine","leavesModel","addChild","children","parentNode","init$2","hierNode","defaultAncestor","prelim","modifier","change","thread","isExpand","firstWalk","separation","siblings","subtreeW","executeShifts","midPoint","apportion","secondWalk","nodeX","defaultSeparation","radialCoordinate","radialCoor","getViewRect","subtreeV","nodeOutRight","nodeInRight","nodeOutLeft","nodeInLeft","sumOutRight","sumInRight","sumOutLeft","sumInLeft","nextRight","nextLeft","moveSubtree","nextAncestor","wl","wr","node1","node2","symbolNeedsDraw$1","getTreeNodeStyle","symbolInnerColor","updateNode","symbolEl","isInit","tree","getNodeByDataIndex","virtualRoot","sourceSymbolEl","sourceLayout","getLayout","sourceOldLayout","rawX","__radialOldRawX","rawY","__radialOldRawY","targetLayout","__radialRawX","__radialRawY","setItemGraphicEl","getSymbolPath","isLeft","realRoot","rootLayout","verticalAlign","__edge","BezierCurve","getEdgeShape","removeNode","fadeOut","keepLabel","radialCoor1","radialCoor2","curvature","radialCoor3","radialCoor4","eachAfter","eachBefore","retrieveTargetInfo","validPayloadTypes","targetNode","contains","targetNodeId","getNodeById","getPathToRoot","aboveViewRoot","viewRoot","viewPath","wrapTreePathInfo","treePathInfo","nodeDataIndex","getRawValue","completeTreeValue","dataNode","childValue","thisValue","setDefault","globalColorList","hasColorDefine","modelColor","level0","Breadcrumb","containerGroup","makeItemPoints","itemWidth","itemHeight","ARRAY_LENGTH","packEventData","itemNode","componentSubType","selfType","nodeData","createWrap","doneCallback","elExistsMap","done","createStorage","nodeGroup","background","content","renderNode","thisStorage","oldStorage","reRoot","lastsForAnimation","willInvisibleEls","thisNode","oldNode","parentGroup","depth","renderBackground","bg","useUpperLabel","thisWidth","thisHeight","visualBorderColor","emphasisBorderColor","itemStyleEmphasisModel","getItemStyleNormal","itemStyleNormalModel","getItemStyleEmphasis","upperLabelWidth","borderWidth","prepareText","upperHeight","renderContent","culling","visualColor","element","thisInvisible","invisible","__tmWillVisible","upperLabelRect","nodeModel","thisLayout","isLeafRoot","iconChar","normalLabelModel","PATH_UPPERLABEL_NORMAL","PATH_LABEL_NOAMAL","emphasisLabelModel","PATH_UPPERLABEL_EMPHASIS","PATH_LABEL_EMPHASIS","isShow","giveGraphic","storageName","oldRawIndex","lasts","prepareAnimationWhenHasOld","calculateZ","__tmDepth","__tmStorageName","prepareAnimationWhenNoOld","thisRawIndex","lastCfg","old","parentOldX","parentOldY","parentOldBg","fadein","isInView","thisViewChildren","viewChildren","isParent","Group$2","__tmNodeWidth","__tmNodeHeight","isAboveViewRoot","Rect$1","Z_BG","Z_CONTENT","zInLevel","zb","Z_BASE","preprocessForPiecewise","thisOption","pieceList","hasSpecialVisual","piece","originIndex","visual","preprocessForSpecifiedCategory","categoryMap","each$10","cate","visualArr","CATEGORY_DEFAULT_VISUAL_INDEX","setVisualToOption","normalizeVisualRange","doNotNeedPair","symbol","makePartialColorVisualHandler","applyValue","applyVisual","mapValueToVisual","_doMap","makeDoMap","doMapToArray","normalized","makeApplyVisual","doMapCategory","doMapFixed","sourceExtent","linear","category","piecewise","getSpecifiedVisual","fixed","pieceIndex","VisualMapping","findPieceIndex","parsedVisual","travelTree","designatedVisual","levelItemStyles","seriesItemStyleModel","viewRootAncestors","nodeLayout","thisNodeColor","nodeItemStyleModel","ITEM_STYLE_NORMAL","levelItemStyle","visuals","buildVisuals","borderColor","borderColorSaturation","calculateColor","calculateBorderColor","setVisual","mapping","buildVisualMapping","childVisual","mapVisual$1","visualName","getValueVisualDefine","colorAlpha","colorSaturation","rangeVisual","getRangeVisual","visualMin","visualMax","colorMappingBy","mappingMethod","__drColorMappingBy","isArray$2","childVisuals","mappingType","mapIdToIndex","getValue","squarify","hideChildren","isRemoved","PATH_BORDER_WIDTH","halfGapWidth","PATH_GAP_WIDTH","upperLabelHeight","getUpperLabelHeight","layoutOffset","layoutOffsetUpper","mathMax$4","totalArea","initChildren","rowFixedLength","mathMin$4","best","area","score","worst","squareRatio","childrenVisibleMin","orderBy","overLeafDepth","leafDepth","sort$1","info","statistic","filterByThreshold","orderedChildren","visibleMin","deletePoint","each$11","ratio","areaMax","areaMin","squareArea","idx0WhenH","idx1WhenH","xy","wh","rowOtherLength","rowLen","wh1","remain","modWH","wh0","estimateRootSize","currNode","defaultSize","viewArea","zoomToNodeRatio","currNodeValue","MAX_SAFE_INTEGER","calculateRootPosition","layoutInfo","rootRect","defaultPosition","targetCenter","prunning","clipRect","viewAbovePath","nodeInViewAbovePath","childClipRect","PATH_UPPER_LABEL_SHOW","PATH_UPPER_LABEL_HEIGHT","generateNodeKey","Node","inEdges","outEdges","hostGraph","Edge","n1","n2","isLine","makeSymbolTypeKey","symbolCategory","createSymbol$1","lineData","createLine","LinePath","setLinePoints","targetShape","updateSymbolAndLabelBeforeLineUpdate","lineGroup","symbolFrom","childOfName","symbolTo","invScale","fromPos","pointAt","toPos","tangent","tangentAt","distance$$1","__position","halfPercent","__verticalAlign","__textAlign","Line$1","_createLine","LineDraw","ctor","_ctor","doAdd","lineDraw","itemLayout","lineNeedsDraw","doUpdate","oldLineData","newLineData","itemEl","makeSeriesScope$1","hoverLineStyle","isPointNaN","pts","intersectCurveCircle","curvePoints","radius","radiusSquare","quadraticAt$1","mathAbs$1","v2DistSquare","v3","nextDiff","getItemOpacity","opacityPath","fadeOutItem","opacityRatio","getGraphicEl","downplay","fadeInItem","highlight","normalize$1","simpleLayout$1","getGraph","eachNode","simpleLayoutEdge","eachEdge","curveness","circularLayout$1","getSum","unitAngle","x12","y12","forceLayout$1","gravity","pp","friction","warmUp","setFixed","setUnfixed","v12","nLen","scaleAndAdd$2","repFact","rep","getViewRect$1","parsePosition","formatLabel","FunnelPiece","labelLine","Polygon","getViewRect$2","getSortedIndices","valueArr","mapArray","indices","isAscending","labelLayout$1","getItemModel","labelPosition","labelLineModel","isLabelInside","labelLineLen","inside","createParallelIfNeeded","parallel","hasParallelSeries","mergeAxisOptionFromParallel","parallelAxis","axisOption","parallelIndex","parallelOption","parallelAxisDefault","getSpanSign","handleEnds","handleIndex","restrict$1","Parallel","parallelModel","_axesLayout","_init","restrict","mathMin$5","mathMax$5","layoutAxisWithoutExpand","axisIndex","layoutLength","axisCount","axisNameAvailableWidth","layoutAxisWithExpand","nameTruncateMaxWidth","axisExpandWidth","axisCollapseWidth","winInnerIndices","axisExpandWindow0Pos","axisExpandWindow","create$2","getAxisType$1","axisName","BrushController","_brushType","_brushOption","_panels","_track","_covers","_creatingCover","_creatingPanel","_enableGlobalPan","_mounted","_uid","baseUID","each$13","mouseHandlers","doEnableBrush","controller","brushOption","MUTEX_RESOURCE_KEY","brushType","DEFAULT_BRUSH_OPT","doDisableBrush","createCover","cover","coverRenderers","__brushOption","updateZ$1","endCreating","creatingCover","coverRenderer","getCoverRenderer","updateCoverShape","COVER_Z","updateCoverAfterCreation","updateCommon","getPanelByPoint","localCursorPoint","panels","panel","pn","isTargetByCursor","getPanelByCover","panelId","clearCovers","covers","originalLength","areas","map$2","isEnd","removeOnClick","shouldShowCover","track","mathPow$2","UNSELECT_THRESHOLD","getTrackEnds","createBaseRectCover","doDrift","edgeNames","makeStyle","cursor","curry$2","ondragend","updateBaseRect","localRange","brushStyle","handleSize","mathMax$6","MIN_RESIZE_LINE_WIDTH","xa","ya","x2a","y2a","widtha","heighta","updateRectShape","transformable","mainEl","globalDir","getGlobalDirection","CURSOR_MAP","pointsToRect","clipByPanel","formatRectRange","mathMin$6","getTransform$1","localDirection","inverseMap","driftRect","toRectRange","fromRectRange","rectRange","localDelta","toLocalDelta","namePart","ind","DIRECTION_MAP","driftPolygon","thisGroup","localD","transformCoordToLocal","localZero","xmin","ymin","xmax","ymax","resetCursor","currPanel","setCursorStyle","preventDefault","rawE","mainShapeContain","updateCoverByMouse","eventParams","thisBrushOption","brushMode","determineBrushType","coverBrushOption","getCreatingRange","defaultBrushType","handleDragEnd","getLineRenderer","xyIndex","localTrack","ends","otherExtent","getLinearBrushOtherExtent","makeRectPanelClipPath","normalizeRect","localPoints","makeLinearBrushOtherExtent","specifiedXYIndex","brushWidth","makeRectIsTargetByCursor","targetModel","fromAxisAreaSelect","findComponents","getCoverInfoList","activeIntervals","checkTrigger","triggerOn","setEncodeAndDimensions","dataDimIndex","convertDimNameToNumber","createGridClipShape$1","rectEl","createLinePoints","isEmptyValue","addEl","dataGroup","updateElCommon","seriesStyleModel","createGridClipShape$2","nest","keysFunction","keyFunction","mapObject","valuesByKey","keyValue","entriesMap","sortKeyFunction","sortKeysFunction","sortKeys","order","entries","getViewRect$3","layoutSankey","nodeWidth","nodeGap","iterations","computeNodeBreadths","computeNodeDepths","computeEdgeDepths","computeNodeValues","getEdgeValue","remainNodes","nextNode","kx","moveSinksRight","scaleNodeBreadths","nodesByBreadth","ascending","initializeNodeDepth","resolveCollisions","relaxRightToLeft","relaxLeftToRight","kyArray","ky","ky0","nodeDy","edgeDy","ascendingDepth","nodeY","weightedTarget","center$1","weightedSource","ascendingTargetDepth","ascendingSourceDepth","sy","WhiskerBox","styleUpdater","bodyIndex","whiskerIndex","_createContent","_seriesModel","transInit","initBaseline","makeWhiskerEndsShape","whiskerEnds","WhiskerBoxDraw","updateStyle$1","itemGroup","normalItemStyleModel","normalStyleAccessPath$1","whiskerEl","bodyEl","emphasisStyleAccessPath$1","groupSeriesByAxis","axisList","calculateBase","groupItem","seriesCount","boxWidthList","boxOffsetList","boundList","maxDataCount","each$14","boxWidthBound","availableWidth","boxGap","boxWidth","layoutSingleSeries","cDim","halfWidth","chartLayout","variableDim","constDim","coordDims","vDims","getPoint","axisDimVal","addBodyEnd","point1","point2","bodyEnds","layEndLine","endCenter","median","end1","end5","updateStyle$2","normalStyleAccessPath$2","emphasisStyleAccessPath$2","calculateCandleWidth","retrieve2$1","barMinWidth","normalizeSymbolSize$1","updateRipplePath","rippleGroup","effectCfg","ripplePath","EffectSymbol","beforeUpdate","compatEc2","coords","fromName","toName","EffectLine","_updateEffectSymbol","Polyline$2","_createPolyline","EffectPolyline","_lastFrame","_lastFramePercent","LargeLineDraw","normalize$2","Heatmap","canvas","blurSize","pointSize","maxOpacity","minOpacity","_gradientPixels","getIsInPiecewiseRange","selected","dataSpan","getIsInContinuousRange","isGeoCoordSys","getSymbolMeta","symbolRepeat","symbolClip","symbolPosition","symbolPatternSize","symbolMeta","symbolRepeatDirection","prepareBarLength","prepareSymbolSize","boundingLength","pxSign","prepareLineWidth","symbolScale","prepareLayoutInfo","valueLineWidth","repeatCutLength","output","symbolBoundingData","zeroPx","pxSignIdx","symbolBoundingExtent","convertToCoordOnAxis","coordSysExtent","categoryDim","categorySize","BAR_BORDER_WIDTH_QUERY$1","pathForLineWidth","getLineScale","unitLength","pathLen","absBoundingLength","symbolMargin","hasEndGap","uLenWithMargin","endFix","repeatSpecified","repeatTimes","toIntTimes","mDiff","sizeFix","pathPosition","bundlePosition","barRectShape","ecSize","createPath","createOrUpdateRepeatSymbols","bar","makeTarget","onMouseOver","eachPath","onMouseOut","bundle","__pictorialBundle","__pictorialAnimationIndex","__pictorialRepeatTimes","updateAttr","updateHoverAnimation","createOrUpdateSingleSymbol","mainPath","__pictorialMainPath","createOrUpdateBarRect","rectShape","barRect","__pictorialBarRect","createOrUpdateClip","__pictorialClipPath","setClipPath","graphic","createBar","__pictorialShapeStr","getShapeStr","__pictorialSymbolMeta","updateBar","removeBar","labelRect","pathes","immediateAttrs","animationAttrs","updateCommon$1","barRectHoverStyle","barPositionOutside","posDesc","times","roundedTimes","Single","_axis","create$3","singles","single","singleAxisModel","layout$2","positionMap","horizontal","vertical","directionMap","getAxisType$2","processOnAxis","newValue","updaters","dontSnap","outputFinder","containData","showPointer","payloadInfo","buildPayloadsBySeries","payloadBatch","snapToValue","showTooltip","minDist","minDiff","each$15","seriesNestestValue","getAxisTooltipData","nestestValue","indicesOfNearest","showValueMap","dataByCoordSys","coordSysItem","coordSysId","coordSysIndex","coordSysType","coordSysMainType","dataByAxis","axisId","valueLabelOpt","formatter","seriesDataIndices","updateModelActually","outputAxesInfo","valItem","dispatchTooltipActually","illegalPoint","tooltipOption","dispatchHighDownActually","highDownKey","lastHighlights","inner$6","newHighlights","toHighlight","toDownplay","findInputAxisInfo","inputAxesInfo","inputAxisInfo","makeMapperParam","inner$7","records","initGlobalListeners","record","useHandler","dis","makeDispatchAction","each$16","dispatchTooltipFinally","pendings","initialized","doEnter","onLeave","actuallyPayload","showLen","showTip","hideLen","hideTip","currTrigger","unregister","BaseAxisPointer","updateProps$1","moveAnimation","propsEqual","inner$8","lastProp","lastProps","newProps","equals","updateLabelShowHide","labelEl","getHandleTransProps","trans","updateMandatoryProps","buildElStyle","axisPointerType","styleModel","getAreaStyle","buildLabelElOption","elOption","labelPos","getValueLabel","paddings","align","confineInContainer","bgColor","shadowBlur","shadowColor","shadowOffsetX","shadowOffsetY","seriesData","idxItem","getSeriesByIndex","dataParams","getDataParams","getTransformedPosition","buildCartesianSingleLabelElOption","textLayout","AxisBuilder","makeLineShape","xDimIndex","makeRectShape","makeSectorShape","getCartesian","getAxisDimIndex","getPointDimIndex","XY","WH","createGridClipShape$3","themeRiverLayout$1","baseY0","layerSeries","getLayerSeries","timeDim","layerPoints","singleLayer","computeBaseline","baseLine","layerIndex","temp","layerNum","pointNum","sums","completeTreeValue$1","SunburstPiece","DEFAULT_SECTOR_Z","DEFAULT_TEXT_Z","getNodeColor","getRootId","getAncestors","isNodeHighlighted","activeNode","policy","NodeHighlightPolicy","NONE","SELF","ANCESTOR","isAncestorOf","isDescendantOf","initChildren$1","isAsc","sort$2","sortOrder","dataToCoordSize","dataSize","dimIdx","halfSize","dataToCoordSize$1","dataToCoordSize$2","dataToCoordSize$3","createEl","graphicType","__customPathData","__customImagePath","__customText","__customGraphicType","updateEl","targetProps","elOptionStyle","targetStyle","prepareStyleTransition","targetOpacity","styleEmphasis","oldElStyle","makeRenderItem","customSeries","updateCache","currDataIndexInside","currDirty","currItemModel","currLabelNormalModel","LABEL_NORMAL","currLabelEmphasisModel","LABEL_EMPHASIS","currVisualColor","getDimension","ITEM_STYLE_NORMAL_PATH","ITEM_STYLE_EMPHASIS_PATH","barLayout","currentSeriesIndices","getCurrentSeriesIndices","renderItem","prepareResult","prepareCustoms","userAPI","getDevicePixelRatio","userParams","dataInsideLength","wrapEncodeDef","createOrUpdate$1","doCreateOrUpdate","elOptionType","oldChildren","newChildren","diffChildrenByName","diffGroupChildren","getKey","processAddUpdate","processRemove","GROUP_DIFF_PREFIX","newIndex","oldIndex","childOption","createEl$1","targetElParent","__ecGraphicId","removeEl","existEl","existElParent","getCleanedElOption","isSetLoc","isSet","setKeyInfoToNewElOption","newElOption","existElOption","parentId","newElParentOption","parentOption","mergeNewElOptionToExist","existList","newElOptCopy","$action","newType","setLayoutInfoToExist","existItem","legendSelectActionHandler","selectedMap","isToggleSelect","legendModel","legendData","isItemSelected","layout$3","boxLayoutParams","viewportSize","makeBackground","dispatchSelectAction","dispatchHighlightAction","dataName","getDisplayList","dispatchDownplayAction","mergeAndNormalizeLayoutParams","raw","getOrient","assembleTransition","transitionCurve","transitionText","vendors","vendorPrefix","assembleFont","each$19","assembleCssText","tooltipModel","transitionDuration","backgroundColor","borderName","camelCase","toCamelCase$1","TooltipContent","wxa","appendChild","_container","_show","_hideTimeout","self","onmouseenter","_enterable","_inContent","onmousemove","dispatch","onmouseleave","hideLater","_hideDelay","buildTooltipModel","modelCascade","resultModel","makeDispatchAction$1","refixTooltipPosition","gapH","gapV","getOuterSize","confineTooltipPosition","defaultView","getComputedStyle","stl","paddingLeft","paddingRight","borderLeftWidth","borderRightWidth","paddingTop","paddingBottom","borderTopWidth","borderBottomWidth","calcTooltipPosition","contentSize","domWidth","domHeight","rectWidth","rectHeight","isCenterAlign","getSeriesStackId$1","getAxisKey$1","barLayoutPolar","calRadialBar","getSeriesByType","barMinAngle","radiusSpan","dataToRadius","dataToAngle","angleSpan","RadiusAxis","AngleAxis","getAxisType$3","resizePolar","polarModel","updatePolarScale","unionExtentFromData","setAxis","getAxisLineShape","rExtent","coordToPoint","getRadiusIdx","layoutAxis","radiusAxisModel","axisAngle","getLabelPosition","makeAction","regions","removeDuplicate","flag","hasKeys","createVisualMappings","stateList","supplementVisualOption","createMappings","Creater","__hidden","visualMappings","each$20","mappings","visualData","isValidType","mappingOption","__alphaForOpacity","replaceVisualOption","keys","getValueState","setItemVisual","eachItem","valueOrIndex","rawDataItem","visualMap","valueState","visualTypes","visualTypesMap","prepareVisualTypes","incrementalApplyVisual","getLineSelectors","selectors","inLineRange","layoutRange","lineIntersectPolygon","lx","ly","l2x","l2y","lineIntersect","a1x","a1y","a2x","a2y","b1x","b1y","b2x","b2y","determinant","nearZero","namenda","miu","v4","BrushTargetManager","targetInfoList","_targetInfoList","foundCpts","parseFinder$1","each$21","targetInfoBuilders","builder","include","indexOf$1","formatMinMax","minMax","INCLUDE_FINDER_MAIN_TYPES","axisConvert","axisNameIndex","to","rangeOrCoordRange","coordToData","xyMinMax","axisDiffProcessor","refer","scales","getScales","xyMinMaxCurr","xyMinMaxOrigin","sizeCurr","getSize","sizeOrigin","throttleDelay","brushSelected","DISPATCH_FLAG","DISPATCH_METHOD","doDispatch","checkInRange","selectorsByBrushType","rangeInfoList","getSelectorsByBrushType","brushSelector","sels","selector","selectorsByElementType","bSelector","sel","brushModelNotControll","brushModel","seriesIndices","bindSelector","selFn","elType","getBoundingRectFromMinMax","generateBrushOption","updateController","$from","_brushController","setPanels","brushTargetManager","makePanelOpts","enableBrush","updateCovers","register$1","get$1","Brush","_brushMode","Calendar","calendarModel","doConvert$2","mergeAndNormalizeLayoutParams$1","cellSize","isCoordSupported","coordType","COORDS","createNameEach","attrs","capitalNames","capitalAttrs","nameObj","capital","createLinkedNodesFinder","forEachNode","forEachEdgeType","edgeIdGetter","isNodeAbsorded","isLinked","hasLink","edgeType","edgeId","absorb","sourceNode","processSingleNode","existsLink","calculateDataExtent","axisProxy","each$23","seriesExtent","getApproximateExtent","fixExtentByAxis","getAxisModel","isCategoryAxis","setAxisModel","isRestore","percentWindow","_percentWindow","valueWindow","_valueWindow","useOrigin","setRange","setMinMaxSpan","minMaxSpan","_minMaxSpan","dataZoomModel","_dataZoomModel","valueSpan","_dataExtent","retrieveRaw","each$22","updateRangeUse","rangePropMode","_rangePropMode","rangeModeInOption","percentSpecified","valueSpecified","getOtherDim","thisDim","getCursor","register$2","dataZoomInfo","giveStore","theDataZoomId","dataZoomId","theCoordId","coordId","dataZoomInfos","allCoordIds","cleanStore","createController","dispatchAction$1","controllerParams","mergeControllerParams","containsPoint","throttleRate","unregister$1","shouldRecordRange","generateCoordId","coordModel","ATTR$1","newRecord","curry$6","onPan","onZoom","newX","newY","wrapAndDispatch","panGetRange","mouseX","mouseY","zoomGetRange","getRange","disabled","prefix","typePriority","type_true","type_move","type_false","type_undefined","oneType","zoomLock","roamControllerOpt","has$1","getColorVisual","visualMapModel","resultVisual","targetVisuals","getColorStopValues","stopValues","getItemAlign","itemSize","modelOption","itemAlign","realIndex","paramsSet","reals","fakeValue","layoutInput","rParam","convertDataIndex","createPolygon","onDrift","onDragEnd","createHandlePoints","textSize","createIndicatorPoints","isRange","halfHoverLinkSize","extentMax","mathMin$7","mathMax$7","HOVER_LINK_OUT","getHalfHoverLinkSize","sizeExtent","HOVER_LINK_SIZE","hoverLinkDataSize","linearMap$4","useHoverLinkOnHandle","hoverLinkOnHandle","getCursor$1","normalizeReverse","fillLabel","hasXOrY","hasXAndY","markerTypeCalculatorWithExtent","mlType","otherDataDim","targetDataDim","otherCoordIndex","targetCoordIndex","coordArr","calcDataDim","numCalculate","dataTransform","getAxisInfo$1","markerTypeCalculator","indexOf$2","baseDataDim","valueDataDim","xAxis","yAxis","valueIndex","dataDimToCoordDim","dataFilter$1","getDataExtent","updateMarkerLayout","xPx","yPx","getMarkerPosition","getValues","createList$1","mpModel","coordDimsInfos","dataOpt","isInifinity","ifMarkLineHasOnlyDim","fromCoord","toCoord","otherDimIndex","markLineFilter","updateSingleMarkerEndLayout","isFrom","createList$2","mlModel","fromData","toData","optData","markLineTransform","dimValueGetter$$1","isInifinity$1","ifMarkLineHasOnlyDim$1","markAreaFilter","getSingleMarkerEndPoint","clampData","createList$3","maModel","areaData","markAreaTransform","compatibleEC2","ec2Types","number","transferItem","has$2","controlStyle","controlPosition","itemStyleEmphasis","labelNormal","excludeLabelAttr","getViewRect$4","makeIcon","timelineModel","objPath","icon","giveSymbol","onUpdate","onCreate","pointerMoveTo","pointer","noAnimation","dragging","pointerModel","isUserFeatureName","featureName","SaveAsImage","MagicType","groupSeries","seriesGroupByCategoryAxis","otherSeries","meta","categoryAxis","other","assembleSeriesWithCategoryAxis","tables","headers","columns","ITEM_SPLITER","items","BLOCK_SPLITER","assembleOtherSeries","argLen","getContentFromModel","trim$1","isTSVFormat","firstLine","parseTSVContents","tsv","tsvLines","itemSplitRegex","header","parseListContents","hasName","parseContents","blockMetaList","blocks","blockMeta","DataView","tryMergeDataOption","originalData","newVal","newSnapshot","giveStore$1","each$30","snapshot","percentRange","getPercentRange","clear$1","ATTR$2","DataZoom","_onBrush","mount","_isZoomActive","retrieveAxisSetting","updateBackBtnStatus","featureModel","setIconStatus","updateZoomBtnStatus","zoomActive","dataZoomSelectActive","xAxisDeclared","yAxisDeclared","Restore","createNode","tagName","doCreateNode","initVML","vmlInited","doc","styleSheets","createStyleSheet","addRule","parseInt10$1","VMLPainter","vmlViewport","vmlRoot","_vmlRoot","_vmlViewport","oldDelFromStorage","delFromStorage","oldAddToStorage","addToStorage","onRemove","onAdd","_firstPaint","createMethodNotSupport","zrLog","createElementNS","svgURI","round4","mathRound","isAroundZero$1","EPSILON$4","pathHasFill","isText","pathHasStroke","svgEl","arrayJoin","attrXLink","setAttributeNS","bindStyle","strokeWidth","strokeScale","lineDash","lineDashOffset","lineCap","lineJoin","miterLimit","pathDataToString$1","dataLength","cmdStr","nData","CMD$4","dThetaPositive","isCircle","PI2$7","large","PI$5","mathCos$3","mathSin$3","degree","getVerticalAlignForSvg","Diff","buildValues","componentPos","componentLen","newPos","oldPos","component","removed","added","clonePath","Definable","zrId","svgRoot","tagNames","markLabel","domName","_zrId","_svgRoot","_tagNames","_markLabel","_domName","nextId","GradientManager","ClippathManager","ShadowManager","hasShadow","parseInt10$2","getSvgProxy","svgPath","svgImage","svgText","checkParentAvailable","insertAfter","prevSibling","nextSibling","insertBefore","prepend","firstChild","remove$1","removeChild","getTextSvgElement","__textSvgEl","getSvgElement","__svgEl","createMethodNotSupport$1","dev","idStart","env","wx","worker","navigator","userAgent","[object Function]","[object RegExp]","[object Date]","[object Error]","[object CanvasGradient]","[object CanvasPattern]","[object Image]","[object Canvas]","[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]","Object","arrayProto","zrUtil","freeze","Float32Array","lengthSquare","vector","draggingTarget","_draggingTarget","dropTarget","lastDropTarget","_dropTarget","arrySlice","_$handlers","one","_h","newList","triggerWithContext","Handler","painterRoot","_hovered","_lastTouchMoment","_lastX","_lastY","setHandlerProxy","lastHovered","lastHoveredTarget","hovered","hoveredTarget","setCursor","mouseout","innerDom","toElement","relatedTarget","eventArgs","eventHandler","eventPacket","eachOtherLayer","exclude","hoverCheckResult","_downEl","_downPoint","_upEl","mIdentity","transformableProto","parentHasTransform","invTransform","tmpTransform","sx","scale$$1","getGlobalScale","transformCoordToGlobal","quadraticIn","quadraticOut","quadraticInOut","cubicIn","cubicOut","cubicInOut","quarticIn","quarticOut","quarticInOut","quinticIn","quinticOut","quinticInOut","sinusoidalIn","sinusoidalOut","sinusoidalInOut","exponentialIn","exponentialOut","exponentialInOut","circularIn","circularOut","circularInOut","elasticIn","asin","elasticOut","elasticInOut","backIn","backOut","backInOut","bounceIn","bounceOut","bounceInOut","globalTime","deltaTime","_startTime","easing$$1","easingFunc","schedule","fire","restart","_needsRemove","arg","pause","resume","LinkedList","_len","linkedListProto","insert","entry","Entry","insertEntry","LRU","maxSize","_list","_maxSize","_lastRemovedEntry","LRUProto","leastUsedEntry","transparent","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","fastMapToColor","mapToColor","Animator","_tracks","_clipCount","_doneList","_onframeList","_clipList","tracks","during","isPaused","_doneCallback","doneList","lastClip","clipCount","addClip","oldOnFrame","forwardToLast","clipList","removeClip","getClips","debugMode","Animatable","animators","animatingShape","pathSplitted","addAnimator","_animateToShallow","objShallow","propertyCount","afterUpdate","attrKV","hide","refresh","addSelfToZr","removeClipPath","__clipTarget","removeSelfFromZr","removeAnimator","v2ApplyTransform","mathMin","mathMax","lt","rb","lb","rt","maxX","maxY","ax0","ax1","ay0","ay1","bx0","bx1","by0","by1","_children","__storage","_doAdd","addBefore","addChildrenToStorage","delChildrenFromStorage","removeAll","includeChildren","tmpMat","childRect","Storage","_roots","_displayList","_displayListLen","includeIgnore","updateDisplayList","displayList","_updateAndAddDisplayable","userSetClipPath","currentClipPath","parentClipPath","addRoot","delRoot","_renderList","displayableSortFunc","SHADOW_PROPS","STYLE_COMMON_PROPS","transformText","prevEl","prevStyle","firstDraw","fillStyle","strokeStyle","globalAlpha","globalCompositeOperation","hasStroke","hasFill","otherStyle","newStyle","getGradient","addColorStop","styleProto","Pattern","repeat","getCanvasPattern","createPattern","Layer","domStyle","onselectstart","domBack","ctxBack","config","clearColor","motionBlur","lastFrameAlpha","__used","__drawIndex","__startIndex","__endIndex","incremental","getElementCount","initContext","createBackBuffer","clearAll","haveMotionBLur","clearRect","clearColorGradientOrPattern","__canvasGradient","save","fillRect","restore","requestAnimationFrame","msRequestAnimationFrame","mozRequestAnimationFrame","webkitRequestAnimationFrame","tmpRect$1","RectText","drawRectText","progressive","inplace","beforeBrush","afterBrush","brush","rectContain","animateStyle","_image","sWidth","sHeight","HOVER_LAYER_ZLEVEL","CANVAS_ZLEVEL","EL_AFTER_INCREMENTAL_INC","INCREMENTAL_INC","Painter","singleCanvas","_opts","_singleCanvas","rootStyle","innerHTML","zlevelList","_zlevelList","layers","_layers","_layerConfig","_needsManuallyCompositing","_width","_height","mainLayer","_domRoot","_getSize","_hoverlayer","_hoverElements","getType","isSingleCanvas","getViewportRoot","getViewportRootOffset","viewportRoot","offsetLeft","offsetTop","paintAll","_redrawId","_paintList","_backgroundColor","refreshHover","__hoverMir","elMirror","__from","hoverElements","clearHover","hoverLayer","getLayer","originalEl","_doPaintEl","getHoverLayer","redrawId","_updateLayerStatus","finished","_doPaintList","_compositeManually","eachBuiltinLayer","virtual","layerList","zi","useTimer","now","startTime","firstEl","dTime","prevElClipPaths","draw","currentLayer","forcePaint","insertLayer","layersMap","prevLayer","prevDom","eachLayer","getLayers","updatePrevLayer","incrementalLayerCount","_clearLayer","setBackgroundColor","configLayer","layerConfig","_zlevel","delLayer","display","_progressiveLayers","clearLayer","getRenderedCanvas","imageLayer","pixelRatio","renderToCanvas","whIdx","cwh","plt","prb","pathToImage","shadowBlurSize","leftMargin","rightMargin","topMargin","bottomMargin","pathTransform","ImageShape","imgShape","stopPropagation","returnValue","Animation","_clips","_running","_time","_pauseStart","clips","_update","deferredEvents","deferredClips","_startLoop","_doTrack","_recognize","touches","trackItem","recognizers","pinchEnd","pinchPre","pinchCenter","TOUCH_CLICK_DELAY","pointerEventNames","pointerdown","pointerup","pointermove","pointerout","nm","touchstart","touchmove","touchend","click","handlerDomProxyProto","useVML","rendererType","vml","handerProxy","_needsRefresh","zLevel","refreshImmediately","triggerRendered","_needsRefreshHover","refreshHoverImmediately","clearAnimation","makeStyleMapper","properties","excludes","includes","lineStyleMixin","getLineDash","lineType","dotSize","dashSize","areaStyleMixin","min$1","max$1","min2","max2","mathMin$2","mathMax$2","mathCos$1","mathSin$1","mathSqrt$1","mathAbs","hasTypedArray","notSaveData","_saveData","_xi","_yi","_x0","_y0","_ux","_uy","_lineDash","_dashOffset","_dashIdx","_dashSum","setScale","exceedUnit","_needsDash","_dashedLineTo","_dashedBezierTo","quadraticCurveTo","_dashedQuadraticTo","arcTo","setLineDash","lineDashSum","setLineDashOffset","len$$1","appendSize","appendPathData","_expandData","_prevCmd","dash","dashSum","dist$$1","nDash","bezierLen","tmpLen","ux","uy","scaleX","scaleY","isEllipse","pathProxyForDraw","strokeContainThreshold","hasFillGradient","hasStrokeGradient","hasFillPattern","hasStrokePattern","_fillGradient","_strokeGradient","ctxLineDash","shapeCfg","inBundle","needsUpdateRect","rectWithStroke","_rectWithStroke","lineScale","localPos","dirtyPath","animateShape","defaults$$1","Sub","defaultShape","thisShape","CMD$2","mathSqrt$3","mathAtan2","nPoint","vMag","Circle","shadowTemp","fixClipWithShadow","orignalBrush","modified","unitX","unitY","Ring","isLoop","segs","w2","w3","constraint","prevPoint","nextPoint","cps","d0","Arc","CompoundPath","paths","_updatePathDirty","Gradient","globalCoord","RadialGradient","clearDisplaybles","addDisplayable","notPersistent","addDisplayables","displayables","mergePath","IncrementalDisplayable","PATH_COLOR","textStyleMixin","itemStyleMixin","getBorderLineDash","mixin$1","ignoreParent","parsePath","thisParentModel","restoreData","setReadOnly","customizeGetParent","varName","truncateText$1","format","boxLayoutMixin","inner$1","defaultOption","dependentModels","layoutMode","extraOpt","mergeDefaultAndTheme","inputPositionParams","themeModel","getTheme","getDefaultOption","optionUpdated","optList","Class","platform","gradientColor","animationDuration","animationDurationUpdate","animationEasingUpdate","animationThreshold","progressiveThreshold","hoverLayerThreshold","useUTC","inner$2","colorPaletteMixin","colorIdx","colorNameMap","getColorFromPalette","scopeFields","defaultColorPalette","layeredColorPalette","colorPalette","cartesian2d","xAxisModel","yAxisModel","singleAxis","findAxisModel","angleAxisModel","parallelAxisIndex","GlobalModel","optionManager","_optionManager","setOption","resetOption","optionChanged","mountOption","timelineOption","getTimelineOption","mediaOptions","getMediaOption","mediaOption","visitComponent","newCptOptionList","ComponentModelClass","newCptTypes","componentOption","getOption","cpts","isIdArray","isNameArray","getQueryCond","q","indexAttr","idAttr","nameAttr","doFilter","queryCond","queryResult","getSeriesByName","oneSeries","getSeriesCount","rawSeriesIndex","filterSeries","filteredSeries","componentTypes","coordinateSystemCreators","coordinateSystems","creater","coordinateSystemCreator","clone$3","oldOptionBackup","newParsedOption","isRecreate","optionBackup","getCurrentIndex","each$5","compatStyle","isTheme","axisOpt","parallelOpt","calendar","calendarOpt","radar","radarOpt","geoOpt","regionObj","toolbox","toolboxOpt","featureOpt","COMPATITABLE_COMPONENTS","clockWise","pointerColor","dataRange","componentName","dataStack","stackInfoMap","providerProto","pure","persistent","arrayRows_column","getItem","appendData","arrayRows_row","objectRows","keyedColumns","col","newCol","oldCol","typedArray","clean","arrayRows","defaultDimValueGetters","_rawData","DIMENSION_LABEL_REG","dataFormatMixin","rawValue","rawDataIndex","marker","labelProp","formatTooltip","taskProto","upTask","_upstream","planResult","outputDueEnd","downTask","_disposed","getUpstream","inner$4","legendDataProvider","visualColorAccessPath","dataTask","getInitialData","dataBeforeProcessed","themeSubType","fillDataTextStyle","newSeriesOption","multipleSeries","formatArrayValue","setEachItem","dimHead","valStr","vertially","tooltipDims","formatSingleValue","tooltipDimLen","isValueArr","formattedValue","colorEl","coordDimToDataDim","getProgressive","getProgressiveThreshold","getTooltipPosition","pipeTask","preventIncremental","componentProto","updateView","updateLayout","updateVisual","createRenderPlanner","originalLarge","originalProgressive","incrementalPrepareRender","incrementalRender","chartProto","markUpdateMethod","seriesColor","colorAccessPath","lang","title","lineX","lineY","keep","dataView","dataZoom","back","magicType","tiled","saveAsImage","typeNames","pie","scatter","effectScatter","treemap","boxplot","candlestick","heatmap","sankey","funnel","gauge","pictorialBar","themeRiver","sunburst","general","withTitle","withoutTitle","withName","withoutName","multiple","separator","allData","partialData","keyValues","getConfig","userConfig","ariaModel","getTitle","getSeriesTypeName","seriesCnt","ariaLabel","maxDataCnt","maxSeriesCnt","displaySeriesCnt","seriesLabels","seriesLabel","seriesTpl","displayCnt","dataLabels","PI$1","loadingDefault","maskColor","mask","pCtx","progressiveEnabled","bockIndex","dataLen","threshold","stageTaskMap","performDataProcessorTasks","performVisualTasks","performSeriesTasks","cond","colorAll","lightTheme","contrastColor","axisCommon","axisLine","axisTick","axisLabel","splitLine","splitArea","areaStyle","legend","iconStyle","timeAxis","logAxis","color0","borderColor0","TEST_FRAME_REMAIN_TIME","PRIORITY_PROCESSOR_STATISTIC","PRIORITY_VISUAL_GLOBAL","PRIORITY_VISUAL_COMPONENT","PRIORITY_VISUAL_BRUSH","PRIORITY","PROCESSOR","FILTER","STATISTIC","VISUAL","LAYOUT","GLOBAL","CHART","COMPONENT","BRUSH","echartsProto","remainTime","getDom","notMerge","lazyUpdate","setTheme","getSvgDataUrl","pathToDataUrl","getDataURL","excludeComponents","excludesComponentViews","url","toDataURL","getConnectedDataURL","MAX_NUMBER","canvasList","targetCanvas","convertToPixel","convertFromPixel","containPixel","containPoint","getViewOfComponentModel","getViewOfSeriesModel","prepareAndUpdate","componentDirtyList","seriesDirtyMap","_loadingFX","showLoading","cfg","hideLoading","MOUSE_EVENT_NAMES","eveName","dataModel","disconnect","dataTool","_add","_remove","oldDataIndexMap","newDataIndexMap","oldDataKeyArr","newDataKeyArr","isObject$4","UNDEFINED","globalObj","dataCtors","float","Float64Array","int","Int32Array","ordinal","Uint32Array","Uint16Array","dimensionInfos","dimensionNames","dimensionName","_nameList","_optionModels","_visual","_layout","_itemVisuals","hasItemVisual","_itemLayouts","_graphicEls","_chunkSize","_chunkCount","_approximateExtent","_dimensionsSummary","_calculationInfo","listProto","getDimensionsOnCoord","dimensionsSummary","nameList","notProvider","_nameRepeatCount","_dimValueGetter","_initDataFromProvider","rawData","nameDimIdx","chunkSize","dimensionInfoMap","idList","nameRepeatCount","chunkCount","lastChunkIndex","_nameDimIdx","itemId","_idDimIdx","DataCtor","resizeChunkArray","newStore","chunkIndex","chunkOffset","dimStorage","_getNameFromStore","chunk","idDimIdx","getIndices","buffer","chunkStore","rawIdx","dimStore","_getFast","dimData","initialExtent","dimExtent","currEnd","useRaw","setApproximateExtent","maxDistance","nearestIndices","contextCompat","filterSelf","newIndices","dim0","selectRange","originalCount","quickFinished","chunkStorage","dimStorage2","chunkStorage2","val2","dimk","tmpRetValue","dataCount","retValue","rawExtentOnDim","downSample","sampleValue","sampleIndex","targetStorage","frameValues","frameSize","originalChunkIndex","originalChunkOffset","sampleFrameIdx","sampleChunkIndex","sampleChunkOffset","otherList","thisList","clearItemLayouts","itemVisual","setItemDataAndSeriesIndex","injectFunction","originalMethod","dimensionsCount","getSetting","unionExtent","thisExtent","_isBlank","createByAxisModel","dedplication","proto$1","getOrdinal","scaleProto","_ordinalMeta","rank","niceTicks","roundNumber","_intervalPrecision","getInterval","_niceExtent","intervalScaleProto","mathCeil","mathFloor","ONE_SECOND","ONE_MINUTE","ONE_HOUR","ONE_DAY","bisect","TimeScale","stepLvl","_stepLvl","getFullYear","getMonth","getDate","approxTickNum","approxInterval","scaleLevelsLen","scaleLevels","yearSpan","yearStep","timezoneOffset","getTimezoneOffset","scaleProto$1","intervalScaleProto$1","mathFloor$1","mathCeil$1","mathPow$1","mathLog","LogScale","_originalScale","originalScale","powVal","__fixMin","__fixMax","err","rangeStart","rangeEnd","resetRange","Triangle","Diamond","Pin","tanX","tanY","cpLen","cpLen2","Arrow","symbolCtors","roundRect","square","circle","diamond","pin","arrow","triangle","symbolShapeMakers","symbolBuildProxies","proxySymbol","dataStack$1","helper","exterior","loopGeo","interiors","transformTo","parseGeoJson$1","featureObj","linearMap$1","normalizedExtent","_labelInterval","alignWithLabel","bands","getBands","getLabelsCoords","getRotate","parseGeoJson","ecUtil","legendHoverLink","clipOverflow","showSymbol","showAllSymbol","sampling","symbolProto","_createSymbol","_symbolType","stopSymbolAnimation","toLastFrame","setZ","setDraggable","_updateCommon","fadeIn","normalStyleAccessPath","emphasisStyleAccessPath","normalLabelAccessPath","emphasisLabelAccessPath","getLabelDefaultText","useNameLabel","elStyle","symbolDrawProto","SymbolCtor","isPersistent","incrementalPrepareUpdate","_seriesScope","incrementalUpdate","taskParams","updateIncrementalAndHover","enableAnimation","lineAnimationDiff","oldStackedOnPoints","newStackedOnPoints","oldCoordSys","newCoordSys","oldValueOrigin","newValueOrigin","currPoints","nextPoints","currStackedPoints","nextStackedPoints","sortedIndices","rawIndices","newDataOldCoordInfo","oldDataNewCoordInfo","diffItem","pointAdded","currentPt","sortedCurrPoints","sortedNextPoints","sortedCurrStackedPoints","sortedNextStackedPoints","sortedStatus","stackedOnCurrent","stackedOnNext","Polyline$1","Polygon$1","stackedOnPoints","stackedOnSmooth","bbox","stackedOnBBox","symbolDraw","_symbolDraw","_lineGroup","areaStyleModel","isCoordSysPolar","prevCoordSys","_coordSys","_polyline","_polygon","isAreaChart","isSymbolIgnore","_getSymbolIgnoreFunc","__temp","_step","_newPolygon","coordSysClipShape","_stackedOnPoints","_points","_updateAnimation","_newPolyline","stackedOnSeries","_valueOrigin","getAxesByScale","__points","updatedDataInfo","diffStatus","ptIdx","visualSymbol","defaultSymbolType","legendSymbol","itemSymbolType","itemSymbolSize","hasCallback","pointsLayout","segCount","isLargeRender","dimLen","tmpIn","tmpOut","samplers","average","nearest","indexSampler","dataSample","sampler","_dimList","addAxis","_dataCoordConvert","input","dimList","axisX","axisY","reserved","xAxisExtent","yAxisExtent","Axis2D","coordExtent","nameRotate","nameTruncate","nameTextStyle","nameGap","axisDefault","logBase","AXIS_TYPES","axisModelCreator","BaseAxisModelClass","axisTypeDefaulter","extraDefaultOption","__ordinalMeta","AxisModel","gridIndex","gridId","extraOption","containLabel","each$6","niceScaleExtent$1","gridProto","_updateScale","ignoreContainLabel","adjustAxes","axesList","gridRect","labelUnionRect","axesMapOnDim","xAxisIndex","yAxisIndex","coordList","getCartesians","_findConvertTarget","coordsList","createAxisCreator","axisPositionUsed","axesCount","axesModels","grids","dumbGroup","hasBuilder","builders","getGroup","arrows","arrowSize","arrowOffset","symbolWidth","symbolHeight","axisTickLabel","gapSignal","nameRotation","truncateOpt","truncatedText","formatterParams","__fullText","__truncatedText","axisRotation","ifIgnoreOnTick","rawTick","axisPointerClazz","registerAxisPointerClass","axisBuilderAttrs","selfBuilderAttrs","CartesianAxisView","oldAxisGroup","_axisGroup","_splitLine","splitLineModel","lineColors","lineInterval","lineCount","colorIndex","_splitArea","splitAreaModel","areaColors","areaInterval","BaseBarSeries","offsetIndex","barItemStyle","coordinateSystemType","_render","isHorizontalOrRadial","elementCreator","animateProperty","animateTarget","isRadial","sectorShape","fixedLineWidth","signX","signY","createListSimply","dimensionsInfo","selectableMixin","updateSelectedMap","_targetList","_selectTargetMap","targetMap","select","selectedMode","unSelect","toggleSelected","PieSeries","_createSelectableList","_defaultLabelLine","labelLineNormalOpt","labelLineEmphasisOpt","minAngle","hoverOffset","avoidLabelOverlap","percentPrecision","stillShowZeroSum","animationType","piePieceProto","firstCreate","_updateLabel","labelText","labelHoverModel","labelLineHoverModel","createDataSelectAction","sectorGroup","_sectorGroup","isFirstRender","onSectorClick","piePiece","_createClipPath","actionInfos","dataColor","paletteScope","seiresModelMap","__paletteScope","dataAll","idxMap","filteredIdx","singleDataColor","hasLabelRotate","labelLineLen2","PI2$4","pieLayout","validDataCount","unitRadian","roseType","restAngle","valueSumLargerThanMinAngle","currentAngle","dataFilter","legendModels","largeThreshold","BOOST_SIZE_THRESHOLD","LargeSymbolPath","symbolProxy","symbolProxyShape","canBoost","findDataIndex","largeSymbolProto","_incremental","_setCommon","endIndex","byteOffset","_clearIncremental","isIncremental","extrudeShadow","_updateSymbolDraw","_finished","isLargeDraw","_isLargeDraw","getIndicatorAxes","indicatorIndex","closestAxis","minRadianDiff","closestAxisIdx","coodToData","viewSize","increaseInterval","indicatorAxes","radarSeries","fixedMin","fixedMax","nicedSplitNumber","halfSplitNumber","radarList","valueAxisDefault","axisBuilderAttrs$1","showName","nameFormatter","indicatorModels","indicatorOpt","iNameTextStyle","indName","indicator","_buildAxes","_buildSplitLineAndArea","axisBuilders","getColorIndex","areaOrLine","areaOrLineColorList","showSplitLine","showSplitArea","splitLineColors","splitAreaColors","splitLines","splitAreas","ticksRadius","realSplitNumber","axesTicksPoints","prevPoints","RadarSeries","radarIndex","createSymbol$$1","updateSymbols","oldPoints","newPoints","symbolGroup","__dimIdx","getInitialPoints","hoverPolygonIgnore","polygonIgnore","hoverAreaStyleModel","itemHoverStyle","radarLayout","pointsConverter","backwardCompat$1","polarOptArr","polarNotRadar","polarOpt","polarIndex","v2ApplyTransform$1","_viewRect","rawTransform","_updateTransform","centerCoord","_updateCenterAndZoom","getDefaultCenter","rawRect","getRoamTransform","rawTransformMatrix","roamTransform","defaultCenter","roamTransformable","rawTransformable","_rawTransform","getViewRectAfterRoam","noRoam","points$1","i$1","fixNanhai","coordsOffsetMap","","","","","","fixTextCoord","coordFix","geoCoordMap","Russia","United States","United States of America","fixGeoCoord","points$2","fixDiaoyuIsland","geoFixFuncs","containCoord","regionsMap","regionName","specialArea","_regionsMap","fixFunc","getRegion","getRegionByCoord","getGeoCoord","regionRect","mapNotExistsError","geoCreator","geoList","mapData","geoIndex","mapModelGroupBySeries","getHostGeoModel","mapType","getMapType","mapSeries","nameMapList","singleMapSeries","getFilledRegions","originRegionArr","regionsArr","MapSeries","needsDrawMap","seriesGroup","_fillOption","getRegionModel","seriesNames","otherIndex","showLegendSymbol","dataRangeHoverLink","scaleLimit","isGeo","groupNewProp","itemStyleAccessPath","hoverItemStyleAccessPath","labelAccessPath","hoverLabelAccessPath","regionGroup","compoundPath","regionModel","hoverItemStyleModel","showLabel","hoverShowLabel","isDataNaN","groupRegions","_updateController","makeActionBase","mapModel","_mapDraw","_renderSymbols","fullData","mainSeries","fullIndex","polygonGroups","normalText","emphasisText","__mapOriginalZ2","mapSymbolLayout","processedMapType","mapSymbolOffsets","subMapSeries","mapVisual","colorList","mapDataStatistic","seriesGroups","hostGeoModel","seriesList","backwardCompat$2","mapLocation","TreeNode","hostTree","suppressVisitSub","updateDepthAndHeight","includeSelf","ancestors","levelModel","getLevelModel","getLeavesModel","getNodeByName","clearLayouts","createTree","dataRoot","treeOptions","buildHierarchy","dimMax","listData","leaves","treeOption","treeDepth","expandAndCollapse","expandTreeDepth","initialTreeDepth","collapsed","_oldTree","_mainGroup","commonLayout","separation$$1","coorX","coorY","finalCoor","orthogonalLayout","radialLayout","_viewRoot","clipWindow","drillDownIcon","roam","nodeClick","emptyItemWidth","upperLabel","gapWidth","visualDimension","resetViewRoot","setLayoutInfo","idIndexMap","_idIndexMap","_idIndexMapCount","getViewRoot","TEXT_PADDING","ITEM_GAP","onSelect","normalStyleModel","layoutParam","totalWidth","renderList","_prepare","_renderContent","lastX","availableSize","onclick","bind$1","each$9","DRAG_THRESHOLD","_containerGroup","_breadcrumb","_state","rootNodeGroup","_giveContainerGroup","renderResult","_doRender","renderFinally","_doAnimation","_resetController","_renderBreadcrumb","dualTravel","oldViewChildren","sameTree","processNode","doRenderNode","clearStorage","willDeleteEls","delEls","__tmWillDelete","els","thisTree","oldTree","animationWrap","targetX","targetY","_onPan","_onZoom","_clearController","findTarget","_rootToNode","_zoomToNode","link","linkTarget","open","bgEl","noop$1","actionTypes","i$2","handleRootToNode","originViewRoot","isObject$5","_normalizeData","normalizers","visualHandler","getColorMapper","getNormalizer","isNormalized","returnRGBArray","colorHue","colorLightness","symbolCfg","listVisualTypes","addVisualHandler","eachVisual","isPrimary","newVisual","retrieveVisuals","hasVisual","type1","type2","dependsOn","visualType1","visualType2","findClosestWhenOutside","updatePossible","newAbs","possibleI","pieceValue","treemapVisual","retrieveValue","treemapLayout","rootSize","viewRootLayout","treeRoot","Graph","directed","_directed","_nodesMap","_edgesMap","graphProto","isDirected","addNode","nodesMap","getNodeByIndex","addEdge","edgesMap","getEdgeByIndex","getEdge","breadthFirstTraverse","startNode","__visited","queue","currentNode","otherNode","inDegree","outDegree","createGraphDataProxyMixin","hostName","createGraphFromNodeEdge","beforeLink","linkNameList","validEdges","linkCount","coordSysCtor","GraphSeries","_categoriesData","_updateCategoriesData","edgeGetParent","fakeSeriesModel","categoriesModels","_categoriesModels","categoryIdx","categoryModel","edgeLabelModel","getEdgeData","getCategoriesData","sourceName","targetName","html","categoriesData","focusNodeAdjacency","circular","rotateLabel","initLayout","repulsion","edgeLength","layoutAnimation","edgeSymbol","edgeSymbolSize","edgeLabel","nodeScaleRatio","straightLineProto","bezierCurveProto","SYMBOL_CATEGORIES","lineProto","_updateCommonStl","visualOpacity","defaultLabelColor","rawVal","labelStyle","linePath","lineDrawProto","_lineData","adjustEdge","tmp0","quadraticSubdivide$$1","pts2","fromSymbol","toSymbol","__original","originalPoints","nodeOpacityPath","lineOpacityPath","_lineDraw","_firstRender","_nodeScaleRatio","_getNodeGlobalScale","_updateNodeAndLinkScale","_layoutTimeout","forceLayout","_startForceLayoutIteration","_layouting","__focusNodeAdjacency","__unfocusNodeAdjacency","edgeDataIndex","circularRotateLabel","adjacentEdge","unfocusNodeAdjacency","stopped","nodeScale","groupScale","groupZoom","roamZoom","categoryFilter","graphSeries","categoryNames","categoryVisual","categoryNameIdxMap","edgeVisual","colorQuery","opacityQuery","simpleLayout","circularLayout","preservedPoints","forceModel","nodeDataExtent","edgeDataExtent","forceInstance","oldStep","createView","positions","bbWidth","bbHeight","viewCoordSys","PointerPath","PI2$5","FunnelSeries","posInfo","_renderMain","axisLineModel","angleRangeSpan","prevEndAngle","axisLineWidth","getColor","_renderTicks","_renderPointer","_renderTitle","_renderDetail","minVal","maxVal","subSplitNumber","splitLineLen","subStep","splitLineStyle","tickLineStyle","tickLine","valueExtent","titleModel","detailModel","minSize","funnelAlign","funnelPieceProto","opacityAccessPath","funnelLayout","funnelPiece","getLinePoints","offY","parallelPreprocessor","ParallelAxis","sliderMove","minSpan","maxSpan","extentSpan","originalDistSign","extentMinSpan","realExtent","currDistSign","each$12","mathFloor$2","mathCeil$2","round$2","PI$3","_updateAxesFromSeries","_makeLayoutInfo","axisBase","layoutBase","pixelDimIndex","pAxis","pLayout","_layoutAxes","winSize","layoutExtent","axisExpandCount","axisExpandable","axisExpandCenter","positionTable","rotationTable","axisCoordToPoint","eachActiveState","dataDimensions","hasActiveSet","hasAxisBrushed","activeState","getActiveState","axisLayout","getAxisLayout","getSlidedAxisExpandWindow","behavior","pointCoord","triggerArea","useJump","AxisModel$2","getAreaSelectStyle","setActiveIntervals","intervals","defaultOption$1","areaSelectStyle","realtime","axisExpandRate","axisExpandDebounce","axisExpandSlideTriggerArea","axisExpandTriggerOn","_initDimensions","setAxisExpand","axisModels","actionInfo$1","parallelAxisModel","ne","sw","nw","se","panelOpts","enableGlobalPan","eachCover","brushOptionList","tmpIdPrefix","oldGetKey","addOrUpdate","newBrushOption","oldCovers","newCovers","unmount","elementList","AxisView$2","areaWidth","builderOpt","_refreshBrushController","extentLen","coverInfoList","coverInfo","parallelAxisId","CLICK_THRESHOLD","handlers","_throttledDispatchExpand","_dispatchExpand","_mouseDownPoint","mouseDownPoint","getRawIndicesByActiveState","theActiveState","inactiveOpacity","activeOpacity","SMOOTH","opacityAccessPath$1","_dataGroup","_renderForNormal","newDataIndex","oldDataIndex","parallelVisual","globalColors","opacityMap","active","inactive","itemOpacity","SankeySeries","rawDataOpt","layoutIterations","SankeyShape","halfExtent","curve","n1Layout","n2Layout","edgeLayout","sankeyLayout","filteredNodes","sankeyVisual","minValue","mapValueToColor","customColor","WhiskerPath","whiskerBoxProto","whiskerBoxDrawProto","seriesModelMixin","_baseAxisDim","addOrdinal","xAxisType","yAxisType","baseAxisDimIndex","baseAxisType","otherAxisType","newOptionData","newItem","defaultValueDimensions","viewMixin","whiskerBoxDraw","_whiskerBoxDraw","getStyleUpdater","BoxplotSeries","BoxplotView","borderColorQuery","boxplotVisual","defaulColor","boxplotLayout","groupResult","CandlestickSeries","animationUpdate","getShadowDim","brushRect","CandlestickView","preprocessor","seriesItem","positiveBorderColorQuery","negativeBorderColorQuery","positiveColorQuery","negativeColorQuery","candlestickVisual","candlestickLayout","candleWidth","makeBrushRect","pmin","openVal","closeVal","lowestVal","highestVal","pmax","subPixelOptimizePoint","ocLow","ocHigh","ocLowPoint","ocHighPoint","lowestPoint","highestPoint","effectType","showEffectOn","rippleEffect","period","EFFECT_RIPPLE_NUMBER","effectSymbolProto","stopEffectAnimation","startEffectAnimation","effectOffset","rippleScale","updateEffectAnimation","oldEffectCfg","_effectCfg","DIFFICULT_PROPS","effectSymbolDraw","_updateGroupTransform","globalObj$1","Uint32Arr","Float64Arr","LinesSeries","_processFlatCoordsArray","_flatCoords","flatCoords","_flatCoordsOffset","flatCoordsOffset","_getCoordsFromItemModel","getLineCoordsCount","getLineCoords","startOffset","coordsOffsetAndLenStorage","coordsStorage","coordsCursor","offsetCursor","CoordSys","effect","constantSpeed","trailLength","effectLineProto","effectModel","_updateEffectAnimation","delayExpr","isDelayFunc","updateAnimationPoints","getLineLength","_period","__t","updateSymbolPosition","__p1","__cp1","__p2","quadraticDerivativeAt$$1","polylineProto","effectPolylineProto","accLenArr","_offsets","_length","offsets","LargeLineShape","largeLineProto","lineEl","linesLayout","lineCoords","isLarge","isPolyline","totalCoordsCount","_updateLineDraw","isSvg","_lastZlevel","_showEffect","notInIndividual","otherSeriesModel","hasEffect","_hasEffet","_isPolyline","linesVisual","GRADIENT_LEVELS","colorFunc","isInRange","_getBrush","gradientInRange","_getGradient","gradientOutOfRange","imageData","getImageData","pixels","pixelLen","diffOpacity","gradientOffset","putImageData","brushCanvas","_brushCanvas","gradientPixels","pixelsSingleState","Uint8ClampedArray","visualMapOfThisSeries","eachTargetSeries","targetSeries","_incrementalDisplayable","_renderOnCartesianAndCalendar","_renderOnGeo","itemStyleQuery","hoverItemStyleQuery","labelQuery","hoverLabelQuery","dataToRect","contentShape","inRangeVisuals","inRange","outOfRangeVisuals","outOfRange","hmLayer","_hmLayer","lng","lat","getPieceList","PictorialBarSeries","LAYOUT_ATTRS","coordSysRect","pictorialShapeStr","SingleAxis","_adjustAxis","_updateAxisTransform","extentSum","getInterval$2","ifIgnoreOnTick$2","axisBuilderAttrs$2","selfBuilderAttr","SingleAxisView","AxisModel$4","defaultOption$2","findPointFromSeries","curry$3","axisTrigger","isIllegalPoint","shouldHide","coordSysContainsPoint","linkTriggers","tarAxisInfo","tarKey","srcAxisInfo","srcKey","srcValItem","shadowStyle","handle","AxisPointerView","clone$4","bind$2","_group","_lastGraphicKey","_handle","_lastValue","_lastStatus","_payloadInfo","_axisModel","_axisPointerModel","makeElOption","graphicKey","_moveAnimation","determineAnimation","doUpdateProps","updatePointerEl","updateLabelEl","createPointerEl","createLabelEl","_renderHandle","useSnap","pointerOption","pointerEl","updateProps$$1","updateHandleTransform","handleModel","onmousedown","_onHandleDragMove","_onHandleDragEnd","includeStyles","_moveHandleToValue","getHandleTransform","_doDispatchAxisPointer","cursorPoint","doClear","buildLabel","CartesianAxisPointer","pixelValue","pointerShapeBuilder","currPosition","cursorOtherValue","tooltipOptions","shadow","SingleAxisPointer","pointerShapeBuilder$1","DATA_NAME_INDEX","ThemeRiverSeries","fixData","rawDataLength","dataByName","layData","dataList","largestLayer","timeValue","keyIndex","filterData","comparer","index1","index2","lenCount","indexArr","nearestIdx","theValue","htmlName","htmlValue","singleAxisIndex","keyGetter","process","oldLayersGroups","points0","layerGroup","newLayersGroups","_layersSeries","themeRiverLayout","themeRiverVisual","highlightPolicy","renderLabelForZeroData","DESCENDANT","SunburstPieceProto","_ecModel","stateStyle","that","onHighlight","onDownplay","getLabelAttr","stateAttr","labelMinAngle","labelPadding","rotateType","ROOT_TO_NODE_ACTION","ROOT_TO_NODE_ACTION$1","newId","oldId","newNode","renderRollUp","_onclickEvent","newRoot","_oldChildren","unhighlight","targetFound","HIGHLIGHT_ACTION","handleHighlight","UNHIGHLIGHT_ACTION","handleUnhighlight","RADIAN$1","sunburstLayout","rootDepth","renderRollupNode","rPerLevel","rStart","rEnd","siblingAngle","prepareCartesian2d","prepareGeo","prepareSingleAxis","preparePolar","prepareCalendar","rangeInfo","getRangeInfo","cellWidth","getCellWidth","cellHeight","getCellHeight","weeks","dayCount","allDay","setIncrementalAndHoverLayer","graphicOption","elements","GraphicModel","_elOptionsToUpdate","flattenedList","_flatten","mappingResult","elOptionsToUpdate","optionList","useElOptionsToUpdate","_elMap","_lastGraphicModel","graphicModel","_clear","_updateElements","_relocate","rootGroup","elOptionCleaned","__ecGraphicWidth","__ecGraphicHeight","elOptions","parentEl","containerInfo","bounding","LegendModel","_updateData","hasSelected","potentialData","availableNames","isPotential","_availableNames","borderRadius","itemGap","inactiveColor","curry$4","each$17","Group$3","LegendView","newlineDisabled","_contentGroup","_backgroundEl","getContentGroup","resetInner","renderInner","mainRect","layoutInner","layoutRect","contentGroup","legendDrawnMap","selectMode","legendSymbolType","_createItem","itemIcon","legendGlobalTooltipModel","hitRect","legendIndex","__legendDataIndex","contentRect","legendFilter","ScrollableLegendModel","setScrollDataIndex","scrollDataIndex","pageButtonItemGap","pageButtonGap","pageButtonPosition","pageFormatter","pageIcons","pageIconColor","pageIconInactiveColor","pageIconSize","pageTextStyle","Group$4","WH$1","XY$1","ScrollableLegendView","_currentIndex","_controllerGroup","_showController","__rectSize","createPageButton","iconIdx","pageDataIndexName","me","_pageGo","controllerGroup","pageTextStyleModel","orientIdx","hw","yx","controllerRect","showController","contentPos","containerPos","controllerPos","pageInfo","_getPageInfo","pageIndex","contentPosition","_updatePageInfoView","legendId","canJump","pageText","pageCount","getItemRect","itemRect","pagePrevDataIndex","pageNextDataIndex","targetItemGroup","currDataIndex","containerRectSize","itemLoc","winRect","startIdx","startItem","startRect","showContent","alwaysShowContent","displayMode","confine","showDelay","hideDelay","enterable","gCssText","currentStyle","setContent","setEnterable","viewportRootOffset","bind$3","each$18","parsePercent$2","proxyRect","tooltipContent","_tooltipContent","_tooltipModel","_lastDataByCoordSys","_alwaysShowContent","_initGlobalListener","_keepShow","_tryShow","_hide","_refreshUpdateTimeout","manuallyShowTip","_ticket","_manuallyAxisShowTip","pointInfo","manuallyHideTip","_showAxisTooltip","_showSeriesItemTooltip","_showComponentItemTooltip","_showOrMove","_showTimout","singleDefaultHTML","singleParamsList","singleTooltipModel","itemCoordSys","axisValue","seriesDefaultHTML","valueLabel","axisValueLabel","positionExpr","_updateContentNotChangedOnAxis","_updatePosition","_showTooltipContent","tooltipTrigger","defaultHtml","asyncTicket","subTooltipModel","cbTicket","vAlign","lastCoordSys","contentNotChanged","lastItemCoordSys","indexCoordSys","lastDataByAxis","thisItemCoordSys","thisDataByAxis","lastItem","indexAxis","lastIndices","lastIdxItem","newIdxItem","radiusToData","angleToData","Polar","_radiusAxis","_angleAxis","pointToCoord","maxAngle","PolarAxisModel","polarId","polarAxisDefaultExtendedOption","foundAxisModel","polarCreator","polarList","elementList$1","ticksAngles","_axisLine","_axisTick","tickAngle","_axisLabel","labelsAngles","labelTextAlign","labelTextVerticalAlign","prevAngle","axisBuilderAttrs$3","selfBuilderAttrs$1","prevRadius","PolarAxisPointer","coordValue","pointerShapeBuilder$2","GeoModel","_optionModelMap","optionModelMap","regionOpt","DEFAULT_TOOLBOX_BTNS","preprocessor$1","brushComponents","brushComponentSpecifiedBtns","brushOpt","tbs","toolboxFeature","toolboxBrush","brushTypes","curry$5","COORD_CONVERTS","proto$2","setOutputRanges","matchOutputRanges","coordRange","coordRanges","coordConvert","__rangeOffset","diffProcessor","findTargetInfo","coordSyses","setInputRanges","rangeOffset","getDefaultBrushType","getPanelRect","controlSeries","areaPanelId","targetInfoMatchers","xAxisModels","yAxisModels","gridModels","gridModelMap","xAxesHas","yAxesHas","cartesians","panelRectBuilder","geoModels","xminymin","xmaxymax","STATE_LIST","PRIORITY_BRUSH","setBrushOption","brushIndex","linkOthers","brushLink","linkedSeriesMap","brushed","stepAParallel","hasBrushExists","selectedDataIndexForLink","stepAOthers","thisBrushSelected","brushId","brushName","rangeInfoBySeries","boundingRectBuilders","seriesBrushSelected","rg","DEFAULT_OUT_OF_BRUSH_COLOR","coordInfoList","inBrush","outOfBrush","setAreas","modelId","brushLang","proto$3","isBrushed","getIcons","availableIcons","icons","command","PROXIMATE_ONE_DAY","_rangeInfo","_sw","_sh","_orient","getFirstDayOfWeek","_firstDayOfWeek","getDateInfo","day","getDay","formatedDate","getNextNDay","setDate","cellSizeSpecified","_lineWidth","_getRangeInfo","_initRangeOption","whNames","layoutParams","cellNumbers","whGlobal","calendarRect","dayInfo","week","nthWeek","pointToDate","tl","tr","br","bl","nthX","nthY","_getDateByWeeksAndDay","firstDay","setMonth","reversed","startDateNum","endDateNum","fweek","lweek","nthDay","calendarList","calendarSeries","CalendarModel","dayLabel","monthLabel","yearLabel","MONTH_TEXT","EN","CN","WEEK_TEXT","_tlpoints","_blpoints","_firstDayOfMonth","_firstDayPoints","rangeData","_renderDayRect","_renderLines","_renderYearText","_renderMonthText","_renderWeekText","itemRectStyleModel","sh","addPoints","_getLinePointsOfOneWeek","_drawSplitline","_getEdgesPoints","rs","poyline","tmpD","_formatterLabel","_yearTextPositionControl","aligns","xc","yc","posPoints","yearText","_monthTextPositionControl","isCenter","termPoints","firstDayPoints","yyyy","yy","MM","monthText","_weekTextPositionControl","isStart","firstDayOfWeek","weekText","subtext","subtarget","subtextStyle","subtextStyleModel","subText","subTextEl","sublink","groupRect","layoutOption","alignStyle","AXIS_DIMS","eachAxisDim$1","asc$1","AxisProxy","_dimName","_axisIndex","hostedBy","getDataValueWindow","getDataPercentWindow","getTargetSeriesModels","getOtherAxisModel","coordSysIndexName","isCartesian","foundOtherAxisModel","otherAxisModel","getMinMaxSpan","calculateDataWindow","getRangePropMode","percentExtent","boundValue","boundPercent","dataWindow","isInWindow","filterMode","leftOut","rightOut","thisHasValue","thisLeftOut","thisRightOut","eachAxisDim","DataZoomModel","startValue","endValue","minValueSpan","maxValueSpan","rangeMode","_dataIntervalByAxis","_dataInfo","_axisProxies","_autoThrottle","doInit","_setDefaultThrottle","_resetTarget","_giveAxisProxies","axisProxies","eachTargetAxis","dimNames","__dzAxisProxy","autoMode","_judgeAutoMode","axisIndexName","_autoSetAxisIndex","_autoSetOrient","hasIndexSpecified","autoAxisIndex","axisIndices","_isSeriesHasAllAxesTypeOf","is","seriesAxisIndex","globalOption","getFirstTargetAxisModel","firstAxisModel","getAxisProxy","setRawRange","ignoreUpdateRangeUsg","findRepresentativeAxisProxy","getValueRange","axisDimName","DataZoomView","getTargetCoordInfo","coordIndex","coordSysLists","Rect$2","dataBackground","fillerColor","handleIcon","handleStyle","labelPrecision","showDetail","showDataShadow","linearMap$2","asc$2","bind$4","each$24","DEFAULT_LOCATION_EDGE_GAP","DEFAULT_FRAME_BORDER_WIDTH","DEFAULT_FILLER_SIZE","HORIZONTAL","VERTICAL","LABEL_GAP","SHOW_DATA_SHADOW_SERIES_TYPE","SliderZoomView","_range","_handleEnds","_size","_handleWidth","_handleHeight","_location","_dataShadowInfo","_buildView","_updateView","_resetLocation","_resetInterval","barGroup","_renderBackground","_renderDataShadow","_positionGroup","coordRect","_findCoordRect","location","targetAxisModel","otherAxisInverse","_getViewExtent","_onClickPanelClick","_prepareDataShadowInfo","otherDataExtent","otherOffset","lastIsEmpty","otherShadowExtent","thisShadowExtent","areaPoints","thisCoord","stride","otherCoord","thisAxis","displaybles","handles","handleLabels","filler","_onDragMove","ondragstart","_showDataInfo","_onDragEnd","onmouseover","onmouseout","bRect","handleColor","viewExtent","_updateInterval","viewExtend","nonRealtime","handleInterval","handleHeight","_updateDataInfo","barTransform","textPoint","orderedHandleEnds","labelTexts","dataInterval","_formatLabel","valueStr","showOrHide","_dispatchZoomAction","localPoint","bind$5","InsideZoomView","coordInfo","dataZoomOption","directionInfo","getDirectionInfo","percentDelta","signal","pixel","pixelLength","percentPoint","pixelStart","oldPoint","newPoint","seriesModelMap","valueRange","linkedNodesFinder","effectedModels","each$25","preprocessor$2","pieces","splitList","calculable","VISUAL_PRIORITY","isTargetSeries","getDataDimension","getVisualMeta","concreteDim","visualDefault","defaultOption$3","mapVisual$2","isArray$3","each$26","asc$3","linearMap$3","noop$2","VisualMapModel","replacableOptionKeys","dataBound","contentColor","textGap","controllerVisuals","resetItemSize","completeVisualOption","resetVisual","getTargetSeriesIndices","optionSeriesIndex","formatValueText","edgeSymbols","isMinMax","textValue","resetExtent","optDim","listDimensions","completeSingle","defa","completeInactive","stateExist","stateAbsent","optExist","optAbsent","completeController","symbolExists","symbolSizeExists","setSelected","DEFAULT_BAR_BOUND","ContinuousModel","hoverLink","_resetRange","auto","getSelected","findTargetDataIndices","setStop","oVals","iVals","iIdx","oIdx","iLen","oLen","first","stopsLen","VisualMapView","autoPositionValues","doRender","getControllerVisual","targetValue","visualCluster","visualObj","forceState","visualMapping","convertOpacityToAlpha","positionGroup","each$27","ContinuousView","_shapes","_dataInterval","_useHandle","_hoverLinkDataIndices","_hovering","_renderBar","dataRangeText","_renderEndsText","_enableHoverLinkToSeries","_enableHoverLinkFromSeries","endsIndex","_applyTransform","targetGroup","shapes","_createBarGroup","_dragHandle","handleThumbs","handleLabelPoints","_createHandle","_createIndicator","handleThumb","handleLabel","handleLabelPoint","indicatorLabel","indicatorLabelPoint","visualMapId","_clearHoverLinkToSeries","_doHoverLinkToSeries","forSketch","outOfRangeHandleEnds","inRangeHandleEnds","visualInRange","_createBarVisual","visualOutOfRange","barColor","barPoints","_updateHandle","_makeColorGradient","symbolSizes","_createBarPoints","handlesColor","sampleNumber","currValue","_showIndicator","cursorValue","rangeSymbol","_hoverLinkFromSeriesMouseOver","_hideIndicator","_clearHoverLinkFromSeries","cursorPos","hoverOnBar","hoverRange","oldBatch","newBatch","resultBatches","_dispatchHighDown","actionInfo$2","PiecewiseModel","minOpen","maxOpen","itemSymbol","_pieceList","mode","_mode","_determineMode","resetMethods","_resetSelected","visualTypesInPieces","getSelectedMapKey","hasSel","pIdx","getRepresentValue","representValue","pieceInterval","splitStep","pieceListItem","closeList","infinityList","useMinMax","_onItemClick","_enableHoverLink","indexInModelPieceList","_createItemSymbol","visualState","_getItemAlign","viewData","_getViewData","endsText","viewPieceList","onHoverLink","shapeParam","newKey","addCommas$1","encodeHTML$1","MarkerModel","createdBySelf","hostSeries","__hostSeries","newOpt","modelPropName","markerOpt","markerModel","curry$7","MarkerView","markerGroupMap","__keep","markerModelKey","markPointModel","symbolDrawMap","mlFrom","mlTo","markLineModel","__to","updateDataVisualAndLayout","lineDrawMap","lineColor","fromSymbolSize","toSymbolSize","retrieve$$1","ltCoord","rbCoord","dimPermutations","markAreaModel","areaGroupMap","polygonGroup","__data","preprocessor$3","currentIndex","setCurrentIndex","isIndexMax","setPlayState","playState","TimelineModel","autoPlay","rewind","playInterval","_names","_initData","getPlayState","dataArr","idxArr","SliderTimelineModel","checkpointStyle","showPlayBtn","showPrevBtn","showNextBtn","playIcon","stopIcon","nextIcon","prevIcon","TimelineView","TimelineAxis","_autoLabelInterval","bind$6","each$28","PI$4","_timer","_currentPointer","_labelGroup","mainGroup","_createGroup","labelGroup","_createAxis","_renderAxisLabel","_position","_doPlayStop","_clearTimer","labelPosOpt","labelAlignMap","labelBaselineMap","rotationMap","mainLength","controlModel","showControl","controlSize","controlGap","sizePlusGap","playPosition","prevBtnPosition","nextBtnPosition","labelAlign","labelBaseline","setOrigin","viewBound","getBound","toBound","boundIdx","rotateOriginX","rotateOriginY","mainBound","labelBound","mainPosition","labelsPosition","mainBoundIdx","_customizeScale","newGroup","_renderAxisLine","_renderAxisTick","hoverStyleModel","symbolOpt","_changeTimeline","_renderControl","makeBtn","iconPath","willRotate","btn","_handlePlayClick","_renderCurrentPointer","_handlePointerDrag","_handlePointerDragend","nextState","_pointerChangeTimeline","mousePos","_toAxisCoord","targetDataIndex","_findNearestTick","handleFrame","axisCoord","nextIndex","ToolboxModel","Feature","showTitle","toolboxModel","processFeature","featureNames","oldName","featureOpts","unusable","createIconPaths","iconName","iconPaths","iconStatus","iconStyleModel","iconStyleEmphasisModel","titles","__title","_features","_featureNames","titleText","needPutOnTop","topOffset","saveAsImageLang","proto$4","$a","download","href","MouseEvent","msSaveOrOpenBlob","bstr","atob","u8arr","Uint8Array","blob","Blob","lang$$1","tab","write","evt","bubbles","cancelable","dispatchEvent","magicTypeLang","proto$5","seriesOptGenreator","radioTypes","generateNewSeriesTypes","newSeriesOpt","radio","currentType","dataViewLang","readOnly","optionToContent","contentToOption","textareaColor","textareaBorderColor","buttonColor","buttonTextColor","viewMain","textarea","htmlOrDom","buttonContainer","buttonStyle","closeButton","refreshButton","keyCode","selectionStart","selectionEnd","newSeriesOptList","dataZoomLang","each$29","DATA_ZOOM_ID_BASE","proto$6","handlers$1","nextActive","setBatch","findDataZoom","found","dzModel","addForAxis","dataZoomOpt","axisIndicesName","givenAxisIndices","forEachComponent","$fromToolbox","dataZoomOpts","restoreLang","proto$7","urn","win","namespaces","zrvml","CMD$3","round$3","abs$1","mathMax$8","comma","imageTransformPrefix","Z2","ZLEVEL_BASE","Z_BASE$1","initRootElStyle","coordsize","coordorigin","encodeHtmlAttribute","rgb2Str","append","getZIndex","parsePercent$3","setColorAndOpacity","getColorAndAlpha","updateFillNode","zrEl","gradientType","focus","expansion","cs1","cs2","length$$1","colorAndAlphaList","colorAndAlpha","color1","color2","opacity1","opacity2","focusposition","updateStrokeNode","dashstyle","updateFillAndStroke","vmlEl","isFill","getElementsByTagName","points$3","pathDataToString","brushVML","_vmlEl","needTransform","strokeEl","weight","zIndex","removeRectText","appendRectText","isImage","ow","oh","_imageSrc","_imageWidth","_imageHeight","imageRuntimeStyle","runtimeStyle","oldRuntimeWidth","oldRuntimeHeight","dw","dh","hasCrop","vmlElStyle","hasRotation","transformFilter","imageEl","_imageEl","cropEl","_cropEl","imageELStyle","tmpImage","overflow","cropElStyle","filterStr","textMeasureEl","DEFAULT_STYLE_NORMAL","fontStyleCache","fontStyleCacheCount","MAX_FONT_CACHE_SIZE","fontEl","getFontStyle","fontString","variant","fontVariant","family","doc$$1","body","ex","createTextNode","offsetWidth","tmpRect$2","fromTextEl","textPathEl","skewEl","createNode$$1","textVmlEl","_textVmlEl","textpathok","textVmlElStyle","string","i$3","proto$8","__alreadyNotVisible","_getWidth","_getHeight","vmlViewportStyle","pathStr","svgTextDrawRectText","HTMLImageElement","__imageSrc","tmpRect$3","textSvgEl","nTextLines","textAnchor","__text","__textFont","tspanList","__tspanList","tspan","execEditLength","diagonalPath","editLength","basePath","addPath","bestPath","removePath","canAdd","newLen","canRemove","oldLen","pushComponent","extractCommon","maxEditLength","commonCount","tokenize","arrayDiff","arrayDiff$1","MARK_UNUSED","MARK_USED","getDefs","isForceCreating","defs","addDom","removeDom","getDoms","doms","tags","markAllUnused","markUsed","removeUnused","addWithoutUpdate","svgElement","updateDom","clipPathEl","svgProxy","cloneNode","_textDom","_shadowDom","_shadowDomId","domChild","blur","stdDx","stdDy","stdDeviation","SVGPainter","gradientManager","clipPathManager","shadowManager","viewport","_viewport","_visibleList","visibleList","listLen","newVisibleList","prevSvgElement","textSvgElement","_getDefs","viewportStyle","outerHTML","parseGeoJSON","util"],"mappings":"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","file":"echarts.js","sourcesContent":["(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n\ttypeof define === 'function' && define.amd ? define(['exports'], factory) :\n\t(factory((global.echarts = {})));\n}(this, (function (exports) { 'use strict';\n\n// (1) The code `if (__DEV__) ...` can be removed by build tool.\n// (2) If intend to use `__DEV__`, this module should be imported. Use a global\n// variable `__DEV__` may cause that miss the declaration (see #6535), or the\n// declaration is behind of the using position (for example in `Model.extent`,\n// And tools like rollup can not analysis the dependency if not import).\n\nvar dev;\n\n// In browser\nif (typeof window !== 'undefined') {\n    dev = window.__DEV__;\n}\n// In node\nelse if (typeof global !== 'undefined') {\n    dev = global.__DEV__;\n}\n\nif (typeof dev === 'undefined') {\n    dev = true;\n}\n\nvar __DEV__ = dev;\n\n/**\n * zrender: id\n *\n * @author errorrik (errorrik@gmail.com)\n */\n\nvar idStart = 0x0907;\n\nvar guid = function () {\n    return idStart++;\n};\n\n/**\n * echarts\n *\n * @desc echartsCanvasJavascript\n * @author firede[firede@firede.us]\n * @desc thanks zepto.\n */\n\nvar env = {};\n\nif (typeof wx !== 'undefined') {\n    // In Weixin Application\n    env = {\n        browser: {},\n        os: {},\n        node: false,\n        wxa: true, // Weixin Application\n        canvasSupported: true,\n        svgSupported: false,\n        touchEventsSupported: true\n    };\n}\nelse if (typeof document === 'undefined' && typeof self !== 'undefined') {\n    // In worker\n    env = {\n        browser: {},\n        os: {},\n        node: false,\n        worker: true,\n        canvasSupported: true\n    };\n}\nelse if (typeof navigator === 'undefined') {\n    // In node\n    env = {\n        browser: {},\n        os: {},\n        node: true,\n        worker: false,\n        // Assume canvas is supported\n        canvasSupported: true,\n        svgSupported: true\n    };\n}\nelse {\n    env = detect(navigator.userAgent);\n}\n\nvar env$1 = env;\n\n// Zepto.js\n// (c) 2010-2013 Thomas Fuchs\n// Zepto.js may be freely distributed under the MIT license.\n\nfunction detect(ua) {\n    var os = {};\n    var browser = {};\n    // var webkit = ua.match(/Web[kK]it[\\/]{0,1}([\\d.]+)/);\n    // var android = ua.match(/(Android);?[\\s\\/]+([\\d.]+)?/);\n    // var ipad = ua.match(/(iPad).*OS\\s([\\d_]+)/);\n    // var ipod = ua.match(/(iPod)(.*OS\\s([\\d_]+))?/);\n    // var iphone = !ipad && ua.match(/(iPhone\\sOS)\\s([\\d_]+)/);\n    // var webos = ua.match(/(webOS|hpwOS)[\\s\\/]([\\d.]+)/);\n    // var touchpad = webos && ua.match(/TouchPad/);\n    // var kindle = ua.match(/Kindle\\/([\\d.]+)/);\n    // var silk = ua.match(/Silk\\/([\\d._]+)/);\n    // var blackberry = ua.match(/(BlackBerry).*Version\\/([\\d.]+)/);\n    // var bb10 = ua.match(/(BB10).*Version\\/([\\d.]+)/);\n    // var rimtabletos = ua.match(/(RIM\\sTablet\\sOS)\\s([\\d.]+)/);\n    // var playbook = ua.match(/PlayBook/);\n    // var chrome = ua.match(/Chrome\\/([\\d.]+)/) || ua.match(/CriOS\\/([\\d.]+)/);\n    var firefox = ua.match(/Firefox\\/([\\d.]+)/);\n    // var safari = webkit && ua.match(/Mobile\\//) && !chrome;\n    // var webview = ua.match(/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/) && !chrome;\n    var ie = ua.match(/MSIE\\s([\\d.]+)/)\n        // IE 11 Trident/7.0; rv:11.0\n        || ua.match(/Trident\\/.+?rv:(([\\d.]+))/);\n    var edge = ua.match(/Edge\\/([\\d.]+)/); // IE 12 and 12+\n\n    var weChat = (/micromessenger/i).test(ua);\n\n    // Todo: clean this up with a better OS/browser seperation:\n    // - discern (more) between multiple browsers on android\n    // - decide if kindle fire in silk mode is android or not\n    // - Firefox on Android doesn't specify the Android version\n    // - possibly devide in os, device and browser hashes\n\n    // if (browser.webkit = !!webkit) browser.version = webkit[1];\n\n    // if (android) os.android = true, os.version = android[2];\n    // if (iphone && !ipod) os.ios = os.iphone = true, os.version = iphone[2].replace(/_/g, '.');\n    // if (ipad) os.ios = os.ipad = true, os.version = ipad[2].replace(/_/g, '.');\n    // if (ipod) os.ios = os.ipod = true, os.version = ipod[3] ? ipod[3].replace(/_/g, '.') : null;\n    // if (webos) os.webos = true, os.version = webos[2];\n    // if (touchpad) os.touchpad = true;\n    // if (blackberry) os.blackberry = true, os.version = blackberry[2];\n    // if (bb10) os.bb10 = true, os.version = bb10[2];\n    // if (rimtabletos) os.rimtabletos = true, os.version = rimtabletos[2];\n    // if (playbook) browser.playbook = true;\n    // if (kindle) os.kindle = true, os.version = kindle[1];\n    // if (silk) browser.silk = true, browser.version = silk[1];\n    // if (!silk && os.android && ua.match(/Kindle Fire/)) browser.silk = true;\n    // if (chrome) browser.chrome = true, browser.version = chrome[1];\n    if (firefox) {\n        browser.firefox = true;\n        browser.version = firefox[1];\n    }\n    // if (safari && (ua.match(/Safari/) || !!os.ios)) browser.safari = true;\n    // if (webview) browser.webview = true;\n\n    if (ie) {\n        browser.ie = true;\n        browser.version = ie[1];\n    }\n\n    if (edge) {\n        browser.edge = true;\n        browser.version = edge[1];\n    }\n\n    // It is difficult to detect WeChat in Win Phone precisely, because ua can\n    // not be set on win phone. So we do not consider Win Phone.\n    if (weChat) {\n        browser.weChat = true;\n    }\n\n    // os.tablet = !!(ipad || playbook || (android && !ua.match(/Mobile/)) ||\n    //     (firefox && ua.match(/Tablet/)) || (ie && !ua.match(/Phone/) && ua.match(/Touch/)));\n    // os.phone  = !!(!os.tablet && !os.ipod && (android || iphone || webos ||\n    //     (chrome && ua.match(/Android/)) || (chrome && ua.match(/CriOS\\/([\\d.]+)/)) ||\n    //     (firefox && ua.match(/Mobile/)) || (ie && ua.match(/Touch/))));\n\n    return {\n        browser: browser,\n        os: os,\n        node: false,\n        // canvas\n        // canvasSupported : !(browser.ie && parseFloat(browser.version) < 9)\n        canvasSupported: !!document.createElement('canvas').getContext,\n        svgSupported: typeof SVGRect !== 'undefined',\n        // works on most browsers\n        // IE10/11 does not support touch event, and MS Edge supports them but not by\n        // default, so we dont check navigator.maxTouchPoints for them here.\n        touchEventsSupported: 'ontouchstart' in window && !browser.ie && !browser.edge,\n        // <http://caniuse.com/#search=pointer%20event>.\n        pointerEventsSupported: 'onpointerdown' in window\n            // Firefox supports pointer but not by default, only MS browsers are reliable on pointer\n            // events currently. So we dont use that on other browsers unless tested sufficiently.\n            // Although IE 10 supports pointer event, it use old style and is different from the\n            // standard. So we exclude that. (IE 10 is hardly used on touch device)\n            && (browser.edge || (browser.ie && browser.version >= 11))\n        // passiveSupported: detectPassiveSupport()\n    };\n}\n\n// See https://github.com/WICG/EventListenerOptions/blob/gh-pages/explainer.md#feature-detection\n// function detectPassiveSupport() {\n//     // Test via a getter in the options object to see if the passive property is accessed\n//     var supportsPassive = false;\n//     try {\n//         var opts = Object.defineProperty({}, 'passive', {\n//             get: function() {\n//                 supportsPassive = true;\n//             }\n//         });\n//         window.addEventListener('testPassive', function() {}, opts);\n//     } catch (e) {\n//     }\n//     return supportsPassive;\n// }\n\n/**\n * @module zrender/core/util\n */\n\n// mergeDate\nvar BUILTIN_OBJECT = {\n    '[object Function]': 1,\n    '[object RegExp]': 1,\n    '[object Date]': 1,\n    '[object Error]': 1,\n    '[object CanvasGradient]': 1,\n    '[object CanvasPattern]': 1,\n    // For node-canvas\n    '[object Image]': 1,\n    '[object Canvas]': 1\n};\n\nvar TYPED_ARRAY = {\n    '[object Int8Array]': 1,\n    '[object Uint8Array]': 1,\n    '[object Uint8ClampedArray]': 1,\n    '[object Int16Array]': 1,\n    '[object Uint16Array]': 1,\n    '[object Int32Array]': 1,\n    '[object Uint32Array]': 1,\n    '[object Float32Array]': 1,\n    '[object Float64Array]': 1\n};\n\nvar objToString = Object.prototype.toString;\n\nvar arrayProto = Array.prototype;\nvar nativeForEach = arrayProto.forEach;\nvar nativeFilter = arrayProto.filter;\nvar nativeSlice = arrayProto.slice;\nvar nativeMap = arrayProto.map;\nvar nativeReduce = arrayProto.reduce;\n\n// Avoid assign to an exported variable, for transforming to cjs.\nvar methods = {};\n\nfunction $override(name, fn) {\n    // Clear ctx instance for different environment\n    if (name === 'createCanvas') {\n        _ctx = null;\n    }\n\n    methods[name] = fn;\n}\n\n/**\n * Those data types can be cloned:\n *     Plain object, Array, TypedArray, number, string, null, undefined.\n * Those data types will be assgined using the orginal data:\n *     BUILTIN_OBJECT\n * Instance of user defined class will be cloned to a plain object, without\n * properties in prototype.\n * Other data types is not supported (not sure what will happen).\n *\n * Caution: do not support clone Date, for performance consideration.\n * (There might be a large number of date in `series.data`).\n * So date should not be modified in and out of echarts.\n *\n * @param {*} source\n * @return {*} new\n */\nfunction clone(source) {\n    if (source == null || typeof source != 'object') {\n        return source;\n    }\n\n    var result = source;\n    var typeStr = objToString.call(source);\n\n    if (typeStr === '[object Array]') {\n        if (!isPrimitive(source)) {\n            result = [];\n            for (var i = 0, len = source.length; i < len; i++) {\n                result[i] = clone(source[i]);\n            }\n        }\n    }\n    else if (TYPED_ARRAY[typeStr]) {\n        if (!isPrimitive(source)) {\n            var Ctor = source.constructor;\n            if (source.constructor.from) {\n                result = Ctor.from(source);\n            }\n            else {\n                result = new Ctor(source.length);\n                for (var i = 0, len = source.length; i < len; i++) {\n                    result[i] = clone(source[i]);\n                }\n            }\n        }\n    }\n    else if (!BUILTIN_OBJECT[typeStr] && !isPrimitive(source) && !isDom(source)) {\n        result = {};\n        for (var key in source) {\n            if (source.hasOwnProperty(key)) {\n                result[key] = clone(source[key]);\n            }\n        }\n    }\n\n    return result;\n}\n\n/**\n * @memberOf module:zrender/core/util\n * @param {*} target\n * @param {*} source\n * @param {boolean} [overwrite=false]\n */\nfunction merge(target, source, overwrite) {\n    // We should escapse that source is string\n    // and enter for ... in ...\n    if (!isObject$1(source) || !isObject$1(target)) {\n        return overwrite ? clone(source) : target;\n    }\n\n    for (var key in source) {\n        if (source.hasOwnProperty(key)) {\n            var targetProp = target[key];\n            var sourceProp = source[key];\n\n            if (isObject$1(sourceProp)\n                && isObject$1(targetProp)\n                && !isArray(sourceProp)\n                && !isArray(targetProp)\n                && !isDom(sourceProp)\n                && !isDom(targetProp)\n                && !isBuiltInObject(sourceProp)\n                && !isBuiltInObject(targetProp)\n                && !isPrimitive(sourceProp)\n                && !isPrimitive(targetProp)\n            ) {\n                // merge\n                merge(targetProp, sourceProp, overwrite);\n            }\n            else if (overwrite || !(key in target)) {\n                // overwritetrue\n                // NOTE target[key] \n                target[key] = clone(source[key], true);\n            }\n        }\n    }\n\n    return target;\n}\n\n/**\n * @param {Array} targetAndSources The first item is target, and the rests are source.\n * @param {boolean} [overwrite=false]\n * @return {*} target\n */\nfunction mergeAll(targetAndSources, overwrite) {\n    var result = targetAndSources[0];\n    for (var i = 1, len = targetAndSources.length; i < len; i++) {\n        result = merge(result, targetAndSources[i], overwrite);\n    }\n    return result;\n}\n\n/**\n * @param {*} target\n * @param {*} source\n * @memberOf module:zrender/core/util\n */\nfunction extend(target, source) {\n    for (var key in source) {\n        if (source.hasOwnProperty(key)) {\n            target[key] = source[key];\n        }\n    }\n    return target;\n}\n\n/**\n * @param {*} target\n * @param {*} source\n * @param {boolean} [overlay=false]\n * @memberOf module:zrender/core/util\n */\nfunction defaults(target, source, overlay) {\n    for (var key in source) {\n        if (source.hasOwnProperty(key)\n            && (overlay ? source[key] != null : target[key] == null)\n        ) {\n            target[key] = source[key];\n        }\n    }\n    return target;\n}\n\nvar createCanvas = function () {\n    return methods.createCanvas();\n};\n\nmethods.createCanvas = function () {\n    return document.createElement('canvas');\n};\n\n// FIXME\nvar _ctx;\n\nfunction getContext() {\n    if (!_ctx) {\n        // Use util.createCanvas instead of createCanvas\n        // because createCanvas may be overwritten in different environment\n        _ctx = createCanvas().getContext('2d');\n    }\n    return _ctx;\n}\n\n/**\n * index\n * @memberOf module:zrender/core/util\n */\nfunction indexOf(array, value) {\n    if (array) {\n        if (array.indexOf) {\n            return array.indexOf(value);\n        }\n        for (var i = 0, len = array.length; i < len; i++) {\n            if (array[i] === value) {\n                return i;\n            }\n        }\n    }\n    return -1;\n}\n\n/**\n * \n *\n * @memberOf module:zrender/core/util\n * @param {Function} clazz \n * @param {Function} baseClazz \n */\nfunction inherits(clazz, baseClazz) {\n    var clazzPrototype = clazz.prototype;\n    function F() {}\n    F.prototype = baseClazz.prototype;\n    clazz.prototype = new F();\n\n    for (var prop in clazzPrototype) {\n        clazz.prototype[prop] = clazzPrototype[prop];\n    }\n    clazz.prototype.constructor = clazz;\n    clazz.superClass = baseClazz;\n}\n\n/**\n * @memberOf module:zrender/core/util\n * @param {Object|Function} target\n * @param {Object|Function} sorce\n * @param {boolean} overlay\n */\nfunction mixin(target, source, overlay) {\n    target = 'prototype' in target ? target.prototype : target;\n    source = 'prototype' in source ? source.prototype : source;\n\n    defaults(target, source, overlay);\n}\n\n/**\n * Consider typed array.\n * @param {Array|TypedArray} data\n */\nfunction isArrayLike(data) {\n    if (! data) {\n        return;\n    }\n    if (typeof data == 'string') {\n        return false;\n    }\n    return typeof data.length == 'number';\n}\n\n/**\n * \n * @memberOf module:zrender/core/util\n * @param {Object|Array} obj\n * @param {Function} cb\n * @param {*} [context]\n */\nfunction each$1(obj, cb, context) {\n    if (!(obj && cb)) {\n        return;\n    }\n    if (obj.forEach && obj.forEach === nativeForEach) {\n        obj.forEach(cb, context);\n    }\n    else if (obj.length === +obj.length) {\n        for (var i = 0, len = obj.length; i < len; i++) {\n            cb.call(context, obj[i], i, obj);\n        }\n    }\n    else {\n        for (var key in obj) {\n            if (obj.hasOwnProperty(key)) {\n                cb.call(context, obj[key], key, obj);\n            }\n        }\n    }\n}\n\n/**\n * \n * @memberOf module:zrender/core/util\n * @param {Array} obj\n * @param {Function} cb\n * @param {*} [context]\n * @return {Array}\n */\nfunction map(obj, cb, context) {\n    if (!(obj && cb)) {\n        return;\n    }\n    if (obj.map && obj.map === nativeMap) {\n        return obj.map(cb, context);\n    }\n    else {\n        var result = [];\n        for (var i = 0, len = obj.length; i < len; i++) {\n            result.push(cb.call(context, obj[i], i, obj));\n        }\n        return result;\n    }\n}\n\n/**\n * @memberOf module:zrender/core/util\n * @param {Array} obj\n * @param {Function} cb\n * @param {Object} [memo]\n * @param {*} [context]\n * @return {Array}\n */\nfunction reduce(obj, cb, memo, context) {\n    if (!(obj && cb)) {\n        return;\n    }\n    if (obj.reduce && obj.reduce === nativeReduce) {\n        return obj.reduce(cb, memo, context);\n    }\n    else {\n        for (var i = 0, len = obj.length; i < len; i++) {\n            memo = cb.call(context, memo, obj[i], i, obj);\n        }\n        return memo;\n    }\n}\n\n/**\n * \n * @memberOf module:zrender/core/util\n * @param {Array} obj\n * @param {Function} cb\n * @param {*} [context]\n * @return {Array}\n */\nfunction filter(obj, cb, context) {\n    if (!(obj && cb)) {\n        return;\n    }\n    if (obj.filter && obj.filter === nativeFilter) {\n        return obj.filter(cb, context);\n    }\n    else {\n        var result = [];\n        for (var i = 0, len = obj.length; i < len; i++) {\n            if (cb.call(context, obj[i], i, obj)) {\n                result.push(obj[i]);\n            }\n        }\n        return result;\n    }\n}\n\n/**\n * \n * @memberOf module:zrender/core/util\n * @param {Array} obj\n * @param {Function} cb\n * @param {*} [context]\n * @return {*}\n */\nfunction find(obj, cb, context) {\n    if (!(obj && cb)) {\n        return;\n    }\n    for (var i = 0, len = obj.length; i < len; i++) {\n        if (cb.call(context, obj[i], i, obj)) {\n            return obj[i];\n        }\n    }\n}\n\n/**\n * @memberOf module:zrender/core/util\n * @param {Function} func\n * @param {*} context\n * @return {Function}\n */\nfunction bind(func, context) {\n    var args = nativeSlice.call(arguments, 2);\n    return function () {\n        return func.apply(context, args.concat(nativeSlice.call(arguments)));\n    };\n}\n\n/**\n * @memberOf module:zrender/core/util\n * @param {Function} func\n * @return {Function}\n */\nfunction curry(func) {\n    var args = nativeSlice.call(arguments, 1);\n    return function () {\n        return func.apply(this, args.concat(nativeSlice.call(arguments)));\n    };\n}\n\n/**\n * @memberOf module:zrender/core/util\n * @param {*} value\n * @return {boolean}\n */\nfunction isArray(value) {\n    return objToString.call(value) === '[object Array]';\n}\n\n/**\n * @memberOf module:zrender/core/util\n * @param {*} value\n * @return {boolean}\n */\nfunction isFunction$1(value) {\n    return typeof value === 'function';\n}\n\n/**\n * @memberOf module:zrender/core/util\n * @param {*} value\n * @return {boolean}\n */\nfunction isString(value) {\n    return objToString.call(value) === '[object String]';\n}\n\n/**\n * @memberOf module:zrender/core/util\n * @param {*} value\n * @return {boolean}\n */\nfunction isObject$1(value) {\n    // Avoid a V8 JIT bug in Chrome 19-20.\n    // See https://code.google.com/p/v8/issues/detail?id=2291 for more details.\n    var type = typeof value;\n    return type === 'function' || (!!value && type == 'object');\n}\n\n/**\n * @memberOf module:zrender/core/util\n * @param {*} value\n * @return {boolean}\n */\nfunction isBuiltInObject(value) {\n    return !!BUILTIN_OBJECT[objToString.call(value)];\n}\n\n/**\n * @memberOf module:zrender/core/util\n * @param {*} value\n * @return {boolean}\n */\nfunction isTypedArray(value) {\n    return !!TYPED_ARRAY[objToString.call(value)];\n}\n\n/**\n * @memberOf module:zrender/core/util\n * @param {*} value\n * @return {boolean}\n */\nfunction isDom(value) {\n    return typeof value === 'object'\n        && typeof value.nodeType === 'number'\n        && typeof value.ownerDocument === 'object';\n}\n\n/**\n * Whether is exactly NaN. Notice isNaN('a') returns true.\n * @param {*} value\n * @return {boolean}\n */\nfunction eqNaN(value) {\n    return value !== value;\n}\n\n/**\n * If value1 is not null, then return value1, otherwise judget rest of values.\n * Low performance.\n * @memberOf module:zrender/core/util\n * @return {*} Final value\n */\nfunction retrieve(values) {\n    for (var i = 0, len = arguments.length; i < len; i++) {\n        if (arguments[i] != null) {\n            return arguments[i];\n        }\n    }\n}\n\nfunction retrieve2(value0, value1) {\n    return value0 != null\n        ? value0\n        : value1;\n}\n\nfunction retrieve3(value0, value1, value2) {\n    return value0 != null\n        ? value0\n        : value1 != null\n        ? value1\n        : value2;\n}\n\n/**\n * @memberOf module:zrender/core/util\n * @param {Array} arr\n * @param {number} startIndex\n * @param {number} endIndex\n * @return {Array}\n */\nfunction slice() {\n    return Function.call.apply(nativeSlice, arguments);\n}\n\n/**\n * Normalize css liked array configuration\n * e.g.\n *  3 => [3, 3, 3, 3]\n *  [4, 2] => [4, 2, 4, 2]\n *  [4, 3, 2] => [4, 3, 2, 3]\n * @param {number|Array.<number>} val\n * @return {Array.<number>}\n */\nfunction normalizeCssArray(val) {\n    if (typeof (val) === 'number') {\n        return [val, val, val, val];\n    }\n    var len = val.length;\n    if (len === 2) {\n        // vertical | horizontal\n        return [val[0], val[1], val[0], val[1]];\n    }\n    else if (len === 3) {\n        // top | horizontal | bottom\n        return [val[0], val[1], val[2], val[1]];\n    }\n    return val;\n}\n\n/**\n * @memberOf module:zrender/core/util\n * @param {boolean} condition\n * @param {string} message\n */\nfunction assert$1(condition, message) {\n    if (!condition) {\n        throw new Error(message);\n    }\n}\n\n/**\n * @memberOf module:zrender/core/util\n * @param {string} str string to be trimed\n * @return {string} trimed string\n */\nfunction trim(str) {\n    if (str == null) {\n        return null;\n    }\n    else if (typeof str.trim === 'function') {\n        return str.trim();\n    }\n    else {\n        return str.replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g, '');\n    }\n}\n\nvar primitiveKey = '__ec_primitive__';\n/**\n * Set an object as primitive to be ignored traversing children in clone or merge\n */\nfunction setAsPrimitive(obj) {\n    obj[primitiveKey] = true;\n}\n\nfunction isPrimitive(obj) {\n    return obj[primitiveKey];\n}\n\n/**\n * @constructor\n * @param {Object} obj Only apply `ownProperty`.\n */\nfunction HashMap(obj) {\n    var isArr = isArray(obj);\n    var thisMap = this;\n\n    (obj instanceof HashMap)\n        ? obj.each(visit)\n        : (obj && each$1(obj, visit));\n\n    function visit(value, key) {\n        isArr ? thisMap.set(value, key) : thisMap.set(key, value);\n    }\n}\n\n// Add prefix to avoid conflict with Object.prototype.\n\nHashMap.prototype = {\n    constructor: HashMap,\n    // Do not provide `has` method to avoid defining what is `has`.\n    // (We usually treat `null` and `undefined` as the same, different\n    // from ES6 Map).\n    get: function (key) {\n        return this.hasOwnProperty(key) ? this[key] : null;\n    },\n    set: function (key, value) {\n        // Comparing with invocation chaining, `return value` is more commonly\n        // used in this case: `var someVal = map.set('a', genVal());`\n        return (this[key] = value);\n    },\n    // Although util.each can be performed on this hashMap directly, user\n    // should not use the exposed keys, who are prefixed.\n    each: function (cb, context) {\n        context !== void 0 && (cb = bind(cb, context));\n        for (var key in this) {\n            this.hasOwnProperty(key) && cb(this[key], key);\n        }\n    },\n    // Do not use this method if performance sensitive.\n    removeKey: function (key) {\n        delete this[key];\n    }\n};\n\nfunction createHashMap(obj) {\n    return new HashMap(obj);\n}\n\nfunction concatArray(a, b) {\n    var newArray = new a.constructor(a.length + b.length);\n    for (var i = 0; i < a.length; i++) {\n        newArray[i] = a[i];\n    }\n    var offset = a.length;\n    for (i = 0; i < b.length; i++) {\n        newArray[i + offset] = b[i];\n    }\n    return newArray;\n}\n\n\nfunction noop() {}\n\n\nvar zrUtil = (Object.freeze || Object)({\n\t$override: $override,\n\tclone: clone,\n\tmerge: merge,\n\tmergeAll: mergeAll,\n\textend: extend,\n\tdefaults: defaults,\n\tcreateCanvas: createCanvas,\n\tgetContext: getContext,\n\tindexOf: indexOf,\n\tinherits: inherits,\n\tmixin: mixin,\n\tisArrayLike: isArrayLike,\n\teach: each$1,\n\tmap: map,\n\treduce: reduce,\n\tfilter: filter,\n\tfind: find,\n\tbind: bind,\n\tcurry: curry,\n\tisArray: isArray,\n\tisFunction: isFunction$1,\n\tisString: isString,\n\tisObject: isObject$1,\n\tisBuiltInObject: isBuiltInObject,\n\tisTypedArray: isTypedArray,\n\tisDom: isDom,\n\teqNaN: eqNaN,\n\tretrieve: retrieve,\n\tretrieve2: retrieve2,\n\tretrieve3: retrieve3,\n\tslice: slice,\n\tnormalizeCssArray: normalizeCssArray,\n\tassert: assert$1,\n\ttrim: trim,\n\tsetAsPrimitive: setAsPrimitive,\n\tisPrimitive: isPrimitive,\n\tcreateHashMap: createHashMap,\n\tconcatArray: concatArray,\n\tnoop: noop\n});\n\nvar ArrayCtor = typeof Float32Array === 'undefined'\n    ? Array\n    : Float32Array;\n\n/**\n * \n * @param {number} [x=0]\n * @param {number} [y=0]\n * @return {Vector2}\n */\nfunction create(x, y) {\n    var out = new ArrayCtor(2);\n    if (x == null) {\n        x = 0;\n    }\n    if (y == null) {\n        y = 0;\n    }\n    out[0] = x;\n    out[1] = y;\n    return out;\n}\n\n/**\n * \n * @param {Vector2} out\n * @param {Vector2} v\n * @return {Vector2}\n */\nfunction copy(out, v) {\n    out[0] = v[0];\n    out[1] = v[1];\n    return out;\n}\n\n/**\n * \n * @param {Vector2} v\n * @return {Vector2}\n */\nfunction clone$1(v) {\n    var out = new ArrayCtor(2);\n    out[0] = v[0];\n    out[1] = v[1];\n    return out;\n}\n\n/**\n * \n * @param {Vector2} out\n * @param {number} a\n * @param {number} b\n * @return {Vector2} \n */\nfunction set(out, a, b) {\n    out[0] = a;\n    out[1] = b;\n    return out;\n}\n\n/**\n * \n * @param {Vector2} out\n * @param {Vector2} v1\n * @param {Vector2} v2\n */\nfunction add(out, v1, v2) {\n    out[0] = v1[0] + v2[0];\n    out[1] = v1[1] + v2[1];\n    return out;\n}\n\n/**\n * \n * @param {Vector2} out\n * @param {Vector2} v1\n * @param {Vector2} v2\n * @param {number} a\n */\nfunction scaleAndAdd(out, v1, v2, a) {\n    out[0] = v1[0] + v2[0] * a;\n    out[1] = v1[1] + v2[1] * a;\n    return out;\n}\n\n/**\n * \n * @param {Vector2} out\n * @param {Vector2} v1\n * @param {Vector2} v2\n */\nfunction sub(out, v1, v2) {\n    out[0] = v1[0] - v2[0];\n    out[1] = v1[1] - v2[1];\n    return out;\n}\n\n/**\n * \n * @param {Vector2} v\n * @return {number}\n */\nfunction len(v) {\n    return Math.sqrt(lenSquare(v));\n}\nvar length = len; // jshint ignore:line\n\n/**\n * \n * @param {Vector2} v\n * @return {number}\n */\nfunction lenSquare(v) {\n    return v[0] * v[0] + v[1] * v[1];\n}\nvar lengthSquare = lenSquare;\n\n/**\n * \n * @param {Vector2} out\n * @param {Vector2} v1\n * @param {Vector2} v2\n */\nfunction mul(out, v1, v2) {\n    out[0] = v1[0] * v2[0];\n    out[1] = v1[1] * v2[1];\n    return out;\n}\n\n/**\n * \n * @param {Vector2} out\n * @param {Vector2} v1\n * @param {Vector2} v2\n */\nfunction div(out, v1, v2) {\n    out[0] = v1[0] / v2[0];\n    out[1] = v1[1] / v2[1];\n    return out;\n}\n\n/**\n * \n * @param {Vector2} v1\n * @param {Vector2} v2\n * @return {number}\n */\nfunction dot(v1, v2) {\n    return v1[0] * v2[0] + v1[1] * v2[1];\n}\n\n/**\n * \n * @param {Vector2} out\n * @param {Vector2} v\n * @param {number} s\n */\nfunction scale(out, v, s) {\n    out[0] = v[0] * s;\n    out[1] = v[1] * s;\n    return out;\n}\n\n/**\n * \n * @param {Vector2} out\n * @param {Vector2} v\n */\nfunction normalize(out, v) {\n    var d = len(v);\n    if (d === 0) {\n        out[0] = 0;\n        out[1] = 0;\n    }\n    else {\n        out[0] = v[0] / d;\n        out[1] = v[1] / d;\n    }\n    return out;\n}\n\n/**\n * \n * @param {Vector2} v1\n * @param {Vector2} v2\n * @return {number}\n */\nfunction distance(v1, v2) {\n    return Math.sqrt(\n        (v1[0] - v2[0]) * (v1[0] - v2[0])\n        + (v1[1] - v2[1]) * (v1[1] - v2[1])\n    );\n}\nvar dist = distance;\n\n/**\n * \n * @param {Vector2} v1\n * @param {Vector2} v2\n * @return {number}\n */\nfunction distanceSquare(v1, v2) {\n    return (v1[0] - v2[0]) * (v1[0] - v2[0])\n        + (v1[1] - v2[1]) * (v1[1] - v2[1]);\n}\nvar distSquare = distanceSquare;\n\n/**\n * \n * @param {Vector2} out\n * @param {Vector2} v\n */\nfunction negate(out, v) {\n    out[0] = -v[0];\n    out[1] = -v[1];\n    return out;\n}\n\n/**\n * \n * @param {Vector2} out\n * @param {Vector2} v1\n * @param {Vector2} v2\n * @param {number} t\n */\nfunction lerp(out, v1, v2, t) {\n    out[0] = v1[0] + t * (v2[0] - v1[0]);\n    out[1] = v1[1] + t * (v2[1] - v1[1]);\n    return out;\n}\n\n/**\n * \n * @param {Vector2} out\n * @param {Vector2} v\n * @param {Vector2} m\n */\nfunction applyTransform(out, v, m) {\n    var x = v[0];\n    var y = v[1];\n    out[0] = m[0] * x + m[2] * y + m[4];\n    out[1] = m[1] * x + m[3] * y + m[5];\n    return out;\n}\n\n/**\n * \n * @param  {Vector2} out\n * @param  {Vector2} v1\n * @param  {Vector2} v2\n */\nfunction min(out, v1, v2) {\n    out[0] = Math.min(v1[0], v2[0]);\n    out[1] = Math.min(v1[1], v2[1]);\n    return out;\n}\n\n/**\n * \n * @param  {Vector2} out\n * @param  {Vector2} v1\n * @param  {Vector2} v2\n */\nfunction max(out, v1, v2) {\n    out[0] = Math.max(v1[0], v2[0]);\n    out[1] = Math.max(v1[1], v2[1]);\n    return out;\n}\n\n\nvar vector = (Object.freeze || Object)({\n\tcreate: create,\n\tcopy: copy,\n\tclone: clone$1,\n\tset: set,\n\tadd: add,\n\tscaleAndAdd: scaleAndAdd,\n\tsub: sub,\n\tlen: len,\n\tlength: length,\n\tlenSquare: lenSquare,\n\tlengthSquare: lengthSquare,\n\tmul: mul,\n\tdiv: div,\n\tdot: dot,\n\tscale: scale,\n\tnormalize: normalize,\n\tdistance: distance,\n\tdist: dist,\n\tdistanceSquare: distanceSquare,\n\tdistSquare: distSquare,\n\tnegate: negate,\n\tlerp: lerp,\n\tapplyTransform: applyTransform,\n\tmin: min,\n\tmax: max\n});\n\n// TODO Draggable for group\n// FIXME Draggable on element which has parent rotation or scale\nfunction Draggable() {\n\n    this.on('mousedown', this._dragStart, this);\n    this.on('mousemove', this._drag, this);\n    this.on('mouseup', this._dragEnd, this);\n    this.on('globalout', this._dragEnd, this);\n    // this._dropTarget = null;\n    // this._draggingTarget = null;\n\n    // this._x = 0;\n    // this._y = 0;\n}\n\nDraggable.prototype = {\n\n    constructor: Draggable,\n\n    _dragStart: function (e) {\n        var draggingTarget = e.target;\n        if (draggingTarget && draggingTarget.draggable) {\n            this._draggingTarget = draggingTarget;\n            draggingTarget.dragging = true;\n            this._x = e.offsetX;\n            this._y = e.offsetY;\n\n            this.dispatchToElement(param(draggingTarget, e), 'dragstart', e.event);\n        }\n    },\n\n    _drag: function (e) {\n        var draggingTarget = this._draggingTarget;\n        if (draggingTarget) {\n\n            var x = e.offsetX;\n            var y = e.offsetY;\n\n            var dx = x - this._x;\n            var dy = y - this._y;\n            this._x = x;\n            this._y = y;\n\n            draggingTarget.drift(dx, dy, e);\n            this.dispatchToElement(param(draggingTarget, e), 'drag', e.event);\n\n            var dropTarget = this.findHover(x, y, draggingTarget).target;\n            var lastDropTarget = this._dropTarget;\n            this._dropTarget = dropTarget;\n\n            if (draggingTarget !== dropTarget) {\n                if (lastDropTarget && dropTarget !== lastDropTarget) {\n                    this.dispatchToElement(param(lastDropTarget, e), 'dragleave', e.event);\n                }\n                if (dropTarget && dropTarget !== lastDropTarget) {\n                    this.dispatchToElement(param(dropTarget, e), 'dragenter', e.event);\n                }\n            }\n        }\n    },\n\n    _dragEnd: function (e) {\n        var draggingTarget = this._draggingTarget;\n\n        if (draggingTarget) {\n            draggingTarget.dragging = false;\n        }\n\n        this.dispatchToElement(param(draggingTarget, e), 'dragend', e.event);\n\n        if (this._dropTarget) {\n            this.dispatchToElement(param(this._dropTarget, e), 'drop', e.event);\n        }\n\n        this._draggingTarget = null;\n        this._dropTarget = null;\n    }\n\n};\n\nfunction param(target, e) {\n    return {target: target, topTarget: e && e.topTarget};\n}\n\n/**\n * \n * @module zrender/mixin/Eventful\n * @author Kener (@Kener-, kener.linfeng@gmail.com)\n *         pissang (https://www.github.com/pissang)\n */\n\nvar arrySlice = Array.prototype.slice;\n\n/**\n * \n * @alias module:zrender/mixin/Eventful\n * @constructor\n */\nvar Eventful = function () {\n    this._$handlers = {};\n};\n\nEventful.prototype = {\n\n    constructor: Eventful,\n\n    /**\n     * trigger\n     *\n     * @param {string} event \n     * @param {Function} handler \n     * @param {Object} context\n     */\n    one: function (event, handler, context) {\n        var _h = this._$handlers;\n\n        if (!handler || !event) {\n            return this;\n        }\n\n        if (!_h[event]) {\n            _h[event] = [];\n        }\n\n        for (var i = 0; i < _h[event].length; i++) {\n            if (_h[event][i].h === handler) {\n                return this;\n            }\n        }\n\n        _h[event].push({\n            h: handler,\n            one: true,\n            ctx: context || this\n        });\n\n        return this;\n    },\n\n    /**\n     * \n     * @param {string} event \n     * @param {Function} handler \n     * @param {Object} [context]\n     */\n    on: function (event, handler, context) {\n        var _h = this._$handlers;\n\n        if (!handler || !event) {\n            return this;\n        }\n\n        if (!_h[event]) {\n            _h[event] = [];\n        }\n\n        for (var i = 0; i < _h[event].length; i++) {\n            if (_h[event][i].h === handler) {\n                return this;\n            }\n        }\n\n        _h[event].push({\n            h: handler,\n            one: false,\n            ctx: context || this\n        });\n\n        return this;\n    },\n\n    /**\n     * \n     * @param  {string}  event\n     * @return {boolean}\n     */\n    isSilent: function (event) {\n        var _h = this._$handlers;\n        return _h[event] && _h[event].length;\n    },\n\n    /**\n     * \n     * @param {string} event \n     * @param {Function} [handler] \n     */\n    off: function (event, handler) {\n        var _h = this._$handlers;\n\n        if (!event) {\n            this._$handlers = {};\n            return this;\n        }\n\n        if (handler) {\n            if (_h[event]) {\n                var newList = [];\n                for (var i = 0, l = _h[event].length; i < l; i++) {\n                    if (_h[event][i]['h'] != handler) {\n                        newList.push(_h[event][i]);\n                    }\n                }\n                _h[event] = newList;\n            }\n\n            if (_h[event] && _h[event].length === 0) {\n                delete _h[event];\n            }\n        }\n        else {\n            delete _h[event];\n        }\n\n        return this;\n    },\n\n    /**\n     * \n     *\n     * @param {string} type \n     */\n    trigger: function (type) {\n        if (this._$handlers[type]) {\n            var args = arguments;\n            var argLen = args.length;\n\n            if (argLen > 3) {\n                args = arrySlice.call(args, 1);\n            }\n\n            var _h = this._$handlers[type];\n            var len = _h.length;\n            for (var i = 0; i < len;) {\n                // Optimize advise from backbone\n                switch (argLen) {\n                    case 1:\n                        _h[i]['h'].call(_h[i]['ctx']);\n                        break;\n                    case 2:\n                        _h[i]['h'].call(_h[i]['ctx'], args[1]);\n                        break;\n                    case 3:\n                        _h[i]['h'].call(_h[i]['ctx'], args[1], args[2]);\n                        break;\n                    default:\n                        // have more than 2 given arguments\n                        _h[i]['h'].apply(_h[i]['ctx'], args);\n                        break;\n                }\n\n                if (_h[i]['one']) {\n                    _h.splice(i, 1);\n                    len--;\n                }\n                else {\n                    i++;\n                }\n            }\n        }\n\n        return this;\n    },\n\n    /**\n     * context, context\n     * @param {string} type \n     */\n    triggerWithContext: function (type) {\n        if (this._$handlers[type]) {\n            var args = arguments;\n            var argLen = args.length;\n\n            if (argLen > 4) {\n                args = arrySlice.call(args, 1, args.length - 1);\n            }\n            var ctx = args[args.length - 1];\n\n            var _h = this._$handlers[type];\n            var len = _h.length;\n            for (var i = 0; i < len;) {\n                // Optimize advise from backbone\n                switch (argLen) {\n                    case 1:\n                        _h[i]['h'].call(ctx);\n                        break;\n                    case 2:\n                        _h[i]['h'].call(ctx, args[1]);\n                        break;\n                    case 3:\n                        _h[i]['h'].call(ctx, args[1], args[2]);\n                        break;\n                    default:\n                        // have more than 2 given arguments\n                        _h[i]['h'].apply(ctx, args);\n                        break;\n                }\n\n                if (_h[i]['one']) {\n                    _h.splice(i, 1);\n                    len--;\n                }\n                else {\n                    i++;\n                }\n            }\n        }\n\n        return this;\n    }\n};\n\nvar SILENT = 'silent';\n\nfunction makeEventPacket(eveType, targetInfo, event) {\n    return {\n        type: eveType,\n        event: event,\n        // target can only be an element that is not silent.\n        target: targetInfo.target,\n        // topTarget can be a silent element.\n        topTarget: targetInfo.topTarget,\n        cancelBubble: false,\n        offsetX: event.zrX,\n        offsetY: event.zrY,\n        gestureEvent: event.gestureEvent,\n        pinchX: event.pinchX,\n        pinchY: event.pinchY,\n        pinchScale: event.pinchScale,\n        wheelDelta: event.zrDelta,\n        zrByTouch: event.zrByTouch,\n        which: event.which\n    };\n}\n\nfunction EmptyProxy () {}\nEmptyProxy.prototype.dispose = function () {};\n\nvar handlerNames = [\n    'click', 'dblclick', 'mousewheel', 'mouseout',\n    'mouseup', 'mousedown', 'mousemove', 'contextmenu'\n];\n/**\n * @alias module:zrender/Handler\n * @constructor\n * @extends module:zrender/mixin/Eventful\n * @param {module:zrender/Storage} storage Storage instance.\n * @param {module:zrender/Painter} painter Painter instance.\n * @param {module:zrender/dom/HandlerProxy} proxy HandlerProxy instance.\n * @param {HTMLElement} painterRoot painter.root (not painter.getViewportRoot()).\n */\nvar Handler = function(storage, painter, proxy, painterRoot) {\n    Eventful.call(this);\n\n    this.storage = storage;\n\n    this.painter = painter;\n\n    this.painterRoot = painterRoot;\n\n    proxy = proxy || new EmptyProxy();\n\n    /**\n     * Proxy of event. can be Dom, WebGLSurface, etc.\n     */\n    this.proxy = null;\n\n    /**\n     * {target, topTarget, x, y}\n     * @private\n     * @type {Object}\n     */\n    this._hovered = {};\n\n    /**\n     * @private\n     * @type {Date}\n     */\n    this._lastTouchMoment;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this._lastX;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this._lastY;\n\n\n    Draggable.call(this);\n\n    this.setHandlerProxy(proxy);\n};\n\nHandler.prototype = {\n\n    constructor: Handler,\n\n    setHandlerProxy: function (proxy) {\n        if (this.proxy) {\n            this.proxy.dispose();\n        }\n\n        if (proxy) {\n            each$1(handlerNames, function (name) {\n                proxy.on && proxy.on(name, this[name], this);\n            }, this);\n            // Attach handler\n            proxy.handler = this;\n        }\n        this.proxy = proxy;\n    },\n\n    mousemove: function (event) {\n        var x = event.zrX;\n        var y = event.zrY;\n\n        var lastHovered = this._hovered;\n        var lastHoveredTarget = lastHovered.target;\n\n        // If lastHoveredTarget is removed from zr (detected by '__zr') by some API call\n        // (like 'setOption' or 'dispatchAction') in event handlers, we should find\n        // lastHovered again here. Otherwise 'mouseout' can not be triggered normally.\n        // See #6198.\n        if (lastHoveredTarget && !lastHoveredTarget.__zr) {\n            lastHovered = this.findHover(lastHovered.x, lastHovered.y);\n            lastHoveredTarget = lastHovered.target;\n        }\n\n        var hovered = this._hovered = this.findHover(x, y);\n        var hoveredTarget = hovered.target;\n\n        var proxy = this.proxy;\n        proxy.setCursor && proxy.setCursor(hoveredTarget ? hoveredTarget.cursor : 'default');\n\n        // Mouse out on previous hovered element\n        if (lastHoveredTarget && hoveredTarget !== lastHoveredTarget) {\n            this.dispatchToElement(lastHovered, 'mouseout', event);\n        }\n\n        // Mouse moving on one element\n        this.dispatchToElement(hovered, 'mousemove', event);\n\n        // Mouse over on a new element\n        if (hoveredTarget && hoveredTarget !== lastHoveredTarget) {\n            this.dispatchToElement(hovered, 'mouseover', event);\n        }\n    },\n\n    mouseout: function (event) {\n        this.dispatchToElement(this._hovered, 'mouseout', event);\n\n        // There might be some doms created by upper layer application\n        // at the same level of painter.getViewportRoot() (e.g., tooltip\n        // dom created by echarts), where 'globalout' event should not\n        // be triggered when mouse enters these doms. (But 'mouseout'\n        // should be triggered at the original hovered element as usual).\n        var element = event.toElement || event.relatedTarget;\n        var innerDom;\n        do {\n            element = element && element.parentNode;\n        }\n        while (element && element.nodeType != 9 && !(\n            innerDom = element === this.painterRoot\n        ));\n\n        !innerDom && this.trigger('globalout', {event: event});\n    },\n\n    /**\n     * Resize\n     */\n    resize: function (event) {\n        this._hovered = {};\n    },\n\n    /**\n     * Dispatch event\n     * @param {string} eventName\n     * @param {event=} eventArgs\n     */\n    dispatch: function (eventName, eventArgs) {\n        var handler = this[eventName];\n        handler && handler.call(this, eventArgs);\n    },\n\n    /**\n     * Dispose\n     */\n    dispose: function () {\n\n        this.proxy.dispose();\n\n        this.storage =\n        this.proxy =\n        this.painter = null;\n    },\n\n    /**\n     * cursor style\n     * @param {string} [cursorStyle='default']  crosshair\n     */\n    setCursorStyle: function (cursorStyle) {\n        var proxy = this.proxy;\n        proxy.setCursor && proxy.setCursor(cursorStyle);\n    },\n\n    /**\n     * \n     *\n     * @private\n     * @param {Object} targetInfo {target, topTarget} \n     * @param {string} eventName \n     * @param {Object} event \n     */\n    dispatchToElement: function (targetInfo, eventName, event) {\n        targetInfo = targetInfo || {};\n        var el = targetInfo.target;\n        if (el && el.silent) {\n            return;\n        }\n        var eventHandler = 'on' + eventName;\n        var eventPacket = makeEventPacket(eventName, targetInfo, event);\n\n        while (el) {\n            el[eventHandler]\n                && (eventPacket.cancelBubble = el[eventHandler].call(el, eventPacket));\n\n            el.trigger(eventName, eventPacket);\n\n            el = el.parent;\n\n            if (eventPacket.cancelBubble) {\n                break;\n            }\n        }\n\n        if (!eventPacket.cancelBubble) {\n            //  zrender \n            this.trigger(eventName, eventPacket);\n            // \n            //  click  dispose painter \n            this.painter && this.painter.eachOtherLayer(function (layer) {\n                if (typeof(layer[eventHandler]) == 'function') {\n                    layer[eventHandler].call(layer, eventPacket);\n                }\n                if (layer.trigger) {\n                    layer.trigger(eventName, eventPacket);\n                }\n            });\n        }\n    },\n\n    /**\n     * @private\n     * @param {number} x\n     * @param {number} y\n     * @param {module:zrender/graphic/Displayable} exclude\n     * @return {model:zrender/Element}\n     * @method\n     */\n    findHover: function(x, y, exclude) {\n        var list = this.storage.getDisplayList();\n        var out = {x: x, y: y};\n\n        for (var i = list.length - 1; i >= 0 ; i--) {\n            var hoverCheckResult;\n            if (list[i] !== exclude\n                // getDisplayList may include ignored item in VML mode\n                && !list[i].ignore\n                && (hoverCheckResult = isHover(list[i], x, y))\n            ) {\n                !out.topTarget && (out.topTarget = list[i]);\n                if (hoverCheckResult !== SILENT) {\n                    out.target = list[i];\n                    break;\n                }\n            }\n        }\n\n        return out;\n    }\n};\n\n// Common handlers\neach$1(['click', 'mousedown', 'mouseup', 'mousewheel', 'dblclick', 'contextmenu'], function (name) {\n    Handler.prototype[name] = function (event) {\n        // Find hover again to avoid click event is dispatched manually. Or click is triggered without mouseover\n        var hovered = this.findHover(event.zrX, event.zrY);\n        var hoveredTarget = hovered.target;\n\n        if (name === 'mousedown') {\n            this._downEl = hoveredTarget;\n            this._downPoint = [event.zrX, event.zrY];\n            // In case click triggered before mouseup\n            this._upEl = hoveredTarget;\n        }\n        else if (name === 'mouseup') {\n            this._upEl = hoveredTarget;\n        }\n        else if (name === 'click') {\n            if (this._downEl !== this._upEl\n                // Original click event is triggered on the whole canvas element,\n                // including the case that `mousedown` - `mousemove` - `mouseup`,\n                // which should be filtered, otherwise it will bring trouble to\n                // pan and zoom.\n                || !this._downPoint\n                // Arbitrary value\n                || dist(this._downPoint, [event.zrX, event.zrY]) > 4\n            ) {\n                return;\n            }\n            this._downPoint = null;\n        }\n\n        this.dispatchToElement(hovered, name, event);\n    };\n});\n\nfunction isHover(displayable, x, y) {\n    if (displayable[displayable.rectHover ? 'rectContain' : 'contain'](x, y)) {\n        var el = displayable;\n        var isSilent;\n        while (el) {\n            // If clipped by ancestor.\n            // FIXME: If clipPath has neither stroke nor fill,\n            // el.clipPath.contain(x, y) will always return false.\n            if (el.clipPath && !el.clipPath.contain(x, y))  {\n                return false;\n            }\n            if (el.silent) {\n                isSilent = true;\n            }\n            el = el.parent;\n        }\n        return isSilent ? SILENT : true;\n    }\n\n    return false;\n}\n\nmixin(Handler, Eventful);\nmixin(Handler, Draggable);\n\n/**\n * 3x2\n * @exports zrender/tool/matrix\n */\n\nvar ArrayCtor$1 = typeof Float32Array === 'undefined'\n    ? Array\n   : Float32Array;\n\n/**\n * Create a identity matrix.\n * @return {Float32Array|Array.<number>}\n */\nfunction create$1() {\n    var out = new ArrayCtor$1(6);\n    identity(out);\n\n    return out;\n}\n\n/**\n * \n * @param {Float32Array|Array.<number>} out\n */\nfunction identity(out) {\n    out[0] = 1;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 1;\n    out[4] = 0;\n    out[5] = 0;\n    return out;\n}\n\n/**\n * \n * @param {Float32Array|Array.<number>} out\n * @param {Float32Array|Array.<number>} m\n */\nfunction copy$1(out, m) {\n    out[0] = m[0];\n    out[1] = m[1];\n    out[2] = m[2];\n    out[3] = m[3];\n    out[4] = m[4];\n    out[5] = m[5];\n    return out;\n}\n\n/**\n * \n * @param {Float32Array|Array.<number>} out\n * @param {Float32Array|Array.<number>} m1\n * @param {Float32Array|Array.<number>} m2\n */\nfunction mul$1(out, m1, m2) {\n    // Consider matrix.mul(m, m2, m);\n    // where out is the same as m2.\n    // So use temp variable to escape error.\n    var out0 = m1[0] * m2[0] + m1[2] * m2[1];\n    var out1 = m1[1] * m2[0] + m1[3] * m2[1];\n    var out2 = m1[0] * m2[2] + m1[2] * m2[3];\n    var out3 = m1[1] * m2[2] + m1[3] * m2[3];\n    var out4 = m1[0] * m2[4] + m1[2] * m2[5] + m1[4];\n    var out5 = m1[1] * m2[4] + m1[3] * m2[5] + m1[5];\n    out[0] = out0;\n    out[1] = out1;\n    out[2] = out2;\n    out[3] = out3;\n    out[4] = out4;\n    out[5] = out5;\n    return out;\n}\n\n/**\n * \n * @param {Float32Array|Array.<number>} out\n * @param {Float32Array|Array.<number>} a\n * @param {Float32Array|Array.<number>} v\n */\nfunction translate(out, a, v) {\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    out[4] = a[4] + v[0];\n    out[5] = a[5] + v[1];\n    return out;\n}\n\n/**\n * \n * @param {Float32Array|Array.<number>} out\n * @param {Float32Array|Array.<number>} a\n * @param {number} rad\n */\nfunction rotate(out, a, rad) {\n    var aa = a[0];\n    var ac = a[2];\n    var atx = a[4];\n    var ab = a[1];\n    var ad = a[3];\n    var aty = a[5];\n    var st = Math.sin(rad);\n    var ct = Math.cos(rad);\n\n    out[0] = aa * ct + ab * st;\n    out[1] = -aa * st + ab * ct;\n    out[2] = ac * ct + ad * st;\n    out[3] = -ac * st + ct * ad;\n    out[4] = ct * atx + st * aty;\n    out[5] = ct * aty - st * atx;\n    return out;\n}\n\n/**\n * \n * @param {Float32Array|Array.<number>} out\n * @param {Float32Array|Array.<number>} a\n * @param {Float32Array|Array.<number>} v\n */\nfunction scale$1(out, a, v) {\n    var vx = v[0];\n    var vy = v[1];\n    out[0] = a[0] * vx;\n    out[1] = a[1] * vy;\n    out[2] = a[2] * vx;\n    out[3] = a[3] * vy;\n    out[4] = a[4] * vx;\n    out[5] = a[5] * vy;\n    return out;\n}\n\n/**\n * \n * @param {Float32Array|Array.<number>} out\n * @param {Float32Array|Array.<number>} a\n */\nfunction invert(out, a) {\n\n    var aa = a[0];\n    var ac = a[2];\n    var atx = a[4];\n    var ab = a[1];\n    var ad = a[3];\n    var aty = a[5];\n\n    var det = aa * ad - ab * ac;\n    if (!det) {\n        return null;\n    }\n    det = 1.0 / det;\n\n    out[0] = ad * det;\n    out[1] = -ab * det;\n    out[2] = -ac * det;\n    out[3] = aa * det;\n    out[4] = (ac * aty - ad * atx) * det;\n    out[5] = (ab * atx - aa * aty) * det;\n    return out;\n}\n\n/**\n * Clone a new matrix.\n * @param {Float32Array|Array.<number>} a\n */\nfunction clone$2(a) {\n    var b = create$1();\n    copy$1(b, a);\n    return b;\n}\n\nvar matrix = (Object.freeze || Object)({\n\tcreate: create$1,\n\tidentity: identity,\n\tcopy: copy$1,\n\tmul: mul$1,\n\ttranslate: translate,\n\trotate: rotate,\n\tscale: scale$1,\n\tinvert: invert,\n\tclone: clone$2\n});\n\n/**\n * \n * @module zrender/mixin/Transformable\n * @author pissang (https://www.github.com/pissang)\n */\n\nvar mIdentity = identity;\n\nvar EPSILON = 5e-5;\n\nfunction isNotAroundZero(val) {\n    return val > EPSILON || val < -EPSILON;\n}\n\n/**\n * @alias module:zrender/mixin/Transformable\n * @constructor\n */\nvar Transformable = function (opts) {\n    opts = opts || {};\n    // If there are no given position, rotation, scale\n    if (!opts.position) {\n        /**\n         * \n         * @type {Array.<number>}\n         * @default [0, 0]\n         */\n        this.position = [0, 0];\n    }\n    if (opts.rotation == null) {\n        /**\n         * \n         * @type {Array.<number>}\n         * @default 0\n         */\n        this.rotation = 0;\n    }\n    if (!opts.scale) {\n        /**\n         * \n         * @type {Array.<number>}\n         * @default [1, 1]\n         */\n        this.scale = [1, 1];\n    }\n    /**\n     * \n     * @type {Array.<number>}\n     * @default null\n     */\n    this.origin = this.origin || null;\n};\n\nvar transformableProto = Transformable.prototype;\ntransformableProto.transform = null;\n\n/**\n * \n * , position, rotation, scaletransformtransform\n */\ntransformableProto.needLocalTransform = function () {\n    return isNotAroundZero(this.rotation)\n        || isNotAroundZero(this.position[0])\n        || isNotAroundZero(this.position[1])\n        || isNotAroundZero(this.scale[0] - 1)\n        || isNotAroundZero(this.scale[1] - 1);\n};\n\ntransformableProto.updateTransform = function () {\n    var parent = this.parent;\n    var parentHasTransform = parent && parent.transform;\n    var needLocalTransform = this.needLocalTransform();\n\n    var m = this.transform;\n    if (!(needLocalTransform || parentHasTransform)) {\n        m && mIdentity(m);\n        return;\n    }\n\n    m = m || create$1();\n\n    if (needLocalTransform) {\n        this.getLocalTransform(m);\n    }\n    else {\n        mIdentity(m);\n    }\n\n    // \n    if (parentHasTransform) {\n        if (needLocalTransform) {\n            mul$1(m, parent.transform, m);\n        }\n        else {\n            copy$1(m, parent.transform);\n        }\n    }\n    // \n    this.transform = m;\n\n    this.invTransform = this.invTransform || create$1();\n    invert(this.invTransform, m);\n};\n\ntransformableProto.getLocalTransform = function (m) {\n    return Transformable.getLocalTransform(this, m);\n};\n\n/**\n * transformcontext\n * @param {CanvasRenderingContext2D} ctx\n */\ntransformableProto.setTransform = function (ctx) {\n    var m = this.transform;\n    var dpr = ctx.dpr || 1;\n    if (m) {\n        ctx.setTransform(dpr * m[0], dpr * m[1], dpr * m[2], dpr * m[3], dpr * m[4], dpr * m[5]);\n    }\n    else {\n        ctx.setTransform(dpr, 0, 0, dpr, 0, 0);\n    }\n};\n\ntransformableProto.restoreTransform = function (ctx) {\n    var dpr = ctx.dpr || 1;\n    ctx.setTransform(dpr, 0, 0, dpr, 0, 0);\n};\n\nvar tmpTransform = [];\n\n/**\n * `transform``position`, `rotation`, `scale`\n */\ntransformableProto.decomposeTransform = function () {\n    if (!this.transform) {\n        return;\n    }\n    var parent = this.parent;\n    var m = this.transform;\n    if (parent && parent.transform) {\n        // Get local transform and decompose them to position, scale, rotation\n        mul$1(tmpTransform, parent.invTransform, m);\n        m = tmpTransform;\n    }\n    var sx = m[0] * m[0] + m[1] * m[1];\n    var sy = m[2] * m[2] + m[3] * m[3];\n    var position = this.position;\n    var scale$$1 = this.scale;\n    if (isNotAroundZero(sx - 1)) {\n        sx = Math.sqrt(sx);\n    }\n    if (isNotAroundZero(sy - 1)) {\n        sy = Math.sqrt(sy);\n    }\n    if (m[0] < 0) {\n        sx = -sx;\n    }\n    if (m[3] < 0) {\n        sy = -sy;\n    }\n    position[0] = m[4];\n    position[1] = m[5];\n    scale$$1[0] = sx;\n    scale$$1[1] = sy;\n    this.rotation = Math.atan2(-m[1] / sy, m[0] / sx);\n};\n\n/**\n * Get global scale\n * @return {Array.<number>}\n */\ntransformableProto.getGlobalScale = function () {\n    var m = this.transform;\n    if (!m) {\n        return [1, 1];\n    }\n    var sx = Math.sqrt(m[0] * m[0] + m[1] * m[1]);\n    var sy = Math.sqrt(m[2] * m[2] + m[3] * m[3]);\n    if (m[0] < 0) {\n        sx = -sx;\n    }\n    if (m[3] < 0) {\n        sy = -sy;\n    }\n    return [sx, sy];\n};\n/**\n *  shape \n * @method\n * @param {number} x\n * @param {number} y\n * @return {Array.<number>}\n */\ntransformableProto.transformCoordToLocal = function (x, y) {\n    var v2 = [x, y];\n    var invTransform = this.invTransform;\n    if (invTransform) {\n        applyTransform(v2, v2, invTransform);\n    }\n    return v2;\n};\n\n/**\n * \n * @method\n * @param {number} x\n * @param {number} y\n * @return {Array.<number>}\n */\ntransformableProto.transformCoordToGlobal = function (x, y) {\n    var v2 = [x, y];\n    var transform = this.transform;\n    if (transform) {\n        applyTransform(v2, v2, transform);\n    }\n    return v2;\n};\n\n/**\n * @static\n * @param {Object} target\n * @param {Array.<number>} target.origin\n * @param {number} target.rotation\n * @param {Array.<number>} target.position\n * @param {Array.<number>} [m]\n */\nTransformable.getLocalTransform = function (target, m) {\n    m = m || [];\n    mIdentity(m);\n\n    var origin = target.origin;\n    var scale$$1 = target.scale || [1, 1];\n    var rotation = target.rotation || 0;\n    var position = target.position || [0, 0];\n\n    if (origin) {\n        // Translate to origin\n        m[4] -= origin[0];\n        m[5] -= origin[1];\n    }\n    scale$1(m, m, scale$$1);\n    if (rotation) {\n        rotate(m, m, rotation);\n    }\n    if (origin) {\n        // Translate back from origin\n        m[4] += origin[0];\n        m[5] += origin[1];\n    }\n\n    m[4] += position[0];\n    m[5] += position[1];\n\n    return m;\n};\n\n/**\n *  https://github.com/sole/tween.js/blob/master/src/Tween.js\n * @see http://sole.github.io/tween.js/examples/03_graphs.html\n * @exports zrender/animation/easing\n */\nvar easing = {\n    /**\n    * @param {number} k\n    * @return {number}\n    */\n    linear: function (k) {\n        return k;\n    },\n\n    /**\n    * @param {number} k\n    * @return {number}\n    */\n    quadraticIn: function (k) {\n        return k * k;\n    },\n    /**\n    * @param {number} k\n    * @return {number}\n    */\n    quadraticOut: function (k) {\n        return k * (2 - k);\n    },\n    /**\n    * @param {number} k\n    * @return {number}\n    */\n    quadraticInOut: function (k) {\n        if ((k *= 2) < 1) {\n            return 0.5 * k * k;\n        }\n        return -0.5 * (--k * (k - 2) - 1);\n    },\n\n    // t^3\n    /**\n    * @param {number} k\n    * @return {number}\n    */\n    cubicIn: function (k) {\n        return k * k * k;\n    },\n    /**\n    * @param {number} k\n    * @return {number}\n    */\n    cubicOut: function (k) {\n        return --k * k * k + 1;\n    },\n    /**\n    * @param {number} k\n    * @return {number}\n    */\n    cubicInOut: function (k) {\n        if ((k *= 2) < 1) {\n            return 0.5 * k * k * k;\n        }\n        return 0.5 * ((k -= 2) * k * k + 2);\n    },\n\n    // t^4\n    /**\n    * @param {number} k\n    * @return {number}\n    */\n    quarticIn: function (k) {\n        return k * k * k * k;\n    },\n    /**\n    * @param {number} k\n    * @return {number}\n    */\n    quarticOut: function (k) {\n        return 1 - (--k * k * k * k);\n    },\n    /**\n    * @param {number} k\n    * @return {number}\n    */\n    quarticInOut: function (k) {\n        if ((k *= 2) < 1) {\n            return 0.5 * k * k * k * k;\n        }\n        return -0.5 * ((k -= 2) * k * k * k - 2);\n    },\n\n    // t^5\n    /**\n    * @param {number} k\n    * @return {number}\n    */\n    quinticIn: function (k) {\n        return k * k * k * k * k;\n    },\n    /**\n    * @param {number} k\n    * @return {number}\n    */\n    quinticOut: function (k) {\n        return --k * k * k * k * k + 1;\n    },\n    /**\n    * @param {number} k\n    * @return {number}\n    */\n    quinticInOut: function (k) {\n        if ((k *= 2) < 1) {\n            return 0.5 * k * k * k * k * k;\n        }\n        return 0.5 * ((k -= 2) * k * k * k * k + 2);\n    },\n\n    // sin(t)\n    /**\n    * @param {number} k\n    * @return {number}\n    */\n    sinusoidalIn: function (k) {\n        return 1 - Math.cos(k * Math.PI / 2);\n    },\n    /**\n    * @param {number} k\n    * @return {number}\n    */\n    sinusoidalOut: function (k) {\n        return Math.sin(k * Math.PI / 2);\n    },\n    /**\n    * @param {number} k\n    * @return {number}\n    */\n    sinusoidalInOut: function (k) {\n        return 0.5 * (1 - Math.cos(Math.PI * k));\n    },\n\n    // 2^t\n    /**\n    * @param {number} k\n    * @return {number}\n    */\n    exponentialIn: function (k) {\n        return k === 0 ? 0 : Math.pow(1024, k - 1);\n    },\n    /**\n    * @param {number} k\n    * @return {number}\n    */\n    exponentialOut: function (k) {\n        return k === 1 ? 1 : 1 - Math.pow(2, -10 * k);\n    },\n    /**\n    * @param {number} k\n    * @return {number}\n    */\n    exponentialInOut: function (k) {\n        if (k === 0) {\n            return 0;\n        }\n        if (k === 1) {\n            return 1;\n        }\n        if ((k *= 2) < 1) {\n            return 0.5 * Math.pow(1024, k - 1);\n        }\n        return 0.5 * (-Math.pow(2, -10 * (k - 1)) + 2);\n    },\n\n    // sqrt(1-t^2)\n    /**\n    * @param {number} k\n    * @return {number}\n    */\n    circularIn: function (k) {\n        return 1 - Math.sqrt(1 - k * k);\n    },\n    /**\n    * @param {number} k\n    * @return {number}\n    */\n    circularOut: function (k) {\n        return Math.sqrt(1 - (--k * k));\n    },\n    /**\n    * @param {number} k\n    * @return {number}\n    */\n    circularInOut: function (k) {\n        if ((k *= 2) < 1) {\n            return -0.5 * (Math.sqrt(1 - k * k) - 1);\n        }\n        return 0.5 * (Math.sqrt(1 - (k -= 2) * k) + 1);\n    },\n\n    // \n    /**\n    * @param {number} k\n    * @return {number}\n    */\n    elasticIn: function (k) {\n        var s;\n        var a = 0.1;\n        var p = 0.4;\n        if (k === 0) {\n            return 0;\n        }\n        if (k === 1) {\n            return 1;\n        }\n        if (!a || a < 1) {\n            a = 1; s = p / 4;\n        }\n        else {\n            s = p * Math.asin(1 / a) / (2 * Math.PI);\n        }\n        return -(a * Math.pow(2, 10 * (k -= 1)) *\n                    Math.sin((k - s) * (2 * Math.PI) / p));\n    },\n    /**\n    * @param {number} k\n    * @return {number}\n    */\n    elasticOut: function (k) {\n        var s;\n        var a = 0.1;\n        var p = 0.4;\n        if (k === 0) {\n            return 0;\n        }\n        if (k === 1) {\n            return 1;\n        }\n        if (!a || a < 1) {\n            a = 1; s = p / 4;\n        }\n        else {\n            s = p * Math.asin(1 / a) / (2 * Math.PI);\n        }\n        return (a * Math.pow(2, -10 * k) *\n                Math.sin((k - s) * (2 * Math.PI) / p) + 1);\n    },\n    /**\n    * @param {number} k\n    * @return {number}\n    */\n    elasticInOut: function (k) {\n        var s;\n        var a = 0.1;\n        var p = 0.4;\n        if (k === 0) {\n            return 0;\n        }\n        if (k === 1) {\n            return 1;\n        }\n        if (!a || a < 1) {\n            a = 1; s = p / 4;\n        }\n        else {\n            s = p * Math.asin(1 / a) / (2 * Math.PI);\n        }\n        if ((k *= 2) < 1) {\n            return -0.5 * (a * Math.pow(2, 10 * (k -= 1))\n                * Math.sin((k - s) * (2 * Math.PI) / p));\n        }\n        return a * Math.pow(2, -10 * (k -= 1))\n                * Math.sin((k - s) * (2 * Math.PI) / p) * 0.5 + 1;\n\n    },\n\n    // \n    /**\n    * @param {number} k\n    * @return {number}\n    */\n    backIn: function (k) {\n        var s = 1.70158;\n        return k * k * ((s + 1) * k - s);\n    },\n    /**\n    * @param {number} k\n    * @return {number}\n    */\n    backOut: function (k) {\n        var s = 1.70158;\n        return --k * k * ((s + 1) * k + s) + 1;\n    },\n    /**\n    * @param {number} k\n    * @return {number}\n    */\n    backInOut: function (k) {\n        var s = 1.70158 * 1.525;\n        if ((k *= 2) < 1) {\n            return 0.5 * (k * k * ((s + 1) * k - s));\n        }\n        return 0.5 * ((k -= 2) * k * ((s + 1) * k + s) + 2);\n    },\n\n    // \n    /**\n    * @param {number} k\n    * @return {number}\n    */\n    bounceIn: function (k) {\n        return 1 - easing.bounceOut(1 - k);\n    },\n    /**\n    * @param {number} k\n    * @return {number}\n    */\n    bounceOut: function (k) {\n        if (k < (1 / 2.75)) {\n            return 7.5625 * k * k;\n        }\n        else if (k < (2 / 2.75)) {\n            return 7.5625 * (k -= (1.5 / 2.75)) * k + 0.75;\n        }\n        else if (k < (2.5 / 2.75)) {\n            return 7.5625 * (k -= (2.25 / 2.75)) * k + 0.9375;\n        }\n        else {\n            return 7.5625 * (k -= (2.625 / 2.75)) * k + 0.984375;\n        }\n    },\n    /**\n    * @param {number} k\n    * @return {number}\n    */\n    bounceInOut: function (k) {\n        if (k < 0.5) {\n            return easing.bounceIn(k * 2) * 0.5;\n        }\n        return easing.bounceOut(k * 2 - 1) * 0.5 + 0.5;\n    }\n};\n\n/**\n * \n * @config target onframe\n * @config life(1000) \n * @config delay(0) \n * @config loop(true)\n * @config gap(0) \n * @config onframe\n * @config easing(optional)\n * @config ondestroy(optional)\n * @config onrestart(optional)\n *\n * TODO pause\n */\n\nfunction Clip(options) {\n\n    this._target = options.target;\n\n    // \n    this._life = options.life || 1000;\n    // \n    this._delay = options.delay || 0;\n    // \n    // this._startTime = new Date().getTime() + this._delay;// \n    this._initialized = false;\n\n    // \n    this.loop = options.loop == null ? false : options.loop;\n\n    this.gap = options.gap || 0;\n\n    this.easing = options.easing || 'Linear';\n\n    this.onframe = options.onframe;\n    this.ondestroy = options.ondestroy;\n    this.onrestart = options.onrestart;\n\n    this._pausedTime = 0;\n    this._paused = false;\n}\n\nClip.prototype = {\n\n    constructor: Clip,\n\n    step: function (globalTime, deltaTime) {\n        // Set startTime on first step, or _startTime may has milleseconds different between clips\n        // PENDING\n        if (!this._initialized) {\n            this._startTime = globalTime + this._delay;\n            this._initialized = true;\n        }\n\n        if (this._paused) {\n            this._pausedTime += deltaTime;\n            return;\n        }\n\n        var percent = (globalTime - this._startTime - this._pausedTime) / this._life;\n\n        // \n        if (percent < 0) {\n            return;\n        }\n\n        percent = Math.min(percent, 1);\n\n        var easing$$1 = this.easing;\n        var easingFunc = typeof easing$$1 == 'string' ? easing[easing$$1] : easing$$1;\n        var schedule = typeof easingFunc === 'function'\n            ? easingFunc(percent)\n            : percent;\n\n        this.fire('frame', schedule);\n\n        // \n        if (percent == 1) {\n            if (this.loop) {\n                this.restart (globalTime);\n                // \n                //  stage.update \n                return 'restart';\n            }\n\n            // \n            // Animation.update\n            this._needsRemove = true;\n            return 'destroy';\n        }\n\n        return null;\n    },\n\n    restart: function (globalTime) {\n        var remainder = (globalTime - this._startTime - this._pausedTime) % this._life;\n        this._startTime = globalTime - remainder + this.gap;\n        this._pausedTime = 0;\n\n        this._needsRemove = false;\n    },\n\n    fire: function (eventType, arg) {\n        eventType = 'on' + eventType;\n        if (this[eventType]) {\n            this[eventType](this._target, arg);\n        }\n    },\n\n    pause: function () {\n        this._paused = true;\n    },\n\n    resume: function () {\n        this._paused = false;\n    }\n};\n\n// Simple LRU cache use doubly linked list\n// @module zrender/core/LRU\n\n/**\n * Simple double linked list. Compared with array, it has O(1) remove operation.\n * @constructor\n */\nvar LinkedList = function () {\n\n    /**\n     * @type {module:zrender/core/LRU~Entry}\n     */\n    this.head = null;\n\n    /**\n     * @type {module:zrender/core/LRU~Entry}\n     */\n    this.tail = null;\n\n    this._len = 0;\n};\n\nvar linkedListProto = LinkedList.prototype;\n/**\n * Insert a new value at the tail\n * @param  {} val\n * @return {module:zrender/core/LRU~Entry}\n */\nlinkedListProto.insert = function (val) {\n    var entry = new Entry(val);\n    this.insertEntry(entry);\n    return entry;\n};\n\n/**\n * Insert an entry at the tail\n * @param  {module:zrender/core/LRU~Entry} entry\n */\nlinkedListProto.insertEntry = function (entry) {\n    if (!this.head) {\n        this.head = this.tail = entry;\n    }\n    else {\n        this.tail.next = entry;\n        entry.prev = this.tail;\n        entry.next = null;\n        this.tail = entry;\n    }\n    this._len++;\n};\n\n/**\n * Remove entry.\n * @param  {module:zrender/core/LRU~Entry} entry\n */\nlinkedListProto.remove = function (entry) {\n    var prev = entry.prev;\n    var next = entry.next;\n    if (prev) {\n        prev.next = next;\n    }\n    else {\n        // Is head\n        this.head = next;\n    }\n    if (next) {\n        next.prev = prev;\n    }\n    else {\n        // Is tail\n        this.tail = prev;\n    }\n    entry.next = entry.prev = null;\n    this._len--;\n};\n\n/**\n * @return {number}\n */\nlinkedListProto.len = function () {\n    return this._len;\n};\n\n/**\n * Clear list\n */\nlinkedListProto.clear = function () {\n    this.head = this.tail = null;\n    this._len = 0;\n};\n\n/**\n * @constructor\n * @param {} val\n */\nvar Entry = function (val) {\n    /**\n     * @type {}\n     */\n    this.value = val;\n\n    /**\n     * @type {module:zrender/core/LRU~Entry}\n     */\n    this.next;\n\n    /**\n     * @type {module:zrender/core/LRU~Entry}\n     */\n    this.prev;\n};\n\n/**\n * LRU Cache\n * @constructor\n * @alias module:zrender/core/LRU\n */\nvar LRU = function (maxSize) {\n\n    this._list = new LinkedList();\n\n    this._map = {};\n\n    this._maxSize = maxSize || 10;\n\n    this._lastRemovedEntry = null;\n};\n\nvar LRUProto = LRU.prototype;\n\n/**\n * @param  {string} key\n * @param  {} value\n * @return {} Removed value\n */\nLRUProto.put = function (key, value) {\n    var list = this._list;\n    var map = this._map;\n    var removed = null;\n    if (map[key] == null) {\n        var len = list.len();\n        // Reuse last removed entry\n        var entry = this._lastRemovedEntry;\n\n        if (len >= this._maxSize && len > 0) {\n            // Remove the least recently used\n            var leastUsedEntry = list.head;\n            list.remove(leastUsedEntry);\n            delete map[leastUsedEntry.key];\n\n            removed = leastUsedEntry.value;\n            this._lastRemovedEntry = leastUsedEntry;\n        }\n\n        if (entry) {\n            entry.value = value;\n        }\n        else {\n            entry = new Entry(value);\n        }\n        entry.key = key;\n        list.insertEntry(entry);\n        map[key] = entry;\n    }\n\n    return removed;\n};\n\n/**\n * @param  {string} key\n * @return {}\n */\nLRUProto.get = function (key) {\n    var entry = this._map[key];\n    var list = this._list;\n    if (entry != null) {\n        // Put the latest used entry in the tail\n        if (entry !== list.tail) {\n            list.remove(entry);\n            list.insertEntry(entry);\n        }\n\n        return entry.value;\n    }\n};\n\n/**\n * Clear the cache\n */\nLRUProto.clear = function () {\n    this._list.clear();\n    this._map = {};\n};\n\nvar kCSSColorTable = {\n    'transparent': [0,0,0,0], 'aliceblue': [240,248,255,1],\n    'antiquewhite': [250,235,215,1], 'aqua': [0,255,255,1],\n    'aquamarine': [127,255,212,1], 'azure': [240,255,255,1],\n    'beige': [245,245,220,1], 'bisque': [255,228,196,1],\n    'black': [0,0,0,1], 'blanchedalmond': [255,235,205,1],\n    'blue': [0,0,255,1], 'blueviolet': [138,43,226,1],\n    'brown': [165,42,42,1], 'burlywood': [222,184,135,1],\n    'cadetblue': [95,158,160,1], 'chartreuse': [127,255,0,1],\n    'chocolate': [210,105,30,1], 'coral': [255,127,80,1],\n    'cornflowerblue': [100,149,237,1], 'cornsilk': [255,248,220,1],\n    'crimson': [220,20,60,1], 'cyan': [0,255,255,1],\n    'darkblue': [0,0,139,1], 'darkcyan': [0,139,139,1],\n    'darkgoldenrod': [184,134,11,1], 'darkgray': [169,169,169,1],\n    'darkgreen': [0,100,0,1], 'darkgrey': [169,169,169,1],\n    'darkkhaki': [189,183,107,1], 'darkmagenta': [139,0,139,1],\n    'darkolivegreen': [85,107,47,1], 'darkorange': [255,140,0,1],\n    'darkorchid': [153,50,204,1], 'darkred': [139,0,0,1],\n    'darksalmon': [233,150,122,1], 'darkseagreen': [143,188,143,1],\n    'darkslateblue': [72,61,139,1], 'darkslategray': [47,79,79,1],\n    'darkslategrey': [47,79,79,1], 'darkturquoise': [0,206,209,1],\n    'darkviolet': [148,0,211,1], 'deeppink': [255,20,147,1],\n    'deepskyblue': [0,191,255,1], 'dimgray': [105,105,105,1],\n    'dimgrey': [105,105,105,1], 'dodgerblue': [30,144,255,1],\n    'firebrick': [178,34,34,1], 'floralwhite': [255,250,240,1],\n    'forestgreen': [34,139,34,1], 'fuchsia': [255,0,255,1],\n    'gainsboro': [220,220,220,1], 'ghostwhite': [248,248,255,1],\n    'gold': [255,215,0,1], 'goldenrod': [218,165,32,1],\n    'gray': [128,128,128,1], 'green': [0,128,0,1],\n    'greenyellow': [173,255,47,1], 'grey': [128,128,128,1],\n    'honeydew': [240,255,240,1], 'hotpink': [255,105,180,1],\n    'indianred': [205,92,92,1], 'indigo': [75,0,130,1],\n    'ivory': [255,255,240,1], 'khaki': [240,230,140,1],\n    'lavender': [230,230,250,1], 'lavenderblush': [255,240,245,1],\n    'lawngreen': [124,252,0,1], 'lemonchiffon': [255,250,205,1],\n    'lightblue': [173,216,230,1], 'lightcoral': [240,128,128,1],\n    'lightcyan': [224,255,255,1], 'lightgoldenrodyellow': [250,250,210,1],\n    'lightgray': [211,211,211,1], 'lightgreen': [144,238,144,1],\n    'lightgrey': [211,211,211,1], 'lightpink': [255,182,193,1],\n    'lightsalmon': [255,160,122,1], 'lightseagreen': [32,178,170,1],\n    'lightskyblue': [135,206,250,1], 'lightslategray': [119,136,153,1],\n    'lightslategrey': [119,136,153,1], 'lightsteelblue': [176,196,222,1],\n    'lightyellow': [255,255,224,1], 'lime': [0,255,0,1],\n    'limegreen': [50,205,50,1], 'linen': [250,240,230,1],\n    'magenta': [255,0,255,1], 'maroon': [128,0,0,1],\n    'mediumaquamarine': [102,205,170,1], 'mediumblue': [0,0,205,1],\n    'mediumorchid': [186,85,211,1], 'mediumpurple': [147,112,219,1],\n    'mediumseagreen': [60,179,113,1], 'mediumslateblue': [123,104,238,1],\n    'mediumspringgreen': [0,250,154,1], 'mediumturquoise': [72,209,204,1],\n    'mediumvioletred': [199,21,133,1], 'midnightblue': [25,25,112,1],\n    'mintcream': [245,255,250,1], 'mistyrose': [255,228,225,1],\n    'moccasin': [255,228,181,1], 'navajowhite': [255,222,173,1],\n    'navy': [0,0,128,1], 'oldlace': [253,245,230,1],\n    'olive': [128,128,0,1], 'olivedrab': [107,142,35,1],\n    'orange': [255,165,0,1], 'orangered': [255,69,0,1],\n    'orchid': [218,112,214,1], 'palegoldenrod': [238,232,170,1],\n    'palegreen': [152,251,152,1], 'paleturquoise': [175,238,238,1],\n    'palevioletred': [219,112,147,1], 'papayawhip': [255,239,213,1],\n    'peachpuff': [255,218,185,1], 'peru': [205,133,63,1],\n    'pink': [255,192,203,1], 'plum': [221,160,221,1],\n    'powderblue': [176,224,230,1], 'purple': [128,0,128,1],\n    'red': [255,0,0,1], 'rosybrown': [188,143,143,1],\n    'royalblue': [65,105,225,1], 'saddlebrown': [139,69,19,1],\n    'salmon': [250,128,114,1], 'sandybrown': [244,164,96,1],\n    'seagreen': [46,139,87,1], 'seashell': [255,245,238,1],\n    'sienna': [160,82,45,1], 'silver': [192,192,192,1],\n    'skyblue': [135,206,235,1], 'slateblue': [106,90,205,1],\n    'slategray': [112,128,144,1], 'slategrey': [112,128,144,1],\n    'snow': [255,250,250,1], 'springgreen': [0,255,127,1],\n    'steelblue': [70,130,180,1], 'tan': [210,180,140,1],\n    'teal': [0,128,128,1], 'thistle': [216,191,216,1],\n    'tomato': [255,99,71,1], 'turquoise': [64,224,208,1],\n    'violet': [238,130,238,1], 'wheat': [245,222,179,1],\n    'white': [255,255,255,1], 'whitesmoke': [245,245,245,1],\n    'yellow': [255,255,0,1], 'yellowgreen': [154,205,50,1]\n};\n\nfunction clampCssByte(i) {  // Clamp to integer 0 .. 255.\n    i = Math.round(i);  // Seems to be what Chrome does (vs truncation).\n    return i < 0 ? 0 : i > 255 ? 255 : i;\n}\n\nfunction clampCssAngle(i) {  // Clamp to integer 0 .. 360.\n    i = Math.round(i);  // Seems to be what Chrome does (vs truncation).\n    return i < 0 ? 0 : i > 360 ? 360 : i;\n}\n\nfunction clampCssFloat(f) {  // Clamp to float 0.0 .. 1.0.\n    return f < 0 ? 0 : f > 1 ? 1 : f;\n}\n\nfunction parseCssInt(str) {  // int or percentage.\n    if (str.length && str.charAt(str.length - 1) === '%') {\n        return clampCssByte(parseFloat(str) / 100 * 255);\n    }\n    return clampCssByte(parseInt(str, 10));\n}\n\nfunction parseCssFloat(str) {  // float or percentage.\n    if (str.length && str.charAt(str.length - 1) === '%') {\n        return clampCssFloat(parseFloat(str) / 100);\n    }\n    return clampCssFloat(parseFloat(str));\n}\n\nfunction cssHueToRgb(m1, m2, h) {\n    if (h < 0) {\n        h += 1;\n    }\n    else if (h > 1) {\n        h -= 1;\n    }\n\n    if (h * 6 < 1) {\n        return m1 + (m2 - m1) * h * 6;\n    }\n    if (h * 2 < 1) {\n        return m2;\n    }\n    if (h * 3 < 2) {\n        return m1 + (m2 - m1) * (2/3 - h) * 6;\n    }\n    return m1;\n}\n\nfunction lerpNumber(a, b, p) {\n    return a + (b - a) * p;\n}\n\nfunction setRgba(out, r, g, b, a) {\n    out[0] = r; out[1] = g; out[2] = b; out[3] = a;\n    return out;\n}\nfunction copyRgba(out, a) {\n    out[0] = a[0]; out[1] = a[1]; out[2] = a[2]; out[3] = a[3];\n    return out;\n}\n\nvar colorCache = new LRU(20);\nvar lastRemovedArr = null;\n\nfunction putToCache(colorStr, rgbaArr) {\n    // Reuse removed array\n    if (lastRemovedArr) {\n        copyRgba(lastRemovedArr, rgbaArr);\n    }\n    lastRemovedArr = colorCache.put(colorStr, lastRemovedArr || (rgbaArr.slice()));\n}\n\n/**\n * @param {string} colorStr\n * @param {Array.<number>} out\n * @return {Array.<number>}\n * @memberOf module:zrender/util/color\n */\nfunction parse(colorStr, rgbaArr) {\n    if (!colorStr) {\n        return;\n    }\n    rgbaArr = rgbaArr || [];\n\n    var cached = colorCache.get(colorStr);\n    if (cached) {\n        return copyRgba(rgbaArr, cached);\n    }\n\n    // colorStr may be not string\n    colorStr = colorStr + '';\n    // Remove all whitespace, not compliant, but should just be more accepting.\n    var str = colorStr.replace(/ /g, '').toLowerCase();\n\n    // Color keywords (and transparent) lookup.\n    if (str in kCSSColorTable) {\n        copyRgba(rgbaArr, kCSSColorTable[str]);\n        putToCache(colorStr, rgbaArr);\n        return rgbaArr;\n    }\n\n    // #abc and #abc123 syntax.\n    if (str.charAt(0) === '#') {\n        if (str.length === 4) {\n            var iv = parseInt(str.substr(1), 16);  // TODO(deanm): Stricter parsing.\n            if (!(iv >= 0 && iv <= 0xfff)) {\n                setRgba(rgbaArr, 0, 0, 0, 1);\n                return;  // Covers NaN.\n            }\n            setRgba(rgbaArr,\n                ((iv & 0xf00) >> 4) | ((iv & 0xf00) >> 8),\n                (iv & 0xf0) | ((iv & 0xf0) >> 4),\n                (iv & 0xf) | ((iv & 0xf) << 4),\n                1\n            );\n            putToCache(colorStr, rgbaArr);\n            return rgbaArr;\n        }\n        else if (str.length === 7) {\n            var iv = parseInt(str.substr(1), 16);  // TODO(deanm): Stricter parsing.\n            if (!(iv >= 0 && iv <= 0xffffff)) {\n                setRgba(rgbaArr, 0, 0, 0, 1);\n                return;  // Covers NaN.\n            }\n            setRgba(rgbaArr,\n                (iv & 0xff0000) >> 16,\n                (iv & 0xff00) >> 8,\n                iv & 0xff,\n                1\n            );\n            putToCache(colorStr, rgbaArr);\n            return rgbaArr;\n        }\n\n        return;\n    }\n    var op = str.indexOf('('), ep = str.indexOf(')');\n    if (op !== -1 && ep + 1 === str.length) {\n        var fname = str.substr(0, op);\n        var params = str.substr(op + 1, ep - (op + 1)).split(',');\n        var alpha = 1;  // To allow case fallthrough.\n        switch (fname) {\n            case 'rgba':\n                if (params.length !== 4) {\n                    setRgba(rgbaArr, 0, 0, 0, 1);\n                    return;\n                }\n                alpha = parseCssFloat(params.pop()); // jshint ignore:line\n            // Fall through.\n            case 'rgb':\n                if (params.length !== 3) {\n                    setRgba(rgbaArr, 0, 0, 0, 1);\n                    return;\n                }\n                setRgba(rgbaArr,\n                    parseCssInt(params[0]),\n                    parseCssInt(params[1]),\n                    parseCssInt(params[2]),\n                    alpha\n                );\n                putToCache(colorStr, rgbaArr);\n                return rgbaArr;\n            case 'hsla':\n                if (params.length !== 4) {\n                    setRgba(rgbaArr, 0, 0, 0, 1);\n                    return;\n                }\n                params[3] = parseCssFloat(params[3]);\n                hsla2rgba(params, rgbaArr);\n                putToCache(colorStr, rgbaArr);\n                return rgbaArr;\n            case 'hsl':\n                if (params.length !== 3) {\n                    setRgba(rgbaArr, 0, 0, 0, 1);\n                    return;\n                }\n                hsla2rgba(params, rgbaArr);\n                putToCache(colorStr, rgbaArr);\n                return rgbaArr;\n            default:\n                return;\n        }\n    }\n\n    setRgba(rgbaArr, 0, 0, 0, 1);\n    return;\n}\n\n/**\n * @param {Array.<number>} hsla\n * @param {Array.<number>} rgba\n * @return {Array.<number>} rgba\n */\nfunction hsla2rgba(hsla, rgba) {\n    var h = (((parseFloat(hsla[0]) % 360) + 360) % 360) / 360;  // 0 .. 1\n    // NOTE(deanm): According to the CSS spec s/l should only be\n    // percentages, but we don't bother and let float or percentage.\n    var s = parseCssFloat(hsla[1]);\n    var l = parseCssFloat(hsla[2]);\n    var m2 = l <= 0.5 ? l * (s + 1) : l + s - l * s;\n    var m1 = l * 2 - m2;\n\n    rgba = rgba || [];\n    setRgba(rgba,\n        clampCssByte(cssHueToRgb(m1, m2, h + 1 / 3) * 255),\n        clampCssByte(cssHueToRgb(m1, m2, h) * 255),\n        clampCssByte(cssHueToRgb(m1, m2, h - 1 / 3) * 255),\n        1\n    );\n\n    if (hsla.length === 4) {\n        rgba[3] = hsla[3];\n    }\n\n    return rgba;\n}\n\n/**\n * @param {Array.<number>} rgba\n * @return {Array.<number>} hsla\n */\nfunction rgba2hsla(rgba) {\n    if (!rgba) {\n        return;\n    }\n\n    // RGB from 0 to 255\n    var R = rgba[0] / 255;\n    var G = rgba[1] / 255;\n    var B = rgba[2] / 255;\n\n    var vMin = Math.min(R, G, B); // Min. value of RGB\n    var vMax = Math.max(R, G, B); // Max. value of RGB\n    var delta = vMax - vMin; // Delta RGB value\n\n    var L = (vMax + vMin) / 2;\n    var H;\n    var S;\n    // HSL results from 0 to 1\n    if (delta === 0) {\n        H = 0;\n        S = 0;\n    }\n    else {\n        if (L < 0.5) {\n            S = delta / (vMax + vMin);\n        }\n        else {\n            S = delta / (2 - vMax - vMin);\n        }\n\n        var deltaR = (((vMax - R) / 6) + (delta / 2)) / delta;\n        var deltaG = (((vMax - G) / 6) + (delta / 2)) / delta;\n        var deltaB = (((vMax - B) / 6) + (delta / 2)) / delta;\n\n        if (R === vMax) {\n            H = deltaB - deltaG;\n        }\n        else if (G === vMax) {\n            H = (1 / 3) + deltaR - deltaB;\n        }\n        else if (B === vMax) {\n            H = (2 / 3) + deltaG - deltaR;\n        }\n\n        if (H < 0) {\n            H += 1;\n        }\n\n        if (H > 1) {\n            H -= 1;\n        }\n    }\n\n    var hsla = [H * 360, S, L];\n\n    if (rgba[3] != null) {\n        hsla.push(rgba[3]);\n    }\n\n    return hsla;\n}\n\n/**\n * @param {string} color\n * @param {number} level\n * @return {string}\n * @memberOf module:zrender/util/color\n */\nfunction lift(color, level) {\n    var colorArr = parse(color);\n    if (colorArr) {\n        for (var i = 0; i < 3; i++) {\n            if (level < 0) {\n                colorArr[i] = colorArr[i] * (1 - level) | 0;\n            }\n            else {\n                colorArr[i] = ((255 - colorArr[i]) * level + colorArr[i]) | 0;\n            }\n            if (colorArr[i] > 255) {\n                colorArr[i] = 255;\n            }\n            else if (color[i] < 0) {\n                colorArr[i] = 0;\n            }\n        }\n        return stringify(colorArr, colorArr.length === 4 ? 'rgba' : 'rgb');\n    }\n}\n\n/**\n * @param {string} color\n * @return {string}\n * @memberOf module:zrender/util/color\n */\nfunction toHex(color) {\n    var colorArr = parse(color);\n    if (colorArr) {\n        return ((1 << 24) + (colorArr[0] << 16) + (colorArr[1] << 8) + (+colorArr[2])).toString(16).slice(1);\n    }\n}\n\n/**\n * Map value to color. Faster than lerp methods because color is represented by rgba array.\n * @param {number} normalizedValue A float between 0 and 1.\n * @param {Array.<Array.<number>>} colors List of rgba color array\n * @param {Array.<number>} [out] Mapped gba color array\n * @return {Array.<number>} will be null/undefined if input illegal.\n */\nfunction fastLerp(normalizedValue, colors, out) {\n    if (!(colors && colors.length)\n        || !(normalizedValue >= 0 && normalizedValue <= 1)\n    ) {\n        return;\n    }\n\n    out = out || [];\n\n    var value = normalizedValue * (colors.length - 1);\n    var leftIndex = Math.floor(value);\n    var rightIndex = Math.ceil(value);\n    var leftColor = colors[leftIndex];\n    var rightColor = colors[rightIndex];\n    var dv = value - leftIndex;\n    out[0] = clampCssByte(lerpNumber(leftColor[0], rightColor[0], dv));\n    out[1] = clampCssByte(lerpNumber(leftColor[1], rightColor[1], dv));\n    out[2] = clampCssByte(lerpNumber(leftColor[2], rightColor[2], dv));\n    out[3] = clampCssFloat(lerpNumber(leftColor[3], rightColor[3], dv));\n\n    return out;\n}\n\n/**\n * @deprecated\n */\nvar fastMapToColor = fastLerp;\n\n/**\n * @param {number} normalizedValue A float between 0 and 1.\n * @param {Array.<string>} colors Color list.\n * @param {boolean=} fullOutput Default false.\n * @return {(string|Object)} Result color. If fullOutput,\n *                           return {color: ..., leftIndex: ..., rightIndex: ..., value: ...},\n * @memberOf module:zrender/util/color\n */\nfunction lerp$1(normalizedValue, colors, fullOutput) {\n    if (!(colors && colors.length)\n        || !(normalizedValue >= 0 && normalizedValue <= 1)\n    ) {\n        return;\n    }\n\n    var value = normalizedValue * (colors.length - 1);\n    var leftIndex = Math.floor(value);\n    var rightIndex = Math.ceil(value);\n    var leftColor = parse(colors[leftIndex]);\n    var rightColor = parse(colors[rightIndex]);\n    var dv = value - leftIndex;\n\n    var color = stringify(\n        [\n            clampCssByte(lerpNumber(leftColor[0], rightColor[0], dv)),\n            clampCssByte(lerpNumber(leftColor[1], rightColor[1], dv)),\n            clampCssByte(lerpNumber(leftColor[2], rightColor[2], dv)),\n            clampCssFloat(lerpNumber(leftColor[3], rightColor[3], dv))\n        ],\n        'rgba'\n    );\n\n    return fullOutput\n        ? {\n            color: color,\n            leftIndex: leftIndex,\n            rightIndex: rightIndex,\n            value: value\n        }\n        : color;\n}\n\n/**\n * @deprecated\n */\nvar mapToColor = lerp$1;\n\n/**\n * @param {string} color\n * @param {number=} h 0 ~ 360, ignore when null.\n * @param {number=} s 0 ~ 1, ignore when null.\n * @param {number=} l 0 ~ 1, ignore when null.\n * @return {string} Color string in rgba format.\n * @memberOf module:zrender/util/color\n */\nfunction modifyHSL(color, h, s, l) {\n    color = parse(color);\n\n    if (color) {\n        color = rgba2hsla(color);\n        h != null && (color[0] = clampCssAngle(h));\n        s != null && (color[1] = parseCssFloat(s));\n        l != null && (color[2] = parseCssFloat(l));\n\n        return stringify(hsla2rgba(color), 'rgba');\n    }\n}\n\n/**\n * @param {string} color\n * @param {number=} alpha 0 ~ 1\n * @return {string} Color string in rgba format.\n * @memberOf module:zrender/util/color\n */\nfunction modifyAlpha(color, alpha) {\n    color = parse(color);\n\n    if (color && alpha != null) {\n        color[3] = clampCssFloat(alpha);\n        return stringify(color, 'rgba');\n    }\n}\n\n/**\n * @param {Array.<number>} arrColor like [12,33,44,0.4]\n * @param {string} type 'rgba', 'hsva', ...\n * @return {string} Result color. (If input illegal, return undefined).\n */\nfunction stringify(arrColor, type) {\n    if (!arrColor || !arrColor.length) {\n        return;\n    }\n    var colorStr = arrColor[0] + ',' + arrColor[1] + ',' + arrColor[2];\n    if (type === 'rgba' || type === 'hsva' || type === 'hsla') {\n        colorStr += ',' + arrColor[3];\n    }\n    return type + '(' + colorStr + ')';\n}\n\n\nvar color = (Object.freeze || Object)({\n\tparse: parse,\n\tlift: lift,\n\ttoHex: toHex,\n\tfastLerp: fastLerp,\n\tfastMapToColor: fastMapToColor,\n\tlerp: lerp$1,\n\tmapToColor: mapToColor,\n\tmodifyHSL: modifyHSL,\n\tmodifyAlpha: modifyAlpha,\n\tstringify: stringify\n});\n\n/**\n * @module echarts/animation/Animator\n */\n\nvar arraySlice = Array.prototype.slice;\n\nfunction defaultGetter(target, key) {\n    return target[key];\n}\n\nfunction defaultSetter(target, key, value) {\n    target[key] = value;\n}\n\n/**\n * @param  {number} p0\n * @param  {number} p1\n * @param  {number} percent\n * @return {number}\n */\nfunction interpolateNumber(p0, p1, percent) {\n    return (p1 - p0) * percent + p0;\n}\n\n/**\n * @param  {string} p0\n * @param  {string} p1\n * @param  {number} percent\n * @return {string}\n */\nfunction interpolateString(p0, p1, percent) {\n    return percent > 0.5 ? p1 : p0;\n}\n\n/**\n * @param  {Array} p0\n * @param  {Array} p1\n * @param  {number} percent\n * @param  {Array} out\n * @param  {number} arrDim\n */\nfunction interpolateArray(p0, p1, percent, out, arrDim) {\n    var len = p0.length;\n    if (arrDim == 1) {\n        for (var i = 0; i < len; i++) {\n            out[i] = interpolateNumber(p0[i], p1[i], percent);\n        }\n    }\n    else {\n        var len2 = len && p0[0].length;\n        for (var i = 0; i < len; i++) {\n            for (var j = 0; j < len2; j++) {\n                out[i][j] = interpolateNumber(\n                    p0[i][j], p1[i][j], percent\n                );\n            }\n        }\n    }\n}\n\n// arr0 is source array, arr1 is target array.\n// Do some preprocess to avoid error happened when interpolating from arr0 to arr1\nfunction fillArr(arr0, arr1, arrDim) {\n    var arr0Len = arr0.length;\n    var arr1Len = arr1.length;\n    if (arr0Len !== arr1Len) {\n        // FIXME Not work for TypedArray\n        var isPreviousLarger = arr0Len > arr1Len;\n        if (isPreviousLarger) {\n            // Cut the previous\n            arr0.length = arr1Len;\n        }\n        else {\n            // Fill the previous\n            for (var i = arr0Len; i < arr1Len; i++) {\n                arr0.push(\n                    arrDim === 1 ? arr1[i] : arraySlice.call(arr1[i])\n                );\n            }\n        }\n    }\n    // Handling NaN value\n    var len2 = arr0[0] && arr0[0].length;\n    for (var i = 0; i < arr0.length; i++) {\n        if (arrDim === 1) {\n            if (isNaN(arr0[i])) {\n                arr0[i] = arr1[i];\n            }\n        }\n        else {\n            for (var j = 0; j < len2; j++) {\n                if (isNaN(arr0[i][j])) {\n                    arr0[i][j] = arr1[i][j];\n                }\n            }\n        }\n    }\n}\n\n/**\n * @param  {Array} arr0\n * @param  {Array} arr1\n * @param  {number} arrDim\n * @return {boolean}\n */\nfunction isArraySame(arr0, arr1, arrDim) {\n    if (arr0 === arr1) {\n        return true;\n    }\n    var len = arr0.length;\n    if (len !== arr1.length) {\n        return false;\n    }\n    if (arrDim === 1) {\n        for (var i = 0; i < len; i++) {\n            if (arr0[i] !== arr1[i]) {\n                return false;\n            }\n        }\n    }\n    else {\n        var len2 = arr0[0].length;\n        for (var i = 0; i < len; i++) {\n            for (var j = 0; j < len2; j++) {\n                if (arr0[i][j] !== arr1[i][j]) {\n                    return false;\n                }\n            }\n        }\n    }\n    return true;\n}\n\n/**\n * Catmull Rom interpolate array\n * @param  {Array} p0\n * @param  {Array} p1\n * @param  {Array} p2\n * @param  {Array} p3\n * @param  {number} t\n * @param  {number} t2\n * @param  {number} t3\n * @param  {Array} out\n * @param  {number} arrDim\n */\nfunction catmullRomInterpolateArray(\n    p0, p1, p2, p3, t, t2, t3, out, arrDim\n) {\n    var len = p0.length;\n    if (arrDim == 1) {\n        for (var i = 0; i < len; i++) {\n            out[i] = catmullRomInterpolate(\n                p0[i], p1[i], p2[i], p3[i], t, t2, t3\n            );\n        }\n    }\n    else {\n        var len2 = p0[0].length;\n        for (var i = 0; i < len; i++) {\n            for (var j = 0; j < len2; j++) {\n                out[i][j] = catmullRomInterpolate(\n                    p0[i][j], p1[i][j], p2[i][j], p3[i][j],\n                    t, t2, t3\n                );\n            }\n        }\n    }\n}\n\n/**\n * Catmull Rom interpolate number\n * @param  {number} p0\n * @param  {number} p1\n * @param  {number} p2\n * @param  {number} p3\n * @param  {number} t\n * @param  {number} t2\n * @param  {number} t3\n * @return {number}\n */\nfunction catmullRomInterpolate(p0, p1, p2, p3, t, t2, t3) {\n    var v0 = (p2 - p0) * 0.5;\n    var v1 = (p3 - p1) * 0.5;\n    return (2 * (p1 - p2) + v0 + v1) * t3\n            + (-3 * (p1 - p2) - 2 * v0 - v1) * t2\n            + v0 * t + p1;\n}\n\nfunction cloneValue(value) {\n    if (isArrayLike(value)) {\n        var len = value.length;\n        if (isArrayLike(value[0])) {\n            var ret = [];\n            for (var i = 0; i < len; i++) {\n                ret.push(arraySlice.call(value[i]));\n            }\n            return ret;\n        }\n\n        return arraySlice.call(value);\n    }\n\n    return value;\n}\n\nfunction rgba2String(rgba) {\n    rgba[0] = Math.floor(rgba[0]);\n    rgba[1] = Math.floor(rgba[1]);\n    rgba[2] = Math.floor(rgba[2]);\n\n    return 'rgba(' + rgba.join(',') + ')';\n}\n\nfunction getArrayDim(keyframes) {\n    var lastValue = keyframes[keyframes.length - 1].value;\n    return isArrayLike(lastValue && lastValue[0]) ? 2 : 1;\n}\n\nfunction createTrackClip(animator, easing, oneTrackDone, keyframes, propName, forceAnimate) {\n    var getter = animator._getter;\n    var setter = animator._setter;\n    var useSpline = easing === 'spline';\n\n    var trackLen = keyframes.length;\n    if (!trackLen) {\n        return;\n    }\n    // Guess data type\n    var firstVal = keyframes[0].value;\n    var isValueArray = isArrayLike(firstVal);\n    var isValueColor = false;\n    var isValueString = false;\n\n    // For vertices morphing\n    var arrDim = isValueArray ? getArrayDim(keyframes) : 0;\n\n    var trackMaxTime;\n    // Sort keyframe as ascending\n    keyframes.sort(function(a, b) {\n        return a.time - b.time;\n    });\n\n    trackMaxTime = keyframes[trackLen - 1].time;\n    // Percents of each keyframe\n    var kfPercents = [];\n    // Value of each keyframe\n    var kfValues = [];\n    var prevValue = keyframes[0].value;\n    var isAllValueEqual = true;\n    for (var i = 0; i < trackLen; i++) {\n        kfPercents.push(keyframes[i].time / trackMaxTime);\n        // Assume value is a color when it is a string\n        var value = keyframes[i].value;\n\n        // Check if value is equal, deep check if value is array\n        if (!((isValueArray && isArraySame(value, prevValue, arrDim))\n            || (!isValueArray && value === prevValue))) {\n            isAllValueEqual = false;\n        }\n        prevValue = value;\n\n        // Try converting a string to a color array\n        if (typeof value == 'string') {\n            var colorArray = parse(value);\n            if (colorArray) {\n                value = colorArray;\n                isValueColor = true;\n            }\n            else {\n                isValueString = true;\n            }\n        }\n        kfValues.push(value);\n    }\n    if (!forceAnimate && isAllValueEqual) {\n        return;\n    }\n\n    var lastValue = kfValues[trackLen - 1];\n    // Polyfill array and NaN value\n    for (var i = 0; i < trackLen - 1; i++) {\n        if (isValueArray) {\n            fillArr(kfValues[i], lastValue, arrDim);\n        }\n        else {\n            if (isNaN(kfValues[i]) && !isNaN(lastValue) && !isValueString && !isValueColor) {\n                kfValues[i] = lastValue;\n            }\n        }\n    }\n    isValueArray && fillArr(getter(animator._target, propName), lastValue, arrDim);\n\n    // Cache the key of last frame to speed up when\n    // animation playback is sequency\n    var lastFrame = 0;\n    var lastFramePercent = 0;\n    var start;\n    var w;\n    var p0;\n    var p1;\n    var p2;\n    var p3;\n\n    if (isValueColor) {\n        var rgba = [0, 0, 0, 0];\n    }\n\n    var onframe = function (target, percent) {\n        // Find the range keyframes\n        // kf1-----kf2---------current--------kf3\n        // find kf2 and kf3 and do interpolation\n        var frame;\n        // In the easing function like elasticOut, percent may less than 0\n        if (percent < 0) {\n            frame = 0;\n        }\n        else if (percent < lastFramePercent) {\n            // Start from next key\n            // PENDING start from lastFrame ?\n            start = Math.min(lastFrame + 1, trackLen - 1);\n            for (frame = start; frame >= 0; frame--) {\n                if (kfPercents[frame] <= percent) {\n                    break;\n                }\n            }\n            // PENDING really need to do this ?\n            frame = Math.min(frame, trackLen - 2);\n        }\n        else {\n            for (frame = lastFrame; frame < trackLen; frame++) {\n                if (kfPercents[frame] > percent) {\n                    break;\n                }\n            }\n            frame = Math.min(frame - 1, trackLen - 2);\n        }\n        lastFrame = frame;\n        lastFramePercent = percent;\n\n        var range = (kfPercents[frame + 1] - kfPercents[frame]);\n        if (range === 0) {\n            return;\n        }\n        else {\n            w = (percent - kfPercents[frame]) / range;\n        }\n        if (useSpline) {\n            p1 = kfValues[frame];\n            p0 = kfValues[frame === 0 ? frame : frame - 1];\n            p2 = kfValues[frame > trackLen - 2 ? trackLen - 1 : frame + 1];\n            p3 = kfValues[frame > trackLen - 3 ? trackLen - 1 : frame + 2];\n            if (isValueArray) {\n                catmullRomInterpolateArray(\n                    p0, p1, p2, p3, w, w * w, w * w * w,\n                    getter(target, propName),\n                    arrDim\n                );\n            }\n            else {\n                var value;\n                if (isValueColor) {\n                    value = catmullRomInterpolateArray(\n                        p0, p1, p2, p3, w, w * w, w * w * w,\n                        rgba, 1\n                    );\n                    value = rgba2String(rgba);\n                }\n                else if (isValueString) {\n                    // String is step(0.5)\n                    return interpolateString(p1, p2, w);\n                }\n                else {\n                    value = catmullRomInterpolate(\n                        p0, p1, p2, p3, w, w * w, w * w * w\n                    );\n                }\n                setter(\n                    target,\n                    propName,\n                    value\n                );\n            }\n        }\n        else {\n            if (isValueArray) {\n                interpolateArray(\n                    kfValues[frame], kfValues[frame + 1], w,\n                    getter(target, propName),\n                    arrDim\n                );\n            }\n            else {\n                var value;\n                if (isValueColor) {\n                    interpolateArray(\n                        kfValues[frame], kfValues[frame + 1], w,\n                        rgba, 1\n                    );\n                    value = rgba2String(rgba);\n                }\n                else if (isValueString) {\n                    // String is step(0.5)\n                    return interpolateString(kfValues[frame], kfValues[frame + 1], w);\n                }\n                else {\n                    value = interpolateNumber(kfValues[frame], kfValues[frame + 1], w);\n                }\n                setter(\n                    target,\n                    propName,\n                    value\n                );\n            }\n        }\n    };\n\n    var clip = new Clip({\n        target: animator._target,\n        life: trackMaxTime,\n        loop: animator._loop,\n        delay: animator._delay,\n        onframe: onframe,\n        ondestroy: oneTrackDone\n    });\n\n    if (easing && easing !== 'spline') {\n        clip.easing = easing;\n    }\n\n    return clip;\n}\n\n/**\n * @alias module:zrender/animation/Animator\n * @constructor\n * @param {Object} target\n * @param {boolean} loop\n * @param {Function} getter\n * @param {Function} setter\n */\nvar Animator = function(target, loop, getter, setter) {\n    this._tracks = {};\n    this._target = target;\n\n    this._loop = loop || false;\n\n    this._getter = getter || defaultGetter;\n    this._setter = setter || defaultSetter;\n\n    this._clipCount = 0;\n\n    this._delay = 0;\n\n    this._doneList = [];\n\n    this._onframeList = [];\n\n    this._clipList = [];\n};\n\nAnimator.prototype = {\n    /**\n     * \n     * @param  {number} time ms\n     * @param  {Object} props key-value\n     * @return {module:zrender/animation/Animator}\n     */\n    when: function(time /* ms */, props) {\n        var tracks = this._tracks;\n        for (var propName in props) {\n            if (!props.hasOwnProperty(propName)) {\n                continue;\n            }\n\n            if (!tracks[propName]) {\n                tracks[propName] = [];\n                // Invalid value\n                var value = this._getter(this._target, propName);\n                if (value == null) {\n                    // zrLog('Invalid property ' + propName);\n                    continue;\n                }\n                // If time is 0\n                //  Then props is given initialize value\n                // Else\n                //  Initialize value from current prop value\n                if (time !== 0) {\n                    tracks[propName].push({\n                        time: 0,\n                        value: cloneValue(value)\n                    });\n                }\n            }\n            tracks[propName].push({\n                time: time,\n                value: props[propName]\n            });\n        }\n        return this;\n    },\n    /**\n     * \n     * @param  {Function} callback\n     * @return {module:zrender/animation/Animator}\n     */\n    during: function (callback) {\n        this._onframeList.push(callback);\n        return this;\n    },\n\n    pause: function () {\n        for (var i = 0; i < this._clipList.length; i++) {\n            this._clipList[i].pause();\n        }\n        this._paused = true;\n    },\n\n    resume: function () {\n        for (var i = 0; i < this._clipList.length; i++) {\n            this._clipList[i].resume();\n        }\n        this._paused = false;\n    },\n\n    isPaused: function () {\n        return !!this._paused;\n    },\n\n    _doneCallback: function () {\n        // Clear all tracks\n        this._tracks = {};\n        // Clear all clips\n        this._clipList.length = 0;\n\n        var doneList = this._doneList;\n        var len = doneList.length;\n        for (var i = 0; i < len; i++) {\n            doneList[i].call(this);\n        }\n    },\n    /**\n     * \n     * @param  {string|Function} [easing]\n     *         {@link module:zrender/animation/easing}\n     * @param  {boolean} forceAnimate\n     * @return {module:zrender/animation/Animator}\n     */\n    start: function (easing, forceAnimate) {\n\n        var self = this;\n        var clipCount = 0;\n\n        var oneTrackDone = function() {\n            clipCount--;\n            if (!clipCount) {\n                self._doneCallback();\n            }\n        };\n\n        var lastClip;\n        for (var propName in this._tracks) {\n            if (!this._tracks.hasOwnProperty(propName)) {\n                continue;\n            }\n            var clip = createTrackClip(\n                this, easing, oneTrackDone,\n                this._tracks[propName], propName, forceAnimate\n            );\n            if (clip) {\n                this._clipList.push(clip);\n                clipCount++;\n\n                // If start after added to animation\n                if (this.animation) {\n                    this.animation.addClip(clip);\n                }\n\n                lastClip = clip;\n            }\n        }\n\n        // Add during callback on the last clip\n        if (lastClip) {\n            var oldOnFrame = lastClip.onframe;\n            lastClip.onframe = function (target, percent) {\n                oldOnFrame(target, percent);\n\n                for (var i = 0; i < self._onframeList.length; i++) {\n                    self._onframeList[i](target, percent);\n                }\n            };\n        }\n\n        // This optimization will help the case that in the upper application\n        // the view may be refreshed frequently, where animation will be\n        // called repeatly but nothing changed.\n        if (!clipCount) {\n            this._doneCallback();\n        }\n        return this;\n    },\n    /**\n     * \n     * @param {boolean} forwardToLast If move to last frame before stop\n     */\n    stop: function (forwardToLast) {\n        var clipList = this._clipList;\n        var animation = this.animation;\n        for (var i = 0; i < clipList.length; i++) {\n            var clip = clipList[i];\n            if (forwardToLast) {\n                // Move to last frame before stop\n                clip.onframe(this._target, 1);\n            }\n            animation && animation.removeClip(clip);\n        }\n        clipList.length = 0;\n    },\n    /**\n     * \n     * @param  {number} time ms\n     * @return {module:zrender/animation/Animator}\n     */\n    delay: function (time) {\n        this._delay = time;\n        return this;\n    },\n    /**\n     * \n     * @param  {Function} cb\n     * @return {module:zrender/animation/Animator}\n     */\n    done: function(cb) {\n        if (cb) {\n            this._doneList.push(cb);\n        }\n        return this;\n    },\n\n    /**\n     * @return {Array.<module:zrender/animation/Clip>}\n     */\n    getClips: function () {\n        return this._clipList;\n    }\n};\n\nvar dpr = 1;\n\n// If in browser environment\nif (typeof window !== 'undefined') {\n    dpr = Math.max(window.devicePixelRatio || 1, 1);\n}\n\n/**\n * config\n * @exports zrender/config\n * @author Kener (@Kener-, kener.linfeng@gmail.com)\n */\n\n/**\n * debugcatchBrushExceptiontrue\n * 0 : debug\n * 1 : \n * 2 : \n */\nvar debugMode = 0;\n\n// retina \nvar devicePixelRatio = dpr;\n\nvar log = function () {\n};\n\nif (debugMode === 1) {\n    log = function () {\n        for (var k in arguments) {\n            throw new Error(arguments[k]);\n        }\n    };\n}\nelse if (debugMode > 1) {\n    log = function () {\n        for (var k in arguments) {\n            console.log(arguments[k]);\n        }\n    };\n}\n\nvar zrLog = log;\n\n/**\n * @alias modue:zrender/mixin/Animatable\n * @constructor\n */\nvar Animatable = function () {\n\n    /**\n     * @type {Array.<module:zrender/animation/Animator>}\n     * @readOnly\n     */\n    this.animators = [];\n};\n\nAnimatable.prototype = {\n\n    constructor: Animatable,\n\n    /**\n     * \n     *\n     * @param {string} path The path to fetch value from object, like 'a.b.c'.\n     * @param {boolean} [loop] Whether to loop animation.\n     * @return {module:zrender/animation/Animator}\n     * @example:\n     *     el.animate('style', false)\n     *         .when(1000, {x: 10} )\n     *         .done(function(){ // Animation done })\n     *         .start()\n     */\n    animate: function (path, loop) {\n        var target;\n        var animatingShape = false;\n        var el = this;\n        var zr = this.__zr;\n        if (path) {\n            var pathSplitted = path.split('.');\n            var prop = el;\n            // If animating shape\n            animatingShape = pathSplitted[0] === 'shape';\n            for (var i = 0, l = pathSplitted.length; i < l; i++) {\n                if (!prop) {\n                    continue;\n                }\n                prop = prop[pathSplitted[i]];\n            }\n            if (prop) {\n                target = prop;\n            }\n        }\n        else {\n            target = el;\n        }\n\n        if (!target) {\n            zrLog(\n                'Property \"'\n                + path\n                + '\" is not existed in element '\n                + el.id\n            );\n            return;\n        }\n\n        var animators = el.animators;\n\n        var animator = new Animator(target, loop);\n\n        animator.during(function (target) {\n            el.dirty(animatingShape);\n        })\n        .done(function () {\n            // FIXME Animator will not be removed if use `Animator#stop` to stop animation\n            animators.splice(indexOf(animators, animator), 1);\n        });\n\n        animators.push(animator);\n\n        // If animate after added to the zrender\n        if (zr) {\n            zr.animation.addAnimator(animator);\n        }\n\n        return animator;\n    },\n\n    /**\n     * \n     * @param {boolean} forwardToLast If move to last frame before stop\n     */\n    stopAnimation: function (forwardToLast) {\n        var animators = this.animators;\n        var len = animators.length;\n        for (var i = 0; i < len; i++) {\n            animators[i].stop(forwardToLast);\n        }\n        animators.length = 0;\n\n        return this;\n    },\n\n    /**\n     * Caution: this method will stop previous animation.\n     * So do not use this method to one element twice before\n     * animation starts, unless you know what you are doing.\n     * @param {Object} target\n     * @param {number} [time=500] Time in ms\n     * @param {string} [easing='linear']\n     * @param {number} [delay=0]\n     * @param {Function} [callback]\n     * @param {Function} [forceAnimate] Prevent stop animation and callback\n     *        immediently when target values are the same as current values.\n     *\n     * @example\n     *  // Animate position\n     *  el.animateTo({\n     *      position: [10, 10]\n     *  }, function () { // done })\n     *\n     *  // Animate shape, style and position in 100ms, delayed 100ms, with cubicOut easing\n     *  el.animateTo({\n     *      shape: {\n     *          width: 500\n     *      },\n     *      style: {\n     *          fill: 'red'\n     *      }\n     *      position: [10, 10]\n     *  }, 100, 100, 'cubicOut', function () { // done })\n     */\n        // TODO Return animation key\n    animateTo: function (target, time, delay, easing, callback, forceAnimate) {\n        // animateTo(target, time, easing, callback);\n        if (isString(delay)) {\n            callback = easing;\n            easing = delay;\n            delay = 0;\n        }\n        // animateTo(target, time, delay, callback);\n        else if (isFunction$1(easing)) {\n            callback = easing;\n            easing = 'linear';\n            delay = 0;\n        }\n        // animateTo(target, time, callback);\n        else if (isFunction$1(delay)) {\n            callback = delay;\n            delay = 0;\n        }\n        // animateTo(target, callback)\n        else if (isFunction$1(time)) {\n            callback = time;\n            time = 500;\n        }\n        // animateTo(target)\n        else if (!time) {\n            time = 500;\n        }\n        // Stop all previous animations\n        this.stopAnimation();\n        this._animateToShallow('', this, target, time, delay);\n\n        // Animators may be removed immediately after start\n        // if there is nothing to animate\n        var animators = this.animators.slice();\n        var count = animators.length;\n        function done() {\n            count--;\n            if (!count) {\n                callback && callback();\n            }\n        }\n\n        // No animators. This should be checked before animators[i].start(),\n        // because 'done' may be executed immediately if no need to animate.\n        if (!count) {\n            callback && callback();\n        }\n        // Start after all animators created\n        // Incase any animator is done immediately when all animation properties are not changed\n        for (var i = 0; i < animators.length; i++) {\n            animators[i]\n                .done(done)\n                .start(easing, forceAnimate);\n        }\n    },\n\n    /**\n     * @private\n     * @param {string} path=''\n     * @param {Object} source=this\n     * @param {Object} target\n     * @param {number} [time=500]\n     * @param {number} [delay=0]\n     *\n     * @example\n     *  // Animate position\n     *  el._animateToShallow({\n     *      position: [10, 10]\n     *  })\n     *\n     *  // Animate shape, style and position in 100ms, delayed 100ms\n     *  el._animateToShallow({\n     *      shape: {\n     *          width: 500\n     *      },\n     *      style: {\n     *          fill: 'red'\n     *      }\n     *      position: [10, 10]\n     *  }, 100, 100)\n     */\n    _animateToShallow: function (path, source, target, time, delay) {\n        var objShallow = {};\n        var propertyCount = 0;\n        for (var name in target) {\n            if (!target.hasOwnProperty(name)) {\n                continue;\n            }\n\n            if (source[name] != null) {\n                if (isObject$1(target[name]) && !isArrayLike(target[name])) {\n                    this._animateToShallow(\n                        path ? path + '.' + name : name,\n                        source[name],\n                        target[name],\n                        time,\n                        delay\n                    );\n                }\n                else {\n                    objShallow[name] = target[name];\n                    propertyCount++;\n                }\n            }\n            else if (target[name] != null) {\n                // Attr directly if not has property\n                // FIXME, if some property not needed for element ?\n                if (!path) {\n                    this.attr(name, target[name]);\n                }\n                else {  // Shape or style\n                    var props = {};\n                    props[path] = {};\n                    props[path][name] = target[name];\n                    this.attr(props);\n                }\n            }\n        }\n\n        if (propertyCount > 0) {\n            this.animate(path, false)\n                .when(time == null ? 500 : time, objShallow)\n                .delay(delay || 0);\n        }\n\n        return this;\n    }\n};\n\n/**\n * @alias module:zrender/Element\n * @constructor\n * @extends {module:zrender/mixin/Animatable}\n * @extends {module:zrender/mixin/Transformable}\n * @extends {module:zrender/mixin/Eventful}\n */\nvar Element = function (opts) { // jshint ignore:line\n\n    Transformable.call(this, opts);\n    Eventful.call(this, opts);\n    Animatable.call(this, opts);\n\n    /**\n     * ID\n     * @type {string}\n     */\n    this.id = opts.id || guid();\n};\n\nElement.prototype = {\n\n    /**\n     * \n     * Element type\n     * @type {string}\n     */\n    type: 'element',\n\n    /**\n     * \n     * Element name\n     * @type {string}\n     */\n    name: '',\n\n    /**\n     * ZRender  element  zrender \n     * ZRender instance will be assigned when element is associated with zrender\n     * @name module:/zrender/Element#__zr\n     * @type {module:zrender/ZRender}\n     */\n    __zr: null,\n\n    /**\n     * true\n     * If ignore drawing and events of the element object\n     * @name module:/zrender/Element#ignore\n     * @type {boolean}\n     * @default false\n     */\n    ignore: false,\n\n    /**\n     * (shape) Group \n     * \n     * @type {module:zrender/graphic/Path}\n     * @see http://www.w3.org/TR/2dcontext/#clipping-region\n     * @readOnly\n     */\n    clipPath: null,\n\n    /**\n     *  Group\n     * @type {boolean}\n     */\n    isGroup: false,\n\n    /**\n     * Drift element\n     * @param  {number} dx dx on the global space\n     * @param  {number} dy dy on the global space\n     */\n    drift: function (dx, dy) {\n        switch (this.draggable) {\n            case 'horizontal':\n                dy = 0;\n                break;\n            case 'vertical':\n                dx = 0;\n                break;\n        }\n\n        var m = this.transform;\n        if (!m) {\n            m = this.transform = [1, 0, 0, 1, 0, 0];\n        }\n        m[4] += dx;\n        m[5] += dy;\n\n        this.decomposeTransform();\n        this.dirty(false);\n    },\n\n    /**\n     * Hook before update\n     */\n    beforeUpdate: function () {},\n    /**\n     * Hook after update\n     */\n    afterUpdate: function () {},\n    /**\n     * Update each frame\n     */\n    update: function () {\n        this.updateTransform();\n    },\n\n    /**\n     * @param  {Function} cb\n     * @param  {}   context\n     */\n    traverse: function (cb, context) {},\n\n    /**\n     * @protected\n     */\n    attrKV: function (key, value) {\n        if (key === 'position' || key === 'scale' || key === 'origin') {\n            // Copy the array\n            if (value) {\n                var target = this[key];\n                if (!target) {\n                    target = this[key] = [];\n                }\n                target[0] = value[0];\n                target[1] = value[1];\n            }\n        }\n        else {\n            this[key] = value;\n        }\n    },\n\n    /**\n     * Hide the element\n     */\n    hide: function () {\n        this.ignore = true;\n        this.__zr && this.__zr.refresh();\n    },\n\n    /**\n     * Show the element\n     */\n    show: function () {\n        this.ignore = false;\n        this.__zr && this.__zr.refresh();\n    },\n\n    /**\n     * @param {string|Object} key\n     * @param {*} value\n     */\n    attr: function (key, value) {\n        if (typeof key === 'string') {\n            this.attrKV(key, value);\n        }\n        else if (isObject$1(key)) {\n            for (var name in key) {\n                if (key.hasOwnProperty(name)) {\n                    this.attrKV(name, key[name]);\n                }\n            }\n        }\n\n        this.dirty(false);\n\n        return this;\n    },\n\n    /**\n     * @param {module:zrender/graphic/Path} clipPath\n     */\n    setClipPath: function (clipPath) {\n        var zr = this.__zr;\n        if (zr) {\n            clipPath.addSelfToZr(zr);\n        }\n\n        // Remove previous clip path\n        if (this.clipPath && this.clipPath !== clipPath) {\n            this.removeClipPath();\n        }\n\n        this.clipPath = clipPath;\n        clipPath.__zr = zr;\n        clipPath.__clipTarget = this;\n\n        this.dirty(false);\n    },\n\n    /**\n     */\n    removeClipPath: function () {\n        var clipPath = this.clipPath;\n        if (clipPath) {\n            if (clipPath.__zr) {\n                clipPath.removeSelfFromZr(clipPath.__zr);\n            }\n\n            clipPath.__zr = null;\n            clipPath.__clipTarget = null;\n            this.clipPath = null;\n\n            this.dirty(false);\n        }\n    },\n\n    /**\n     * Add self from zrender instance.\n     * Not recursively because it will be invoked when element added to storage.\n     * @param {module:zrender/ZRender} zr\n     */\n    addSelfToZr: function (zr) {\n        this.__zr = zr;\n        // \n        var animators = this.animators;\n        if (animators) {\n            for (var i = 0; i < animators.length; i++) {\n                zr.animation.addAnimator(animators[i]);\n            }\n        }\n\n        if (this.clipPath) {\n            this.clipPath.addSelfToZr(zr);\n        }\n    },\n\n    /**\n     * Remove self from zrender instance.\n     * Not recursively because it will be invoked when element added to storage.\n     * @param {module:zrender/ZRender} zr\n     */\n    removeSelfFromZr: function (zr) {\n        this.__zr = null;\n        // \n        var animators = this.animators;\n        if (animators) {\n            for (var i = 0; i < animators.length; i++) {\n                zr.animation.removeAnimator(animators[i]);\n            }\n        }\n\n        if (this.clipPath) {\n            this.clipPath.removeSelfFromZr(zr);\n        }\n    }\n};\n\nmixin(Element, Animatable);\nmixin(Element, Transformable);\nmixin(Element, Eventful);\n\n/**\n * @module echarts/core/BoundingRect\n */\n\nvar v2ApplyTransform = applyTransform;\nvar mathMin = Math.min;\nvar mathMax = Math.max;\n\n/**\n * @alias module:echarts/core/BoundingRect\n */\nfunction BoundingRect(x, y, width, height) {\n\n    if (width < 0) {\n        x = x + width;\n        width = -width;\n    }\n    if (height < 0) {\n        y = y + height;\n        height = -height;\n    }\n\n    /**\n     * @type {number}\n     */\n    this.x = x;\n    /**\n     * @type {number}\n     */\n    this.y = y;\n    /**\n     * @type {number}\n     */\n    this.width = width;\n    /**\n     * @type {number}\n     */\n    this.height = height;\n}\n\nBoundingRect.prototype = {\n\n    constructor: BoundingRect,\n\n    /**\n     * @param {module:echarts/core/BoundingRect} other\n     */\n    union: function (other) {\n        var x = mathMin(other.x, this.x);\n        var y = mathMin(other.y, this.y);\n\n        this.width = mathMax(\n                other.x + other.width,\n                this.x + this.width\n            ) - x;\n        this.height = mathMax(\n                other.y + other.height,\n                this.y + this.height\n            ) - y;\n        this.x = x;\n        this.y = y;\n    },\n\n    /**\n     * @param {Array.<number>} m\n     * @methods\n     */\n    applyTransform: (function () {\n        var lt = [];\n        var rb = [];\n        var lb = [];\n        var rt = [];\n        return function (m) {\n            // In case usage like this\n            // el.getBoundingRect().applyTransform(el.transform)\n            // And element has no transform\n            if (!m) {\n                return;\n            }\n            lt[0] = lb[0] = this.x;\n            lt[1] = rt[1] = this.y;\n            rb[0] = rt[0] = this.x + this.width;\n            rb[1] = lb[1] = this.y + this.height;\n\n            v2ApplyTransform(lt, lt, m);\n            v2ApplyTransform(rb, rb, m);\n            v2ApplyTransform(lb, lb, m);\n            v2ApplyTransform(rt, rt, m);\n\n            this.x = mathMin(lt[0], rb[0], lb[0], rt[0]);\n            this.y = mathMin(lt[1], rb[1], lb[1], rt[1]);\n            var maxX = mathMax(lt[0], rb[0], lb[0], rt[0]);\n            var maxY = mathMax(lt[1], rb[1], lb[1], rt[1]);\n            this.width = maxX - this.x;\n            this.height = maxY - this.y;\n        };\n    })(),\n\n    /**\n     * Calculate matrix of transforming from self to target rect\n     * @param  {module:zrender/core/BoundingRect} b\n     * @return {Array.<number>}\n     */\n    calculateTransform: function (b) {\n        var a = this;\n        var sx = b.width / a.width;\n        var sy = b.height / a.height;\n\n        var m = create$1();\n\n        // \n        translate(m, m, [-a.x, -a.y]);\n        scale$1(m, m, [sx, sy]);\n        translate(m, m, [b.x, b.y]);\n\n        return m;\n    },\n\n    /**\n     * @param {(module:echarts/core/BoundingRect|Object)} b\n     * @return {boolean}\n     */\n    intersect: function (b) {\n        if (!b) {\n            return false;\n        }\n\n        if (!(b instanceof BoundingRect)) {\n            // Normalize negative width/height.\n            b = BoundingRect.create(b);\n        }\n\n        var a = this;\n        var ax0 = a.x;\n        var ax1 = a.x + a.width;\n        var ay0 = a.y;\n        var ay1 = a.y + a.height;\n\n        var bx0 = b.x;\n        var bx1 = b.x + b.width;\n        var by0 = b.y;\n        var by1 = b.y + b.height;\n\n        return ! (ax1 < bx0 || bx1 < ax0 || ay1 < by0 || by1 < ay0);\n    },\n\n    contain: function (x, y) {\n        var rect = this;\n        return x >= rect.x\n            && x <= (rect.x + rect.width)\n            && y >= rect.y\n            && y <= (rect.y + rect.height);\n    },\n\n    /**\n     * @return {module:echarts/core/BoundingRect}\n     */\n    clone: function () {\n        return new BoundingRect(this.x, this.y, this.width, this.height);\n    },\n\n    /**\n     * Copy from another rect\n     */\n    copy: function (other) {\n        this.x = other.x;\n        this.y = other.y;\n        this.width = other.width;\n        this.height = other.height;\n    },\n\n    plain: function () {\n        return {\n            x: this.x,\n            y: this.y,\n            width: this.width,\n            height: this.height\n        };\n    }\n};\n\n/**\n * @param {Object|module:zrender/core/BoundingRect} rect\n * @param {number} rect.x\n * @param {number} rect.y\n * @param {number} rect.width\n * @param {number} rect.height\n * @return {module:zrender/core/BoundingRect}\n */\nBoundingRect.create = function (rect) {\n    return new BoundingRect(rect.x, rect.y, rect.width, rect.height);\n};\n\n/**\n * GroupGroup\n * @module zrender/graphic/Group\n * @example\n *     var Group = require('zrender/container/Group');\n *     var Circle = require('zrender/graphic/shape/Circle');\n *     var g = new Group();\n *     g.position[0] = 100;\n *     g.position[1] = 100;\n *     g.add(new Circle({\n *         style: {\n *             x: 100,\n *             y: 100,\n *             r: 20,\n *         }\n *     }));\n *     zr.add(g);\n */\n\n/**\n * @alias module:zrender/graphic/Group\n * @constructor\n * @extends module:zrender/mixin/Transformable\n * @extends module:zrender/mixin/Eventful\n */\nvar Group = function (opts) {\n\n    opts = opts || {};\n\n    Element.call(this, opts);\n\n    for (var key in opts) {\n        if (opts.hasOwnProperty(key)) {\n            this[key] = opts[key];\n        }\n    }\n\n    this._children = [];\n\n    this.__storage = null;\n\n    this.__dirty = true;\n};\n\nGroup.prototype = {\n\n    constructor: Group,\n\n    isGroup: true,\n\n    /**\n     * @type {string}\n     */\n    type: 'group',\n\n    /**\n     * \n     * @name module:/zrender/container/Group#silent\n     * @type {boolean}\n     * @default false\n     */\n    silent: false,\n\n    /**\n     * @return {Array.<module:zrender/Element>}\n     */\n    children: function () {\n        return this._children.slice();\n    },\n\n    /**\n     *  index \n     * @param  {number} idx\n     * @return {module:zrender/Element}\n     */\n    childAt: function (idx) {\n        return this._children[idx];\n    },\n\n    /**\n     * \n     * @param  {string} name\n     * @return {module:zrender/Element}\n     */\n    childOfName: function (name) {\n        var children = this._children;\n        for (var i = 0; i < children.length; i++) {\n            if (children[i].name === name) {\n                return children[i];\n            }\n            }\n    },\n\n    /**\n     * @return {number}\n     */\n    childCount: function () {\n        return this._children.length;\n    },\n\n    /**\n     * \n     * @param {module:zrender/Element} child\n     */\n    add: function (child) {\n        if (child && child !== this && child.parent !== this) {\n\n            this._children.push(child);\n\n            this._doAdd(child);\n        }\n\n        return this;\n    },\n\n    /**\n     *  nextSibling \n     * @param {module:zrender/Element} child\n     * @param {module:zrender/Element} nextSibling\n     */\n    addBefore: function (child, nextSibling) {\n        if (child && child !== this && child.parent !== this\n            && nextSibling && nextSibling.parent === this) {\n\n            var children = this._children;\n            var idx = children.indexOf(nextSibling);\n\n            if (idx >= 0) {\n                children.splice(idx, 0, child);\n                this._doAdd(child);\n            }\n        }\n\n        return this;\n    },\n\n    _doAdd: function (child) {\n        if (child.parent) {\n            child.parent.remove(child);\n        }\n\n        child.parent = this;\n\n        var storage = this.__storage;\n        var zr = this.__zr;\n        if (storage && storage !== child.__storage) {\n\n            storage.addToStorage(child);\n\n            if (child instanceof Group) {\n                child.addChildrenToStorage(storage);\n            }\n        }\n\n        zr && zr.refresh();\n    },\n\n    /**\n     * \n     * @param {module:zrender/Element} child\n     */\n    remove: function (child) {\n        var zr = this.__zr;\n        var storage = this.__storage;\n        var children = this._children;\n\n        var idx = indexOf(children, child);\n        if (idx < 0) {\n            return this;\n        }\n        children.splice(idx, 1);\n\n        child.parent = null;\n\n        if (storage) {\n\n            storage.delFromStorage(child);\n\n            if (child instanceof Group) {\n                child.delChildrenFromStorage(storage);\n            }\n        }\n\n        zr && zr.refresh();\n\n        return this;\n    },\n\n    /**\n     * \n     */\n    removeAll: function () {\n        var children = this._children;\n        var storage = this.__storage;\n        var child;\n        var i;\n        for (i = 0; i < children.length; i++) {\n            child = children[i];\n            if (storage) {\n                storage.delFromStorage(child);\n                if (child instanceof Group) {\n                    child.delChildrenFromStorage(storage);\n                }\n            }\n            child.parent = null;\n        }\n        children.length = 0;\n\n        return this;\n    },\n\n    /**\n     * \n     * @param  {Function} cb\n     * @param  {}   context\n     */\n    eachChild: function (cb, context) {\n        var children = this._children;\n        for (var i = 0; i < children.length; i++) {\n            var child = children[i];\n            cb.call(context, child, i);\n        }\n        return this;\n    },\n\n    /**\n     * \n     * @param  {Function} cb\n     * @param  {}   context\n     */\n    traverse: function (cb, context) {\n        for (var i = 0; i < this._children.length; i++) {\n            var child = this._children[i];\n            cb.call(context, child);\n\n            if (child.type === 'group') {\n                child.traverse(cb, context);\n            }\n        }\n        return this;\n    },\n\n    addChildrenToStorage: function (storage) {\n        for (var i = 0; i < this._children.length; i++) {\n            var child = this._children[i];\n            storage.addToStorage(child);\n            if (child instanceof Group) {\n                child.addChildrenToStorage(storage);\n            }\n        }\n    },\n\n    delChildrenFromStorage: function (storage) {\n        for (var i = 0; i < this._children.length; i++) {\n            var child = this._children[i];\n            storage.delFromStorage(child);\n            if (child instanceof Group) {\n                child.delChildrenFromStorage(storage);\n            }\n        }\n    },\n\n    dirty: function () {\n        this.__dirty = true;\n        this.__zr && this.__zr.refresh();\n        return this;\n    },\n\n    /**\n     * @return {module:zrender/core/BoundingRect}\n     */\n    getBoundingRect: function (includeChildren) {\n        // TODO Caching\n        var rect = null;\n        var tmpRect = new BoundingRect(0, 0, 0, 0);\n        var children = includeChildren || this._children;\n        var tmpMat = [];\n\n        for (var i = 0; i < children.length; i++) {\n            var child = children[i];\n            if (child.ignore || child.invisible) {\n                continue;\n            }\n\n            var childRect = child.getBoundingRect();\n            var transform = child.getLocalTransform(tmpMat);\n            // TODO\n            // The boundingRect cacluated by transforming original\n            // rect may be bigger than the actual bundingRect when rotation\n            // is used. (Consider a circle rotated aginst its center, where\n            // the actual boundingRect should be the same as that not be\n            // rotated.) But we can not find better approach to calculate\n            // actual boundingRect yet, considering performance.\n            if (transform) {\n                tmpRect.copy(childRect);\n                tmpRect.applyTransform(transform);\n                rect = rect || tmpRect.clone();\n                rect.union(tmpRect);\n            }\n            else {\n                rect = rect || childRect.clone();\n                rect.union(childRect);\n            }\n        }\n        return rect || tmpRect;\n    }\n};\n\ninherits(Group, Element);\n\n// https://github.com/mziccard/node-timsort\nvar DEFAULT_MIN_MERGE = 32;\n\nvar DEFAULT_MIN_GALLOPING = 7;\n\nfunction minRunLength(n) {\n    var r = 0;\n\n    while (n >= DEFAULT_MIN_MERGE) {\n        r |= n & 1;\n        n >>= 1;\n    }\n\n    return n + r;\n}\n\nfunction makeAscendingRun(array, lo, hi, compare) {\n    var runHi = lo + 1;\n\n    if (runHi === hi) {\n        return 1;\n    }\n\n    if (compare(array[runHi++], array[lo]) < 0) {\n        while (runHi < hi && compare(array[runHi], array[runHi - 1]) < 0) {\n            runHi++;\n        }\n\n        reverseRun(array, lo, runHi);\n    }\n    else {\n        while (runHi < hi && compare(array[runHi], array[runHi - 1]) >= 0) {\n            runHi++;\n        }\n    }\n\n    return runHi - lo;\n}\n\nfunction reverseRun(array, lo, hi) {\n    hi--;\n\n    while (lo < hi) {\n        var t = array[lo];\n        array[lo++] = array[hi];\n        array[hi--] = t;\n    }\n}\n\nfunction binaryInsertionSort(array, lo, hi, start, compare) {\n    if (start === lo) {\n        start++;\n    }\n\n    for (; start < hi; start++) {\n        var pivot = array[start];\n\n        var left = lo;\n        var right = start;\n        var mid;\n\n        while (left < right) {\n            mid = left + right >>> 1;\n\n            if (compare(pivot, array[mid]) < 0) {\n                right = mid;\n            }\n            else {\n                left = mid + 1;\n            }\n        }\n\n        var n = start - left;\n\n        switch (n) {\n            case 3:\n                array[left + 3] = array[left + 2];\n\n            case 2:\n                array[left + 2] = array[left + 1];\n\n            case 1:\n                array[left + 1] = array[left];\n                break;\n            default:\n                while (n > 0) {\n                    array[left + n] = array[left + n - 1];\n                    n--;\n                }\n        }\n\n        array[left] = pivot;\n    }\n}\n\nfunction gallopLeft(value, array, start, length, hint, compare) {\n    var lastOffset = 0;\n    var maxOffset = 0;\n    var offset = 1;\n\n    if (compare(value, array[start + hint]) > 0) {\n        maxOffset = length - hint;\n\n        while (offset < maxOffset && compare(value, array[start + hint + offset]) > 0) {\n            lastOffset = offset;\n            offset = (offset << 1) + 1;\n\n            if (offset <= 0) {\n                offset = maxOffset;\n            }\n        }\n\n        if (offset > maxOffset) {\n            offset = maxOffset;\n        }\n\n        lastOffset += hint;\n        offset += hint;\n    }\n    else {\n        maxOffset = hint + 1;\n        while (offset < maxOffset && compare(value, array[start + hint - offset]) <= 0) {\n            lastOffset = offset;\n            offset = (offset << 1) + 1;\n\n            if (offset <= 0) {\n                offset = maxOffset;\n            }\n        }\n        if (offset > maxOffset) {\n            offset = maxOffset;\n        }\n\n        var tmp = lastOffset;\n        lastOffset = hint - offset;\n        offset = hint - tmp;\n    }\n\n    lastOffset++;\n    while (lastOffset < offset) {\n        var m = lastOffset + (offset - lastOffset >>> 1);\n\n        if (compare(value, array[start + m]) > 0) {\n            lastOffset = m + 1;\n        }\n        else {\n            offset = m;\n        }\n    }\n    return offset;\n}\n\nfunction gallopRight(value, array, start, length, hint, compare) {\n    var lastOffset = 0;\n    var maxOffset = 0;\n    var offset = 1;\n\n    if (compare(value, array[start + hint]) < 0) {\n        maxOffset = hint + 1;\n\n        while (offset < maxOffset && compare(value, array[start + hint - offset]) < 0) {\n            lastOffset = offset;\n            offset = (offset << 1) + 1;\n\n            if (offset <= 0) {\n                offset = maxOffset;\n            }\n        }\n\n        if (offset > maxOffset) {\n            offset = maxOffset;\n        }\n\n        var tmp = lastOffset;\n        lastOffset = hint - offset;\n        offset = hint - tmp;\n    }\n    else {\n        maxOffset = length - hint;\n\n        while (offset < maxOffset && compare(value, array[start + hint + offset]) >= 0) {\n            lastOffset = offset;\n            offset = (offset << 1) + 1;\n\n            if (offset <= 0) {\n                offset = maxOffset;\n            }\n        }\n\n        if (offset > maxOffset) {\n            offset = maxOffset;\n        }\n\n        lastOffset += hint;\n        offset += hint;\n    }\n\n    lastOffset++;\n\n    while (lastOffset < offset) {\n        var m = lastOffset + (offset - lastOffset >>> 1);\n\n        if (compare(value, array[start + m]) < 0) {\n            offset = m;\n        }\n        else {\n            lastOffset = m + 1;\n        }\n    }\n\n    return offset;\n}\n\nfunction TimSort(array, compare) {\n    var minGallop = DEFAULT_MIN_GALLOPING;\n    var runStart;\n    var runLength;\n    var stackSize = 0;\n\n    var tmp = [];\n\n    runStart = [];\n    runLength = [];\n\n    function pushRun(_runStart, _runLength) {\n        runStart[stackSize] = _runStart;\n        runLength[stackSize] = _runLength;\n        stackSize += 1;\n    }\n\n    function mergeRuns() {\n        while (stackSize > 1) {\n            var n = stackSize - 2;\n\n            if (n >= 1 && runLength[n - 1] <= runLength[n] + runLength[n + 1] || n >= 2 && runLength[n - 2] <= runLength[n] + runLength[n - 1]) {\n                if (runLength[n - 1] < runLength[n + 1]) {\n                    n--;\n                }\n            }\n            else if (runLength[n] > runLength[n + 1]) {\n                break;\n            }\n            mergeAt(n);\n        }\n    }\n\n    function forceMergeRuns() {\n        while (stackSize > 1) {\n            var n = stackSize - 2;\n\n            if (n > 0 && runLength[n - 1] < runLength[n + 1]) {\n                n--;\n            }\n\n            mergeAt(n);\n        }\n    }\n\n    function mergeAt(i) {\n        var start1 = runStart[i];\n        var length1 = runLength[i];\n        var start2 = runStart[i + 1];\n        var length2 = runLength[i + 1];\n\n        runLength[i] = length1 + length2;\n\n        if (i === stackSize - 3) {\n            runStart[i + 1] = runStart[i + 2];\n            runLength[i + 1] = runLength[i + 2];\n        }\n\n        stackSize--;\n\n        var k = gallopRight(array[start2], array, start1, length1, 0, compare);\n        start1 += k;\n        length1 -= k;\n\n        if (length1 === 0) {\n            return;\n        }\n\n        length2 = gallopLeft(array[start1 + length1 - 1], array, start2, length2, length2 - 1, compare);\n\n        if (length2 === 0) {\n            return;\n        }\n\n        if (length1 <= length2) {\n            mergeLow(start1, length1, start2, length2);\n        }\n        else {\n            mergeHigh(start1, length1, start2, length2);\n        }\n    }\n\n    function mergeLow(start1, length1, start2, length2) {\n        var i = 0;\n\n        for (i = 0; i < length1; i++) {\n            tmp[i] = array[start1 + i];\n        }\n\n        var cursor1 = 0;\n        var cursor2 = start2;\n        var dest = start1;\n\n        array[dest++] = array[cursor2++];\n\n        if (--length2 === 0) {\n            for (i = 0; i < length1; i++) {\n                array[dest + i] = tmp[cursor1 + i];\n            }\n            return;\n        }\n\n        if (length1 === 1) {\n            for (i = 0; i < length2; i++) {\n                array[dest + i] = array[cursor2 + i];\n            }\n            array[dest + length2] = tmp[cursor1];\n            return;\n        }\n\n        var _minGallop = minGallop;\n        var count1, count2, exit;\n\n        while (1) {\n            count1 = 0;\n            count2 = 0;\n            exit = false;\n\n            do {\n                if (compare(array[cursor2], tmp[cursor1]) < 0) {\n                    array[dest++] = array[cursor2++];\n                    count2++;\n                    count1 = 0;\n\n                    if (--length2 === 0) {\n                        exit = true;\n                        break;\n                    }\n                }\n                else {\n                    array[dest++] = tmp[cursor1++];\n                    count1++;\n                    count2 = 0;\n                    if (--length1 === 1) {\n                        exit = true;\n                        break;\n                    }\n                }\n            } while ((count1 | count2) < _minGallop);\n\n            if (exit) {\n                break;\n            }\n\n            do {\n                count1 = gallopRight(array[cursor2], tmp, cursor1, length1, 0, compare);\n\n                if (count1 !== 0) {\n                    for (i = 0; i < count1; i++) {\n                        array[dest + i] = tmp[cursor1 + i];\n                    }\n\n                    dest += count1;\n                    cursor1 += count1;\n                    length1 -= count1;\n                    if (length1 <= 1) {\n                        exit = true;\n                        break;\n                    }\n                }\n\n                array[dest++] = array[cursor2++];\n\n                if (--length2 === 0) {\n                    exit = true;\n                    break;\n                }\n\n                count2 = gallopLeft(tmp[cursor1], array, cursor2, length2, 0, compare);\n\n                if (count2 !== 0) {\n                    for (i = 0; i < count2; i++) {\n                        array[dest + i] = array[cursor2 + i];\n                    }\n\n                    dest += count2;\n                    cursor2 += count2;\n                    length2 -= count2;\n\n                    if (length2 === 0) {\n                        exit = true;\n                        break;\n                    }\n                }\n                array[dest++] = tmp[cursor1++];\n\n                if (--length1 === 1) {\n                    exit = true;\n                    break;\n                }\n\n                _minGallop--;\n            } while (count1 >= DEFAULT_MIN_GALLOPING || count2 >= DEFAULT_MIN_GALLOPING);\n\n            if (exit) {\n                break;\n            }\n\n            if (_minGallop < 0) {\n                _minGallop = 0;\n            }\n\n            _minGallop += 2;\n        }\n\n        minGallop = _minGallop;\n\n        minGallop < 1 && (minGallop = 1);\n\n        if (length1 === 1) {\n            for (i = 0; i < length2; i++) {\n                array[dest + i] = array[cursor2 + i];\n            }\n            array[dest + length2] = tmp[cursor1];\n        }\n        else if (length1 === 0) {\n            throw new Error();\n            // throw new Error('mergeLow preconditions were not respected');\n        }\n        else {\n            for (i = 0; i < length1; i++) {\n                array[dest + i] = tmp[cursor1 + i];\n            }\n        }\n    }\n\n    function mergeHigh (start1, length1, start2, length2) {\n        var i = 0;\n\n        for (i = 0; i < length2; i++) {\n            tmp[i] = array[start2 + i];\n        }\n\n        var cursor1 = start1 + length1 - 1;\n        var cursor2 = length2 - 1;\n        var dest = start2 + length2 - 1;\n        var customCursor = 0;\n        var customDest = 0;\n\n        array[dest--] = array[cursor1--];\n\n        if (--length1 === 0) {\n            customCursor = dest - (length2 - 1);\n\n            for (i = 0; i < length2; i++) {\n                array[customCursor + i] = tmp[i];\n            }\n\n            return;\n        }\n\n        if (length2 === 1) {\n            dest -= length1;\n            cursor1 -= length1;\n            customDest = dest + 1;\n            customCursor = cursor1 + 1;\n\n            for (i = length1 - 1; i >= 0; i--) {\n                array[customDest + i] = array[customCursor + i];\n            }\n\n            array[dest] = tmp[cursor2];\n            return;\n        }\n\n        var _minGallop = minGallop;\n\n        while (true) {\n            var count1 = 0;\n            var count2 = 0;\n            var exit = false;\n\n            do {\n                if (compare(tmp[cursor2], array[cursor1]) < 0) {\n                    array[dest--] = array[cursor1--];\n                    count1++;\n                    count2 = 0;\n                    if (--length1 === 0) {\n                        exit = true;\n                        break;\n                    }\n                }\n                else {\n                    array[dest--] = tmp[cursor2--];\n                    count2++;\n                    count1 = 0;\n                    if (--length2 === 1) {\n                        exit = true;\n                        break;\n                    }\n                }\n            } while ((count1 | count2) < _minGallop);\n\n            if (exit) {\n                break;\n            }\n\n            do {\n                count1 = length1 - gallopRight(tmp[cursor2], array, start1, length1, length1 - 1, compare);\n\n                if (count1 !== 0) {\n                    dest -= count1;\n                    cursor1 -= count1;\n                    length1 -= count1;\n                    customDest = dest + 1;\n                    customCursor = cursor1 + 1;\n\n                    for (i = count1 - 1; i >= 0; i--) {\n                        array[customDest + i] = array[customCursor + i];\n                    }\n\n                    if (length1 === 0) {\n                        exit = true;\n                        break;\n                    }\n                }\n\n                array[dest--] = tmp[cursor2--];\n\n                if (--length2 === 1) {\n                    exit = true;\n                    break;\n                }\n\n                count2 = length2 - gallopLeft(array[cursor1], tmp, 0, length2, length2 - 1, compare);\n\n                if (count2 !== 0) {\n                    dest -= count2;\n                    cursor2 -= count2;\n                    length2 -= count2;\n                    customDest = dest + 1;\n                    customCursor = cursor2 + 1;\n\n                    for (i = 0; i < count2; i++) {\n                        array[customDest + i] = tmp[customCursor + i];\n                    }\n\n                    if (length2 <= 1) {\n                        exit = true;\n                        break;\n                    }\n                }\n\n                array[dest--] = array[cursor1--];\n\n                if (--length1 === 0) {\n                    exit = true;\n                    break;\n                }\n\n                _minGallop--;\n            } while (count1 >= DEFAULT_MIN_GALLOPING || count2 >= DEFAULT_MIN_GALLOPING);\n\n            if (exit) {\n                break;\n            }\n\n            if (_minGallop < 0) {\n                _minGallop = 0;\n            }\n\n            _minGallop += 2;\n        }\n\n        minGallop = _minGallop;\n\n        if (minGallop < 1) {\n            minGallop = 1;\n        }\n\n        if (length2 === 1) {\n            dest -= length1;\n            cursor1 -= length1;\n            customDest = dest + 1;\n            customCursor = cursor1 + 1;\n\n            for (i = length1 - 1; i >= 0; i--) {\n                array[customDest + i] = array[customCursor + i];\n            }\n\n            array[dest] = tmp[cursor2];\n        }\n        else if (length2 === 0) {\n            throw new Error();\n            // throw new Error('mergeHigh preconditions were not respected');\n        }\n        else {\n            customCursor = dest - (length2 - 1);\n            for (i = 0; i < length2; i++) {\n                array[customCursor + i] = tmp[i];\n            }\n        }\n    }\n\n    this.mergeRuns = mergeRuns;\n    this.forceMergeRuns = forceMergeRuns;\n    this.pushRun = pushRun;\n}\n\nfunction sort(array, compare, lo, hi) {\n    if (!lo) {\n        lo = 0;\n    }\n    if (!hi) {\n        hi = array.length;\n    }\n\n    var remaining = hi - lo;\n\n    if (remaining < 2) {\n        return;\n    }\n\n    var runLength = 0;\n\n    if (remaining < DEFAULT_MIN_MERGE) {\n        runLength = makeAscendingRun(array, lo, hi, compare);\n        binaryInsertionSort(array, lo, hi, lo + runLength, compare);\n        return;\n    }\n\n    var ts = new TimSort(array, compare);\n\n    var minRun = minRunLength(remaining);\n\n    do {\n        runLength = makeAscendingRun(array, lo, hi, compare);\n        if (runLength < minRun) {\n            var force = remaining;\n            if (force > minRun) {\n                force = minRun;\n            }\n\n            binaryInsertionSort(array, lo, lo + force, lo + runLength, compare);\n            runLength = force;\n        }\n\n        ts.pushRun(lo, runLength);\n        ts.mergeRuns();\n\n        remaining -= runLength;\n        lo += runLength;\n    } while (remaining !== 0);\n\n    ts.forceMergeRuns();\n}\n\n// Use timsort because in most case elements are partially sorted\n// https://jsfiddle.net/pissang/jr4x7mdm/8/\nfunction shapeCompareFunc(a, b) {\n    if (a.zlevel === b.zlevel) {\n        if (a.z === b.z) {\n            // if (a.z2 === b.z2) {\n            //     // FIXME Slow has renderidx compare\n            //     // http://stackoverflow.com/questions/20883421/sorting-in-javascript-should-every-compare-function-have-a-return-0-statement\n            //     // https://github.com/v8/v8/blob/47cce544a31ed5577ffe2963f67acb4144ee0232/src/js/array.js#L1012\n            //     return a.__renderidx - b.__renderidx;\n            // }\n            return a.z2 - b.z2;\n        }\n        return a.z - b.z;\n    }\n    return a.zlevel - b.zlevel;\n}\n/**\n *  (M)\n * @alias module:zrender/Storage\n * @constructor\n */\nvar Storage = function () { // jshint ignore:line\n    this._roots = [];\n\n    this._displayList = [];\n\n    this._displayListLen = 0;\n};\n\nStorage.prototype = {\n\n    constructor: Storage,\n\n    /**\n     * @param  {Function} cb\n     *\n     */\n    traverse: function (cb, context) {\n        for (var i = 0; i < this._roots.length; i++) {\n            this._roots[i].traverse(cb, context);\n        }\n    },\n\n    /**\n     * \n     * @param {boolean} [update=false] \n     * @param {boolean} [includeIgnore=false]  ignore ,  update  true \n     *\n     * {@link module:zrender/graphic/Displayable.prototype.updateDisplayList}\n     * @return {Array.<module:zrender/graphic/Displayable>}\n     */\n    getDisplayList: function (update, includeIgnore) {\n        includeIgnore = includeIgnore || false;\n        if (update) {\n            this.updateDisplayList(includeIgnore);\n        }\n        return this._displayList;\n    },\n\n    /**\n     * \n     * GroupShapeShape\n     * zlevel > z > \n     * @param {boolean} [includeIgnore=false]  ignore \n     */\n    updateDisplayList: function (includeIgnore) {\n        this._displayListLen = 0;\n\n        var roots = this._roots;\n        var displayList = this._displayList;\n        for (var i = 0, len = roots.length; i < len; i++) {\n            this._updateAndAddDisplayable(roots[i], null, includeIgnore);\n        }\n\n        displayList.length = this._displayListLen;\n\n        env$1.canvasSupported && sort(displayList, shapeCompareFunc);\n    },\n\n    _updateAndAddDisplayable: function (el, clipPaths, includeIgnore) {\n\n        if (el.ignore && !includeIgnore) {\n            return;\n        }\n\n        el.beforeUpdate();\n\n        if (el.__dirty) {\n\n            el.update();\n\n        }\n\n        el.afterUpdate();\n\n        var userSetClipPath = el.clipPath;\n        if (userSetClipPath) {\n\n            // FIXME \n            if (clipPaths) {\n                clipPaths = clipPaths.slice();\n            }\n            else {\n                clipPaths = [];\n            }\n\n            var currentClipPath = userSetClipPath;\n            var parentClipPath = el;\n            // Recursively add clip path\n            while (currentClipPath) {\n                // clipPath  clipPath \n                currentClipPath.parent = parentClipPath;\n                currentClipPath.updateTransform();\n\n                clipPaths.push(currentClipPath);\n\n                parentClipPath = currentClipPath;\n                currentClipPath = currentClipPath.clipPath;\n            }\n        }\n\n        if (el.isGroup) {\n            var children = el._children;\n\n            for (var i = 0; i < children.length; i++) {\n                var child = children[i];\n\n                // Force to mark as dirty if group is dirty\n                // FIXME __dirtyPath ?\n                if (el.__dirty) {\n                    child.__dirty = true;\n                }\n\n                this._updateAndAddDisplayable(child, clipPaths, includeIgnore);\n            }\n\n            // Mark group clean here\n            el.__dirty = false;\n\n        }\n        else {\n            el.__clipPaths = clipPaths;\n\n            this._displayList[this._displayListLen++] = el;\n        }\n    },\n\n    /**\n     * (Shape)(Group)\n     * @param {module:zrender/Element} el\n     */\n    addRoot: function (el) {\n        if (el.__storage === this) {\n            return;\n        }\n\n        if (el instanceof Group) {\n            el.addChildrenToStorage(this);\n        }\n\n        this.addToStorage(el);\n        this._roots.push(el);\n    },\n\n    /**\n     * (Shape)(Group)\n     * @param {string|Array.<string>} [el] Storage\n     */\n    delRoot: function (el) {\n        if (el == null) {\n            // el\n            for (var i = 0; i < this._roots.length; i++) {\n                var root = this._roots[i];\n                if (root instanceof Group) {\n                    root.delChildrenFromStorage(this);\n                }\n            }\n\n            this._roots = [];\n            this._displayList = [];\n            this._displayListLen = 0;\n\n            return;\n        }\n\n        if (el instanceof Array) {\n            for (var i = 0, l = el.length; i < l; i++) {\n                this.delRoot(el[i]);\n            }\n            return;\n        }\n\n\n        var idx = indexOf(this._roots, el);\n        if (idx >= 0) {\n            this.delFromStorage(el);\n            this._roots.splice(idx, 1);\n            if (el instanceof Group) {\n                el.delChildrenFromStorage(this);\n            }\n        }\n    },\n\n    addToStorage: function (el) {\n        if (el) {\n            el.__storage = this;\n            el.dirty(false);\n        }\n        return this;\n    },\n\n    delFromStorage: function (el) {\n        if (el) {\n            el.__storage = null;\n        }\n\n        return this;\n    },\n\n    /**\n     * Storage\n     */\n    dispose: function () {\n        this._renderList =\n        this._roots = null;\n    },\n\n    displayableSortFunc: shapeCompareFunc\n};\n\nvar SHADOW_PROPS = {\n    'shadowBlur': 1,\n    'shadowOffsetX': 1,\n    'shadowOffsetY': 1,\n    'textShadowBlur': 1,\n    'textShadowOffsetX': 1,\n    'textShadowOffsetY': 1,\n    'textBoxShadowBlur': 1,\n    'textBoxShadowOffsetX': 1,\n    'textBoxShadowOffsetY': 1\n};\n\nvar fixShadow = function (ctx, propName, value) {\n    if (SHADOW_PROPS.hasOwnProperty(propName)) {\n        return value *= ctx.dpr;\n    }\n    return value;\n};\n\nvar STYLE_COMMON_PROPS = [\n    ['shadowBlur', 0], ['shadowOffsetX', 0], ['shadowOffsetY', 0], ['shadowColor', '#000'],\n    ['lineCap', 'butt'], ['lineJoin', 'miter'], ['miterLimit', 10]\n];\n\n// var SHADOW_PROPS = STYLE_COMMON_PROPS.slice(0, 4);\n// var LINE_PROPS = STYLE_COMMON_PROPS.slice(4);\n\nvar Style = function (opts, host) {\n    this.extendFrom(opts, false);\n    this.host = host;\n};\n\nfunction createLinearGradient(ctx, obj, rect) {\n    var x = obj.x == null ? 0 : obj.x;\n    var x2 = obj.x2 == null ? 1 : obj.x2;\n    var y = obj.y == null ? 0 : obj.y;\n    var y2 = obj.y2 == null ? 0 : obj.y2;\n\n    if (!obj.global) {\n        x = x * rect.width + rect.x;\n        x2 = x2 * rect.width + rect.x;\n        y = y * rect.height + rect.y;\n        y2 = y2 * rect.height + rect.y;\n    }\n\n    // Fix NaN when rect is Infinity\n    x = isNaN(x) ? 0 : x;\n    x2 = isNaN(x2) ? 1 : x2;\n    y = isNaN(y) ? 0 : y;\n    y2 = isNaN(y2) ? 0 : y2;\n\n    var canvasGradient = ctx.createLinearGradient(x, y, x2, y2);\n\n    return canvasGradient;\n}\n\nfunction createRadialGradient(ctx, obj, rect) {\n    var width = rect.width;\n    var height = rect.height;\n    var min = Math.min(width, height);\n\n    var x = obj.x == null ? 0.5 : obj.x;\n    var y = obj.y == null ? 0.5 : obj.y;\n    var r = obj.r == null ? 0.5 : obj.r;\n    if (!obj.global) {\n        x = x * width + rect.x;\n        y = y * height + rect.y;\n        r = r * min;\n    }\n\n    var canvasGradient = ctx.createRadialGradient(x, y, 0, x, y, r);\n\n    return canvasGradient;\n}\n\n\nStyle.prototype = {\n\n    constructor: Style,\n\n    /**\n     * @type {module:zrender/graphic/Displayable}\n     */\n    host: null,\n\n    /**\n     * @type {string}\n     */\n    fill: '#000',\n\n    /**\n     * @type {string}\n     */\n    stroke: null,\n\n    /**\n     * @type {number}\n     */\n    opacity: 1,\n\n    /**\n     * @type {Array.<number>}\n     */\n    lineDash: null,\n\n    /**\n     * @type {number}\n     */\n    lineDashOffset: 0,\n\n    /**\n     * @type {number}\n     */\n    shadowBlur: 0,\n\n    /**\n     * @type {number}\n     */\n    shadowOffsetX: 0,\n\n    /**\n     * @type {number}\n     */\n    shadowOffsetY: 0,\n\n    /**\n     * @type {number}\n     */\n    lineWidth: 1,\n\n    /**\n     * If stroke ignore scale\n     * @type {Boolean}\n     */\n    strokeNoScale: false,\n\n    // Bounding rect text configuration\n    // Not affected by element transform\n    /**\n     * @type {string}\n     */\n    text: null,\n\n    /**\n     * If `fontSize` or `fontFamily` exists, `font` will be reset by\n     * `fontSize`, `fontStyle`, `fontWeight`, `fontFamily`.\n     * So do not visit it directly in upper application (like echarts),\n     * but use `contain/text#makeFont` instead.\n     * @type {string}\n     */\n    font: null,\n\n    /**\n     * The same as font. Use font please.\n     * @deprecated\n     * @type {string}\n     */\n    textFont: null,\n\n    /**\n     * It helps merging respectively, rather than parsing an entire font string.\n     * @type {string}\n     */\n    fontStyle: null,\n\n    /**\n     * It helps merging respectively, rather than parsing an entire font string.\n     * @type {string}\n     */\n    fontWeight: null,\n\n    /**\n     * It helps merging respectively, rather than parsing an entire font string.\n     * Should be 12 but not '12px'.\n     * @type {number}\n     */\n    fontSize: null,\n\n    /**\n     * It helps merging respectively, rather than parsing an entire font string.\n     * @type {string}\n     */\n    fontFamily: null,\n\n    /**\n     * Reserved for special functinality, like 'hr'.\n     * @type {string}\n     */\n    textTag: null,\n\n    /**\n     * @type {string}\n     */\n    textFill: '#000',\n\n    /**\n     * @type {string}\n     */\n    textStroke: null,\n\n    /**\n     * @type {number}\n     */\n    textWidth: null,\n\n    /**\n     * Only for textBackground.\n     * @type {number}\n     */\n    textHeight: null,\n\n    /**\n     * textStroke may be set as some color as a default\n     * value in upper applicaion, where the default value\n     * of textStrokeWidth should be 0 to make sure that\n     * user can choose to do not use text stroke.\n     * @type {number}\n     */\n    textStrokeWidth: 0,\n\n    /**\n     * @type {number}\n     */\n    textLineHeight: null,\n\n    /**\n     * 'inside', 'left', 'right', 'top', 'bottom'\n     * [x, y]\n     * Based on x, y of rect.\n     * @type {string|Array.<number>}\n     * @default 'inside'\n     */\n    textPosition: 'inside',\n\n    /**\n     * If not specified, use the boundingRect of a `displayable`.\n     * @type {Object}\n     */\n    textRect: null,\n\n    /**\n     * [x, y]\n     * @type {Array.<number>}\n     */\n    textOffset: null,\n\n    /**\n     * @type {string}\n     */\n    textAlign: null,\n\n    /**\n     * @type {string}\n     */\n    textVerticalAlign: null,\n\n    /**\n     * @type {number}\n     */\n    textDistance: 5,\n\n    /**\n     * @type {string}\n     */\n    textShadowColor: 'transparent',\n\n    /**\n     * @type {number}\n     */\n    textShadowBlur: 0,\n\n    /**\n     * @type {number}\n     */\n    textShadowOffsetX: 0,\n\n    /**\n     * @type {number}\n     */\n    textShadowOffsetY: 0,\n\n    /**\n     * @type {string}\n     */\n    textBoxShadowColor: 'transparent',\n\n    /**\n     * @type {number}\n     */\n    textBoxShadowBlur: 0,\n\n    /**\n     * @type {number}\n     */\n    textBoxShadowOffsetX: 0,\n\n    /**\n     * @type {number}\n     */\n    textBoxShadowOffsetY: 0,\n\n    /**\n     * Whether transform text.\n     * Only useful in Path and Image element\n     * @type {boolean}\n     */\n    transformText: false,\n\n    /**\n     * Text rotate around position of Path or Image\n     * Only useful in Path and Image element and transformText is false.\n     */\n    textRotation: 0,\n\n    /**\n     * Text origin of text rotation, like [10, 40].\n     * Based on x, y of rect.\n     * Useful in label rotation of circular symbol.\n     * By default, this origin is textPosition.\n     * Can be 'center'.\n     * @type {string|Array.<number>}\n     */\n    textOrigin: null,\n\n    /**\n     * @type {string}\n     */\n    textBackgroundColor: null,\n\n    /**\n     * @type {string}\n     */\n    textBorderColor: null,\n\n    /**\n     * @type {number}\n     */\n    textBorderWidth: 0,\n\n    /**\n     * @type {number}\n     */\n    textBorderRadius: 0,\n\n    /**\n     * Can be `2` or `[2, 4]` or `[2, 3, 4, 5]`\n     * @type {number|Array.<number>}\n     */\n    textPadding: null,\n\n    /**\n     * Text styles for rich text.\n     * @type {Object}\n     */\n    rich: null,\n\n    /**\n     * {outerWidth, outerHeight, ellipsis, placeholder}\n     * @type {Object}\n     */\n    truncate: null,\n\n    /**\n     * https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/globalCompositeOperation\n     * @type {string}\n     */\n    blend: null,\n\n    /**\n     * @param {CanvasRenderingContext2D} ctx\n     */\n    bind: function (ctx, el, prevEl) {\n        var style = this;\n        var prevStyle = prevEl && prevEl.style;\n        var firstDraw = !prevStyle;\n\n        for (var i = 0; i < STYLE_COMMON_PROPS.length; i++) {\n            var prop = STYLE_COMMON_PROPS[i];\n            var styleName = prop[0];\n\n            if (firstDraw || style[styleName] !== prevStyle[styleName]) {\n                // FIXME Invalid property value will cause style leak from previous element.\n                ctx[styleName] =\n                    fixShadow(ctx, styleName, style[styleName] || prop[1]);\n            }\n        }\n\n        if ((firstDraw || style.fill !== prevStyle.fill)) {\n            ctx.fillStyle = style.fill;\n        }\n        if ((firstDraw || style.stroke !== prevStyle.stroke)) {\n            ctx.strokeStyle = style.stroke;\n        }\n        if ((firstDraw || style.opacity !== prevStyle.opacity)) {\n            ctx.globalAlpha = style.opacity == null ? 1 : style.opacity;\n        }\n\n        if ((firstDraw || style.blend !== prevStyle.blend)) {\n            ctx.globalCompositeOperation = style.blend || 'source-over';\n        }\n        if (this.hasStroke()) {\n            var lineWidth = style.lineWidth;\n            ctx.lineWidth = lineWidth / (\n                (this.strokeNoScale && el && el.getLineScale) ? el.getLineScale() : 1\n            );\n        }\n    },\n\n    hasFill: function () {\n        var fill = this.fill;\n        return fill != null && fill !== 'none';\n    },\n\n    hasStroke: function () {\n        var stroke = this.stroke;\n        return stroke != null && stroke !== 'none' && this.lineWidth > 0;\n    },\n\n    /**\n     * Extend from other style\n     * @param {zrender/graphic/Style} otherStyle\n     * @param {boolean} overwrite true: overwrirte any way.\n     *                            false: overwrite only when !target.hasOwnProperty\n     *                            others: overwrite when property is not null/undefined.\n     */\n    extendFrom: function (otherStyle, overwrite) {\n        if (otherStyle) {\n            for (var name in otherStyle) {\n                if (otherStyle.hasOwnProperty(name)\n                    && (overwrite === true\n                        || (\n                            overwrite === false\n                                ? !this.hasOwnProperty(name)\n                                : otherStyle[name] != null\n                        )\n                    )\n                ) {\n                    this[name] = otherStyle[name];\n                }\n            }\n        }\n    },\n\n    /**\n     * Batch setting style with a given object\n     * @param {Object|string} obj\n     * @param {*} [obj]\n     */\n    set: function (obj, value) {\n        if (typeof obj === 'string') {\n            this[obj] = value;\n        }\n        else {\n            this.extendFrom(obj, true);\n        }\n    },\n\n    /**\n     * Clone\n     * @return {zrender/graphic/Style} [description]\n     */\n    clone: function () {\n        var newStyle = new this.constructor();\n        newStyle.extendFrom(this, true);\n        return newStyle;\n    },\n\n    getGradient: function (ctx, obj, rect) {\n        var method = obj.type === 'radial' ? createRadialGradient : createLinearGradient;\n        var canvasGradient = method(ctx, obj, rect);\n        var colorStops = obj.colorStops;\n        for (var i = 0; i < colorStops.length; i++) {\n            canvasGradient.addColorStop(\n                colorStops[i].offset, colorStops[i].color\n            );\n        }\n        return canvasGradient;\n    }\n\n};\n\nvar styleProto = Style.prototype;\nfor (var i = 0; i < STYLE_COMMON_PROPS.length; i++) {\n    var prop = STYLE_COMMON_PROPS[i];\n    if (!(prop[0] in styleProto)) {\n        styleProto[prop[0]] = prop[1];\n    }\n}\n\n// Provide for others\nStyle.getGradient = styleProto.getGradient;\n\nvar Pattern = function (image, repeat) {\n    // Should do nothing more in this constructor. Because gradient can be\n    // declard by `color: {image: ...}`, where this constructor will not be called.\n\n    this.image = image;\n    this.repeat = repeat;\n\n    // Can be cloned\n    this.type = 'pattern';\n};\n\nPattern.prototype.getCanvasPattern = function (ctx) {\n    return ctx.createPattern(this.image, this.repeat || 'repeat');\n};\n\n/**\n * @module zrender/Layer\n * @author pissang(https://www.github.com/pissang)\n */\n\nfunction returnFalse() {\n    return false;\n}\n\n/**\n * dom\n *\n * @inner\n * @param {string} id dom id \n * @param {Painter} painter painter instance\n * @param {number} number\n */\nfunction createDom(id, painter, dpr) {\n    var newDom = createCanvas();\n    var width = painter.getWidth();\n    var height = painter.getHeight();\n\n    var newDomStyle = newDom.style;\n    if (newDomStyle) {  // In node or some other non-browser environment\n        newDomStyle.position = 'absolute';\n        newDomStyle.left = 0;\n        newDomStyle.top = 0;\n        newDomStyle.width = width + 'px';\n        newDomStyle.height = height + 'px';\n\n        newDom.setAttribute('data-zr-dom-id', id);\n    }\n\n    newDom.width = width * dpr;\n    newDom.height = height * dpr;\n\n    return newDom;\n}\n\n/**\n * @alias module:zrender/Layer\n * @constructor\n * @extends module:zrender/mixin/Transformable\n * @param {string} id\n * @param {module:zrender/Painter} painter\n * @param {number} [dpr]\n */\nvar Layer = function(id, painter, dpr) {\n    var dom;\n    dpr = dpr || devicePixelRatio;\n    if (typeof id === 'string') {\n        dom = createDom(id, painter, dpr);\n    }\n    // Not using isDom because in node it will return false\n    else if (isObject$1(id)) {\n        dom = id;\n        id = dom.id;\n    }\n    this.id = id;\n    this.dom = dom;\n\n    var domStyle = dom.style;\n    if (domStyle) { // Not in node\n        dom.onselectstart = returnFalse; // \n        domStyle['-webkit-user-select'] = 'none';\n        domStyle['user-select'] = 'none';\n        domStyle['-webkit-touch-callout'] = 'none';\n        domStyle['-webkit-tap-highlight-color'] = 'rgba(0,0,0,0)';\n        domStyle['padding'] = 0;\n        domStyle['margin'] = 0;\n        domStyle['border-width'] = 0;\n    }\n\n    this.domBack = null;\n    this.ctxBack = null;\n\n    this.painter = painter;\n\n    this.config = null;\n\n    // Configs\n    /**\n     * \n     * @type {string}\n     * @default 0\n     */\n    this.clearColor = 0;\n    /**\n     * \n     * @type {boolean}\n     * @default false\n     */\n    this.motionBlur = false;\n    /**\n     * alpha\n     * @type {number}\n     * @default 0.7\n     */\n    this.lastFrameAlpha = 0.7;\n\n    /**\n     * Layer dpr\n     * @type {number}\n     */\n    this.dpr = dpr;\n};\n\nLayer.prototype = {\n\n    constructor: Layer,\n\n    __dirty: true,\n\n    __used: false,\n\n    __drawIndex: 0,\n    __startIndex: 0,\n    __endIndex: 0,\n\n    incremental: false,\n\n    getElementCount: function () {\n        return this.__endIndex - this.__startIndex;\n    },\n\n    initContext: function () {\n        this.ctx = this.dom.getContext('2d');\n        this.ctx.dpr = this.dpr;\n    },\n\n    createBackBuffer: function () {\n        var dpr = this.dpr;\n\n        this.domBack = createDom('back-' + this.id, this.painter, dpr);\n        this.ctxBack = this.domBack.getContext('2d');\n\n        if (dpr != 1) {\n            this.ctxBack.scale(dpr, dpr);\n        }\n    },\n\n    /**\n     * @param  {number} width\n     * @param  {number} height\n     */\n    resize: function (width, height) {\n        var dpr = this.dpr;\n\n        var dom = this.dom;\n        var domStyle = dom.style;\n        var domBack = this.domBack;\n\n        if (domStyle) {\n            domStyle.width = width + 'px';\n            domStyle.height = height + 'px';\n        }\n\n        dom.width = width * dpr;\n        dom.height = height * dpr;\n\n        if (domBack) {\n            domBack.width = width * dpr;\n            domBack.height = height * dpr;\n\n            if (dpr != 1) {\n                this.ctxBack.scale(dpr, dpr);\n            }\n        }\n    },\n\n    /**\n     * \n     * @param {boolean} [clearAll]=false Clear all with out motion blur\n     * @param {Color} [clearColor]\n     */\n    clear: function (clearAll, clearColor) {\n        var dom = this.dom;\n        var ctx = this.ctx;\n        var width = dom.width;\n        var height = dom.height;\n\n        var clearColor = clearColor || this.clearColor;\n        var haveMotionBLur = this.motionBlur && !clearAll;\n        var lastFrameAlpha = this.lastFrameAlpha;\n\n        var dpr = this.dpr;\n\n        if (haveMotionBLur) {\n            if (!this.domBack) {\n                this.createBackBuffer();\n            }\n\n            this.ctxBack.globalCompositeOperation = 'copy';\n            this.ctxBack.drawImage(\n                dom, 0, 0,\n                width / dpr,\n                height / dpr\n            );\n        }\n\n        ctx.clearRect(0, 0, width, height);\n        if (clearColor && clearColor !== 'transparent') {\n            var clearColorGradientOrPattern;\n            // Gradient\n            if (clearColor.colorStops) {\n                // Cache canvas gradient\n                clearColorGradientOrPattern = clearColor.__canvasGradient || Style.getGradient(ctx, clearColor, {\n                    x: 0,\n                    y: 0,\n                    width: width,\n                    height: height\n                });\n\n                clearColor.__canvasGradient = clearColorGradientOrPattern;\n            }\n            // Pattern\n            else if (clearColor.image) {\n                clearColorGradientOrPattern = Pattern.prototype.getCanvasPattern.call(clearColor, ctx);\n            }\n            ctx.save();\n            ctx.fillStyle = clearColorGradientOrPattern || clearColor;\n            ctx.fillRect(0, 0, width, height);\n            ctx.restore();\n        }\n\n        if (haveMotionBLur) {\n            var domBack = this.domBack;\n            ctx.save();\n            ctx.globalAlpha = lastFrameAlpha;\n            ctx.drawImage(domBack, 0, 0, width, height);\n            ctx.restore();\n        }\n    }\n};\n\nvar requestAnimationFrame = (\n    typeof window !== 'undefined'\n    && (\n        (window.requestAnimationFrame && window.requestAnimationFrame.bind(window))\n        // https://github.com/ecomfe/zrender/issues/189#issuecomment-224919809\n        || (window.msRequestAnimationFrame && window.msRequestAnimationFrame.bind(window))\n        || window.mozRequestAnimationFrame\n        || window.webkitRequestAnimationFrame\n    )\n) || function (func) {\n    setTimeout(func, 16);\n};\n\nvar globalImageCache = new LRU(50);\n\n/**\n * @param {string|HTMLImageElement|HTMLCanvasElement|Canvas} newImageOrSrc\n * @return {HTMLImageElement|HTMLCanvasElement|Canvas} image\n */\nfunction findExistImage(newImageOrSrc) {\n    if (typeof newImageOrSrc === 'string') {\n        var cachedImgObj = globalImageCache.get(newImageOrSrc);\n        return cachedImgObj && cachedImgObj.image;\n    }\n    else {\n        return newImageOrSrc;\n    }\n}\n\n/**\n * Caution: User should cache loaded images, but not just count on LRU.\n * Consider if required images more than LRU size, will dead loop occur?\n *\n * @param {string|HTMLImageElement|HTMLCanvasElement|Canvas} newImageOrSrc\n * @param {HTMLImageElement|HTMLCanvasElement|Canvas} image Existent image.\n * @param {module:zrender/Element} [hostEl] For calling `dirty`.\n * @param {Function} [cb] params: (image, cbPayload)\n * @param {Object} [cbPayload] Payload on cb calling.\n * @return {HTMLImageElement|HTMLCanvasElement|Canvas} image\n */\nfunction createOrUpdateImage(newImageOrSrc, image, hostEl, cb, cbPayload) {\n    if (!newImageOrSrc) {\n        return image;\n    }\n    else if (typeof newImageOrSrc === 'string') {\n\n        // Image should not be loaded repeatly.\n        if ((image && image.__zrImageSrc === newImageOrSrc) || !hostEl) {\n            return image;\n        }\n\n        // Only when there is no existent image or existent image src\n        // is different, this method is responsible for load.\n        var cachedImgObj = globalImageCache.get(newImageOrSrc);\n\n        var pendingWrap = {hostEl: hostEl, cb: cb, cbPayload: cbPayload};\n\n        if (cachedImgObj) {\n            image = cachedImgObj.image;\n            !isImageReady(image) && cachedImgObj.pending.push(pendingWrap);\n        }\n        else {\n            !image && (image = new Image());\n            image.onload = imageOnLoad;\n\n            globalImageCache.put(\n                newImageOrSrc,\n                image.__cachedImgObj = {\n                    image: image,\n                    pending: [pendingWrap]\n                }\n            );\n\n            image.src = image.__zrImageSrc = newImageOrSrc;\n        }\n\n        return image;\n    }\n    // newImageOrSrc is an HTMLImageElement or HTMLCanvasElement or Canvas\n    else {\n        return newImageOrSrc;\n    }\n}\n\nfunction imageOnLoad() {\n    var cachedImgObj = this.__cachedImgObj;\n    this.onload = this.__cachedImgObj = null;\n\n    for (var i = 0; i < cachedImgObj.pending.length; i++) {\n        var pendingWrap = cachedImgObj.pending[i];\n        var cb = pendingWrap.cb;\n        cb && cb(this, pendingWrap.cbPayload);\n        pendingWrap.hostEl.dirty();\n    }\n    cachedImgObj.pending.length = 0;\n}\n\nfunction isImageReady(image) {\n    return image && image.width && image.height;\n}\n\nvar textWidthCache = {};\nvar textWidthCacheCounter = 0;\n\nvar TEXT_CACHE_MAX = 5000;\nvar STYLE_REG = /\\{([a-zA-Z0-9_]+)\\|([^}]*)\\}/g;\n\nvar DEFAULT_FONT = '12px sans-serif';\n\n// Avoid assign to an exported variable, for transforming to cjs.\nvar methods$1 = {};\n\nfunction $override$1(name, fn) {\n    methods$1[name] = fn;\n}\n\n/**\n * @public\n * @param {string} text\n * @param {string} font\n * @return {number} width\n */\nfunction getWidth(text, font) {\n    font = font || DEFAULT_FONT;\n    var key = text + ':' + font;\n    if (textWidthCache[key]) {\n        return textWidthCache[key];\n    }\n\n    var textLines = (text + '').split('\\n');\n    var width = 0;\n\n    for (var i = 0, l = textLines.length; i < l; i++) {\n        // textContain.measureText may be overrided in SVG or VML\n        width = Math.max(measureText(textLines[i], font).width, width);\n    }\n\n    if (textWidthCacheCounter > TEXT_CACHE_MAX) {\n        textWidthCacheCounter = 0;\n        textWidthCache = {};\n    }\n    textWidthCacheCounter++;\n    textWidthCache[key] = width;\n\n    return width;\n}\n\n/**\n * @public\n * @param {string} text\n * @param {string} font\n * @param {string} [textAlign='left']\n * @param {string} [textVerticalAlign='top']\n * @param {Array.<number>} [textPadding]\n * @param {Object} [rich]\n * @param {Object} [truncate]\n * @return {Object} {x, y, width, height, lineHeight}\n */\nfunction getBoundingRect(text, font, textAlign, textVerticalAlign, textPadding, rich, truncate) {\n    return rich\n        ? getRichTextRect(text, font, textAlign, textVerticalAlign, textPadding, rich, truncate)\n        : getPlainTextRect(text, font, textAlign, textVerticalAlign, textPadding, truncate);\n}\n\nfunction getPlainTextRect(text, font, textAlign, textVerticalAlign, textPadding, truncate) {\n    var contentBlock = parsePlainText(text, font, textPadding, truncate);\n    var outerWidth = getWidth(text, font);\n    if (textPadding) {\n        outerWidth += textPadding[1] + textPadding[3];\n    }\n    var outerHeight = contentBlock.outerHeight;\n\n    var x = adjustTextX(0, outerWidth, textAlign);\n    var y = adjustTextY(0, outerHeight, textVerticalAlign);\n\n    var rect = new BoundingRect(x, y, outerWidth, outerHeight);\n    rect.lineHeight = contentBlock.lineHeight;\n\n    return rect;\n}\n\nfunction getRichTextRect(text, font, textAlign, textVerticalAlign, textPadding, rich, truncate) {\n    var contentBlock = parseRichText(text, {\n        rich: rich,\n        truncate: truncate,\n        font: font,\n        textAlign: textAlign,\n        textPadding: textPadding\n    });\n    var outerWidth = contentBlock.outerWidth;\n    var outerHeight = contentBlock.outerHeight;\n\n    var x = adjustTextX(0, outerWidth, textAlign);\n    var y = adjustTextY(0, outerHeight, textVerticalAlign);\n\n    return new BoundingRect(x, y, outerWidth, outerHeight);\n}\n\n/**\n * @public\n * @param {number} x\n * @param {number} width\n * @param {string} [textAlign='left']\n * @return {number} Adjusted x.\n */\nfunction adjustTextX(x, width, textAlign) {\n    // FIXME Right to left language\n    if (textAlign === 'right') {\n        x -= width;\n    }\n    else if (textAlign === 'center') {\n        x -= width / 2;\n    }\n    return x;\n}\n\n/**\n * @public\n * @param {number} y\n * @param {number} height\n * @param {string} [textVerticalAlign='top']\n * @return {number} Adjusted y.\n */\nfunction adjustTextY(y, height, textVerticalAlign) {\n    if (textVerticalAlign === 'middle') {\n        y -= height / 2;\n    }\n    else if (textVerticalAlign === 'bottom') {\n        y -= height;\n    }\n    return y;\n}\n\n/**\n * @public\n * @param {stirng} textPosition\n * @param {Object} rect {x, y, width, height}\n * @param {number} distance\n * @return {Object} {x, y, textAlign, textVerticalAlign}\n */\nfunction adjustTextPositionOnRect(textPosition, rect, distance) {\n\n    var x = rect.x;\n    var y = rect.y;\n\n    var height = rect.height;\n    var width = rect.width;\n    var halfHeight = height / 2;\n\n    var textAlign = 'left';\n    var textVerticalAlign = 'top';\n\n    switch (textPosition) {\n        case 'left':\n            x -= distance;\n            y += halfHeight;\n            textAlign = 'right';\n            textVerticalAlign = 'middle';\n            break;\n        case 'right':\n            x += distance + width;\n            y += halfHeight;\n            textVerticalAlign = 'middle';\n            break;\n        case 'top':\n            x += width / 2;\n            y -= distance;\n            textAlign = 'center';\n            textVerticalAlign = 'bottom';\n            break;\n        case 'bottom':\n            x += width / 2;\n            y += height + distance;\n            textAlign = 'center';\n            break;\n        case 'inside':\n            x += width / 2;\n            y += halfHeight;\n            textAlign = 'center';\n            textVerticalAlign = 'middle';\n            break;\n        case 'insideLeft':\n            x += distance;\n            y += halfHeight;\n            textVerticalAlign = 'middle';\n            break;\n        case 'insideRight':\n            x += width - distance;\n            y += halfHeight;\n            textAlign = 'right';\n            textVerticalAlign = 'middle';\n            break;\n        case 'insideTop':\n            x += width / 2;\n            y += distance;\n            textAlign = 'center';\n            break;\n        case 'insideBottom':\n            x += width / 2;\n            y += height - distance;\n            textAlign = 'center';\n            textVerticalAlign = 'bottom';\n            break;\n        case 'insideTopLeft':\n            x += distance;\n            y += distance;\n            break;\n        case 'insideTopRight':\n            x += width - distance;\n            y += distance;\n            textAlign = 'right';\n            break;\n        case 'insideBottomLeft':\n            x += distance;\n            y += height - distance;\n            textVerticalAlign = 'bottom';\n            break;\n        case 'insideBottomRight':\n            x += width - distance;\n            y += height - distance;\n            textAlign = 'right';\n            textVerticalAlign = 'bottom';\n            break;\n    }\n\n    return {\n        x: x,\n        y: y,\n        textAlign: textAlign,\n        textVerticalAlign: textVerticalAlign\n    };\n}\n\n/**\n * Show ellipsis if overflow.\n *\n * @public\n * @param  {string} text\n * @param  {string} containerWidth\n * @param  {string} font\n * @param  {number} [ellipsis='...']\n * @param  {Object} [options]\n * @param  {number} [options.maxIterations=3]\n * @param  {number} [options.minChar=0] If truncate result are less\n *                  then minChar, ellipsis will not show, which is\n *                  better for user hint in some cases.\n * @param  {number} [options.placeholder=''] When all truncated, use the placeholder.\n * @return {string}\n */\nfunction truncateText(text, containerWidth, font, ellipsis, options) {\n    if (!containerWidth) {\n        return '';\n    }\n\n    var textLines = (text + '').split('\\n');\n    options = prepareTruncateOptions(containerWidth, font, ellipsis, options);\n\n    // FIXME\n    // It is not appropriate that every line has '...' when truncate multiple lines.\n    for (var i = 0, len = textLines.length; i < len; i++) {\n        textLines[i] = truncateSingleLine(textLines[i], options);\n    }\n\n    return textLines.join('\\n');\n}\n\nfunction prepareTruncateOptions(containerWidth, font, ellipsis, options) {\n    options = extend({}, options);\n\n    options.font = font;\n    var ellipsis = retrieve2(ellipsis, '...');\n    options.maxIterations = retrieve2(options.maxIterations, 2);\n    var minChar = options.minChar = retrieve2(options.minChar, 0);\n    // FIXME\n    // Other languages?\n    options.cnCharWidth = getWidth('', font);\n    // FIXME\n    // Consider proportional font?\n    var ascCharWidth = options.ascCharWidth = getWidth('a', font);\n    options.placeholder = retrieve2(options.placeholder, '');\n\n    // Example 1: minChar: 3, text: 'asdfzxcv', truncate result: 'asdf', but not: 'a...'.\n    // Example 2: minChar: 3, text: '', truncate result: '', but not: '...'.\n    var contentWidth = containerWidth = Math.max(0, containerWidth - 1); // Reserve some gap.\n    for (var i = 0; i < minChar && contentWidth >= ascCharWidth; i++) {\n        contentWidth -= ascCharWidth;\n    }\n\n    var ellipsisWidth = getWidth(ellipsis);\n    if (ellipsisWidth > contentWidth) {\n        ellipsis = '';\n        ellipsisWidth = 0;\n    }\n\n    contentWidth = containerWidth - ellipsisWidth;\n\n    options.ellipsis = ellipsis;\n    options.ellipsisWidth = ellipsisWidth;\n    options.contentWidth = contentWidth;\n    options.containerWidth = containerWidth;\n\n    return options;\n}\n\nfunction truncateSingleLine(textLine, options) {\n    var containerWidth = options.containerWidth;\n    var font = options.font;\n    var contentWidth = options.contentWidth;\n\n    if (!containerWidth) {\n        return '';\n    }\n\n    var lineWidth = getWidth(textLine, font);\n\n    if (lineWidth <= containerWidth) {\n        return textLine;\n    }\n\n    for (var j = 0;; j++) {\n        if (lineWidth <= contentWidth || j >= options.maxIterations) {\n            textLine += options.ellipsis;\n            break;\n        }\n\n        var subLength = j === 0\n            ? estimateLength(textLine, contentWidth, options.ascCharWidth, options.cnCharWidth)\n            : lineWidth > 0\n            ? Math.floor(textLine.length * contentWidth / lineWidth)\n            : 0;\n\n        textLine = textLine.substr(0, subLength);\n        lineWidth = getWidth(textLine, font);\n    }\n\n    if (textLine === '') {\n        textLine = options.placeholder;\n    }\n\n    return textLine;\n}\n\nfunction estimateLength(text, contentWidth, ascCharWidth, cnCharWidth) {\n    var width = 0;\n    var i = 0;\n    for (var len = text.length; i < len && width < contentWidth; i++) {\n        var charCode = text.charCodeAt(i);\n        width += (0 <= charCode && charCode <= 127) ? ascCharWidth : cnCharWidth;\n    }\n    return i;\n}\n\n/**\n * @public\n * @param {string} font\n * @return {number} line height\n */\nfunction getLineHeight(font) {\n    // FIXME A rough approach.\n    return getWidth('', font);\n}\n\n/**\n * @public\n * @param {string} text\n * @param {string} font\n * @return {Object} width\n */\nfunction measureText(text, font) {\n    return methods$1.measureText(text, font);\n}\n\n// Avoid assign to an exported variable, for transforming to cjs.\nmethods$1.measureText = function (text, font) {\n    var ctx = getContext();\n    ctx.font = font || DEFAULT_FONT;\n    return ctx.measureText(text);\n};\n\n/**\n * @public\n * @param {string} text\n * @param {string} font\n * @param {Object} [truncate]\n * @return {Object} block: {lineHeight, lines, height, outerHeight}\n *  Notice: for performance, do not calculate outerWidth util needed.\n */\nfunction parsePlainText(text, font, padding, truncate) {\n    text != null && (text += '');\n\n    var lineHeight = getLineHeight(font);\n    var lines = text ? text.split('\\n') : [];\n    var height = lines.length * lineHeight;\n    var outerHeight = height;\n\n    if (padding) {\n        outerHeight += padding[0] + padding[2];\n    }\n\n    if (text && truncate) {\n        var truncOuterHeight = truncate.outerHeight;\n        var truncOuterWidth = truncate.outerWidth;\n        if (truncOuterHeight != null && outerHeight > truncOuterHeight) {\n            text = '';\n            lines = [];\n        }\n        else if (truncOuterWidth != null) {\n            var options = prepareTruncateOptions(\n                truncOuterWidth - (padding ? padding[1] + padding[3] : 0),\n                font,\n                truncate.ellipsis,\n                {minChar: truncate.minChar, placeholder: truncate.placeholder}\n            );\n\n            // FIXME\n            // It is not appropriate that every line has '...' when truncate multiple lines.\n            for (var i = 0, len = lines.length; i < len; i++) {\n                lines[i] = truncateSingleLine(lines[i], options);\n            }\n        }\n    }\n\n    return {\n        lines: lines,\n        height: height,\n        outerHeight: outerHeight,\n        lineHeight: lineHeight\n    };\n}\n\n/**\n * For example: 'some text {a|some text}other text{b|some text}xxx{c|}xxx'\n * Also consider 'bbbb{a|xxx\\nzzz}xxxx\\naaaa'.\n *\n * @public\n * @param {string} text\n * @param {Object} style\n * @return {Object} block\n * {\n *      width,\n *      height,\n *      lines: [{\n *          lineHeight,\n *          width,\n *          tokens: [[{\n *              styleName,\n *              text,\n *              width,      // include textPadding\n *              height,     // include textPadding\n *              textWidth, // pure text width\n *              textHeight, // pure text height\n *              lineHeihgt,\n *              font,\n *              textAlign,\n *              textVerticalAlign\n *          }], [...], ...]\n *      }, ...]\n * }\n * If styleName is undefined, it is plain text.\n */\nfunction parseRichText(text, style) {\n    var contentBlock = {lines: [], width: 0, height: 0};\n\n    text != null && (text += '');\n    if (!text) {\n        return contentBlock;\n    }\n\n    var lastIndex = STYLE_REG.lastIndex = 0;\n    var result;\n    while ((result = STYLE_REG.exec(text)) != null) {\n        var matchedIndex = result.index;\n        if (matchedIndex > lastIndex) {\n            pushTokens(contentBlock, text.substring(lastIndex, matchedIndex));\n        }\n        pushTokens(contentBlock, result[2], result[1]);\n        lastIndex = STYLE_REG.lastIndex;\n    }\n\n    if (lastIndex < text.length) {\n        pushTokens(contentBlock, text.substring(lastIndex, text.length));\n    }\n\n    var lines = contentBlock.lines;\n    var contentHeight = 0;\n    var contentWidth = 0;\n    // For `textWidth: 100%`\n    var pendingList = [];\n\n    var stlPadding = style.textPadding;\n\n    var truncate = style.truncate;\n    var truncateWidth = truncate && truncate.outerWidth;\n    var truncateHeight = truncate && truncate.outerHeight;\n    if (stlPadding) {\n        truncateWidth != null && (truncateWidth -= stlPadding[1] + stlPadding[3]);\n        truncateHeight != null && (truncateHeight -= stlPadding[0] + stlPadding[2]);\n    }\n\n    // Calculate layout info of tokens.\n    for (var i = 0; i < lines.length; i++) {\n        var line = lines[i];\n        var lineHeight = 0;\n        var lineWidth = 0;\n\n        for (var j = 0; j < line.tokens.length; j++) {\n            var token = line.tokens[j];\n            var tokenStyle = token.styleName && style.rich[token.styleName] || {};\n            // textPadding should not inherit from style.\n            var textPadding = token.textPadding = tokenStyle.textPadding;\n\n            // textFont has been asigned to font by `normalizeStyle`.\n            var font = token.font = tokenStyle.font || style.font;\n\n            // textHeight can be used when textVerticalAlign is specified in token.\n            var tokenHeight = token.textHeight = retrieve2(\n                // textHeight should not be inherited, consider it can be specified\n                // as box height of the block.\n                tokenStyle.textHeight, getLineHeight(font)\n            );\n            textPadding && (tokenHeight += textPadding[0] + textPadding[2]);\n            token.height = tokenHeight;\n            token.lineHeight = retrieve3(\n                tokenStyle.textLineHeight, style.textLineHeight, tokenHeight\n            );\n\n            token.textAlign = tokenStyle && tokenStyle.textAlign || style.textAlign;\n            token.textVerticalAlign = tokenStyle && tokenStyle.textVerticalAlign || 'middle';\n\n            if (truncateHeight != null && contentHeight + token.lineHeight > truncateHeight) {\n                return {lines: [], width: 0, height: 0};\n            }\n\n            token.textWidth = getWidth(token.text, font);\n            var tokenWidth = tokenStyle.textWidth;\n            var tokenWidthNotSpecified = tokenWidth == null || tokenWidth === 'auto';\n\n            // Percent width, can be `100%`, can be used in drawing separate\n            // line when box width is needed to be auto.\n            if (typeof tokenWidth === 'string' && tokenWidth.charAt(tokenWidth.length - 1) === '%') {\n                token.percentWidth = tokenWidth;\n                pendingList.push(token);\n                tokenWidth = 0;\n                // Do not truncate in this case, because there is no user case\n                // and it is too complicated.\n            }\n            else {\n                if (tokenWidthNotSpecified) {\n                    tokenWidth = token.textWidth;\n\n                    // FIXME: If image is not loaded and textWidth is not specified, calling\n                    // `getBoundingRect()` will not get correct result.\n                    var textBackgroundColor = tokenStyle.textBackgroundColor;\n                    var bgImg = textBackgroundColor && textBackgroundColor.image;\n\n                    // Use cases:\n                    // (1) If image is not loaded, it will be loaded at render phase and call\n                    // `dirty()` and `textBackgroundColor.image` will be replaced with the loaded\n                    // image, and then the right size will be calculated here at the next tick.\n                    // See `graphic/helper/text.js`.\n                    // (2) If image loaded, and `textBackgroundColor.image` is image src string,\n                    // use `imageHelper.findExistImage` to find cached image.\n                    // `imageHelper.findExistImage` will always be called here before\n                    // `imageHelper.createOrUpdateImage` in `graphic/helper/text.js#renderRichText`\n                    // which ensures that image will not be rendered before correct size calcualted.\n                    if (bgImg) {\n                        bgImg = findExistImage(bgImg);\n                        if (isImageReady(bgImg)) {\n                            tokenWidth = Math.max(tokenWidth, bgImg.width * tokenHeight / bgImg.height);\n                        }\n                    }\n                }\n\n                var paddingW = textPadding ? textPadding[1] + textPadding[3] : 0;\n                tokenWidth += paddingW;\n\n                var remianTruncWidth = truncateWidth != null ? truncateWidth - lineWidth : null;\n\n                if (remianTruncWidth != null && remianTruncWidth < tokenWidth) {\n                    if (!tokenWidthNotSpecified || remianTruncWidth < paddingW) {\n                        token.text = '';\n                        token.textWidth = tokenWidth = 0;\n                    }\n                    else {\n                        token.text = truncateText(\n                            token.text, remianTruncWidth - paddingW, font, truncate.ellipsis,\n                            {minChar: truncate.minChar}\n                        );\n                        token.textWidth = getWidth(token.text, font);\n                        tokenWidth = token.textWidth + paddingW;\n                    }\n                }\n            }\n\n            lineWidth += (token.width = tokenWidth);\n            tokenStyle && (lineHeight = Math.max(lineHeight, token.lineHeight));\n        }\n\n        line.width = lineWidth;\n        line.lineHeight = lineHeight;\n        contentHeight += lineHeight;\n        contentWidth = Math.max(contentWidth, lineWidth);\n    }\n\n    contentBlock.outerWidth = contentBlock.width = retrieve2(style.textWidth, contentWidth);\n    contentBlock.outerHeight = contentBlock.height = retrieve2(style.textHeight, contentHeight);\n\n    if (stlPadding) {\n        contentBlock.outerWidth += stlPadding[1] + stlPadding[3];\n        contentBlock.outerHeight += stlPadding[0] + stlPadding[2];\n    }\n\n    for (var i = 0; i < pendingList.length; i++) {\n        var token = pendingList[i];\n        var percentWidth = token.percentWidth;\n        // Should not base on outerWidth, because token can not be placed out of padding.\n        token.width = parseInt(percentWidth, 10) / 100 * contentWidth;\n    }\n\n    return contentBlock;\n}\n\nfunction pushTokens(block, str, styleName) {\n    var isEmptyStr = str === '';\n    var strs = str.split('\\n');\n    var lines = block.lines;\n\n    for (var i = 0; i < strs.length; i++) {\n        var text = strs[i];\n        var token = {\n            styleName: styleName,\n            text: text,\n            isLineHolder: !text && !isEmptyStr\n        };\n\n        // The first token should be appended to the last line.\n        if (!i) {\n            var tokens = (lines[lines.length - 1] || (lines[0] = {tokens: []})).tokens;\n\n            // Consider cases:\n            // (1) ''.split('\\n') => ['', '\\n', ''], the '' at the first item\n            // (which is a placeholder) should be replaced by new token.\n            // (2) A image backage, where token likes {a|}.\n            // (3) A redundant '' will affect textAlign in line.\n            // (4) tokens with the same tplName should not be merged, because\n            // they should be displayed in different box (with border and padding).\n            var tokensLen = tokens.length;\n            (tokensLen === 1 && tokens[0].isLineHolder)\n                ? (tokens[0] = token)\n                // Consider text is '', only insert when it is the \"lineHolder\" or\n                // \"emptyStr\". Otherwise a redundant '' will affect textAlign in line.\n                : ((text || !tokensLen || isEmptyStr) && tokens.push(token));\n        }\n        // Other tokens always start a new line.\n        else {\n            // If there is '', insert it as a placeholder.\n            lines.push({tokens: [token]});\n        }\n    }\n}\n\nfunction makeFont(style) {\n    // FIXME in node-canvas fontWeight is before fontStyle\n    // Use `fontSize` `fontFamily` to check whether font properties are defined.\n    var font = (style.fontSize || style.fontFamily) && [\n        style.fontStyle,\n        style.fontWeight,\n        (style.fontSize || 12) + 'px',\n        // If font properties are defined, `fontFamily` should not be ignored.\n        style.fontFamily || 'sans-serif'\n    ].join(' ');\n    return font && trim(font) || style.textFont || style.font;\n}\n\nfunction buildPath(ctx, shape) {\n    var x = shape.x;\n    var y = shape.y;\n    var width = shape.width;\n    var height = shape.height;\n    var r = shape.r;\n    var r1;\n    var r2;\n    var r3;\n    var r4;\n\n    // Convert width and height to positive for better borderRadius\n    if (width < 0) {\n        x = x + width;\n        width = -width;\n    }\n    if (height < 0) {\n        y = y + height;\n        height = -height;\n    }\n\n    if (typeof r === 'number') {\n        r1 = r2 = r3 = r4 = r;\n    }\n    else if (r instanceof Array) {\n        if (r.length === 1) {\n            r1 = r2 = r3 = r4 = r[0];\n        }\n        else if (r.length === 2) {\n            r1 = r3 = r[0];\n            r2 = r4 = r[1];\n        }\n        else if (r.length === 3) {\n            r1 = r[0];\n            r2 = r4 = r[1];\n            r3 = r[2];\n        }\n        else {\n            r1 = r[0];\n            r2 = r[1];\n            r3 = r[2];\n            r4 = r[3];\n        }\n    }\n    else {\n        r1 = r2 = r3 = r4 = 0;\n    }\n\n    var total;\n    if (r1 + r2 > width) {\n        total = r1 + r2;\n        r1 *= width / total;\n        r2 *= width / total;\n    }\n    if (r3 + r4 > width) {\n        total = r3 + r4;\n        r3 *= width / total;\n        r4 *= width / total;\n    }\n    if (r2 + r3 > height) {\n        total = r2 + r3;\n        r2 *= height / total;\n        r3 *= height / total;\n    }\n    if (r1 + r4 > height) {\n        total = r1 + r4;\n        r1 *= height / total;\n        r4 *= height / total;\n    }\n    ctx.moveTo(x + r1, y);\n    ctx.lineTo(x + width - r2, y);\n    r2 !== 0 && ctx.arc(x + width - r2, y + r2, r2, -Math.PI / 2, 0);\n    ctx.lineTo(x + width, y + height - r3);\n    r3 !== 0 && ctx.arc(x + width - r3, y + height - r3, r3, 0, Math.PI / 2);\n    ctx.lineTo(x + r4, y + height);\n    r4 !== 0 && ctx.arc(x + r4, y + height - r4, r4, Math.PI / 2, Math.PI);\n    ctx.lineTo(x, y + r1);\n    r1 !== 0 && ctx.arc(x + r1, y + r1, r1, Math.PI, Math.PI * 1.5);\n}\n\n// TODO: Have not support 'start', 'end' yet.\nvar VALID_TEXT_ALIGN = {left: 1, right: 1, center: 1};\nvar VALID_TEXT_VERTICAL_ALIGN = {top: 1, bottom: 1, middle: 1};\n\n/**\n * @param {module:zrender/graphic/Style} style\n * @return {module:zrender/graphic/Style} The input style.\n */\nfunction normalizeTextStyle(style) {\n    normalizeStyle(style);\n    each$1(style.rich, normalizeStyle);\n    return style;\n}\n\nfunction normalizeStyle(style) {\n    if (style) {\n\n        style.font = makeFont(style);\n\n        var textAlign = style.textAlign;\n        textAlign === 'middle' && (textAlign = 'center');\n        style.textAlign = (\n            textAlign == null || VALID_TEXT_ALIGN[textAlign]\n        ) ? textAlign : 'left';\n\n        // Compatible with textBaseline.\n        var textVerticalAlign = style.textVerticalAlign || style.textBaseline;\n        textVerticalAlign === 'center' && (textVerticalAlign = 'middle');\n        style.textVerticalAlign = (\n            textVerticalAlign == null || VALID_TEXT_VERTICAL_ALIGN[textVerticalAlign]\n        ) ? textVerticalAlign : 'top';\n\n        var textPadding = style.textPadding;\n        if (textPadding) {\n            style.textPadding = normalizeCssArray(style.textPadding);\n        }\n    }\n}\n\n/**\n * @param {CanvasRenderingContext2D} ctx\n * @param {string} text\n * @param {module:zrender/graphic/Style} style\n * @param {Object|boolean} [rect] {x, y, width, height}\n *                  If set false, rect text is not used.\n */\nfunction renderText(hostEl, ctx, text, style, rect) {\n    style.rich\n        ? renderRichText(hostEl, ctx, text, style, rect)\n        : renderPlainText(hostEl, ctx, text, style, rect);\n}\n\nfunction renderPlainText(hostEl, ctx, text, style, rect) {\n    var font = setCtx(ctx, 'font', style.font || DEFAULT_FONT);\n\n    var textPadding = style.textPadding;\n\n    var contentBlock = hostEl.__textCotentBlock;\n    if (!contentBlock || hostEl.__dirty) {\n        contentBlock = hostEl.__textCotentBlock = parsePlainText(\n            text, font, textPadding, style.truncate\n        );\n    }\n\n    var outerHeight = contentBlock.outerHeight;\n\n    var textLines = contentBlock.lines;\n    var lineHeight = contentBlock.lineHeight;\n\n    var boxPos = getBoxPosition(outerHeight, style, rect);\n    var baseX = boxPos.baseX;\n    var baseY = boxPos.baseY;\n    var textAlign = boxPos.textAlign;\n    var textVerticalAlign = boxPos.textVerticalAlign;\n\n    // Origin of textRotation should be the base point of text drawing.\n    applyTextRotation(ctx, style, rect, baseX, baseY);\n\n    var boxY = adjustTextY(baseY, outerHeight, textVerticalAlign);\n    var textX = baseX;\n    var textY = boxY;\n\n    var needDrawBg = needDrawBackground(style);\n    if (needDrawBg || textPadding) {\n        // Consider performance, do not call getTextWidth util necessary.\n        var textWidth = getWidth(text, font);\n        var outerWidth = textWidth;\n        textPadding && (outerWidth += textPadding[1] + textPadding[3]);\n        var boxX = adjustTextX(baseX, outerWidth, textAlign);\n\n        needDrawBg && drawBackground(hostEl, ctx, style, boxX, boxY, outerWidth, outerHeight);\n\n        if (textPadding) {\n            textX = getTextXForPadding(baseX, textAlign, textPadding);\n            textY += textPadding[0];\n        }\n    }\n\n    setCtx(ctx, 'textAlign', textAlign || 'left');\n    // Force baseline to be \"middle\". Otherwise, if using \"top\", the\n    // text will offset downward a little bit in font \"Microsoft YaHei\".\n    setCtx(ctx, 'textBaseline', 'middle');\n\n    // Always set shadowBlur and shadowOffset to avoid leak from displayable.\n    setCtx(ctx, 'shadowBlur', style.textShadowBlur || 0);\n    setCtx(ctx, 'shadowColor', style.textShadowColor || 'transparent');\n    setCtx(ctx, 'shadowOffsetX', style.textShadowOffsetX || 0);\n    setCtx(ctx, 'shadowOffsetY', style.textShadowOffsetY || 0);\n\n    // `textBaseline` is set as 'middle'.\n    textY += lineHeight / 2;\n\n    var textStrokeWidth = style.textStrokeWidth;\n    var textStroke = getStroke(style.textStroke, textStrokeWidth);\n    var textFill = getFill(style.textFill);\n\n    if (textStroke) {\n        setCtx(ctx, 'lineWidth', textStrokeWidth);\n        setCtx(ctx, 'strokeStyle', textStroke);\n    }\n    if (textFill) {\n        setCtx(ctx, 'fillStyle', textFill);\n    }\n\n    for (var i = 0; i < textLines.length; i++) {\n        // Fill after stroke so the outline will not cover the main part.\n        textStroke && ctx.strokeText(textLines[i], textX, textY);\n        textFill && ctx.fillText(textLines[i], textX, textY);\n        textY += lineHeight;\n    }\n}\n\nfunction renderRichText(hostEl, ctx, text, style, rect) {\n    var contentBlock = hostEl.__textCotentBlock;\n\n    if (!contentBlock || hostEl.__dirty) {\n        contentBlock = hostEl.__textCotentBlock = parseRichText(text, style);\n    }\n\n    drawRichText(hostEl, ctx, contentBlock, style, rect);\n}\n\nfunction drawRichText(hostEl, ctx, contentBlock, style, rect) {\n    var contentWidth = contentBlock.width;\n    var outerWidth = contentBlock.outerWidth;\n    var outerHeight = contentBlock.outerHeight;\n    var textPadding = style.textPadding;\n\n    var boxPos = getBoxPosition(outerHeight, style, rect);\n    var baseX = boxPos.baseX;\n    var baseY = boxPos.baseY;\n    var textAlign = boxPos.textAlign;\n    var textVerticalAlign = boxPos.textVerticalAlign;\n\n    // Origin of textRotation should be the base point of text drawing.\n    applyTextRotation(ctx, style, rect, baseX, baseY);\n\n    var boxX = adjustTextX(baseX, outerWidth, textAlign);\n    var boxY = adjustTextY(baseY, outerHeight, textVerticalAlign);\n    var xLeft = boxX;\n    var lineTop = boxY;\n    if (textPadding) {\n        xLeft += textPadding[3];\n        lineTop += textPadding[0];\n    }\n    var xRight = xLeft + contentWidth;\n\n    needDrawBackground(style) && drawBackground(\n        hostEl, ctx, style, boxX, boxY, outerWidth, outerHeight\n    );\n\n    for (var i = 0; i < contentBlock.lines.length; i++) {\n        var line = contentBlock.lines[i];\n        var tokens = line.tokens;\n        var tokenCount = tokens.length;\n        var lineHeight = line.lineHeight;\n        var usedWidth = line.width;\n\n        var leftIndex = 0;\n        var lineXLeft = xLeft;\n        var lineXRight = xRight;\n        var rightIndex = tokenCount - 1;\n        var token;\n\n        while (\n            leftIndex < tokenCount\n            && (token = tokens[leftIndex], !token.textAlign || token.textAlign === 'left')\n        ) {\n            placeToken(hostEl, ctx, token, style, lineHeight, lineTop, lineXLeft, 'left');\n            usedWidth -= token.width;\n            lineXLeft += token.width;\n            leftIndex++;\n        }\n\n        while (\n            rightIndex >= 0\n            && (token = tokens[rightIndex], token.textAlign === 'right')\n        ) {\n            placeToken(hostEl, ctx, token, style, lineHeight, lineTop, lineXRight, 'right');\n            usedWidth -= token.width;\n            lineXRight -= token.width;\n            rightIndex--;\n        }\n\n        // The other tokens are placed as textAlign 'center' if there is enough space.\n        lineXLeft += (contentWidth - (lineXLeft - xLeft) - (xRight - lineXRight) - usedWidth) / 2;\n        while (leftIndex <= rightIndex) {\n            token = tokens[leftIndex];\n            // Consider width specified by user, use 'center' rather than 'left'.\n            placeToken(hostEl, ctx, token, style, lineHeight, lineTop, lineXLeft + token.width / 2, 'center');\n            lineXLeft += token.width;\n            leftIndex++;\n        }\n\n        lineTop += lineHeight;\n    }\n}\n\nfunction applyTextRotation(ctx, style, rect, x, y) {\n    // textRotation only apply in RectText.\n    if (rect && style.textRotation) {\n        var origin = style.textOrigin;\n        if (origin === 'center') {\n            x = rect.width / 2 + rect.x;\n            y = rect.height / 2 + rect.y;\n        }\n        else if (origin) {\n            x = origin[0] + rect.x;\n            y = origin[1] + rect.y;\n        }\n\n        ctx.translate(x, y);\n        // Positive: anticlockwise\n        ctx.rotate(-style.textRotation);\n        ctx.translate(-x, -y);\n    }\n}\n\nfunction placeToken(hostEl, ctx, token, style, lineHeight, lineTop, x, textAlign) {\n    var tokenStyle = style.rich[token.styleName] || {};\n\n    // 'ctx.textBaseline' is always set as 'middle', for sake of\n    // the bias of \"Microsoft YaHei\".\n    var textVerticalAlign = token.textVerticalAlign;\n    var y = lineTop + lineHeight / 2;\n    if (textVerticalAlign === 'top') {\n        y = lineTop + token.height / 2;\n    }\n    else if (textVerticalAlign === 'bottom') {\n        y = lineTop + lineHeight - token.height / 2;\n    }\n\n    !token.isLineHolder && needDrawBackground(tokenStyle) && drawBackground(\n        hostEl,\n        ctx,\n        tokenStyle,\n        textAlign === 'right'\n            ? x - token.width\n            : textAlign === 'center'\n            ? x - token.width / 2\n            : x,\n        y - token.height / 2,\n        token.width,\n        token.height\n    );\n\n    var textPadding = token.textPadding;\n    if (textPadding) {\n        x = getTextXForPadding(x, textAlign, textPadding);\n        y -= token.height / 2 - textPadding[2] - token.textHeight / 2;\n    }\n\n    setCtx(ctx, 'shadowBlur', retrieve3(tokenStyle.textShadowBlur, style.textShadowBlur, 0));\n    setCtx(ctx, 'shadowColor', tokenStyle.textShadowColor || style.textShadowColor || 'transparent');\n    setCtx(ctx, 'shadowOffsetX', retrieve3(tokenStyle.textShadowOffsetX, style.textShadowOffsetX, 0));\n    setCtx(ctx, 'shadowOffsetY', retrieve3(tokenStyle.textShadowOffsetY, style.textShadowOffsetY, 0));\n\n    setCtx(ctx, 'textAlign', textAlign);\n    // Force baseline to be \"middle\". Otherwise, if using \"top\", the\n    // text will offset downward a little bit in font \"Microsoft YaHei\".\n    setCtx(ctx, 'textBaseline', 'middle');\n\n    setCtx(ctx, 'font', token.font || DEFAULT_FONT);\n\n    var textStroke = getStroke(tokenStyle.textStroke || style.textStroke, textStrokeWidth);\n    var textFill = getFill(tokenStyle.textFill || style.textFill);\n    var textStrokeWidth = retrieve2(tokenStyle.textStrokeWidth, style.textStrokeWidth);\n\n    // Fill after stroke so the outline will not cover the main part.\n    if (textStroke) {\n        setCtx(ctx, 'lineWidth', textStrokeWidth);\n        setCtx(ctx, 'strokeStyle', textStroke);\n        ctx.strokeText(token.text, x, y);\n    }\n    if (textFill) {\n        setCtx(ctx, 'fillStyle', textFill);\n        ctx.fillText(token.text, x, y);\n    }\n}\n\nfunction needDrawBackground(style) {\n    return style.textBackgroundColor\n        || (style.textBorderWidth && style.textBorderColor);\n}\n\n// style: {textBackgroundColor, textBorderWidth, textBorderColor, textBorderRadius}\n// shape: {x, y, width, height}\nfunction drawBackground(hostEl, ctx, style, x, y, width, height) {\n    var textBackgroundColor = style.textBackgroundColor;\n    var textBorderWidth = style.textBorderWidth;\n    var textBorderColor = style.textBorderColor;\n    var isPlainBg = isString(textBackgroundColor);\n\n    setCtx(ctx, 'shadowBlur', style.textBoxShadowBlur || 0);\n    setCtx(ctx, 'shadowColor', style.textBoxShadowColor || 'transparent');\n    setCtx(ctx, 'shadowOffsetX', style.textBoxShadowOffsetX || 0);\n    setCtx(ctx, 'shadowOffsetY', style.textBoxShadowOffsetY || 0);\n\n    if (isPlainBg || (textBorderWidth && textBorderColor)) {\n        ctx.beginPath();\n        var textBorderRadius = style.textBorderRadius;\n        if (!textBorderRadius) {\n            ctx.rect(x, y, width, height);\n        }\n        else {\n            buildPath(ctx, {\n                x: x, y: y, width: width, height: height, r: textBorderRadius\n            });\n        }\n        ctx.closePath();\n    }\n\n    if (isPlainBg) {\n        setCtx(ctx, 'fillStyle', textBackgroundColor);\n        ctx.fill();\n    }\n    else if (isObject$1(textBackgroundColor)) {\n        var image = textBackgroundColor.image;\n\n        image = createOrUpdateImage(\n            image, null, hostEl, onBgImageLoaded, textBackgroundColor\n        );\n        if (image && isImageReady(image)) {\n            ctx.drawImage(image, x, y, width, height);\n        }\n    }\n\n    if (textBorderWidth && textBorderColor) {\n        setCtx(ctx, 'lineWidth', textBorderWidth);\n        setCtx(ctx, 'strokeStyle', textBorderColor);\n        ctx.stroke();\n    }\n}\n\nfunction onBgImageLoaded(image, textBackgroundColor) {\n    // Replace image, so that `contain/text.js#parseRichText`\n    // will get correct result in next tick.\n    textBackgroundColor.image = image;\n}\n\nfunction getBoxPosition(blockHeiht, style, rect) {\n    var baseX = style.x || 0;\n    var baseY = style.y || 0;\n    var textAlign = style.textAlign;\n    var textVerticalAlign = style.textVerticalAlign;\n\n    // Text position represented by coord\n    if (rect) {\n        var textPosition = style.textPosition;\n        if (textPosition instanceof Array) {\n            // Percent\n            baseX = rect.x + parsePercent(textPosition[0], rect.width);\n            baseY = rect.y + parsePercent(textPosition[1], rect.height);\n        }\n        else {\n            var res = adjustTextPositionOnRect(\n                textPosition, rect, style.textDistance\n            );\n            baseX = res.x;\n            baseY = res.y;\n            // Default align and baseline when has textPosition\n            textAlign = textAlign || res.textAlign;\n            textVerticalAlign = textVerticalAlign || res.textVerticalAlign;\n        }\n\n        // textOffset is only support in RectText, otherwise\n        // we have to adjust boundingRect for textOffset.\n        var textOffset = style.textOffset;\n        if (textOffset) {\n            baseX += textOffset[0];\n            baseY += textOffset[1];\n        }\n    }\n\n    return {\n        baseX: baseX,\n        baseY: baseY,\n        textAlign: textAlign,\n        textVerticalAlign: textVerticalAlign\n    };\n}\n\nfunction setCtx(ctx, prop, value) {\n    ctx[prop] = fixShadow(ctx, prop, value);\n    return ctx[prop];\n}\n\n/**\n * @param {string} [stroke] If specified, do not check style.textStroke.\n * @param {string} [lineWidth] If specified, do not check style.textStroke.\n * @param {number} style\n */\nfunction getStroke(stroke, lineWidth) {\n    return (stroke == null || lineWidth <= 0 || stroke === 'transparent' || stroke === 'none')\n        ? null\n        // TODO pattern and gradient?\n        : (stroke.image || stroke.colorStops)\n        ? '#000'\n        : stroke;\n}\n\nfunction getFill(fill) {\n    return (fill == null || fill === 'none')\n        ? null\n        // TODO pattern and gradient?\n        : (fill.image || fill.colorStops)\n        ? '#000'\n        : fill;\n}\n\nfunction parsePercent(value, maxValue) {\n    if (typeof value === 'string') {\n        if (value.lastIndexOf('%') >= 0) {\n            return parseFloat(value) / 100 * maxValue;\n        }\n        return parseFloat(value);\n    }\n    return value;\n}\n\nfunction getTextXForPadding(x, textAlign, textPadding) {\n    return textAlign === 'right'\n        ? (x - textPadding[1])\n        : textAlign === 'center'\n        ? (x + textPadding[3] / 2 - textPadding[1] / 2)\n        : (x + textPadding[3]);\n}\n\n/**\n * @param {string} text\n * @param {module:zrender/Style} style\n * @return {boolean}\n */\nfunction needDrawText(text, style) {\n    return text != null\n        && (text\n            || style.textBackgroundColor\n            || (style.textBorderWidth && style.textBorderColor)\n            || style.textPadding\n        );\n}\n\n/**\n * Mixin for drawing text in a element bounding rect\n * @module zrender/mixin/RectText\n */\n\nvar tmpRect$1 = new BoundingRect();\n\nvar RectText = function () {};\n\nRectText.prototype = {\n\n    constructor: RectText,\n\n    /**\n     * Draw text in a rect with specified position.\n     * @param  {CanvasRenderingContext2D} ctx\n     * @param  {Object} rect Displayable rect\n     */\n    drawRectText: function (ctx, rect) {\n        var style = this.style;\n\n        rect = style.textRect || rect;\n\n        // Optimize, avoid normalize every time.\n        this.__dirty && normalizeTextStyle(style, true);\n\n        var text = style.text;\n\n        // Convert to string\n        text != null && (text += '');\n\n        if (!needDrawText(text, style)) {\n            return;\n        }\n\n        // FIXME\n        ctx.save();\n\n        // Transform rect to view space\n        var transform = this.transform;\n        if (!style.transformText) {\n            if (transform) {\n                tmpRect$1.copy(rect);\n                tmpRect$1.applyTransform(transform);\n                rect = tmpRect$1;\n            }\n        }\n        else {\n            this.setTransform(ctx);\n        }\n\n        // transformText and textRotation can not be used at the same time.\n        renderText(this, ctx, text, style, rect);\n\n        ctx.restore();\n    }\n};\n\n/**\n * \n * Base class of all displayable graphic objects\n * @module zrender/graphic/Displayable\n */\n\n\n/**\n * @alias module:zrender/graphic/Displayable\n * @extends module:zrender/Element\n * @extends module:zrender/graphic/mixin/RectText\n */\nfunction Displayable(opts) {\n\n    opts = opts || {};\n\n    Element.call(this, opts);\n\n    // Extend properties\n    for (var name in opts) {\n        if (\n            opts.hasOwnProperty(name) &&\n            name !== 'style'\n        ) {\n            this[name] = opts[name];\n        }\n    }\n\n    /**\n     * @type {module:zrender/graphic/Style}\n     */\n    this.style = new Style(opts.style, this);\n\n    this._rect = null;\n    // Shapes for cascade clipping.\n    this.__clipPaths = [];\n\n    // FIXME Stateful must be mixined after style is setted\n    // Stateful.call(this, opts);\n}\n\nDisplayable.prototype = {\n\n    constructor: Displayable,\n\n    type: 'displayable',\n\n    /**\n     * Displayable Painter \n     * Dirty flag. From which painter will determine if this displayable object needs brush\n     * @name module:zrender/graphic/Displayable#__dirty\n     * @type {boolean}\n     */\n    __dirty: true,\n\n    /**\n     * true\n     * If ignore drawing of the displayable object. Mouse event will still be triggered\n     * @name module:/zrender/graphic/Displayable#invisible\n     * @type {boolean}\n     * @default false\n     */\n    invisible: false,\n\n    /**\n     * @name module:/zrender/graphic/Displayable#z\n     * @type {number}\n     * @default 0\n     */\n    z: 0,\n\n    /**\n     * @name module:/zrender/graphic/Displayable#z\n     * @type {number}\n     * @default 0\n     */\n    z2: 0,\n\n    /**\n     * zlevelcanvas\n     * @name module:/zrender/graphic/Displayable#zlevel\n     * @type {number}\n     * @default 0\n     */\n    zlevel: 0,\n\n    /**\n     * \n     * @name module:/zrender/graphic/Displayable#draggable\n     * @type {boolean}\n     * @default false\n     */\n    draggable: false,\n\n    /**\n     * \n     * @name module:/zrender/graphic/Displayable#draggable\n     * @type {boolean}\n     * @default false\n     */\n    dragging: false,\n\n    /**\n     * \n     * @name module:/zrender/graphic/Displayable#silent\n     * @type {boolean}\n     * @default false\n     */\n    silent: false,\n\n    /**\n     * If enable culling\n     * @type {boolean}\n     * @default false\n     */\n    culling: false,\n\n    /**\n     * Mouse cursor when hovered\n     * @name module:/zrender/graphic/Displayable#cursor\n     * @type {string}\n     */\n    cursor: 'pointer',\n\n    /**\n     * If hover area is bounding rect\n     * @name module:/zrender/graphic/Displayable#rectHover\n     * @type {string}\n     */\n    rectHover: false,\n\n    /**\n     * Render the element progressively when the value >= 0,\n     * usefull for large data.\n     * @type {boolean}\n     */\n    progressive: false,\n\n    /**\n     * @type {boolean}\n     */\n    incremental: false,\n    // inplace is used with incremental\n    inplace: false,\n\n    beforeBrush: function (ctx) {},\n\n    afterBrush: function (ctx) {},\n\n    /**\n     * \n     * @param {CanvasRenderingContext2D} ctx\n     */\n    // Interface\n    brush: function (ctx, prevEl) {},\n\n    /**\n     * \n     * @return {module:zrender/core/BoundingRect}\n     */\n    // Interface\n    getBoundingRect: function () {},\n\n    /**\n     *  x, y \n     * If displayable element contain coord x, y\n     * @param  {number} x\n     * @param  {number} y\n     * @return {boolean}\n     */\n    contain: function (x, y) {\n        return this.rectContain(x, y);\n    },\n\n    /**\n     * @param  {Function} cb\n     * @param  {}   context\n     */\n    traverse: function (cb, context) {\n        cb.call(context, this);\n    },\n\n    /**\n     *  x, y \n     * If bounding rect of element contain coord x, y\n     * @param  {number} x\n     * @param  {number} y\n     * @return {boolean}\n     */\n    rectContain: function (x, y) {\n        var coord = this.transformCoordToLocal(x, y);\n        var rect = this.getBoundingRect();\n        return rect.contain(coord[0], coord[1]);\n    },\n\n    /**\n     * \n     * Mark displayable element dirty and refresh next frame\n     */\n    dirty: function () {\n        this.__dirty = true;\n\n        this._rect = null;\n\n        this.__zr && this.__zr.refresh();\n    },\n\n    /**\n     * \n     * If displayable object binded any event\n     * @return {boolean}\n     */\n    // TODO,  bind \n    // isSilent: function () {\n    //     return !(\n    //         this.hoverable || this.draggable\n    //         || this.onmousemove || this.onmouseover || this.onmouseout\n    //         || this.onmousedown || this.onmouseup || this.onclick\n    //         || this.ondragenter || this.ondragover || this.ondragleave\n    //         || this.ondrop\n    //     );\n    // },\n    /**\n     * Alias for animate('style')\n     * @param {boolean} loop\n     */\n    animateStyle: function (loop) {\n        return this.animate('style', loop);\n    },\n\n    attrKV: function (key, value) {\n        if (key !== 'style') {\n            Element.prototype.attrKV.call(this, key, value);\n        }\n        else {\n            this.style.set(value);\n        }\n    },\n\n    /**\n     * @param {Object|string} key\n     * @param {*} value\n     */\n    setStyle: function (key, value) {\n        this.style.set(key, value);\n        this.dirty(false);\n        return this;\n    },\n\n    /**\n     * Use given style object\n     * @param  {Object} obj\n     */\n    useStyle: function (obj) {\n        this.style = new Style(obj, this);\n        this.dirty(false);\n        return this;\n    }\n};\n\ninherits(Displayable, Element);\n\nmixin(Displayable, RectText);\n\n/**\n * @alias zrender/graphic/Image\n * @extends module:zrender/graphic/Displayable\n * @constructor\n * @param {Object} opts\n */\nfunction ZImage(opts) {\n    Displayable.call(this, opts);\n}\n\nZImage.prototype = {\n\n    constructor: ZImage,\n\n    type: 'image',\n\n    brush: function (ctx, prevEl) {\n        var style = this.style;\n        var src = style.image;\n\n        // Must bind each time\n        style.bind(ctx, this, prevEl);\n\n        var image = this._image = createOrUpdateImage(\n            src,\n            this._image,\n            this,\n            this.onload\n        );\n\n        if (!image || !isImageReady(image)) {\n            return;\n        }\n\n        // \n        // if (image.nodeName.toUpperCase() == 'IMG') {\n        //     if (!image.complete) {\n        //         return;\n        //     }\n        // }\n        // Else is canvas\n\n        var x = style.x || 0;\n        var y = style.y || 0;\n        var width = style.width;\n        var height = style.height;\n        var aspect = image.width / image.height;\n        if (width == null && height != null) {\n            // Keep image/height ratio\n            width = height * aspect;\n        }\n        else if (height == null && width != null) {\n            height = width / aspect;\n        }\n        else if (width == null && height == null) {\n            width = image.width;\n            height = image.height;\n        }\n\n        // transform\n        this.setTransform(ctx);\n\n        if (style.sWidth && style.sHeight) {\n            var sx = style.sx || 0;\n            var sy = style.sy || 0;\n            ctx.drawImage(\n                image,\n                sx, sy, style.sWidth, style.sHeight,\n                x, y, width, height\n            );\n        }\n        else if (style.sx && style.sy) {\n            var sx = style.sx;\n            var sy = style.sy;\n            var sWidth = width - sx;\n            var sHeight = height - sy;\n            ctx.drawImage(\n                image,\n                sx, sy, sWidth, sHeight,\n                x, y, width, height\n            );\n        }\n        else {\n            ctx.drawImage(image, x, y, width, height);\n        }\n\n        // Draw rect text\n        if (style.text != null) {\n            // Only restore transform when needs draw text.\n            this.restoreTransform(ctx);    \n            this.drawRectText(ctx, this.getBoundingRect());\n        }\n    },\n\n    getBoundingRect: function () {\n        var style = this.style;\n        if (! this._rect) {\n            this._rect = new BoundingRect(\n                style.x || 0, style.y || 0, style.width || 0, style.height || 0\n            );\n        }\n        return this._rect;\n    }\n};\n\ninherits(ZImage, Displayable);\n\nvar HOVER_LAYER_ZLEVEL = 1e5;\nvar CANVAS_ZLEVEL = 314159;\n\nvar EL_AFTER_INCREMENTAL_INC = 0.01;\nvar INCREMENTAL_INC = 0.001;\n\nfunction parseInt10(val) {\n    return parseInt(val, 10);\n}\n\nfunction isLayerValid(layer) {\n    if (!layer) {\n        return false;\n    }\n\n    if (layer.__builtin__) {\n        return true;\n    }\n\n    if (typeof(layer.resize) !== 'function'\n        || typeof(layer.refresh) !== 'function'\n    ) {\n        return false;\n    }\n\n    return true;\n}\n\nvar tmpRect = new BoundingRect(0, 0, 0, 0);\nvar viewRect = new BoundingRect(0, 0, 0, 0);\nfunction isDisplayableCulled(el, width, height) {\n    tmpRect.copy(el.getBoundingRect());\n    if (el.transform) {\n        tmpRect.applyTransform(el.transform);\n    }\n    viewRect.width = width;\n    viewRect.height = height;\n    return !tmpRect.intersect(viewRect);\n}\n\nfunction isClipPathChanged(clipPaths, prevClipPaths) {\n    if (clipPaths == prevClipPaths) { // Can both be null or undefined\n        return false;\n    }\n\n    if (!clipPaths || !prevClipPaths || (clipPaths.length !== prevClipPaths.length)) {\n        return true;\n    }\n    for (var i = 0; i < clipPaths.length; i++) {\n        if (clipPaths[i] !== prevClipPaths[i]) {\n            return true;\n        }\n    }\n}\n\nfunction doClip(clipPaths, ctx) {\n    for (var i = 0; i < clipPaths.length; i++) {\n        var clipPath = clipPaths[i];\n\n        clipPath.setTransform(ctx);\n        ctx.beginPath();\n        clipPath.buildPath(ctx, clipPath.shape);\n        ctx.clip();\n        // Transform back\n        clipPath.restoreTransform(ctx);\n    }\n}\n\nfunction createRoot(width, height) {\n    var domRoot = document.createElement('div');\n\n    // domRoot.onselectstart = returnFalse; // \n    domRoot.style.cssText = [\n        'position:relative',\n        'overflow:hidden',\n        'width:' + width + 'px',\n        'height:' + height + 'px',\n        'padding:0',\n        'margin:0',\n        'border-width:0'\n    ].join(';') + ';';\n\n    return domRoot;\n}\n\n\n/**\n * @alias module:zrender/Painter\n * @constructor\n * @param {HTMLElement} root \n * @param {module:zrender/Storage} storage\n * @param {Object} opts\n */\nvar Painter = function (root, storage, opts) {\n\n    this.type = 'canvas';\n\n    // In node environment using node-canvas\n    var singleCanvas = !root.nodeName // In node ?\n        || root.nodeName.toUpperCase() === 'CANVAS';\n\n    this._opts = opts = extend({}, opts || {});\n\n    /**\n     * @type {number}\n     */\n    this.dpr = opts.devicePixelRatio || devicePixelRatio;\n    /**\n     * @type {boolean}\n     * @private\n     */\n    this._singleCanvas = singleCanvas;\n    /**\n     * \n     * @type {HTMLElement}\n     */\n    this.root = root;\n\n    var rootStyle = root.style;\n\n    if (rootStyle) {\n        rootStyle['-webkit-tap-highlight-color'] = 'transparent';\n        rootStyle['-webkit-user-select'] =\n        rootStyle['user-select'] =\n        rootStyle['-webkit-touch-callout'] = 'none';\n\n        root.innerHTML = '';\n    }\n\n    /**\n     * @type {module:zrender/Storage}\n     */\n    this.storage = storage;\n\n    /**\n     * @type {Array.<number>}\n     * @private\n     */\n    var zlevelList = this._zlevelList = [];\n\n    /**\n     * @type {Object.<string, module:zrender/Layer>}\n     * @private\n     */\n    var layers = this._layers = {};\n\n    /**\n     * @type {Object.<string, Object>}\n     * @private\n     */\n    this._layerConfig = {};\n\n    /**\n     * zrender will do compositing when root is a canvas and have multiple zlevels.\n     */\n    this._needsManuallyCompositing = false;\n\n    if (!singleCanvas) {\n        this._width = this._getSize(0);\n        this._height = this._getSize(1);\n\n        var domRoot = this._domRoot = createRoot(\n            this._width, this._height\n        );\n        root.appendChild(domRoot);\n    }\n    else {\n        var width = root.width;\n        var height = root.height;\n\n        if (opts.width != null) {\n            width = opts.width;\n        }\n        if (opts.height != null) {\n            height = opts.height;\n        }\n        this.dpr = opts.devicePixelRatio || 1;\n\n        // Use canvas width and height directly\n        root.width = width * this.dpr;\n        root.height = height * this.dpr;\n\n        this._width = width;\n        this._height = height;\n\n        // Create layer if only one given canvas\n        // Device can be specified to create a high dpi image.\n        var mainLayer = new Layer(root, this, this.dpr);\n        mainLayer.__builtin__ = true;\n        mainLayer.initContext();\n        // FIXME Use canvas width and height\n        // mainLayer.resize(width, height);\n        layers[CANVAS_ZLEVEL] = mainLayer;\n        // Not use common zlevel.\n        zlevelList.push(CANVAS_ZLEVEL);\n\n        this._domRoot = root;\n    }\n\n    /**\n     * @type {module:zrender/Layer}\n     * @private\n     */\n    this._hoverlayer = null;\n\n    this._hoverElements = [];\n};\n\nPainter.prototype = {\n\n    constructor: Painter,\n\n    getType: function () {\n        return 'canvas';\n    },\n\n    /**\n     * If painter use a single canvas\n     * @return {boolean}\n     */\n    isSingleCanvas: function () {\n        return this._singleCanvas;\n    },\n    /**\n     * @return {HTMLDivElement}\n     */\n    getViewportRoot: function () {\n        return this._domRoot;\n    },\n\n    getViewportRootOffset: function () {\n        var viewportRoot = this.getViewportRoot();\n        if (viewportRoot) {\n            return {\n                offsetLeft: viewportRoot.offsetLeft || 0,\n                offsetTop: viewportRoot.offsetTop || 0\n            };\n        }\n    },\n\n    /**\n     * \n     * @param {boolean} [paintAll=false] displayable\n     */\n    refresh: function (paintAll) {\n\n        var list = this.storage.getDisplayList(true);\n\n        var zlevelList = this._zlevelList;\n\n        this._redrawId = Math.random();\n\n        this._paintList(list, paintAll, this._redrawId);\n\n        // Paint custum layers\n        for (var i = 0; i < zlevelList.length; i++) {\n            var z = zlevelList[i];\n            var layer = this._layers[z];\n            if (!layer.__builtin__ && layer.refresh) {\n                var clearColor = i === 0 ? this._backgroundColor : null;\n                layer.refresh(clearColor);\n            }\n        }\n\n        this.refreshHover();\n\n        return this;\n    },\n\n    addHover: function (el, hoverStyle) {\n        if (el.__hoverMir) {\n            return;\n        }\n        var elMirror = new el.constructor({\n            style: el.style,\n            shape: el.shape\n        });\n        elMirror.__from = el;\n        el.__hoverMir = elMirror;\n        elMirror.setStyle(hoverStyle);\n        this._hoverElements.push(elMirror);\n    },\n\n    removeHover: function (el) {\n        var elMirror = el.__hoverMir;\n        var hoverElements = this._hoverElements;\n        var idx = indexOf(hoverElements, elMirror);\n        if (idx >= 0) {\n            hoverElements.splice(idx, 1);\n        }\n        el.__hoverMir = null;\n    },\n\n    clearHover: function (el) {\n        var hoverElements = this._hoverElements;\n        for (var i = 0; i < hoverElements.length; i++) {\n            var from = hoverElements[i].__from;\n            if (from) {\n                from.__hoverMir = null;\n            }\n        }\n        hoverElements.length = 0;\n    },\n\n    refreshHover: function () {\n        var hoverElements = this._hoverElements;\n        var len = hoverElements.length;\n        var hoverLayer = this._hoverlayer;\n        hoverLayer && hoverLayer.clear();\n\n        if (!len) {\n            return;\n        }\n        sort(hoverElements, this.storage.displayableSortFunc);\n\n        // Use a extream large zlevel\n        // FIXME?\n        if (!hoverLayer) {\n            hoverLayer = this._hoverlayer = this.getLayer(HOVER_LAYER_ZLEVEL);\n        }\n\n        var scope = {};\n        hoverLayer.ctx.save();\n        for (var i = 0; i < len;) {\n            var el = hoverElements[i];\n            var originalEl = el.__from;\n            // Original el is removed\n            // PENDING\n            if (!(originalEl && originalEl.__zr)) {\n                hoverElements.splice(i, 1);\n                originalEl.__hoverMir = null;\n                len--;\n                continue;\n            }\n            i++;\n\n            // Use transform\n            // FIXME style and shape ?\n            if (!originalEl.invisible) {\n                el.transform = originalEl.transform;\n                el.invTransform = originalEl.invTransform;\n                el.__clipPaths = originalEl.__clipPaths;\n                // el.\n                this._doPaintEl(el, hoverLayer, true, scope);\n            }\n        }\n        hoverLayer.ctx.restore();\n    },\n\n    getHoverLayer: function () {\n        return this.getLayer(HOVER_LAYER_ZLEVEL);\n    },\n\n    _paintList: function (list, paintAll, redrawId) {\n        if (this._redrawId !== redrawId) {\n            return;\n        }\n\n        paintAll = paintAll || false;\n\n        this._updateLayerStatus(list);\n\n        var finished = this._doPaintList(list, paintAll);\n\n        if (this._needsManuallyCompositing) {\n            this._compositeManually();\n        }\n\n        if (!finished) {\n            var self = this;\n            requestAnimationFrame(function () {\n                self._paintList(list, paintAll, redrawId);\n            });\n        }\n    },\n\n    _compositeManually: function () {\n        var ctx = this.getLayer(CANVAS_ZLEVEL).ctx;\n        var width = this._domRoot.width;\n        var height = this._domRoot.height;\n        ctx.clearRect(0, 0, width, height);\n        // PENDING, If only builtin layer?\n        this.eachBuiltinLayer(function (layer) {\n            if (layer.virtual) {\n                ctx.drawImage(layer.dom, 0, 0, width, height);\n            }\n        });\n    },\n\n    _doPaintList: function (list, paintAll) {\n        var layerList = [];\n        for (var zi = 0; zi < this._zlevelList.length; zi++) {\n            var zlevel = this._zlevelList[zi];\n            var layer = this._layers[zlevel];\n            if (layer.__builtin__\n                && layer !== this._hoverlayer\n                && (layer.__dirty || paintAll)\n            ) {\n                layerList.push(layer);\n            }\n        }\n\n        var finished = true;\n\n        for (var k = 0; k < layerList.length; k++) {\n            var layer = layerList[k];\n            var ctx = layer.ctx;\n            var scope = {};\n            ctx.save();\n\n            var start = paintAll ? layer.__startIndex : layer.__drawIndex;\n\n            var useTimer = !paintAll && layer.incremental && Date.now;\n            var startTime = useTimer && Date.now();\n\n            var clearColor = layer.zlevel === this._zlevelList[0]\n                ? this._backgroundColor : null;\n            // All elements in this layer are cleared.\n            if (layer.__startIndex === layer.__endIndex) {\n                layer.clear(false, clearColor);\n            }\n            else if (start === layer.__startIndex) {\n                var firstEl = list[start];\n                if (!firstEl.incremental || !firstEl.notClear || paintAll) {\n                    layer.clear(false, clearColor);\n                }\n            }\n            if (start === -1) {\n                console.error('For some unknown reason. drawIndex is -1');\n                start = layer.__startIndex;\n            }\n            for (var i = start; i < layer.__endIndex; i++) {\n                var el = list[i];\n                this._doPaintEl(el, layer, paintAll, scope);\n                el.__dirty = false;\n\n                if (useTimer) {\n                    // Date.now can be executed in 13,025,305 ops/second.\n                    var dTime = Date.now() - startTime;\n                    // Give 15 millisecond to draw.\n                    // The rest elements will be drawn in the next frame.\n                    if (dTime > 15) {\n                        break;\n                    }\n                }\n            }\n\n            layer.__drawIndex = i;\n\n            if (layer.__drawIndex < layer.__endIndex) {\n                finished = false;\n            }\n\n            if (scope.prevElClipPaths) {\n                // Needs restore the state. If last drawn element is in the clipping area.\n                ctx.restore();\n            }\n\n            ctx.restore();\n        }\n\n        if (env$1.wxa) {\n            // Flush for weixin application\n            each$1(this._layers, function (layer) {\n                if (layer && layer.ctx && layer.ctx.draw) {\n                    layer.ctx.draw();\n                }\n            });\n        }\n\n        return finished;\n    },\n\n    _doPaintEl: function (el, currentLayer, forcePaint, scope) {\n        var ctx = currentLayer.ctx;\n        var m = el.transform;\n        if (\n            (currentLayer.__dirty || forcePaint)\n            // Ignore invisible element\n            && !el.invisible\n            // Ignore transparent element\n            && el.style.opacity !== 0\n            // Ignore scale 0 element, in some environment like node-canvas\n            // Draw a scale 0 element can cause all following draw wrong\n            // And setTransform with scale 0 will cause set back transform failed.\n            && !(m && !m[0] && !m[3])\n            // Ignore culled element\n            && !(el.culling && isDisplayableCulled(el, this._width, this._height))\n        ) {\n\n            var clipPaths = el.__clipPaths;\n\n            // Optimize when clipping on group with several elements\n            if (!scope.prevElClipPaths\n                || isClipPathChanged(clipPaths, scope.prevElClipPaths)\n            ) {\n                // If has previous clipping state, restore from it\n                if (scope.prevElClipPaths) {\n                    currentLayer.ctx.restore();\n                    scope.prevElClipPaths = null;\n\n                    // Reset prevEl since context has been restored\n                    scope.prevEl = null;\n                }\n                // New clipping state\n                if (clipPaths) {\n                    ctx.save();\n                    doClip(clipPaths, ctx);\n                    scope.prevElClipPaths = clipPaths;\n                }\n            }\n            el.beforeBrush && el.beforeBrush(ctx);\n\n            el.brush(ctx, scope.prevEl || null);\n            scope.prevEl = el;\n\n            el.afterBrush && el.afterBrush(ctx);\n        }\n    },\n\n    /**\n     *  zlevel \n     * @param {number} zlevel\n     * @param {boolean} virtual Virtual layer will not be inserted into dom.\n     * @return {module:zrender/Layer}\n     */\n    getLayer: function (zlevel, virtual) {\n        if (this._singleCanvas && !this._needsManuallyCompositing) {\n            zlevel = CANVAS_ZLEVEL;\n        }\n        var layer = this._layers[zlevel];\n        if (!layer) {\n            // Create a new layer\n            layer = new Layer('zr_' + zlevel, this, this.dpr);\n            layer.zlevel = zlevel;\n            layer.__builtin__ = true;\n\n            if (this._layerConfig[zlevel]) {\n                merge(layer, this._layerConfig[zlevel], true);\n            }\n\n            if (virtual) {\n                layer.virtual = virtual;\n            }\n\n            this.insertLayer(zlevel, layer);\n\n            // Context is created after dom inserted to document\n            // Or excanvas will get 0px clientWidth and clientHeight\n            layer.initContext();\n        }\n\n        return layer;\n    },\n\n    insertLayer: function (zlevel, layer) {\n\n        var layersMap = this._layers;\n        var zlevelList = this._zlevelList;\n        var len = zlevelList.length;\n        var prevLayer = null;\n        var i = -1;\n        var domRoot = this._domRoot;\n\n        if (layersMap[zlevel]) {\n            zrLog('ZLevel ' + zlevel + ' has been used already');\n            return;\n        }\n        // Check if is a valid layer\n        if (!isLayerValid(layer)) {\n            zrLog('Layer of zlevel ' + zlevel + ' is not valid');\n            return;\n        }\n\n        if (len > 0 && zlevel > zlevelList[0]) {\n            for (i = 0; i < len - 1; i++) {\n                if (\n                    zlevelList[i] < zlevel\n                    && zlevelList[i + 1] > zlevel\n                ) {\n                    break;\n                }\n            }\n            prevLayer = layersMap[zlevelList[i]];\n        }\n        zlevelList.splice(i + 1, 0, zlevel);\n\n        layersMap[zlevel] = layer;\n\n        // Vitual layer will not directly show on the screen.\n        // (It can be a WebGL layer and assigned to a ZImage element)\n        // But it still under management of zrender.\n        if (!layer.virtual) {\n            if (prevLayer) {\n                var prevDom = prevLayer.dom;\n                if (prevDom.nextSibling) {\n                    domRoot.insertBefore(\n                        layer.dom,\n                        prevDom.nextSibling\n                    );\n                }\n                else {\n                    domRoot.appendChild(layer.dom);\n                }\n            }\n            else {\n                if (domRoot.firstChild) {\n                    domRoot.insertBefore(layer.dom, domRoot.firstChild);\n                }\n                else {\n                    domRoot.appendChild(layer.dom);\n                }\n            }\n        }\n    },\n\n    // Iterate each layer\n    eachLayer: function (cb, context) {\n        var zlevelList = this._zlevelList;\n        var z;\n        var i;\n        for (i = 0; i < zlevelList.length; i++) {\n            z = zlevelList[i];\n            cb.call(context, this._layers[z], z);\n        }\n    },\n\n    // Iterate each buildin layer\n    eachBuiltinLayer: function (cb, context) {\n        var zlevelList = this._zlevelList;\n        var layer;\n        var z;\n        var i;\n        for (i = 0; i < zlevelList.length; i++) {\n            z = zlevelList[i];\n            layer = this._layers[z];\n            if (layer.__builtin__) {\n                cb.call(context, layer, z);\n            }\n        }\n    },\n\n    // Iterate each other layer except buildin layer\n    eachOtherLayer: function (cb, context) {\n        var zlevelList = this._zlevelList;\n        var layer;\n        var z;\n        var i;\n        for (i = 0; i < zlevelList.length; i++) {\n            z = zlevelList[i];\n            layer = this._layers[z];\n            if (!layer.__builtin__) {\n                cb.call(context, layer, z);\n            }\n        }\n    },\n\n    /**\n     * \n     * @param {Array.<module:zrender/Layer>} [prevLayer]\n     */\n    getLayers: function () {\n        return this._layers;\n    },\n\n    _updateLayerStatus: function (list) {\n\n        this.eachBuiltinLayer(function (layer, z) {\n            layer.__dirty = layer.__used = false;\n        });\n\n        function updatePrevLayer(idx) {\n            if (prevLayer) {\n                if (prevLayer.__endIndex !== idx) {\n                    prevLayer.__dirty = true;\n                }\n                prevLayer.__endIndex = idx;\n            }\n        }\n\n        if (this._singleCanvas) {\n            for (var i = 1; i < list.length; i++) {\n                var el = list[i];\n                if (el.zlevel !== list[i - 1].zlevel || el.incremental) {\n                    this._needsManuallyCompositing = true;\n                    break;\n                }\n            }\n        }\n\n        var prevLayer = null;\n        var incrementalLayerCount = 0;\n        for (var i = 0; i < list.length; i++) {\n            var el = list[i];\n            var zlevel = el.zlevel;\n            var layer;\n            // PENDING If change one incremental element style ?\n            // TODO Where there are non-incremental elements between incremental elements.\n            if (el.incremental) {\n                layer = this.getLayer(zlevel + INCREMENTAL_INC, this._needsManuallyCompositing);\n                layer.incremental = true;\n                incrementalLayerCount = 1;\n            }\n            else {\n                layer = this.getLayer(zlevel + (incrementalLayerCount > 0 ? EL_AFTER_INCREMENTAL_INC : 0), this._needsManuallyCompositing);\n            }\n\n            if (!layer.__builtin__) {\n                zrLog('ZLevel ' + zlevel + ' has been used by unkown layer ' + layer.id);\n            }\n\n            if (layer !== prevLayer) {\n                layer.__used = true;\n                if (layer.__startIndex !== i) {\n                    layer.__dirty = true;\n                }\n                layer.__startIndex = i;\n                if (!layer.incremental) {\n                    layer.__drawIndex = i;\n                }\n                else {\n                    // Mark layer draw index needs to update.\n                    layer.__drawIndex = -1;\n                }\n                updatePrevLayer(i);\n                prevLayer = layer;\n            }\n            if (el.__dirty) {\n                layer.__dirty = true;\n                if (layer.incremental && layer.__drawIndex < 0) {\n                    // Start draw from the first dirty element.\n                    layer.__drawIndex = i;\n                }\n            }\n        }\n\n        updatePrevLayer(i);\n\n        this.eachBuiltinLayer(function (layer, z) {\n            // Used in last frame but not in this frame. Needs clear\n            if (!layer.__used && layer.getElementCount() > 0) {\n                layer.__dirty = true;\n                layer.__startIndex = layer.__endIndex = layer.__drawIndex = 0;\n            }\n            // For incremental layer. In case start index changed and no elements are dirty.\n            if (layer.__dirty && layer.__drawIndex < 0) {\n                layer.__drawIndex = layer.__startIndex;\n            }\n        });\n    },\n\n    /**\n     * hover\n     */\n    clear: function () {\n        this.eachBuiltinLayer(this._clearLayer);\n        return this;\n    },\n\n    _clearLayer: function (layer) {\n        layer.clear();\n    },\n\n    setBackgroundColor: function (backgroundColor) {\n        this._backgroundColor = backgroundColor;\n    },\n\n    /**\n     * zlevel\n     *\n     * @param {string} zlevel\n     * @param {Object} config \n     * @param {string} [config.clearColor=0] \n     * @param {string} [config.motionBlur=false] \n     * @param {number} [config.lastFrameAlpha=0.7]\n     *                 alpha\n     */\n    configLayer: function (zlevel, config) {\n        if (config) {\n            var layerConfig = this._layerConfig;\n            if (!layerConfig[zlevel]) {\n                layerConfig[zlevel] = config;\n            }\n            else {\n                merge(layerConfig[zlevel], config, true);\n            }\n\n            for (var i = 0; i < this._zlevelList.length; i++) {\n                var _zlevel = this._zlevelList[i];\n                if (_zlevel === zlevel || _zlevel === zlevel + EL_AFTER_INCREMENTAL_INC) {\n                    var layer = this._layers[_zlevel];\n                    merge(layer, layerConfig[zlevel], true);\n                }\n            }\n        }\n    },\n\n    /**\n     * \n     * @param {number} zlevel zlevel\n     */\n    delLayer: function (zlevel) {\n        var layers = this._layers;\n        var zlevelList = this._zlevelList;\n        var layer = layers[zlevel];\n        if (!layer) {\n            return;\n        }\n        layer.dom.parentNode.removeChild(layer.dom);\n        delete layers[zlevel];\n\n        zlevelList.splice(indexOf(zlevelList, zlevel), 1);\n    },\n\n    /**\n     * \n     */\n    resize: function (width, height) {\n        if (!this._domRoot.style) { // Maybe in node or worker\n            if (width == null || height == null) {\n                return;\n            }\n            this._width = width;\n            this._height = height;\n\n            this.getLayer(CANVAS_ZLEVEL).resize(width, height);\n        }\n        else {\n            var domRoot = this._domRoot;\n            // FIXME Why ?\n            domRoot.style.display = 'none';\n\n            // Save input w/h\n            var opts = this._opts;\n            width != null && (opts.width = width);\n            height != null && (opts.height = height);\n\n            width = this._getSize(0);\n            height = this._getSize(1);\n\n            domRoot.style.display = '';\n\n            // resize\n            if (this._width != width || height != this._height) {\n                domRoot.style.width = width + 'px';\n                domRoot.style.height = height + 'px';\n\n                for (var id in this._layers) {\n                    if (this._layers.hasOwnProperty(id)) {\n                        this._layers[id].resize(width, height);\n                    }\n                }\n                each$1(this._progressiveLayers, function (layer) {\n                    layer.resize(width, height);\n                });\n\n                this.refresh(true);\n            }\n\n            this._width = width;\n            this._height = height;\n\n        }\n        return this;\n    },\n\n    /**\n     * \n     * @param {number} zlevel\n     */\n    clearLayer: function (zlevel) {\n        var layer = this._layers[zlevel];\n        if (layer) {\n            layer.clear();\n        }\n    },\n\n    /**\n     * \n     */\n    dispose: function () {\n        this.root.innerHTML = '';\n\n        this.root =\n        this.storage =\n\n        this._domRoot =\n        this._layers = null;\n    },\n\n    /**\n     * Get canvas which has all thing rendered\n     * @param {Object} opts\n     * @param {string} [opts.backgroundColor]\n     * @param {number} [opts.pixelRatio]\n     */\n    getRenderedCanvas: function (opts) {\n        opts = opts || {};\n        if (this._singleCanvas && !this._compositeManually) {\n            return this._layers[CANVAS_ZLEVEL].dom;\n        }\n\n        var imageLayer = new Layer('image', this, opts.pixelRatio || this.dpr);\n        imageLayer.initContext();\n        imageLayer.clear(false, opts.backgroundColor || this._backgroundColor);\n\n        if (opts.pixelRatio <= this.dpr) {\n            this.refresh();\n\n            var width = imageLayer.dom.width;\n            var height = imageLayer.dom.height;\n            var ctx = imageLayer.ctx;\n            this.eachLayer(function (layer) {\n                if (layer.__builtin__) {\n                    ctx.drawImage(layer.dom, 0, 0, width, height);\n                }\n                else if (layer.renderToCanvas) {\n                    imageLayer.ctx.save();\n                    layer.renderToCanvas(imageLayer.ctx);\n                    imageLayer.ctx.restore();\n                }\n            });\n        }\n        else {\n            // PENDING, echarts-gl and incremental rendering.\n            var scope = {};\n            var displayList = this.storage.getDisplayList(true);\n            for (var i = 0; i < displayList.length; i++) {\n                var el = displayList[i];\n                this._doPaintEl(el, imageLayer, true, scope);\n            }\n        }\n\n        return imageLayer.dom;\n    },\n    /**\n     * \n     */\n    getWidth: function () {\n        return this._width;\n    },\n\n    /**\n     * \n     */\n    getHeight: function () {\n        return this._height;\n    },\n\n    _getSize: function (whIdx) {\n        var opts = this._opts;\n        var wh = ['width', 'height'][whIdx];\n        var cwh = ['clientWidth', 'clientHeight'][whIdx];\n        var plt = ['paddingLeft', 'paddingTop'][whIdx];\n        var prb = ['paddingRight', 'paddingBottom'][whIdx];\n\n        if (opts[wh] != null && opts[wh] !== 'auto') {\n            return parseFloat(opts[wh]);\n        }\n\n        var root = this.root;\n        // IE8 does not support getComputedStyle, but it use VML.\n        var stl = document.defaultView.getComputedStyle(root);\n\n        return (\n            (root[cwh] || parseInt10(stl[wh]) || parseInt10(root.style[wh]))\n            - (parseInt10(stl[plt]) || 0)\n            - (parseInt10(stl[prb]) || 0)\n        ) | 0;\n    },\n\n    pathToImage: function (path, dpr) {\n        dpr = dpr || this.dpr;\n\n        var canvas = document.createElement('canvas');\n        var ctx = canvas.getContext('2d');\n        var rect = path.getBoundingRect();\n        var style = path.style;\n        var shadowBlurSize = style.shadowBlur * dpr;\n        var shadowOffsetX = style.shadowOffsetX * dpr;\n        var shadowOffsetY = style.shadowOffsetY * dpr;\n        var lineWidth = style.hasStroke() ? style.lineWidth : 0;\n\n        var leftMargin = Math.max(lineWidth / 2, -shadowOffsetX + shadowBlurSize);\n        var rightMargin = Math.max(lineWidth / 2, shadowOffsetX + shadowBlurSize);\n        var topMargin = Math.max(lineWidth / 2, -shadowOffsetY + shadowBlurSize);\n        var bottomMargin = Math.max(lineWidth / 2, shadowOffsetY + shadowBlurSize);\n        var width = rect.width + leftMargin + rightMargin;\n        var height = rect.height + topMargin + bottomMargin;\n\n        canvas.width = width * dpr;\n        canvas.height = height * dpr;\n\n        ctx.scale(dpr, dpr);\n        ctx.clearRect(0, 0, width, height);\n        ctx.dpr = dpr;\n\n        var pathTransform = {\n            position: path.position,\n            rotation: path.rotation,\n            scale: path.scale\n        };\n        path.position = [leftMargin - rect.x, topMargin - rect.y];\n        path.rotation = 0;\n        path.scale = [1, 1];\n        path.updateTransform();\n        if (path) {\n            path.brush(ctx);\n        }\n\n        var ImageShape = ZImage;\n        var imgShape = new ImageShape({\n            style: {\n                x: 0,\n                y: 0,\n                image: canvas\n            }\n        });\n\n        if (pathTransform.position != null) {\n            imgShape.position = path.position = pathTransform.position;\n        }\n\n        if (pathTransform.rotation != null) {\n            imgShape.rotation = path.rotation = pathTransform.rotation;\n        }\n\n        if (pathTransform.scale != null) {\n            imgShape.scale = path.scale = pathTransform.scale;\n        }\n\n        return imgShape;\n    }\n};\n\n/**\n * \n * @module zrender/core/event\n * @author Kener (@Kener-, kener.linfeng@gmail.com)\n */\n\nvar isDomLevel2 = (typeof window !== 'undefined') && !!window.addEventListener;\n\nvar MOUSE_EVENT_REG = /^(?:mouse|pointer|contextmenu|drag|drop)|click/;\n\nfunction getBoundingClientRect(el) {\n    // BlackBerry 5, iOS 3 (original iPhone) don't have getBoundingRect\n    return el.getBoundingClientRect ? el.getBoundingClientRect() : {left: 0, top: 0};\n}\n\n// `calculate` is optional, default false\nfunction clientToLocal(el, e, out, calculate) {\n    out = out || {};\n\n    // According to the W3C Working Draft, offsetX and offsetY should be relative\n    // to the padding edge of the target element. The only browser using this convention\n    // is IE. Webkit uses the border edge, Opera uses the content edge, and FireFox does\n    // not support the properties.\n    // (see http://www.jacklmoore.com/notes/mouse-position/)\n    // In zr painter.dom, padding edge equals to border edge.\n\n    // FIXME\n    // When mousemove event triggered on ec tooltip, target is not zr painter.dom, and\n    // offsetX/Y is relative to e.target, where the calculation of zrX/Y via offsetX/Y\n    // is too complex. So css-transfrom dont support in this case temporarily.\n    if (calculate || !env$1.canvasSupported) {\n        defaultGetZrXY(el, e, out);\n    }\n    // Caution: In FireFox, layerX/layerY Mouse position relative to the closest positioned\n    // ancestor element, so we should make sure el is positioned (e.g., not position:static).\n    // BTW1, Webkit don't return the same results as FF in non-simple cases (like add\n    // zoom-factor, overflow / opacity layers, transforms ...)\n    // BTW2, (ev.offsetY || ev.pageY - $(ev.target).offset().top) is not correct in preserve-3d.\n    // <https://bugs.jquery.com/ticket/8523#comment:14>\n    // BTW3, In ff, offsetX/offsetY is always 0.\n    else if (env$1.browser.firefox && e.layerX != null && e.layerX !== e.offsetX) {\n        out.zrX = e.layerX;\n        out.zrY = e.layerY;\n    }\n    // For IE6+, chrome, safari, opera. (When will ff support offsetX?)\n    else if (e.offsetX != null) {\n        out.zrX = e.offsetX;\n        out.zrY = e.offsetY;\n    }\n    // For some other device, e.g., IOS safari.\n    else {\n        defaultGetZrXY(el, e, out);\n    }\n\n    return out;\n}\n\nfunction defaultGetZrXY(el, e, out) {\n    // This well-known method below does not support css transform.\n    var box = getBoundingClientRect(el);\n    out.zrX = e.clientX - box.left;\n    out.zrY = e.clientY - box.top;\n}\n\n/**\n * domtouch.\n * `calculate` is optional, default false.\n */\nfunction normalizeEvent(el, e, calculate) {\n\n    e = e || window.event;\n\n    if (e.zrX != null) {\n        return e;\n    }\n\n    var eventType = e.type;\n    var isTouch = eventType && eventType.indexOf('touch') >= 0;\n\n    if (!isTouch) {\n        clientToLocal(el, e, e, calculate);\n        e.zrDelta = (e.wheelDelta) ? e.wheelDelta / 120 : -(e.detail || 0) / 3;\n    }\n    else {\n        var touch = eventType != 'touchend'\n            ? e.targetTouches[0]\n            : e.changedTouches[0];\n        touch && clientToLocal(el, touch, e, calculate);\n    }\n\n    // Add which for click: 1 === left; 2 === middle; 3 === right; otherwise: 0;\n    // See jQuery: https://github.com/jquery/jquery/blob/master/src/event.js\n    // If e.which has been defined, if may be readonly,\n    // see: https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent/which\n    var button = e.button;\n    if (e.which == null && button !== undefined && MOUSE_EVENT_REG.test(e.type)) {\n        e.which = (button & 1 ? 1 : (button & 2 ? 3 : (button & 4 ? 2 : 0)));\n    }\n\n    return e;\n}\n\n/**\n * @param {HTMLElement} el\n * @param {string} name\n * @param {Function} handler\n */\nfunction addEventListener(el, name, handler) {\n    if (isDomLevel2) {\n        // Reproduct the console warning:\n        // [Violation] Added non-passive event listener to a scroll-blocking <some> event.\n        // Consider marking event handler as 'passive' to make the page more responsive.\n        // Just set console log level: verbose in chrome dev tool.\n        // then the warning log will be printed when addEventListener called.\n        // See https://github.com/WICG/EventListenerOptions/blob/gh-pages/explainer.md\n        // We have not yet found a neat way to using passive. Because in zrender the dom event\n        // listener delegate all of the upper events of element. Some of those events need\n        // to prevent default. For example, the feature `preventDefaultMouseMove` of echarts.\n        // Before passive can be adopted, these issues should be considered:\n        // (1) Whether and how a zrender user specifies an event listener passive. And by default,\n        // passive or not.\n        // (2) How to tread that some zrender event listener is passive, and some is not. If\n        // we use other way but not preventDefault of mousewheel and touchmove, browser\n        // compatibility should be handled.\n\n        // var opts = (env.passiveSupported && name === 'mousewheel')\n        //     ? {passive: true}\n        //     // By default, the third param of el.addEventListener is `capture: false`.\n        //     : void 0;\n        // el.addEventListener(name, handler /* , opts */);\n        el.addEventListener(name, handler);\n    }\n    else {\n        el.attachEvent('on' + name, handler);\n    }\n}\n\nfunction removeEventListener(el, name, handler) {\n    if (isDomLevel2) {\n        el.removeEventListener(name, handler);\n    }\n    else {\n        el.detachEvent('on' + name, handler);\n    }\n}\n\n/**\n * preventDefault and stopPropagation.\n * Notice: do not do that in zrender. Upper application\n * do that if necessary.\n *\n * @memberOf module:zrender/core/event\n * @method\n * @param {Event} e : event\n */\nvar stop = isDomLevel2\n    ? function (e) {\n        e.preventDefault();\n        e.stopPropagation();\n        e.cancelBubble = true;\n    }\n    : function (e) {\n        e.returnValue = false;\n        e.cancelBubble = true;\n    };\n\nfunction notLeftMouse(e) {\n    // If e.which is undefined, considered as left mouse event.\n    return e.which > 1;\n}\n\n/**\n * , \n *\n * @module zrender/animation/Animation\n * @author pissang(https://github.com/pissang)\n */\n// TODO Additive animation\n// http://iosoteric.com/additive-animations-animatewithduration-in-ios-8/\n// https://developer.apple.com/videos/wwdc2014/#236\n\n/**\n * @typedef {Object} IZRenderStage\n * @property {Function} update\n */\n\n/**\n * @alias module:zrender/animation/Animation\n * @constructor\n * @param {Object} [options]\n * @param {Function} [options.onframe]\n * @param {IZRenderStage} [options.stage]\n * @example\n *     var animation = new Animation();\n *     var obj = {\n *         x: 100,\n *         y: 100\n *     };\n *     animation.animate(node.position)\n *         .when(1000, {\n *             x: 500,\n *             y: 500\n *         })\n *         .when(2000, {\n *             x: 100,\n *             y: 100\n *         })\n *         .start('spline');\n */\nvar Animation = function (options) {\n\n    options = options || {};\n\n    this.stage = options.stage || {};\n\n    this.onframe = options.onframe || function() {};\n\n    // private properties\n    this._clips = [];\n\n    this._running = false;\n\n    this._time;\n\n    this._pausedTime;\n\n    this._pauseStart;\n\n    this._paused = false;\n\n    Eventful.call(this);\n};\n\nAnimation.prototype = {\n\n    constructor: Animation,\n    /**\n     *  clip\n     * @param {module:zrender/animation/Clip} clip\n     */\n    addClip: function (clip) {\n        this._clips.push(clip);\n    },\n    /**\n     *  animator\n     * @param {module:zrender/animation/Animator} animator\n     */\n    addAnimator: function (animator) {\n        animator.animation = this;\n        var clips = animator.getClips();\n        for (var i = 0; i < clips.length; i++) {\n            this.addClip(clips[i]);\n        }\n    },\n    /**\n     * \n     * @param {module:zrender/animation/Clip} clip\n     */\n    removeClip: function(clip) {\n        var idx = indexOf(this._clips, clip);\n        if (idx >= 0) {\n            this._clips.splice(idx, 1);\n        }\n    },\n\n    /**\n     * \n     * @param {module:zrender/animation/Animator} animator\n     */\n    removeAnimator: function (animator) {\n        var clips = animator.getClips();\n        for (var i = 0; i < clips.length; i++) {\n            this.removeClip(clips[i]);\n        }\n        animator.animation = null;\n    },\n\n    _update: function() {\n        var time = new Date().getTime() - this._pausedTime;\n        var delta = time - this._time;\n        var clips = this._clips;\n        var len = clips.length;\n\n        var deferredEvents = [];\n        var deferredClips = [];\n        for (var i = 0; i < len; i++) {\n            var clip = clips[i];\n            var e = clip.step(time, delta);\n            // Throw out the events need to be called after\n            // stage.update, like destroy\n            if (e) {\n                deferredEvents.push(e);\n                deferredClips.push(clip);\n            }\n        }\n\n        // Remove the finished clip\n        for (var i = 0; i < len;) {\n            if (clips[i]._needsRemove) {\n                clips[i] = clips[len - 1];\n                clips.pop();\n                len--;\n            }\n            else {\n                i++;\n            }\n        }\n\n        len = deferredEvents.length;\n        for (var i = 0; i < len; i++) {\n            deferredClips[i].fire(deferredEvents[i]);\n        }\n\n        this._time = time;\n\n        this.onframe(delta);\n\n        // 'frame' should be triggered before stage, because upper application\n        // depends on the sequence (e.g., echarts-stream and finish\n        // event judge)\n        this.trigger('frame', delta);\n\n        if (this.stage.update) {\n            this.stage.update();\n        }\n    },\n\n    _startLoop: function () {\n        var self = this;\n\n        this._running = true;\n\n        function step() {\n            if (self._running) {\n\n                requestAnimationFrame(step);\n\n                !self._paused && self._update();\n            }\n        }\n\n        requestAnimationFrame(step);\n    },\n\n    /**\n     * Start animation.\n     */\n    start: function () {\n\n        this._time = new Date().getTime();\n        this._pausedTime = 0;\n\n        this._startLoop();\n    },\n\n    /**\n     * Stop animation.\n     */\n    stop: function () {\n        this._running = false;\n    },\n\n    /**\n     * Pause animation.\n     */\n    pause: function () {\n        if (!this._paused) {\n            this._pauseStart = new Date().getTime();\n            this._paused = true;\n        }\n    },\n\n    /**\n     * Resume animation.\n     */\n    resume: function () {\n        if (this._paused) {\n            this._pausedTime += (new Date().getTime()) - this._pauseStart;\n            this._paused = false;\n        }\n    },\n\n    /**\n     * Clear animation.\n     */\n    clear: function () {\n        this._clips = [];\n    },\n\n    /**\n     * Whether animation finished.\n     */\n    isFinished: function () {\n        return !this._clips.length;\n    },\n\n    /**\n     * Creat animator for a target, whose props can be animated.\n     *\n     * @param  {Object} target\n     * @param  {Object} options\n     * @param  {boolean} [options.loop=false] Whether loop animation.\n     * @param  {Function} [options.getter=null] Get value from target.\n     * @param  {Function} [options.setter=null] Set value to target.\n     * @return {module:zrender/animation/Animation~Animator}\n     */\n    // TODO Gap\n    animate: function (target, options) {\n        options = options || {};\n\n        var animator = new Animator(\n            target,\n            options.loop,\n            options.getter,\n            options.setter\n        );\n\n        this.addAnimator(animator);\n\n        return animator;\n    }\n};\n\nmixin(Animation, Eventful);\n\n/**\n * Only implements needed gestures for mobile.\n */\n\nvar GestureMgr = function () {\n\n    /**\n     * @private\n     * @type {Array.<Object>}\n     */\n    this._track = [];\n};\n\nGestureMgr.prototype = {\n\n    constructor: GestureMgr,\n\n    recognize: function (event, target, root) {\n        this._doTrack(event, target, root);\n        return this._recognize(event);\n    },\n\n    clear: function () {\n        this._track.length = 0;\n        return this;\n    },\n\n    _doTrack: function (event, target, root) {\n        var touches = event.touches;\n\n        if (!touches) {\n            return;\n        }\n\n        var trackItem = {\n            points: [],\n            touches: [],\n            target: target,\n            event: event\n        };\n\n        for (var i = 0, len = touches.length; i < len; i++) {\n            var touch = touches[i];\n            var pos = clientToLocal(root, touch, {});\n            trackItem.points.push([pos.zrX, pos.zrY]);\n            trackItem.touches.push(touch);\n        }\n\n        this._track.push(trackItem);\n    },\n\n    _recognize: function (event) {\n        for (var eventName in recognizers) {\n            if (recognizers.hasOwnProperty(eventName)) {\n                var gestureInfo = recognizers[eventName](this._track, event);\n                if (gestureInfo) {\n                    return gestureInfo;\n                }\n            }\n        }\n    }\n};\n\nfunction dist$1(pointPair) {\n    var dx = pointPair[1][0] - pointPair[0][0];\n    var dy = pointPair[1][1] - pointPair[0][1];\n\n    return Math.sqrt(dx * dx + dy * dy);\n}\n\nfunction center(pointPair) {\n    return [\n        (pointPair[0][0] + pointPair[1][0]) / 2,\n        (pointPair[0][1] + pointPair[1][1]) / 2\n    ];\n}\n\nvar recognizers = {\n\n    pinch: function (track, event) {\n        var trackLen = track.length;\n\n        if (!trackLen) {\n            return;\n        }\n\n        var pinchEnd = (track[trackLen - 1] || {}).points;\n        var pinchPre = (track[trackLen - 2] || {}).points || pinchEnd;\n\n        if (pinchPre\n            && pinchPre.length > 1\n            && pinchEnd\n            && pinchEnd.length > 1\n        ) {\n            var pinchScale = dist$1(pinchEnd) / dist$1(pinchPre);\n            !isFinite(pinchScale) && (pinchScale = 1);\n\n            event.pinchScale = pinchScale;\n\n            var pinchCenter = center(pinchEnd);\n            event.pinchX = pinchCenter[0];\n            event.pinchY = pinchCenter[1];\n\n            return {\n                type: 'pinch',\n                target: track[0].target,\n                event: event\n            };\n        }\n    }\n\n    // Only pinch currently.\n};\n\nvar TOUCH_CLICK_DELAY = 300;\n\nvar mouseHandlerNames = [\n    'click', 'dblclick', 'mousewheel', 'mouseout',\n    'mouseup', 'mousedown', 'mousemove', 'contextmenu'\n];\n\nvar touchHandlerNames = [\n    'touchstart', 'touchend', 'touchmove'\n];\n\nvar pointerEventNames = {\n    pointerdown: 1, pointerup: 1, pointermove: 1, pointerout: 1\n};\n\nvar pointerHandlerNames = map(mouseHandlerNames, function (name) {\n    var nm = name.replace('mouse', 'pointer');\n    return pointerEventNames[nm] ? nm : name;\n});\n\nfunction eventNameFix(name) {\n    return (name === 'mousewheel' && env$1.browser.firefox) ? 'DOMMouseScroll' : name;\n}\n\nfunction processGesture(proxy, event, stage) {\n    var gestureMgr = proxy._gestureMgr;\n\n    stage === 'start' && gestureMgr.clear();\n\n    var gestureInfo = gestureMgr.recognize(\n        event,\n        proxy.handler.findHover(event.zrX, event.zrY, null).target,\n        proxy.dom\n    );\n\n    stage === 'end' && gestureMgr.clear();\n\n    // Do not do any preventDefault here. Upper application do that if necessary.\n    if (gestureInfo) {\n        var type = gestureInfo.type;\n        event.gestureEvent = type;\n\n        proxy.handler.dispatchToElement({target: gestureInfo.target}, type, gestureInfo.event);\n    }\n}\n\n// function onMSGestureChange(proxy, event) {\n//     if (event.translationX || event.translationY) {\n//         // mousemove is carried by MSGesture to reduce the sensitivity.\n//         proxy.handler.dispatchToElement(event.target, 'mousemove', event);\n//     }\n//     if (event.scale !== 1) {\n//         event.pinchX = event.offsetX;\n//         event.pinchY = event.offsetY;\n//         event.pinchScale = event.scale;\n//         proxy.handler.dispatchToElement(event.target, 'pinch', event);\n//     }\n// }\n\n/**\n * Prevent mouse event from being dispatched after Touch Events action\n * @see <https://github.com/deltakosh/handjs/blob/master/src/hand.base.js>\n * 1. Mobile browsers dispatch mouse events 300ms after touchend.\n * 2. Chrome for Android dispatch mousedown for long-touch about 650ms\n * Result: Blocking Mouse Events for 700ms.\n */\nfunction setTouchTimer(instance) {\n    instance._touching = true;\n    clearTimeout(instance._touchTimer);\n    instance._touchTimer = setTimeout(function () {\n        instance._touching = false;\n    }, 700);\n}\n\n\nvar domHandlers = {\n    /**\n     * Mouse move handler\n     * @inner\n     * @param {Event} event\n     */\n    mousemove: function (event) {\n        event = normalizeEvent(this.dom, event);\n\n        this.trigger('mousemove', event);\n    },\n\n    /**\n     * Mouse out handler\n     * @inner\n     * @param {Event} event\n     */\n    mouseout: function (event) {\n        event = normalizeEvent(this.dom, event);\n\n        var element = event.toElement || event.relatedTarget;\n        if (element != this.dom) {\n            while (element && element.nodeType != 9) {\n                // rootdommouseOut\n                if (element === this.dom) {\n                    return;\n                }\n\n                element = element.parentNode;\n            }\n        }\n\n        this.trigger('mouseout', event);\n    },\n\n    /**\n     * Touch\n     * @inner\n     * @param {Event} event\n     */\n    touchstart: function (event) {\n        // Default mouse behaviour should not be disabled here.\n        // For example, page may needs to be slided.\n        event = normalizeEvent(this.dom, event);\n\n        // Mark touch, which is useful in distinguish touch and\n        // mouse event in upper applicatoin.\n        event.zrByTouch = true;\n\n        this._lastTouchMoment = new Date();\n\n        processGesture(this, event, 'start');\n\n        // In touch device, trigger `mousemove`(`mouseover`) should\n        // be triggered, and must before `mousedown` triggered.\n        domHandlers.mousemove.call(this, event);\n\n        domHandlers.mousedown.call(this, event);\n\n        setTouchTimer(this);\n    },\n\n    /**\n     * Touch\n     * @inner\n     * @param {Event} event\n     */\n    touchmove: function (event) {\n\n        event = normalizeEvent(this.dom, event);\n\n        // Mark touch, which is useful in distinguish touch and\n        // mouse event in upper applicatoin.\n        event.zrByTouch = true;\n\n        processGesture(this, event, 'change');\n\n        // Mouse move should always be triggered no matter whether\n        // there is gestrue event, because mouse move and pinch may\n        // be used at the same time.\n        domHandlers.mousemove.call(this, event);\n\n        setTouchTimer(this);\n    },\n\n    /**\n     * Touch\n     * @inner\n     * @param {Event} event\n     */\n    touchend: function (event) {\n\n        event = normalizeEvent(this.dom, event);\n\n        // Mark touch, which is useful in distinguish touch and\n        // mouse event in upper applicatoin.\n        event.zrByTouch = true;\n\n        processGesture(this, event, 'end');\n\n        domHandlers.mouseup.call(this, event);\n\n        // Do not trigger `mouseout` here, in spite of `mousemove`(`mouseover`) is\n        // triggered in `touchstart`. This seems to be illogical, but by this mechanism,\n        // we can conveniently implement \"hover style\" in both PC and touch device just\n        // by listening to `mouseover` to add \"hover style\" and listening to `mouseout`\n        // to remove \"hover style\" on an element, without any additional code for\n        // compatibility. (`mouseout` will not be triggered in `touchend`, so \"hover\n        // style\" will remain for user view)\n\n        // click event should always be triggered no matter whether\n        // there is gestrue event. System click can not be prevented.\n        if (+new Date() - this._lastTouchMoment < TOUCH_CLICK_DELAY) {\n            domHandlers.click.call(this, event);\n        }\n\n        setTouchTimer(this);\n    },\n\n    pointerdown: function (event) {\n        domHandlers.mousedown.call(this, event);\n\n        // if (useMSGuesture(this, event)) {\n        //     this._msGesture.addPointer(event.pointerId);\n        // }\n    },\n\n    pointermove: function (event) {\n        // FIXME\n        // pointermove is so sensitive that it always triggered when\n        // tap(click) on touch screen, which affect some judgement in\n        // upper application. So, we dont support mousemove on MS touch\n        // device yet.\n        if (!isPointerFromTouch(event)) {\n            domHandlers.mousemove.call(this, event);\n        }\n    },\n\n    pointerup: function (event) {\n        domHandlers.mouseup.call(this, event);\n    },\n\n    pointerout: function (event) {\n        // pointerout will be triggered when tap on touch screen\n        // (IE11+/Edge on MS Surface) after click event triggered,\n        // which is inconsistent with the mousout behavior we defined\n        // in touchend. So we unify them.\n        // (check domHandlers.touchend for detailed explanation)\n        if (!isPointerFromTouch(event)) {\n            domHandlers.mouseout.call(this, event);\n        }\n    }\n};\n\nfunction isPointerFromTouch(event) {\n    var pointerType = event.pointerType;\n    return pointerType === 'pen' || pointerType === 'touch';\n}\n\n// function useMSGuesture(handlerProxy, event) {\n//     return isPointerFromTouch(event) && !!handlerProxy._msGesture;\n// }\n\n// Common handlers\neach$1(['click', 'mousedown', 'mouseup', 'mousewheel', 'dblclick', 'contextmenu'], function (name) {\n    domHandlers[name] = function (event) {\n        event = normalizeEvent(this.dom, event);\n        this.trigger(name, event);\n    };\n});\n\n/**\n * dom \n *\n * @inner\n * @param {module:zrender/Handler} instance \n */\nfunction initDomHandler(instance) {\n    each$1(touchHandlerNames, function (name) {\n        instance._handlers[name] = bind(domHandlers[name], instance);\n    });\n\n    each$1(pointerHandlerNames, function (name) {\n        instance._handlers[name] = bind(domHandlers[name], instance);\n    });\n\n    each$1(mouseHandlerNames, function (name) {\n        instance._handlers[name] = makeMouseHandler(domHandlers[name], instance);\n    });\n\n    function makeMouseHandler(fn, instance) {\n        return function () {\n            if (instance._touching) {\n                return;\n            }\n            return fn.apply(instance, arguments);\n        };\n    }\n}\n\n\nfunction HandlerDomProxy(dom) {\n    Eventful.call(this);\n\n    this.dom = dom;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this._touching = false;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this._touchTimer;\n\n    /**\n     * @private\n     * @type {module:zrender/core/GestureMgr}\n     */\n    this._gestureMgr = new GestureMgr();\n\n    this._handlers = {};\n\n    initDomHandler(this);\n\n    if (env$1.pointerEventsSupported) { // Only IE11+/Edge\n        // 1. On devices that both enable touch and mouse (e.g., MS Surface and lenovo X240),\n        // IE11+/Edge do not trigger touch event, but trigger pointer event and mouse event\n        // at the same time.\n        // 2. On MS Surface, it probablely only trigger mousedown but no mouseup when tap on\n        // screen, which do not occurs in pointer event.\n        // So we use pointer event to both detect touch gesture and mouse behavior.\n        mountHandlers(pointerHandlerNames, this);\n\n        // FIXME\n        // Note: MS Gesture require CSS touch-action set. But touch-action is not reliable,\n        // which does not prevent defuault behavior occasionally (which may cause view port\n        // zoomed in but use can not zoom it back). And event.preventDefault() does not work.\n        // So we have to not to use MSGesture and not to support touchmove and pinch on MS\n        // touch screen. And we only support click behavior on MS touch screen now.\n\n        // MS Gesture Event is only supported on IE11+/Edge and on Windows 8+.\n        // We dont support touch on IE on win7.\n        // See <https://msdn.microsoft.com/en-us/library/dn433243(v=vs.85).aspx>\n        // if (typeof MSGesture === 'function') {\n        //     (this._msGesture = new MSGesture()).target = dom; // jshint ignore:line\n        //     dom.addEventListener('MSGestureChange', onMSGestureChange);\n        // }\n    }\n    else {\n        if (env$1.touchEventsSupported) {\n            mountHandlers(touchHandlerNames, this);\n            // Handler of 'mouseout' event is needed in touch mode, which will be mounted below.\n            // addEventListener(root, 'mouseout', this._mouseoutHandler);\n        }\n\n        // 1. Considering some devices that both enable touch and mouse event (like on MS Surface\n        // and lenovo X240, @see #2350), we make mouse event be always listened, otherwise\n        // mouse event can not be handle in those devices.\n        // 2. On MS Surface, Chrome will trigger both touch event and mouse event. How to prevent\n        // mouseevent after touch event triggered, see `setTouchTimer`.\n        mountHandlers(mouseHandlerNames, this);\n    }\n\n    function mountHandlers(handlerNames, instance) {\n        each$1(handlerNames, function (name) {\n            addEventListener(dom, eventNameFix(name), instance._handlers[name]);\n        }, instance);\n    }\n}\n\nvar handlerDomProxyProto = HandlerDomProxy.prototype;\nhandlerDomProxyProto.dispose = function () {\n    var handlerNames = mouseHandlerNames.concat(touchHandlerNames);\n\n    for (var i = 0; i < handlerNames.length; i++) {\n        var name = handlerNames[i];\n        removeEventListener(this.dom, eventNameFix(name), this._handlers[name]);\n    }\n};\n\nhandlerDomProxyProto.setCursor = function (cursorStyle) {\n    this.dom.style && (this.dom.style.cursor = cursorStyle || 'default');\n};\n\nmixin(HandlerDomProxy, Eventful);\n\n/*!\n* ZRender, a high performance 2d drawing library.\n*\n* Copyright (c) 2013, Baidu Inc.\n* All rights reserved.\n*\n* LICENSE\n* https://github.com/ecomfe/zrender/blob/master/LICENSE.txt\n*/\n\nvar useVML = !env$1.canvasSupported;\n\nvar painterCtors = {\n    canvas: Painter\n};\n\nvar instances$1 = {};    // ZRendermap\n\n/**\n * @type {string}\n */\nvar version$1 = '4.0.3';\n\n/**\n * Initializing a zrender instance\n * @param {HTMLElement} dom\n * @param {Object} opts\n * @param {string} [opts.renderer='canvas'] 'canvas' or 'svg'\n * @param {number} [opts.devicePixelRatio]\n * @param {number|string} [opts.width] Can be 'auto' (the same as null/undefined)\n * @param {number|string} [opts.height] Can be 'auto' (the same as null/undefined)\n * @return {module:zrender/ZRender}\n */\nfunction init$1(dom, opts) {\n    var zr = new ZRender(guid(), dom, opts);\n    instances$1[zr.id] = zr;\n    return zr;\n}\n\n/**\n * Dispose zrender instance\n * @param {module:zrender/ZRender} zr\n */\nfunction dispose$1(zr) {\n    if (zr) {\n        zr.dispose();\n    }\n    else {\n        for (var key in instances$1) {\n            if (instances$1.hasOwnProperty(key)) {\n                instances$1[key].dispose();\n            }\n        }\n        instances$1 = {};\n    }\n\n    return this;\n}\n\n/**\n * Get zrender instance by id\n * @param {string} id zrender instance id\n * @return {module:zrender/ZRender}\n */\nfunction getInstance(id) {\n    return instances$1[id];\n}\n\nfunction registerPainter(name, Ctor) {\n    painterCtors[name] = Ctor;\n}\n\nfunction delInstance(id) {\n    delete instances$1[id];\n}\n\n/**\n * @module zrender/ZRender\n */\n/**\n * @constructor\n * @alias module:zrender/ZRender\n * @param {string} id\n * @param {HTMLElement} dom\n * @param {Object} opts\n * @param {string} [opts.renderer='canvas'] 'canvas' or 'svg'\n * @param {number} [opts.devicePixelRatio]\n * @param {number} [opts.width] Can be 'auto' (the same as null/undefined)\n * @param {number} [opts.height] Can be 'auto' (the same as null/undefined)\n */\nvar ZRender = function (id, dom, opts) {\n\n    opts = opts || {};\n\n    /**\n     * @type {HTMLDomElement}\n     */\n    this.dom = dom;\n\n    /**\n     * @type {string}\n     */\n    this.id = id;\n\n    var self = this;\n    var storage = new Storage();\n\n    var rendererType = opts.renderer;\n    // TODO WebGL\n    if (useVML) {\n        if (!painterCtors.vml) {\n            throw new Error('You need to require \\'zrender/vml/vml\\' to support IE8');\n        }\n        rendererType = 'vml';\n    }\n    else if (!rendererType || !painterCtors[rendererType]) {\n        rendererType = 'canvas';\n    }\n    var painter = new painterCtors[rendererType](dom, storage, opts, id);\n\n    this.storage = storage;\n    this.painter = painter;\n\n    var handerProxy = (!env$1.node && !env$1.worker) ? new HandlerDomProxy(painter.getViewportRoot()) : null;\n    this.handler = new Handler(storage, painter, handerProxy, painter.root);\n\n    /**\n     * @type {module:zrender/animation/Animation}\n     */\n    this.animation = new Animation({\n        stage: {\n            update: bind(this.flush, this)\n        }\n    });\n    this.animation.start();\n\n    /**\n     * @type {boolean}\n     * @private\n     */\n    this._needsRefresh;\n\n    //  storage.delFromStorage, \n    // FIXME ugly\n    var oldDelFromStorage = storage.delFromStorage;\n    var oldAddToStorage = storage.addToStorage;\n\n    storage.delFromStorage = function (el) {\n        oldDelFromStorage.call(storage, el);\n\n        el && el.removeSelfFromZr(self);\n    };\n\n    storage.addToStorage = function (el) {\n        oldAddToStorage.call(storage, el);\n\n        el.addSelfToZr(self);\n    };\n};\n\nZRender.prototype = {\n\n    constructor: ZRender,\n    /**\n     * \n     * @return {string}\n     */\n    getId: function () {\n        return this.id;\n    },\n\n    /**\n     * \n     * @param  {module:zrender/Element} el\n     */\n    add: function (el) {\n        this.storage.addRoot(el);\n        this._needsRefresh = true;\n    },\n\n    /**\n     * \n     * @param  {module:zrender/Element} el\n     */\n    remove: function (el) {\n        this.storage.delRoot(el);\n        this._needsRefresh = true;\n    },\n\n    /**\n     * Change configuration of layer\n     * @param {string} zLevel\n     * @param {Object} config\n     * @param {string} [config.clearColor=0] Clear color\n     * @param {string} [config.motionBlur=false] If enable motion blur\n     * @param {number} [config.lastFrameAlpha=0.7] Motion blur factor. Larger value cause longer trailer\n    */\n    configLayer: function (zLevel, config) {\n        if (this.painter.configLayer) {\n            this.painter.configLayer(zLevel, config);\n        }\n        this._needsRefresh = true;\n    },\n\n    /**\n     * Set background color\n     * @param {string} backgroundColor\n     */\n    setBackgroundColor: function (backgroundColor) {\n        if (this.painter.setBackgroundColor) {\n            this.painter.setBackgroundColor(backgroundColor);\n        }\n        this._needsRefresh = true;\n    },\n\n    /**\n     * Repaint the canvas immediately\n     */\n    refreshImmediately: function () {\n        // var start = new Date();\n        // Clear needsRefresh ahead to avoid something wrong happens in refresh\n        // Or it will cause zrender refreshes again and again.\n        this._needsRefresh = false;\n        this.painter.refresh();\n        /**\n         * Avoid trigger zr.refresh in Element#beforeUpdate hook\n         */\n        this._needsRefresh = false;\n        // var end = new Date();\n\n        // var log = document.getElementById('log');\n        // if (log) {\n        //     log.innerHTML = log.innerHTML + '<br>' + (end - start);\n        // }\n    },\n\n    /**\n     * Mark and repaint the canvas in the next frame of browser\n     */\n    refresh: function() {\n        this._needsRefresh = true;\n    },\n\n    /**\n     * Perform all refresh\n     */\n    flush: function () {\n        var triggerRendered;\n\n        if (this._needsRefresh) {\n            triggerRendered = true;\n            this.refreshImmediately();\n        }\n        if (this._needsRefreshHover) {\n            triggerRendered = true;\n            this.refreshHoverImmediately();\n        }\n\n        triggerRendered && this.trigger('rendered');\n    },\n\n    /**\n     * Add element to hover layer\n     * @param  {module:zrender/Element} el\n     * @param {Object} style\n     */\n    addHover: function (el, style) {\n        if (this.painter.addHover) {\n            this.painter.addHover(el, style);\n            this.refreshHover();\n        }\n    },\n\n    /**\n     * Add element from hover layer\n     * @param  {module:zrender/Element} el\n     */\n    removeHover: function (el) {\n        if (this.painter.removeHover) {\n            this.painter.removeHover(el);\n            this.refreshHover();\n        }\n    },\n\n    /**\n     * Clear all hover elements in hover layer\n     * @param  {module:zrender/Element} el\n     */\n    clearHover: function () {\n        if (this.painter.clearHover) {\n            this.painter.clearHover();\n            this.refreshHover();\n        }\n    },\n\n    /**\n     * Refresh hover in next frame\n     */\n    refreshHover: function () {\n        this._needsRefreshHover = true;\n    },\n\n    /**\n     * Refresh hover immediately\n     */\n    refreshHoverImmediately: function () {\n        this._needsRefreshHover = false;\n        this.painter.refreshHover && this.painter.refreshHover();\n    },\n\n    /**\n     * Resize the canvas.\n     * Should be invoked when container size is changed\n     * @param {Object} [opts]\n     * @param {number|string} [opts.width] Can be 'auto' (the same as null/undefined)\n     * @param {number|string} [opts.height] Can be 'auto' (the same as null/undefined)\n     */\n    resize: function(opts) {\n        opts = opts || {};\n        this.painter.resize(opts.width, opts.height);\n        this.handler.resize();\n    },\n\n    /**\n     * Stop and clear all animation immediately\n     */\n    clearAnimation: function () {\n        this.animation.clear();\n    },\n\n    /**\n     * Get container width\n     */\n    getWidth: function() {\n        return this.painter.getWidth();\n    },\n\n    /**\n     * Get container height\n     */\n    getHeight: function() {\n        return this.painter.getHeight();\n    },\n\n    /**\n     * Export the canvas as Base64 URL\n     * @param {string} type\n     * @param {string} [backgroundColor='#fff']\n     * @return {string} Base64 URL\n     */\n    // toDataURL: function(type, backgroundColor) {\n    //     return this.painter.getRenderedCanvas({\n    //         backgroundColor: backgroundColor\n    //     }).toDataURL(type);\n    // },\n\n    /**\n     * Converting a path to image.\n     * It has much better performance of drawing image rather than drawing a vector path.\n     * @param {module:zrender/graphic/Path} e\n     * @param {number} width\n     * @param {number} height\n     */\n    pathToImage: function(e, dpr) {\n        return this.painter.pathToImage(e, dpr);\n    },\n\n    /**\n     * Set default cursor\n     * @param {string} [cursorStyle='default']  crosshair\n     */\n    setCursorStyle: function (cursorStyle) {\n        this.handler.setCursorStyle(cursorStyle);\n    },\n\n    /**\n     * Find hovered element\n     * @param {number} x\n     * @param {number} y\n     * @return {Object} {target, topTarget}\n     */\n    findHover: function (x, y) {\n        return this.handler.findHover(x, y);\n    },\n\n    /**\n     * Bind event\n     *\n     * @param {string} eventName Event name\n     * @param {Function} eventHandler Handler function\n     * @param {Object} [context] Context object\n     */\n    on: function(eventName, eventHandler, context) {\n        this.handler.on(eventName, eventHandler, context);\n    },\n\n    /**\n     * Unbind event\n     * @param {string} eventName Event name\n     * @param {Function} [eventHandler] Handler function\n     */\n    off: function(eventName, eventHandler) {\n        this.handler.off(eventName, eventHandler);\n    },\n\n    /**\n     * Trigger event manually\n     *\n     * @param {string} eventName Event name\n     * @param {event=} event Event object\n     */\n    trigger: function (eventName, event) {\n        this.handler.trigger(eventName, event);\n    },\n\n\n    /**\n     * Clear all objects and the canvas.\n     */\n    clear: function () {\n        this.storage.delRoot();\n        this.painter.clear();\n    },\n\n    /**\n     * Dispose self.\n     */\n    dispose: function () {\n        this.animation.stop();\n\n        this.clear();\n        this.storage.dispose();\n        this.painter.dispose();\n        this.handler.dispose();\n\n        this.animation =\n        this.storage =\n        this.painter =\n        this.handler = null;\n\n        delInstance(this.id);\n    }\n};\n\n\n\nvar zrender = (Object.freeze || Object)({\n\tversion: version$1,\n\tinit: init$1,\n\tdispose: dispose$1,\n\tgetInstance: getInstance,\n\tregisterPainter: registerPainter\n});\n\nvar each$2 = each$1;\nvar isObject$2 = isObject$1;\nvar isArray$1 = isArray;\n\n/**\n * Make the name displayable. But we should\n * make sure it is not duplicated with user\n * specified name, so use '\\0';\n */\nvar DUMMY_COMPONENT_NAME_PREFIX = 'series\\0';\n\n/**\n * If value is not array, then translate it to array.\n * @param  {*} value\n * @return {Array} [value] or value\n */\nfunction normalizeToArray(value) {\n    return value instanceof Array\n        ? value\n        : value == null\n        ? []\n        : [value];\n}\n\n/**\n * Sync default option between normal and emphasis like `position` and `show`\n * In case some one will write code like\n *     label: {\n *          show: false,\n *          position: 'outside',\n *          fontSize: 18\n *     },\n *     emphasis: {\n *          label: { show: true }\n *     }\n * @param {Object} opt\n * @param {string} key\n * @param {Array.<string>} subOpts\n */\nfunction defaultEmphasis(opt, key, subOpts) {\n    if (opt) {\n        opt[key] = opt[key] || {};\n        opt.emphasis = opt.emphasis || {};\n        opt.emphasis[key] = opt.emphasis[key] || {};\n\n        // Default emphasis option from normal\n        for (var i = 0, len = subOpts.length; i < len; i++) {\n            var subOptName = subOpts[i];\n            if (!opt.emphasis[key].hasOwnProperty(subOptName)\n                && opt[key].hasOwnProperty(subOptName)\n            ) {\n                opt.emphasis[key][subOptName] = opt[key][subOptName];\n            }\n        }\n    }\n}\n\nvar TEXT_STYLE_OPTIONS = [\n    'fontStyle', 'fontWeight', 'fontSize', 'fontFamily',\n    'rich', 'tag', 'color', 'textBorderColor', 'textBorderWidth',\n    'width', 'height', 'lineHeight', 'align', 'verticalAlign', 'baseline',\n    'shadowColor', 'shadowBlur', 'shadowOffsetX', 'shadowOffsetY',\n    'textShadowColor', 'textShadowBlur', 'textShadowOffsetX', 'textShadowOffsetY',\n    'backgroundColor', 'borderColor', 'borderWidth', 'borderRadius', 'padding'\n];\n\n// modelUtil.LABEL_OPTIONS = modelUtil.TEXT_STYLE_OPTIONS.concat([\n//     'position', 'offset', 'rotate', 'origin', 'show', 'distance', 'formatter',\n//     'fontStyle', 'fontWeight', 'fontSize', 'fontFamily',\n//     // FIXME: deprecated, check and remove it.\n//     'textStyle'\n// ]);\n\n/**\n * The method do not ensure performance.\n * data could be [12, 2323, {value: 223}, [1221, 23], {value: [2, 23]}]\n * This helper method retieves value from data.\n * @param {string|number|Date|Array|Object} dataItem\n * @return {number|string|Date|Array.<number|string|Date>}\n */\nfunction getDataItemValue(dataItem) {\n    return (isObject$2(dataItem) && !isArray$1(dataItem) && !(dataItem instanceof Date))\n        ? dataItem.value : dataItem;\n}\n\n/**\n * data could be [12, 2323, {value: 223}, [1221, 23], {value: [2, 23]}]\n * This helper method determine if dataItem has extra option besides value\n * @param {string|number|Date|Array|Object} dataItem\n */\nfunction isDataItemOption(dataItem) {\n    return isObject$2(dataItem)\n        && !(dataItem instanceof Array);\n        // // markLine data can be array\n        // && !(dataItem[0] && isObject(dataItem[0]) && !(dataItem[0] instanceof Array));\n}\n\n/**\n * Mapping to exists for merge.\n *\n * @public\n * @param {Array.<Object>|Array.<module:echarts/model/Component>} exists\n * @param {Object|Array.<Object>} newCptOptions\n * @return {Array.<Object>} Result, like [{exist: ..., option: ...}, {}],\n *                          index of which is the same as exists.\n */\nfunction mappingToExists(exists, newCptOptions) {\n    // Mapping by the order by original option (but not order of\n    // new option) in merge mode. Because we should ensure\n    // some specified index (like xAxisIndex) is consistent with\n    // original option, which is easy to understand, espatially in\n    // media query. And in most case, merge option is used to\n    // update partial option but not be expected to change order.\n    newCptOptions = (newCptOptions || []).slice();\n\n    var result = map(exists || [], function (obj, index) {\n        return {exist: obj};\n    });\n\n    // Mapping by id or name if specified.\n    each$2(newCptOptions, function (cptOption, index) {\n        if (!isObject$2(cptOption)) {\n            return;\n        }\n\n        // id has highest priority.\n        for (var i = 0; i < result.length; i++) {\n            if (!result[i].option // Consider name: two map to one.\n                && cptOption.id != null\n                && result[i].exist.id === cptOption.id + ''\n            ) {\n                result[i].option = cptOption;\n                newCptOptions[index] = null;\n                return;\n            }\n        }\n\n        for (var i = 0; i < result.length; i++) {\n            var exist = result[i].exist;\n            if (!result[i].option // Consider name: two map to one.\n                // Can not match when both ids exist but different.\n                && (exist.id == null || cptOption.id == null)\n                && cptOption.name != null\n                && !isIdInner(cptOption)\n                && !isIdInner(exist)\n                && exist.name === cptOption.name + ''\n            ) {\n                result[i].option = cptOption;\n                newCptOptions[index] = null;\n                return;\n            }\n        }\n    });\n\n    // Otherwise mapping by index.\n    each$2(newCptOptions, function (cptOption, index) {\n        if (!isObject$2(cptOption)) {\n            return;\n        }\n\n        var i = 0;\n        for (; i < result.length; i++) {\n            var exist = result[i].exist;\n            if (!result[i].option\n                // Existing model that already has id should be able to\n                // mapped to (because after mapping performed model may\n                // be assigned with a id, whish should not affect next\n                // mapping), except those has inner id.\n                && !isIdInner(exist)\n                // Caution:\n                // Do not overwrite id. But name can be overwritten,\n                // because axis use name as 'show label text'.\n                // 'exist' always has id and name and we dont\n                // need to check it.\n                && cptOption.id == null\n            ) {\n                result[i].option = cptOption;\n                break;\n            }\n        }\n\n        if (i >= result.length) {\n            result.push({option: cptOption});\n        }\n    });\n\n    return result;\n}\n\n/**\n * Make id and name for mapping result (result of mappingToExists)\n * into `keyInfo` field.\n *\n * @public\n * @param {Array.<Object>} Result, like [{exist: ..., option: ...}, {}],\n *                          which order is the same as exists.\n * @return {Array.<Object>} The input.\n */\nfunction makeIdAndName(mapResult) {\n    // We use this id to hash component models and view instances\n    // in echarts. id can be specified by user, or auto generated.\n\n    // The id generation rule ensures new view instance are able\n    // to mapped to old instance when setOption are called in\n    // no-merge mode. So we generate model id by name and plus\n    // type in view id.\n\n    // name can be duplicated among components, which is convenient\n    // to specify multi components (like series) by one name.\n\n    // Ensure that each id is distinct.\n    var idMap = createHashMap();\n\n    each$2(mapResult, function (item, index) {\n        var existCpt = item.exist;\n        existCpt && idMap.set(existCpt.id, item);\n    });\n\n    each$2(mapResult, function (item, index) {\n        var opt = item.option;\n\n        assert$1(\n            !opt || opt.id == null || !idMap.get(opt.id) || idMap.get(opt.id) === item,\n            'id duplicates: ' + (opt && opt.id)\n        );\n\n        opt && opt.id != null && idMap.set(opt.id, item);\n        !item.keyInfo && (item.keyInfo = {});\n    });\n\n    // Make name and id.\n    each$2(mapResult, function (item, index) {\n        var existCpt = item.exist;\n        var opt = item.option;\n        var keyInfo = item.keyInfo;\n\n        if (!isObject$2(opt)) {\n            return;\n        }\n\n        // name can be overwitten. Consider case: axis.name = '20km'.\n        // But id generated by name will not be changed, which affect\n        // only in that case: setOption with 'not merge mode' and view\n        // instance will be recreated, which can be accepted.\n        keyInfo.name = opt.name != null\n            ? opt.name + ''\n            : existCpt\n            ? existCpt.name\n            // Avoid diffferent series has the same name,\n            // because name may be used like in color pallet.\n            : DUMMY_COMPONENT_NAME_PREFIX + index;\n\n        if (existCpt) {\n            keyInfo.id = existCpt.id;\n        }\n        else if (opt.id != null) {\n            keyInfo.id = opt.id + '';\n        }\n        else {\n            // Consider this situatoin:\n            //  optionA: [{name: 'a'}, {name: 'a'}, {..}]\n            //  optionB [{..}, {name: 'a'}, {name: 'a'}]\n            // Series with the same name between optionA and optionB\n            // should be mapped.\n            var idNum = 0;\n            do {\n                keyInfo.id = '\\0' + keyInfo.name + '\\0' + idNum++;\n            }\n            while (idMap.get(keyInfo.id));\n        }\n\n        idMap.set(keyInfo.id, item);\n    });\n}\n\nfunction isNameSpecified(componentModel) {\n    var name = componentModel.name;\n    // Is specified when `indexOf` get -1 or > 0.\n    return !!(name && name.indexOf(DUMMY_COMPONENT_NAME_PREFIX));\n}\n\n/**\n * @public\n * @param {Object} cptOption\n * @return {boolean}\n */\nfunction isIdInner(cptOption) {\n    return isObject$2(cptOption)\n        && cptOption.id\n        && (cptOption.id + '').indexOf('\\0_ec_\\0') === 0;\n}\n\n/**\n * A helper for removing duplicate items between batchA and batchB,\n * and in themselves, and categorize by series.\n *\n * @param {Array.<Object>} batchA Like: [{seriesId: 2, dataIndex: [32, 4, 5]}, ...]\n * @param {Array.<Object>} batchB Like: [{seriesId: 2, dataIndex: [32, 4, 5]}, ...]\n * @return {Array.<Array.<Object>, Array.<Object>>} result: [resultBatchA, resultBatchB]\n */\nfunction compressBatches(batchA, batchB) {\n    var mapA = {};\n    var mapB = {};\n\n    makeMap(batchA || [], mapA);\n    makeMap(batchB || [], mapB, mapA);\n\n    return [mapToArray(mapA), mapToArray(mapB)];\n\n    function makeMap(sourceBatch, map$$1, otherMap) {\n        for (var i = 0, len = sourceBatch.length; i < len; i++) {\n            var seriesId = sourceBatch[i].seriesId;\n            var dataIndices = normalizeToArray(sourceBatch[i].dataIndex);\n            var otherDataIndices = otherMap && otherMap[seriesId];\n\n            for (var j = 0, lenj = dataIndices.length; j < lenj; j++) {\n                var dataIndex = dataIndices[j];\n\n                if (otherDataIndices && otherDataIndices[dataIndex]) {\n                    otherDataIndices[dataIndex] = null;\n                }\n                else {\n                    (map$$1[seriesId] || (map$$1[seriesId] = {}))[dataIndex] = 1;\n                }\n            }\n        }\n    }\n\n    function mapToArray(map$$1, isData) {\n        var result = [];\n        for (var i in map$$1) {\n            if (map$$1.hasOwnProperty(i) && map$$1[i] != null) {\n                if (isData) {\n                    result.push(+i);\n                }\n                else {\n                    var dataIndices = mapToArray(map$$1[i], true);\n                    dataIndices.length && result.push({seriesId: i, dataIndex: dataIndices});\n                }\n            }\n        }\n        return result;\n    }\n}\n\n/**\n * @param {module:echarts/data/List} data\n * @param {Object} payload Contains dataIndex (means rawIndex) / dataIndexInside / name\n *                         each of which can be Array or primary type.\n * @return {number|Array.<number>} dataIndex If not found, return undefined/null.\n */\nfunction queryDataIndex(data, payload) {\n    if (payload.dataIndexInside != null) {\n        return payload.dataIndexInside;\n    }\n    else if (payload.dataIndex != null) {\n        return isArray(payload.dataIndex)\n            ? map(payload.dataIndex, function (value) {\n                return data.indexOfRawIndex(value);\n            })\n            : data.indexOfRawIndex(payload.dataIndex);\n    }\n    else if (payload.name != null) {\n        return isArray(payload.name)\n            ? map(payload.name, function (value) {\n                return data.indexOfName(value);\n            })\n            : data.indexOfName(payload.name);\n    }\n}\n\n/**\n * Enable property storage to any host object.\n * Notice: Serialization is not supported.\n *\n * For example:\n * var inner = zrUitl.makeInner();\n *\n * function some1(hostObj) {\n *      inner(hostObj).someProperty = 1212;\n *      ...\n * }\n * function some2() {\n *      var fields = inner(this);\n *      fields.someProperty1 = 1212;\n *      fields.someProperty2 = 'xx';\n *      ...\n * }\n *\n * @return {Function}\n */\nfunction makeInner() {\n    // Consider different scope by es module import.\n    var key = '__\\0ec_inner_' + innerUniqueIndex++ + '_' + Math.random().toFixed(5);\n    return function (hostObj) {\n        return hostObj[key] || (hostObj[key] = {});\n    };\n}\nvar innerUniqueIndex = 0;\n\n/**\n * @param {module:echarts/model/Global} ecModel\n * @param {string|Object} finder\n *        If string, e.g., 'geo', means {geoIndex: 0}.\n *        If Object, could contain some of these properties below:\n *        {\n *            seriesIndex, seriesId, seriesName,\n *            geoIndex, geoId, geoName,\n *            bmapIndex, bmapId, bmapName,\n *            xAxisIndex, xAxisId, xAxisName,\n *            yAxisIndex, yAxisId, yAxisName,\n *            gridIndex, gridId, gridName,\n *            ... (can be extended)\n *        }\n *        Each properties can be number|string|Array.<number>|Array.<string>\n *        For example, a finder could be\n *        {\n *            seriesIndex: 3,\n *            geoId: ['aa', 'cc'],\n *            gridName: ['xx', 'rr']\n *        }\n *        xxxIndex can be set as 'all' (means all xxx) or 'none' (means not specify)\n *        If nothing or null/undefined specified, return nothing.\n * @param {Object} [opt]\n * @param {string} [opt.defaultMainType]\n * @param {Array.<string>} [opt.includeMainTypes]\n * @return {Object} result like:\n *        {\n *            seriesModels: [seriesModel1, seriesModel2],\n *            seriesModel: seriesModel1, // The first model\n *            geoModels: [geoModel1, geoModel2],\n *            geoModel: geoModel1, // The first model\n *            ...\n *        }\n */\nfunction parseFinder(ecModel, finder, opt) {\n    if (isString(finder)) {\n        var obj = {};\n        obj[finder + 'Index'] = 0;\n        finder = obj;\n    }\n\n    var defaultMainType = opt && opt.defaultMainType;\n    if (defaultMainType\n        && !has(finder, defaultMainType + 'Index')\n        && !has(finder, defaultMainType + 'Id')\n        && !has(finder, defaultMainType + 'Name')\n    ) {\n        finder[defaultMainType + 'Index'] = 0;\n    }\n\n    var result = {};\n\n    each$2(finder, function (value, key) {\n        var value = finder[key];\n\n        // Exclude 'dataIndex' and other illgal keys.\n        if (key === 'dataIndex' || key === 'dataIndexInside') {\n            result[key] = value;\n            return;\n        }\n\n        var parsedKey = key.match(/^(\\w+)(Index|Id|Name)$/) || [];\n        var mainType = parsedKey[1];\n        var queryType = (parsedKey[2] || '').toLowerCase();\n\n        if (!mainType\n            || !queryType\n            || value == null\n            || (queryType === 'index' && value === 'none')\n            || (opt && opt.includeMainTypes && indexOf(opt.includeMainTypes, mainType) < 0)\n        ) {\n            return;\n        }\n\n        var queryParam = {mainType: mainType};\n        if (queryType !== 'index' || value !== 'all') {\n            queryParam[queryType] = value;\n        }\n\n        var models = ecModel.queryComponents(queryParam);\n        result[mainType + 'Models'] = models;\n        result[mainType + 'Model'] = models[0];\n    });\n\n    return result;\n}\n\nfunction has(obj, prop) {\n    return obj && obj.hasOwnProperty(prop);\n}\n\nfunction setAttribute(dom, key, value) {\n    dom.setAttribute\n        ? dom.setAttribute(key, value)\n        : (dom[key] = value);\n}\n\nfunction getAttribute(dom, key) {\n    return dom.getAttribute\n        ? dom.getAttribute(key)\n        : dom[key];\n}\n\nvar TYPE_DELIMITER = '.';\nvar IS_CONTAINER = '___EC__COMPONENT__CONTAINER___';\n\n/**\n * Notice, parseClassType('') should returns {main: '', sub: ''}\n * @public\n */\nfunction parseClassType$1(componentType) {\n    var ret = {main: '', sub: ''};\n    if (componentType) {\n        componentType = componentType.split(TYPE_DELIMITER);\n        ret.main = componentType[0] || '';\n        ret.sub = componentType[1] || '';\n    }\n    return ret;\n}\n\n/**\n * @public\n */\nfunction checkClassType(componentType) {\n    assert$1(\n        /^[a-zA-Z0-9_]+([.][a-zA-Z0-9_]+)?$/.test(componentType),\n        'componentType \"' + componentType + '\" illegal'\n    );\n}\n\n/**\n * @public\n */\nfunction enableClassExtend(RootClass, mandatoryMethods) {\n\n    RootClass.$constructor = RootClass;\n    RootClass.extend = function (proto) {\n\n        if (__DEV__) {\n            each$1(mandatoryMethods, function (method) {\n                if (!proto[method]) {\n                    console.warn(\n                        'Method `' + method + '` should be implemented'\n                        + (proto.type ? ' in ' + proto.type : '') + '.'\n                    );\n                }\n            });\n        }\n\n        var superClass = this;\n        var ExtendedClass = function () {\n            if (!proto.$constructor) {\n                superClass.apply(this, arguments);\n            }\n            else {\n                proto.$constructor.apply(this, arguments);\n            }\n        };\n\n        extend(ExtendedClass.prototype, proto);\n\n        ExtendedClass.extend = this.extend;\n        ExtendedClass.superCall = superCall;\n        ExtendedClass.superApply = superApply;\n        inherits(ExtendedClass, this);\n        ExtendedClass.superClass = superClass;\n\n        return ExtendedClass;\n    };\n}\n\nvar classBase = 0;\n\n/**\n * Can not use instanceof, consider different scope by\n * cross domain or es module import in ec extensions.\n * Mount a method \"isInstance()\" to Clz.\n */\nfunction enableClassCheck(Clz) {\n    var classAttr = ['__\\0is_clz', classBase++, Math.random().toFixed(3)].join('_');\n    Clz.prototype[classAttr] = true;\n\n    if (__DEV__) {\n        assert$1(!Clz.isInstance, 'The method \"is\" can not be defined.');\n    }\n\n    Clz.isInstance = function (obj) {\n        return !!(obj && obj[classAttr]);\n    };\n}\n\n// superCall should have class info, which can not be fetch from 'this'.\n// Consider this case:\n// class A has method f,\n// class B inherits class A, overrides method f, f call superApply('f'),\n// class C inherits class B, do not overrides method f,\n// then when method of class C is called, dead loop occured.\nfunction superCall(context, methodName) {\n    var args = slice(arguments, 2);\n    return this.superClass.prototype[methodName].apply(context, args);\n}\n\nfunction superApply(context, methodName, args) {\n    return this.superClass.prototype[methodName].apply(context, args);\n}\n\n/**\n * @param {Object} entity\n * @param {Object} options\n * @param {boolean} [options.registerWhenExtend]\n * @public\n */\nfunction enableClassManagement(entity, options) {\n    options = options || {};\n\n    /**\n     * Component model classes\n     * key: componentType,\n     * value:\n     *     componentClass, when componentType is 'xxx'\n     *     or Object.<subKey, componentClass>, when componentType is 'xxx.yy'\n     * @type {Object}\n     */\n    var storage = {};\n\n    entity.registerClass = function (Clazz, componentType) {\n        if (componentType) {\n            checkClassType(componentType);\n            componentType = parseClassType$1(componentType);\n\n            if (!componentType.sub) {\n                if (__DEV__) {\n                    if (storage[componentType.main]) {\n                        console.warn(componentType.main + ' exists.');\n                    }\n                }\n                storage[componentType.main] = Clazz;\n            }\n            else if (componentType.sub !== IS_CONTAINER) {\n                var container = makeContainer(componentType);\n                container[componentType.sub] = Clazz;\n            }\n        }\n        return Clazz;\n    };\n\n    entity.getClass = function (componentMainType, subType, throwWhenNotFound) {\n        var Clazz = storage[componentMainType];\n\n        if (Clazz && Clazz[IS_CONTAINER]) {\n            Clazz = subType ? Clazz[subType] : null;\n        }\n\n        if (throwWhenNotFound && !Clazz) {\n            throw new Error(\n                !subType\n                    ? componentMainType + '.' + 'type should be specified.'\n                    : 'Component ' + componentMainType + '.' + (subType || '') + ' not exists. Load it first.'\n            );\n        }\n\n        return Clazz;\n    };\n\n    entity.getClassesByMainType = function (componentType) {\n        componentType = parseClassType$1(componentType);\n\n        var result = [];\n        var obj = storage[componentType.main];\n\n        if (obj && obj[IS_CONTAINER]) {\n            each$1(obj, function (o, type) {\n                type !== IS_CONTAINER && result.push(o);\n            });\n        }\n        else {\n            result.push(obj);\n        }\n\n        return result;\n    };\n\n    entity.hasClass = function (componentType) {\n        // Just consider componentType.main.\n        componentType = parseClassType$1(componentType);\n        return !!storage[componentType.main];\n    };\n\n    /**\n     * @return {Array.<string>} Like ['aa', 'bb'], but can not be ['aa.xx']\n     */\n    entity.getAllClassMainTypes = function () {\n        var types = [];\n        each$1(storage, function (obj, type) {\n            types.push(type);\n        });\n        return types;\n    };\n\n    /**\n     * If a main type is container and has sub types\n     * @param  {string}  mainType\n     * @return {boolean}\n     */\n    entity.hasSubTypes = function (componentType) {\n        componentType = parseClassType$1(componentType);\n        var obj = storage[componentType.main];\n        return obj && obj[IS_CONTAINER];\n    };\n\n    entity.parseClassType = parseClassType$1;\n\n    function makeContainer(componentType) {\n        var container = storage[componentType.main];\n        if (!container || !container[IS_CONTAINER]) {\n            container = storage[componentType.main] = {};\n            container[IS_CONTAINER] = true;\n        }\n        return container;\n    }\n\n    if (options.registerWhenExtend) {\n        var originalExtend = entity.extend;\n        if (originalExtend) {\n            entity.extend = function (proto) {\n                var ExtendedClass = originalExtend.call(this, proto);\n                return entity.registerClass(ExtendedClass, proto.type);\n            };\n        }\n    }\n\n    return entity;\n}\n\n/**\n * @param {string|Array.<string>} properties\n */\n\n// TODO Parse shadow style\n// TODO Only shallow path support\nvar makeStyleMapper = function (properties) {\n    // Normalize\n    for (var i = 0; i < properties.length; i++) {\n        if (!properties[i][1]) {\n            properties[i][1] = properties[i][0];\n        }\n    }\n    return function (model, excludes, includes) {\n        var style = {};\n        for (var i = 0; i < properties.length; i++) {\n            var propName = properties[i][1];\n            if ((excludes && indexOf(excludes, propName) >= 0)\n                || (includes && indexOf(includes, propName) < 0)\n            ) {\n                continue;\n            }\n            var val = model.getShallow(propName);\n            if (val != null) {\n                style[properties[i][0]] = val;\n            }\n        }\n        return style;\n    };\n};\n\nvar getLineStyle = makeStyleMapper(\n    [\n        ['lineWidth', 'width'],\n        ['stroke', 'color'],\n        ['opacity'],\n        ['shadowBlur'],\n        ['shadowOffsetX'],\n        ['shadowOffsetY'],\n        ['shadowColor']\n    ]\n);\n\nvar lineStyleMixin = {\n    getLineStyle: function (excludes) {\n        var style = getLineStyle(this, excludes);\n        var lineDash = this.getLineDash(style.lineWidth);\n        lineDash && (style.lineDash = lineDash);\n        return style;\n    },\n\n    getLineDash: function (lineWidth) {\n        if (lineWidth == null) {\n            lineWidth = 1;\n        }\n        var lineType = this.get('type');\n        var dotSize = Math.max(lineWidth, 2);\n        var dashSize = lineWidth * 4;\n        return (lineType === 'solid' || lineType == null) ? null\n            : (lineType === 'dashed' ? [dashSize, dashSize] : [dotSize, dotSize]);\n    }\n};\n\nvar getAreaStyle = makeStyleMapper(\n    [\n        ['fill', 'color'],\n        ['shadowBlur'],\n        ['shadowOffsetX'],\n        ['shadowOffsetY'],\n        ['opacity'],\n        ['shadowColor']\n    ]\n);\n\nvar areaStyleMixin = {\n    getAreaStyle: function (excludes, includes) {\n        return getAreaStyle(this, excludes, includes);\n    }\n};\n\n/**\n * \n * @module zrender/core/curve\n * @author pissang(https://www.github.com/pissang)\n */\n\nvar mathPow = Math.pow;\nvar mathSqrt$2 = Math.sqrt;\n\nvar EPSILON$1 = 1e-8;\nvar EPSILON_NUMERIC = 1e-4;\n\nvar THREE_SQRT = mathSqrt$2(3);\nvar ONE_THIRD = 1 / 3;\n\n// \nvar _v0 = create();\nvar _v1 = create();\nvar _v2 = create();\n\nfunction isAroundZero(val) {\n    return val > -EPSILON$1 && val < EPSILON$1;\n}\nfunction isNotAroundZero$1(val) {\n    return val > EPSILON$1 || val < -EPSILON$1;\n}\n/**\n * \n * @memberOf module:zrender/core/curve\n * @param  {number} p0\n * @param  {number} p1\n * @param  {number} p2\n * @param  {number} p3\n * @param  {number} t\n * @return {number}\n */\nfunction cubicAt(p0, p1, p2, p3, t) {\n    var onet = 1 - t;\n    return onet * onet * (onet * p0 + 3 * t * p1)\n            + t * t * (t * p3 + 3 * onet * p2);\n}\n\n/**\n * \n * @memberOf module:zrender/core/curve\n * @param  {number} p0\n * @param  {number} p1\n * @param  {number} p2\n * @param  {number} p3\n * @param  {number} t\n * @return {number}\n */\nfunction cubicDerivativeAt(p0, p1, p2, p3, t) {\n    var onet = 1 - t;\n    return 3 * (\n        ((p1 - p0) * onet + 2 * (p2 - p1) * t) * onet\n        + (p3 - p2) * t * t\n    );\n}\n\n/**\n * \n * @memberOf module:zrender/core/curve\n * @param  {number} p0\n * @param  {number} p1\n * @param  {number} p2\n * @param  {number} p3\n * @param  {number} val\n * @param  {Array.<number>} roots\n * @return {number} \n */\nfunction cubicRootAt(p0, p1, p2, p3, val, roots) {\n    // Evaluate roots of cubic functions\n    var a = p3 + 3 * (p1 - p2) - p0;\n    var b = 3 * (p2 - p1 * 2 + p0);\n    var c = 3 * (p1  - p0);\n    var d = p0 - val;\n\n    var A = b * b - 3 * a * c;\n    var B = b * c - 9 * a * d;\n    var C = c * c - 3 * b * d;\n\n    var n = 0;\n\n    if (isAroundZero(A) && isAroundZero(B)) {\n        if (isAroundZero(b)) {\n            roots[0] = 0;\n        }\n        else {\n            var t1 = -c / b;  //t1, t2, t3, b is not zero\n            if (t1 >= 0 && t1 <= 1) {\n                roots[n++] = t1;\n            }\n        }\n    }\n    else {\n        var disc = B * B - 4 * A * C;\n\n        if (isAroundZero(disc)) {\n            var K = B / A;\n            var t1 = -b / a + K;  // t1, a is not zero\n            var t2 = -K / 2;  // t2, t3\n            if (t1 >= 0 && t1 <= 1) {\n                roots[n++] = t1;\n            }\n            if (t2 >= 0 && t2 <= 1) {\n                roots[n++] = t2;\n            }\n        }\n        else if (disc > 0) {\n            var discSqrt = mathSqrt$2(disc);\n            var Y1 = A * b + 1.5 * a * (-B + discSqrt);\n            var Y2 = A * b + 1.5 * a * (-B - discSqrt);\n            if (Y1 < 0) {\n                Y1 = -mathPow(-Y1, ONE_THIRD);\n            }\n            else {\n                Y1 = mathPow(Y1, ONE_THIRD);\n            }\n            if (Y2 < 0) {\n                Y2 = -mathPow(-Y2, ONE_THIRD);\n            }\n            else {\n                Y2 = mathPow(Y2, ONE_THIRD);\n            }\n            var t1 = (-b - (Y1 + Y2)) / (3 * a);\n            if (t1 >= 0 && t1 <= 1) {\n                roots[n++] = t1;\n            }\n        }\n        else {\n            var T = (2 * A * b - 3 * a * B) / (2 * mathSqrt$2(A * A * A));\n            var theta = Math.acos(T) / 3;\n            var ASqrt = mathSqrt$2(A);\n            var tmp = Math.cos(theta);\n\n            var t1 = (-b - 2 * ASqrt * tmp) / (3 * a);\n            var t2 = (-b + ASqrt * (tmp + THREE_SQRT * Math.sin(theta))) / (3 * a);\n            var t3 = (-b + ASqrt * (tmp - THREE_SQRT * Math.sin(theta))) / (3 * a);\n            if (t1 >= 0 && t1 <= 1) {\n                roots[n++] = t1;\n            }\n            if (t2 >= 0 && t2 <= 1) {\n                roots[n++] = t2;\n            }\n            if (t3 >= 0 && t3 <= 1) {\n                roots[n++] = t3;\n            }\n        }\n    }\n    return n;\n}\n\n/**\n * \n * @memberOf module:zrender/core/curve\n * @param  {number} p0\n * @param  {number} p1\n * @param  {number} p2\n * @param  {number} p3\n * @param  {Array.<number>} extrema\n * @return {number} \n */\nfunction cubicExtrema(p0, p1, p2, p3, extrema) {\n    var b = 6 * p2 - 12 * p1 + 6 * p0;\n    var a = 9 * p1 + 3 * p3 - 3 * p0 - 9 * p2;\n    var c = 3 * p1 - 3 * p0;\n\n    var n = 0;\n    if (isAroundZero(a)) {\n        if (isNotAroundZero$1(b)) {\n            var t1 = -c / b;\n            if (t1 >= 0 && t1 <=1) {\n                extrema[n++] = t1;\n            }\n        }\n    }\n    else {\n        var disc = b * b - 4 * a * c;\n        if (isAroundZero(disc)) {\n            extrema[0] = -b / (2 * a);\n        }\n        else if (disc > 0) {\n            var discSqrt = mathSqrt$2(disc);\n            var t1 = (-b + discSqrt) / (2 * a);\n            var t2 = (-b - discSqrt) / (2 * a);\n            if (t1 >= 0 && t1 <= 1) {\n                extrema[n++] = t1;\n            }\n            if (t2 >= 0 && t2 <= 1) {\n                extrema[n++] = t2;\n            }\n        }\n    }\n    return n;\n}\n\n/**\n * \n * @memberOf module:zrender/core/curve\n * @param  {number} p0\n * @param  {number} p1\n * @param  {number} p2\n * @param  {number} p3\n * @param  {number} t\n * @param  {Array.<number>} out\n */\nfunction cubicSubdivide(p0, p1, p2, p3, t, out) {\n    var p01 = (p1 - p0) * t + p0;\n    var p12 = (p2 - p1) * t + p1;\n    var p23 = (p3 - p2) * t + p2;\n\n    var p012 = (p12 - p01) * t + p01;\n    var p123 = (p23 - p12) * t + p12;\n\n    var p0123 = (p123 - p012) * t + p012;\n    // Seg0\n    out[0] = p0;\n    out[1] = p01;\n    out[2] = p012;\n    out[3] = p0123;\n    // Seg1\n    out[4] = p0123;\n    out[5] = p123;\n    out[6] = p23;\n    out[7] = p3;\n}\n\n/**\n * \n * \n * @param {number} x0\n * @param {number} y0\n * @param {number} x1\n * @param {number} y1\n * @param {number} x2\n * @param {number} y2\n * @param {number} x3\n * @param {number} y3\n * @param {number} x\n * @param {number} y\n * @param {Array.<number>} [out] \n * @return {number}\n */\nfunction cubicProjectPoint(\n    x0, y0, x1, y1, x2, y2, x3, y3,\n    x, y, out\n) {\n    // http://pomax.github.io/bezierinfo/#projections\n    var t;\n    var interval = 0.005;\n    var d = Infinity;\n    var prev;\n    var next;\n    var d1;\n    var d2;\n\n    _v0[0] = x;\n    _v0[1] = y;\n\n    //  t \n    // PENDING\n    for (var _t = 0; _t < 1; _t += 0.05) {\n        _v1[0] = cubicAt(x0, x1, x2, x3, _t);\n        _v1[1] = cubicAt(y0, y1, y2, y3, _t);\n        d1 = distSquare(_v0, _v1);\n        if (d1 < d) {\n            t = _t;\n            d = d1;\n        }\n    }\n    d = Infinity;\n\n    // At most 32 iteration\n    for (var i = 0; i < 32; i++) {\n        if (interval < EPSILON_NUMERIC) {\n            break;\n        }\n        prev = t - interval;\n        next = t + interval;\n        // t - interval\n        _v1[0] = cubicAt(x0, x1, x2, x3, prev);\n        _v1[1] = cubicAt(y0, y1, y2, y3, prev);\n\n        d1 = distSquare(_v1, _v0);\n\n        if (prev >= 0 && d1 < d) {\n            t = prev;\n            d = d1;\n        }\n        else {\n            // t + interval\n            _v2[0] = cubicAt(x0, x1, x2, x3, next);\n            _v2[1] = cubicAt(y0, y1, y2, y3, next);\n            d2 = distSquare(_v2, _v0);\n\n            if (next <= 1 && d2 < d) {\n                t = next;\n                d = d2;\n            }\n            else {\n                interval *= 0.5;\n            }\n        }\n    }\n    // t\n    if (out) {\n        out[0] = cubicAt(x0, x1, x2, x3, t);\n        out[1] = cubicAt(y0, y1, y2, y3, t);\n    }\n    // console.log(interval, i);\n    return mathSqrt$2(d);\n}\n\n/**\n * \n * @param  {number} p0\n * @param  {number} p1\n * @param  {number} p2\n * @param  {number} t\n * @return {number}\n */\nfunction quadraticAt(p0, p1, p2, t) {\n    var onet = 1 - t;\n    return onet * (onet * p0 + 2 * t * p1) + t * t * p2;\n}\n\n/**\n * \n * @param  {number} p0\n * @param  {number} p1\n * @param  {number} p2\n * @param  {number} t\n * @return {number}\n */\nfunction quadraticDerivativeAt(p0, p1, p2, t) {\n    return 2 * ((1 - t) * (p1 - p0) + t * (p2 - p1));\n}\n\n/**\n * \n * @param  {number} p0\n * @param  {number} p1\n * @param  {number} p2\n * @param  {number} t\n * @param  {Array.<number>} roots\n * @return {number} \n */\nfunction quadraticRootAt(p0, p1, p2, val, roots) {\n    var a = p0 - 2 * p1 + p2;\n    var b = 2 * (p1 - p0);\n    var c = p0 - val;\n\n    var n = 0;\n    if (isAroundZero(a)) {\n        if (isNotAroundZero$1(b)) {\n            var t1 = -c / b;\n            if (t1 >= 0 && t1 <= 1) {\n                roots[n++] = t1;\n            }\n        }\n    }\n    else {\n        var disc = b * b - 4 * a * c;\n        if (isAroundZero(disc)) {\n            var t1 = -b / (2 * a);\n            if (t1 >= 0 && t1 <= 1) {\n                roots[n++] = t1;\n            }\n        }\n        else if (disc > 0) {\n            var discSqrt = mathSqrt$2(disc);\n            var t1 = (-b + discSqrt) / (2 * a);\n            var t2 = (-b - discSqrt) / (2 * a);\n            if (t1 >= 0 && t1 <= 1) {\n                roots[n++] = t1;\n            }\n            if (t2 >= 0 && t2 <= 1) {\n                roots[n++] = t2;\n            }\n        }\n    }\n    return n;\n}\n\n/**\n * \n * @memberOf module:zrender/core/curve\n * @param  {number} p0\n * @param  {number} p1\n * @param  {number} p2\n * @return {number}\n */\nfunction quadraticExtremum(p0, p1, p2) {\n    var divider = p0 + p2 - 2 * p1;\n    if (divider === 0) {\n        // p1 is center of p0 and p2\n        return 0.5;\n    }\n    else {\n        return (p0 - p1) / divider;\n    }\n}\n\n/**\n * \n * @memberOf module:zrender/core/curve\n * @param  {number} p0\n * @param  {number} p1\n * @param  {number} p2\n * @param  {number} t\n * @param  {Array.<number>} out\n */\nfunction quadraticSubdivide(p0, p1, p2, t, out) {\n    var p01 = (p1 - p0) * t + p0;\n    var p12 = (p2 - p1) * t + p1;\n    var p012 = (p12 - p01) * t + p01;\n\n    // Seg0\n    out[0] = p0;\n    out[1] = p01;\n    out[2] = p012;\n\n    // Seg1\n    out[3] = p012;\n    out[4] = p12;\n    out[5] = p2;\n}\n\n/**\n * \n * \n * @param {number} x0\n * @param {number} y0\n * @param {number} x1\n * @param {number} y1\n * @param {number} x2\n * @param {number} y2\n * @param {number} x\n * @param {number} y\n * @param {Array.<number>} out \n * @return {number}\n */\nfunction quadraticProjectPoint(\n    x0, y0, x1, y1, x2, y2,\n    x, y, out\n) {\n    // http://pomax.github.io/bezierinfo/#projections\n    var t;\n    var interval = 0.005;\n    var d = Infinity;\n\n    _v0[0] = x;\n    _v0[1] = y;\n\n    //  t \n    // PENDING\n    for (var _t = 0; _t < 1; _t += 0.05) {\n        _v1[0] = quadraticAt(x0, x1, x2, _t);\n        _v1[1] = quadraticAt(y0, y1, y2, _t);\n        var d1 = distSquare(_v0, _v1);\n        if (d1 < d) {\n            t = _t;\n            d = d1;\n        }\n    }\n    d = Infinity;\n\n    // At most 32 iteration\n    for (var i = 0; i < 32; i++) {\n        if (interval < EPSILON_NUMERIC) {\n            break;\n        }\n        var prev = t - interval;\n        var next = t + interval;\n        // t - interval\n        _v1[0] = quadraticAt(x0, x1, x2, prev);\n        _v1[1] = quadraticAt(y0, y1, y2, prev);\n\n        var d1 = distSquare(_v1, _v0);\n\n        if (prev >= 0 && d1 < d) {\n            t = prev;\n            d = d1;\n        }\n        else {\n            // t + interval\n            _v2[0] = quadraticAt(x0, x1, x2, next);\n            _v2[1] = quadraticAt(y0, y1, y2, next);\n            var d2 = distSquare(_v2, _v0);\n            if (next <= 1 && d2 < d) {\n                t = next;\n                d = d2;\n            }\n            else {\n                interval *= 0.5;\n            }\n        }\n    }\n    // t\n    if (out) {\n        out[0] = quadraticAt(x0, x1, x2, t);\n        out[1] = quadraticAt(y0, y1, y2, t);\n    }\n    // console.log(interval, i);\n    return mathSqrt$2(d);\n}\n\n/**\n * @author Yi Shen(https://github.com/pissang)\n */\n\nvar mathMin$3 = Math.min;\nvar mathMax$3 = Math.max;\nvar mathSin$2 = Math.sin;\nvar mathCos$2 = Math.cos;\nvar PI2 = Math.PI * 2;\n\nvar start = create();\nvar end = create();\nvar extremity = create();\n\n/**\n * `min``max`\n * @module zrender/core/bbox\n * @param {Array<Object>} points \n * @param {number} min\n * @param {number} max\n */\nfunction fromPoints(points, min$$1, max$$1) {\n    if (points.length === 0) {\n        return;\n    }\n    var p = points[0];\n    var left = p[0];\n    var right = p[0];\n    var top = p[1];\n    var bottom = p[1];\n    var i;\n\n    for (i = 1; i < points.length; i++) {\n        p = points[i];\n        left = mathMin$3(left, p[0]);\n        right = mathMax$3(right, p[0]);\n        top = mathMin$3(top, p[1]);\n        bottom = mathMax$3(bottom, p[1]);\n    }\n\n    min$$1[0] = left;\n    min$$1[1] = top;\n    max$$1[0] = right;\n    max$$1[1] = bottom;\n}\n\n/**\n * @memberOf module:zrender/core/bbox\n * @param {number} x0\n * @param {number} y0\n * @param {number} x1\n * @param {number} y1\n * @param {Array.<number>} min\n * @param {Array.<number>} max\n */\nfunction fromLine(x0, y0, x1, y1, min$$1, max$$1) {\n    min$$1[0] = mathMin$3(x0, x1);\n    min$$1[1] = mathMin$3(y0, y1);\n    max$$1[0] = mathMax$3(x0, x1);\n    max$$1[1] = mathMax$3(y0, y1);\n}\n\nvar xDim = [];\nvar yDim = [];\n/**\n * (p0, p1, p2, p3)`min``max`\n * @memberOf module:zrender/core/bbox\n * @param {number} x0\n * @param {number} y0\n * @param {number} x1\n * @param {number} y1\n * @param {number} x2\n * @param {number} y2\n * @param {number} x3\n * @param {number} y3\n * @param {Array.<number>} min\n * @param {Array.<number>} max\n */\nfunction fromCubic(\n    x0, y0, x1, y1, x2, y2, x3, y3, min$$1, max$$1\n) {\n    var cubicExtrema$$1 = cubicExtrema;\n    var cubicAt$$1 = cubicAt;\n    var i;\n    var n = cubicExtrema$$1(x0, x1, x2, x3, xDim);\n    min$$1[0] = Infinity;\n    min$$1[1] = Infinity;\n    max$$1[0] = -Infinity;\n    max$$1[1] = -Infinity;\n\n    for (i = 0; i < n; i++) {\n        var x = cubicAt$$1(x0, x1, x2, x3, xDim[i]);\n        min$$1[0] = mathMin$3(x, min$$1[0]);\n        max$$1[0] = mathMax$3(x, max$$1[0]);\n    }\n    n = cubicExtrema$$1(y0, y1, y2, y3, yDim);\n    for (i = 0; i < n; i++) {\n        var y = cubicAt$$1(y0, y1, y2, y3, yDim[i]);\n        min$$1[1] = mathMin$3(y, min$$1[1]);\n        max$$1[1] = mathMax$3(y, max$$1[1]);\n    }\n\n    min$$1[0] = mathMin$3(x0, min$$1[0]);\n    max$$1[0] = mathMax$3(x0, max$$1[0]);\n    min$$1[0] = mathMin$3(x3, min$$1[0]);\n    max$$1[0] = mathMax$3(x3, max$$1[0]);\n\n    min$$1[1] = mathMin$3(y0, min$$1[1]);\n    max$$1[1] = mathMax$3(y0, max$$1[1]);\n    min$$1[1] = mathMin$3(y3, min$$1[1]);\n    max$$1[1] = mathMax$3(y3, max$$1[1]);\n}\n\n/**\n * (p0, p1, p2)`min``max`\n * @memberOf module:zrender/core/bbox\n * @param {number} x0\n * @param {number} y0\n * @param {number} x1\n * @param {number} y1\n * @param {number} x2\n * @param {number} y2\n * @param {Array.<number>} min\n * @param {Array.<number>} max\n */\nfunction fromQuadratic(x0, y0, x1, y1, x2, y2, min$$1, max$$1) {\n    var quadraticExtremum$$1 = quadraticExtremum;\n    var quadraticAt$$1 = quadraticAt;\n    // Find extremities, where derivative in x dim or y dim is zero\n    var tx =\n        mathMax$3(\n            mathMin$3(quadraticExtremum$$1(x0, x1, x2), 1), 0\n        );\n    var ty =\n        mathMax$3(\n            mathMin$3(quadraticExtremum$$1(y0, y1, y2), 1), 0\n        );\n\n    var x = quadraticAt$$1(x0, x1, x2, tx);\n    var y = quadraticAt$$1(y0, y1, y2, ty);\n\n    min$$1[0] = mathMin$3(x0, x2, x);\n    min$$1[1] = mathMin$3(y0, y2, y);\n    max$$1[0] = mathMax$3(x0, x2, x);\n    max$$1[1] = mathMax$3(y0, y2, y);\n}\n\n/**\n * `min``max`\n * @method\n * @memberOf module:zrender/core/bbox\n * @param {number} x\n * @param {number} y\n * @param {number} rx\n * @param {number} ry\n * @param {number} startAngle\n * @param {number} endAngle\n * @param {number} anticlockwise\n * @param {Array.<number>} min\n * @param {Array.<number>} max\n */\nfunction fromArc(\n    x, y, rx, ry, startAngle, endAngle, anticlockwise, min$$1, max$$1\n) {\n    var vec2Min = min;\n    var vec2Max = max;\n\n    var diff = Math.abs(startAngle - endAngle);\n\n\n    if (diff % PI2 < 1e-4 && diff > 1e-4) {\n        // Is a circle\n        min$$1[0] = x - rx;\n        min$$1[1] = y - ry;\n        max$$1[0] = x + rx;\n        max$$1[1] = y + ry;\n        return;\n    }\n\n    start[0] = mathCos$2(startAngle) * rx + x;\n    start[1] = mathSin$2(startAngle) * ry + y;\n\n    end[0] = mathCos$2(endAngle) * rx + x;\n    end[1] = mathSin$2(endAngle) * ry + y;\n\n    vec2Min(min$$1, start, end);\n    vec2Max(max$$1, start, end);\n\n    // Thresh to [0, Math.PI * 2]\n    startAngle = startAngle % (PI2);\n    if (startAngle < 0) {\n        startAngle = startAngle + PI2;\n    }\n    endAngle = endAngle % (PI2);\n    if (endAngle < 0) {\n        endAngle = endAngle + PI2;\n    }\n\n    if (startAngle > endAngle && !anticlockwise) {\n        endAngle += PI2;\n    }\n    else if (startAngle < endAngle && anticlockwise) {\n        startAngle += PI2;\n    }\n    if (anticlockwise) {\n        var tmp = endAngle;\n        endAngle = startAngle;\n        startAngle = tmp;\n    }\n\n    // var number = 0;\n    // var step = (anticlockwise ? -Math.PI : Math.PI) / 2;\n    for (var angle = 0; angle < endAngle; angle += Math.PI / 2) {\n        if (angle > startAngle) {\n            extremity[0] = mathCos$2(angle) * rx + x;\n            extremity[1] = mathSin$2(angle) * ry + y;\n\n            vec2Min(min$$1, extremity, min$$1);\n            vec2Max(max$$1, extremity, max$$1);\n        }\n    }\n}\n\n/**\n * Path `buildPath``ctx`, pathpathCommands\n *  isInsidePath boundingRect\n *\n * @module zrender/core/PathProxy\n * @author Yi Shen (http://www.github.com/pissang)\n */\n\n// TODO getTotalLength, getPointAtLength\n\nvar CMD = {\n    M: 1,\n    L: 2,\n    C: 3,\n    Q: 4,\n    A: 5,\n    Z: 6,\n    // Rect\n    R: 7\n};\n\n// var CMD_MEM_SIZE = {\n//     M: 3,\n//     L: 3,\n//     C: 7,\n//     Q: 5,\n//     A: 9,\n//     R: 5,\n//     Z: 1\n// };\n\nvar min$1 = [];\nvar max$1 = [];\nvar min2 = [];\nvar max2 = [];\nvar mathMin$2 = Math.min;\nvar mathMax$2 = Math.max;\nvar mathCos$1 = Math.cos;\nvar mathSin$1 = Math.sin;\nvar mathSqrt$1 = Math.sqrt;\nvar mathAbs = Math.abs;\n\nvar hasTypedArray = typeof Float32Array != 'undefined';\n\n/**\n * @alias module:zrender/core/PathProxy\n * @constructor\n */\nvar PathProxy = function (notSaveData) {\n\n    this._saveData = !(notSaveData || false);\n\n    if (this._saveData) {\n        /**\n         * Path data. Stored as flat array\n         * @type {Array.<Object>}\n         */\n        this.data = [];\n    }\n\n    this._ctx = null;\n};\n\n/**\n * Path\n * @return {Object}\n */\nPathProxy.prototype = {\n\n    constructor: PathProxy,\n\n    _xi: 0,\n    _yi: 0,\n\n    _x0: 0,\n    _y0: 0,\n    // Unit x, Unit y. Provide for avoiding drawing that too short line segment\n    _ux: 0,\n    _uy: 0,\n\n    _len: 0,\n\n    _lineDash: null,\n\n    _dashOffset: 0,\n\n    _dashIdx: 0,\n\n    _dashSum: 0,\n\n    /**\n     * @readOnly\n     */\n    setScale: function (sx, sy) {\n        this._ux = mathAbs(1 / devicePixelRatio / sx) || 0;\n        this._uy = mathAbs(1 / devicePixelRatio / sy) || 0;\n    },\n\n    getContext: function () {\n        return this._ctx;\n    },\n\n    /**\n     * @param  {CanvasRenderingContext2D} ctx\n     * @return {module:zrender/core/PathProxy}\n     */\n    beginPath: function (ctx) {\n\n        this._ctx = ctx;\n\n        ctx && ctx.beginPath();\n\n        ctx && (this.dpr = ctx.dpr);\n\n        // Reset\n        if (this._saveData) {\n            this._len = 0;\n        }\n\n        if (this._lineDash) {\n            this._lineDash = null;\n\n            this._dashOffset = 0;\n        }\n\n        return this;\n    },\n\n    /**\n     * @param  {number} x\n     * @param  {number} y\n     * @return {module:zrender/core/PathProxy}\n     */\n    moveTo: function (x, y) {\n        this.addData(CMD.M, x, y);\n        this._ctx && this._ctx.moveTo(x, y);\n\n        // x0, y0, xi, yi  _dashedXXXXTo \n        // xi, yi , x0, y0  closePath \n        //  beginPath  lineTo x0, y0 \n        //  lineTo dashed line  IE10- \n        this._x0 = x;\n        this._y0 = y;\n\n        this._xi = x;\n        this._yi = y;\n\n        return this;\n    },\n\n    /**\n     * @param  {number} x\n     * @param  {number} y\n     * @return {module:zrender/core/PathProxy}\n     */\n    lineTo: function (x, y) {\n        var exceedUnit = mathAbs(x - this._xi) > this._ux\n            || mathAbs(y - this._yi) > this._uy\n            // Force draw the first segment\n            || this._len < 5;\n\n        this.addData(CMD.L, x, y);\n\n        if (this._ctx && exceedUnit) {\n            this._needsDash() ? this._dashedLineTo(x, y)\n                : this._ctx.lineTo(x, y);\n        }\n        if (exceedUnit) {\n            this._xi = x;\n            this._yi = y;\n        }\n\n        return this;\n    },\n\n    /**\n     * @param  {number} x1\n     * @param  {number} y1\n     * @param  {number} x2\n     * @param  {number} y2\n     * @param  {number} x3\n     * @param  {number} y3\n     * @return {module:zrender/core/PathProxy}\n     */\n    bezierCurveTo: function (x1, y1, x2, y2, x3, y3) {\n        this.addData(CMD.C, x1, y1, x2, y2, x3, y3);\n        if (this._ctx) {\n            this._needsDash() ? this._dashedBezierTo(x1, y1, x2, y2, x3, y3)\n                : this._ctx.bezierCurveTo(x1, y1, x2, y2, x3, y3);\n        }\n        this._xi = x3;\n        this._yi = y3;\n        return this;\n    },\n\n    /**\n     * @param  {number} x1\n     * @param  {number} y1\n     * @param  {number} x2\n     * @param  {number} y2\n     * @return {module:zrender/core/PathProxy}\n     */\n    quadraticCurveTo: function (x1, y1, x2, y2) {\n        this.addData(CMD.Q, x1, y1, x2, y2);\n        if (this._ctx) {\n            this._needsDash() ? this._dashedQuadraticTo(x1, y1, x2, y2)\n                : this._ctx.quadraticCurveTo(x1, y1, x2, y2);\n        }\n        this._xi = x2;\n        this._yi = y2;\n        return this;\n    },\n\n    /**\n     * @param  {number} cx\n     * @param  {number} cy\n     * @param  {number} r\n     * @param  {number} startAngle\n     * @param  {number} endAngle\n     * @param  {boolean} anticlockwise\n     * @return {module:zrender/core/PathProxy}\n     */\n    arc: function (cx, cy, r, startAngle, endAngle, anticlockwise) {\n        this.addData(\n            CMD.A, cx, cy, r, r, startAngle, endAngle - startAngle, 0, anticlockwise ? 0 : 1\n        );\n        this._ctx && this._ctx.arc(cx, cy, r, startAngle, endAngle, anticlockwise);\n\n        this._xi = mathCos$1(endAngle) * r + cx;\n        this._yi = mathSin$1(endAngle) * r + cx;\n        return this;\n    },\n\n    // TODO\n    arcTo: function (x1, y1, x2, y2, radius) {\n        if (this._ctx) {\n            this._ctx.arcTo(x1, y1, x2, y2, radius);\n        }\n        return this;\n    },\n\n    // TODO\n    rect: function (x, y, w, h) {\n        this._ctx && this._ctx.rect(x, y, w, h);\n        this.addData(CMD.R, x, y, w, h);\n        return this;\n    },\n\n    /**\n     * @return {module:zrender/core/PathProxy}\n     */\n    closePath: function () {\n        this.addData(CMD.Z);\n\n        var ctx = this._ctx;\n        var x0 = this._x0;\n        var y0 = this._y0;\n        if (ctx) {\n            this._needsDash() && this._dashedLineTo(x0, y0);\n            ctx.closePath();\n        }\n\n        this._xi = x0;\n        this._yi = y0;\n        return this;\n    },\n\n    /**\n     * Context  rebuildPath  fill\n     * stroke \n     * @param {CanvasRenderingContext2D} ctx\n     * @return {module:zrender/core/PathProxy}\n     */\n    fill: function (ctx) {\n        ctx && ctx.fill();\n        this.toStatic();\n    },\n\n    /**\n     * @param {CanvasRenderingContext2D} ctx\n     * @return {module:zrender/core/PathProxy}\n     */\n    stroke: function (ctx) {\n        ctx && ctx.stroke();\n        this.toStatic();\n    },\n\n    /**\n     * \n     * Must be invoked before all other path drawing methods\n     * @return {module:zrender/core/PathProxy}\n     */\n    setLineDash: function (lineDash) {\n        if (lineDash instanceof Array) {\n            this._lineDash = lineDash;\n\n            this._dashIdx = 0;\n\n            var lineDashSum = 0;\n            for (var i = 0; i < lineDash.length; i++) {\n                lineDashSum += lineDash[i];\n            }\n            this._dashSum = lineDashSum;\n        }\n        return this;\n    },\n\n    /**\n     * \n     * Must be invoked before all other path drawing methods\n     * @return {module:zrender/core/PathProxy}\n     */\n    setLineDashOffset: function (offset) {\n        this._dashOffset = offset;\n        return this;\n    },\n\n    /**\n     *\n     * @return {boolean}\n     */\n    len: function () {\n        return this._len;\n    },\n\n    /**\n     *  Path \n     */\n    setData: function (data) {\n\n        var len$$1 = data.length;\n\n        if (! (this.data && this.data.length == len$$1) && hasTypedArray) {\n            this.data = new Float32Array(len$$1);\n        }\n\n        for (var i = 0; i < len$$1; i++) {\n            this.data[i] = data[i];\n        }\n\n        this._len = len$$1;\n    },\n\n    /**\n     * \n     * @param {module:zrender/core/PathProxy|Array.<module:zrender/core/PathProxy>} path\n     */\n    appendPath: function (path) {\n        if (!(path instanceof Array)) {\n            path = [path];\n        }\n        var len$$1 = path.length;\n        var appendSize = 0;\n        var offset = this._len;\n        for (var i = 0; i < len$$1; i++) {\n            appendSize += path[i].len();\n        }\n        if (hasTypedArray && (this.data instanceof Float32Array)) {\n            this.data = new Float32Array(offset + appendSize);\n        }\n        for (var i = 0; i < len$$1; i++) {\n            var appendPathData = path[i].data;\n            for (var k = 0; k < appendPathData.length; k++) {\n                this.data[offset++] = appendPathData[k];\n            }\n        }\n        this._len = offset;\n    },\n\n    /**\n     *  Path \n     * \n     */\n    addData: function (cmd) {\n        if (!this._saveData) {\n            return;\n        }\n\n        var data = this.data;\n        if (this._len + arguments.length > data.length) {\n            //  Float32Array\n            // \n            this._expandData();\n            data = this.data;\n        }\n        for (var i = 0; i < arguments.length; i++) {\n            data[this._len++] = arguments[i];\n        }\n\n        this._prevCmd = cmd;\n    },\n\n    _expandData: function () {\n        // Only if data is Float32Array\n        if (!(this.data instanceof Array)) {\n            var newData = [];\n            for (var i = 0; i < this._len; i++) {\n                newData[i] = this.data[i];\n            }\n            this.data = newData;\n        }\n    },\n\n    /**\n     * If needs js implemented dashed line\n     * @return {boolean}\n     * @private\n     */\n    _needsDash: function () {\n        return this._lineDash;\n    },\n\n    _dashedLineTo: function (x1, y1) {\n        var dashSum = this._dashSum;\n        var offset = this._dashOffset;\n        var lineDash = this._lineDash;\n        var ctx = this._ctx;\n\n        var x0 = this._xi;\n        var y0 = this._yi;\n        var dx = x1 - x0;\n        var dy = y1 - y0;\n        var dist$$1 = mathSqrt$1(dx * dx + dy * dy);\n        var x = x0;\n        var y = y0;\n        var dash;\n        var nDash = lineDash.length;\n        var idx;\n        dx /= dist$$1;\n        dy /= dist$$1;\n\n        if (offset < 0) {\n            // Convert to positive offset\n            offset = dashSum + offset;\n        }\n        offset %= dashSum;\n        x -= offset * dx;\n        y -= offset * dy;\n\n        while ((dx > 0 && x <= x1) || (dx < 0 && x >= x1)\n        || (dx == 0 && ((dy > 0 && y <= y1) || (dy < 0 && y >= y1)))) {\n            idx = this._dashIdx;\n            dash = lineDash[idx];\n            x += dx * dash;\n            y += dy * dash;\n            this._dashIdx = (idx + 1) % nDash;\n            // Skip positive offset\n            if ((dx > 0 && x < x0) || (dx < 0 && x > x0) || (dy > 0 && y < y0) || (dy < 0 && y > y0)) {\n                continue;\n            }\n            ctx[idx % 2 ? 'moveTo' : 'lineTo'](\n                dx >= 0 ? mathMin$2(x, x1) : mathMax$2(x, x1),\n                dy >= 0 ? mathMin$2(y, y1) : mathMax$2(y, y1)\n            );\n        }\n        // Offset for next lineTo\n        dx = x - x1;\n        dy = y - y1;\n        this._dashOffset = -mathSqrt$1(dx * dx + dy * dy);\n    },\n\n    // Not accurate dashed line to\n    _dashedBezierTo: function (x1, y1, x2, y2, x3, y3) {\n        var dashSum = this._dashSum;\n        var offset = this._dashOffset;\n        var lineDash = this._lineDash;\n        var ctx = this._ctx;\n\n        var x0 = this._xi;\n        var y0 = this._yi;\n        var t;\n        var dx;\n        var dy;\n        var cubicAt$$1 = cubicAt;\n        var bezierLen = 0;\n        var idx = this._dashIdx;\n        var nDash = lineDash.length;\n\n        var x;\n        var y;\n\n        var tmpLen = 0;\n\n        if (offset < 0) {\n            // Convert to positive offset\n            offset = dashSum + offset;\n        }\n        offset %= dashSum;\n        // Bezier approx length\n        for (t = 0; t < 1; t += 0.1) {\n            dx = cubicAt$$1(x0, x1, x2, x3, t + 0.1)\n                - cubicAt$$1(x0, x1, x2, x3, t);\n            dy = cubicAt$$1(y0, y1, y2, y3, t + 0.1)\n                - cubicAt$$1(y0, y1, y2, y3, t);\n            bezierLen += mathSqrt$1(dx * dx + dy * dy);\n        }\n\n        // Find idx after add offset\n        for (; idx < nDash; idx++) {\n            tmpLen += lineDash[idx];\n            if (tmpLen > offset) {\n                break;\n            }\n        }\n        t = (tmpLen - offset) / bezierLen;\n\n        while (t <= 1) {\n\n            x = cubicAt$$1(x0, x1, x2, x3, t);\n            y = cubicAt$$1(y0, y1, y2, y3, t);\n\n            // Use line to approximate dashed bezier\n            // Bad result if dash is long\n            idx % 2 ? ctx.moveTo(x, y)\n                : ctx.lineTo(x, y);\n\n            t += lineDash[idx] / bezierLen;\n\n            idx = (idx + 1) % nDash;\n        }\n\n        // Finish the last segment and calculate the new offset\n        (idx % 2 !== 0) && ctx.lineTo(x3, y3);\n        dx = x3 - x;\n        dy = y3 - y;\n        this._dashOffset = -mathSqrt$1(dx * dx + dy * dy);\n    },\n\n    _dashedQuadraticTo: function (x1, y1, x2, y2) {\n        // Convert quadratic to cubic using degree elevation\n        var x3 = x2;\n        var y3 = y2;\n        x2 = (x2 + 2 * x1) / 3;\n        y2 = (y2 + 2 * y1) / 3;\n        x1 = (this._xi + 2 * x1) / 3;\n        y1 = (this._yi + 2 * y1) / 3;\n\n        this._dashedBezierTo(x1, y1, x2, y2, x3, y3);\n    },\n\n    /**\n     *  Float32Array \n     * Convert dynamic array to static Float32Array\n     */\n    toStatic: function () {\n        var data = this.data;\n        if (data instanceof Array) {\n            data.length = this._len;\n            if (hasTypedArray) {\n                this.data = new Float32Array(data);\n            }\n        }\n    },\n\n    /**\n     * @return {module:zrender/core/BoundingRect}\n     */\n    getBoundingRect: function () {\n        min$1[0] = min$1[1] = min2[0] = min2[1] = Number.MAX_VALUE;\n        max$1[0] = max$1[1] = max2[0] = max2[1] = -Number.MAX_VALUE;\n\n        var data = this.data;\n        var xi = 0;\n        var yi = 0;\n        var x0 = 0;\n        var y0 = 0;\n\n        for (var i = 0; i < data.length;) {\n            var cmd = data[i++];\n\n            if (i == 1) {\n                //  L, C, Q\n                //  previous point  point\n                //\n                //  Arc \n                xi = data[i];\n                yi = data[i + 1];\n\n                x0 = xi;\n                y0 = yi;\n            }\n\n            switch (cmd) {\n                case CMD.M:\n                    // moveTo  subpath, \n                    //  closePath \n                    x0 = data[i++];\n                    y0 = data[i++];\n                    xi = x0;\n                    yi = y0;\n                    min2[0] = x0;\n                    min2[1] = y0;\n                    max2[0] = x0;\n                    max2[1] = y0;\n                    break;\n                case CMD.L:\n                    fromLine(xi, yi, data[i], data[i + 1], min2, max2);\n                    xi = data[i++];\n                    yi = data[i++];\n                    break;\n                case CMD.C:\n                    fromCubic(\n                        xi, yi, data[i++], data[i++], data[i++], data[i++], data[i], data[i + 1],\n                        min2, max2\n                    );\n                    xi = data[i++];\n                    yi = data[i++];\n                    break;\n                case CMD.Q:\n                    fromQuadratic(\n                        xi, yi, data[i++], data[i++], data[i], data[i + 1],\n                        min2, max2\n                    );\n                    xi = data[i++];\n                    yi = data[i++];\n                    break;\n                case CMD.A:\n                    // TODO Arc \n                    var cx = data[i++];\n                    var cy = data[i++];\n                    var rx = data[i++];\n                    var ry = data[i++];\n                    var startAngle = data[i++];\n                    var endAngle = data[i++] + startAngle;\n                    // TODO Arc \n                    var psi = data[i++];\n                    var anticlockwise = 1 - data[i++];\n\n                    if (i == 1) {\n                        //  arc \n                        // \n                        x0 = mathCos$1(startAngle) * rx + cx;\n                        y0 = mathSin$1(startAngle) * ry + cy;\n                    }\n\n                    fromArc(\n                        cx, cy, rx, ry, startAngle, endAngle,\n                        anticlockwise, min2, max2\n                    );\n\n                    xi = mathCos$1(endAngle) * rx + cx;\n                    yi = mathSin$1(endAngle) * ry + cy;\n                    break;\n                case CMD.R:\n                    x0 = xi = data[i++];\n                    y0 = yi = data[i++];\n                    var width = data[i++];\n                    var height = data[i++];\n                    // Use fromLine\n                    fromLine(x0, y0, x0 + width, y0 + height, min2, max2);\n                    break;\n                case CMD.Z:\n                    xi = x0;\n                    yi = y0;\n                    break;\n            }\n\n            // Union\n            min(min$1, min$1, min2);\n            max(max$1, max$1, max2);\n        }\n\n        // No data\n        if (i === 0) {\n            min$1[0] = min$1[1] = max$1[0] = max$1[1] = 0;\n        }\n\n        return new BoundingRect(\n            min$1[0], min$1[1], max$1[0] - min$1[0], max$1[1] - min$1[1]\n        );\n    },\n\n    /**\n     * Rebuild path from current data\n     * Rebuild path will not consider javascript implemented line dash.\n     * @param {CanvasRenderingContext2D} ctx\n     */\n    rebuildPath: function (ctx) {\n        var d = this.data;\n        var x0, y0;\n        var xi, yi;\n        var x, y;\n        var ux = this._ux;\n        var uy = this._uy;\n        var len$$1 = this._len;\n        for (var i = 0; i < len$$1;) {\n            var cmd = d[i++];\n\n            if (i == 1) {\n                //  L, C, Q\n                //  previous point  point\n                //\n                //  Arc \n                xi = d[i];\n                yi = d[i + 1];\n\n                x0 = xi;\n                y0 = yi;\n            }\n            switch (cmd) {\n                case CMD.M:\n                    x0 = xi = d[i++];\n                    y0 = yi = d[i++];\n                    ctx.moveTo(xi, yi);\n                    break;\n                case CMD.L:\n                    x = d[i++];\n                    y = d[i++];\n                    // Not draw too small seg between\n                    if (mathAbs(x - xi) > ux || mathAbs(y - yi) > uy || i === len$$1 - 1) {\n                        ctx.lineTo(x, y);\n                        xi = x;\n                        yi = y;\n                    }\n                    break;\n                case CMD.C:\n                    ctx.bezierCurveTo(\n                        d[i++], d[i++], d[i++], d[i++], d[i++], d[i++]\n                    );\n                    xi = d[i - 2];\n                    yi = d[i - 1];\n                    break;\n                case CMD.Q:\n                    ctx.quadraticCurveTo(d[i++], d[i++], d[i++], d[i++]);\n                    xi = d[i - 2];\n                    yi = d[i - 1];\n                    break;\n                case CMD.A:\n                    var cx = d[i++];\n                    var cy = d[i++];\n                    var rx = d[i++];\n                    var ry = d[i++];\n                    var theta = d[i++];\n                    var dTheta = d[i++];\n                    var psi = d[i++];\n                    var fs = d[i++];\n                    var r = (rx > ry) ? rx : ry;\n                    var scaleX = (rx > ry) ? 1 : rx / ry;\n                    var scaleY = (rx > ry) ? ry / rx : 1;\n                    var isEllipse = Math.abs(rx - ry) > 1e-3;\n                    var endAngle = theta + dTheta;\n                    if (isEllipse) {\n                        ctx.translate(cx, cy);\n                        ctx.rotate(psi);\n                        ctx.scale(scaleX, scaleY);\n                        ctx.arc(0, 0, r, theta, endAngle, 1 - fs);\n                        ctx.scale(1 / scaleX, 1 / scaleY);\n                        ctx.rotate(-psi);\n                        ctx.translate(-cx, -cy);\n                    }\n                    else {\n                        ctx.arc(cx, cy, r, theta, endAngle, 1 - fs);\n                    }\n\n                    if (i == 1) {\n                        //  arc \n                        // \n                        x0 = mathCos$1(theta) * rx + cx;\n                        y0 = mathSin$1(theta) * ry + cy;\n                    }\n                    xi = mathCos$1(endAngle) * rx + cx;\n                    yi = mathSin$1(endAngle) * ry + cy;\n                    break;\n                case CMD.R:\n                    x0 = xi = d[i];\n                    y0 = yi = d[i + 1];\n                    ctx.rect(d[i++], d[i++], d[i++], d[i++]);\n                    break;\n                case CMD.Z:\n                    ctx.closePath();\n                    xi = x0;\n                    yi = y0;\n            }\n        }\n    }\n};\n\nPathProxy.CMD = CMD;\n\n/**\n * \n * @param  {number}  x0\n * @param  {number}  y0\n * @param  {number}  x1\n * @param  {number}  y1\n * @param  {number}  lineWidth\n * @param  {number}  x\n * @param  {number}  y\n * @return {boolean}\n */\nfunction containStroke$1(x0, y0, x1, y1, lineWidth, x, y) {\n    if (lineWidth === 0) {\n        return false;\n    }\n    var _l = lineWidth;\n    var _a = 0;\n    var _b = x0;\n    // Quick reject\n    if (\n        (y > y0 + _l && y > y1 + _l)\n        || (y < y0 - _l && y < y1 - _l)\n        || (x > x0 + _l && x > x1 + _l)\n        || (x < x0 - _l && x < x1 - _l)\n    ) {\n        return false;\n    }\n\n    if (x0 !== x1) {\n        _a = (y0 - y1) / (x0 - x1);\n        _b = (x0 * y1 - x1 * y0) / (x0 - x1) ;\n    }\n    else {\n        return Math.abs(x - x0) <= _l / 2;\n    }\n    var tmp = _a * x - y + _b;\n    var _s = tmp * tmp / (_a * _a + 1);\n    return _s <= _l / 2 * _l / 2;\n}\n\n/**\n * \n * @param  {number}  x0\n * @param  {number}  y0\n * @param  {number}  x1\n * @param  {number}  y1\n * @param  {number}  x2\n * @param  {number}  y2\n * @param  {number}  x3\n * @param  {number}  y3\n * @param  {number}  lineWidth\n * @param  {number}  x\n * @param  {number}  y\n * @return {boolean}\n */\nfunction containStroke$2(x0, y0, x1, y1, x2, y2, x3, y3, lineWidth, x, y) {\n    if (lineWidth === 0) {\n        return false;\n    }\n    var _l = lineWidth;\n    // Quick reject\n    if (\n        (y > y0 + _l && y > y1 + _l && y > y2 + _l && y > y3 + _l)\n        || (y < y0 - _l && y < y1 - _l && y < y2 - _l && y < y3 - _l)\n        || (x > x0 + _l && x > x1 + _l && x > x2 + _l && x > x3 + _l)\n        || (x < x0 - _l && x < x1 - _l && x < x2 - _l && x < x3 - _l)\n    ) {\n        return false;\n    }\n    var d = cubicProjectPoint(\n        x0, y0, x1, y1, x2, y2, x3, y3,\n        x, y, null\n    );\n    return d <= _l / 2;\n}\n\n/**\n * \n * @param  {number}  x0\n * @param  {number}  y0\n * @param  {number}  x1\n * @param  {number}  y1\n * @param  {number}  x2\n * @param  {number}  y2\n * @param  {number}  lineWidth\n * @param  {number}  x\n * @param  {number}  y\n * @return {boolean}\n */\nfunction containStroke$3(x0, y0, x1, y1, x2, y2, lineWidth, x, y) {\n    if (lineWidth === 0) {\n        return false;\n    }\n    var _l = lineWidth;\n    // Quick reject\n    if (\n        (y > y0 + _l && y > y1 + _l && y > y2 + _l)\n        || (y < y0 - _l && y < y1 - _l && y < y2 - _l)\n        || (x > x0 + _l && x > x1 + _l && x > x2 + _l)\n        || (x < x0 - _l && x < x1 - _l && x < x2 - _l)\n    ) {\n        return false;\n    }\n    var d = quadraticProjectPoint(\n        x0, y0, x1, y1, x2, y2,\n        x, y, null\n    );\n    return d <= _l / 2;\n}\n\nvar PI2$3 = Math.PI * 2;\n\nfunction normalizeRadian(angle) {\n    angle %= PI2$3;\n    if (angle < 0) {\n        angle += PI2$3;\n    }\n    return angle;\n}\n\nvar PI2$2 = Math.PI * 2;\n\n/**\n * \n * @param  {number}  cx\n * @param  {number}  cy\n * @param  {number}  r\n * @param  {number}  startAngle\n * @param  {number}  endAngle\n * @param  {boolean}  anticlockwise\n * @param  {number} lineWidth\n * @param  {number}  x\n * @param  {number}  y\n * @return {Boolean}\n */\nfunction containStroke$4(\n    cx, cy, r, startAngle, endAngle, anticlockwise,\n    lineWidth, x, y\n) {\n\n    if (lineWidth === 0) {\n        return false;\n    }\n    var _l = lineWidth;\n\n    x -= cx;\n    y -= cy;\n    var d = Math.sqrt(x * x + y * y);\n\n    if ((d - _l > r) || (d + _l < r)) {\n        return false;\n    }\n    if (Math.abs(startAngle - endAngle) % PI2$2 < 1e-4) {\n        // Is a circle\n        return true;\n    }\n    if (anticlockwise) {\n        var tmp = startAngle;\n        startAngle = normalizeRadian(endAngle);\n        endAngle = normalizeRadian(tmp);\n    } else {\n        startAngle = normalizeRadian(startAngle);\n        endAngle = normalizeRadian(endAngle);\n    }\n    if (startAngle > endAngle) {\n        endAngle += PI2$2;\n    }\n\n    var angle = Math.atan2(y, x);\n    if (angle < 0) {\n        angle += PI2$2;\n    }\n    return (angle >= startAngle && angle <= endAngle)\n        || (angle + PI2$2 >= startAngle && angle + PI2$2 <= endAngle);\n}\n\nfunction windingLine(x0, y0, x1, y1, x, y) {\n    if ((y > y0 && y > y1) || (y < y0 && y < y1)) {\n        return 0;\n    }\n    // Ignore horizontal line\n    if (y1 === y0) {\n        return 0;\n    }\n    var dir = y1 < y0 ? 1 : -1;\n    var t = (y - y0) / (y1 - y0);\n\n    // Avoid winding error when intersection point is the connect point of two line of polygon\n    if (t === 1 || t === 0) {\n        dir = y1 < y0 ? 0.5 : -0.5;\n    }\n\n    var x_ = t * (x1 - x0) + x0;\n\n    return x_ > x ? dir : 0;\n}\n\nvar CMD$1 = PathProxy.CMD;\nvar PI2$1 = Math.PI * 2;\n\nvar EPSILON$2 = 1e-4;\n\nfunction isAroundEqual(a, b) {\n    return Math.abs(a - b) < EPSILON$2;\n}\n\n// \nvar roots = [-1, -1, -1];\nvar extrema = [-1, -1];\n\nfunction swapExtrema() {\n    var tmp = extrema[0];\n    extrema[0] = extrema[1];\n    extrema[1] = tmp;\n}\n\nfunction windingCubic(x0, y0, x1, y1, x2, y2, x3, y3, x, y) {\n    // Quick reject\n    if (\n        (y > y0 && y > y1 && y > y2 && y > y3)\n        || (y < y0 && y < y1 && y < y2 && y < y3)\n    ) {\n        return 0;\n    }\n    var nRoots = cubicRootAt(y0, y1, y2, y3, y, roots);\n    if (nRoots === 0) {\n        return 0;\n    }\n    else {\n        var w = 0;\n        var nExtrema = -1;\n        var y0_, y1_;\n        for (var i = 0; i < nRoots; i++) {\n            var t = roots[i];\n\n            // Avoid winding error when intersection point is the connect point of two line of polygon\n            var unit = (t === 0 || t === 1) ? 0.5 : 1;\n\n            var x_ = cubicAt(x0, x1, x2, x3, t);\n            if (x_ < x) { // Quick reject\n                continue;\n            }\n            if (nExtrema < 0) {\n                nExtrema = cubicExtrema(y0, y1, y2, y3, extrema);\n                if (extrema[1] < extrema[0] && nExtrema > 1) {\n                    swapExtrema();\n                }\n                y0_ = cubicAt(y0, y1, y2, y3, extrema[0]);\n                if (nExtrema > 1) {\n                    y1_ = cubicAt(y0, y1, y2, y3, extrema[1]);\n                }\n            }\n            if (nExtrema == 2) {\n                // \n                if (t < extrema[0]) {\n                    w += y0_ < y0 ? unit : -unit;\n                }\n                else if (t < extrema[1]) {\n                    w += y1_ < y0_ ? unit : -unit;\n                }\n                else {\n                    w += y3 < y1_ ? unit : -unit;\n                }\n            }\n            else {\n                // \n                if (t < extrema[0]) {\n                    w += y0_ < y0 ? unit : -unit;\n                }\n                else {\n                    w += y3 < y0_ ? unit : -unit;\n                }\n            }\n        }\n        return w;\n    }\n}\n\nfunction windingQuadratic(x0, y0, x1, y1, x2, y2, x, y) {\n    // Quick reject\n    if (\n        (y > y0 && y > y1 && y > y2)\n        || (y < y0 && y < y1 && y < y2)\n    ) {\n        return 0;\n    }\n    var nRoots = quadraticRootAt(y0, y1, y2, y, roots);\n    if (nRoots === 0) {\n        return 0;\n    }\n    else {\n        var t = quadraticExtremum(y0, y1, y2);\n        if (t >= 0 && t <= 1) {\n            var w = 0;\n            var y_ = quadraticAt(y0, y1, y2, t);\n            for (var i = 0; i < nRoots; i++) {\n                // Remove one endpoint.\n                var unit = (roots[i] === 0 || roots[i] === 1) ? 0.5 : 1;\n\n                var x_ = quadraticAt(x0, x1, x2, roots[i]);\n                if (x_ < x) {   // Quick reject\n                    continue;\n                }\n                if (roots[i] < t) {\n                    w += y_ < y0 ? unit : -unit;\n                }\n                else {\n                    w += y2 < y_ ? unit : -unit;\n                }\n            }\n            return w;\n        }\n        else {\n            // Remove one endpoint.\n            var unit = (roots[0] === 0 || roots[0] === 1) ? 0.5 : 1;\n\n            var x_ = quadraticAt(x0, x1, x2, roots[0]);\n            if (x_ < x) {   // Quick reject\n                return 0;\n            }\n            return y2 < y0 ? unit : -unit;\n        }\n    }\n}\n\n// TODO\n// Arc \nfunction windingArc(\n    cx, cy, r, startAngle, endAngle, anticlockwise, x, y\n) {\n    y -= cy;\n    if (y > r || y < -r) {\n        return 0;\n    }\n    var tmp = Math.sqrt(r * r - y * y);\n    roots[0] = -tmp;\n    roots[1] = tmp;\n\n    var diff = Math.abs(startAngle - endAngle);\n    if (diff < 1e-4) {\n        return 0;\n    }\n    if (diff % PI2$1 < 1e-4) {\n        // Is a circle\n        startAngle = 0;\n        endAngle = PI2$1;\n        var dir = anticlockwise ? 1 : -1;\n        if (x >= roots[0] + cx && x <= roots[1] + cx) {\n            return dir;\n        } else {\n            return 0;\n        }\n    }\n\n    if (anticlockwise) {\n        var tmp = startAngle;\n        startAngle = normalizeRadian(endAngle);\n        endAngle = normalizeRadian(tmp);\n    }\n    else {\n        startAngle = normalizeRadian(startAngle);\n        endAngle = normalizeRadian(endAngle);\n    }\n    if (startAngle > endAngle) {\n        endAngle += PI2$1;\n    }\n\n    var w = 0;\n    for (var i = 0; i < 2; i++) {\n        var x_ = roots[i];\n        if (x_ + cx > x) {\n            var angle = Math.atan2(y, x_);\n            var dir = anticlockwise ? 1 : -1;\n            if (angle < 0) {\n                angle = PI2$1 + angle;\n            }\n            if (\n                (angle >= startAngle && angle <= endAngle)\n                || (angle + PI2$1 >= startAngle && angle + PI2$1 <= endAngle)\n            ) {\n                if (angle > Math.PI / 2 && angle < Math.PI * 1.5) {\n                    dir = -dir;\n                }\n                w += dir;\n            }\n        }\n    }\n    return w;\n}\n\nfunction containPath(data, lineWidth, isStroke, x, y) {\n    var w = 0;\n    var xi = 0;\n    var yi = 0;\n    var x0 = 0;\n    var y0 = 0;\n\n    for (var i = 0; i < data.length;) {\n        var cmd = data[i++];\n        // Begin a new subpath\n        if (cmd === CMD$1.M && i > 1) {\n            // Close previous subpath\n            if (!isStroke) {\n                w += windingLine(xi, yi, x0, y0, x, y);\n            }\n            //  subpath \n            // if (w !== 0) {\n            //     return true;\n            // }\n        }\n\n        if (i == 1) {\n            //  L, C, Q\n            //  previous point  point\n            //\n            //  Arc \n            xi = data[i];\n            yi = data[i + 1];\n\n            x0 = xi;\n            y0 = yi;\n        }\n\n        switch (cmd) {\n            case CMD$1.M:\n                // moveTo  subpath, \n                //  closePath \n                x0 = data[i++];\n                y0 = data[i++];\n                xi = x0;\n                yi = y0;\n                break;\n            case CMD$1.L:\n                if (isStroke) {\n                    if (containStroke$1(xi, yi, data[i], data[i + 1], lineWidth, x, y)) {\n                        return true;\n                    }\n                }\n                else {\n                    // NOTE  L, C, Q  NaN\n                    w += windingLine(xi, yi, data[i], data[i + 1], x, y) || 0;\n                }\n                xi = data[i++];\n                yi = data[i++];\n                break;\n            case CMD$1.C:\n                if (isStroke) {\n                    if (containStroke$2(xi, yi,\n                        data[i++], data[i++], data[i++], data[i++], data[i], data[i + 1],\n                        lineWidth, x, y\n                    )) {\n                        return true;\n                    }\n                }\n                else {\n                    w += windingCubic(\n                        xi, yi,\n                        data[i++], data[i++], data[i++], data[i++], data[i], data[i + 1],\n                        x, y\n                    ) || 0;\n                }\n                xi = data[i++];\n                yi = data[i++];\n                break;\n            case CMD$1.Q:\n                if (isStroke) {\n                    if (containStroke$3(xi, yi,\n                        data[i++], data[i++], data[i], data[i + 1],\n                        lineWidth, x, y\n                    )) {\n                        return true;\n                    }\n                }\n                else {\n                    w += windingQuadratic(\n                        xi, yi,\n                        data[i++], data[i++], data[i], data[i + 1],\n                        x, y\n                    ) || 0;\n                }\n                xi = data[i++];\n                yi = data[i++];\n                break;\n            case CMD$1.A:\n                // TODO Arc \n                var cx = data[i++];\n                var cy = data[i++];\n                var rx = data[i++];\n                var ry = data[i++];\n                var theta = data[i++];\n                var dTheta = data[i++];\n                // TODO Arc \n                var psi = data[i++];\n                var anticlockwise = 1 - data[i++];\n                var x1 = Math.cos(theta) * rx + cx;\n                var y1 = Math.sin(theta) * ry + cy;\n                //  arc \n                if (i > 1) {\n                    w += windingLine(xi, yi, x1, y1, x, y);\n                }\n                else {\n                    // \n                    x0 = x1;\n                    y0 = y1;\n                }\n                // zr scale, x\n                var _x = (x - cx) * ry / rx + cx;\n                if (isStroke) {\n                    if (containStroke$4(\n                        cx, cy, ry, theta, theta + dTheta, anticlockwise,\n                        lineWidth, _x, y\n                    )) {\n                        return true;\n                    }\n                }\n                else {\n                    w += windingArc(\n                        cx, cy, ry, theta, theta + dTheta, anticlockwise,\n                        _x, y\n                    );\n                }\n                xi = Math.cos(theta + dTheta) * rx + cx;\n                yi = Math.sin(theta + dTheta) * ry + cy;\n                break;\n            case CMD$1.R:\n                x0 = xi = data[i++];\n                y0 = yi = data[i++];\n                var width = data[i++];\n                var height = data[i++];\n                var x1 = x0 + width;\n                var y1 = y0 + height;\n                if (isStroke) {\n                    if (containStroke$1(x0, y0, x1, y0, lineWidth, x, y)\n                        || containStroke$1(x1, y0, x1, y1, lineWidth, x, y)\n                        || containStroke$1(x1, y1, x0, y1, lineWidth, x, y)\n                        || containStroke$1(x0, y1, x0, y0, lineWidth, x, y)\n                    ) {\n                        return true;\n                    }\n                }\n                else {\n                    // FIXME Clockwise ?\n                    w += windingLine(x1, y0, x1, y1, x, y);\n                    w += windingLine(x0, y1, x0, y0, x, y);\n                }\n                break;\n            case CMD$1.Z:\n                if (isStroke) {\n                    if (containStroke$1(\n                        xi, yi, x0, y0, lineWidth, x, y\n                    )) {\n                        return true;\n                    }\n                }\n                else {\n                    // Close a subpath\n                    w += windingLine(xi, yi, x0, y0, x, y);\n                    //  subpath \n                    // FIXME subpaths may overlap\n                    // if (w !== 0) {\n                    //     return true;\n                    // }\n                }\n                xi = x0;\n                yi = y0;\n                break;\n        }\n    }\n    if (!isStroke && !isAroundEqual(yi, y0)) {\n        w += windingLine(xi, yi, x0, y0, x, y) || 0;\n    }\n    return w !== 0;\n}\n\nfunction contain(pathData, x, y) {\n    return containPath(pathData, 0, false, x, y);\n}\n\nfunction containStroke(pathData, lineWidth, x, y) {\n    return containPath(pathData, lineWidth, true, x, y);\n}\n\nvar getCanvasPattern = Pattern.prototype.getCanvasPattern;\n\nvar abs = Math.abs;\n\nvar pathProxyForDraw = new PathProxy(true);\n/**\n * @alias module:zrender/graphic/Path\n * @extends module:zrender/graphic/Displayable\n * @constructor\n * @param {Object} opts\n */\nfunction Path(opts) {\n    Displayable.call(this, opts);\n\n    /**\n     * @type {module:zrender/core/PathProxy}\n     * @readOnly\n     */\n    this.path = null;\n}\n\nPath.prototype = {\n\n    constructor: Path,\n\n    type: 'path',\n\n    __dirtyPath: true,\n\n    strokeContainThreshold: 5,\n\n    brush: function (ctx, prevEl) {\n        var style = this.style;\n        var path = this.path || pathProxyForDraw;\n        var hasStroke = style.hasStroke();\n        var hasFill = style.hasFill();\n        var fill = style.fill;\n        var stroke = style.stroke;\n        var hasFillGradient = hasFill && !!(fill.colorStops);\n        var hasStrokeGradient = hasStroke && !!(stroke.colorStops);\n        var hasFillPattern = hasFill && !!(fill.image);\n        var hasStrokePattern = hasStroke && !!(stroke.image);\n\n        style.bind(ctx, this, prevEl);\n        this.setTransform(ctx);\n\n        if (this.__dirty) {\n            var rect;\n            // Update gradient because bounding rect may changed\n            if (hasFillGradient) {\n                rect = rect || this.getBoundingRect();\n                this._fillGradient = style.getGradient(ctx, fill, rect);\n            }\n            if (hasStrokeGradient) {\n                rect = rect || this.getBoundingRect();\n                this._strokeGradient = style.getGradient(ctx, stroke, rect);\n            }\n        }\n        // Use the gradient or pattern\n        if (hasFillGradient) {\n            // PENDING If may have affect the state\n            ctx.fillStyle = this._fillGradient;\n        }\n        else if (hasFillPattern) {\n            ctx.fillStyle = getCanvasPattern.call(fill, ctx);\n        }\n        if (hasStrokeGradient) {\n            ctx.strokeStyle = this._strokeGradient;\n        }\n        else if (hasStrokePattern) {\n            ctx.strokeStyle = getCanvasPattern.call(stroke, ctx);\n        }\n\n        var lineDash = style.lineDash;\n        var lineDashOffset = style.lineDashOffset;\n\n        var ctxLineDash = !!ctx.setLineDash;\n\n        // Update path sx, sy\n        var scale = this.getGlobalScale();\n        path.setScale(scale[0], scale[1]);\n\n        // Proxy context\n        // Rebuild path in following 2 cases\n        // 1. Path is dirty\n        // 2. Path needs javascript implemented lineDash stroking.\n        //    In this case, lineDash information will not be saved in PathProxy\n        if (this.__dirtyPath\n            || (lineDash && !ctxLineDash && hasStroke)\n        ) {\n            path.beginPath(ctx);\n\n            // Setting line dash before build path\n            if (lineDash && !ctxLineDash) {\n                path.setLineDash(lineDash);\n                path.setLineDashOffset(lineDashOffset);\n            }\n\n            this.buildPath(path, this.shape, false);\n\n            // Clear path dirty flag\n            if (this.path) {\n                this.__dirtyPath = false;\n            }\n        }\n        else {\n            // Replay path building\n            ctx.beginPath();\n            this.path.rebuildPath(ctx);\n        }\n\n        hasFill && path.fill(ctx);\n\n        if (lineDash && ctxLineDash) {\n            ctx.setLineDash(lineDash);\n            ctx.lineDashOffset = lineDashOffset;\n        }\n\n        hasStroke && path.stroke(ctx);\n\n        if (lineDash && ctxLineDash) {\n            // PENDING\n            // Remove lineDash\n            ctx.setLineDash([]);\n        }\n\n        // Draw rect text\n        if (style.text != null) {\n            // Only restore transform when needs draw text.\n            this.restoreTransform(ctx);    \n            this.drawRectText(ctx, this.getBoundingRect());\n        }\n    },\n\n    // When bundling path, some shape may decide if use moveTo to begin a new subpath or closePath\n    // Like in circle\n    buildPath: function (ctx, shapeCfg, inBundle) {},\n\n    createPathProxy: function () {\n        this.path = new PathProxy();\n    },\n\n    getBoundingRect: function () {\n        var rect = this._rect;\n        var style = this.style;\n        var needsUpdateRect = !rect;\n        if (needsUpdateRect) {\n            var path = this.path;\n            if (!path) {\n                // Create path on demand.\n                path = this.path = new PathProxy();\n            }\n            if (this.__dirtyPath) {\n                path.beginPath();\n                this.buildPath(path, this.shape, false);\n            }\n            rect = path.getBoundingRect();\n        }\n        this._rect = rect;\n\n        if (style.hasStroke()) {\n            // Needs update rect with stroke lineWidth when\n            // 1. Element changes scale or lineWidth\n            // 2. Shape is changed\n            var rectWithStroke = this._rectWithStroke || (this._rectWithStroke = rect.clone());\n            if (this.__dirty || needsUpdateRect) {\n                rectWithStroke.copy(rect);\n                // FIXME Must after updateTransform\n                var w = style.lineWidth;\n                // PENDING, Min line width is needed when line is horizontal or vertical\n                var lineScale = style.strokeNoScale ? this.getLineScale() : 1;\n\n                // Only add extra hover lineWidth when there are no fill\n                if (!style.hasFill()) {\n                    w = Math.max(w, this.strokeContainThreshold || 4);\n                }\n                // Consider line width\n                // Line scale can't be 0;\n                if (lineScale > 1e-10) {\n                    rectWithStroke.width += w / lineScale;\n                    rectWithStroke.height += w / lineScale;\n                    rectWithStroke.x -= w / lineScale / 2;\n                    rectWithStroke.y -= w / lineScale / 2;\n                }\n            }\n\n            // Return rect with stroke\n            return rectWithStroke;\n        }\n\n        return rect;\n    },\n\n    contain: function (x, y) {\n        var localPos = this.transformCoordToLocal(x, y);\n        var rect = this.getBoundingRect();\n        var style = this.style;\n        x = localPos[0];\n        y = localPos[1];\n\n        if (rect.contain(x, y)) {\n            var pathData = this.path.data;\n            if (style.hasStroke()) {\n                var lineWidth = style.lineWidth;\n                var lineScale = style.strokeNoScale ? this.getLineScale() : 1;\n                // Line scale can't be 0;\n                if (lineScale > 1e-10) {\n                    // Only add extra hover lineWidth when there are no fill\n                    if (!style.hasFill()) {\n                        lineWidth = Math.max(lineWidth, this.strokeContainThreshold);\n                    }\n                    if (containStroke(\n                        pathData, lineWidth / lineScale, x, y\n                    )) {\n                        return true;\n                    }\n                }\n            }\n            if (style.hasFill()) {\n                return contain(pathData, x, y);\n            }\n        }\n        return false;\n    },\n\n    /**\n     * @param  {boolean} dirtyPath\n     */\n    dirty: function (dirtyPath) {\n        if (dirtyPath == null) {\n            dirtyPath = true;\n        }\n        // Only mark dirty, not mark clean\n        if (dirtyPath) {\n            this.__dirtyPath = dirtyPath;\n            this._rect = null;\n        }\n\n        this.__dirty = true;\n\n        this.__zr && this.__zr.refresh();\n\n        // Used as a clipping path\n        if (this.__clipTarget) {\n            this.__clipTarget.dirty();\n        }\n    },\n\n    /**\n     * Alias for animate('shape')\n     * @param {boolean} loop\n     */\n    animateShape: function (loop) {\n        return this.animate('shape', loop);\n    },\n\n    // Overwrite attrKV\n    attrKV: function (key, value) {\n        // FIXME\n        if (key === 'shape') {\n            this.setShape(value);\n            this.__dirtyPath = true;\n            this._rect = null;\n        }\n        else {\n            Displayable.prototype.attrKV.call(this, key, value);\n        }\n    },\n\n    /**\n     * @param {Object|string} key\n     * @param {*} value\n     */\n    setShape: function (key, value) {\n        var shape = this.shape;\n        // Path from string may not have shape\n        if (shape) {\n            if (isObject$1(key)) {\n                for (var name in key) {\n                    if (key.hasOwnProperty(name)) {\n                        shape[name] = key[name];\n                    }\n                }\n            }\n            else {\n                shape[key] = value;\n            }\n            this.dirty(true);\n        }\n        return this;\n    },\n\n    getLineScale: function () {\n        var m = this.transform;\n        // Get the line scale.\n        // Determinant of `m` means how much the area is enlarged by the\n        // transformation. So its square root can be used as a scale factor\n        // for width.\n        return m && abs(m[0] - 1) > 1e-10 && abs(m[3] - 1) > 1e-10\n            ? Math.sqrt(abs(m[0] * m[3] - m[2] * m[1]))\n            : 1;\n    }\n};\n\n/**\n *  Path element, \n * Extend a path element\n * @param {Object} props\n * @param {string} props.type Path type\n * @param {Function} props.init Initialize\n * @param {Function} props.buildPath Overwrite buildPath method\n * @param {Object} [props.style] Extended default style config\n * @param {Object} [props.shape] Extended default shape config\n */\nPath.extend = function (defaults$$1) {\n    var Sub = function (opts) {\n        Path.call(this, opts);\n\n        if (defaults$$1.style) {\n            // Extend default style\n            this.style.extendFrom(defaults$$1.style, false);\n        }\n\n        // Extend default shape\n        var defaultShape = defaults$$1.shape;\n        if (defaultShape) {\n            this.shape = this.shape || {};\n            var thisShape = this.shape;\n            for (var name in defaultShape) {\n                if (\n                    ! thisShape.hasOwnProperty(name)\n                    && defaultShape.hasOwnProperty(name)\n                ) {\n                    thisShape[name] = defaultShape[name];\n                }\n            }\n        }\n\n        defaults$$1.init && defaults$$1.init.call(this, opts);\n    };\n\n    inherits(Sub, Path);\n\n    // FIXME  extend position, rotation \n    for (var name in defaults$$1) {\n        // Extending prototype values and methods\n        if (name !== 'style' && name !== 'shape') {\n            Sub.prototype[name] = defaults$$1[name];\n        }\n    }\n\n    return Sub;\n};\n\ninherits(Path, Displayable);\n\nvar CMD$2 = PathProxy.CMD;\n\nvar points = [[], [], []];\nvar mathSqrt$3 = Math.sqrt;\nvar mathAtan2 = Math.atan2;\n\nvar transformPath = function (path, m) {\n    var data = path.data;\n    var cmd;\n    var nPoint;\n    var i;\n    var j;\n    var k;\n    var p;\n\n    var M = CMD$2.M;\n    var C = CMD$2.C;\n    var L = CMD$2.L;\n    var R = CMD$2.R;\n    var A = CMD$2.A;\n    var Q = CMD$2.Q;\n\n    for (i = 0, j = 0; i < data.length;) {\n        cmd = data[i++];\n        j = i;\n        nPoint = 0;\n\n        switch (cmd) {\n            case M:\n                nPoint = 1;\n                break;\n            case L:\n                nPoint = 1;\n                break;\n            case C:\n                nPoint = 3;\n                break;\n            case Q:\n                nPoint = 2;\n                break;\n            case A:\n                var x = m[4];\n                var y = m[5];\n                var sx = mathSqrt$3(m[0] * m[0] + m[1] * m[1]);\n                var sy = mathSqrt$3(m[2] * m[2] + m[3] * m[3]);\n                var angle = mathAtan2(-m[1] / sy, m[0] / sx);\n                // cx\n                data[i] *= sx;\n                data[i++] += x;\n                // cy\n                data[i] *= sy;\n                data[i++] += y;\n                // Scale rx and ry\n                // FIXME Assume psi is 0 here\n                data[i++] *= sx;\n                data[i++] *= sy;\n\n                // Start angle\n                data[i++] += angle;\n                // end angle\n                data[i++] += angle;\n                // FIXME psi\n                i += 2;\n                j = i;\n                break;\n            case R:\n                // x0, y0\n                p[0] = data[i++];\n                p[1] = data[i++];\n                applyTransform(p, p, m);\n                data[j++] = p[0];\n                data[j++] = p[1];\n                // x1, y1\n                p[0] += data[i++];\n                p[1] += data[i++];\n                applyTransform(p, p, m);\n                data[j++] = p[0];\n                data[j++] = p[1];\n        }\n\n        for (k = 0; k < nPoint; k++) {\n            var p = points[k];\n            p[0] = data[i++];\n            p[1] = data[i++];\n\n            applyTransform(p, p, m);\n            // Write back\n            data[j++] = p[0];\n            data[j++] = p[1];\n        }\n    }\n};\n\n// command chars\nvar cc = [\n    'm', 'M', 'l', 'L', 'v', 'V', 'h', 'H', 'z', 'Z',\n    'c', 'C', 'q', 'Q', 't', 'T', 's', 'S', 'a', 'A'\n];\n\nvar mathSqrt = Math.sqrt;\nvar mathSin = Math.sin;\nvar mathCos = Math.cos;\nvar PI = Math.PI;\n\nvar vMag = function(v) {\n    return Math.sqrt(v[0] * v[0] + v[1] * v[1]);\n};\nvar vRatio = function(u, v) {\n    return (u[0] * v[0] + u[1] * v[1]) / (vMag(u) * vMag(v));\n};\nvar vAngle = function(u, v) {\n    return (u[0] * v[1] < u[1] * v[0] ? -1 : 1)\n            * Math.acos(vRatio(u, v));\n};\n\nfunction processArc(x1, y1, x2, y2, fa, fs, rx, ry, psiDeg, cmd, path) {\n    var psi = psiDeg * (PI / 180.0);\n    var xp = mathCos(psi) * (x1 - x2) / 2.0\n                + mathSin(psi) * (y1 - y2) / 2.0;\n    var yp = -1 * mathSin(psi) * (x1 - x2) / 2.0\n                + mathCos(psi) * (y1 - y2) / 2.0;\n\n    var lambda = (xp * xp) / (rx * rx) + (yp * yp) / (ry * ry);\n\n    if (lambda > 1) {\n        rx *= mathSqrt(lambda);\n        ry *= mathSqrt(lambda);\n    }\n\n    var f = (fa === fs ? -1 : 1)\n        * mathSqrt((((rx * rx) * (ry * ry))\n                - ((rx * rx) * (yp * yp))\n                - ((ry * ry) * (xp * xp))) / ((rx * rx) * (yp * yp)\n                + (ry * ry) * (xp * xp))\n            ) || 0;\n\n    var cxp = f * rx * yp / ry;\n    var cyp = f * -ry * xp / rx;\n\n    var cx = (x1 + x2) / 2.0\n                + mathCos(psi) * cxp\n                - mathSin(psi) * cyp;\n    var cy = (y1 + y2) / 2.0\n            + mathSin(psi) * cxp\n            + mathCos(psi) * cyp;\n\n    var theta = vAngle([ 1, 0 ], [ (xp - cxp) / rx, (yp - cyp) / ry ]);\n    var u = [ (xp - cxp) / rx, (yp - cyp) / ry ];\n    var v = [ (-1 * xp - cxp) / rx, (-1 * yp - cyp) / ry ];\n    var dTheta = vAngle(u, v);\n\n    if (vRatio(u, v) <= -1) {\n        dTheta = PI;\n    }\n    if (vRatio(u, v) >= 1) {\n        dTheta = 0;\n    }\n    if (fs === 0 && dTheta > 0) {\n        dTheta = dTheta - 2 * PI;\n    }\n    if (fs === 1 && dTheta < 0) {\n        dTheta = dTheta + 2 * PI;\n    }\n\n    path.addData(cmd, cx, cy, rx, ry, theta, dTheta, psi, fs);\n}\n\nfunction createPathProxyFromString(data) {\n    if (!data) {\n        return [];\n    }\n\n    // command string\n    var cs = data.replace(/-/g, ' -')\n        .replace(/  /g, ' ')\n        .replace(/ /g, ',')\n        .replace(/,,/g, ',');\n\n    var n;\n    // create pipes so that we can split the data\n    for (n = 0; n < cc.length; n++) {\n        cs = cs.replace(new RegExp(cc[n], 'g'), '|' + cc[n]);\n    }\n\n    // create array\n    var arr = cs.split('|');\n    // init context point\n    var cpx = 0;\n    var cpy = 0;\n\n    var path = new PathProxy();\n    var CMD = PathProxy.CMD;\n\n    var prevCmd;\n    for (n = 1; n < arr.length; n++) {\n        var str = arr[n];\n        var c = str.charAt(0);\n        var off = 0;\n        var p = str.slice(1).replace(/e,-/g, 'e-').split(',');\n        var cmd;\n\n        if (p.length > 0 && p[0] === '') {\n            p.shift();\n        }\n\n        for (var i = 0; i < p.length; i++) {\n            p[i] = parseFloat(p[i]);\n        }\n        while (off < p.length && !isNaN(p[off])) {\n            if (isNaN(p[0])) {\n                break;\n            }\n            var ctlPtx;\n            var ctlPty;\n\n            var rx;\n            var ry;\n            var psi;\n            var fa;\n            var fs;\n\n            var x1 = cpx;\n            var y1 = cpy;\n\n            // convert l, H, h, V, and v to L\n            switch (c) {\n                case 'l':\n                    cpx += p[off++];\n                    cpy += p[off++];\n                    cmd = CMD.L;\n                    path.addData(cmd, cpx, cpy);\n                    break;\n                case 'L':\n                    cpx = p[off++];\n                    cpy = p[off++];\n                    cmd = CMD.L;\n                    path.addData(cmd, cpx, cpy);\n                    break;\n                case 'm':\n                    cpx += p[off++];\n                    cpy += p[off++];\n                    cmd = CMD.M;\n                    path.addData(cmd, cpx, cpy);\n                    c = 'l';\n                    break;\n                case 'M':\n                    cpx = p[off++];\n                    cpy = p[off++];\n                    cmd = CMD.M;\n                    path.addData(cmd, cpx, cpy);\n                    c = 'L';\n                    break;\n                case 'h':\n                    cpx += p[off++];\n                    cmd = CMD.L;\n                    path.addData(cmd, cpx, cpy);\n                    break;\n                case 'H':\n                    cpx = p[off++];\n                    cmd = CMD.L;\n                    path.addData(cmd, cpx, cpy);\n                    break;\n                case 'v':\n                    cpy += p[off++];\n                    cmd = CMD.L;\n                    path.addData(cmd, cpx, cpy);\n                    break;\n                case 'V':\n                    cpy = p[off++];\n                    cmd = CMD.L;\n                    path.addData(cmd, cpx, cpy);\n                    break;\n                case 'C':\n                    cmd = CMD.C;\n                    path.addData(\n                        cmd, p[off++], p[off++], p[off++], p[off++], p[off++], p[off++]\n                    );\n                    cpx = p[off - 2];\n                    cpy = p[off - 1];\n                    break;\n                case 'c':\n                    cmd = CMD.C;\n                    path.addData(\n                        cmd,\n                        p[off++] + cpx, p[off++] + cpy,\n                        p[off++] + cpx, p[off++] + cpy,\n                        p[off++] + cpx, p[off++] + cpy\n                    );\n                    cpx += p[off - 2];\n                    cpy += p[off - 1];\n                    break;\n                case 'S':\n                    ctlPtx = cpx;\n                    ctlPty = cpy;\n                    var len = path.len();\n                    var pathData = path.data;\n                    if (prevCmd === CMD.C) {\n                        ctlPtx += cpx - pathData[len - 4];\n                        ctlPty += cpy - pathData[len - 3];\n                    }\n                    cmd = CMD.C;\n                    x1 = p[off++];\n                    y1 = p[off++];\n                    cpx = p[off++];\n                    cpy = p[off++];\n                    path.addData(cmd, ctlPtx, ctlPty, x1, y1, cpx, cpy);\n                    break;\n                case 's':\n                    ctlPtx = cpx;\n                    ctlPty = cpy;\n                    var len = path.len();\n                    var pathData = path.data;\n                    if (prevCmd === CMD.C) {\n                        ctlPtx += cpx - pathData[len - 4];\n                        ctlPty += cpy - pathData[len - 3];\n                    }\n                    cmd = CMD.C;\n                    x1 = cpx + p[off++];\n                    y1 = cpy + p[off++];\n                    cpx += p[off++];\n                    cpy += p[off++];\n                    path.addData(cmd, ctlPtx, ctlPty, x1, y1, cpx, cpy);\n                    break;\n                case 'Q':\n                    x1 = p[off++];\n                    y1 = p[off++];\n                    cpx = p[off++];\n                    cpy = p[off++];\n                    cmd = CMD.Q;\n                    path.addData(cmd, x1, y1, cpx, cpy);\n                    break;\n                case 'q':\n                    x1 = p[off++] + cpx;\n                    y1 = p[off++] + cpy;\n                    cpx += p[off++];\n                    cpy += p[off++];\n                    cmd = CMD.Q;\n                    path.addData(cmd, x1, y1, cpx, cpy);\n                    break;\n                case 'T':\n                    ctlPtx = cpx;\n                    ctlPty = cpy;\n                    var len = path.len();\n                    var pathData = path.data;\n                    if (prevCmd === CMD.Q) {\n                        ctlPtx += cpx - pathData[len - 4];\n                        ctlPty += cpy - pathData[len - 3];\n                    }\n                    cpx = p[off++];\n                    cpy = p[off++];\n                    cmd = CMD.Q;\n                    path.addData(cmd, ctlPtx, ctlPty, cpx, cpy);\n                    break;\n                case 't':\n                    ctlPtx = cpx;\n                    ctlPty = cpy;\n                    var len = path.len();\n                    var pathData = path.data;\n                    if (prevCmd === CMD.Q) {\n                        ctlPtx += cpx - pathData[len - 4];\n                        ctlPty += cpy - pathData[len - 3];\n                    }\n                    cpx += p[off++];\n                    cpy += p[off++];\n                    cmd = CMD.Q;\n                    path.addData(cmd, ctlPtx, ctlPty, cpx, cpy);\n                    break;\n                case 'A':\n                    rx = p[off++];\n                    ry = p[off++];\n                    psi = p[off++];\n                    fa = p[off++];\n                    fs = p[off++];\n\n                    x1 = cpx, y1 = cpy;\n                    cpx = p[off++];\n                    cpy = p[off++];\n                    cmd = CMD.A;\n                    processArc(\n                        x1, y1, cpx, cpy, fa, fs, rx, ry, psi, cmd, path\n                    );\n                    break;\n                case 'a':\n                    rx = p[off++];\n                    ry = p[off++];\n                    psi = p[off++];\n                    fa = p[off++];\n                    fs = p[off++];\n\n                    x1 = cpx, y1 = cpy;\n                    cpx += p[off++];\n                    cpy += p[off++];\n                    cmd = CMD.A;\n                    processArc(\n                        x1, y1, cpx, cpy, fa, fs, rx, ry, psi, cmd, path\n                    );\n                    break;\n            }\n        }\n\n        if (c === 'z' || c === 'Z') {\n            cmd = CMD.Z;\n            path.addData(cmd);\n        }\n\n        prevCmd = cmd;\n    }\n\n    path.toStatic();\n\n    return path;\n}\n\n// TODO Optimize double memory cost problem\nfunction createPathOptions(str, opts) {\n    var pathProxy = createPathProxyFromString(str);\n    opts = opts || {};\n    opts.buildPath = function (path) {\n        if (path.setData) {\n            path.setData(pathProxy.data);\n            // Svg and vml renderer don't have context\n            var ctx = path.getContext();\n            if (ctx) {\n                path.rebuildPath(ctx);\n            }\n        }\n        else {\n            var ctx = path;\n            pathProxy.rebuildPath(ctx);\n        }\n    };\n\n    opts.applyTransform = function (m) {\n        transformPath(pathProxy, m);\n        this.dirty(true);\n    };\n\n    return opts;\n}\n\n/**\n * Create a Path object from path string data\n * http://www.w3.org/TR/SVG/paths.html#PathData\n * @param  {Object} opts Other options\n */\nfunction createFromString(str, opts) {\n    return new Path(createPathOptions(str, opts));\n}\n\n/**\n * Create a Path class from path string data\n * @param  {string} str\n * @param  {Object} opts Other options\n */\nfunction extendFromString(str, opts) {\n    return Path.extend(createPathOptions(str, opts));\n}\n\n/**\n * Merge multiple paths\n */\n// TODO Apply transform\n// TODO stroke dash\n// TODO Optimize double memory cost problem\nfunction mergePath$1(pathEls, opts) {\n    var pathList = [];\n    var len = pathEls.length;\n    for (var i = 0; i < len; i++) {\n        var pathEl = pathEls[i];\n        if (!pathEl.path) {\n            pathEl.createPathProxy();\n        }\n        if (pathEl.__dirtyPath) {\n            pathEl.buildPath(pathEl.path, pathEl.shape, true);\n        }\n        pathList.push(pathEl.path);\n    }\n\n    var pathBundle = new Path(opts);\n    // Need path proxy.\n    pathBundle.createPathProxy();\n    pathBundle.buildPath = function (path) {\n        path.appendPath(pathList);\n        // Svg and vml renderer don't have context\n        var ctx = path.getContext();\n        if (ctx) {\n            path.rebuildPath(ctx);\n        }\n    };\n\n    return pathBundle;\n}\n\n/**\n * @alias zrender/graphic/Text\n * @extends module:zrender/graphic/Displayable\n * @constructor\n * @param {Object} opts\n */\nvar Text = function (opts) { // jshint ignore:line\n    Displayable.call(this, opts);\n};\n\nText.prototype = {\n\n    constructor: Text,\n\n    type: 'text',\n\n    brush: function (ctx, prevEl) {\n        var style = this.style;\n\n        // Optimize, avoid normalize every time.\n        this.__dirty && normalizeTextStyle(style, true);\n\n        // Use props with prefix 'text'.\n        style.fill = style.stroke = style.shadowBlur = style.shadowColor =\n            style.shadowOffsetX = style.shadowOffsetY = null;\n\n        var text = style.text;\n        // Convert to string\n        text != null && (text += '');\n\n        // Always bind style\n        style.bind(ctx, this, prevEl);\n\n        if (!needDrawText(text, style)) {\n            return;\n        }\n\n        this.setTransform(ctx);\n\n        renderText(this, ctx, text, style);\n\n        this.restoreTransform(ctx);\n    },\n\n    getBoundingRect: function () {\n        var style = this.style;\n\n        // Optimize, avoid normalize every time.\n        this.__dirty && normalizeTextStyle(style, true);\n\n        if (!this._rect) {\n            var text = style.text;\n            text != null ? (text += '') : (text = '');\n\n            var rect = getBoundingRect(\n                style.text + '',\n                style.font,\n                style.textAlign,\n                style.textVerticalAlign,\n                style.textPadding,\n                style.rich\n            );\n\n            rect.x += style.x || 0;\n            rect.y += style.y || 0;\n\n            if (getStroke(style.textStroke, style.textStrokeWidth)) {\n                var w = style.textStrokeWidth;\n                rect.x -= w / 2;\n                rect.y -= w / 2;\n                rect.width += w;\n                rect.height += w;\n            }\n\n            this._rect = rect;\n        }\n\n        return this._rect;\n    }\n};\n\ninherits(Text, Displayable);\n\n/**\n * \n * @module zrender/shape/Circle\n */\n\nvar Circle = Path.extend({\n\n    type: 'circle',\n\n    shape: {\n        cx: 0,\n        cy: 0,\n        r: 0\n    },\n\n\n    buildPath : function (ctx, shape, inBundle) {\n        // Better stroking in ShapeBundle\n        // Always do it may have performence issue ( fill may be 2x more cost)\n        if (inBundle) {\n            ctx.moveTo(shape.cx + shape.r, shape.cy);\n        }\n        // else {\n        //     if (ctx.allocate && !ctx.data.length) {\n        //         ctx.allocate(ctx.CMD_MEM_SIZE.A);\n        //     }\n        // }\n        // Better stroking in ShapeBundle\n        // ctx.moveTo(shape.cx + shape.r, shape.cy);\n        ctx.arc(shape.cx, shape.cy, shape.r, 0, Math.PI * 2, true);\n    }\n});\n\n// Fix weird bug in some version of IE11 (like 11.0.9600.178**),\n// where exception \"unexpected call to method or property access\"\n// might be thrown when calling ctx.fill or ctx.stroke after a path\n// whose area size is zero is drawn and ctx.clip() is called and\n// shadowBlur is set. See #4572, #3112, #5777.\n// (e.g.,\n//  ctx.moveTo(10, 10);\n//  ctx.lineTo(20, 10);\n//  ctx.closePath();\n//  ctx.clip();\n//  ctx.shadowBlur = 10;\n//  ...\n//  ctx.fill();\n// )\n\nvar shadowTemp = [\n    ['shadowBlur', 0],\n    ['shadowColor', '#000'],\n    ['shadowOffsetX', 0],\n    ['shadowOffsetY', 0]\n];\n\nvar fixClipWithShadow = function (orignalBrush) {\n\n    // version string can be: '11.0'\n    return (env$1.browser.ie && env$1.browser.version >= 11)\n\n        ? function () {\n            var clipPaths = this.__clipPaths;\n            var style = this.style;\n            var modified;\n\n            if (clipPaths) {\n                for (var i = 0; i < clipPaths.length; i++) {\n                    var clipPath = clipPaths[i];\n                    var shape = clipPath && clipPath.shape;\n                    var type = clipPath && clipPath.type;\n\n                    if (shape && (\n                        (type === 'sector' && shape.startAngle === shape.endAngle)\n                        || (type === 'rect' && (!shape.width || !shape.height))\n                    )) {\n                        for (var j = 0; j < shadowTemp.length; j++) {\n                            // It is save to put shadowTemp static, because shadowTemp\n                            // will be all modified each item brush called.\n                            shadowTemp[j][2] = style[shadowTemp[j][0]];\n                            style[shadowTemp[j][0]] = shadowTemp[j][1];\n                        }\n                        modified = true;\n                        break;\n                    }\n                }\n            }\n\n            orignalBrush.apply(this, arguments);\n\n            if (modified) {\n                for (var j = 0; j < shadowTemp.length; j++) {\n                    style[shadowTemp[j][0]] = shadowTemp[j][2];\n                }\n            }\n        }\n\n        : orignalBrush;\n};\n\n/**\n * \n * @module zrender/graphic/shape/Sector\n */\n\nvar Sector = Path.extend({\n\n    type: 'sector',\n\n    shape: {\n\n        cx: 0,\n\n        cy: 0,\n\n        r0: 0,\n\n        r: 0,\n\n        startAngle: 0,\n\n        endAngle: Math.PI * 2,\n\n        clockwise: true\n    },\n\n    brush: fixClipWithShadow(Path.prototype.brush),\n\n    buildPath: function (ctx, shape) {\n\n        var x = shape.cx;\n        var y = shape.cy;\n        var r0 = Math.max(shape.r0 || 0, 0);\n        var r = Math.max(shape.r, 0);\n        var startAngle = shape.startAngle;\n        var endAngle = shape.endAngle;\n        var clockwise = shape.clockwise;\n\n        var unitX = Math.cos(startAngle);\n        var unitY = Math.sin(startAngle);\n\n        ctx.moveTo(unitX * r0 + x, unitY * r0 + y);\n\n        ctx.lineTo(unitX * r + x, unitY * r + y);\n\n        ctx.arc(x, y, r, startAngle, endAngle, !clockwise);\n\n        ctx.lineTo(\n            Math.cos(endAngle) * r0 + x,\n            Math.sin(endAngle) * r0 + y\n        );\n\n        if (r0 !== 0) {\n            ctx.arc(x, y, r0, endAngle, startAngle, clockwise);\n        }\n\n        ctx.closePath();\n    }\n});\n\n/**\n * \n * @module zrender/graphic/shape/Ring\n */\n\nvar Ring = Path.extend({\n\n    type: 'ring',\n\n    shape: {\n        cx: 0,\n        cy: 0,\n        r: 0,\n        r0: 0\n    },\n\n    buildPath: function (ctx, shape) {\n        var x = shape.cx;\n        var y = shape.cy;\n        var PI2 = Math.PI * 2;\n        ctx.moveTo(x + shape.r, y);\n        ctx.arc(x, y, shape.r, 0, PI2, false);\n        ctx.moveTo(x + shape.r0, y);\n        ctx.arc(x, y, shape.r0, 0, PI2, true);\n    }\n});\n\n/**\n * Catmull-Rom spline \n * @module zrender/shape/util/smoothSpline\n * @author pissang (https://www.github.com/pissang)\n *         Kener (@Kener-, kener.linfeng@gmail.com)\n *         errorrik (errorrik@gmail.com)\n */\n\n/**\n * @inner\n */\nfunction interpolate(p0, p1, p2, p3, t, t2, t3) {\n    var v0 = (p2 - p0) * 0.5;\n    var v1 = (p3 - p1) * 0.5;\n    return (2 * (p1 - p2) + v0 + v1) * t3\n            + (-3 * (p1 - p2) - 2 * v0 - v1) * t2\n            + v0 * t + p1;\n}\n\n/**\n * @alias module:zrender/shape/util/smoothSpline\n * @param {Array} points \n * @param {boolean} isLoop\n * @return {Array}\n */\nvar smoothSpline = function (points, isLoop) {\n    var len$$1 = points.length;\n    var ret = [];\n\n    var distance$$1 = 0;\n    for (var i = 1; i < len$$1; i++) {\n        distance$$1 += distance(points[i - 1], points[i]);\n    }\n\n    var segs = distance$$1 / 2;\n    segs = segs < len$$1 ? len$$1 : segs;\n    for (var i = 0; i < segs; i++) {\n        var pos = i / (segs - 1) * (isLoop ? len$$1 : len$$1 - 1);\n        var idx = Math.floor(pos);\n\n        var w = pos - idx;\n\n        var p0;\n        var p1 = points[idx % len$$1];\n        var p2;\n        var p3;\n        if (!isLoop) {\n            p0 = points[idx === 0 ? idx : idx - 1];\n            p2 = points[idx > len$$1 - 2 ? len$$1 - 1 : idx + 1];\n            p3 = points[idx > len$$1 - 3 ? len$$1 - 1 : idx + 2];\n        }\n        else {\n            p0 = points[(idx - 1 + len$$1) % len$$1];\n            p2 = points[(idx + 1) % len$$1];\n            p3 = points[(idx + 2) % len$$1];\n        }\n\n        var w2 = w * w;\n        var w3 = w * w2;\n\n        ret.push([\n            interpolate(p0[0], p1[0], p2[0], p3[0], w, w2, w3),\n            interpolate(p0[1], p1[1], p2[1], p3[1], w, w2, w3)\n        ]);\n    }\n    return ret;\n};\n\n/**\n * \n * @module zrender/shape/util/smoothBezier\n * @author pissang (https://www.github.com/pissang)\n *         Kener (@Kener-, kener.linfeng@gmail.com)\n *         errorrik (errorrik@gmail.com)\n */\n\n/**\n * \n * @alias module:zrender/shape/util/smoothBezier\n * @param {Array} points \n * @param {number} smooth , 0-1\n * @param {boolean} isLoop\n * @param {Array} constraint \n *                            [[0, 0], [100, 100]], \n *                           \n * @param {Array} \n */\nvar smoothBezier = function (points, smooth, isLoop, constraint) {\n    var cps = [];\n\n    var v = [];\n    var v1 = [];\n    var v2 = [];\n    var prevPoint;\n    var nextPoint;\n\n    var min$$1, max$$1;\n    if (constraint) {\n        min$$1 = [Infinity, Infinity];\n        max$$1 = [-Infinity, -Infinity];\n        for (var i = 0, len$$1 = points.length; i < len$$1; i++) {\n            min(min$$1, min$$1, points[i]);\n            max(max$$1, max$$1, points[i]);\n        }\n        // \n        min(min$$1, min$$1, constraint[0]);\n        max(max$$1, max$$1, constraint[1]);\n    }\n\n    for (var i = 0, len$$1 = points.length; i < len$$1; i++) {\n        var point = points[i];\n\n        if (isLoop) {\n            prevPoint = points[i ? i - 1 : len$$1 - 1];\n            nextPoint = points[(i + 1) % len$$1];\n        }\n        else {\n            if (i === 0 || i === len$$1 - 1) {\n                cps.push(clone$1(points[i]));\n                continue;\n            }\n            else {\n                prevPoint = points[i - 1];\n                nextPoint = points[i + 1];\n            }\n        }\n\n        sub(v, nextPoint, prevPoint);\n\n        // use degree to scale the handle length\n        scale(v, v, smooth);\n\n        var d0 = distance(point, prevPoint);\n        var d1 = distance(point, nextPoint);\n        var sum = d0 + d1;\n        if (sum !== 0) {\n            d0 /= sum;\n            d1 /= sum;\n        }\n\n        scale(v1, v, -d0);\n        scale(v2, v, d1);\n        var cp0 = add([], point, v1);\n        var cp1 = add([], point, v2);\n        if (constraint) {\n            max(cp0, cp0, min$$1);\n            min(cp0, cp0, max$$1);\n            max(cp1, cp1, min$$1);\n            min(cp1, cp1, max$$1);\n        }\n        cps.push(cp0);\n        cps.push(cp1);\n    }\n\n    if (isLoop) {\n        cps.push(cps.shift());\n    }\n\n    return cps;\n};\n\nfunction buildPath$1(ctx, shape, closePath) {\n    var points = shape.points;\n    var smooth = shape.smooth;\n    if (points && points.length >= 2) {\n        if (smooth && smooth !== 'spline') {\n            var controlPoints = smoothBezier(\n                points, smooth, closePath, shape.smoothConstraint\n            );\n\n            ctx.moveTo(points[0][0], points[0][1]);\n            var len = points.length;\n            for (var i = 0; i < (closePath ? len : len - 1); i++) {\n                var cp1 = controlPoints[i * 2];\n                var cp2 = controlPoints[i * 2 + 1];\n                var p = points[(i + 1) % len];\n                ctx.bezierCurveTo(\n                    cp1[0], cp1[1], cp2[0], cp2[1], p[0], p[1]\n                );\n            }\n        }\n        else {\n            if (smooth === 'spline') {\n                points = smoothSpline(points, closePath);\n            }\n\n            ctx.moveTo(points[0][0], points[0][1]);\n            for (var i = 1, l = points.length; i < l; i++) {\n                ctx.lineTo(points[i][0], points[i][1]);\n            }\n        }\n\n        closePath && ctx.closePath();\n    }\n}\n\n/**\n * \n * @module zrender/shape/Polygon\n */\n\nvar Polygon = Path.extend({\n\n    type: 'polygon',\n\n    shape: {\n        points: null,\n\n        smooth: false,\n\n        smoothConstraint: null\n    },\n\n    buildPath: function (ctx, shape) {\n        buildPath$1(ctx, shape, true);\n    }\n});\n\n/**\n * @module zrender/graphic/shape/Polyline\n */\n\nvar Polyline = Path.extend({\n\n    type: 'polyline',\n\n    shape: {\n        points: null,\n\n        smooth: false,\n\n        smoothConstraint: null\n    },\n\n    style: {\n        stroke: '#000',\n\n        fill: null\n    },\n\n    buildPath: function (ctx, shape) {\n        buildPath$1(ctx, shape, false);\n    }\n});\n\n/**\n * \n * @module zrender/graphic/shape/Rect\n */\n\nvar Rect = Path.extend({\n\n    type: 'rect',\n\n    shape: {\n        // r1r2r3r4\n        // r1          [1, 1, 1, 1]\n        // r[1]        [1, 1, 1, 1]\n        // r[1, 2]     [1, 2, 1, 2]\n        // r[1, 2, 3]  [1, 2, 3, 2]\n        r: 0,\n\n        x: 0,\n        y: 0,\n        width: 0,\n        height: 0\n    },\n\n    buildPath: function (ctx, shape) {\n        var x = shape.x;\n        var y = shape.y;\n        var width = shape.width;\n        var height = shape.height;\n        if (!shape.r) {\n            ctx.rect(x, y, width, height);\n        }\n        else {\n            buildPath(ctx, shape);\n        }\n        ctx.closePath();\n        return;\n    }\n});\n\n/**\n * \n * @module zrender/graphic/shape/Line\n */\n\nvar Line = Path.extend({\n\n    type: 'line',\n\n    shape: {\n        // Start point\n        x1: 0,\n        y1: 0,\n        // End point\n        x2: 0,\n        y2: 0,\n\n        percent: 1\n    },\n\n    style: {\n        stroke: '#000',\n        fill: null\n    },\n\n    buildPath: function (ctx, shape) {\n        var x1 = shape.x1;\n        var y1 = shape.y1;\n        var x2 = shape.x2;\n        var y2 = shape.y2;\n        var percent = shape.percent;\n\n        if (percent === 0) {\n            return;\n        }\n\n        ctx.moveTo(x1, y1);\n\n        if (percent < 1) {\n            x2 = x1 * (1 - percent) + x2 * percent;\n            y2 = y1 * (1 - percent) + y2 * percent;\n        }\n        ctx.lineTo(x2, y2);\n    },\n\n    /**\n     * Get point at percent\n     * @param  {number} percent\n     * @return {Array.<number>}\n     */\n    pointAt: function (p) {\n        var shape = this.shape;\n        return [\n            shape.x1 * (1 - p) + shape.x2 * p,\n            shape.y1 * (1 - p) + shape.y2 * p\n        ];\n    }\n});\n\n/**\n * \n * @module zrender/shape/BezierCurve\n */\n\nvar out = [];\n\nfunction someVectorAt(shape, t, isTangent) {\n    var cpx2 = shape.cpx2;\n    var cpy2 = shape.cpy2;\n    if (cpx2 === null || cpy2 === null) {\n        return [\n            (isTangent ? cubicDerivativeAt : cubicAt)(shape.x1, shape.cpx1, shape.cpx2, shape.x2, t),\n            (isTangent ? cubicDerivativeAt : cubicAt)(shape.y1, shape.cpy1, shape.cpy2, shape.y2, t)\n        ];\n    }\n    else {\n        return [\n            (isTangent ? quadraticDerivativeAt : quadraticAt)(shape.x1, shape.cpx1, shape.x2, t),\n            (isTangent ? quadraticDerivativeAt : quadraticAt)(shape.y1, shape.cpy1, shape.y2, t)\n        ];\n    }\n}\n\nvar BezierCurve = Path.extend({\n\n    type: 'bezier-curve',\n\n    shape: {\n        x1: 0,\n        y1: 0,\n        x2: 0,\n        y2: 0,\n        cpx1: 0,\n        cpy1: 0,\n        // cpx2: 0,\n        // cpy2: 0\n\n        // Curve show percent, for animating\n        percent: 1\n    },\n\n    style: {\n        stroke: '#000',\n        fill: null\n    },\n\n    buildPath: function (ctx, shape) {\n        var x1 = shape.x1;\n        var y1 = shape.y1;\n        var x2 = shape.x2;\n        var y2 = shape.y2;\n        var cpx1 = shape.cpx1;\n        var cpy1 = shape.cpy1;\n        var cpx2 = shape.cpx2;\n        var cpy2 = shape.cpy2;\n        var percent = shape.percent;\n        if (percent === 0) {\n            return;\n        }\n\n        ctx.moveTo(x1, y1);\n\n        if (cpx2 == null || cpy2 == null) {\n            if (percent < 1) {\n                quadraticSubdivide(\n                    x1, cpx1, x2, percent, out\n                );\n                cpx1 = out[1];\n                x2 = out[2];\n                quadraticSubdivide(\n                    y1, cpy1, y2, percent, out\n                );\n                cpy1 = out[1];\n                y2 = out[2];\n            }\n\n            ctx.quadraticCurveTo(\n                cpx1, cpy1,\n                x2, y2\n            );\n        }\n        else {\n            if (percent < 1) {\n                cubicSubdivide(\n                    x1, cpx1, cpx2, x2, percent, out\n                );\n                cpx1 = out[1];\n                cpx2 = out[2];\n                x2 = out[3];\n                cubicSubdivide(\n                    y1, cpy1, cpy2, y2, percent, out\n                );\n                cpy1 = out[1];\n                cpy2 = out[2];\n                y2 = out[3];\n            }\n            ctx.bezierCurveTo(\n                cpx1, cpy1,\n                cpx2, cpy2,\n                x2, y2\n            );\n        }\n    },\n\n    /**\n     * Get point at percent\n     * @param  {number} t\n     * @return {Array.<number>}\n     */\n    pointAt: function (t) {\n        return someVectorAt(this.shape, t, false);\n    },\n\n    /**\n     * Get tangent at percent\n     * @param  {number} t\n     * @return {Array.<number>}\n     */\n    tangentAt: function (t) {\n        var p = someVectorAt(this.shape, t, true);\n        return normalize(p, p);\n    }\n});\n\n/**\n * \n * @module zrender/graphic/shape/Arc\n */\n\nvar Arc = Path.extend({\n\n    type: 'arc',\n\n    shape: {\n\n        cx: 0,\n\n        cy: 0,\n\n        r: 0,\n\n        startAngle: 0,\n\n        endAngle: Math.PI * 2,\n\n        clockwise: true\n    },\n\n    style: {\n\n        stroke: '#000',\n\n        fill: null\n    },\n\n    buildPath: function (ctx, shape) {\n\n        var x = shape.cx;\n        var y = shape.cy;\n        var r = Math.max(shape.r, 0);\n        var startAngle = shape.startAngle;\n        var endAngle = shape.endAngle;\n        var clockwise = shape.clockwise;\n\n        var unitX = Math.cos(startAngle);\n        var unitY = Math.sin(startAngle);\n\n        ctx.moveTo(unitX * r + x, unitY * r + y);\n        ctx.arc(x, y, r, startAngle, endAngle, !clockwise);\n    }\n});\n\n// CompoundPath to improve performance\n\nvar CompoundPath = Path.extend({\n\n    type: 'compound',\n\n    shape: {\n\n        paths: null\n    },\n\n    _updatePathDirty: function () {\n        var dirtyPath = this.__dirtyPath;\n        var paths = this.shape.paths;\n        for (var i = 0; i < paths.length; i++) {\n            // Mark as dirty if any subpath is dirty\n            dirtyPath = dirtyPath || paths[i].__dirtyPath;\n        }\n        this.__dirtyPath = dirtyPath;\n        this.__dirty = this.__dirty || dirtyPath;\n    },\n\n    beforeBrush: function () {\n        this._updatePathDirty();\n        var paths = this.shape.paths || [];\n        var scale = this.getGlobalScale();\n        // Update path scale\n        for (var i = 0; i < paths.length; i++) {\n            if (!paths[i].path) {\n                paths[i].createPathProxy();\n            }\n            paths[i].path.setScale(scale[0], scale[1]);\n        }\n    },\n\n    buildPath: function (ctx, shape) {\n        var paths = shape.paths || [];\n        for (var i = 0; i < paths.length; i++) {\n            paths[i].buildPath(ctx, paths[i].shape, true);\n        }\n    },\n\n    afterBrush: function () {\n        var paths = this.shape.paths || [];\n        for (var i = 0; i < paths.length; i++) {\n            paths[i].__dirtyPath = false;\n        }\n    },\n\n    getBoundingRect: function () {\n        this._updatePathDirty();\n        return Path.prototype.getBoundingRect.call(this);\n    }\n});\n\n/**\n * @param {Array.<Object>} colorStops\n */\nvar Gradient = function (colorStops) {\n\n    this.colorStops = colorStops || [];\n\n};\n\nGradient.prototype = {\n\n    constructor: Gradient,\n\n    addColorStop: function (offset, color) {\n        this.colorStops.push({\n\n            offset: offset,\n\n            color: color\n        });\n    }\n\n};\n\n/**\n * x, y, x2, y2 are all percent from 0 to 1\n * @param {number} [x=0]\n * @param {number} [y=0]\n * @param {number} [x2=1]\n * @param {number} [y2=0]\n * @param {Array.<Object>} colorStops\n * @param {boolean} [globalCoord=false]\n */\nvar LinearGradient = function (x, y, x2, y2, colorStops, globalCoord) {\n    // Should do nothing more in this constructor. Because gradient can be\n    // declard by `color: {type: 'linear', colorStops: ...}`, where\n    // this constructor will not be called.\n\n    this.x = x == null ? 0 : x;\n\n    this.y = y == null ? 0 : y;\n\n    this.x2 = x2 == null ? 1 : x2;\n\n    this.y2 = y2 == null ? 0 : y2;\n\n    // Can be cloned\n    this.type = 'linear';\n\n    // If use global coord\n    this.global = globalCoord || false;\n\n    Gradient.call(this, colorStops);\n};\n\nLinearGradient.prototype = {\n\n    constructor: LinearGradient\n};\n\ninherits(LinearGradient, Gradient);\n\n/**\n * x, y, r are all percent from 0 to 1\n * @param {number} [x=0.5]\n * @param {number} [y=0.5]\n * @param {number} [r=0.5]\n * @param {Array.<Object>} [colorStops]\n * @param {boolean} [globalCoord=false]\n */\nvar RadialGradient = function (x, y, r, colorStops, globalCoord) {\n    // Should do nothing more in this constructor. Because gradient can be\n    // declard by `color: {type: 'radial', colorStops: ...}`, where\n    // this constructor will not be called.\n\n    this.x = x == null ? 0.5 : x;\n\n    this.y = y == null ? 0.5 : y;\n\n    this.r = r == null ? 0.5 : r;\n\n    // Can be cloned\n    this.type = 'radial';\n\n    // If use global coord\n    this.global = globalCoord || false;\n\n    Gradient.call(this, colorStops);\n};\n\nRadialGradient.prototype = {\n\n    constructor: RadialGradient\n};\n\ninherits(RadialGradient, Gradient);\n\n/**\n * Displayable for incremental rendering. It will be rendered in a separate layer\n * IncrementalDisplay have too main methods. `clearDisplayables` and `addDisplayables`\n * addDisplayables will render the added displayables incremetally.\n *\n * It use a not clearFlag to tell the painter don't clear the layer if it's the first element.\n */\n// TODO Style override ?\nfunction IncrementalDisplayble(opts) {\n\n    Displayable.call(this, opts);\n\n    this._displayables = [];\n\n    this._temporaryDisplayables = [];\n\n    this._cursor = 0;\n\n    this.notClear = true;\n}\n\nIncrementalDisplayble.prototype.incremental = true;\n\nIncrementalDisplayble.prototype.clearDisplaybles = function () {\n    this._displayables = [];\n    this._temporaryDisplayables = [];\n    this._cursor = 0;\n    this.dirty();\n\n    this.notClear = false;\n};\n\nIncrementalDisplayble.prototype.addDisplayable = function (displayable, notPersistent) {\n    if (notPersistent) {\n        this._temporaryDisplayables.push(displayable);\n    }\n    else {\n        this._displayables.push(displayable);\n    }\n    this.dirty();\n};\n\nIncrementalDisplayble.prototype.addDisplayables = function (displayables, notPersistent) {\n    notPersistent = notPersistent || false;\n    for (var i = 0; i < displayables.length; i++) {\n        this.addDisplayable(displayables[i], notPersistent);\n    }\n};\n\nIncrementalDisplayble.prototype.eachPendingDisplayable = function  (cb) {\n    for (var i = this._cursor; i < this._displayables.length; i++) {\n        cb && cb(this._displayables[i]);\n    }\n    for (var i = 0; i < this._temporaryDisplayables.length; i++) {\n        cb && cb(this._temporaryDisplayables[i]);\n    }\n};\n\nIncrementalDisplayble.prototype.update = function () {\n    this.updateTransform();\n    for (var i = this._cursor; i < this._displayables.length; i++) {\n        var displayable = this._displayables[i];\n        // PENDING\n        displayable.parent = this;\n        displayable.update();\n        displayable.parent = null;\n    }\n    for (var i = 0; i < this._temporaryDisplayables.length; i++) {\n        var displayable = this._temporaryDisplayables[i];\n        // PENDING\n        displayable.parent = this;\n        displayable.update();\n        displayable.parent = null;\n    }\n};\n\nIncrementalDisplayble.prototype.brush = function (ctx, prevEl) {\n    // Render persistant displayables.\n    for (var i = this._cursor; i < this._displayables.length; i++) {\n        var displayable = this._temporaryDisplayables[i];\n        displayable.beforeBrush && displayable.beforeBrush(ctx);\n        displayable.brush(ctx, i === this._cursor ? null : this._displayables[i - 1]);\n        displayable.afterBrush && displayable.afterBrush(ctx);\n    }\n    this._cursor = i;\n    // Render temporary displayables.\n    for (var i = 0; i < this._temporaryDisplayables.length; i++) {\n        var displayable = this._temporaryDisplayables[i];\n        displayable.beforeBrush && displayable.beforeBrush(ctx);\n        displayable.brush(ctx, i === 0 ? null : this._temporaryDisplayables[i - 1]);\n        displayable.afterBrush && displayable.afterBrush(ctx);\n    }\n\n    this._temporaryDisplayables = [];\n\n    this.notClear = true;\n};\n\nvar m = [];\nIncrementalDisplayble.prototype.getBoundingRect = function () {\n    if (!this._rect) {\n        var rect = new BoundingRect(Infinity, Infinity, -Infinity, -Infinity);\n        for (var i = 0; i < this._displayables.length; i++) {\n            var displayable = this._displayables[i];\n            var childRect = displayable.getBoundingRect().clone();\n            if (displayable.needLocalTransform()) {\n                childRect.applyTransform(displayable.getLocalTransform(m));\n            }\n            rect.union(childRect);\n        }\n        this._rect = rect;\n    }\n    return this._rect;\n};\n\nIncrementalDisplayble.prototype.contain = function (x, y) {\n    var localPos = this.transformCoordToLocal(x, y);\n    var rect = this.getBoundingRect();\n\n    if (rect.contain(localPos[0], localPos[1])) {\n        for (var i = 0; i < this._displayables.length; i++) {\n            var displayable = this._displayables[i];\n            if (displayable.contain(x, y)) {\n                return true;\n            }\n        }\n    }\n    return false;\n};\n\ninherits(IncrementalDisplayble, Displayable);\n\nvar round = Math.round;\nvar mathMax$1 = Math.max;\nvar mathMin$1 = Math.min;\n\nvar EMPTY_OBJ = {};\n\n/**\n * Extend shape with parameters\n */\nfunction extendShape(opts) {\n    return Path.extend(opts);\n}\n\n/**\n * Extend path\n */\nfunction extendPath(pathData, opts) {\n    return extendFromString(pathData, opts);\n}\n\n/**\n * Create a path element from path data string\n * @param {string} pathData\n * @param {Object} opts\n * @param {module:zrender/core/BoundingRect} rect\n * @param {string} [layout=cover] 'center' or 'cover'\n */\nfunction makePath(pathData, opts, rect, layout) {\n    var path = createFromString(pathData, opts);\n    var boundingRect = path.getBoundingRect();\n    if (rect) {\n        if (layout === 'center') {\n            rect = centerGraphic(rect, boundingRect);\n        }\n\n        resizePath(path, rect);\n    }\n    return path;\n}\n\n/**\n * Create a image element from image url\n * @param {string} imageUrl image url\n * @param {Object} opts options\n * @param {module:zrender/core/BoundingRect} rect constrain rect\n * @param {string} [layout=cover] 'center' or 'cover'\n */\nfunction makeImage(imageUrl, rect, layout) {\n    var path = new ZImage({\n        style: {\n            image: imageUrl,\n            x: rect.x,\n            y: rect.y,\n            width: rect.width,\n            height: rect.height\n        },\n        onload: function (img) {\n            if (layout === 'center') {\n                var boundingRect = {\n                    width: img.width,\n                    height: img.height\n                };\n                path.setStyle(centerGraphic(rect, boundingRect));\n            }\n        }\n    });\n    return path;\n}\n\n/**\n * Get position of centered element in bounding box.\n *\n * @param  {Object} rect         element local bounding box\n * @param  {Object} boundingRect constraint bounding box\n * @return {Object} element position containing x, y, width, and height\n */\nfunction centerGraphic(rect, boundingRect) {\n    // Set rect to center, keep width / height ratio.\n    var aspect = boundingRect.width / boundingRect.height;\n    var width = rect.height * aspect;\n    var height;\n    if (width <= rect.width) {\n        height = rect.height;\n    }\n    else {\n        width = rect.width;\n        height = width / aspect;\n    }\n    var cx = rect.x + rect.width / 2;\n    var cy = rect.y + rect.height / 2;\n\n    return {\n        x: cx - width / 2,\n        y: cy - height / 2,\n        width: width,\n        height: height\n    };\n}\n\nvar mergePath = mergePath$1;\n\n/**\n * Resize a path to fit the rect\n * @param {module:zrender/graphic/Path} path\n * @param {Object} rect\n */\nfunction resizePath(path, rect) {\n    if (!path.applyTransform) {\n        return;\n    }\n\n    var pathRect = path.getBoundingRect();\n\n    var m = pathRect.calculateTransform(rect);\n\n    path.applyTransform(m);\n}\n\n/**\n * Sub pixel optimize line for canvas\n *\n * @param {Object} param\n * @param {Object} [param.shape]\n * @param {number} [param.shape.x1]\n * @param {number} [param.shape.y1]\n * @param {number} [param.shape.x2]\n * @param {number} [param.shape.y2]\n * @param {Object} [param.style]\n * @param {number} [param.style.lineWidth]\n * @return {Object} Modified param\n */\nfunction subPixelOptimizeLine(param) {\n    var shape = param.shape;\n    var lineWidth = param.style.lineWidth;\n\n    if (round(shape.x1 * 2) === round(shape.x2 * 2)) {\n        shape.x1 = shape.x2 = subPixelOptimize(shape.x1, lineWidth, true);\n    }\n    if (round(shape.y1 * 2) === round(shape.y2 * 2)) {\n        shape.y1 = shape.y2 = subPixelOptimize(shape.y1, lineWidth, true);\n    }\n    return param;\n}\n\n/**\n * Sub pixel optimize rect for canvas\n *\n * @param {Object} param\n * @param {Object} [param.shape]\n * @param {number} [param.shape.x]\n * @param {number} [param.shape.y]\n * @param {number} [param.shape.width]\n * @param {number} [param.shape.height]\n * @param {Object} [param.style]\n * @param {number} [param.style.lineWidth]\n * @return {Object} Modified param\n */\nfunction subPixelOptimizeRect(param) {\n    var shape = param.shape;\n    var lineWidth = param.style.lineWidth;\n    var originX = shape.x;\n    var originY = shape.y;\n    var originWidth = shape.width;\n    var originHeight = shape.height;\n    shape.x = subPixelOptimize(shape.x, lineWidth, true);\n    shape.y = subPixelOptimize(shape.y, lineWidth, true);\n    shape.width = Math.max(\n        subPixelOptimize(originX + originWidth, lineWidth, false) - shape.x,\n        originWidth === 0 ? 0 : 1\n    );\n    shape.height = Math.max(\n        subPixelOptimize(originY + originHeight, lineWidth, false) - shape.y,\n        originHeight === 0 ? 0 : 1\n    );\n    return param;\n}\n\n/**\n * Sub pixel optimize for canvas\n *\n * @param {number} position Coordinate, such as x, y\n * @param {number} lineWidth Should be nonnegative integer.\n * @param {boolean=} positiveOrNegative Default false (negative).\n * @return {number} Optimized position.\n */\nfunction subPixelOptimize(position, lineWidth, positiveOrNegative) {\n    // Assure that (position + lineWidth / 2) is near integer edge,\n    // otherwise line will be fuzzy in canvas.\n    var doubledPosition = round(position * 2);\n    return (doubledPosition + round(lineWidth)) % 2 === 0\n        ? doubledPosition / 2\n        : (doubledPosition + (positiveOrNegative ? 1 : -1)) / 2;\n}\n\nfunction hasFillOrStroke(fillOrStroke) {\n    return fillOrStroke != null && fillOrStroke != 'none';\n}\n\nfunction liftColor(color) {\n    return typeof color === 'string' ? lift(color, -0.1) : color;\n}\n\n/**\n * @private\n */\nfunction cacheElementStl(el) {\n    if (el.__hoverStlDirty) {\n        var stroke = el.style.stroke;\n        var fill = el.style.fill;\n\n        // Create hoverStyle on mouseover\n        var hoverStyle = el.__hoverStl;\n        hoverStyle.fill = hoverStyle.fill\n            || (hasFillOrStroke(fill) ? liftColor(fill) : null);\n        hoverStyle.stroke = hoverStyle.stroke\n            || (hasFillOrStroke(stroke) ? liftColor(stroke) : null);\n\n        var normalStyle = {};\n        for (var name in hoverStyle) {\n            // See comment in `doSingleEnterHover`.\n            if (hoverStyle[name] != null) {\n                normalStyle[name] = el.style[name];\n            }\n        }\n\n        el.__normalStl = normalStyle;\n\n        el.__hoverStlDirty = false;\n    }\n}\n\n/**\n * @private\n */\nfunction doSingleEnterHover(el) {\n    if (el.__isHover) {\n        return;\n    }\n\n    cacheElementStl(el);\n\n    if (el.useHoverLayer) {\n        el.__zr && el.__zr.addHover(el, el.__hoverStl);\n    }\n    else {\n        var style = el.style;\n        var insideRollbackOpt = style.insideRollbackOpt;\n\n        // Consider case: only `position: 'top'` is set on emphasis, then text\n        // color should be returned to `autoColor`, rather than remain '#fff'.\n        // So we should rollback then apply again after style merging.\n        insideRollbackOpt && rollbackInsideStyle(style);\n\n        // styles can be:\n        // {\n        //    label: {\n        //        show: false,\n        //        position: 'outside',\n        //        fontSize: 18\n        //    },\n        //    emphasis: {\n        //        label: {\n        //            show: true\n        //        }\n        //    }\n        // },\n        // where properties of `emphasis` may not appear in `normal`. We previously use\n        // module:echarts/util/model#defaultEmphasis to merge `normal` to `emphasis`.\n        // But consider rich text and setOption in merge mode, it is impossible to cover\n        // all properties in merge. So we use merge mode when setting style here, where\n        // only properties that is not `null/undefined` can be set. The disadventage:\n        // null/undefined can not be used to remove style any more in `emphasis`.\n        style.extendFrom(el.__hoverStl);\n\n        // Do not save `insideRollback`.\n        if (insideRollbackOpt) {\n            applyInsideStyle(style, style.insideOriginalTextPosition, insideRollbackOpt);\n\n            // textFill may be rollbacked to null.\n            if (style.textFill == null) {\n                style.textFill = insideRollbackOpt.autoColor;\n            }\n        }\n\n        el.dirty(false);\n        el.z2 += 1;\n    }\n\n    el.__isHover = true;\n}\n\n/**\n * @inner\n */\nfunction doSingleLeaveHover(el) {\n    if (!el.__isHover) {\n        return;\n    }\n\n    var normalStl = el.__normalStl;\n    if (el.useHoverLayer) {\n        el.__zr && el.__zr.removeHover(el);\n    }\n    else {\n        // Consider null/undefined value, should use\n        // `setStyle` but not `extendFrom(stl, true)`.\n        normalStl && el.setStyle(normalStl);\n        el.z2 -= 1;\n    }\n\n    el.__isHover = false;\n}\n\n/**\n * @inner\n */\nfunction doEnterHover(el) {\n    el.type === 'group'\n        ? el.traverse(function (child) {\n            if (child.type !== 'group') {\n                doSingleEnterHover(child);\n            }\n        })\n        : doSingleEnterHover(el);\n}\n\nfunction doLeaveHover(el) {\n    el.type === 'group'\n        ? el.traverse(function (child) {\n            if (child.type !== 'group') {\n                doSingleLeaveHover(child);\n            }\n        })\n        : doSingleLeaveHover(el);\n}\n\n/**\n * @inner\n */\nfunction setElementHoverStl(el, hoverStl) {\n    // If element has sepcified hoverStyle, then use it instead of given hoverStyle\n    // Often used when item group has a label element and it's hoverStyle is different\n    el.__hoverStl = el.hoverStyle || hoverStl || {};\n    el.__hoverStlDirty = true;\n\n    if (el.__isHover) {\n        cacheElementStl(el);\n    }\n}\n\n/**\n * @inner\n */\nfunction onElementMouseOver(e) {\n    if (this.__hoverSilentOnTouch && e.zrByTouch) {\n        return;\n    }\n\n    // Only if element is not in emphasis status\n    !this.__isEmphasis && doEnterHover(this);\n}\n\n/**\n * @inner\n */\nfunction onElementMouseOut(e) {\n    if (this.__hoverSilentOnTouch && e.zrByTouch) {\n        return;\n    }\n\n    // Only if element is not in emphasis status\n    !this.__isEmphasis && doLeaveHover(this);\n}\n\n/**\n * @inner\n */\nfunction enterEmphasis() {\n    this.__isEmphasis = true;\n    doEnterHover(this);\n}\n\n/**\n * @inner\n */\nfunction leaveEmphasis() {\n    this.__isEmphasis = false;\n    doLeaveHover(this);\n}\n\n/**\n * Set hover style of element.\n * This method can be called repeatly without side-effects.\n * @param {module:zrender/Element} el\n * @param {Object} [hoverStyle]\n * @param {Object} [opt]\n * @param {boolean} [opt.hoverSilentOnTouch=false]\n *        In touch device, mouseover event will be trigger on touchstart event\n *        (see module:zrender/dom/HandlerProxy). By this mechanism, we can\n *        conviniently use hoverStyle when tap on touch screen without additional\n *        code for compatibility.\n *        But if the chart/component has select feature, which usually also use\n *        hoverStyle, there might be conflict between 'select-highlight' and\n *        'hover-highlight' especially when roam is enabled (see geo for example).\n *        In this case, hoverSilentOnTouch should be used to disable hover-highlight\n *        on touch device.\n */\nfunction setHoverStyle(el, hoverStyle, opt) {\n    el.__hoverSilentOnTouch = opt && opt.hoverSilentOnTouch;\n\n    el.type === 'group'\n        ? el.traverse(function (child) {\n            if (child.type !== 'group') {\n                setElementHoverStl(child, hoverStyle);\n            }\n        })\n        : setElementHoverStl(el, hoverStyle);\n\n    // Duplicated function will be auto-ignored, see Eventful.js.\n    el.on('mouseover', onElementMouseOver)\n        .on('mouseout', onElementMouseOut);\n\n    // Emphasis, normal can be triggered manually\n    el.on('emphasis', enterEmphasis)\n        .on('normal', leaveEmphasis);\n}\n\n/**\n * @param {Object|module:zrender/graphic/Style} normalStyle\n * @param {Object} emphasisStyle\n * @param {module:echarts/model/Model} normalModel\n * @param {module:echarts/model/Model} emphasisModel\n * @param {Object} opt Check `opt` of `setTextStyleCommon` to find other props.\n * @param {string|Function} [opt.defaultText]\n * @param {module:echarts/model/Model} [opt.labelFetcher] Fetch text by\n *      `opt.labelFetcher.getFormattedLabel(opt.labelDataIndex, 'normal'/'emphasis', null, opt.labelDimIndex)`\n * @param {module:echarts/model/Model} [opt.labelDataIndex] Fetch text by\n *      `opt.textFetcher.getFormattedLabel(opt.labelDataIndex, 'normal'/'emphasis', null, opt.labelDimIndex)`\n * @param {module:echarts/model/Model} [opt.labelDimIndex] Fetch text by\n *      `opt.textFetcher.getFormattedLabel(opt.labelDataIndex, 'normal'/'emphasis', null, opt.labelDimIndex)`\n * @param {Object} [normalSpecified]\n * @param {Object} [emphasisSpecified]\n */\nfunction setLabelStyle(\n    normalStyle, emphasisStyle,\n    normalModel, emphasisModel,\n    opt,\n    normalSpecified, emphasisSpecified\n) {\n    opt = opt || EMPTY_OBJ;\n    var labelFetcher = opt.labelFetcher;\n    var labelDataIndex = opt.labelDataIndex;\n    var labelDimIndex = opt.labelDimIndex;\n\n    // This scenario, `label.normal.show = true; label.emphasis.show = false`,\n    // is not supported util someone requests.\n\n    var showNormal = normalModel.getShallow('show');\n    var showEmphasis = emphasisModel.getShallow('show');\n\n    // Consider performance, only fetch label when necessary.\n    // If `normal.show` is `false` and `emphasis.show` is `true` and `emphasis.formatter` is not set,\n    // label should be displayed, where text is fetched by `normal.formatter` or `opt.defaultText`.\n    var baseText;\n    if (showNormal || showEmphasis) {\n        if (labelFetcher) {\n            baseText = labelFetcher.getFormattedLabel(labelDataIndex, 'normal', null, labelDimIndex);\n        }\n        if (baseText == null) {\n            baseText = isFunction$1(opt.defaultText) ? opt.defaultText(labelDataIndex, opt) : opt.defaultText;\n        }\n    }\n    var normalStyleText = showNormal ? baseText : null;\n    var emphasisStyleText = showEmphasis\n        ? retrieve2(\n            labelFetcher\n                ? labelFetcher.getFormattedLabel(labelDataIndex, 'emphasis', null, labelDimIndex)\n                : null,\n            baseText\n        )\n        : null;\n\n    // Optimize: If style.text is null, text will not be drawn.\n    if (normalStyleText != null || emphasisStyleText != null) {\n        // Always set `textStyle` even if `normalStyle.text` is null, because default\n        // values have to be set on `normalStyle`.\n        // If we set default values on `emphasisStyle`, consider case:\n        // Firstly, `setOption(... label: {normal: {text: null}, emphasis: {show: true}} ...);`\n        // Secondly, `setOption(... label: {noraml: {show: true, text: 'abc', color: 'red'} ...);`\n        // Then the 'red' will not work on emphasis.\n        setTextStyle(normalStyle, normalModel, normalSpecified, opt);\n        setTextStyle(emphasisStyle, emphasisModel, emphasisSpecified, opt, true);\n    }\n\n    normalStyle.text = normalStyleText;\n    emphasisStyle.text = emphasisStyleText;\n}\n\n/**\n * Set basic textStyle properties.\n * @param {Object|module:zrender/graphic/Style} textStyle\n * @param {module:echarts/model/Model} model\n * @param {Object} [specifiedTextStyle] Can be overrided by settings in model.\n * @param {Object} [opt] See `opt` of `setTextStyleCommon`.\n * @param {boolean} [isEmphasis]\n */\nfunction setTextStyle(\n    textStyle, textStyleModel, specifiedTextStyle, opt, isEmphasis\n) {\n    setTextStyleCommon(textStyle, textStyleModel, opt, isEmphasis);\n    specifiedTextStyle && extend(textStyle, specifiedTextStyle);\n    textStyle.host && textStyle.host.dirty && textStyle.host.dirty(false);\n\n    return textStyle;\n}\n\n/**\n * Set text option in the style.\n * @deprecated\n * @param {Object} textStyle\n * @param {module:echarts/model/Model} labelModel\n * @param {string|boolean} defaultColor Default text color.\n *        If set as false, it will be processed as a emphasis style.\n */\nfunction setText(textStyle, labelModel, defaultColor) {\n    var opt = {isRectText: true};\n    var isEmphasis;\n\n    if (defaultColor === false) {\n        isEmphasis = true;\n    }\n    else {\n        // Support setting color as 'auto' to get visual color.\n        opt.autoColor = defaultColor;\n    }\n    setTextStyleCommon(textStyle, labelModel, opt, isEmphasis);\n    textStyle.host && textStyle.host.dirty && textStyle.host.dirty(false);\n}\n\n/**\n * {\n *      disableBox: boolean, Whether diable drawing box of block (outer most).\n *      isRectText: boolean,\n *      autoColor: string, specify a color when color is 'auto',\n *              for textFill, textStroke, textBackgroundColor, and textBorderColor.\n *              If autoColor specified, it is used as default textFill.\n *      useInsideStyle:\n *              `true`: Use inside style (textFill, textStroke, textStrokeWidth)\n *                  if `textFill` is not specified.\n *              `false`: Do not use inside style.\n *              `null/undefined`: use inside style if `isRectText` is true and\n *                  `textFill` is not specified and textPosition contains `'inside'`.\n *      forceRich: boolean\n * }\n */\nfunction setTextStyleCommon(textStyle, textStyleModel, opt, isEmphasis) {\n    // Consider there will be abnormal when merge hover style to normal style if given default value.\n    opt = opt || EMPTY_OBJ;\n\n    if (opt.isRectText) {\n        var textPosition = textStyleModel.getShallow('position')\n            || (isEmphasis ? null : 'inside');\n        // 'outside' is not a valid zr textPostion value, but used\n        // in bar series, and magric type should be considered.\n        textPosition === 'outside' && (textPosition = 'top');\n        textStyle.textPosition = textPosition;\n        textStyle.textOffset = textStyleModel.getShallow('offset');\n        var labelRotate = textStyleModel.getShallow('rotate');\n        labelRotate != null && (labelRotate *= Math.PI / 180);\n        textStyle.textRotation = labelRotate;\n        textStyle.textDistance = retrieve2(\n            textStyleModel.getShallow('distance'), isEmphasis ? null : 5\n        );\n    }\n\n    var ecModel = textStyleModel.ecModel;\n    var globalTextStyle = ecModel && ecModel.option.textStyle;\n\n    // Consider case:\n    // {\n    //     data: [{\n    //         value: 12,\n    //         label: {\n    //             rich: {\n    //                 // no 'a' here but using parent 'a'.\n    //             }\n    //         }\n    //     }],\n    //     rich: {\n    //         a: { ... }\n    //     }\n    // }\n    var richItemNames = getRichItemNames(textStyleModel);\n    var richResult;\n    if (richItemNames) {\n        richResult = {};\n        for (var name in richItemNames) {\n            if (richItemNames.hasOwnProperty(name)) {\n                // Cascade is supported in rich.\n                var richTextStyle = textStyleModel.getModel(['rich', name]);\n                // In rich, never `disableBox`.\n                setTokenTextStyle(richResult[name] = {}, richTextStyle, globalTextStyle, opt, isEmphasis);\n            }\n        }\n    }\n    textStyle.rich = richResult;\n\n    setTokenTextStyle(textStyle, textStyleModel, globalTextStyle, opt, isEmphasis, true);\n\n    if (opt.forceRich && !opt.textStyle) {\n        opt.textStyle = {};\n    }\n\n    return textStyle;\n}\n\n// Consider case:\n// {\n//     data: [{\n//         value: 12,\n//         label: {\n//             rich: {\n//                 // no 'a' here but using parent 'a'.\n//             }\n//         }\n//     }],\n//     rich: {\n//         a: { ... }\n//     }\n// }\nfunction getRichItemNames(textStyleModel) {\n    // Use object to remove duplicated names.\n    var richItemNameMap;\n    while (textStyleModel && textStyleModel !== textStyleModel.ecModel) {\n        var rich = (textStyleModel.option || EMPTY_OBJ).rich;\n        if (rich) {\n            richItemNameMap = richItemNameMap || {};\n            for (var name in rich) {\n                if (rich.hasOwnProperty(name)) {\n                    richItemNameMap[name] = 1;\n                }\n            }\n        }\n        textStyleModel = textStyleModel.parentModel;\n    }\n    return richItemNameMap;\n}\n\nfunction setTokenTextStyle(textStyle, textStyleModel, globalTextStyle, opt, isEmphasis, isBlock) {\n    // In merge mode, default value should not be given.\n    globalTextStyle = !isEmphasis && globalTextStyle || EMPTY_OBJ;\n\n    textStyle.textFill = getAutoColor(textStyleModel.getShallow('color'), opt)\n        || globalTextStyle.color;\n    textStyle.textStroke = getAutoColor(textStyleModel.getShallow('textBorderColor'), opt)\n        || globalTextStyle.textBorderColor;\n    textStyle.textStrokeWidth = retrieve2(\n        textStyleModel.getShallow('textBorderWidth'),\n        globalTextStyle.textBorderWidth\n    );\n\n    if (!isEmphasis) {\n        if (isBlock) {\n            // Always set `insideRollback`, for clearing previous.\n            var originalTextPosition = textStyle.textPosition;\n            textStyle.insideRollback = applyInsideStyle(textStyle, originalTextPosition, opt);\n            // Save original textPosition, because style.textPosition will be repalced by\n            // real location (like [10, 30]) in zrender.\n            textStyle.insideOriginalTextPosition = originalTextPosition;\n            textStyle.insideRollbackOpt = opt;\n        }\n\n        // Set default finally.\n        if (textStyle.textFill == null) {\n            textStyle.textFill = opt.autoColor;\n        }\n    }\n\n    // Do not use `getFont` here, because merge should be supported, where\n    // part of these properties may be changed in emphasis style, and the\n    // others should remain their original value got from normal style.\n    textStyle.fontStyle = textStyleModel.getShallow('fontStyle') || globalTextStyle.fontStyle;\n    textStyle.fontWeight = textStyleModel.getShallow('fontWeight') || globalTextStyle.fontWeight;\n    textStyle.fontSize = textStyleModel.getShallow('fontSize') || globalTextStyle.fontSize;\n    textStyle.fontFamily = textStyleModel.getShallow('fontFamily') || globalTextStyle.fontFamily;\n\n    textStyle.textAlign = textStyleModel.getShallow('align');\n    textStyle.textVerticalAlign = textStyleModel.getShallow('verticalAlign')\n        || textStyleModel.getShallow('baseline');\n\n    textStyle.textLineHeight = textStyleModel.getShallow('lineHeight');\n    textStyle.textWidth = textStyleModel.getShallow('width');\n    textStyle.textHeight = textStyleModel.getShallow('height');\n    textStyle.textTag = textStyleModel.getShallow('tag');\n\n    if (!isBlock || !opt.disableBox) {\n        textStyle.textBackgroundColor = getAutoColor(textStyleModel.getShallow('backgroundColor'), opt);\n        textStyle.textPadding = textStyleModel.getShallow('padding');\n        textStyle.textBorderColor = getAutoColor(textStyleModel.getShallow('borderColor'), opt);\n        textStyle.textBorderWidth = textStyleModel.getShallow('borderWidth');\n        textStyle.textBorderRadius = textStyleModel.getShallow('borderRadius');\n\n        textStyle.textBoxShadowColor = textStyleModel.getShallow('shadowColor');\n        textStyle.textBoxShadowBlur = textStyleModel.getShallow('shadowBlur');\n        textStyle.textBoxShadowOffsetX = textStyleModel.getShallow('shadowOffsetX');\n        textStyle.textBoxShadowOffsetY = textStyleModel.getShallow('shadowOffsetY');\n    }\n\n    textStyle.textShadowColor = textStyleModel.getShallow('textShadowColor')\n        || globalTextStyle.textShadowColor;\n    textStyle.textShadowBlur = textStyleModel.getShallow('textShadowBlur')\n        || globalTextStyle.textShadowBlur;\n    textStyle.textShadowOffsetX = textStyleModel.getShallow('textShadowOffsetX')\n        || globalTextStyle.textShadowOffsetX;\n    textStyle.textShadowOffsetY = textStyleModel.getShallow('textShadowOffsetY')\n        || globalTextStyle.textShadowOffsetY;\n}\n\nfunction getAutoColor(color, opt) {\n    return color !== 'auto' ? color : (opt && opt.autoColor) ? opt.autoColor : null;\n}\n\nfunction applyInsideStyle(textStyle, textPosition, opt) {\n    var useInsideStyle = opt.useInsideStyle;\n    var insideRollback;\n\n    if (textStyle.textFill == null\n        && useInsideStyle !== false\n        && (useInsideStyle === true\n            || (opt.isRectText\n                && textPosition\n                // textPosition can be [10, 30]\n                && typeof textPosition === 'string'\n                && textPosition.indexOf('inside') >= 0\n            )\n        )\n    ) {\n        insideRollback = {\n            textFill: null,\n            textStroke: textStyle.textStroke,\n            textStrokeWidth: textStyle.textStrokeWidth\n        };\n        textStyle.textFill = '#fff';\n        // Consider text with #fff overflow its container.\n        if (textStyle.textStroke == null) {\n            textStyle.textStroke = opt.autoColor;\n            textStyle.textStrokeWidth == null && (textStyle.textStrokeWidth = 2);\n        }\n    }\n\n    return insideRollback;\n}\n\nfunction rollbackInsideStyle(style) {\n    var insideRollback = style.insideRollback;\n    if (insideRollback) {\n        style.textFill = insideRollback.textFill;\n        style.textStroke = insideRollback.textStroke;\n        style.textStrokeWidth = insideRollback.textStrokeWidth;\n    }\n}\n\nfunction getFont(opt, ecModel) {\n    // ecModel or default text style model.\n    var gTextStyleModel = ecModel || ecModel.getModel('textStyle');\n    return trim([\n        // FIXME in node-canvas fontWeight is before fontStyle\n        opt.fontStyle || gTextStyleModel && gTextStyleModel.getShallow('fontStyle') || '',\n        opt.fontWeight || gTextStyleModel && gTextStyleModel.getShallow('fontWeight') || '',\n        (opt.fontSize || gTextStyleModel && gTextStyleModel.getShallow('fontSize') || 12) + 'px',\n        opt.fontFamily || gTextStyleModel && gTextStyleModel.getShallow('fontFamily') || 'sans-serif'\n    ].join(' '));\n}\n\nfunction animateOrSetProps(isUpdate, el, props, animatableModel, dataIndex, cb) {\n    if (typeof dataIndex === 'function') {\n        cb = dataIndex;\n        dataIndex = null;\n    }\n    // Do not check 'animation' property directly here. Consider this case:\n    // animation model is an `itemModel`, whose does not have `isAnimationEnabled`\n    // but its parent model (`seriesModel`) does.\n    var animationEnabled = animatableModel && animatableModel.isAnimationEnabled();\n\n    if (animationEnabled) {\n        var postfix = isUpdate ? 'Update' : '';\n        var duration = animatableModel.getShallow('animationDuration' + postfix);\n        var animationEasing = animatableModel.getShallow('animationEasing' + postfix);\n        var animationDelay = animatableModel.getShallow('animationDelay' + postfix);\n        if (typeof animationDelay === 'function') {\n            animationDelay = animationDelay(\n                dataIndex,\n                animatableModel.getAnimationDelayParams\n                    ? animatableModel.getAnimationDelayParams(el, dataIndex)\n                    : null\n            );\n        }\n        if (typeof duration === 'function') {\n            duration = duration(dataIndex);\n        }\n\n        duration > 0\n            ? el.animateTo(props, duration, animationDelay || 0, animationEasing, cb, !!cb)\n            : (el.stopAnimation(), el.attr(props), cb && cb());\n    }\n    else {\n        el.stopAnimation();\n        el.attr(props);\n        cb && cb();\n    }\n}\n\n/**\n * Update graphic element properties with or without animation according to the\n * configuration in series.\n *\n * Caution: this method will stop previous animation.\n * So if do not use this method to one element twice before\n * animation starts, unless you know what you are doing.\n *\n * @param {module:zrender/Element} el\n * @param {Object} props\n * @param {module:echarts/model/Model} [animatableModel]\n * @param {number} [dataIndex]\n * @param {Function} [cb]\n * @example\n *     graphic.updateProps(el, {\n *         position: [100, 100]\n *     }, seriesModel, dataIndex, function () { console.log('Animation done!'); });\n *     // Or\n *     graphic.updateProps(el, {\n *         position: [100, 100]\n *     }, seriesModel, function () { console.log('Animation done!'); });\n */\nfunction updateProps(el, props, animatableModel, dataIndex, cb) {\n    animateOrSetProps(true, el, props, animatableModel, dataIndex, cb);\n}\n\n/**\n * Init graphic element properties with or without animation according to the\n * configuration in series.\n *\n * Caution: this method will stop previous animation.\n * So if do not use this method to one element twice before\n * animation starts, unless you know what you are doing.\n *\n * @param {module:zrender/Element} el\n * @param {Object} props\n * @param {module:echarts/model/Model} [animatableModel]\n * @param {number} [dataIndex]\n * @param {Function} cb\n */\nfunction initProps(el, props, animatableModel, dataIndex, cb) {\n    animateOrSetProps(false, el, props, animatableModel, dataIndex, cb);\n}\n\n/**\n * Get transform matrix of target (param target),\n * in coordinate of its ancestor (param ancestor)\n *\n * @param {module:zrender/mixin/Transformable} target\n * @param {module:zrender/mixin/Transformable} [ancestor]\n */\nfunction getTransform(target, ancestor) {\n    var mat = identity([]);\n\n    while (target && target !== ancestor) {\n        mul$1(mat, target.getLocalTransform(), mat);\n        target = target.parent;\n    }\n\n    return mat;\n}\n\n/**\n * Apply transform to an vertex.\n * @param {Array.<number>} target [x, y]\n * @param {Array.<number>|TypedArray.<number>|Object} transform Can be:\n *      + Transform matrix: like [1, 0, 0, 1, 0, 0]\n *      + {position, rotation, scale}, the same as `zrender/Transformable`.\n * @param {boolean=} invert Whether use invert matrix.\n * @return {Array.<number>} [x, y]\n */\nfunction applyTransform$1(target, transform, invert$$1) {\n    if (transform && !isArrayLike(transform)) {\n        transform = Transformable.getLocalTransform(transform);\n    }\n\n    if (invert$$1) {\n        transform = invert([], transform);\n    }\n    return applyTransform([], target, transform);\n}\n\n/**\n * @param {string} direction 'left' 'right' 'top' 'bottom'\n * @param {Array.<number>} transform Transform matrix: like [1, 0, 0, 1, 0, 0]\n * @param {boolean=} invert Whether use invert matrix.\n * @return {string} Transformed direction. 'left' 'right' 'top' 'bottom'\n */\nfunction transformDirection(direction, transform, invert$$1) {\n\n    // Pick a base, ensure that transform result will not be (0, 0).\n    var hBase = (transform[4] === 0 || transform[5] === 0 || transform[0] === 0)\n        ? 1 : Math.abs(2 * transform[4] / transform[0]);\n    var vBase = (transform[4] === 0 || transform[5] === 0 || transform[2] === 0)\n        ? 1 : Math.abs(2 * transform[4] / transform[2]);\n\n    var vertex = [\n        direction === 'left' ? -hBase : direction === 'right' ? hBase : 0,\n        direction === 'top' ? -vBase : direction === 'bottom' ? vBase : 0\n    ];\n\n    vertex = applyTransform$1(vertex, transform, invert$$1);\n\n    return Math.abs(vertex[0]) > Math.abs(vertex[1])\n        ? (vertex[0] > 0 ? 'right' : 'left')\n        : (vertex[1] > 0 ? 'bottom' : 'top');\n}\n\n/**\n * Apply group transition animation from g1 to g2.\n * If no animatableModel, no animation.\n */\nfunction groupTransition(g1, g2, animatableModel, cb) {\n    if (!g1 || !g2) {\n        return;\n    }\n\n    function getElMap(g) {\n        var elMap = {};\n        g.traverse(function (el) {\n            if (!el.isGroup && el.anid) {\n                elMap[el.anid] = el;\n            }\n        });\n        return elMap;\n    }\n    function getAnimatableProps(el) {\n        var obj = {\n            position: clone$1(el.position),\n            rotation: el.rotation\n        };\n        if (el.shape) {\n            obj.shape = extend({}, el.shape);\n        }\n        return obj;\n    }\n    var elMap1 = getElMap(g1);\n\n    g2.traverse(function (el) {\n        if (!el.isGroup && el.anid) {\n            var oldEl = elMap1[el.anid];\n            if (oldEl) {\n                var newProp = getAnimatableProps(el);\n                el.attr(getAnimatableProps(oldEl));\n                updateProps(el, newProp, animatableModel, el.dataIndex);\n            }\n            // else {\n            //     if (el.previousProps) {\n            //         graphic.updateProps\n            //     }\n            // }\n        }\n    });\n}\n\n/**\n * @param {Array.<Array.<number>>} points Like: [[23, 44], [53, 66], ...]\n * @param {Object} rect {x, y, width, height}\n * @return {Array.<Array.<number>>} A new clipped points.\n */\nfunction clipPointsByRect(points, rect) {\n    return map(points, function (point) {\n        var x = point[0];\n        x = mathMax$1(x, rect.x);\n        x = mathMin$1(x, rect.x + rect.width);\n        var y = point[1];\n        y = mathMax$1(y, rect.y);\n        y = mathMin$1(y, rect.y + rect.height);\n        return [x, y];\n    });\n}\n\n/**\n * @param {Object} targetRect {x, y, width, height}\n * @param {Object} rect {x, y, width, height}\n * @return {Object} A new clipped rect. If rect size are negative, return undefined.\n */\nfunction clipRectByRect(targetRect, rect) {\n    var x = mathMax$1(targetRect.x, rect.x);\n    var x2 = mathMin$1(targetRect.x + targetRect.width, rect.x + rect.width);\n    var y = mathMax$1(targetRect.y, rect.y);\n    var y2 = mathMin$1(targetRect.y + targetRect.height, rect.y + rect.height);\n\n    if (x2 >= x && y2 >= y) {\n        return {\n            x: x,\n            y: y,\n            width: x2 - x,\n            height: y2 - y\n        };\n    }\n}\n\n/**\n * @param {string} iconStr Support 'image://' or 'path://' or direct svg path.\n * @param {Object} [opt] Properties of `module:zrender/Element`, except `style`.\n * @param {Object} [rect] {x, y, width, height}\n * @return {module:zrender/Element} Icon path or image element.\n */\nfunction createIcon(iconStr, opt, rect) {\n    opt = extend({rectHover: true}, opt);\n    var style = opt.style = {strokeNoScale: true};\n    rect = rect || {x: -1, y: -1, width: 2, height: 2};\n\n    if (iconStr) {\n        return iconStr.indexOf('image://') === 0\n            ? (\n                style.image = iconStr.slice(8),\n                defaults(style, rect),\n                new ZImage(opt)\n            )\n            : (\n                makePath(\n                    iconStr.replace('path://', ''),\n                    opt,\n                    rect,\n                    'center'\n                )\n            );\n    }\n}\n\n\n\n\nvar graphic = (Object.freeze || Object)({\n\textendShape: extendShape,\n\textendPath: extendPath,\n\tmakePath: makePath,\n\tmakeImage: makeImage,\n\tmergePath: mergePath,\n\tresizePath: resizePath,\n\tsubPixelOptimizeLine: subPixelOptimizeLine,\n\tsubPixelOptimizeRect: subPixelOptimizeRect,\n\tsubPixelOptimize: subPixelOptimize,\n\tsetHoverStyle: setHoverStyle,\n\tsetLabelStyle: setLabelStyle,\n\tsetTextStyle: setTextStyle,\n\tsetText: setText,\n\tgetFont: getFont,\n\tupdateProps: updateProps,\n\tinitProps: initProps,\n\tgetTransform: getTransform,\n\tapplyTransform: applyTransform$1,\n\ttransformDirection: transformDirection,\n\tgroupTransition: groupTransition,\n\tclipPointsByRect: clipPointsByRect,\n\tclipRectByRect: clipRectByRect,\n\tcreateIcon: createIcon,\n\tGroup: Group,\n\tImage: ZImage,\n\tText: Text,\n\tCircle: Circle,\n\tSector: Sector,\n\tRing: Ring,\n\tPolygon: Polygon,\n\tPolyline: Polyline,\n\tRect: Rect,\n\tLine: Line,\n\tBezierCurve: BezierCurve,\n\tArc: Arc,\n\tIncrementalDisplayable: IncrementalDisplayble,\n\tCompoundPath: CompoundPath,\n\tLinearGradient: LinearGradient,\n\tRadialGradient: RadialGradient,\n\tBoundingRect: BoundingRect\n});\n\nvar PATH_COLOR = ['textStyle', 'color'];\n\nvar textStyleMixin = {\n    /**\n     * Get color property or get color from option.textStyle.color\n     * @param {boolean} [isEmphasis]\n     * @return {string}\n     */\n    getTextColor: function (isEmphasis) {\n        var ecModel = this.ecModel;\n        return this.getShallow('color')\n            || (\n                (!isEmphasis && ecModel) ? ecModel.get(PATH_COLOR) : null\n            );\n    },\n\n    /**\n     * Create font string from fontStyle, fontWeight, fontSize, fontFamily\n     * @return {string}\n     */\n    getFont: function () {\n        return getFont({\n            fontStyle: this.getShallow('fontStyle'),\n            fontWeight: this.getShallow('fontWeight'),\n            fontSize: this.getShallow('fontSize'),\n            fontFamily: this.getShallow('fontFamily')\n        }, this.ecModel);\n    },\n\n    getTextRect: function (text) {\n        return getBoundingRect(\n            text,\n            this.getFont(),\n            this.getShallow('align'),\n            this.getShallow('verticalAlign') || this.getShallow('baseline'),\n            this.getShallow('padding'),\n            this.getShallow('rich'),\n            this.getShallow('truncateText')\n        );\n    }\n};\n\nvar getItemStyle = makeStyleMapper(\n    [\n        ['fill', 'color'],\n        ['stroke', 'borderColor'],\n        ['lineWidth', 'borderWidth'],\n        ['opacity'],\n        ['shadowBlur'],\n        ['shadowOffsetX'],\n        ['shadowOffsetY'],\n        ['shadowColor'],\n        ['textPosition'],\n        ['textAlign']\n    ]\n);\n\nvar itemStyleMixin = {\n    getItemStyle: function (excludes, includes) {\n        var style = getItemStyle(this, excludes, includes);\n        var lineDash = this.getBorderLineDash();\n        lineDash && (style.lineDash = lineDash);\n        return style;\n    },\n\n    getBorderLineDash: function () {\n        var lineType = this.get('borderType');\n        return (lineType === 'solid' || lineType == null) ? null\n            : (lineType === 'dashed' ? [5, 5] : [1, 1]);\n    }\n};\n\n/**\n * @module echarts/model/Model\n */\n\nvar mixin$1 = mixin;\nvar inner = makeInner();\n\n/**\n * @alias module:echarts/model/Model\n * @constructor\n * @param {Object} option\n * @param {module:echarts/model/Model} [parentModel]\n * @param {module:echarts/model/Global} [ecModel]\n */\nfunction Model(option, parentModel, ecModel) {\n    /**\n     * @type {module:echarts/model/Model}\n     * @readOnly\n     */\n    this.parentModel = parentModel;\n\n    /**\n     * @type {module:echarts/model/Global}\n     * @readOnly\n     */\n    this.ecModel = ecModel;\n\n    /**\n     * @type {Object}\n     * @protected\n     */\n    this.option = option;\n\n    // Simple optimization\n    // if (this.init) {\n    //     if (arguments.length <= 4) {\n    //         this.init(option, parentModel, ecModel, extraOpt);\n    //     }\n    //     else {\n    //         this.init.apply(this, arguments);\n    //     }\n    // }\n}\n\nModel.prototype = {\n\n    constructor: Model,\n\n    /**\n     * Model \n     * @param {Object} option\n     */\n    init: null,\n\n    /**\n     *  Option merge\n     */\n    mergeOption: function (option) {\n        merge(this.option, option, true);\n    },\n\n    /**\n     * @param {string|Array.<string>} path\n     * @param {boolean} [ignoreParent=false]\n     * @return {*}\n     */\n    get: function (path, ignoreParent) {\n        if (path == null) {\n            return this.option;\n        }\n\n        return doGet(\n            this.option,\n            this.parsePath(path),\n            !ignoreParent && getParent(this, path)\n        );\n    },\n\n    /**\n     * @param {string} key\n     * @param {boolean} [ignoreParent=false]\n     * @return {*}\n     */\n    getShallow: function (key, ignoreParent) {\n        var option = this.option;\n\n        var val = option == null ? option : option[key];\n        var parentModel = !ignoreParent && getParent(this, key);\n        if (val == null && parentModel) {\n            val = parentModel.getShallow(key);\n        }\n        return val;\n    },\n\n    /**\n     * @param {string|Array.<string>} [path]\n     * @param {module:echarts/model/Model} [parentModel]\n     * @return {module:echarts/model/Model}\n     */\n    getModel: function (path, parentModel) {\n        var obj = path == null\n            ? this.option\n            : doGet(this.option, path = this.parsePath(path));\n\n        var thisParentModel;\n        parentModel = parentModel || (\n            (thisParentModel = getParent(this, path))\n                && thisParentModel.getModel(path)\n        );\n\n        return new Model(obj, parentModel, this.ecModel);\n    },\n\n    /**\n     * If model has option\n     */\n    isEmpty: function () {\n        return this.option == null;\n    },\n\n    restoreData: function () {},\n\n    // Pending\n    clone: function () {\n        var Ctor = this.constructor;\n        return new Ctor(clone(this.option));\n    },\n\n    setReadOnly: function (properties) {\n        // clazzUtil.setReadOnly(this, properties);\n    },\n\n    // If path is null/undefined, return null/undefined.\n    parsePath: function(path) {\n        if (typeof path === 'string') {\n            path = path.split('.');\n        }\n        return path;\n    },\n\n    /**\n     * @param {Function} getParentMethod\n     *        param {Array.<string>|string} path\n     *        return {module:echarts/model/Model}\n     */\n    customizeGetParent: function (getParentMethod) {\n        inner(this).getParent = getParentMethod;\n    },\n\n    isAnimationEnabled: function () {\n        if (!env$1.node) {\n            if (this.option.animation != null) {\n                return !!this.option.animation;\n            }\n            else if (this.parentModel) {\n                return this.parentModel.isAnimationEnabled();\n            }\n        }\n    }\n\n};\n\nfunction doGet(obj, pathArr, parentModel) {\n    for (var i = 0; i < pathArr.length; i++) {\n        // Ignore empty\n        if (!pathArr[i]) {\n            continue;\n        }\n        // obj could be number/string/... (like 0)\n        obj = (obj && typeof obj === 'object') ? obj[pathArr[i]] : null;\n        if (obj == null) {\n            break;\n        }\n    }\n    if (obj == null && parentModel) {\n        obj = parentModel.get(pathArr);\n    }\n    return obj;\n}\n\n// `path` can be null/undefined\nfunction getParent(model, path) {\n    var getParentMethod = inner(model).getParent;\n    return getParentMethod ? getParentMethod.call(model, path) : model.parentModel;\n}\n\n// Enable Model.extend.\nenableClassExtend(Model);\nenableClassCheck(Model);\n\nmixin$1(Model, lineStyleMixin);\nmixin$1(Model, areaStyleMixin);\nmixin$1(Model, textStyleMixin);\nmixin$1(Model, itemStyleMixin);\n\nvar base = 0;\n\n/**\n * @public\n * @param {string} type\n * @return {string}\n */\nfunction getUID(type) {\n    // Considering the case of crossing js context,\n    // use Math.random to make id as unique as possible.\n    return [(type || ''), base++, Math.random().toFixed(5)].join('_');\n}\n\n/**\n * @inner\n */\nfunction enableSubTypeDefaulter(entity) {\n\n    var subTypeDefaulters = {};\n\n    entity.registerSubTypeDefaulter = function (componentType, defaulter) {\n        componentType = parseClassType$1(componentType);\n        subTypeDefaulters[componentType.main] = defaulter;\n    };\n\n    entity.determineSubType = function (componentType, option) {\n        var type = option.type;\n        if (!type) {\n            var componentTypeMain = parseClassType$1(componentType).main;\n            if (entity.hasSubTypes(componentType) && subTypeDefaulters[componentTypeMain]) {\n                type = subTypeDefaulters[componentTypeMain](option);\n            }\n        }\n        return type;\n    };\n\n    return entity;\n}\n\n/**\n * Topological travel on Activity Network (Activity On Vertices).\n * Dependencies is defined in Model.prototype.dependencies, like ['xAxis', 'yAxis'].\n *\n * If 'xAxis' or 'yAxis' is absent in componentTypeList, just ignore it in topology.\n *\n * If there is circle dependencey, Error will be thrown.\n *\n */\nfunction enableTopologicalTravel(entity, dependencyGetter) {\n\n    /**\n     * @public\n     * @param {Array.<string>} targetNameList Target Component type list.\n     *                                           Can be ['aa', 'bb', 'aa.xx']\n     * @param {Array.<string>} fullNameList By which we can build dependency graph.\n     * @param {Function} callback Params: componentType, dependencies.\n     * @param {Object} context Scope of callback.\n     */\n    entity.topologicalTravel = function (targetNameList, fullNameList, callback, context) {\n        if (!targetNameList.length) {\n            return;\n        }\n\n        var result = makeDepndencyGraph(fullNameList);\n        var graph = result.graph;\n        var stack = result.noEntryList;\n\n        var targetNameSet = {};\n        each$1(targetNameList, function (name) {\n            targetNameSet[name] = true;\n        });\n\n        while (stack.length) {\n            var currComponentType = stack.pop();\n            var currVertex = graph[currComponentType];\n            var isInTargetNameSet = !!targetNameSet[currComponentType];\n            if (isInTargetNameSet) {\n                callback.call(context, currComponentType, currVertex.originalDeps.slice());\n                delete targetNameSet[currComponentType];\n            }\n            each$1(\n                currVertex.successor,\n                isInTargetNameSet ? removeEdgeAndAdd : removeEdge\n            );\n        }\n\n        each$1(targetNameSet, function () {\n            throw new Error('Circle dependency may exists');\n        });\n\n        function removeEdge(succComponentType) {\n            graph[succComponentType].entryCount--;\n            if (graph[succComponentType].entryCount === 0) {\n                stack.push(succComponentType);\n            }\n        }\n\n        // Consider this case: legend depends on series, and we call\n        // chart.setOption({series: [...]}), where only series is in option.\n        // If we do not have 'removeEdgeAndAdd', legendModel.mergeOption will\n        // not be called, but only sereis.mergeOption is called. Thus legend\n        // have no chance to update its local record about series (like which\n        // name of series is available in legend).\n        function removeEdgeAndAdd(succComponentType) {\n            targetNameSet[succComponentType] = true;\n            removeEdge(succComponentType);\n        }\n    };\n\n    /**\n     * DepndencyGraph: {Object}\n     * key: conponentType,\n     * value: {\n     *     successor: [conponentTypes...],\n     *     originalDeps: [conponentTypes...],\n     *     entryCount: {number}\n     * }\n     */\n    function makeDepndencyGraph(fullNameList) {\n        var graph = {};\n        var noEntryList = [];\n\n        each$1(fullNameList, function (name) {\n\n            var thisItem = createDependencyGraphItem(graph, name);\n            var originalDeps = thisItem.originalDeps = dependencyGetter(name);\n\n            var availableDeps = getAvailableDependencies(originalDeps, fullNameList);\n            thisItem.entryCount = availableDeps.length;\n            if (thisItem.entryCount === 0) {\n                noEntryList.push(name);\n            }\n\n            each$1(availableDeps, function (dependentName) {\n                if (indexOf(thisItem.predecessor, dependentName) < 0) {\n                    thisItem.predecessor.push(dependentName);\n                }\n                var thatItem = createDependencyGraphItem(graph, dependentName);\n                if (indexOf(thatItem.successor, dependentName) < 0) {\n                    thatItem.successor.push(name);\n                }\n            });\n        });\n\n        return {graph: graph, noEntryList: noEntryList};\n    }\n\n    function createDependencyGraphItem(graph, name) {\n        if (!graph[name]) {\n            graph[name] = {predecessor: [], successor: []};\n        }\n        return graph[name];\n    }\n\n    function getAvailableDependencies(originalDeps, fullNameList) {\n        var availableDeps = [];\n        each$1(originalDeps, function (dep) {\n            indexOf(fullNameList, dep) >= 0 && availableDeps.push(dep);\n        });\n        return availableDeps;\n    }\n}\n\nvar RADIAN_EPSILON = 1e-4;\n\nfunction _trim(str) {\n    return str.replace(/^\\s+/, '').replace(/\\s+$/, '');\n}\n\n/**\n * Linear mapping a value from domain to range\n * @memberOf module:echarts/util/number\n * @param  {(number|Array.<number>)} val\n * @param  {Array.<number>} domain Domain extent domain[0] can be bigger than domain[1]\n * @param  {Array.<number>} range  Range extent range[0] can be bigger than range[1]\n * @param  {boolean} clamp\n * @return {(number|Array.<number>}\n */\nfunction linearMap(val, domain, range, clamp) {\n    var subDomain = domain[1] - domain[0];\n    var subRange = range[1] - range[0];\n\n    if (subDomain === 0) {\n        return subRange === 0\n            ? range[0]\n            : (range[0] + range[1]) / 2;\n    }\n\n    // Avoid accuracy problem in edge, such as\n    // 146.39 - 62.83 === 83.55999999999999.\n    // See echarts/test/ut/spec/util/number.js#linearMap#accuracyError\n    // It is a little verbose for efficiency considering this method\n    // is a hotspot.\n    if (clamp) {\n        if (subDomain > 0) {\n            if (val <= domain[0]) {\n                return range[0];\n            }\n            else if (val >= domain[1]) {\n                return range[1];\n            }\n        }\n        else {\n            if (val >= domain[0]) {\n                return range[0];\n            }\n            else if (val <= domain[1]) {\n                return range[1];\n            }\n        }\n    }\n    else {\n        if (val === domain[0]) {\n            return range[0];\n        }\n        if (val === domain[1]) {\n            return range[1];\n        }\n    }\n\n    return (val - domain[0]) / subDomain * subRange + range[0];\n}\n\n/**\n * Convert a percent string to absolute number.\n * Returns NaN if percent is not a valid string or number\n * @memberOf module:echarts/util/number\n * @param {string|number} percent\n * @param {number} all\n * @return {number}\n */\nfunction parsePercent$1(percent, all) {\n    switch (percent) {\n        case 'center':\n        case 'middle':\n            percent = '50%';\n            break;\n        case 'left':\n        case 'top':\n            percent = '0%';\n            break;\n        case 'right':\n        case 'bottom':\n            percent = '100%';\n            break;\n    }\n    if (typeof percent === 'string') {\n        if (_trim(percent).match(/%$/)) {\n            return parseFloat(percent) / 100 * all;\n        }\n\n        return parseFloat(percent);\n    }\n\n    return percent == null ? NaN : +percent;\n}\n\n/**\n * (1) Fix rounding error of float numbers.\n * (2) Support return string to avoid scientific notation like '3.5e-7'.\n *\n * @param {number} x\n * @param {number} [precision]\n * @param {boolean} [returnStr]\n * @return {number|string}\n */\nfunction round$1(x, precision, returnStr) {\n    if (precision == null) {\n        precision = 10;\n    }\n    // Avoid range error\n    precision = Math.min(Math.max(0, precision), 20);\n    x = (+x).toFixed(precision);\n    return returnStr ? x : +x;\n}\n\nfunction asc(arr) {\n    arr.sort(function (a, b) {\n        return a - b;\n    });\n    return arr;\n}\n\n/**\n * Get precision\n * @param {number} val\n */\nfunction getPrecision(val) {\n    val = +val;\n    if (isNaN(val)) {\n        return 0;\n    }\n    // It is much faster than methods converting number to string as follows\n    //      var tmp = val.toString();\n    //      return tmp.length - 1 - tmp.indexOf('.');\n    // especially when precision is low\n    var e = 1;\n    var count = 0;\n    while (Math.round(val * e) / e !== val) {\n        e *= 10;\n        count++;\n    }\n    return count;\n}\n\n/**\n * @param {string|number} val\n * @return {number}\n */\nfunction getPrecisionSafe(val) {\n    var str = val.toString();\n\n    // Consider scientific notation: '3.4e-12' '3.4e+12'\n    var eIndex = str.indexOf('e');\n    if (eIndex > 0) {\n        var precision = +str.slice(eIndex + 1);\n        return precision < 0 ? -precision : 0;\n    }\n    else {\n        var dotIndex = str.indexOf('.');\n        return dotIndex < 0 ? 0 : str.length - 1 - dotIndex;\n    }\n}\n\n/**\n * Minimal dicernible data precisioin according to a single pixel.\n *\n * @param {Array.<number>} dataExtent\n * @param {Array.<number>} pixelExtent\n * @return {number} precision\n */\nfunction getPixelPrecision(dataExtent, pixelExtent) {\n    var log = Math.log;\n    var LN10 = Math.LN10;\n    var dataQuantity = Math.floor(log(dataExtent[1] - dataExtent[0]) / LN10);\n    var sizeQuantity = Math.round(log(Math.abs(pixelExtent[1] - pixelExtent[0])) / LN10);\n    // toFixed() digits argument must be between 0 and 20.\n    var precision = Math.min(Math.max(-dataQuantity + sizeQuantity, 0), 20);\n    return !isFinite(precision) ? 20 : precision;\n}\n\n/**\n * Get a data of given precision, assuring the sum of percentages\n * in valueList is 1.\n * The largest remainer method is used.\n * https://en.wikipedia.org/wiki/Largest_remainder_method\n *\n * @param {Array.<number>} valueList a list of all data\n * @param {number} idx index of the data to be processed in valueList\n * @param {number} precision integer number showing digits of precision\n * @return {number} percent ranging from 0 to 100\n */\nfunction getPercentWithPrecision(valueList, idx, precision) {\n    if (!valueList[idx]) {\n        return 0;\n    }\n\n    var sum = reduce(valueList, function (acc, val) {\n        return acc + (isNaN(val) ? 0 : val);\n    }, 0);\n    if (sum === 0) {\n        return 0;\n    }\n\n    var digits = Math.pow(10, precision);\n    var votesPerQuota = map(valueList, function (val) {\n        return (isNaN(val) ? 0 : val) / sum * digits * 100;\n    });\n    var targetSeats = digits * 100;\n\n    var seats = map(votesPerQuota, function (votes) {\n        // Assign automatic seats.\n        return Math.floor(votes);\n    });\n    var currentSum = reduce(seats, function (acc, val) {\n        return acc + val;\n    }, 0);\n\n    var remainder = map(votesPerQuota, function (votes, idx) {\n        return votes - seats[idx];\n    });\n\n    // Has remainding votes.\n    while (currentSum < targetSeats) {\n        // Find next largest remainder.\n        var max = Number.NEGATIVE_INFINITY;\n        var maxId = null;\n        for (var i = 0, len = remainder.length; i < len; ++i) {\n            if (remainder[i] > max) {\n                max = remainder[i];\n                maxId = i;\n            }\n        }\n\n        // Add a vote to max remainder.\n        ++seats[maxId];\n        remainder[maxId] = 0;\n        ++currentSum;\n    }\n\n    return seats[idx] / digits;\n}\n\n// Number.MAX_SAFE_INTEGER, ie do not support.\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/**\n * To 0 - 2 * PI, considering negative radian.\n * @param {number} radian\n * @return {number}\n */\nfunction remRadian(radian) {\n    var pi2 = Math.PI * 2;\n    return (radian % pi2 + pi2) % pi2;\n}\n\n/**\n * @param {type} radian\n * @return {boolean}\n */\nfunction isRadianAroundZero(val) {\n    return val > -RADIAN_EPSILON && val < RADIAN_EPSILON;\n}\n\nvar TIME_REG = /^(?:(\\d{4})(?:[-\\/](\\d{1,2})(?:[-\\/](\\d{1,2})(?:[T ](\\d{1,2})(?::(\\d\\d)(?::(\\d\\d)(?:[.,](\\d+))?)?)?(Z|[\\+\\-]\\d\\d:?\\d\\d)?)?)?)?)?$/; // jshint ignore:line\n\n/**\n * @param {string|Date|number} value These values can be accepted:\n *   + An instance of Date, represent a time in its own time zone.\n *   + Or string in a subset of ISO 8601, only including:\n *     + only year, month, date: '2012-03', '2012-03-01', '2012-03-01 05', '2012-03-01 05:06',\n *     + separated with T or space: '2012-03-01T12:22:33.123', '2012-03-01 12:22:33.123',\n *     + time zone: '2012-03-01T12:22:33Z', '2012-03-01T12:22:33+8000', '2012-03-01T12:22:33-05:00',\n *     all of which will be treated as local time if time zone is not specified\n *     (see <https://momentjs.com/>).\n *   + Or other string format, including (all of which will be treated as loacal time):\n *     '2012', '2012-3-1', '2012/3/1', '2012/03/01',\n *     '2009/6/12 2:00', '2009/6/12 2:05:08', '2009/6/12 2:05:08.123'\n *   + a timestamp, which represent a time in UTC.\n * @return {Date} date\n */\nfunction parseDate(value) {\n    if (value instanceof Date) {\n        return value;\n    }\n    else if (typeof value === 'string') {\n        // Different browsers parse date in different way, so we parse it manually.\n        // Some other issues:\n        // new Date('1970-01-01') is UTC,\n        // new Date('1970/01/01') and new Date('1970-1-01') is local.\n        // See issue #3623\n        var match = TIME_REG.exec(value);\n\n        if (!match) {\n            // return Invalid Date.\n            return new Date(NaN);\n        }\n\n        // Use local time when no timezone offset specifed.\n        if (!match[8]) {\n            // match[n] can only be string or undefined.\n            // But take care of '12' + 1 => '121'.\n            return new Date(\n                +match[1],\n                +(match[2] || 1) - 1,\n                +match[3] || 1,\n                +match[4] || 0,\n                +(match[5] || 0),\n                +match[6] || 0,\n                +match[7] || 0\n            );\n        }\n        // Timezoneoffset of Javascript Date has considered DST (Daylight Saving Time,\n        // https://tc39.github.io/ecma262/#sec-daylight-saving-time-adjustment).\n        // For example, system timezone is set as \"Time Zone: America/Toronto\",\n        // then these code will get different result:\n        // `new Date(1478411999999).getTimezoneOffset();  // get 240`\n        // `new Date(1478412000000).getTimezoneOffset();  // get 300`\n        // So we should not use `new Date`, but use `Date.UTC`.\n        else {\n            var hour = +match[4] || 0;\n            if (match[8].toUpperCase() !== 'Z') {\n                hour -= match[8].slice(0, 3);\n            }\n            return new Date(Date.UTC(\n                +match[1],\n                +(match[2] || 1) - 1,\n                +match[3] || 1,\n                hour,\n                +(match[5] || 0),\n                +match[6] || 0,\n                +match[7] || 0\n            ));\n        }\n    }\n    else if (value == null) {\n        return new Date(NaN);\n    }\n\n    return new Date(Math.round(value));\n}\n\n/**\n * Quantity of a number. e.g. 0.1, 1, 10, 100\n *\n * @param  {number} val\n * @return {number}\n */\nfunction quantity(val) {\n    return Math.pow(10, quantityExponent(val));\n}\n\nfunction quantityExponent(val) {\n    return Math.floor(Math.log(val) / Math.LN10);\n}\n\n/**\n * find a nice number approximately equal to x. Round the number if round = true,\n * take ceiling if round = false. The primary observation is that the nicest\n * numbers in decimal are 1, 2, and 5, and all power-of-ten multiples of these numbers.\n *\n * See \"Nice Numbers for Graph Labels\" of Graphic Gems.\n *\n * @param  {number} val Non-negative value.\n * @param  {boolean} round\n * @return {number}\n */\nfunction nice(val, round) {\n    var exponent = quantityExponent(val);\n    var exp10 = Math.pow(10, exponent);\n    var f = val / exp10; // 1 <= f < 10\n    var nf;\n    if (round) {\n        if (f < 1.5) { nf = 1; }\n        else if (f < 2.5) { nf = 2; }\n        else if (f < 4) { nf = 3; }\n        else if (f < 7) { nf = 5; }\n        else { nf = 10; }\n    }\n    else {\n        if (f < 1) { nf = 1; }\n        else if (f < 2) { nf = 2; }\n        else if (f < 3) { nf = 3; }\n        else if (f < 5) { nf = 5; }\n        else { nf = 10; }\n    }\n    val = nf * exp10;\n\n    // Fix 3 * 0.1 === 0.30000000000000004 issue (see IEEE 754).\n    // 20 is the uppper bound of toFixed.\n    return exponent >= -20 ? +val.toFixed(exponent < 0 ? -exponent : 0) : val;\n}\n\n/**\n * Order intervals asc, and split them when overlap.\n * expect(numberUtil.reformIntervals([\n *     {interval: [18, 62], close: [1, 1]},\n *     {interval: [-Infinity, -70], close: [0, 0]},\n *     {interval: [-70, -26], close: [1, 1]},\n *     {interval: [-26, 18], close: [1, 1]},\n *     {interval: [62, 150], close: [1, 1]},\n *     {interval: [106, 150], close: [1, 1]},\n *     {interval: [150, Infinity], close: [0, 0]}\n * ])).toEqual([\n *     {interval: [-Infinity, -70], close: [0, 0]},\n *     {interval: [-70, -26], close: [1, 1]},\n *     {interval: [-26, 18], close: [0, 1]},\n *     {interval: [18, 62], close: [0, 1]},\n *     {interval: [62, 150], close: [0, 1]},\n *     {interval: [150, Infinity], close: [0, 0]}\n * ]);\n * @param {Array.<Object>} list, where `close` mean open or close\n *        of the interval, and Infinity can be used.\n * @return {Array.<Object>} The origin list, which has been reformed.\n */\nfunction reformIntervals(list) {\n    list.sort(function (a, b) {\n        return littleThan(a, b, 0) ? -1 : 1;\n    });\n\n    var curr = -Infinity;\n    var currClose = 1;\n    for (var i = 0; i < list.length;) {\n        var interval = list[i].interval;\n        var close = list[i].close;\n\n        for (var lg = 0; lg < 2; lg++) {\n            if (interval[lg] <= curr) {\n                interval[lg] = curr;\n                close[lg] = !lg ? 1 - currClose : 1;\n            }\n            curr = interval[lg];\n            currClose = close[lg];\n        }\n\n        if (interval[0] === interval[1] && close[0] * close[1] !== 1) {\n            list.splice(i, 1);\n        }\n        else {\n            i++;\n        }\n    }\n\n    return list;\n\n    function littleThan(a, b, lg) {\n        return a.interval[lg] < b.interval[lg]\n            || (\n                a.interval[lg] === b.interval[lg]\n                && (\n                    (a.close[lg] - b.close[lg] === (!lg ? 1 : -1))\n                    || (!lg && littleThan(a, b, 1))\n                )\n            );\n    }\n}\n\n/**\n * parseFloat NaNs numeric-cast false positives (null|true|false|\"\")\n * ...but misinterprets leading-number strings, particularly hex literals (\"0x...\")\n * subtraction forces infinities to NaN\n *\n * @param {*} v\n * @return {boolean}\n */\nfunction isNumeric(v) {\n    return v - parseFloat(v) >= 0;\n}\n\n\nvar number = (Object.freeze || Object)({\n\tlinearMap: linearMap,\n\tparsePercent: parsePercent$1,\n\tround: round$1,\n\tasc: asc,\n\tgetPrecision: getPrecision,\n\tgetPrecisionSafe: getPrecisionSafe,\n\tgetPixelPrecision: getPixelPrecision,\n\tgetPercentWithPrecision: getPercentWithPrecision,\n\tMAX_SAFE_INTEGER: MAX_SAFE_INTEGER,\n\tremRadian: remRadian,\n\tisRadianAroundZero: isRadianAroundZero,\n\tparseDate: parseDate,\n\tquantity: quantity,\n\tnice: nice,\n\treformIntervals: reformIntervals,\n\tisNumeric: isNumeric\n});\n\n/**\n * ,\n * @param {string|number} x\n * @return {string}\n */\nfunction addCommas(x) {\n    if (isNaN(x)) {\n        return '-';\n    }\n    x = (x + '').split('.');\n    return x[0].replace(/(\\d{1,3})(?=(?:\\d{3})+(?!\\d))/g,'$1,')\n            + (x.length > 1 ? ('.' + x[1]) : '');\n}\n\n/**\n * @param {string} str\n * @param {boolean} [upperCaseFirst=false]\n * @return {string} str\n */\nfunction toCamelCase(str, upperCaseFirst) {\n    str = (str || '').toLowerCase().replace(/-(.)/g, function(match, group1) {\n        return group1.toUpperCase();\n    });\n\n    if (upperCaseFirst && str) {\n        str = str.charAt(0).toUpperCase() + str.slice(1);\n    }\n\n    return str;\n}\n\nvar normalizeCssArray$1 = normalizeCssArray;\n\nfunction encodeHTML(source) {\n    return String(source)\n        .replace(/&/g, '&amp;')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;')\n        .replace(/\"/g, '&quot;')\n        .replace(/'/g, '&#39;');\n}\n\nvar TPL_VAR_ALIAS = ['a', 'b', 'c', 'd', 'e', 'f', 'g'];\n\nvar wrapVar = function (varName, seriesIdx) {\n    return '{' + varName + (seriesIdx == null ? '' : seriesIdx) + '}';\n};\n\n/**\n * Template formatter\n * @param {string} tpl\n * @param {Array.<Object>|Object} paramsList\n * @param {boolean} [encode=false]\n * @return {string}\n */\nfunction formatTpl(tpl, paramsList, encode) {\n    if (!isArray(paramsList)) {\n        paramsList = [paramsList];\n    }\n    var seriesLen = paramsList.length;\n    if (!seriesLen) {\n        return '';\n    }\n\n    var $vars = paramsList[0].$vars || [];\n    for (var i = 0; i < $vars.length; i++) {\n        var alias = TPL_VAR_ALIAS[i];\n        tpl = tpl.replace(wrapVar(alias), wrapVar(alias, 0));\n    }\n    for (var seriesIdx = 0; seriesIdx < seriesLen; seriesIdx++) {\n        for (var k = 0; k < $vars.length; k++) {\n            var val = paramsList[seriesIdx][$vars[k]];\n            tpl = tpl.replace(\n                wrapVar(TPL_VAR_ALIAS[k], seriesIdx),\n                encode ? encodeHTML(val) : val\n            );\n        }\n    }\n\n    return tpl;\n}\n\n/**\n * simple Template formatter\n *\n * @param {string} tpl\n * @param {Object} param\n * @param {boolean} [encode=false]\n * @return {string}\n */\nfunction formatTplSimple(tpl, param, encode) {\n    each$1(param, function (value, key) {\n        tpl = tpl.replace(\n            '{' + key + '}',\n            encode ? encodeHTML(value) : value\n        );\n    });\n    return tpl;\n}\n\n/**\n * @param {Object|string} [opt] If string, means color.\n * @param {string} [opt.color]\n * @param {string} [opt.extraCssText]\n * @param {string} [opt.type='item'] 'item' or 'subItem'\n * @return {string}\n */\nfunction getTooltipMarker(opt, extraCssText) {\n    opt = isString(opt) ? {color: opt, extraCssText: extraCssText} : (opt || {});\n    var color = opt.color;\n    var type = opt.type;\n    var extraCssText = opt.extraCssText;\n\n    if (!color) {\n        return '';\n    }\n\n    return type === 'subItem'\n        ? '<span style=\"display:inline-block;vertical-align:middle;margin-right:8px;margin-left:3px;'\n            + 'border-radius:4px;width:4px;height:4px;background-color:'\n            + encodeHTML(color) + ';' + (extraCssText || '') + '\"></span>'\n        : '<span style=\"display:inline-block;margin-right:5px;'\n            + 'border-radius:10px;width:10px;height:10px;background-color:'\n            + encodeHTML(color) + ';' + (extraCssText || '') + '\"></span>';\n}\n\nfunction pad(str, len) {\n    str += '';\n    return '0000'.substr(0, len - str.length) + str;\n}\n\n\n/**\n * ISO Date format\n * @param {string} tpl\n * @param {number} value\n * @param {boolean} [isUTC=false] Default in local time.\n *           see `module:echarts/scale/Time`\n *           and `module:echarts/util/number#parseDate`.\n * @inner\n */\nfunction formatTime(tpl, value, isUTC) {\n    if (tpl === 'week'\n        || tpl === 'month'\n        || tpl === 'quarter'\n        || tpl === 'half-year'\n        || tpl === 'year'\n    ) {\n        tpl = 'MM-dd\\nyyyy';\n    }\n\n    var date = parseDate(value);\n    var utc = isUTC ? 'UTC' : '';\n    var y = date['get' + utc + 'FullYear']();\n    var M = date['get' + utc + 'Month']() + 1;\n    var d = date['get' + utc + 'Date']();\n    var h = date['get' + utc + 'Hours']();\n    var m = date['get' + utc + 'Minutes']();\n    var s = date['get' + utc + 'Seconds']();\n    var S = date['get' + utc + 'Milliseconds']();\n\n    tpl = tpl.replace('MM', pad(M, 2))\n        .replace('M', M)\n        .replace('yyyy', y)\n        .replace('yy', y % 100)\n        .replace('dd', pad(d, 2))\n        .replace('d', d)\n        .replace('hh', pad(h, 2))\n        .replace('h', h)\n        .replace('mm', pad(m, 2))\n        .replace('m', m)\n        .replace('ss', pad(s, 2))\n        .replace('s', s)\n        .replace('SSS', pad(S, 3));\n\n    return tpl;\n}\n\n/**\n * Capital first\n * @param {string} str\n * @return {string}\n */\nfunction capitalFirst(str) {\n    return str ? str.charAt(0).toUpperCase() + str.substr(1) : str;\n}\n\nvar truncateText$1 = truncateText;\n\nvar getTextRect = getBoundingRect;\n\n\nvar format = (Object.freeze || Object)({\n\taddCommas: addCommas,\n\ttoCamelCase: toCamelCase,\n\tnormalizeCssArray: normalizeCssArray$1,\n\tencodeHTML: encodeHTML,\n\tformatTpl: formatTpl,\n\tformatTplSimple: formatTplSimple,\n\tgetTooltipMarker: getTooltipMarker,\n\tformatTime: formatTime,\n\tcapitalFirst: capitalFirst,\n\ttruncateText: truncateText$1,\n\tgetTextRect: getTextRect\n});\n\n// Layout helpers for each component positioning\n\nvar each$3 = each$1;\n\n/**\n * @public\n */\nvar LOCATION_PARAMS = [\n    'left', 'right', 'top', 'bottom', 'width', 'height'\n];\n\n/**\n * @public\n */\nvar HV_NAMES = [\n    ['width', 'left', 'right'],\n    ['height', 'top', 'bottom']\n];\n\nfunction boxLayout(orient, group, gap, maxWidth, maxHeight) {\n    var x = 0;\n    var y = 0;\n\n    if (maxWidth == null) {\n        maxWidth = Infinity;\n    }\n    if (maxHeight == null) {\n        maxHeight = Infinity;\n    }\n    var currentLineMaxSize = 0;\n\n    group.eachChild(function (child, idx) {\n        var position = child.position;\n        var rect = child.getBoundingRect();\n        var nextChild = group.childAt(idx + 1);\n        var nextChildRect = nextChild && nextChild.getBoundingRect();\n        var nextX;\n        var nextY;\n\n        if (orient === 'horizontal') {\n            var moveX = rect.width + (nextChildRect ? (-nextChildRect.x + rect.x) : 0);\n            nextX = x + moveX;\n            // Wrap when width exceeds maxWidth or meet a `newline` group\n            // FIXME compare before adding gap?\n            if (nextX > maxWidth || child.newline) {\n                x = 0;\n                nextX = moveX;\n                y += currentLineMaxSize + gap;\n                currentLineMaxSize = rect.height;\n            }\n            else {\n                // FIXME: consider rect.y is not `0`?\n                currentLineMaxSize = Math.max(currentLineMaxSize, rect.height);\n            }\n        }\n        else {\n            var moveY = rect.height + (nextChildRect ? (-nextChildRect.y + rect.y) : 0);\n            nextY = y + moveY;\n            // Wrap when width exceeds maxHeight or meet a `newline` group\n            if (nextY > maxHeight || child.newline) {\n                x += currentLineMaxSize + gap;\n                y = 0;\n                nextY = moveY;\n                currentLineMaxSize = rect.width;\n            }\n            else {\n                currentLineMaxSize = Math.max(currentLineMaxSize, rect.width);\n            }\n        }\n\n        if (child.newline) {\n            return;\n        }\n\n        position[0] = x;\n        position[1] = y;\n\n        orient === 'horizontal'\n            ? (x = nextX + gap)\n            : (y = nextY + gap);\n    });\n}\n\n/**\n * VBox or HBox layouting\n * @param {string} orient\n * @param {module:zrender/container/Group} group\n * @param {number} gap\n * @param {number} [width=Infinity]\n * @param {number} [height=Infinity]\n */\nvar box = boxLayout;\n\n/**\n * VBox layouting\n * @param {module:zrender/container/Group} group\n * @param {number} gap\n * @param {number} [width=Infinity]\n * @param {number} [height=Infinity]\n */\nvar vbox = curry(boxLayout, 'vertical');\n\n/**\n * HBox layouting\n * @param {module:zrender/container/Group} group\n * @param {number} gap\n * @param {number} [width=Infinity]\n * @param {number} [height=Infinity]\n */\nvar hbox = curry(boxLayout, 'horizontal');\n\n/**\n * If x or x2 is not specified or 'center' 'left' 'right',\n * the width would be as long as possible.\n * If y or y2 is not specified or 'middle' 'top' 'bottom',\n * the height would be as long as possible.\n *\n * @param {Object} positionInfo\n * @param {number|string} [positionInfo.x]\n * @param {number|string} [positionInfo.y]\n * @param {number|string} [positionInfo.x2]\n * @param {number|string} [positionInfo.y2]\n * @param {Object} containerRect {width, height}\n * @param {string|number} margin\n * @return {Object} {width, height}\n */\nfunction getAvailableSize(positionInfo, containerRect, margin) {\n    var containerWidth = containerRect.width;\n    var containerHeight = containerRect.height;\n\n    var x = parsePercent$1(positionInfo.x, containerWidth);\n    var y = parsePercent$1(positionInfo.y, containerHeight);\n    var x2 = parsePercent$1(positionInfo.x2, containerWidth);\n    var y2 = parsePercent$1(positionInfo.y2, containerHeight);\n\n    (isNaN(x) || isNaN(parseFloat(positionInfo.x))) && (x = 0);\n    (isNaN(x2) || isNaN(parseFloat(positionInfo.x2))) && (x2 = containerWidth);\n    (isNaN(y) || isNaN(parseFloat(positionInfo.y))) && (y = 0);\n    (isNaN(y2) || isNaN(parseFloat(positionInfo.y2))) && (y2 = containerHeight);\n\n    margin = normalizeCssArray$1(margin || 0);\n\n    return {\n        width: Math.max(x2 - x - margin[1] - margin[3], 0),\n        height: Math.max(y2 - y - margin[0] - margin[2], 0)\n    };\n}\n\n/**\n * Parse position info.\n *\n * @param {Object} positionInfo\n * @param {number|string} [positionInfo.left]\n * @param {number|string} [positionInfo.top]\n * @param {number|string} [positionInfo.right]\n * @param {number|string} [positionInfo.bottom]\n * @param {number|string} [positionInfo.width]\n * @param {number|string} [positionInfo.height]\n * @param {number|string} [positionInfo.aspect] Aspect is width / height\n * @param {Object} containerRect\n * @param {string|number} [margin]\n *\n * @return {module:zrender/core/BoundingRect}\n */\nfunction getLayoutRect(\n    positionInfo, containerRect, margin\n) {\n    margin = normalizeCssArray$1(margin || 0);\n\n    var containerWidth = containerRect.width;\n    var containerHeight = containerRect.height;\n\n    var left = parsePercent$1(positionInfo.left, containerWidth);\n    var top = parsePercent$1(positionInfo.top, containerHeight);\n    var right = parsePercent$1(positionInfo.right, containerWidth);\n    var bottom = parsePercent$1(positionInfo.bottom, containerHeight);\n    var width = parsePercent$1(positionInfo.width, containerWidth);\n    var height = parsePercent$1(positionInfo.height, containerHeight);\n\n    var verticalMargin = margin[2] + margin[0];\n    var horizontalMargin = margin[1] + margin[3];\n    var aspect = positionInfo.aspect;\n\n    // If width is not specified, calculate width from left and right\n    if (isNaN(width)) {\n        width = containerWidth - right - horizontalMargin - left;\n    }\n    if (isNaN(height)) {\n        height = containerHeight - bottom - verticalMargin - top;\n    }\n\n    if (aspect != null) {\n        // If width and height are not given\n        // 1. Graph should not exceeds the container\n        // 2. Aspect must be keeped\n        // 3. Graph should take the space as more as possible\n        // FIXME\n        // Margin is not considered, because there is no case that both\n        // using margin and aspect so far.\n        if (isNaN(width) && isNaN(height)) {\n            if (aspect > containerWidth / containerHeight) {\n                width = containerWidth * 0.8;\n            }\n            else {\n                height = containerHeight * 0.8;\n            }\n        }\n\n        // Calculate width or height with given aspect\n        if (isNaN(width)) {\n            width = aspect * height;\n        }\n        if (isNaN(height)) {\n            height = width / aspect;\n        }\n    }\n\n    // If left is not specified, calculate left from right and width\n    if (isNaN(left)) {\n        left = containerWidth - right - width - horizontalMargin;\n    }\n    if (isNaN(top)) {\n        top = containerHeight - bottom - height - verticalMargin;\n    }\n\n    // Align left and top\n    switch (positionInfo.left || positionInfo.right) {\n        case 'center':\n            left = containerWidth / 2 - width / 2 - margin[3];\n            break;\n        case 'right':\n            left = containerWidth - width - horizontalMargin;\n            break;\n    }\n    switch (positionInfo.top || positionInfo.bottom) {\n        case 'middle':\n        case 'center':\n            top = containerHeight / 2 - height / 2 - margin[0];\n            break;\n        case 'bottom':\n            top = containerHeight - height - verticalMargin;\n            break;\n    }\n    // If something is wrong and left, top, width, height are calculated as NaN\n    left = left || 0;\n    top = top || 0;\n    if (isNaN(width)) {\n        // Width may be NaN if only one value is given except width\n        width = containerWidth - horizontalMargin - left - (right || 0);\n    }\n    if (isNaN(height)) {\n        // Height may be NaN if only one value is given except height\n        height = containerHeight - verticalMargin - top - (bottom || 0);\n    }\n\n    var rect = new BoundingRect(left + margin[3], top + margin[0], width, height);\n    rect.margin = margin;\n    return rect;\n}\n\n\n/**\n * Position a zr element in viewport\n *  Group position is specified by either\n *  {left, top}, {right, bottom}\n *  If all properties exists, right and bottom will be igonred.\n *\n * Logic:\n *     1. Scale (against origin point in parent coord)\n *     2. Rotate (against origin point in parent coord)\n *     3. Traslate (with el.position by this method)\n * So this method only fixes the last step 'Traslate', which does not affect\n * scaling and rotating.\n *\n * If be called repeatly with the same input el, the same result will be gotten.\n *\n * @param {module:zrender/Element} el Should have `getBoundingRect` method.\n * @param {Object} positionInfo\n * @param {number|string} [positionInfo.left]\n * @param {number|string} [positionInfo.top]\n * @param {number|string} [positionInfo.right]\n * @param {number|string} [positionInfo.bottom]\n * @param {number|string} [positionInfo.width] Only for opt.boundingModel: 'raw'\n * @param {number|string} [positionInfo.height] Only for opt.boundingModel: 'raw'\n * @param {Object} containerRect\n * @param {string|number} margin\n * @param {Object} [opt]\n * @param {Array.<number>} [opt.hv=[1,1]] Only horizontal or only vertical.\n * @param {Array.<number>} [opt.boundingMode='all']\n *        Specify how to calculate boundingRect when locating.\n *        'all': Position the boundingRect that is transformed and uioned\n *               both itself and its descendants.\n *               This mode simplies confine the elements in the bounding\n *               of their container (e.g., using 'right: 0').\n *        'raw': Position the boundingRect that is not transformed and only itself.\n *               This mode is useful when you want a element can overflow its\n *               container. (Consider a rotated circle needs to be located in a corner.)\n *               In this mode positionInfo.width/height can only be number.\n */\nfunction positionElement(el, positionInfo, containerRect, margin, opt) {\n    var h = !opt || !opt.hv || opt.hv[0];\n    var v = !opt || !opt.hv || opt.hv[1];\n    var boundingMode = opt && opt.boundingMode || 'all';\n\n    if (!h && !v) {\n        return;\n    }\n\n    var rect;\n    if (boundingMode === 'raw') {\n        rect = el.type === 'group'\n            ? new BoundingRect(0, 0, +positionInfo.width || 0, +positionInfo.height || 0)\n            : el.getBoundingRect();\n    }\n    else {\n        rect = el.getBoundingRect();\n        if (el.needLocalTransform()) {\n            var transform = el.getLocalTransform();\n            // Notice: raw rect may be inner object of el,\n            // which should not be modified.\n            rect = rect.clone();\n            rect.applyTransform(transform);\n        }\n    }\n\n    // The real width and height can not be specified but calculated by the given el.\n    positionInfo = getLayoutRect(\n        defaults(\n            {width: rect.width, height: rect.height},\n            positionInfo\n        ),\n        containerRect,\n        margin\n    );\n\n    // Because 'tranlate' is the last step in transform\n    // (see zrender/core/Transformable#getLocalTransform),\n    // we can just only modify el.position to get final result.\n    var elPos = el.position;\n    var dx = h ? positionInfo.x - rect.x : 0;\n    var dy = v ? positionInfo.y - rect.y : 0;\n\n    el.attr('position', boundingMode === 'raw' ? [dx, dy] : [elPos[0] + dx, elPos[1] + dy]);\n}\n\n/**\n * @param {Object} option Contains some of the properties in HV_NAMES.\n * @param {number} hvIdx 0: horizontal; 1: vertical.\n */\nfunction sizeCalculable(option, hvIdx) {\n    return option[HV_NAMES[hvIdx][0]] != null\n        || (option[HV_NAMES[hvIdx][1]] != null && option[HV_NAMES[hvIdx][2]] != null);\n}\n\n/**\n * Consider Case:\n * When defulat option has {left: 0, width: 100}, and we set {right: 0}\n * through setOption or media query, using normal zrUtil.merge will cause\n * {right: 0} does not take effect.\n *\n * @example\n * ComponentModel.extend({\n *     init: function () {\n *         ...\n *         var inputPositionParams = layout.getLayoutParams(option);\n *         this.mergeOption(inputPositionParams);\n *     },\n *     mergeOption: function (newOption) {\n *         newOption && zrUtil.merge(thisOption, newOption, true);\n *         layout.mergeLayoutParam(thisOption, newOption);\n *     }\n * });\n *\n * @param {Object} targetOption\n * @param {Object} newOption\n * @param {Object|string} [opt]\n * @param {boolean|Array.<boolean>} [opt.ignoreSize=false] Used for the components\n *  that width (or height) should not be calculated by left and right (or top and bottom).\n */\nfunction mergeLayoutParam(targetOption, newOption, opt) {\n    !isObject$1(opt) && (opt = {});\n\n    var ignoreSize = opt.ignoreSize;\n    !isArray(ignoreSize) && (ignoreSize = [ignoreSize, ignoreSize]);\n\n    var hResult = merge$$1(HV_NAMES[0], 0);\n    var vResult = merge$$1(HV_NAMES[1], 1);\n\n    copy(HV_NAMES[0], targetOption, hResult);\n    copy(HV_NAMES[1], targetOption, vResult);\n\n    function merge$$1(names, hvIdx) {\n        var newParams = {};\n        var newValueCount = 0;\n        var merged = {};\n        var mergedValueCount = 0;\n        var enoughParamNumber = 2;\n\n        each$3(names, function (name) {\n            merged[name] = targetOption[name];\n        });\n        each$3(names, function (name) {\n            // Consider case: newOption.width is null, which is\n            // set by user for removing width setting.\n            hasProp(newOption, name) && (newParams[name] = merged[name] = newOption[name]);\n            hasValue(newParams, name) && newValueCount++;\n            hasValue(merged, name) && mergedValueCount++;\n        });\n\n        if (ignoreSize[hvIdx]) {\n            // Only one of left/right is premitted to exist.\n            if (hasValue(newOption, names[1])) {\n                merged[names[2]] = null;\n            }\n            else if (hasValue(newOption, names[2])) {\n                merged[names[1]] = null;\n            }\n            return merged;\n        }\n\n        // Case: newOption: {width: ..., right: ...},\n        // or targetOption: {right: ...} and newOption: {width: ...},\n        // There is no conflict when merged only has params count\n        // little than enoughParamNumber.\n        if (mergedValueCount === enoughParamNumber || !newValueCount) {\n            return merged;\n        }\n        // Case: newOption: {width: ..., right: ...},\n        // Than we can make sure user only want those two, and ignore\n        // all origin params in targetOption.\n        else if (newValueCount >= enoughParamNumber) {\n            return newParams;\n        }\n        else {\n            // Chose another param from targetOption by priority.\n            for (var i = 0; i < names.length; i++) {\n                var name = names[i];\n                if (!hasProp(newParams, name) && hasProp(targetOption, name)) {\n                    newParams[name] = targetOption[name];\n                    break;\n                }\n            }\n            return newParams;\n        }\n    }\n\n    function hasProp(obj, name) {\n        return obj.hasOwnProperty(name);\n    }\n\n    function hasValue(obj, name) {\n        return obj[name] != null && obj[name] !== 'auto';\n    }\n\n    function copy(names, target, source) {\n        each$3(names, function (name) {\n            target[name] = source[name];\n        });\n    }\n}\n\n/**\n * Retrieve 'left', 'right', 'top', 'bottom', 'width', 'height' from object.\n * @param {Object} source\n * @return {Object} Result contains those props.\n */\nfunction getLayoutParams(source) {\n    return copyLayoutParams({}, source);\n}\n\n/**\n * Retrieve 'left', 'right', 'top', 'bottom', 'width', 'height' from object.\n * @param {Object} source\n * @return {Object} Result contains those props.\n */\nfunction copyLayoutParams(target, source) {\n    source && target && each$3(LOCATION_PARAMS, function (name) {\n        source.hasOwnProperty(name) && (target[name] = source[name]);\n    });\n    return target;\n}\n\nvar boxLayoutMixin = {\n    getBoxLayoutParams: function () {\n        return {\n            left: this.get('left'),\n            top: this.get('top'),\n            right: this.get('right'),\n            bottom: this.get('bottom'),\n            width: this.get('width'),\n            height: this.get('height')\n        };\n    }\n};\n\n/**\n * Component model\n *\n * @module echarts/model/Component\n */\n\nvar inner$1 = makeInner();\n\n/**\n * @alias module:echarts/model/Component\n * @constructor\n * @param {Object} option\n * @param {module:echarts/model/Model} parentModel\n * @param {module:echarts/model/Model} ecModel\n */\nvar ComponentModel = Model.extend({\n\n    type: 'component',\n\n    /**\n     * @readOnly\n     * @type {string}\n     */\n    id: '',\n\n    /**\n     * Because simplified concept is probably better, series.name (or component.name)\n     * has been having too many resposibilities:\n     * (1) Generating id (which requires name in option should not be modified).\n     * (2) As an index to mapping series when merging option or calling API (a name\n     * can refer to more then one components, which is convinient is some case).\n     * (3) Display.\n     * @readOnly\n     */\n    name: '',\n\n    /**\n     * @readOnly\n     * @type {string}\n     */\n    mainType: '',\n\n    /**\n     * @readOnly\n     * @type {string}\n     */\n    subType: '',\n\n    /**\n     * @readOnly\n     * @type {number}\n     */\n    componentIndex: 0,\n\n    /**\n     * @type {Object}\n     * @protected\n     */\n    defaultOption: null,\n\n    /**\n     * @type {module:echarts/model/Global}\n     * @readOnly\n     */\n    ecModel: null,\n\n    /**\n     * key: componentType\n     * value:  Component model list, can not be null.\n     * @type {Object.<string, Array.<module:echarts/model/Model>>}\n     * @readOnly\n     */\n    dependentModels: [],\n\n    /**\n     * @type {string}\n     * @readOnly\n     */\n    uid: null,\n\n    /**\n     * Support merge layout params.\n     * Only support 'box' now (left/right/top/bottom/width/height).\n     * @type {string|Object} Object can be {ignoreSize: true}\n     * @readOnly\n     */\n    layoutMode: null,\n\n    $constructor: function (option, parentModel, ecModel, extraOpt) {\n        Model.call(this, option, parentModel, ecModel, extraOpt);\n\n        this.uid = getUID('ec_cpt_model');\n    },\n\n    init: function (option, parentModel, ecModel, extraOpt) {\n        this.mergeDefaultAndTheme(option, ecModel);\n    },\n\n    mergeDefaultAndTheme: function (option, ecModel) {\n        var layoutMode = this.layoutMode;\n        var inputPositionParams = layoutMode\n            ? getLayoutParams(option) : {};\n\n        var themeModel = ecModel.getTheme();\n        merge(option, themeModel.get(this.mainType));\n        merge(option, this.getDefaultOption());\n\n        if (layoutMode) {\n            mergeLayoutParam(option, inputPositionParams, layoutMode);\n        }\n    },\n\n    mergeOption: function (option, extraOpt) {\n        merge(this.option, option, true);\n\n        var layoutMode = this.layoutMode;\n        if (layoutMode) {\n            mergeLayoutParam(this.option, option, layoutMode);\n        }\n    },\n\n    // Hooker after init or mergeOption\n    optionUpdated: function (newCptOption, isInit) {},\n\n    getDefaultOption: function () {\n        var fields = inner$1(this);\n        if (!fields.defaultOption) {\n            var optList = [];\n            var Class = this.constructor;\n            while (Class) {\n                var opt = Class.prototype.defaultOption;\n                opt && optList.push(opt);\n                Class = Class.superClass;\n            }\n\n            var defaultOption = {};\n            for (var i = optList.length - 1; i >= 0; i--) {\n                defaultOption = merge(defaultOption, optList[i], true);\n            }\n            fields.defaultOption = defaultOption;\n        }\n        return fields.defaultOption;\n    },\n\n    getReferringComponents: function (mainType) {\n        return this.ecModel.queryComponents({\n            mainType: mainType,\n            index: this.get(mainType + 'Index', true),\n            id: this.get(mainType + 'Id', true)\n        });\n    }\n\n});\n\n// Reset ComponentModel.extend, add preConstruct.\n// clazzUtil.enableClassExtend(\n//     ComponentModel,\n//     function (option, parentModel, ecModel, extraOpt) {\n//         // Set dependentModels, componentIndex, name, id, mainType, subType.\n//         zrUtil.extend(this, extraOpt);\n\n//         this.uid = componentUtil.getUID('componentModel');\n\n//         // this.setReadOnly([\n//         //     'type', 'id', 'uid', 'name', 'mainType', 'subType',\n//         //     'dependentModels', 'componentIndex'\n//         // ]);\n//     }\n// );\n\n// Add capability of registerClass, getClass, hasClass, registerSubTypeDefaulter and so on.\nenableClassManagement(\n    ComponentModel, {registerWhenExtend: true}\n);\nenableSubTypeDefaulter(ComponentModel);\n\n// Add capability of ComponentModel.topologicalTravel.\nenableTopologicalTravel(ComponentModel, getDependencies);\n\nfunction getDependencies(componentType) {\n    var deps = [];\n    each$1(ComponentModel.getClassesByMainType(componentType), function (Clazz) {\n        deps = deps.concat(Clazz.prototype.dependencies || []);\n    });\n\n    // Ensure main type.\n    deps = map(deps, function (type) {\n        return parseClassType$1(type).main;\n    });\n\n    // Hack dataset for convenience.\n    if (componentType !== 'dataset' && indexOf(deps, 'dataset') <= 0) {\n        deps.unshift('dataset');\n    }\n\n    return deps;\n}\n\nmixin(ComponentModel, boxLayoutMixin);\n\nvar platform = '';\n// Navigator not exists in node\nif (typeof navigator !== 'undefined') {\n    platform = navigator.platform || '';\n}\n\nvar globalDefault = {\n    // backgroundColor: 'rgba(0,0,0,0)',\n\n    // https://dribbble.com/shots/1065960-Infographic-Pie-chart-visualization\n    // color: ['#5793f3', '#d14a61', '#fd9c35', '#675bba', '#fec42c', '#dd4444', '#d4df5a', '#cd4870'],\n    // Light colors:\n    // color: ['#bcd3bb', '#e88f70', '#edc1a5', '#9dc5c8', '#e1e8c8', '#7b7c68', '#e5b5b5', '#f0b489', '#928ea8', '#bda29a'],\n    // color: ['#cc5664', '#9bd6ec', '#ea946e', '#8acaaa', '#f1ec64', '#ee8686', '#a48dc1', '#5da6bc', '#b9dcae'],\n    // Dark colors:\n    color: ['#c23531','#2f4554', '#61a0a8', '#d48265', '#91c7ae','#749f83',  '#ca8622', '#bda29a','#6e7074', '#546570', '#c4ccd3'],\n\n    gradientColor: ['#f6efa6', '#d88273', '#bf444c'],\n\n    // If xAxis and yAxis declared, grid is created by default.\n    // grid: {},\n\n    textStyle: {\n        // color: '#000',\n        // decoration: 'none',\n        // PENDING\n        fontFamily: platform.match(/^Win/) ? 'Microsoft YaHei' : 'sans-serif',\n        // fontFamily: 'Arial, Verdana, sans-serif',\n        fontSize: 12,\n        fontStyle: 'normal',\n        fontWeight: 'normal'\n    },\n\n    // http://blogs.adobe.com/webplatform/2014/02/24/using-blend-modes-in-html-canvas/\n    // https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/globalCompositeOperation\n    // Default is source-over\n    blendMode: null,\n\n    animation: 'auto',\n    animationDuration: 1000,\n    animationDurationUpdate: 300,\n    animationEasing: 'exponentialOut',\n    animationEasingUpdate: 'cubicOut',\n\n    animationThreshold: 2000,\n    // Configuration for progressive/incremental rendering\n    progressiveThreshold: 3000,\n    progressive: 400,\n\n    // Threshold of if use single hover layer to optimize.\n    // It is recommended that `hoverLayerThreshold` is equivalent to or less than\n    // `progressiveThreshold`, otherwise hover will cause restart of progressive,\n    // which is unexpected.\n    // see example <echarts/test/heatmap-large.html>.\n    hoverLayerThreshold: 3000,\n\n    // See: module:echarts/scale/Time\n    useUTC: false\n};\n\nvar inner$2 = makeInner();\n\nfunction getNearestColorPalette(colors, requestColorNum) {\n    var paletteNum = colors.length;\n    // TODO colors must be in order\n    for (var i = 0; i < paletteNum; i++) {\n        if (colors[i].length > requestColorNum) {\n            return colors[i];\n        }\n    }\n    return colors[paletteNum - 1];\n}\n\nvar colorPaletteMixin = {\n    clearColorPalette: function () {\n        inner$2(this).colorIdx = 0;\n        inner$2(this).colorNameMap = {};\n    },\n\n    /**\n     * @param {string} name MUST NOT be null/undefined. Otherwise call this function\n     *                 twise with the same parameters will get different result.\n     * @param {Object} [scope=this]\n     * @param {Object} [requestColorNum]\n     * @return {string} color string.\n     */\n    getColorFromPalette: function (name, scope, requestColorNum) {\n        scope = scope || this;\n        var scopeFields = inner$2(scope);\n        var colorIdx = scopeFields.colorIdx || 0;\n        var colorNameMap = scopeFields.colorNameMap = scopeFields.colorNameMap || {};\n        // Use `hasOwnProperty` to avoid conflict with Object.prototype.\n        if (colorNameMap.hasOwnProperty(name)) {\n            return colorNameMap[name];\n        }\n        var defaultColorPalette = normalizeToArray(this.get('color', true));\n        var layeredColorPalette = this.get('colorLayer', true);\n        var colorPalette = ((requestColorNum == null || !layeredColorPalette)\n            ? defaultColorPalette : getNearestColorPalette(layeredColorPalette, requestColorNum));\n\n        // In case can't find in layered color palette.\n        colorPalette = colorPalette || defaultColorPalette;\n\n        if (!colorPalette || !colorPalette.length) {\n            return;\n        }\n\n        var color = colorPalette[colorIdx];\n        if (name) {\n            colorNameMap[name] = color;\n        }\n        scopeFields.colorIdx = (colorIdx + 1) % colorPalette.length;\n\n        return color;\n    }\n};\n\n/**\n * Helper for model references.\n * There are many manners to refer axis/coordSys.\n */\n\n// TODO\n// merge relevant logic to this file?\n// check: \"modelHelper\" of tooltip and \"BrushTargetManager\".\n\n/**\n * @return {Object} For example:\n * {\n *     coordSysName: 'cartesian2d',\n *     coordSysDims: ['x', 'y', ...],\n *     axisMap: HashMap({\n *         x: xAxisModel,\n *         y: yAxisModel\n *     }),\n *     categoryAxisMap: HashMap({\n *         x: xAxisModel,\n *         y: undefined\n *     }),\n *     // It also indicate that whether there is category axis.\n *     firstCategoryDimIndex: 1,\n *     // To replace user specified encode.\n * }\n */\nfunction getCoordSysDefineBySeries(seriesModel) {\n    var coordSysName = seriesModel.get('coordinateSystem');\n    var result = {\n        coordSysName: coordSysName,\n        coordSysDims: [],\n        axisMap: createHashMap(),\n        categoryAxisMap: createHashMap()\n    };\n    var fetch = fetchers[coordSysName];\n    if (fetch) {\n        fetch(seriesModel, result, result.axisMap, result.categoryAxisMap);\n        return result;\n    }\n}\n\nvar fetchers = {\n\n    cartesian2d: function (seriesModel, result, axisMap, categoryAxisMap) {\n        var xAxisModel = seriesModel.getReferringComponents('xAxis')[0];\n        var yAxisModel = seriesModel.getReferringComponents('yAxis')[0];\n\n        if (__DEV__) {\n            if (!xAxisModel) {\n                throw new Error('xAxis \"' + retrieve(\n                    seriesModel.get('xAxisIndex'),\n                    seriesModel.get('xAxisId'),\n                    0\n                ) + '\" not found');\n            }\n            if (!yAxisModel) {\n                throw new Error('yAxis \"' + retrieve(\n                    seriesModel.get('xAxisIndex'),\n                    seriesModel.get('yAxisId'),\n                    0\n                ) + '\" not found');\n            }\n        }\n\n        result.coordSysDims = ['x', 'y'];\n        axisMap.set('x', xAxisModel);\n        axisMap.set('y', yAxisModel);\n\n        if (isCategory(xAxisModel)) {\n            categoryAxisMap.set('x', xAxisModel);\n            result.firstCategoryDimIndex = 0;\n        }\n        if (isCategory(yAxisModel)) {\n            categoryAxisMap.set('y', yAxisModel);\n            result.firstCategoryDimIndex = 1;\n        }\n    },\n\n    singleAxis: function (seriesModel, result, axisMap, categoryAxisMap) {\n        var singleAxisModel = seriesModel.getReferringComponents('singleAxis')[0];\n\n        if (__DEV__) {\n            if (!singleAxisModel) {\n                throw new Error('singleAxis should be specified.');\n            }\n        }\n\n        result.coordSysDims = ['single'];\n        axisMap.set('single', singleAxisModel);\n\n        if (isCategory(singleAxisModel)) {\n            categoryAxisMap.set('single', singleAxisModel);\n            result.firstCategoryDimIndex = 0;\n        }\n    },\n\n    polar: function (seriesModel, result, axisMap, categoryAxisMap) {\n        var polarModel = seriesModel.getReferringComponents('polar')[0];\n        var radiusAxisModel = polarModel.findAxisModel('radiusAxis');\n        var angleAxisModel = polarModel.findAxisModel('angleAxis');\n\n        if (__DEV__) {\n            if (!angleAxisModel) {\n                throw new Error('angleAxis option not found');\n            }\n            if (!radiusAxisModel) {\n                throw new Error('radiusAxis option not found');\n            }\n        }\n\n        result.coordSysDims = ['radius', 'angle'];\n        axisMap.set('radius', radiusAxisModel);\n        axisMap.set('angle', angleAxisModel);\n\n        if (isCategory(radiusAxisModel)) {\n            categoryAxisMap.set('radius', radiusAxisModel);\n            result.firstCategoryDimIndex = 0;\n        }\n        if (isCategory(angleAxisModel)) {\n            categoryAxisMap.set('angle', angleAxisModel);\n            result.firstCategoryDimIndex = 1;\n        }\n    },\n\n    geo: function (seriesModel, result, axisMap, categoryAxisMap) {\n        result.coordSysDims = ['lng', 'lat'];\n    },\n\n    parallel: function (seriesModel, result, axisMap, categoryAxisMap) {\n        var ecModel = seriesModel.ecModel;\n        var parallelModel = ecModel.getComponent(\n            'parallel', seriesModel.get('parallelIndex')\n        );\n        var coordSysDims = result.coordSysDims = parallelModel.dimensions.slice();\n\n        each$1(parallelModel.parallelAxisIndex, function (axisIndex, index) {\n            var axisModel = ecModel.getComponent('parallelAxis', axisIndex);\n            var axisDim = coordSysDims[index];\n            axisMap.set(axisDim, axisModel);\n\n            if (isCategory(axisModel) && result.firstCategoryDimIndex == null) {\n                categoryAxisMap.set(axisDim, axisModel);\n                result.firstCategoryDimIndex = index;\n            }\n        });\n    }\n};\n\nfunction isCategory(axisModel) {\n    return axisModel.get('type') === 'category';\n}\n\n// Avoid typo.\nvar SOURCE_FORMAT_ORIGINAL = 'original';\nvar SOURCE_FORMAT_ARRAY_ROWS = 'arrayRows';\nvar SOURCE_FORMAT_OBJECT_ROWS = 'objectRows';\nvar SOURCE_FORMAT_KEYED_COLUMNS = 'keyedColumns';\nvar SOURCE_FORMAT_UNKNOWN = 'unknown';\n// ??? CHANGE A NAME\nvar SOURCE_FORMAT_TYPED_ARRAY = 'typedArray';\n\nvar SERIES_LAYOUT_BY_COLUMN = 'column';\nvar SERIES_LAYOUT_BY_ROW = 'row';\n\n/**\n * [sourceFormat]\n *\n * + \"original\":\n * This format is only used in series.data, where\n * itemStyle can be specified in data item.\n *\n * + \"arrayRows\":\n * [\n *     ['product', 'score', 'amount'],\n *     ['Matcha Latte', 89.3, 95.8],\n *     ['Milk Tea', 92.1, 89.4],\n *     ['Cheese Cocoa', 94.4, 91.2],\n *     ['Walnut Brownie', 85.4, 76.9]\n * ]\n *\n * + \"objectRows\":\n * [\n *     {product: 'Matcha Latte', score: 89.3, amount: 95.8},\n *     {product: 'Milk Tea', score: 92.1, amount: 89.4},\n *     {product: 'Cheese Cocoa', score: 94.4, amount: 91.2},\n *     {product: 'Walnut Brownie', score: 85.4, amount: 76.9}\n * ]\n *\n * + \"keyedColumns\":\n * {\n *     'product': ['Matcha Latte', 'Milk Tea', 'Cheese Cocoa', 'Walnut Brownie'],\n *     'count': [823, 235, 1042, 988],\n *     'score': [95.8, 81.4, 91.2, 76.9]\n * }\n *\n * + \"typedArray\"\n *\n * + \"unknown\"\n */\n\n/**\n * @constructor\n * @param {Object} fields\n * @param {string} fields.sourceFormat\n * @param {Array|Object} fields.fromDataset\n * @param {Array|Object} [fields.data]\n * @param {string} [seriesLayoutBy='column']\n * @param {Array.<Object|string>} [dimensionsDefine]\n * @param {Objet|HashMap} [encodeDefine]\n * @param {number} [startIndex=0]\n * @param {number} [dimensionsDetectCount]\n */\nfunction Source(fields) {\n\n    /**\n     * @type {boolean}\n     */\n    this.fromDataset = fields.fromDataset;\n\n    /**\n     * Not null/undefined.\n     * @type {Array|Object}\n     */\n    this.data = fields.data || (\n        fields.sourceFormat === SOURCE_FORMAT_KEYED_COLUMNS ? {} : []\n    );\n\n    /**\n     * See also \"detectSourceFormat\".\n     * Not null/undefined.\n     * @type {string}\n     */\n    this.sourceFormat = fields.sourceFormat || SOURCE_FORMAT_UNKNOWN;\n\n    /**\n     * 'row' or 'column'\n     * Not null/undefined.\n     * @type {string} seriesLayoutBy\n     */\n    this.seriesLayoutBy = fields.seriesLayoutBy || SERIES_LAYOUT_BY_COLUMN;\n\n    /**\n     * dimensions definition in option.\n     * can be null/undefined.\n     * @type {Array.<Object|string>}\n     */\n    this.dimensionsDefine = fields.dimensionsDefine;\n\n    /**\n     * encode definition in option.\n     * can be null/undefined.\n     * @type {Objet|HashMap}\n     */\n    this.encodeDefine = fields.encodeDefine && createHashMap(fields.encodeDefine);\n\n    /**\n     * Not null/undefined, uint.\n     * @type {number}\n     */\n    this.startIndex = fields.startIndex || 0;\n\n    /**\n     * Can be null/undefined (when unknown), uint.\n     * @type {number}\n     */\n    this.dimensionsDetectCount = fields.dimensionsDetectCount;\n}\n\n/**\n * Wrap original series data for some compatibility cases.\n */\nSource.seriesDataToSource = function (data) {\n    return new Source({\n        data: data,\n        sourceFormat: isTypedArray(data)\n            ? SOURCE_FORMAT_TYPED_ARRAY\n            : SOURCE_FORMAT_ORIGINAL,\n        fromDataset: false\n    });\n};\n\nenableClassCheck(Source);\n\nvar inner$3 = makeInner();\n\n/**\n * @see {module:echarts/data/Source}\n * @param {module:echarts/component/dataset/DatasetModel} datasetModel\n * @return {string} sourceFormat\n */\nfunction detectSourceFormat(datasetModel) {\n    var data = datasetModel.option.source;\n    var sourceFormat = SOURCE_FORMAT_UNKNOWN;\n\n    if (isTypedArray(data)) {\n        sourceFormat = SOURCE_FORMAT_TYPED_ARRAY;\n    }\n    else if (isArray(data)) {\n        // FIXME Whether tolerate null in top level array?\n        for (var i = 0, len = data.length; i < len; i++) {\n            var item = data[i];\n\n            if (item == null) {\n                continue;\n            }\n            else if (isArray(item)) {\n                sourceFormat = SOURCE_FORMAT_ARRAY_ROWS;\n                break;\n            }\n            else if (isObject$1(item)) {\n                sourceFormat = SOURCE_FORMAT_OBJECT_ROWS;\n                break;\n            }\n        }\n    }\n    else if (isObject$1(data)) {\n        for (var key in data) {\n            if (data.hasOwnProperty(key) && isArrayLike(data[key])) {\n                sourceFormat = SOURCE_FORMAT_KEYED_COLUMNS;\n                break;\n            }\n        }\n    }\n    else if (data != null) {\n        throw new Error('Invalid data');\n    }\n\n    inner$3(datasetModel).sourceFormat = sourceFormat;\n}\n\n/**\n * [Scenarios]:\n * (1) Provide source data directly:\n *     series: {\n *         encode: {...},\n *         dimensions: [...]\n *         seriesLayoutBy: 'row',\n *         data: [[...]]\n *     }\n * (2) Refer to datasetModel.\n *     series: [{\n *         encode: {...}\n *         // Ignore datasetIndex means `datasetIndex: 0`\n *         // and the dimensions defination in dataset is used\n *     }, {\n *         encode: {...},\n *         seriesLayoutBy: 'column',\n *         datasetIndex: 1\n *     }]\n *\n * Get data from series itself or datset.\n * @return {module:echarts/data/Source} source\n */\nfunction getSource(seriesModel) {\n    return inner$3(seriesModel).source;\n}\n\n/**\n * MUST be called before mergeOption of all series.\n * @param {module:echarts/model/Global} ecModel\n */\nfunction resetSourceDefaulter(ecModel) {\n    // `datasetMap` is used to make default encode.\n    inner$3(ecModel).datasetMap = createHashMap();\n}\n\n/**\n * [Caution]:\n * MUST be called after series option merged and\n * before \"series.getInitailData()\" called.\n *\n * [The rule of making default encode]:\n * Category axis (if exists) alway map to the first dimension.\n * Each other axis occupies a subsequent dimension.\n *\n * [Why make default encode]:\n * Simplify the typing of encode in option, avoiding the case like that:\n * series: [{encode: {x: 0, y: 1}}, {encode: {x: 0, y: 2}}, {encode: {x: 0, y: 3}}],\n * where the \"y\" have to be manually typed as \"1, 2, 3, ...\".\n *\n * @param {module:echarts/model/Series} seriesModel\n */\nfunction prepareSource(seriesModel) {\n    var seriesOption = seriesModel.option;\n\n    var data = seriesOption.data;\n    var sourceFormat = isTypedArray(data)\n        ? SOURCE_FORMAT_TYPED_ARRAY : SOURCE_FORMAT_ORIGINAL;\n    var fromDataset = false;\n\n    var seriesLayoutBy = seriesOption.seriesLayoutBy;\n    var sourceHeader = seriesOption.sourceHeader;\n    var dimensionsDefine = seriesOption.dimensions;\n\n    var datasetModel = getDatasetModel(seriesModel);\n    if (datasetModel) {\n        var datasetOption = datasetModel.option;\n\n        data = datasetOption.source;\n        sourceFormat = inner$3(datasetModel).sourceFormat;\n        fromDataset = true;\n\n        // These settings from series has higher priority.\n        seriesLayoutBy = seriesLayoutBy || datasetOption.seriesLayoutBy;\n        sourceHeader == null && (sourceHeader = datasetOption.sourceHeader);\n        dimensionsDefine = dimensionsDefine || datasetOption.dimensions;\n    }\n\n    var completeResult = completeBySourceData(\n        data, sourceFormat, seriesLayoutBy, sourceHeader, dimensionsDefine\n    );\n\n    // Note: dataset option does not have `encode`.\n    var encodeDefine = seriesOption.encode;\n    if (!encodeDefine && datasetModel) {\n        encodeDefine = makeDefaultEncode(\n            seriesModel, datasetModel, data, sourceFormat, seriesLayoutBy, completeResult\n        );\n    }\n\n    inner$3(seriesModel).source = new Source({\n        data: data,\n        fromDataset: fromDataset,\n        seriesLayoutBy: seriesLayoutBy,\n        sourceFormat: sourceFormat,\n        dimensionsDefine: completeResult.dimensionsDefine,\n        startIndex: completeResult.startIndex,\n        dimensionsDetectCount: completeResult.dimensionsDetectCount,\n        encodeDefine: encodeDefine\n    });\n}\n\n// return {startIndex, dimensionsDefine, dimensionsCount}\nfunction completeBySourceData(data, sourceFormat, seriesLayoutBy, sourceHeader, dimensionsDefine) {\n    if (!data) {\n        return {dimensionsDefine: normalizeDimensionsDefine(dimensionsDefine)};\n    }\n\n    var dimensionsDetectCount;\n    var startIndex;\n    var findPotentialName;\n\n    if (sourceFormat === SOURCE_FORMAT_ARRAY_ROWS) {\n        // Rule: Most of the first line are string: it is header.\n        // Caution: consider a line with 5 string and 1 number,\n        // it still can not be sure it is a head, because the\n        // 5 string may be 5 values of category columns.\n        if (sourceHeader === 'auto' || sourceHeader == null) {\n            arrayRowsTravelFirst(function (val) {\n                // '-' is regarded as null/undefined.\n                if (val != null && val !== '-') {\n                    if (isString(val)) {\n                        startIndex == null && (startIndex = 1);\n                    }\n                    else {\n                        startIndex = 0;\n                    }\n                }\n            // 10 is an experience number, avoid long loop.\n            }, seriesLayoutBy, data, 10);\n        }\n        else {\n            startIndex = sourceHeader ? 1 : 0;\n        }\n\n        if (!dimensionsDefine && startIndex === 1) {\n            dimensionsDefine = [];\n            arrayRowsTravelFirst(function (val, index) {\n                dimensionsDefine[index] = val != null ? val : '';\n            }, seriesLayoutBy, data);\n        }\n\n        dimensionsDetectCount = dimensionsDefine\n            ? dimensionsDefine.length\n            : seriesLayoutBy === SERIES_LAYOUT_BY_ROW\n            ? data.length\n            : data[0]\n            ? data[0].length\n            : null;\n    }\n    else if (sourceFormat === SOURCE_FORMAT_OBJECT_ROWS) {\n        if (!dimensionsDefine) {\n            dimensionsDefine = objectRowsCollectDimensions(data);\n            findPotentialName = true;\n        }\n    }\n    else if (sourceFormat === SOURCE_FORMAT_KEYED_COLUMNS) {\n        if (!dimensionsDefine) {\n            dimensionsDefine = [];\n            findPotentialName = true;\n            each$1(data, function (colArr, key) {\n                dimensionsDefine.push(key);\n            });\n        }\n    }\n    else if (sourceFormat === SOURCE_FORMAT_ORIGINAL) {\n        var value0 = getDataItemValue(data[0]);\n        dimensionsDetectCount = isArray(value0) && value0.length || 1;\n    }\n    else if (sourceFormat === SOURCE_FORMAT_TYPED_ARRAY) {\n        if (__DEV__) {\n            assert$1(!!dimensionsDefine, 'dimensions must be given if data is TypedArray.');\n        }\n    }\n\n    var potentialNameDimIndex;\n    if (findPotentialName) {\n        each$1(dimensionsDefine, function (dim, idx) {\n            if ((isObject$1(dim) ? dim.name : dim) === 'name') {\n                potentialNameDimIndex = idx;\n            }\n        });\n    }\n\n    return {\n        startIndex: startIndex,\n        dimensionsDefine: normalizeDimensionsDefine(dimensionsDefine),\n        dimensionsDetectCount: dimensionsDetectCount,\n        potentialNameDimIndex: potentialNameDimIndex\n        // TODO: potentialIdDimIdx\n    };\n}\n\n// Consider dimensions defined like ['A', 'price', 'B', 'price', 'C', 'price'],\n// which is reasonable. But dimension name is duplicated.\n// Returns undefined or an array contains only object without null/undefiend or string.\nfunction normalizeDimensionsDefine(dimensionsDefine) {\n    if (!dimensionsDefine) {\n        // The meaning of null/undefined is different from empty array.\n        return;\n    }\n    var nameMap = createHashMap();\n    return map(dimensionsDefine, function (item, index) {\n        item = extend({}, isObject$1(item) ? item : {name: item});\n\n        // User can set null in dimensions.\n        // We dont auto specify name, othewise a given name may\n        // cause it be refered unexpectedly.\n        if (item.name == null) {\n            return item;\n        }\n\n        // Also consider number form like 2012.\n        item.name += '';\n        // User may also specify displayName.\n        // displayName will always exists except user not\n        // specified or dim name is not specified or detected.\n        // (A auto generated dim name will not be used as\n        // displayName).\n        if (item.displayName == null) {\n            item.displayName = item.name;\n        }\n\n        var exist = nameMap.get(item.name);\n        if (!exist) {\n            nameMap.set(item.name, {count: 1});\n        }\n        else {\n            item.name += '-' + exist.count++;\n        }\n\n        return item;\n    });\n}\n\nfunction arrayRowsTravelFirst(cb, seriesLayoutBy, data, maxLoop) {\n    maxLoop == null && (maxLoop = Infinity);\n    if (seriesLayoutBy === SERIES_LAYOUT_BY_ROW) {\n        for (var i = 0; i < data.length && i < maxLoop; i++) {\n            cb(data[i] ? data[i][0] : null, i);\n        }\n    }\n    else {\n        var value0 = data[0] || [];\n        for (var i = 0; i < value0.length && i < maxLoop; i++) {\n            cb(value0[i], i);\n        }\n    }\n}\n\nfunction objectRowsCollectDimensions(data) {\n    var firstIndex = 0;\n    var obj;\n    while (firstIndex < data.length && !(obj = data[firstIndex++])) {} // jshint ignore: line\n    if (obj) {\n        var dimensions = [];\n        each$1(obj, function (value, key) {\n            dimensions.push(key);\n        });\n        return dimensions;\n    }\n}\n\n// ??? TODO merge to completedimensions, where also has\n// default encode making logic. And the default rule\n// should depends on series? consider 'map'.\nfunction makeDefaultEncode(\n    seriesModel, datasetModel, data, sourceFormat, seriesLayoutBy, completeResult\n) {\n    var coordSysDefine = getCoordSysDefineBySeries(seriesModel);\n    var encode = {};\n    // var encodeTooltip = [];\n    // var encodeLabel = [];\n    var encodeItemName = [];\n    var encodeSeriesName = [];\n    var seriesType = seriesModel.subType;\n\n    // ??? TODO refactor: provide by series itself.\n    // Consider the case: 'map' series is based on geo coordSys,\n    // 'graph', 'heatmap' can be based on cartesian. But can not\n    // give default rule simply here.\n    var nSeriesMap = createHashMap(['pie', 'map', 'funnel']);\n    var cSeriesMap = createHashMap([\n        'line', 'bar', 'pictorialBar', 'scatter', 'effectScatter', 'candlestick', 'boxplot'\n    ]);\n\n    // Usually in this case series will use the first data\n    // dimension as the \"value\" dimension, or other default\n    // processes respectively.\n    if (coordSysDefine && cSeriesMap.get(seriesType) != null) {\n        var ecModel = seriesModel.ecModel;\n        var datasetMap = inner$3(ecModel).datasetMap;\n        var key = datasetModel.uid + '_' + seriesLayoutBy;\n        var datasetRecord = datasetMap.get(key)\n            || datasetMap.set(key, {categoryWayDim: 1, valueWayDim: 0});\n\n        // TODO\n        // Auto detect first time axis and do arrangement.\n        each$1(coordSysDefine.coordSysDims, function (coordDim) {\n            // In value way.\n            if (coordSysDefine.firstCategoryDimIndex == null) {\n                var dataDim = datasetRecord.valueWayDim++;\n                encode[coordDim] = dataDim;\n\n                // ??? TODO give a better default series name rule?\n                // especially when encode x y specified.\n                // consider: when mutiple series share one dimension\n                // category axis, series name should better use\n                // the other dimsion name. On the other hand, use\n                // both dimensions name.\n\n                encodeSeriesName.push(dataDim);\n                // encodeTooltip.push(dataDim);\n                // encodeLabel.push(dataDim);\n            }\n            // In category way, category axis.\n            else if (coordSysDefine.categoryAxisMap.get(coordDim)) {\n                encode[coordDim] = 0;\n                encodeItemName.push(0);\n            }\n            // In category way, non-category axis.\n            else {\n                var dataDim = datasetRecord.categoryWayDim++;\n                encode[coordDim] = dataDim;\n                // encodeTooltip.push(dataDim);\n                // encodeLabel.push(dataDim);\n                encodeSeriesName.push(dataDim);\n            }\n        });\n    }\n    // Do not make a complex rule! Hard to code maintain and not necessary.\n    // ??? TODO refactor: provide by series itself.\n    // [{name: ..., value: ...}, ...] like:\n    else if (nSeriesMap.get(seriesType) != null) {\n        // Find the first not ordinal. (5 is an experience value)\n        var firstNotOrdinal;\n        for (var i = 0; i < 5 && firstNotOrdinal == null; i++) {\n            if (!doGuessOrdinal(\n                data, sourceFormat, seriesLayoutBy,\n                completeResult.dimensionsDefine, completeResult.startIndex, i\n            )) {\n                firstNotOrdinal = i;\n            }\n        }\n        if (firstNotOrdinal != null) {\n            encode.value = firstNotOrdinal;\n            var nameDimIndex = completeResult.potentialNameDimIndex\n                || Math.max(firstNotOrdinal - 1, 0);\n            // By default, label use itemName in charts.\n            // So we dont set encodeLabel here.\n            encodeSeriesName.push(nameDimIndex);\n            encodeItemName.push(nameDimIndex);\n            // encodeTooltip.push(firstNotOrdinal);\n        }\n    }\n\n    // encodeTooltip.length && (encode.tooltip = encodeTooltip);\n    // encodeLabel.length && (encode.label = encodeLabel);\n    encodeItemName.length && (encode.itemName = encodeItemName);\n    encodeSeriesName.length && (encode.seriesName = encodeSeriesName);\n\n    return encode;\n}\n\n/**\n * If return null/undefined, indicate that should not use datasetModel.\n */\nfunction getDatasetModel(seriesModel) {\n    var option = seriesModel.option;\n    // Caution: consider the scenario:\n    // A dataset is declared and a series is not expected to use the dataset,\n    // and at the beginning `setOption({series: { noData })` (just prepare other\n    // option but no data), then `setOption({series: {data: [...]}); In this case,\n    // the user should set an empty array to avoid that dataset is used by default.\n    var thisData = option.data;\n    if (!thisData) {\n        return seriesModel.ecModel.getComponent('dataset', option.datasetIndex || 0);\n    }\n}\n\n/**\n * The rule should not be complex, otherwise user might not\n * be able to known where the data is wrong.\n * The code is ugly, but how to make it neat?\n *\n * @param {module:echars/data/Source} source\n * @param {number} dimIndex\n * @return {boolean} Whether ordinal.\n */\nfunction guessOrdinal(source, dimIndex) {\n    return doGuessOrdinal(\n        source.data,\n        source.sourceFormat,\n        source.seriesLayoutBy,\n        source.dimensionsDefine,\n        source.startIndex,\n        dimIndex\n    );\n}\n\n// dimIndex may be overflow source data.\nfunction doGuessOrdinal(\n    data, sourceFormat, seriesLayoutBy, dimensionsDefine, startIndex, dimIndex\n) {\n    var result;\n    // Experience value.\n    var maxLoop = 5;\n\n    if (isTypedArray(data)) {\n        return false;\n    }\n\n    // When sourceType is 'objectRows' or 'keyedColumns', dimensionsDefine\n    // always exists in source.\n    var dimName;\n    if (dimensionsDefine) {\n        dimName = dimensionsDefine[dimIndex];\n        dimName = isObject$1(dimName) ? dimName.name : dimName;\n    }\n\n    if (sourceFormat === SOURCE_FORMAT_ARRAY_ROWS) {\n        if (seriesLayoutBy === SERIES_LAYOUT_BY_ROW) {\n            var sample = data[dimIndex];\n            for (var i = 0; i < (sample || []).length && i < maxLoop; i++) {\n                if ((result = detectValue(sample[startIndex + i])) != null) {\n                    return result;\n                }\n            }\n        }\n        else {\n            for (var i = 0; i < data.length && i < maxLoop; i++) {\n                var row = data[startIndex + i];\n                if (row && (result = detectValue(row[dimIndex])) != null) {\n                    return result;\n                }\n            }\n        }\n    }\n    else if (sourceFormat === SOURCE_FORMAT_OBJECT_ROWS) {\n        if (!dimName) {\n            return;\n        }\n        for (var i = 0; i < data.length && i < maxLoop; i++) {\n            var item = data[i];\n            if (item && (result = detectValue(item[dimName])) != null) {\n                return result;\n            }\n        }\n    }\n    else if (sourceFormat === SOURCE_FORMAT_KEYED_COLUMNS) {\n        if (!dimName) {\n            return;\n        }\n        var sample = data[dimName];\n        if (!sample || isTypedArray(sample)) {\n            return false;\n        }\n        for (var i = 0; i < sample.length && i < maxLoop; i++) {\n            if ((result = detectValue(sample[i])) != null) {\n                return result;\n            }\n        }\n    }\n    else if (sourceFormat === SOURCE_FORMAT_ORIGINAL) {\n        for (var i = 0; i < data.length && i < maxLoop; i++) {\n            var item = data[i];\n            var val = getDataItemValue(item);\n            if (!isArray(val)) {\n                return false;\n            }\n            if ((result = detectValue(val[dimIndex])) != null) {\n                return result;\n            }\n        }\n    }\n\n    function detectValue(val) {\n        // Consider usage convenience, '1', '2' will be treated as \"number\".\n        // `isFinit('')` get `true`.\n        if (val != null && isFinite(val) && val !== '') {\n            return false;\n        }\n        else if (isString(val) && val !== '-') {\n            return true;\n        }\n    }\n\n    return false;\n}\n\n/**\n * ECharts global model\n *\n * @module {echarts/model/Global}\n */\n\n\n/**\n * Caution: If the mechanism should be changed some day, these cases\n * should be considered:\n *\n * (1) In `merge option` mode, if using the same option to call `setOption`\n * many times, the result should be the same (try our best to ensure that).\n * (2) In `merge option` mode, if a component has no id/name specified, it\n * will be merged by index, and the result sequence of the components is\n * consistent to the original sequence.\n * (3) `reset` feature (in toolbox). Find detailed info in comments about\n * `mergeOption` in module:echarts/model/OptionManager.\n */\n\nvar OPTION_INNER_KEY = '\\0_ec_inner';\n\n/**\n * @alias module:echarts/model/Global\n *\n * @param {Object} option\n * @param {module:echarts/model/Model} parentModel\n * @param {Object} theme\n */\nvar GlobalModel = Model.extend({\n\n    constructor: GlobalModel,\n\n    init: function (option, parentModel, theme, optionManager) {\n        theme = theme || {};\n\n        this.option = null; // Mark as not initialized.\n\n        /**\n         * @type {module:echarts/model/Model}\n         * @private\n         */\n        this._theme = new Model(theme);\n\n        /**\n         * @type {module:echarts/model/OptionManager}\n         */\n        this._optionManager = optionManager;\n    },\n\n    setOption: function (option, optionPreprocessorFuncs) {\n        assert$1(\n            !(OPTION_INNER_KEY in option),\n            'please use chart.getOption()'\n        );\n\n        this._optionManager.setOption(option, optionPreprocessorFuncs);\n\n        this.resetOption(null);\n    },\n\n    /**\n     * @param {string} type null/undefined: reset all.\n     *                      'recreate': force recreate all.\n     *                      'timeline': only reset timeline option\n     *                      'media': only reset media query option\n     * @return {boolean} Whether option changed.\n     */\n    resetOption: function (type) {\n        var optionChanged = false;\n        var optionManager = this._optionManager;\n\n        if (!type || type === 'recreate') {\n            var baseOption = optionManager.mountOption(type === 'recreate');\n\n            if (!this.option || type === 'recreate') {\n                initBase.call(this, baseOption);\n            }\n            else {\n                this.restoreData();\n                this.mergeOption(baseOption);\n            }\n            optionChanged = true;\n        }\n\n        if (type === 'timeline' || type === 'media') {\n            this.restoreData();\n        }\n\n        if (!type || type === 'recreate' || type === 'timeline') {\n            var timelineOption = optionManager.getTimelineOption(this);\n            timelineOption && (this.mergeOption(timelineOption), optionChanged = true);\n        }\n\n        if (!type || type === 'recreate' || type === 'media') {\n            var mediaOptions = optionManager.getMediaOption(this, this._api);\n            if (mediaOptions.length) {\n                each$1(mediaOptions, function (mediaOption) {\n                    this.mergeOption(mediaOption, optionChanged = true);\n                }, this);\n            }\n        }\n\n        return optionChanged;\n    },\n\n    /**\n     * @protected\n     */\n    mergeOption: function (newOption) {\n        var option = this.option;\n        var componentsMap = this._componentsMap;\n        var newCptTypes = [];\n\n        resetSourceDefaulter(this);\n\n        // If no component class, merge directly.\n        // For example: color, animaiton options, etc.\n        each$1(newOption, function (componentOption, mainType) {\n            if (componentOption == null) {\n                return;\n            }\n\n            if (!ComponentModel.hasClass(mainType)) {\n                // globalSettingTask.dirty();\n                option[mainType] = option[mainType] == null\n                    ? clone(componentOption)\n                    : merge(option[mainType], componentOption, true);\n            }\n            else if (mainType) {\n                newCptTypes.push(mainType);\n            }\n        });\n\n        ComponentModel.topologicalTravel(\n            newCptTypes, ComponentModel.getAllClassMainTypes(), visitComponent, this\n        );\n\n        function visitComponent(mainType, dependencies) {\n\n            var newCptOptionList = normalizeToArray(newOption[mainType]);\n\n            var mapResult = mappingToExists(\n                componentsMap.get(mainType), newCptOptionList\n            );\n\n            makeIdAndName(mapResult);\n\n            // Set mainType and complete subType.\n            each$1(mapResult, function (item, index) {\n                var opt = item.option;\n                if (isObject$1(opt)) {\n                    item.keyInfo.mainType = mainType;\n                    item.keyInfo.subType = determineSubType(mainType, opt, item.exist);\n                }\n            });\n\n            var dependentModels = getComponentsByTypes(\n                componentsMap, dependencies\n            );\n\n            option[mainType] = [];\n            componentsMap.set(mainType, []);\n\n            each$1(mapResult, function (resultItem, index) {\n                var componentModel = resultItem.exist;\n                var newCptOption = resultItem.option;\n\n                assert$1(\n                    isObject$1(newCptOption) || componentModel,\n                    'Empty component definition'\n                );\n\n                // Consider where is no new option and should be merged using {},\n                // see removeEdgeAndAdd in topologicalTravel and\n                // ComponentModel.getAllClassMainTypes.\n                if (!newCptOption) {\n                    componentModel.mergeOption({}, this);\n                    componentModel.optionUpdated({}, false);\n                }\n                else {\n                    var ComponentModelClass = ComponentModel.getClass(\n                        mainType, resultItem.keyInfo.subType, true\n                    );\n\n                    if (componentModel && componentModel instanceof ComponentModelClass) {\n                        componentModel.name = resultItem.keyInfo.name;\n                        // componentModel.settingTask && componentModel.settingTask.dirty();\n                        componentModel.mergeOption(newCptOption, this);\n                        componentModel.optionUpdated(newCptOption, false);\n                    }\n                    else {\n                        // PENDING Global as parent ?\n                        var extraOpt = extend(\n                            {\n                                dependentModels: dependentModels,\n                                componentIndex: index\n                            },\n                            resultItem.keyInfo\n                        );\n                        componentModel = new ComponentModelClass(\n                            newCptOption, this, this, extraOpt\n                        );\n                        extend(componentModel, extraOpt);\n                        componentModel.init(newCptOption, this, this, extraOpt);\n\n                        // Call optionUpdated after init.\n                        // newCptOption has been used as componentModel.option\n                        // and may be merged with theme and default, so pass null\n                        // to avoid confusion.\n                        componentModel.optionUpdated(null, true);\n                    }\n                }\n\n                componentsMap.get(mainType)[index] = componentModel;\n                option[mainType][index] = componentModel.option;\n            }, this);\n\n            // Backup series for filtering.\n            if (mainType === 'series') {\n                createSeriesIndices(this, componentsMap.get('series'));\n            }\n        }\n\n        this._seriesIndicesMap = createHashMap(\n            this._seriesIndices = this._seriesIndices || []\n        );\n    },\n\n    /**\n     * Get option for output (cloned option and inner info removed)\n     * @public\n     * @return {Object}\n     */\n    getOption: function () {\n        var option = clone(this.option);\n\n        each$1(option, function (opts, mainType) {\n            if (ComponentModel.hasClass(mainType)) {\n                var opts = normalizeToArray(opts);\n                for (var i = opts.length - 1; i >= 0; i--) {\n                    // Remove options with inner id.\n                    if (isIdInner(opts[i])) {\n                        opts.splice(i, 1);\n                    }\n                }\n                option[mainType] = opts;\n            }\n        });\n\n        delete option[OPTION_INNER_KEY];\n\n        return option;\n    },\n\n    /**\n     * @return {module:echarts/model/Model}\n     */\n    getTheme: function () {\n        return this._theme;\n    },\n\n    /**\n     * @param {string} mainType\n     * @param {number} [idx=0]\n     * @return {module:echarts/model/Component}\n     */\n    getComponent: function (mainType, idx) {\n        var list = this._componentsMap.get(mainType);\n        if (list) {\n            return list[idx || 0];\n        }\n    },\n\n    /**\n     * If none of index and id and name used, return all components with mainType.\n     * @param {Object} condition\n     * @param {string} condition.mainType\n     * @param {string} [condition.subType] If ignore, only query by mainType\n     * @param {number|Array.<number>} [condition.index] Either input index or id or name.\n     * @param {string|Array.<string>} [condition.id] Either input index or id or name.\n     * @param {string|Array.<string>} [condition.name] Either input index or id or name.\n     * @return {Array.<module:echarts/model/Component>}\n     */\n    queryComponents: function (condition) {\n        var mainType = condition.mainType;\n        if (!mainType) {\n            return [];\n        }\n\n        var index = condition.index;\n        var id = condition.id;\n        var name = condition.name;\n\n        var cpts = this._componentsMap.get(mainType);\n\n        if (!cpts || !cpts.length) {\n            return [];\n        }\n\n        var result;\n\n        if (index != null) {\n            if (!isArray(index)) {\n                index = [index];\n            }\n            result = filter(map(index, function (idx) {\n                return cpts[idx];\n            }), function (val) {\n                return !!val;\n            });\n        }\n        else if (id != null) {\n            var isIdArray = isArray(id);\n            result = filter(cpts, function (cpt) {\n                return (isIdArray && indexOf(id, cpt.id) >= 0)\n                    || (!isIdArray && cpt.id === id);\n            });\n        }\n        else if (name != null) {\n            var isNameArray = isArray(name);\n            result = filter(cpts, function (cpt) {\n                return (isNameArray && indexOf(name, cpt.name) >= 0)\n                    || (!isNameArray && cpt.name === name);\n            });\n        }\n        else {\n            // Return all components with mainType\n            result = cpts.slice();\n        }\n\n        return filterBySubType(result, condition);\n    },\n\n    /**\n     * The interface is different from queryComponents,\n     * which is convenient for inner usage.\n     *\n     * @usage\n     * var result = findComponents(\n     *     {mainType: 'dataZoom', query: {dataZoomId: 'abc'}}\n     * );\n     * var result = findComponents(\n     *     {mainType: 'series', subType: 'pie', query: {seriesName: 'uio'}}\n     * );\n     * var result = findComponents(\n     *     {mainType: 'series'},\n     *     function (model, index) {...}\n     * );\n     * // result like [component0, componnet1, ...]\n     *\n     * @param {Object} condition\n     * @param {string} condition.mainType Mandatory.\n     * @param {string} [condition.subType] Optional.\n     * @param {Object} [condition.query] like {xxxIndex, xxxId, xxxName},\n     *        where xxx is mainType.\n     *        If query attribute is null/undefined or has no index/id/name,\n     *        do not filtering by query conditions, which is convenient for\n     *        no-payload situations or when target of action is global.\n     * @param {Function} [condition.filter] parameter: component, return boolean.\n     * @return {Array.<module:echarts/model/Component>}\n     */\n    findComponents: function (condition) {\n        var query = condition.query;\n        var mainType = condition.mainType;\n\n        var queryCond = getQueryCond(query);\n        var result = queryCond\n            ? this.queryComponents(queryCond)\n            : this._componentsMap.get(mainType);\n\n        return doFilter(filterBySubType(result, condition));\n\n        function getQueryCond(q) {\n            var indexAttr = mainType + 'Index';\n            var idAttr = mainType + 'Id';\n            var nameAttr = mainType + 'Name';\n            return q && (\n                    q[indexAttr] != null\n                    || q[idAttr] != null\n                    || q[nameAttr] != null\n                )\n                ? {\n                    mainType: mainType,\n                    // subType will be filtered finally.\n                    index: q[indexAttr],\n                    id: q[idAttr],\n                    name: q[nameAttr]\n                }\n                : null;\n        }\n\n        function doFilter(res) {\n            return condition.filter\n                    ? filter(res, condition.filter)\n                    : res;\n        }\n    },\n\n    /**\n     * @usage\n     * eachComponent('legend', function (legendModel, index) {\n     *     ...\n     * });\n     * eachComponent(function (componentType, model, index) {\n     *     // componentType does not include subType\n     *     // (componentType is 'xxx' but not 'xxx.aa')\n     * });\n     * eachComponent(\n     *     {mainType: 'dataZoom', query: {dataZoomId: 'abc'}},\n     *     function (model, index) {...}\n     * );\n     * eachComponent(\n     *     {mainType: 'series', subType: 'pie', query: {seriesName: 'uio'}},\n     *     function (model, index) {...}\n     * );\n     *\n     * @param {string|Object=} mainType When mainType is object, the definition\n     *                                  is the same as the method 'findComponents'.\n     * @param {Function} cb\n     * @param {*} context\n     */\n    eachComponent: function (mainType, cb, context) {\n        var componentsMap = this._componentsMap;\n\n        if (typeof mainType === 'function') {\n            context = cb;\n            cb = mainType;\n            componentsMap.each(function (components, componentType) {\n                each$1(components, function (component, index) {\n                    cb.call(context, componentType, component, index);\n                });\n            });\n        }\n        else if (isString(mainType)) {\n            each$1(componentsMap.get(mainType), cb, context);\n        }\n        else if (isObject$1(mainType)) {\n            var queryResult = this.findComponents(mainType);\n            each$1(queryResult, cb, context);\n        }\n    },\n\n    /**\n     * @param {string} name\n     * @return {Array.<module:echarts/model/Series>}\n     */\n    getSeriesByName: function (name) {\n        var series = this._componentsMap.get('series');\n        return filter(series, function (oneSeries) {\n            return oneSeries.name === name;\n        });\n    },\n\n    /**\n     * @param {number} seriesIndex\n     * @return {module:echarts/model/Series}\n     */\n    getSeriesByIndex: function (seriesIndex) {\n        return this._componentsMap.get('series')[seriesIndex];\n    },\n\n    /**\n     * Get series list before filtered by type.\n     * FIXME: rename to getRawSeriesByType?\n     *\n     * @param {string} subType\n     * @return {Array.<module:echarts/model/Series>}\n     */\n    getSeriesByType: function (subType) {\n        var series = this._componentsMap.get('series');\n        return filter(series, function (oneSeries) {\n            return oneSeries.subType === subType;\n        });\n    },\n\n    /**\n     * @return {Array.<module:echarts/model/Series>}\n     */\n    getSeries: function () {\n        return this._componentsMap.get('series').slice();\n    },\n\n    /**\n     * @return {number}\n     */\n    getSeriesCount: function () {\n        return this._componentsMap.get('series').length;\n    },\n\n    /**\n     * After filtering, series may be different\n     * frome raw series.\n     *\n     * @param {Function} cb\n     * @param {*} context\n     */\n    eachSeries: function (cb, context) {\n        assertSeriesInitialized(this);\n        each$1(this._seriesIndices, function (rawSeriesIndex) {\n            var series = this._componentsMap.get('series')[rawSeriesIndex];\n            cb.call(context, series, rawSeriesIndex);\n        }, this);\n    },\n\n    /**\n     * Iterate raw series before filtered.\n     *\n     * @param {Function} cb\n     * @param {*} context\n     */\n    eachRawSeries: function (cb, context) {\n        each$1(this._componentsMap.get('series'), cb, context);\n    },\n\n    /**\n     * After filtering, series may be different.\n     * frome raw series.\n     *\n     * @parma {string} subType\n     * @param {Function} cb\n     * @param {*} context\n     */\n    eachSeriesByType: function (subType, cb, context) {\n        assertSeriesInitialized(this);\n        each$1(this._seriesIndices, function (rawSeriesIndex) {\n            var series = this._componentsMap.get('series')[rawSeriesIndex];\n            if (series.subType === subType) {\n                cb.call(context, series, rawSeriesIndex);\n            }\n        }, this);\n    },\n\n    /**\n     * Iterate raw series before filtered of given type.\n     *\n     * @parma {string} subType\n     * @param {Function} cb\n     * @param {*} context\n     */\n    eachRawSeriesByType: function (subType, cb, context) {\n        return each$1(this.getSeriesByType(subType), cb, context);\n    },\n\n    /**\n     * @param {module:echarts/model/Series} seriesModel\n     */\n    isSeriesFiltered: function (seriesModel) {\n        assertSeriesInitialized(this);\n        return this._seriesIndicesMap.get(seriesModel.componentIndex) == null;\n    },\n\n    /**\n     * @return {Array.<number>}\n     */\n    getCurrentSeriesIndices: function () {\n        return (this._seriesIndices || []).slice();\n    },\n\n    /**\n     * @param {Function} cb\n     * @param {*} context\n     */\n    filterSeries: function (cb, context) {\n        assertSeriesInitialized(this);\n        var filteredSeries = filter(\n            this._componentsMap.get('series'), cb, context\n        );\n        createSeriesIndices(this, filteredSeries);\n    },\n\n    restoreData: function (payload) {\n        var componentsMap = this._componentsMap;\n\n        createSeriesIndices(this, componentsMap.get('series'));\n\n        var componentTypes = [];\n        componentsMap.each(function (components, componentType) {\n            componentTypes.push(componentType);\n        });\n\n        ComponentModel.topologicalTravel(\n            componentTypes,\n            ComponentModel.getAllClassMainTypes(),\n            function (componentType, dependencies) {\n                each$1(componentsMap.get(componentType), function (component) {\n                    (componentType !== 'series' || !isNotTargetSeries(component, payload))\n                        && component.restoreData();\n                });\n            }\n        );\n    }\n\n});\n\nfunction isNotTargetSeries(seriesModel, payload) {\n    if (payload) {\n        var index = payload.seiresIndex;\n        var id = payload.seriesId;\n        var name = payload.seriesName;\n        return (index != null && seriesModel.componentIndex !== index)\n            || (id != null && seriesModel.id !== id)\n            || (name != null && seriesModel.name !== name);\n    }\n}\n\n/**\n * @inner\n */\nfunction mergeTheme(option, theme) {\n    // PENDING\n    // NOT use `colorLayer` in theme if option has `color`\n    var notMergeColorLayer = option.color && !option.colorLayer;\n\n    each$1(theme, function (themeItem, name) {\n        if (name === 'colorLayer' && notMergeColorLayer) {\n            return;\n        }\n        //  component model  merge  model \n        if (!ComponentModel.hasClass(name)) {\n            if (typeof themeItem === 'object') {\n                option[name] = !option[name]\n                    ? clone(themeItem)\n                    : merge(option[name], themeItem, false);\n            }\n            else {\n                if (option[name] == null) {\n                    option[name] = themeItem;\n                }\n            }\n        }\n    });\n}\n\nfunction initBase(baseOption) {\n    baseOption = baseOption;\n\n    // Using OPTION_INNER_KEY to mark that this option can not be used outside,\n    // i.e. `chart.setOption(chart.getModel().option);` is forbiden.\n    this.option = {};\n    this.option[OPTION_INNER_KEY] = 1;\n\n    /**\n     * Init with series: [], in case of calling findSeries method\n     * before series initialized.\n     * @type {Object.<string, Array.<module:echarts/model/Model>>}\n     * @private\n     */\n    this._componentsMap = createHashMap({series: []});\n\n    /**\n     * Mapping between filtered series list and raw series list.\n     * key: filtered series indices, value: raw series indices.\n     * @type {Array.<nubmer>}\n     * @private\n     */\n    this._seriesIndices;\n\n    this._seriesIndicesMap;\n\n    mergeTheme(baseOption, this._theme.option);\n\n    // TODO Needs clone when merging to the unexisted property\n    merge(baseOption, globalDefault, false);\n\n    this.mergeOption(baseOption);\n}\n\n/**\n * @inner\n * @param {Array.<string>|string} types model types\n * @return {Object} key: {string} type, value: {Array.<Object>} models\n */\nfunction getComponentsByTypes(componentsMap, types) {\n    if (!isArray(types)) {\n        types = types ? [types] : [];\n    }\n\n    var ret = {};\n    each$1(types, function (type) {\n        ret[type] = (componentsMap.get(type) || []).slice();\n    });\n\n    return ret;\n}\n\n/**\n * @inner\n */\nfunction determineSubType(mainType, newCptOption, existComponent) {\n    var subType = newCptOption.type\n        ? newCptOption.type\n        : existComponent\n        ? existComponent.subType\n        // Use determineSubType only when there is no existComponent.\n        : ComponentModel.determineSubType(mainType, newCptOption);\n\n    // tooltip, markline, markpoint may always has no subType\n    return subType;\n}\n\n/**\n * @inner\n */\nfunction createSeriesIndices(ecModel, seriesModels) {\n    ecModel._seriesIndicesMap = createHashMap(\n        ecModel._seriesIndices = map(seriesModels, function (series) {\n            return series.componentIndex;\n        }) || []\n    );\n}\n\n/**\n * @inner\n */\nfunction filterBySubType(components, condition) {\n    // Using hasOwnProperty for restrict. Consider\n    // subType is undefined in user payload.\n    return condition.hasOwnProperty('subType')\n        ? filter(components, function (cpt) {\n            return cpt.subType === condition.subType;\n        })\n        : components;\n}\n\n/**\n * @inner\n */\nfunction assertSeriesInitialized(ecModel) {\n    // Components that use _seriesIndices should depends on series component,\n    // which make sure that their initialization is after series.\n    if (__DEV__) {\n        if (!ecModel._seriesIndices) {\n            throw new Error('Option should contains series.');\n        }\n    }\n}\n\nmixin(GlobalModel, colorPaletteMixin);\n\nvar echartsAPIList = [\n    'getDom', 'getZr', 'getWidth', 'getHeight', 'getDevicePixelRatio', 'dispatchAction', 'isDisposed',\n    'on', 'off', 'getDataURL', 'getConnectedDataURL', 'getModel', 'getOption',\n    'getViewOfComponentModel', 'getViewOfSeriesModel'\n];\n// And `getCoordinateSystems` and `getComponentByElement` will be injected in echarts.js\n\nfunction ExtensionAPI(chartInstance) {\n    each$1(echartsAPIList, function (name) {\n        this[name] = bind(chartInstance[name], chartInstance);\n    }, this);\n}\n\nvar coordinateSystemCreators = {};\n\nfunction CoordinateSystemManager() {\n\n    this._coordinateSystems = [];\n}\n\nCoordinateSystemManager.prototype = {\n\n    constructor: CoordinateSystemManager,\n\n    create: function (ecModel, api) {\n        var coordinateSystems = [];\n        each$1(coordinateSystemCreators, function (creater, type) {\n            var list = creater.create(ecModel, api);\n            coordinateSystems = coordinateSystems.concat(list || []);\n        });\n\n        this._coordinateSystems = coordinateSystems;\n    },\n\n    update: function (ecModel, api) {\n        each$1(this._coordinateSystems, function (coordSys) {\n            coordSys.update && coordSys.update(ecModel, api);\n        });\n    },\n\n    getCoordinateSystems: function () {\n        return this._coordinateSystems.slice();\n    }\n};\n\nCoordinateSystemManager.register = function (type, coordinateSystemCreator) {\n    coordinateSystemCreators[type] = coordinateSystemCreator;\n};\n\nCoordinateSystemManager.get = function (type) {\n    return coordinateSystemCreators[type];\n};\n\n/**\n * ECharts option manager\n *\n * @module {echarts/model/OptionManager}\n */\n\n\nvar each$4 = each$1;\nvar clone$3 = clone;\nvar map$1 = map;\nvar merge$1 = merge;\n\nvar QUERY_REG = /^(min|max)?(.+)$/;\n\n/**\n * TERM EXPLANATIONS:\n *\n * [option]:\n *\n *     An object that contains definitions of components. For example:\n *     var option = {\n *         title: {...},\n *         legend: {...},\n *         visualMap: {...},\n *         series: [\n *             {data: [...]},\n *             {data: [...]},\n *             ...\n *         ]\n *     };\n *\n * [rawOption]:\n *\n *     An object input to echarts.setOption. 'rawOption' may be an\n *     'option', or may be an object contains multi-options. For example:\n *     var option = {\n *         baseOption: {\n *             title: {...},\n *             legend: {...},\n *             series: [\n *                 {data: [...]},\n *                 {data: [...]},\n *                 ...\n *             ]\n *         },\n *         timeline: {...},\n *         options: [\n *             {title: {...}, series: {data: [...]}},\n *             {title: {...}, series: {data: [...]}},\n *             ...\n *         ],\n *         media: [\n *             {\n *                 query: {maxWidth: 320},\n *                 option: {series: {x: 20}, visualMap: {show: false}}\n *             },\n *             {\n *                 query: {minWidth: 320, maxWidth: 720},\n *                 option: {series: {x: 500}, visualMap: {show: true}}\n *             },\n *             {\n *                 option: {series: {x: 1200}, visualMap: {show: true}}\n *             }\n *         ]\n *     };\n *\n * @alias module:echarts/model/OptionManager\n * @param {module:echarts/ExtensionAPI} api\n */\nfunction OptionManager(api) {\n\n    /**\n     * @private\n     * @type {module:echarts/ExtensionAPI}\n     */\n    this._api = api;\n\n    /**\n     * @private\n     * @type {Array.<number>}\n     */\n    this._timelineOptions = [];\n\n    /**\n     * @private\n     * @type {Array.<Object>}\n     */\n    this._mediaList = [];\n\n    /**\n     * @private\n     * @type {Object}\n     */\n    this._mediaDefault;\n\n    /**\n     * -1, means default.\n     * empty means no media.\n     * @private\n     * @type {Array.<number>}\n     */\n    this._currentMediaIndices = [];\n\n    /**\n     * @private\n     * @type {Object}\n     */\n    this._optionBackup;\n\n    /**\n     * @private\n     * @type {Object}\n     */\n    this._newBaseOption;\n}\n\n// timeline.notMerge is not supported in ec3. Firstly there is rearly\n// case that notMerge is needed. Secondly supporting 'notMerge' requires\n// rawOption cloned and backuped when timeline changed, which does no\n// good to performance. What's more, that both timeline and setOption\n// method supply 'notMerge' brings complex and some problems.\n// Consider this case:\n// (step1) chart.setOption({timeline: {notMerge: false}, ...}, false);\n// (step2) chart.setOption({timeline: {notMerge: true}, ...}, false);\n\nOptionManager.prototype = {\n\n    constructor: OptionManager,\n\n    /**\n     * @public\n     * @param {Object} rawOption Raw option.\n     * @param {module:echarts/model/Global} ecModel\n     * @param {Array.<Function>} optionPreprocessorFuncs\n     * @return {Object} Init option\n     */\n    setOption: function (rawOption, optionPreprocessorFuncs) {\n        if (rawOption) {\n            // That set dat primitive is dangerous if user reuse the data when setOption again.\n            each$1(normalizeToArray(rawOption.series), function (series) {\n                series && series.data && isTypedArray(series.data) && setAsPrimitive(series.data);\n            });\n        }\n\n        // Caution: some series modify option data, if do not clone,\n        // it should ensure that the repeat modify correctly\n        // (create a new object when modify itself).\n        rawOption = clone$3(rawOption, true);\n\n        // FIXME\n        //  timeline options  media baseOption\n\n        var oldOptionBackup = this._optionBackup;\n        var newParsedOption = parseRawOption.call(\n            this, rawOption, optionPreprocessorFuncs, !oldOptionBackup\n        );\n        this._newBaseOption = newParsedOption.baseOption;\n\n        // For setOption at second time (using merge mode);\n        if (oldOptionBackup) {\n            // Only baseOption can be merged.\n            mergeOption(oldOptionBackup.baseOption, newParsedOption.baseOption);\n\n            // For simplicity, timeline options and media options do not support merge,\n            // that is, if you `setOption` twice and both has timeline options, the latter\n            // timeline opitons will not be merged to the formers, but just substitude them.\n            if (newParsedOption.timelineOptions.length) {\n                oldOptionBackup.timelineOptions = newParsedOption.timelineOptions;\n            }\n            if (newParsedOption.mediaList.length) {\n                oldOptionBackup.mediaList = newParsedOption.mediaList;\n            }\n            if (newParsedOption.mediaDefault) {\n                oldOptionBackup.mediaDefault = newParsedOption.mediaDefault;\n            }\n        }\n        else {\n            this._optionBackup = newParsedOption;\n        }\n    },\n\n    /**\n     * @param {boolean} isRecreate\n     * @return {Object}\n     */\n    mountOption: function (isRecreate) {\n        var optionBackup = this._optionBackup;\n\n        // TODO\n        // resetclone\n\n        this._timelineOptions = map$1(optionBackup.timelineOptions, clone$3);\n        this._mediaList = map$1(optionBackup.mediaList, clone$3);\n        this._mediaDefault = clone$3(optionBackup.mediaDefault);\n        this._currentMediaIndices = [];\n\n        return clone$3(isRecreate\n            // this._optionBackup.baseOption, which is created at the first `setOption`\n            // called, and is merged into every new option by inner method `mergeOption`\n            // each time `setOption` called, can be only used in `isRecreate`, because\n            // its reliability is under suspicion. In other cases option merge is\n            // performed by `model.mergeOption`.\n            ? optionBackup.baseOption : this._newBaseOption\n        );\n    },\n\n    /**\n     * @param {module:echarts/model/Global} ecModel\n     * @return {Object}\n     */\n    getTimelineOption: function (ecModel) {\n        var option;\n        var timelineOptions = this._timelineOptions;\n\n        if (timelineOptions.length) {\n            // getTimelineOption can only be called after ecModel inited,\n            // so we can get currentIndex from timelineModel.\n            var timelineModel = ecModel.getComponent('timeline');\n            if (timelineModel) {\n                option = clone$3(\n                    timelineOptions[timelineModel.getCurrentIndex()],\n                    true\n                );\n            }\n        }\n\n        return option;\n    },\n\n    /**\n     * @param {module:echarts/model/Global} ecModel\n     * @return {Array.<Object>}\n     */\n    getMediaOption: function (ecModel) {\n        var ecWidth = this._api.getWidth();\n        var ecHeight = this._api.getHeight();\n        var mediaList = this._mediaList;\n        var mediaDefault = this._mediaDefault;\n        var indices = [];\n        var result = [];\n\n        // No media defined.\n        if (!mediaList.length && !mediaDefault) {\n            return result;\n        }\n\n        // Multi media may be applied, the latter defined media has higher priority.\n        for (var i = 0, len = mediaList.length; i < len; i++) {\n            if (applyMediaQuery(mediaList[i].query, ecWidth, ecHeight)) {\n                indices.push(i);\n            }\n        }\n\n        // FIXME\n        // mediaDefault\n        if (!indices.length && mediaDefault) {\n            indices = [-1];\n        }\n\n        if (indices.length && !indicesEquals(indices, this._currentMediaIndices)) {\n            result = map$1(indices, function (index) {\n                return clone$3(\n                    index === -1 ? mediaDefault.option : mediaList[index].option\n                );\n            });\n        }\n        // Otherwise return nothing.\n\n        this._currentMediaIndices = indices;\n\n        return result;\n    }\n};\n\nfunction parseRawOption(rawOption, optionPreprocessorFuncs, isNew) {\n    var timelineOptions = [];\n    var mediaList = [];\n    var mediaDefault;\n    var baseOption;\n\n    // Compatible with ec2.\n    var timelineOpt = rawOption.timeline;\n\n    if (rawOption.baseOption) {\n        baseOption = rawOption.baseOption;\n    }\n\n    // For timeline\n    if (timelineOpt || rawOption.options) {\n        baseOption = baseOption || {};\n        timelineOptions = (rawOption.options || []).slice();\n    }\n\n    // For media query\n    if (rawOption.media) {\n        baseOption = baseOption || {};\n        var media = rawOption.media;\n        each$4(media, function (singleMedia) {\n            if (singleMedia && singleMedia.option) {\n                if (singleMedia.query) {\n                    mediaList.push(singleMedia);\n                }\n                else if (!mediaDefault) {\n                    // Use the first media default.\n                    mediaDefault = singleMedia;\n                }\n            }\n        });\n    }\n\n    // For normal option\n    if (!baseOption) {\n        baseOption = rawOption;\n    }\n\n    // Set timelineOpt to baseOption in ec3,\n    // which is convenient for merge option.\n    if (!baseOption.timeline) {\n        baseOption.timeline = timelineOpt;\n    }\n\n    // Preprocess.\n    each$4([baseOption].concat(timelineOptions)\n        .concat(map(mediaList, function (media) {\n            return media.option;\n        })),\n        function (option) {\n            each$4(optionPreprocessorFuncs, function (preProcess) {\n                preProcess(option, isNew);\n            });\n        }\n    );\n\n    return {\n        baseOption: baseOption,\n        timelineOptions: timelineOptions,\n        mediaDefault: mediaDefault,\n        mediaList: mediaList\n    };\n}\n\n/**\n * @see <http://www.w3.org/TR/css3-mediaqueries/#media1>\n * Support: width, height, aspectRatio\n * Can use max or min as prefix.\n */\nfunction applyMediaQuery(query, ecWidth, ecHeight) {\n    var realMap = {\n        width: ecWidth,\n        height: ecHeight,\n        aspectratio: ecWidth / ecHeight // lowser case for convenientce.\n    };\n\n    var applicatable = true;\n\n    each$1(query, function (value, attr) {\n        var matched = attr.match(QUERY_REG);\n\n        if (!matched || !matched[1] || !matched[2]) {\n            return;\n        }\n\n        var operator = matched[1];\n        var realAttr = matched[2].toLowerCase();\n\n        if (!compare(realMap[realAttr], value, operator)) {\n            applicatable = false;\n        }\n    });\n\n    return applicatable;\n}\n\nfunction compare(real, expect, operator) {\n    if (operator === 'min') {\n        return real >= expect;\n    }\n    else if (operator === 'max') {\n        return real <= expect;\n    }\n    else { // Equals\n        return real === expect;\n    }\n}\n\nfunction indicesEquals(indices1, indices2) {\n    // indices is always order by asc and has only finite number.\n    return indices1.join(',') === indices2.join(',');\n}\n\n/**\n * Consider case:\n * `chart.setOption(opt1);`\n * Then user do some interaction like dataZoom, dataView changing.\n * `chart.setOption(opt2);`\n * Then user press 'reset button' in toolbox.\n *\n * After doing that all of the interaction effects should be reset, the\n * chart should be the same as the result of invoke\n * `chart.setOption(opt1); chart.setOption(opt2);`.\n *\n * Although it is not able ensure that\n * `chart.setOption(opt1); chart.setOption(opt2);` is equivalents to\n * `chart.setOption(merge(opt1, opt2));` exactly,\n * this might be the only simple way to implement that feature.\n *\n * MEMO: We've considered some other approaches:\n * 1. Each model handle its self restoration but not uniform treatment.\n *     (Too complex in logic and error-prone)\n * 2. Use a shadow ecModel. (Performace expensive)\n */\nfunction mergeOption(oldOption, newOption) {\n    newOption = newOption || {};\n\n    each$4(newOption, function (newCptOpt, mainType) {\n        if (newCptOpt == null) {\n            return;\n        }\n\n        var oldCptOpt = oldOption[mainType];\n\n        if (!ComponentModel.hasClass(mainType)) {\n            oldOption[mainType] = merge$1(oldCptOpt, newCptOpt, true);\n        }\n        else {\n            newCptOpt = normalizeToArray(newCptOpt);\n            oldCptOpt = normalizeToArray(oldCptOpt);\n\n            var mapResult = mappingToExists(oldCptOpt, newCptOpt);\n\n            oldOption[mainType] = map$1(mapResult, function (item) {\n                return (item.option && item.exist)\n                    ? merge$1(item.exist, item.option, true)\n                    : (item.exist || item.option);\n            });\n        }\n    });\n}\n\nvar each$5 = each$1;\nvar isObject$3 = isObject$1;\n\nvar POSSIBLE_STYLES = [\n    'areaStyle', 'lineStyle', 'nodeStyle', 'linkStyle',\n    'chordStyle', 'label', 'labelLine'\n];\n\nfunction compatEC2ItemStyle(opt) {\n    var itemStyleOpt = opt && opt.itemStyle;\n    if (!itemStyleOpt) {\n        return;\n    }\n    for (var i = 0, len = POSSIBLE_STYLES.length; i < len; i++) {\n        var styleName = POSSIBLE_STYLES[i];\n        var normalItemStyleOpt = itemStyleOpt.normal;\n        var emphasisItemStyleOpt = itemStyleOpt.emphasis;\n        if (normalItemStyleOpt && normalItemStyleOpt[styleName]) {\n            opt[styleName] = opt[styleName] || {};\n            if (!opt[styleName].normal) {\n                opt[styleName].normal = normalItemStyleOpt[styleName];\n            }\n            else {\n                merge(opt[styleName].normal, normalItemStyleOpt[styleName]);\n            }\n            normalItemStyleOpt[styleName] = null;\n        }\n        if (emphasisItemStyleOpt && emphasisItemStyleOpt[styleName]) {\n            opt[styleName] = opt[styleName] || {};\n            if (!opt[styleName].emphasis) {\n                opt[styleName].emphasis = emphasisItemStyleOpt[styleName];\n            }\n            else {\n                merge(opt[styleName].emphasis, emphasisItemStyleOpt[styleName]);\n            }\n            emphasisItemStyleOpt[styleName] = null;\n        }\n    }\n}\n\nfunction convertNormalEmphasis(opt, optType, useExtend) {\n    if (opt && opt[optType] && (opt[optType].normal || opt[optType].emphasis)) {\n        var normalOpt = opt[optType].normal;\n        var emphasisOpt = opt[optType].emphasis;\n\n        if (normalOpt) {\n            // Timeline controlStyle has other properties besides normal and emphasis\n            if (useExtend) {\n                opt[optType].normal = opt[optType].emphasis = null;\n                defaults(opt[optType], normalOpt);\n            }\n            else {\n                opt[optType] = normalOpt;\n            }\n        }\n        if (emphasisOpt) {\n            opt.emphasis = opt.emphasis || {};\n            opt.emphasis[optType] = emphasisOpt;\n        }\n    }\n}\nfunction removeEC3NormalStatus(opt) {\n    convertNormalEmphasis(opt, 'itemStyle');\n    convertNormalEmphasis(opt, 'lineStyle');\n    convertNormalEmphasis(opt, 'areaStyle');\n    convertNormalEmphasis(opt, 'label');\n    convertNormalEmphasis(opt, 'labelLine');\n    // treemap\n    convertNormalEmphasis(opt, 'upperLabel');\n    // graph\n    convertNormalEmphasis(opt, 'edgeLabel');\n}\n\nfunction compatTextStyle(opt, propName) {\n    // Check whether is not object (string\\null\\undefined ...)\n    var labelOptSingle = isObject$3(opt) && opt[propName];\n    var textStyle = isObject$3(labelOptSingle) && labelOptSingle.textStyle;\n    if (textStyle) {\n        for (var i = 0, len = TEXT_STYLE_OPTIONS.length; i < len; i++) {\n            var propName = TEXT_STYLE_OPTIONS[i];\n            if (textStyle.hasOwnProperty(propName)) {\n                labelOptSingle[propName] = textStyle[propName];\n            }\n        }\n    }\n}\n\nfunction compatEC3CommonStyles(opt) {\n    if (opt) {\n        removeEC3NormalStatus(opt);\n        compatTextStyle(opt, 'label');\n        opt.emphasis && compatTextStyle(opt.emphasis, 'label');\n    }\n}\n\nfunction processSeries(seriesOpt) {\n    if (!isObject$3(seriesOpt)) {\n        return;\n    }\n\n    compatEC2ItemStyle(seriesOpt);\n    removeEC3NormalStatus(seriesOpt);\n\n    compatTextStyle(seriesOpt, 'label');\n    // treemap\n    compatTextStyle(seriesOpt, 'upperLabel');\n    // graph\n    compatTextStyle(seriesOpt, 'edgeLabel');\n    if (seriesOpt.emphasis) {\n        compatTextStyle(seriesOpt.emphasis, 'label');\n        // treemap\n        compatTextStyle(seriesOpt.emphasis, 'upperLabel');\n        // graph\n        compatTextStyle(seriesOpt.emphasis, 'edgeLabel');\n    }\n\n    var markPoint = seriesOpt.markPoint;\n    if (markPoint) {\n        compatEC2ItemStyle(markPoint);\n        compatEC3CommonStyles(markPoint);\n    }\n\n    var markLine = seriesOpt.markLine;\n    if (markLine) {\n        compatEC2ItemStyle(markLine);\n        compatEC3CommonStyles(markLine);\n    }\n\n    var markArea = seriesOpt.markArea;\n    if (markArea) {\n        compatEC3CommonStyles(markArea);\n    }\n\n    var data = seriesOpt.data;\n\n    // Break with ec3: if `setOption` again, there may be no `type` in option,\n    // then the backward compat based on option type will not be performed.\n\n    if (seriesOpt.type === 'graph') {\n        data = data || seriesOpt.nodes;\n        var edgeData = seriesOpt.links || seriesOpt.edges;\n        if (edgeData && !isTypedArray(edgeData)) {\n            for (var i = 0; i < edgeData.length; i++) {\n                compatEC3CommonStyles(edgeData[i]);\n            }\n        }\n        each$1(seriesOpt.categories, function (opt) {\n            removeEC3NormalStatus(opt);\n        });\n    }\n\n    if (data && !isTypedArray(data)) {\n        for (var i = 0; i < data.length; i++) {\n            compatEC3CommonStyles(data[i]);\n        }\n    }\n\n    // mark point data\n    var markPoint = seriesOpt.markPoint;\n    if (markPoint && markPoint.data) {\n        var mpData = markPoint.data;\n        for (var i = 0; i < mpData.length; i++) {\n            compatEC3CommonStyles(mpData[i]);\n        }\n    }\n    // mark line data\n    var markLine = seriesOpt.markLine;\n    if (markLine && markLine.data) {\n        var mlData = markLine.data;\n        for (var i = 0; i < mlData.length; i++) {\n            if (isArray(mlData[i])) {\n                compatEC3CommonStyles(mlData[i][0]);\n                compatEC3CommonStyles(mlData[i][1]);\n            }\n            else {\n                compatEC3CommonStyles(mlData[i]);\n            }\n        }\n    }\n\n    // Series\n    if (seriesOpt.type === 'gauge') {\n        compatTextStyle(seriesOpt, 'axisLabel');\n        compatTextStyle(seriesOpt, 'title');\n        compatTextStyle(seriesOpt, 'detail');\n    }\n    else if (seriesOpt.type === 'treemap') {\n        convertNormalEmphasis(seriesOpt.breadcrumb, 'itemStyle');\n        each$1(seriesOpt.levels, function (opt) {\n            removeEC3NormalStatus(opt);\n        });\n    }\n    // sunburst starts from ec4, so it does not need to compat levels.\n}\n\nfunction toArr(o) {\n    return isArray(o) ? o : o ? [o] : [];\n}\n\nfunction toObj(o) {\n    return (isArray(o) ? o[0] : o) || {};\n}\n\nvar compatStyle = function (option, isTheme) {\n    each$5(toArr(option.series), function (seriesOpt) {\n        isObject$3(seriesOpt) && processSeries(seriesOpt);\n    });\n\n    var axes = ['xAxis', 'yAxis', 'radiusAxis', 'angleAxis', 'singleAxis', 'parallelAxis', 'radar'];\n    isTheme && axes.push('valueAxis', 'categoryAxis', 'logAxis', 'timeAxis');\n\n    each$5(\n        axes,\n        function (axisName) {\n            each$5(toArr(option[axisName]), function (axisOpt) {\n                if (axisOpt) {\n                    compatTextStyle(axisOpt, 'axisLabel');\n                    compatTextStyle(axisOpt.axisPointer, 'label');\n                }\n            });\n        }\n    );\n\n    each$5(toArr(option.parallel), function (parallelOpt) {\n        var parallelAxisDefault = parallelOpt && parallelOpt.parallelAxisDefault;\n        compatTextStyle(parallelAxisDefault, 'axisLabel');\n        compatTextStyle(parallelAxisDefault && parallelAxisDefault.axisPointer, 'label');\n    });\n\n    each$5(toArr(option.calendar), function (calendarOpt) {\n        convertNormalEmphasis(calendarOpt, 'itemStyle');\n        compatTextStyle(calendarOpt, 'dayLabel');\n        compatTextStyle(calendarOpt, 'monthLabel');\n        compatTextStyle(calendarOpt, 'yearLabel');\n    });\n\n    // radar.name.textStyle\n    each$5(toArr(option.radar), function (radarOpt) {\n        compatTextStyle(radarOpt, 'name');\n    });\n\n    each$5(toArr(option.geo), function (geoOpt) {\n        if (isObject$3(geoOpt)) {\n            compatEC3CommonStyles(geoOpt);\n            each$5(toArr(geoOpt.regions), function (regionObj) {\n                compatEC3CommonStyles(regionObj);\n            });\n        }\n    });\n\n    each$5(toArr(option.timeline), function (timelineOpt) {\n        compatEC3CommonStyles(timelineOpt);\n        convertNormalEmphasis(timelineOpt, 'label');\n        convertNormalEmphasis(timelineOpt, 'itemStyle');\n        convertNormalEmphasis(timelineOpt, 'controlStyle', true);\n\n        var data = timelineOpt.data;\n        isArray(data) && each$1(data, function (item) {\n            if (isObject$1(item)) {\n                convertNormalEmphasis(item, 'label');\n                convertNormalEmphasis(item, 'itemStyle');\n            }\n        });\n    });\n\n    each$5(toArr(option.toolbox), function (toolboxOpt) {\n        convertNormalEmphasis(toolboxOpt, 'iconStyle');\n        each$5(toolboxOpt.feature, function (featureOpt) {\n            convertNormalEmphasis(featureOpt, 'iconStyle');\n        });\n    });\n\n    compatTextStyle(toObj(option.axisPointer), 'label');\n    compatTextStyle(toObj(option.tooltip).axisPointer, 'label');\n};\n\n// Compatitable with 2.0\n\nfunction get(opt, path) {\n    path = path.split(',');\n    var obj = opt;\n    for (var i = 0; i < path.length; i++) {\n        obj = obj && obj[path[i]];\n        if (obj == null) {\n            break;\n        }\n    }\n    return obj;\n}\n\nfunction set$1(opt, path, val, overwrite) {\n    path = path.split(',');\n    var obj = opt;\n    var key;\n    for (var i = 0; i < path.length - 1; i++) {\n        key = path[i];\n        if (obj[key] == null) {\n            obj[key] = {};\n        }\n        obj = obj[key];\n    }\n    if (overwrite || obj[path[i]] == null) {\n        obj[path[i]] = val;\n    }\n}\n\nfunction compatLayoutProperties(option) {\n    each$1(LAYOUT_PROPERTIES, function (prop) {\n        if (prop[0] in option && !(prop[1] in option)) {\n            option[prop[1]] = option[prop[0]];\n        }\n    });\n}\n\nvar LAYOUT_PROPERTIES = [\n    ['x', 'left'], ['y', 'top'], ['x2', 'right'], ['y2', 'bottom']\n];\n\nvar COMPATITABLE_COMPONENTS = [\n    'grid', 'geo', 'parallel', 'legend', 'toolbox', 'title', 'visualMap', 'dataZoom', 'timeline'\n];\n\nvar backwardCompat = function (option, isTheme) {\n    compatStyle(option, isTheme);\n\n    // Make sure series array for model initialization.\n    option.series = normalizeToArray(option.series);\n\n    each$1(option.series, function (seriesOpt) {\n        if (!isObject$1(seriesOpt)) {\n            return;\n        }\n\n        var seriesType = seriesOpt.type;\n\n        if (seriesType === 'pie' || seriesType === 'gauge') {\n            if (seriesOpt.clockWise != null) {\n                seriesOpt.clockwise = seriesOpt.clockWise;\n            }\n        }\n        if (seriesType === 'gauge') {\n            var pointerColor = get(seriesOpt, 'pointer.color');\n            pointerColor != null\n                && set$1(seriesOpt, 'itemStyle.normal.color', pointerColor);\n        }\n\n        compatLayoutProperties(seriesOpt);\n    });\n\n    // dataRange has changed to visualMap\n    if (option.dataRange) {\n        option.visualMap = option.dataRange;\n    }\n\n    each$1(COMPATITABLE_COMPONENTS, function (componentName) {\n        var options = option[componentName];\n        if (options) {\n            if (!isArray(options)) {\n                options = [options];\n            }\n            each$1(options, function (option) {\n                compatLayoutProperties(option);\n            });\n        }\n    });\n};\n\n// (1) [Caution]: the logic is correct based on the premises:\n//     data processing stage is blocked in stream.\n//     See <module:echarts/stream/Scheduler#performDataProcessorTasks>\n// (2) Only register once when import repeatly.\n//     Should be executed before after series filtered and before stack calculation.\nvar dataStack = function (ecModel) {\n    var stackInfoMap = createHashMap();\n    ecModel.eachSeries(function (seriesModel) {\n        var stack = seriesModel.get('stack');\n        // Compatibal: when `stack` is set as '', do not stack.\n        if (stack) {\n            var stackInfoList = stackInfoMap.get(stack) || stackInfoMap.set(stack, []);\n            var data = seriesModel.getData();\n\n            var stackInfo = {\n                // Used for calculate axis extent automatically.\n                stackResultDimension: data.getCalculationInfo('stackResultDimension'),\n                stackedOverDimension: data.getCalculationInfo('stackedOverDimension'),\n                stackedDimension: data.getCalculationInfo('stackedDimension'),\n                stackedByDimension: data.getCalculationInfo('stackedByDimension'),\n                isStackedByIndex: data.getCalculationInfo('isStackedByIndex'),\n                data: data,\n                seriesModel: seriesModel\n            };\n\n            // If stacked on axis that do not support data stack.\n            if (!stackInfo.stackedDimension\n                || !(stackInfo.isStackedByIndex || stackInfo.stackedByDimension)\n            ) {\n                return;\n            }\n\n            stackInfoList.length && data.setCalculationInfo(\n                'stackedOnSeries', stackInfoList[stackInfoList.length - 1].seriesModel\n            );\n\n            stackInfoList.push(stackInfo);\n        }\n    });\n\n    stackInfoMap.each(calculateStack);\n};\n\nfunction calculateStack(stackInfoList) {\n    each$1(stackInfoList, function (targetStackInfo, idxInStack) {\n        var resultVal = [];\n        var resultNaN = [NaN, NaN];\n        var dims = [targetStackInfo.stackResultDimension, targetStackInfo.stackedOverDimension];\n        var targetData = targetStackInfo.data;\n        var isStackedByIndex = targetStackInfo.isStackedByIndex;\n\n        // Should not write on raw data, because stack series model list changes\n        // depending on legend selection.\n        var newData = targetData.map(dims, function (v0, v1, dataIndex) {\n            var sum = targetData.get(targetStackInfo.stackedDimension, dataIndex);\n\n            // Consider `connectNulls` of line area, if value is NaN, stackedOver\n            // should also be NaN, to draw a appropriate belt area.\n            if (isNaN(sum)) {\n                return resultNaN;\n            }\n\n            var byValue;\n            var stackedDataRawIndex;\n\n            if (isStackedByIndex) {\n                stackedDataRawIndex = targetData.getRawIndex(dataIndex);\n            }\n            else {\n                byValue = targetData.get(targetStackInfo.stackedByDimension, dataIndex);\n            }\n\n            // If stackOver is NaN, chart view will render point on value start.\n            var stackedOver = NaN;\n\n            for (var j = idxInStack - 1; j >= 0; j--) {\n                var stackInfo = stackInfoList[j];\n\n                // Has been optimized by inverted indices on `stackedByDimension`.\n                if (!isStackedByIndex) {\n                    stackedDataRawIndex = stackInfo.data.rawIndexOf(stackInfo.stackedByDimension, byValue);\n                }\n\n                if (stackedDataRawIndex >= 0) {\n                    var val = stackInfo.data.getByRawIndex(stackInfo.stackResultDimension, stackedDataRawIndex);\n\n                    // Considering positive stack, negative stack and empty data\n                    if ((sum >= 0 && val > 0) // Positive stack\n                        || (sum <= 0 && val < 0) // Negative stack\n                    ) {\n                        sum += val;\n                        stackedOver = val;\n                        break;\n                    }\n                }\n            }\n\n            resultVal[0] = sum;\n            resultVal[1] = stackedOver;\n\n            return resultVal;\n        });\n\n        targetData.hostModel.setData(newData);\n        // Update for consequent calculation\n        targetStackInfo.data = newData;\n    });\n}\n\n// TODO\n// ??? refactor? check the outer usage of data provider.\n// merge with defaultDimValueGetter?\n\n/**\n * If normal array used, mutable chunk size is supported.\n * If typed array used, chunk size must be fixed.\n */\nfunction DefaultDataProvider(source, dimSize) {\n    if (!Source.isInstance(source)) {\n        source = Source.seriesDataToSource(source);\n    }\n    this._source = source;\n\n    var data = this._data = source.data;\n    var sourceFormat = source.sourceFormat;\n\n    // Typed array. TODO IE10+?\n    if (sourceFormat === SOURCE_FORMAT_TYPED_ARRAY) {\n        if (__DEV__) {\n            if (dimSize == null) {\n                throw new Error('Typed array data must specify dimension size');\n            }\n        }\n        this._offset = 0;\n        this._dimSize = dimSize;\n        this._data = data;\n    }\n\n    var methods = providerMethods[\n        sourceFormat === SOURCE_FORMAT_ARRAY_ROWS\n        ? sourceFormat + '_' + source.seriesLayoutBy\n        : sourceFormat\n    ];\n\n    if (__DEV__) {\n        assert$1(methods, 'Invalide sourceFormat: ' + sourceFormat);\n    }\n\n    extend(this, methods);\n}\n\nvar providerProto = DefaultDataProvider.prototype;\n// If data is pure without style configuration\nproviderProto.pure = false;\n// If data is persistent and will not be released after use.\nproviderProto.persistent = true;\n\n// ???! FIXME legacy data provider do not has method getSource\nproviderProto.getSource = function () {\n    return this._source;\n};\n\nvar providerMethods = {\n\n    'arrayRows_column': {\n        pure: true,\n        count: function () {\n            return Math.max(0, this._data.length - this._source.startIndex);\n        },\n        getItem: function (idx) {\n            return this._data[idx + this._source.startIndex];\n        },\n        appendData: appendDataSimply\n    },\n\n    'arrayRows_row': {\n        pure: true,\n        count: function () {\n            var row = this._data[0];\n            return row ? Math.max(0, row.length - this._source.startIndex) : 0;\n        },\n        getItem: function (idx) {\n            idx += this._source.startIndex;\n            var item = [];\n            var data = this._data;\n            for (var i = 0; i < data.length; i++) {\n                var row = data[i];\n                item.push(row ? row[idx] : null);\n            }\n            return item;\n        },\n        appendData: function () {\n            throw new Error('Do not support appendData when set seriesLayoutBy: \"row\".');\n        }\n    },\n\n    'objectRows': {\n        pure: true,\n        count: countSimply,\n        getItem: getItemSimply,\n        appendData: appendDataSimply\n    },\n\n    'keyedColumns': {\n        pure: true,\n        count: function () {\n            var dimName = this._source.dimensionsDefine[0].name;\n            var col = this._data[dimName];\n            return col ? col.length : 0;\n        },\n        getItem: function (idx) {\n            var item = [];\n            var dims = this._source.dimensionsDefine;\n            for (var i = 0; i < dims.length; i++) {\n                var col = this._data[dims[i].name];\n                item.push(col ? col[idx] : null);\n            }\n            return item;\n        },\n        appendData: function (newData) {\n            var data = this._data;\n            each$1(newData, function (newCol, key) {\n                var oldCol = data[key] || (data[key] = []);\n                for (var i = 0; i < (newCol || []).length; i++) {\n                    oldCol.push(newCol[i]);\n                }\n            });\n        }\n    },\n\n    'original': {\n        count: countSimply,\n        getItem: getItemSimply,\n        appendData: appendDataSimply\n    },\n\n    'typedArray': {\n        persistent: false,\n        pure: true,\n        count: function () {\n            return this._data ? (this._data.length / this._dimSize) : 0;\n        },\n        getItem: function (idx) {\n            idx = idx - this._offset;\n            var item = [];\n            var offset = this._dimSize * idx;\n            for (var i = 0; i < this._dimSize; i++) {\n                item[i] = this._data[offset + i];\n            }\n            return item;\n        },\n        appendData: function (newData) {\n            if (__DEV__) {\n                assert$1(\n                    isTypedArray(newData),\n                    'Added data must be TypedArray if data in initialization is TypedArray'\n                );\n            }\n\n            this._data = newData;\n        },\n\n        // Clean self if data is already used.\n        clean: function () {\n            // PENDING\n            this._offset += this.count();\n            this._data = null;\n        }\n    }\n};\n\nfunction countSimply() {\n    return this._data.length;\n}\nfunction getItemSimply(idx) {\n    return this._data[idx];\n}\nfunction appendDataSimply(newData) {\n    for (var i = 0; i < newData.length; i++) {\n        this._data.push(newData[i]);\n    }\n}\n\n\n\nvar rawValueGetters = {\n\n    arrayRows: getRawValueSimply,\n\n    objectRows: function (dataItem, dataIndex, dimIndex, dimName) {\n        return dimIndex != null ? dataItem[dimName] : dataItem;\n    },\n\n    keyedColumns: getRawValueSimply,\n\n    original: function (dataItem, dataIndex, dimIndex, dimName) {\n        // FIXME\n        // In some case (markpoint in geo (geo-map.html)), dataItem\n        // is {coord: [...]}\n        var value = getDataItemValue(dataItem);\n        return (dimIndex == null || !(value instanceof Array))\n            ? value\n            : value[dimIndex];\n    },\n\n    typedArray: getRawValueSimply\n};\n\nfunction getRawValueSimply(dataItem, dataIndex, dimIndex, dimName) {\n    return dimIndex != null ? dataItem[dimIndex] : dataItem;\n}\n\n\nvar defaultDimValueGetters = {\n\n    arrayRows: getDimValueSimply,\n\n    objectRows: function (dataItem, dimName, dataIndex, dimIndex) {\n        return converDataValue(dataItem[dimName], this._dimensionInfos[dimName]);\n    },\n\n    keyedColumns: getDimValueSimply,\n\n    original: function (dataItem, dimName, dataIndex, dimIndex) {\n        // Performance sensitive, do not use modelUtil.getDataItemValue.\n        // If dataItem is an plain object with no value field, the var `value`\n        // will be assigned with the object, but it will be tread correctly\n        // in the `convertDataValue`.\n        var value = dataItem && (dataItem.value == null ? dataItem : dataItem.value);\n\n        // If any dataItem is like { value: 10 }\n        if (!this._rawData.pure && isDataItemOption(dataItem)) {\n            this.hasItemOption = true;\n        }\n        return converDataValue(\n            (value instanceof Array)\n                ? value[dimIndex]\n                // If value is a single number or something else not array.\n                : value,\n            this._dimensionInfos[dimName]\n        );\n    },\n\n    typedArray: function (dataItem, dimName, dataIndex, dimIndex) {\n        return dataItem[dimIndex];\n    }\n\n};\n\nfunction getDimValueSimply(dataItem, dimName, dataIndex, dimIndex) {\n    return converDataValue(dataItem[dimIndex], this._dimensionInfos[dimName]);\n}\n\n/**\n * This helper method convert value in data.\n * @param {string|number|Date} value\n * @param {Object|string} [dimInfo] If string (like 'x'), dimType defaults 'number'.\n *        If \"dimInfo.ordinalParseAndSave\", ordinal value can be parsed.\n */\nfunction converDataValue(value, dimInfo) {\n    // Performance sensitive.\n    var dimType = dimInfo && dimInfo.type;\n    if (dimType === 'ordinal') {\n        // If given value is a category string\n        var ordinalMeta = dimInfo && dimInfo.ordinalMeta;\n        return ordinalMeta\n            ? ordinalMeta.parseAndCollect(value)\n            : value;\n    }\n\n    if (dimType === 'time'\n        // spead up when using timestamp\n        && typeof value !== 'number'\n        && value != null\n        && value !== '-'\n    ) {\n        value = +parseDate(value);\n    }\n\n    // dimType defaults 'number'.\n    // If dimType is not ordinal and value is null or undefined or NaN or '-',\n    // parse to NaN.\n    return (value == null || value === '')\n        ? NaN\n        // If string (like '-'), using '+' parse to NaN\n        // If object, also parse to NaN\n        : +value;\n}\n\n// ??? FIXME can these logic be more neat: getRawValue, getRawDataItem,\n// Consider persistent.\n// Caution: why use raw value to display on label or tooltip?\n// A reason is to avoid format. For example time value we do not know\n// how to format is expected. More over, if stack is used, calculated\n// value may be 0.91000000001, which have brings trouble to display.\n// TODO: consider how to treat null/undefined/NaN when display?\n/**\n * @param {module:echarts/data/List} data\n * @param {number} dataIndex\n * @param {string|number} [dim] dimName or dimIndex\n * @return {Array.<number>|string|number} can be null/undefined.\n */\nfunction retrieveRawValue(data, dataIndex, dim) {\n    if (!data) {\n        return;\n    }\n\n    // Consider data may be not persistent.\n    var dataItem = data.getRawDataItem(dataIndex);\n\n    if (dataItem == null) {\n        return;\n    }\n\n    var sourceFormat = data.getProvider().getSource().sourceFormat;\n    var dimName;\n    var dimIndex;\n\n    var dimInfo = data.getDimensionInfo(dim);\n    if (dimInfo) {\n        dimName = dimInfo.name;\n        dimIndex = dimInfo.index;\n    }\n\n    return rawValueGetters[sourceFormat](dataItem, dataIndex, dimIndex, dimName);\n}\n\n/**\n * Compatible with some cases (in pie, map) like:\n * data: [{name: 'xx', value: 5, selected: true}, ...]\n * where only sourceFormat is 'original' and 'objectRows' supported.\n *\n * ??? TODO\n * Supported detail options in data item when using 'arrayRows'.\n *\n * @param {module:echarts/data/List} data\n * @param {number} dataIndex\n * @param {string} attr like 'selected'\n */\nfunction retrieveRawAttr(data, dataIndex, attr) {\n    if (!data) {\n        return;\n    }\n\n    var sourceFormat = data.getProvider().getSource().sourceFormat;\n\n    if (sourceFormat !== SOURCE_FORMAT_ORIGINAL\n        && sourceFormat !== SOURCE_FORMAT_OBJECT_ROWS\n    ) {\n        return;\n    }\n\n    var dataItem = data.getRawDataItem(dataIndex);\n    if (sourceFormat === SOURCE_FORMAT_ORIGINAL && !isObject$1(dataItem)) {\n        dataItem = null;\n    }\n    if (dataItem) {\n        return dataItem[attr];\n    }\n}\n\nvar DIMENSION_LABEL_REG = /\\{@(.+?)\\}/g;\n\n// PENDING A little ugly\nvar dataFormatMixin = {\n    /**\n     * Get params for formatter\n     * @param {number} dataIndex\n     * @param {string} [dataType]\n     * @return {Object}\n     */\n    getDataParams: function (dataIndex, dataType) {\n        var data = this.getData(dataType);\n        var rawValue = this.getRawValue(dataIndex, dataType);\n        var rawDataIndex = data.getRawIndex(dataIndex);\n        var name = data.getName(dataIndex, true);\n        var itemOpt = data.getRawDataItem(dataIndex);\n        var color = data.getItemVisual(dataIndex, 'color');\n\n        return {\n            componentType: this.mainType,\n            componentSubType: this.subType,\n            seriesType: this.mainType === 'series' ? this.subType : null,\n            seriesIndex: this.seriesIndex,\n            seriesId: this.id,\n            seriesName: this.name,\n            name: name,\n            dataIndex: rawDataIndex,\n            data: itemOpt,\n            dataType: dataType,\n            value: rawValue,\n            color: color,\n            marker: getTooltipMarker(color),\n\n            // Param name list for mapping `a`, `b`, `c`, `d`, `e`\n            $vars: ['seriesName', 'name', 'value']\n        };\n    },\n\n    /**\n     * Format label\n     * @param {number} dataIndex\n     * @param {string} [status='normal'] 'normal' or 'emphasis'\n     * @param {string} [dataType]\n     * @param {number} [dimIndex]\n     * @param {string} [labelProp='label']\n     * @return {string} If not formatter, return null/undefined\n     */\n    getFormattedLabel: function (dataIndex, status, dataType, dimIndex, labelProp) {\n        status = status || 'normal';\n        var data = this.getData(dataType);\n        var itemModel = data.getItemModel(dataIndex);\n\n        var params = this.getDataParams(dataIndex, dataType);\n        if (dimIndex != null && (params.value instanceof Array)) {\n            params.value = params.value[dimIndex];\n        }\n\n        var formatter = itemModel.get(\n            status === 'normal'\n            ? [labelProp || 'label', 'formatter']\n            : [status, labelProp || 'label', 'formatter']\n        );\n\n        if (typeof formatter === 'function') {\n            params.status = status;\n            return formatter(params);\n        }\n        else if (typeof formatter === 'string') {\n            var str = formatTpl(formatter, params);\n\n            // Support 'aaa{@[3]}bbb{@product}ccc'.\n            // Do not support '}' in dim name util have to.\n            return str.replace(DIMENSION_LABEL_REG, function (origin, dim) {\n                var len = dim.length;\n                if (dim.charAt(0) === '[' && dim.charAt(len - 1) === ']') {\n                    dim = +dim.slice(1, len - 1); // Also: '[]' => 0\n                }\n                return retrieveRawValue(data, dataIndex, dim);\n            });\n        }\n    },\n\n    /**\n     * Get raw value in option\n     * @param {number} idx\n     * @param {string} [dataType]\n     * @return {Array|number|string}\n     */\n    getRawValue: function (idx, dataType) {\n        return retrieveRawValue(this.getData(dataType), idx);\n    },\n\n    /**\n     * Should be implemented.\n     * @param {number} dataIndex\n     * @param {boolean} [multipleSeries=false]\n     * @param {number} [dataType]\n     * @return {string} tooltip string\n     */\n    formatTooltip: function () {\n        // Empty function\n    }\n};\n\n/**\n * @param {Object} define\n * @return See the return of `createTask`.\n */\nfunction createTask(define) {\n    return new Task(define);\n}\n\n/**\n * @constructor\n * @param {Object} define\n * @param {Function} define.reset Custom reset\n * @param {Function} [define.plan] Returns 'reset' indicate reset immediately.\n * @param {Function} [define.count] count is used to determin data task.\n * @param {Function} [define.onDirty] count is used to determin data task.\n */\nfunction Task(define) {\n    define = define || {};\n\n    this._reset = define.reset;\n    this._plan = define.plan;\n    this._count = define.count;\n    this._onDirty = define.onDirty;\n\n    this._dirty = true;\n\n    // Context must be specified implicitly, to\n    // avoid miss update context when model changed.\n    this.context;\n}\n\nvar taskProto = Task.prototype;\n\n/**\n * @param {Object} performArgs\n * @param {number} [performArgs.step] Specified step.\n * @param {number} [performArgs.skip] Skip customer perform call.\n */\ntaskProto.perform = function (performArgs) {\n    var upTask = this._upstream;\n    var skip = performArgs && performArgs.skip;\n\n    // TODO some refactor.\n    // Pull data. Must pull data each time, because context.data\n    // may be updated by Series.setData.\n    if (this._dirty && upTask) {\n        var context = this.context;\n        context.data = context.outputData = upTask.context.outputData;\n    }\n\n    if (this.__pipeline) {\n        this.__pipeline.currentTask = this;\n    }\n\n    var planResult;\n    if (this._plan && !skip) {\n        planResult = this._plan(this.context);\n    }\n\n    var forceFirstProgress;\n    if (this._dirty || planResult === 'reset') {\n        this._dirty = false;\n        forceFirstProgress = reset(this, skip);\n    }\n\n    var step = performArgs && performArgs.step;\n\n    if (upTask) {\n\n        if (__DEV__) {\n            assert$1(upTask._outputDueEnd != null);\n        }\n        // ??? FIXME move to schedueler?\n        // this._dueEnd = Math.max(upTask._outputDueEnd, this._dueEnd);\n        this._dueEnd = upTask._outputDueEnd;\n    }\n    // DataTask or overallTask\n    else {\n        if (__DEV__) {\n            assert$1(!this._progress || this._count);\n        }\n        this._dueEnd = this._count ? this._count(this.context) : Infinity;\n    }\n\n    // Note: Stubs, that its host overall task let it has progress, has progress.\n    // If no progress, pass index from upstream to downstream each time plan called.\n    if (this._progress) {\n        var start = this._dueIndex;\n        var end = Math.min(\n            step != null ? this._dueIndex + step : Infinity,\n            this._dueEnd\n        );\n\n        !skip && (forceFirstProgress || start < end) && (\n            this._progress({start: start, end: end}, this.context)\n        );\n\n        this._dueIndex = end;\n        // If no `outputDueEnd`, assume that output data and\n        // input data is the same, so use `dueIndex` as `outputDueEnd`.\n        var outputDueEnd = this._settedOutputEnd != null\n            ? this._settedOutputEnd : end;\n\n        if (__DEV__) {\n            // ??? Can not rollback.\n            assert$1(outputDueEnd >= this._outputDueEnd);\n        }\n\n        this._outputDueEnd = outputDueEnd;\n    }\n    else {\n        // (1) Some overall task has no progress.\n        // (2) Stubs, that its host overall task do not let it has progress, has no progress.\n        // This should always be performed so it can be passed to downstream.\n        this._dueIndex = this._outputDueEnd = this._settedOutputEnd != null\n            ? this._settedOutputEnd : this._dueEnd;\n    }\n\n    return this.unfinished();\n};\n\ntaskProto.dirty = function () {\n    this._dirty = true;\n    this._onDirty && this._onDirty(this.context);\n};\n\n/**\n * @param {Object} [params]\n */\nfunction reset(taskIns, skip) {\n    taskIns._dueIndex = taskIns._outputDueEnd = taskIns._dueEnd = 0;\n    taskIns._settedOutputEnd = null;\n\n    var progress;\n    var forceFirstProgress;\n\n    if (!skip && taskIns._reset) {\n        progress = taskIns._reset(taskIns.context);\n        if (progress && progress.progress) {\n            forceFirstProgress = progress.forceFirstProgress;\n            progress = progress.progress;\n        }\n    }\n\n    taskIns._progress = progress;\n\n    var downstream = taskIns._downstream;\n    downstream && downstream.dirty();\n\n    return forceFirstProgress;\n}\n\n/**\n * @return {boolean}\n */\ntaskProto.unfinished = function () {\n    return this._progress && this._dueIndex < this._dueEnd;\n};\n\n/**\n * @param {Object} downTask The downstream task.\n * @return {Object} The downstream task.\n */\ntaskProto.pipe = function (downTask) {\n    if (__DEV__) {\n        assert$1(downTask && !downTask._disposed && downTask !== this);\n    }\n\n    // If already downstream, do not dirty downTask.\n    if (this._downstream !== downTask || this._dirty) {\n        this._downstream = downTask;\n        downTask._upstream = this;\n        downTask.dirty();\n    }\n};\n\ntaskProto.dispose = function () {\n    if (this._disposed) {\n        return;\n    }\n\n    this._upstream && (this._upstream._downstream = null);\n    this._downstream && (this._downstream._upstream = null);\n\n    this._dirty = false;\n    this._disposed = true;\n};\n\ntaskProto.getUpstream = function () {\n    return this._upstream;\n};\n\ntaskProto.getDownstream = function () {\n    return this._downstream;\n};\n\ntaskProto.setOutputEnd = function (end) {\n    // ??? FIXME: check\n    // This only happend in dataTask, dataZoom, map, currently.\n    // where dataZoom do not set end each time, but only set\n    // when reset. So we should record the setted end, in case\n    // that the stub of dataZoom perform again and earse the\n    // setted end by upstream.\n    this._outputDueEnd = this._settedOutputEnd = end;\n    // this._outputDueEnd = end;\n};\n\n\n///////////////////////////////////////////////////////////\n// For stream debug (Should be commented out after used!)\n// Usage: printTask(this, 'begin');\n// Usage: printTask(this, null, {someExtraProp});\n// function printTask(task, prefix, extra) {\n//     window.ecTaskUID == null && (window.ecTaskUID = 0);\n//     task.uidDebug == null && (task.uidDebug = `task_${window.ecTaskUID++}`);\n//     task.agent && task.agent.uidDebug == null && (task.agent.uidDebug = `task_${window.ecTaskUID++}`);\n//     var props = [];\n//     if (task.__pipeline) {\n//         var val = `${task.__idxInPipeline}/${task.__pipeline.tail.__idxInPipeline} ${task.agent ? '(stub)' : ''}`;\n//         props.push({text: 'idx', value: val});\n//     } else {\n//         var stubCount = 0;\n//         task.agentStubMap.each(() => stubCount++);\n//         props.push({text: 'idx', value: `overall (stubs: ${stubCount})`});\n//     }\n//     props.push({text: 'uid', value: task.uidDebug});\n//     if (task.__pipeline) {\n//         props.push({text: 'pid', value: task.__pipeline.id});\n//         task.agent && props.push(\n//             {text: 'stubFor', value: task.agent.uidDebug}\n//         );\n//     }\n//     props.push(\n//         {text: 'dirty', value: task._dirty},\n//         {text: 'dueIndex', value: task._dueIndex},\n//         {text: 'dueEnd', value: task._dueEnd},\n//         {text: 'outputDueEnd', value: task._outputDueEnd}\n//     );\n//     if (extra) {\n//         Object.keys(extra).forEach(key => {\n//             props.push({text: key, value: extra[key]});\n//         });\n//     }\n//     var args = ['color: blue'];\n//     var msg = `%c[${prefix || 'T'}] %c` + props.map(item => (\n//         args.push('color: black', 'color: red'),\n//         `${item.text}: %c${item.value}`\n//     )).join('%c, ');\n//     console.log.apply(console, [msg].concat(args));\n//     // console.log(this);\n// }\n\nvar inner$4 = makeInner();\n\nvar SeriesModel = ComponentModel.extend({\n\n    type: 'series.__base__',\n\n    /**\n     * @readOnly\n     */\n    seriesIndex: 0,\n\n    // coodinateSystem will be injected in the echarts/CoordinateSystem\n    coordinateSystem: null,\n\n    /**\n     * @type {Object}\n     * @protected\n     */\n    defaultOption: null,\n\n    /**\n     * Data provided for legend\n     * @type {Function}\n     */\n    // PENDING\n    legendDataProvider: null,\n\n    /**\n     * Access path of color for visual\n     */\n    visualColorAccessPath: 'itemStyle.color',\n\n    /**\n     * Support merge layout params.\n     * Only support 'box' now (left/right/top/bottom/width/height).\n     * @type {string|Object} Object can be {ignoreSize: true}\n     * @readOnly\n     */\n    layoutMode: null,\n\n    init: function (option, parentModel, ecModel, extraOpt) {\n\n        /**\n         * @type {number}\n         * @readOnly\n         */\n        this.seriesIndex = this.componentIndex;\n\n        this.dataTask = createTask({\n            count: dataTaskCount,\n            reset: dataTaskReset\n        });\n        this.dataTask.context = {model: this};\n\n        this.mergeDefaultAndTheme(option, ecModel);\n\n        prepareSource(this);\n\n\n        var data = this.getInitialData(option, ecModel);\n        wrapData(data, this);\n        this.dataTask.context.data = data;\n\n        if (__DEV__) {\n            assert$1(data, 'getInitialData returned invalid data.');\n        }\n\n        /**\n         * @type {module:echarts/data/List|module:echarts/data/Tree|module:echarts/data/Graph}\n         * @private\n         */\n        inner$4(this).dataBeforeProcessed = data;\n\n        // If we reverse the order (make data firstly, and then make\n        // dataBeforeProcessed by cloneShallow), cloneShallow will\n        // cause data.graph.data !== data when using\n        // module:echarts/data/Graph or module:echarts/data/Tree.\n        // See module:echarts/data/helper/linkList\n\n        // Theoretically, it is unreasonable to call `seriesModel.getData()` in the model\n        // init or merge stage, because the data can be restored. So we do not `restoreData`\n        // and `setData` here, which forbids calling `seriesModel.getData()` in this stage.\n        // Call `seriesModel.getRawData()` instead.\n        // this.restoreData();\n\n        autoSeriesName(this);\n    },\n\n    /**\n     * Util for merge default and theme to option\n     * @param  {Object} option\n     * @param  {module:echarts/model/Global} ecModel\n     */\n    mergeDefaultAndTheme: function (option, ecModel) {\n        var layoutMode = this.layoutMode;\n        var inputPositionParams = layoutMode\n            ? getLayoutParams(option) : {};\n\n        // Backward compat: using subType on theme.\n        // But if name duplicate between series subType\n        // (for example: parallel) add component mainType,\n        // add suffix 'Series'.\n        var themeSubType = this.subType;\n        if (ComponentModel.hasClass(themeSubType)) {\n            themeSubType += 'Series';\n        }\n        merge(\n            option,\n            ecModel.getTheme().get(this.subType)\n        );\n        merge(option, this.getDefaultOption());\n\n        // Default label emphasis `show`\n        defaultEmphasis(option, 'label', ['show']);\n\n        this.fillDataTextStyle(option.data);\n\n        if (layoutMode) {\n            mergeLayoutParam(option, inputPositionParams, layoutMode);\n        }\n    },\n\n    mergeOption: function (newSeriesOption, ecModel) {\n        // this.settingTask.dirty();\n\n        newSeriesOption = merge(this.option, newSeriesOption, true);\n        this.fillDataTextStyle(newSeriesOption.data);\n\n        var layoutMode = this.layoutMode;\n        if (layoutMode) {\n            mergeLayoutParam(this.option, newSeriesOption, layoutMode);\n        }\n\n        prepareSource(this);\n\n        var data = this.getInitialData(newSeriesOption, ecModel);\n        wrapData(data, this);\n        this.dataTask.dirty();\n        this.dataTask.context.data = data;\n\n        inner$4(this).dataBeforeProcessed = data;\n\n        autoSeriesName(this);\n    },\n\n    fillDataTextStyle: function (data) {\n        // Default data label emphasis `show`\n        // FIXME Tree structure data ?\n        // FIXME Performance ?\n        if (data) {\n            var props = ['show'];\n            for (var i = 0; i < data.length; i++) {\n                if (data[i] && data[i].label) {\n                    defaultEmphasis(data[i], 'label', props);\n                }\n            }\n        }\n    },\n\n    /**\n     * Init a data structure from data related option in series\n     * Must be overwritten\n     */\n    getInitialData: function () {},\n\n    /**\n     * Append data to list\n     * @param {Object} params\n     * @param {Array|TypedArray} params.data\n     */\n    appendData: function (params) {\n        // FIXME ???\n        // (1) If data from dataset, forbidden append.\n        // (2) support append data of dataset.\n        var data = this.getRawData();\n        data.appendData(params.data);\n    },\n\n    /**\n     * Consider some method like `filter`, `map` need make new data,\n     * We should make sure that `seriesModel.getData()` get correct\n     * data in the stream procedure. So we fetch data from upstream\n     * each time `task.perform` called.\n     * @param {string} [dataType]\n     * @return {module:echarts/data/List}\n     */\n    getData: function (dataType) {\n        var task = getCurrentTask(this);\n        if (task) {\n            var data = task.context.data;\n            return dataType == null ? data : data.getLinkedData(dataType);\n        }\n        else {\n            // When series is not alive (that may happen when click toolbox\n            // restore or setOption with not merge mode), series data may\n            // be still need to judge animation or something when graphic\n            // elements want to know whether fade out.\n            return inner$4(this).data;\n        }\n    },\n\n    /**\n     * @param {module:echarts/data/List} data\n     */\n    setData: function (data) {\n        var task = getCurrentTask(this);\n        if (task) {\n            var context = task.context;\n            // Consider case: filter, data sample.\n            if (context.data !== data && task.isOverallFilter) {\n                task.setOutputEnd(data.count());\n            }\n            context.outputData = data;\n            // Caution: setData should update context.data,\n            // Because getData may be called multiply in a\n            // single stage and expect to get the data just\n            // set. (For example, AxisProxy, x y both call\n            // getData and setDate sequentially).\n            // So the context.data should be fetched from\n            // upstream each time when a stage starts to be\n            // performed.\n            if (task !== this.dataTask) {\n                context.data = data;\n            }\n        }\n        inner$4(this).data = data;\n    },\n\n    /**\n     * @see {module:echarts/data/helper/sourceHelper#getSource}\n     * @return {module:echarts/data/Source} source\n     */\n    getSource: function () {\n        return getSource(this);\n    },\n\n    /**\n     * Get data before processed\n     * @return {module:echarts/data/List}\n     */\n    getRawData: function () {\n        return inner$4(this).dataBeforeProcessed;\n    },\n\n    /**\n     * Get base axis if has coordinate system and has axis.\n     * By default use coordSys.getBaseAxis();\n     * Can be overrided for some chart.\n     * @return {type} description\n     */\n    getBaseAxis: function () {\n        var coordSys = this.coordinateSystem;\n        return coordSys && coordSys.getBaseAxis && coordSys.getBaseAxis();\n    },\n\n    // FIXME\n    /**\n     * Default tooltip formatter\n     *\n     * @param {number} dataIndex\n     * @param {boolean} [multipleSeries=false]\n     * @param {number} [dataType]\n     */\n    formatTooltip: function (dataIndex, multipleSeries, dataType) {\n\n        function formatArrayValue(value) {\n            // ??? TODO refactor these logic.\n            // check: category-no-encode-has-axis-data in dataset.html\n            var vertially = reduce(value, function (vertially, val, idx) {\n                var dimItem = data.getDimensionInfo(idx);\n                return vertially |= dimItem && dimItem.tooltip !== false && dimItem.displayName != null;\n            }, 0);\n\n            var result = [];\n\n            tooltipDims.length\n                ? each$1(tooltipDims, function (dim) {\n                    setEachItem(retrieveRawValue(data, dataIndex, dim), dim);\n                })\n                // By default, all dims is used on tooltip.\n                : each$1(value, setEachItem);\n\n            function setEachItem(val, dim) {\n                var dimInfo = data.getDimensionInfo(dim);\n                // If `dimInfo.tooltip` is not set, show tooltip.\n                if (!dimInfo || dimInfo.otherDims.tooltip === false) {\n                    return;\n                }\n                var dimType = dimInfo.type;\n                var dimHead = getTooltipMarker({color: color, type: 'subItem'});\n                var valStr = (vertially\n                        ? dimHead + encodeHTML(dimInfo.displayName || '-') + ': '\n                        : ''\n                    )\n                    // FIXME should not format time for raw data?\n                    + encodeHTML(dimType === 'ordinal'\n                        ? val + ''\n                        : dimType === 'time'\n                        ? (multipleSeries ? '' : formatTime('yyyy/MM/dd hh:mm:ss', val))\n                        : addCommas(val)\n                    );\n                valStr && result.push(valStr);\n            }\n\n            return (vertially ? '<br/>' : '') + result.join(vertially ? '<br/>' : ', ');\n        }\n\n        function formatSingleValue(val) {\n            return encodeHTML(addCommas(val));\n        }\n\n        var data = this.getData();\n        var tooltipDims = data.mapDimension('defaultedTooltip', true);\n        var tooltipDimLen = tooltipDims.length;\n        var value = this.getRawValue(dataIndex);\n        var isValueArr = isArray(value);\n\n        var color = data.getItemVisual(dataIndex, 'color');\n        if (isObject$1(color) && color.colorStops) {\n            color = (color.colorStops[0] || {}).color;\n        }\n        color = color || 'transparent';\n\n        // Complicated rule for pretty tooltip.\n        var formattedValue = (tooltipDimLen > 1 || (isValueArr && !tooltipDimLen))\n            ? formatArrayValue(value)\n            : tooltipDimLen\n            ? formatSingleValue(retrieveRawValue(data, dataIndex, tooltipDims[0]))\n            : formatSingleValue(isValueArr ? value[0] : value);\n\n        var colorEl = getTooltipMarker(color);\n\n        var name = data.getName(dataIndex);\n\n        var seriesName = this.name;\n        if (!isNameSpecified(this)) {\n            seriesName = '';\n        }\n        seriesName = seriesName\n            ? encodeHTML(seriesName) + (!multipleSeries ? '<br/>' : ': ')\n            : '';\n\n        return !multipleSeries\n            ? seriesName + colorEl\n                + (name\n                    ? encodeHTML(name) + ': ' + formattedValue\n                    : formattedValue\n                )\n            : colorEl + seriesName + formattedValue;\n    },\n\n    /**\n     * @return {boolean}\n     */\n    isAnimationEnabled: function () {\n        if (env$1.node) {\n            return false;\n        }\n\n        var animationEnabled = this.getShallow('animation');\n        if (animationEnabled) {\n            if (this.getData().count() > this.getShallow('animationThreshold')) {\n                animationEnabled = false;\n            }\n        }\n        return animationEnabled;\n    },\n\n    restoreData: function () {\n        this.dataTask.dirty();\n    },\n\n    getColorFromPalette: function (name, scope, requestColorNum) {\n        var ecModel = this.ecModel;\n        // PENDING\n        var color = colorPaletteMixin.getColorFromPalette.call(this, name, scope, requestColorNum);\n        if (!color) {\n            color = ecModel.getColorFromPalette(name, scope, requestColorNum);\n        }\n        return color;\n    },\n\n    /**\n     * Use `data.mapDimension(coordDim, true)` instead.\n     * @deprecated\n     */\n    coordDimToDataDim: function (coordDim) {\n        return this.getRawData().mapDimension(coordDim, true);\n    },\n\n    /**\n     * Get progressive rendering count each step\n     * @return {number}\n     */\n    getProgressive: function () {\n        return this.get('progressive');\n    },\n\n    /**\n     * Get progressive rendering count each step\n     * @return {number}\n     */\n    getProgressiveThreshold: function () {\n        return this.get('progressiveThreshold');\n    },\n\n    /**\n     * Get data indices for show tooltip content. See tooltip.\n     * @abstract\n     * @param {Array.<string>|string} dim\n     * @param {Array.<number>} value\n     * @param {module:echarts/coord/single/SingleAxis} baseAxis\n     * @return {Object} {dataIndices, nestestValue}.\n     */\n    getAxisTooltipData: null,\n\n    /**\n     * See tooltip.\n     * @abstract\n     * @param {number} dataIndex\n     * @return {Array.<number>} Point of tooltip. null/undefined can be returned.\n     */\n    getTooltipPosition: null,\n\n    /**\n     * @see {module:echarts/stream/Scheduler}\n     */\n    pipeTask: null,\n\n    /**\n     * Convinient for override in extended class.\n     * @protected\n     * @type {Function}\n     */\n    preventIncremental: null,\n\n    /**\n     * @public\n     * @readOnly\n     * @type {Object}\n     */\n    pipelineContext: null\n\n});\n\n\nmixin(SeriesModel, dataFormatMixin);\nmixin(SeriesModel, colorPaletteMixin);\n\n/**\n * MUST be called after `prepareSource` called\n * Here we need to make auto series, especially for auto legend. But we\n * do not modify series.name in option to avoid side effects.\n */\nfunction autoSeriesName(seriesModel) {\n    // User specified name has higher priority, otherwise it may cause\n    // series can not be queried unexpectedly.\n    var name = seriesModel.name;\n    if (!isNameSpecified(seriesModel)) {\n        seriesModel.name = getSeriesAutoName(seriesModel) || name;\n    }\n}\n\nfunction getSeriesAutoName(seriesModel) {\n    var data = seriesModel.getRawData();\n    var dataDims = data.mapDimension('seriesName', true);\n    var nameArr = [];\n    each$1(dataDims, function (dataDim) {\n        var dimInfo = data.getDimensionInfo(dataDim);\n        dimInfo.displayName && nameArr.push(dimInfo.displayName);\n    });\n    return nameArr.join(' ');\n}\n\nfunction dataTaskCount(context) {\n    return context.model.getRawData().count();\n}\n\nfunction dataTaskReset(context) {\n    var seriesModel = context.model;\n    seriesModel.setData(seriesModel.getRawData().cloneShallow());\n    return dataTaskProgress;\n}\n\nfunction dataTaskProgress(param, context) {\n    // Avoid repead cloneShallow when data just created in reset.\n    if (param.end > context.outputData.count()) {\n        context.model.getRawData().cloneShallow(context.outputData);\n    }\n}\n\n// TODO refactor\nfunction wrapData(data, seriesModel) {\n    each$1(data.CHANGABLE_METHODS, function (methodName) {\n        data.wrapMethod(methodName, curry(onDataSelfChange, seriesModel));\n    });\n}\n\nfunction onDataSelfChange(seriesModel) {\n    var task = getCurrentTask(seriesModel);\n    if (task) {\n        // Consider case: filter, selectRange\n        task.setOutputEnd(this.count());\n    }\n}\n\nfunction getCurrentTask(seriesModel) {\n    var scheduler = (seriesModel.ecModel || {}).scheduler;\n    var pipeline = scheduler && scheduler.getPipeline(seriesModel.uid);\n\n    if (pipeline) {\n        // When pipline finished, the currrentTask keep the last\n        // task (renderTask).\n        var task = pipeline.currentTask;\n        if (task) {\n            var agentStubMap = task.agentStubMap;\n            if (agentStubMap) {\n                task = agentStubMap.get(seriesModel.uid);\n            }\n        }\n        return task;\n    }\n}\n\nvar Component = function () {\n    /**\n     * @type {module:zrender/container/Group}\n     * @readOnly\n     */\n    this.group = new Group();\n\n    /**\n     * @type {string}\n     * @readOnly\n     */\n    this.uid = getUID('viewComponent');\n};\n\nComponent.prototype = {\n\n    constructor: Component,\n\n    init: function (ecModel, api) {},\n\n    render: function (componentModel, ecModel, api, payload) {},\n\n    dispose: function () {}\n\n};\n\nvar componentProto = Component.prototype;\ncomponentProto.updateView\n    = componentProto.updateLayout\n    = componentProto.updateVisual\n    = function (seriesModel, ecModel, api, payload) {\n        // Do nothing;\n    };\n// Enable Component.extend.\nenableClassExtend(Component);\n\n// Enable capability of registerClass, getClass, hasClass, registerSubTypeDefaulter and so on.\nenableClassManagement(Component, {registerWhenExtend: true});\n\n/**\n * @return {string} If large mode changed, return string 'reset';\n */\nvar createRenderPlanner = function () {\n    var inner = makeInner();\n\n    return function (seriesModel) {\n        var fields = inner(seriesModel);\n        var pipelineContext = seriesModel.pipelineContext;\n\n        var originalLarge = fields.large;\n        var originalProgressive = fields.canProgressiveRender;\n\n        var large = fields.large = pipelineContext.large;\n        var progressive = fields.canProgressiveRender = pipelineContext.canProgressiveRender;\n\n        return !!((originalLarge ^ large) || (originalProgressive ^ progressive)) && 'reset';\n    };\n};\n\nvar inner$5 = makeInner();\nvar renderPlanner = createRenderPlanner();\n\nfunction Chart() {\n\n    /**\n     * @type {module:zrender/container/Group}\n     * @readOnly\n     */\n    this.group = new Group();\n\n    /**\n     * @type {string}\n     * @readOnly\n     */\n    this.uid = getUID('viewChart');\n\n    this.renderTask = createTask({\n        plan: renderTaskPlan,\n        reset: renderTaskReset\n    });\n    this.renderTask.context = {view: this};\n}\n\nChart.prototype = {\n\n    type: 'chart',\n\n    /**\n     * Init the chart.\n     * @param  {module:echarts/model/Global} ecModel\n     * @param  {module:echarts/ExtensionAPI} api\n     */\n    init: function (ecModel, api) {},\n\n    /**\n     * Render the chart.\n     * @param  {module:echarts/model/Series} seriesModel\n     * @param  {module:echarts/model/Global} ecModel\n     * @param  {module:echarts/ExtensionAPI} api\n     * @param  {Object} payload\n     */\n    render: function (seriesModel, ecModel, api, payload) {},\n\n    /**\n     * Highlight series or specified data item.\n     * @param  {module:echarts/model/Series} seriesModel\n     * @param  {module:echarts/model/Global} ecModel\n     * @param  {module:echarts/ExtensionAPI} api\n     * @param  {Object} payload\n     */\n    highlight: function (seriesModel, ecModel, api, payload) {\n        toggleHighlight(seriesModel.getData(), payload, 'emphasis');\n    },\n\n    /**\n     * Downplay series or specified data item.\n     * @param  {module:echarts/model/Series} seriesModel\n     * @param  {module:echarts/model/Global} ecModel\n     * @param  {module:echarts/ExtensionAPI} api\n     * @param  {Object} payload\n     */\n    downplay: function (seriesModel, ecModel, api, payload) {\n        toggleHighlight(seriesModel.getData(), payload, 'normal');\n    },\n\n    /**\n     * Remove self.\n     * @param  {module:echarts/model/Global} ecModel\n     * @param  {module:echarts/ExtensionAPI} api\n     */\n    remove: function (ecModel, api) {\n        this.group.removeAll();\n    },\n\n    /**\n     * Dispose self.\n     * @param  {module:echarts/model/Global} ecModel\n     * @param  {module:echarts/ExtensionAPI} api\n     */\n    dispose: function () {},\n\n    /**\n     * Rendering preparation in progressive mode.\n     * @param  {module:echarts/model/Series} seriesModel\n     * @param  {module:echarts/model/Global} ecModel\n     * @param  {module:echarts/ExtensionAPI} api\n     * @param  {Object} payload\n     */\n    incrementalPrepareRender: null,\n\n    /**\n     * Render in progressive mode.\n     * @param  {module:echarts/model/Series} seriesModel\n     * @param  {module:echarts/model/Global} ecModel\n     * @param  {module:echarts/ExtensionAPI} api\n     * @param  {Object} payload\n     */\n    incrementalRender: null,\n\n    /**\n     * Update transform directly.\n     * @param  {module:echarts/model/Series} seriesModel\n     * @param  {module:echarts/model/Global} ecModel\n     * @param  {module:echarts/ExtensionAPI} api\n     * @param  {Object} payload\n     * @return {Object} {update: true}\n     */\n    updateTransform: null\n\n    /**\n     * The view contains the given point.\n     * @interface\n     * @param {Array.<number>} point\n     * @return {boolean}\n     */\n    // containPoint: function () {}\n\n};\n\nvar chartProto = Chart.prototype;\nchartProto.updateView\n    = chartProto.updateLayout\n    = chartProto.updateVisual\n    = function (seriesModel, ecModel, api, payload) {\n        this.render(seriesModel, ecModel, api, payload);\n    };\n\n/**\n * Set state of single element\n * @param  {module:zrender/Element} el\n * @param  {string} state\n */\nfunction elSetState(el, state) {\n    if (el) {\n        el.trigger(state);\n        if (el.type === 'group') {\n            for (var i = 0; i < el.childCount(); i++) {\n                elSetState(el.childAt(i), state);\n            }\n        }\n    }\n}\n/**\n * @param  {module:echarts/data/List} data\n * @param  {Object} payload\n * @param  {string} state 'normal'|'emphasis'\n */\nfunction toggleHighlight(data, payload, state) {\n    var dataIndex = queryDataIndex(data, payload);\n\n    if (dataIndex != null) {\n        each$1(normalizeToArray(dataIndex), function (dataIdx) {\n            elSetState(data.getItemGraphicEl(dataIdx), state);\n        });\n    }\n    else {\n        data.eachItemGraphicEl(function (el) {\n            elSetState(el, state);\n        });\n    }\n}\n\n// Enable Chart.extend.\nenableClassExtend(Chart, ['dispose']);\n\n// Add capability of registerClass, getClass, hasClass, registerSubTypeDefaulter and so on.\nenableClassManagement(Chart, {registerWhenExtend: true});\n\nChart.markUpdateMethod = function (payload, methodName) {\n    inner$5(payload).updateMethod = methodName;\n};\n\nfunction renderTaskPlan(context) {\n    return renderPlanner(context.model);\n}\n\nfunction renderTaskReset(context) {\n    var seriesModel = context.model;\n    var ecModel = context.ecModel;\n    var api = context.api;\n    var payload = context.payload;\n    // ???! remove updateView updateVisual\n    var canProgressiveRender = seriesModel.pipelineContext.canProgressiveRender;\n    var view = context.view;\n\n    var updateMethod = payload && inner$5(payload).updateMethod;\n    var methodName = canProgressiveRender\n        ? 'incrementalPrepareRender'\n        : (updateMethod && view[updateMethod])\n        ? updateMethod\n        // `appendData` is also supported when data amount\n        // is less than progressive threshold.\n        : 'render';\n\n    if (methodName !== 'render') {\n        view[methodName](seriesModel, ecModel, api, payload);\n    }\n\n    return progressMethodMap[methodName];\n}\n\nvar progressMethodMap = {\n    incrementalPrepareRender: {\n        progress: function (params, context) {\n            context.view.incrementalRender(\n                params, context.model, context.ecModel, context.api, context.payload\n            );\n        }\n    },\n    render: {\n        // Put view.render in `progress` to support appendData. But in this case\n        // view.render should not be called in reset, otherwise it will be called\n        // twise. Use `forceFirstProgress` to make sure that view.render is called\n        // in any cases.\n        forceFirstProgress: true,\n        progress: function (params, context) {\n            context.view.render(\n                context.model, context.ecModel, context.api, context.payload\n            );\n        }\n    }\n};\n\nvar ORIGIN_METHOD = '\\0__throttleOriginMethod';\nvar RATE = '\\0__throttleRate';\nvar THROTTLE_TYPE = '\\0__throttleType';\n\n/**\n * @public\n * @param {(Function)} fn\n * @param {number} [delay=0] Unit: ms.\n * @param {boolean} [debounce=false]\n *        true: If call interval less than `delay`, only the last call works.\n *        false: If call interval less than `delay, call works on fixed rate.\n * @return {(Function)} throttled fn.\n */\nfunction throttle(fn, delay, debounce) {\n\n    var currCall;\n    var lastCall = 0;\n    var lastExec = 0;\n    var timer = null;\n    var diff;\n    var scope;\n    var args;\n    var debounceNextCall;\n\n    delay = delay || 0;\n\n    function exec() {\n        lastExec = (new Date()).getTime();\n        timer = null;\n        fn.apply(scope, args || []);\n    }\n\n    var cb = function () {\n        currCall = (new Date()).getTime();\n        scope = this;\n        args = arguments;\n        var thisDelay = debounceNextCall || delay;\n        var thisDebounce = debounceNextCall || debounce;\n        debounceNextCall = null;\n        diff = currCall - (thisDebounce ? lastCall : lastExec) - thisDelay;\n\n        clearTimeout(timer);\n\n        if (thisDebounce) {\n            timer = setTimeout(exec, thisDelay);\n        }\n        else {\n            if (diff >= 0) {\n                exec();\n            }\n            else {\n                timer = setTimeout(exec, -diff);\n            }\n        }\n\n        lastCall = currCall;\n    };\n\n    /**\n     * Clear throttle.\n     * @public\n     */\n    cb.clear = function () {\n        if (timer) {\n            clearTimeout(timer);\n            timer = null;\n        }\n    };\n\n    /**\n     * Enable debounce once.\n     */\n    cb.debounceNextCall = function (debounceDelay) {\n        debounceNextCall = debounceDelay;\n    };\n\n    return cb;\n}\n\n/**\n * Create throttle method or update throttle rate.\n *\n * @example\n * ComponentView.prototype.render = function () {\n *     ...\n *     throttle.createOrUpdate(\n *         this,\n *         '_dispatchAction',\n *         this.model.get('throttle'),\n *         'fixRate'\n *     );\n * };\n * ComponentView.prototype.remove = function () {\n *     throttle.clear(this, '_dispatchAction');\n * };\n * ComponentView.prototype.dispose = function () {\n *     throttle.clear(this, '_dispatchAction');\n * };\n *\n * @public\n * @param {Object} obj\n * @param {string} fnAttr\n * @param {number} [rate]\n * @param {string} [throttleType='fixRate'] 'fixRate' or 'debounce'\n * @return {Function} throttled function.\n */\nfunction createOrUpdate(obj, fnAttr, rate, throttleType) {\n    var fn = obj[fnAttr];\n\n    if (!fn) {\n        return;\n    }\n\n    var originFn = fn[ORIGIN_METHOD] || fn;\n    var lastThrottleType = fn[THROTTLE_TYPE];\n    var lastRate = fn[RATE];\n\n    if (lastRate !== rate || lastThrottleType !== throttleType) {\n        if (rate == null || !throttleType) {\n            return (obj[fnAttr] = originFn);\n        }\n\n        fn = obj[fnAttr] = throttle(\n            originFn, rate, throttleType === 'debounce'\n        );\n        fn[ORIGIN_METHOD] = originFn;\n        fn[THROTTLE_TYPE] = throttleType;\n        fn[RATE] = rate;\n    }\n\n    return fn;\n}\n\n/**\n * Clear throttle. Example see throttle.createOrUpdate.\n *\n * @public\n * @param {Object} obj\n * @param {string} fnAttr\n */\nfunction clear(obj, fnAttr) {\n    var fn = obj[fnAttr];\n    if (fn && fn[ORIGIN_METHOD]) {\n        obj[fnAttr] = fn[ORIGIN_METHOD];\n    }\n}\n\nvar seriesColor = {\n    createOnAllSeries: true,\n    performRawSeries: true,\n    reset: function (seriesModel, ecModel) {\n        var data = seriesModel.getData();\n        var colorAccessPath = (seriesModel.visualColorAccessPath || 'itemStyle.color').split('.');\n        var color = seriesModel.get(colorAccessPath) // Set in itemStyle\n            || seriesModel.getColorFromPalette(\n                // TODO series count changed.\n                seriesModel.name, null, ecModel.getSeriesCount()\n            );  // Default color\n\n        // FIXME Set color function or use the platte color\n        data.setVisual('color', color);\n\n        // Only visible series has each data be visual encoded\n        if (!ecModel.isSeriesFiltered(seriesModel)) {\n            if (typeof color === 'function' && !(color instanceof Gradient)) {\n                data.each(function (idx) {\n                    data.setItemVisual(\n                        idx, 'color', color(seriesModel.getDataParams(idx))\n                    );\n                });\n            }\n\n            // itemStyle in each data item\n            var dataEach = function (data, idx) {\n                var itemModel = data.getItemModel(idx);\n                var color = itemModel.get(colorAccessPath, true);\n                if (color != null) {\n                    data.setItemVisual(idx, 'color', color);\n                }\n            };\n\n            return { dataEach: data.hasItemOption ? dataEach : null };\n        }\n    }\n};\n\nvar lang = {\n    toolbox: {\n        brush: {\n            title: {\n                rect: '',\n                polygon: '',\n                lineX: '',\n                lineY: '',\n                keep: '',\n                clear: ''\n            }\n        },\n        dataView: {\n            title: '',\n            lang: ['', '', '']\n        },\n        dataZoom: {\n            title: {\n                zoom: '',\n                back: ''\n            }\n        },\n        magicType: {\n            title: {\n                line: '',\n                bar: '',\n                stack: '',\n                tiled: ''\n            }\n        },\n        restore: {\n            title: ''\n        },\n        saveAsImage: {\n            title: '',\n            lang: ['']\n        }\n    },\n    series: {\n        typeNames: {\n            pie: '',\n            bar: '',\n            line: '',\n            scatter: '',\n            effectScatter: '',\n            radar: '',\n            tree: '',\n            treemap: '',\n            boxplot: '',\n            candlestick: 'K',\n            k: 'K',\n            heatmap: '',\n            map: '',\n            parallel: '',\n            lines: '',\n            graph: '',\n            sankey: '',\n            funnel: '',\n            gauge: '',\n            pictorialBar: '',\n            themeRiver: '',\n            sunburst: ''\n        }\n    },\n    aria: {\n        general: {\n            withTitle: '{title}',\n            withoutTitle: ''\n        },\n        series: {\n            single: {\n                prefix: '',\n                withName: '{seriesType}{seriesName}',\n                withoutName: '{seriesType}'\n            },\n            multiple: {\n                prefix: '{seriesCount}',\n                withName: '{seriesId}{seriesName}{seriesType}',\n                withoutName: '{seriesId}{seriesType}',\n                separator: {\n                    middle: '',\n                    end: ''\n                }\n            }\n        },\n        data: {\n            allData: '',\n            partialData: '{displayCnt}',\n            withName: '{name}{value}',\n            withoutName: '{value}',\n            separator: {\n                middle: '',\n                end: ''\n            }\n        }\n    }\n};\n\nvar aria = function (dom, ecModel) {\n    var ariaModel = ecModel.getModel('aria');\n    if (!ariaModel.get('show')) {\n        return;\n    }\n    else if (ariaModel.get('description')) {\n        dom.setAttribute('aria-label', ariaModel.get('description'));\n        return;\n    }\n\n    var seriesCnt = 0;\n    ecModel.eachSeries(function (seriesModel, idx) {\n        ++seriesCnt;\n    }, this);\n\n    var maxDataCnt = ariaModel.get('data.maxCount') || 10;\n    var maxSeriesCnt = ariaModel.get('series.maxCount') || 10;\n    var displaySeriesCnt = Math.min(seriesCnt, maxSeriesCnt);\n\n    var ariaLabel;\n    if (seriesCnt < 1) {\n        // No series, no aria label\n        return;\n    }\n    else {\n        var title = getTitle();\n        if (title) {\n            ariaLabel = replace(getConfig('general.withTitle'), {\n                title: title\n            });\n        }\n        else {\n            ariaLabel = getConfig('general.withoutTitle');\n        }\n\n        var seriesLabels = [];\n        var prefix = seriesCnt > 1\n            ? 'series.multiple.prefix'\n            : 'series.single.prefix';\n        ariaLabel += replace(getConfig(prefix), { seriesCount: seriesCnt });\n\n        ecModel.eachSeries(function (seriesModel, idx) {\n            if (idx < displaySeriesCnt) {\n                var seriesLabel;\n\n                var seriesName = seriesModel.get('name');\n                var seriesTpl = 'series.'\n                    + (seriesCnt > 1 ? 'multiple' : 'single') + '.';\n                seriesLabel = getConfig(seriesName\n                    ? seriesTpl + 'withName'\n                    : seriesTpl + 'withoutName');\n\n                seriesLabel = replace(seriesLabel, {\n                    seriesId: seriesModel.seriesIndex,\n                    seriesName: seriesModel.get('name'),\n                    seriesType: getSeriesTypeName(seriesModel.subType)\n                });\n\n                var data = seriesModel.getData();\n                window.data = data;\n                if (data.count() > maxDataCnt) {\n                    // Show part of data\n                    seriesLabel += replace(getConfig('data.partialData'), {\n                        displayCnt: maxDataCnt\n                    });\n                }\n                else {\n                    seriesLabel += getConfig('data.allData');\n                }\n\n                var dataLabels = [];\n                for (var i = 0; i < data.count(); i++) {\n                    if (i < maxDataCnt) {\n                        var name = data.getName(i);\n                        var value = retrieveRawValue(data, i);\n                        dataLabels.push(\n                            replace(\n                                name\n                                    ? getConfig('data.withName')\n                                    : getConfig('data.withoutName'),\n                                {\n                                    name: name,\n                                    value: value\n                                }\n                            )\n                        );\n                    }\n                }\n                seriesLabel += dataLabels\n                    .join(getConfig('data.separator.middle'))\n                    + getConfig('data.separator.end');\n\n                seriesLabels.push(seriesLabel);\n            }\n        });\n\n        ariaLabel += seriesLabels\n            .join(getConfig('series.multiple.separator.middle'))\n            + getConfig('series.multiple.separator.end');\n\n        dom.setAttribute('aria-label', ariaLabel);\n    }\n\n    function replace(str, keyValues) {\n        if (typeof str !== 'string') {\n            return str;\n        }\n\n        var result = str;\n        each$1(keyValues, function (value, key) {\n            result = result.replace(\n                new RegExp('\\\\{\\\\s*' + key + '\\\\s*\\\\}', 'g'),\n                value\n            );\n        });\n        return result;\n    }\n\n    function getConfig(path) {\n        var userConfig = ariaModel.get(path);\n        if (userConfig == null) {\n            var pathArr = path.split('.');\n            var result = lang.aria;\n            for (var i = 0; i < pathArr.length; ++i) {\n                result = result[pathArr[i]];\n            }\n            return result;\n        }\n        else {\n            return userConfig;\n        }\n    }\n\n    function getTitle() {\n        var title = ecModel.getModel('title').option;\n        if (title && title.length) {\n            title = title[0];\n        }\n        return title && title.text;\n    }\n\n    function getSeriesTypeName(type) {\n        return lang.series.typeNames[type] || '';\n    }\n};\n\nvar PI$1 = Math.PI;\n\n/**\n * @param {module:echarts/ExtensionAPI} api\n * @param {Object} [opts]\n * @param {string} [opts.text]\n * @param {string} [opts.color]\n * @param {string} [opts.textColor]\n * @return {module:zrender/Element}\n */\nvar loadingDefault = function (api, opts) {\n    opts = opts || {};\n    defaults(opts, {\n        text: 'loading',\n        color: '#c23531',\n        textColor: '#000',\n        maskColor: 'rgba(255, 255, 255, 0.8)',\n        zlevel: 0\n    });\n    var mask = new Rect({\n        style: {\n            fill: opts.maskColor\n        },\n        zlevel: opts.zlevel,\n        z: 10000\n    });\n    var arc = new Arc({\n        shape: {\n            startAngle: -PI$1 / 2,\n            endAngle: -PI$1 / 2 + 0.1,\n            r: 10\n        },\n        style: {\n            stroke: opts.color,\n            lineCap: 'round',\n            lineWidth: 5\n        },\n        zlevel: opts.zlevel,\n        z: 10001\n    });\n    var labelRect = new Rect({\n        style: {\n            fill: 'none',\n            text: opts.text,\n            textPosition: 'right',\n            textDistance: 10,\n            textFill: opts.textColor\n        },\n        zlevel: opts.zlevel,\n        z: 10001\n    });\n\n    arc.animateShape(true)\n        .when(1000, {\n            endAngle: PI$1 * 3 / 2\n        })\n        .start('circularInOut');\n    arc.animateShape(true)\n        .when(1000, {\n            startAngle: PI$1 * 3 / 2\n        })\n        .delay(300)\n        .start('circularInOut');\n\n    var group = new Group();\n    group.add(arc);\n    group.add(labelRect);\n    group.add(mask);\n    // Inject resize\n    group.resize = function () {\n        var cx = api.getWidth() / 2;\n        var cy = api.getHeight() / 2;\n        arc.setShape({\n            cx: cx,\n            cy: cy\n        });\n        var r = arc.shape.r;\n        labelRect.setShape({\n            x: cx - r,\n            y: cy - r,\n            width: r * 2,\n            height: r * 2\n        });\n\n        mask.setShape({\n            x: 0,\n            y: 0,\n            width: api.getWidth(),\n            height: api.getHeight()\n        });\n    };\n    group.resize();\n    return group;\n};\n\n/**\n * @module echarts/stream/Scheduler\n */\n\n/**\n * @constructor\n */\nfunction Scheduler(ecInstance, api, dataProcessorHandlers, visualHandlers) {\n    // this._pipelineMap = createHashMap();\n\n    this.ecInstance = ecInstance;\n    this.api = api;\n    this.unfinished;\n\n    // Fix current processors in case that in some rear cases that\n    // processors might be registered after echarts instance created.\n    // Register processors incrementally for a echarts instance is\n    // not supported by this stream architecture.\n    this._dataProcessorHandlers = dataProcessorHandlers.slice();\n    this._visualHandlers = visualHandlers.slice();\n\n    /**\n     * @private\n     * @type {\n     *     [handlerUID: string]: {\n     *         seriesTaskMap?: {\n     *             [seriesUID: string]: Task\n     *         },\n     *         overallTask?: Task\n     *     }\n     * }\n     */\n    this._stageTaskMap = createHashMap();\n}\n\nvar proto = Scheduler.prototype;\n\n// If seriesModel provided, incremental threshold is check by series data.\nproto.getPerformArgs = function (task, isBlock) {\n    // For overall task\n    if (!task.__pipeline) {\n        return;\n    }\n\n    var pipeline = this._pipelineMap.get(task.__pipeline.id);\n    var pCtx = pipeline.context;\n    var incremental = !isBlock\n        && pipeline.progressiveEnabled\n        && (!pCtx || pCtx.canProgressiveRender)\n        && task.__idxInPipeline > pipeline.bockIndex;\n\n    return {step: incremental ? pipeline.step : null};\n};\n\nproto.getPipeline = function (pipelineId) {\n    return this._pipelineMap.get(pipelineId);\n};\n\n/**\n * Current, progressive rendering starts from visual and layout.\n * Always detect render mode in the same stage, avoiding that incorrect\n * detection caused by data filtering.\n * Caution:\n * `updateStreamModes` use `seriesModel.getData()`.\n */\nproto.updateStreamModes = function (seriesModel, view) {\n    var pipeline = this._pipelineMap.get(seriesModel.uid);\n    var data = seriesModel.getData();\n    var dataLen = data.count();\n\n    // `canProgressiveRender` means that can render progressively in each\n    // animation frame. Note that some types of series do not provide\n    // `view.incrementalPrepareRender` but support `chart.appendData`. We\n    // use the term `incremental` but not `progressive` to describe the\n    // case that `chart.appendData`.\n    var canProgressiveRender = pipeline.progressiveEnabled\n        && view.incrementalPrepareRender\n        && dataLen >= pipeline.threshold;\n\n    var large = seriesModel.get('large') && dataLen >= seriesModel.get('largeThreshold');\n\n    seriesModel.pipelineContext = pipeline.context = {\n        canProgressiveRender: canProgressiveRender,\n        large: large\n    };\n};\n\nproto.restorePipelines = function (ecModel) {\n    var scheduler = this;\n    var pipelineMap = scheduler._pipelineMap = createHashMap();\n    ecModel.eachSeries(function (seriesModel) {\n        var progressive = seriesModel.getProgressive();\n        var pipelineId = seriesModel.uid;\n\n        pipelineMap.set(pipelineId, {\n            id: pipelineId,\n            head: null,\n            tail: null,\n            threshold: seriesModel.getProgressiveThreshold(),\n            progressiveEnabled: progressive\n                && !(seriesModel.preventIncremental && seriesModel.preventIncremental()),\n            bockIndex: -1,\n            step: progressive || 700, // ??? Temporarily number\n            count: 0\n        });\n\n        pipe(scheduler, seriesModel, seriesModel.dataTask);\n    });\n};\n\nproto.prepareStageTasks = function () {\n    var stageTaskMap = this._stageTaskMap;\n    var ecModel = this.ecInstance.getModel();\n    var api = this.api;\n\n    each$1([this._dataProcessorHandlers, this._visualHandlers], function (stageHandlers) {\n        each$1(stageHandlers, function (handler) {\n            var record = stageTaskMap.get(handler.uid) || stageTaskMap.set(handler.uid, []);\n\n            handler.reset && createSeriesStageTask(this, handler, record, ecModel, api);\n            handler.overallReset && createOverallStageTask(this, handler, record, ecModel, api);\n        }, this);\n    }, this);\n};\n\nproto.prepareView = function (view, model, ecModel, api) {\n    var renderTask = view.renderTask;\n    var context = renderTask.context;\n\n    context.model = model;\n    context.ecModel = ecModel;\n    context.api = api;\n\n    renderTask.__block = !view.incrementalPrepareRender;\n\n    pipe(this, model, renderTask);\n};\n\n\nproto.performDataProcessorTasks = function (ecModel, payload) {\n    // If we do not use `block` here, it should be considered when to update modes.\n    performStageTasks(this, this._dataProcessorHandlers, ecModel, payload, {block: true});\n};\n\n// opt\n// opt.visualType: 'visual' or 'layout'\n// opt.setDirty\nproto.performVisualTasks = function (ecModel, payload, opt) {\n    performStageTasks(this, this._visualHandlers, ecModel, payload, opt);\n};\n\nfunction performStageTasks(scheduler, stageHandlers, ecModel, payload, opt) {\n    opt = opt || {};\n    var unfinished;\n\n    each$1(stageHandlers, function (stageHandler, idx) {\n        if (opt.visualType && opt.visualType !== stageHandler.visualType) {\n            return;\n        }\n\n        var stageHandlerRecord = scheduler._stageTaskMap.get(stageHandler.uid);\n        var seriesTaskMap = stageHandlerRecord.seriesTaskMap;\n        var overallTask = stageHandlerRecord.overallTask;\n\n        if (overallTask) {\n            var overallNeedDirty;\n            var agentStubMap = overallTask.agentStubMap;\n            agentStubMap.each(function (stub) {\n                if (needSetDirty(opt, stub)) {\n                    stub.dirty();\n                    overallNeedDirty = true;\n                }\n            });\n            overallNeedDirty && overallTask.dirty();\n            updatePayload(overallTask, payload);\n            var performArgs = scheduler.getPerformArgs(overallTask, opt.block);\n            // Execute stubs firstly, which may set the overall task dirty,\n            // then execute the overall task. And stub will call seriesModel.setData,\n            // which ensures that in the overallTask seriesModel.getData() will not\n            // return incorrect data.\n            agentStubMap.each(function (stub) {\n                stub.perform(performArgs);\n            });\n            unfinished |= overallTask.perform(performArgs);\n        }\n        else if (seriesTaskMap) {\n            seriesTaskMap.each(function (task, pipelineId) {\n                if (needSetDirty(opt, task)) {\n                    task.dirty();\n                }\n                var performArgs = scheduler.getPerformArgs(task, opt.block);\n                performArgs.skip = !stageHandler.performRawSeries\n                    && ecModel.isSeriesFiltered(task.context.model);\n                updatePayload(task, payload);\n                unfinished |= task.perform(performArgs);\n            });\n        }\n    });\n\n    function needSetDirty(opt, task) {\n        return opt.setDirty && (!opt.dirtyMap || opt.dirtyMap.get(task.__pipeline.id));\n    }\n\n    scheduler.unfinished |= unfinished;\n}\n\nproto.performSeriesTasks = function (ecModel) {\n    var unfinished;\n\n    ecModel.eachSeries(function (seriesModel) {\n        // Progress to the end for dataInit and dataRestore.\n        unfinished |= seriesModel.dataTask.perform();\n    });\n\n    this.unfinished |= unfinished;\n};\n\nproto.plan = function () {\n    // Travel pipelines, check block.\n    this._pipelineMap.each(function (pipeline) {\n        var task = pipeline.tail;\n        do {\n            if (task.__block) {\n                pipeline.bockIndex = task.__idxInPipeline;\n                break;\n            }\n            task = task.getUpstream();\n        }\n        while (task);\n    });\n};\n\nvar updatePayload = proto.updatePayload = function (task, payload) {\n    payload !== 'remain' && (task.context.payload = payload);\n};\n\nfunction createSeriesStageTask(scheduler, stageHandler, stageHandlerRecord, ecModel, api) {\n    var seriesTaskMap = stageHandlerRecord.seriesTaskMap\n        || (stageHandlerRecord.seriesTaskMap = createHashMap());\n    var seriesType = stageHandler.seriesType;\n    var getTargetSeries = stageHandler.getTargetSeries;\n\n    // If a stageHandler should cover all series, `createOnAllSeries` should be declared mandatorily,\n    // to avoid some typo or abuse. Otherwise if an extension do not specify a `seriesType`,\n    // it works but it may cause other irrelevant charts blocked.\n    if (stageHandler.createOnAllSeries) {\n        ecModel.eachRawSeries(create);\n    }\n    else if (seriesType) {\n        ecModel.eachRawSeriesByType(seriesType, create);\n    }\n    else if (getTargetSeries) {\n        getTargetSeries(ecModel, api).each(create);\n    }\n\n    function create(seriesModel) {\n        var pipelineId = seriesModel.uid;\n\n        // Init tasks for each seriesModel only once.\n        // Reuse original task instance.\n        var task = seriesTaskMap.get(pipelineId)\n            || seriesTaskMap.set(pipelineId, createTask({\n                plan: seriesTaskPlan,\n                reset: seriesTaskReset,\n                count: seriesTaskCount\n            }));\n        task.context = {\n            model: seriesModel,\n            ecModel: ecModel,\n            api: api,\n            useClearVisual: stageHandler.isVisual && !stageHandler.isLayout,\n            plan: stageHandler.plan,\n            reset: stageHandler.reset,\n            scheduler: scheduler\n        };\n        pipe(scheduler, seriesModel, task);\n    }\n\n    // Clear unused series tasks.\n    var pipelineMap = scheduler._pipelineMap;\n    seriesTaskMap.each(function (task, pipelineId) {\n        if (!pipelineMap.get(pipelineId)) {\n            task.dispose();\n            seriesTaskMap.removeKey(pipelineId);\n        }\n    });\n}\n\nfunction createOverallStageTask(scheduler, stageHandler, stageHandlerRecord, ecModel, api) {\n    var overallTask = stageHandlerRecord.overallTask = stageHandlerRecord.overallTask\n        // For overall task, the function only be called on reset stage.\n        || createTask({reset: overallTaskReset});\n\n    overallTask.context = {\n        ecModel: ecModel,\n        api: api,\n        overallReset: stageHandler.overallReset,\n        scheduler: scheduler\n    };\n\n    // Reuse orignal stubs.\n    var agentStubMap = overallTask.agentStubMap = overallTask.agentStubMap || createHashMap();\n\n    var seriesType = stageHandler.seriesType;\n    var getTargetSeries = stageHandler.getTargetSeries;\n    var overallProgress = true;\n    var isOverallFilter = stageHandler.isOverallFilter;\n\n    // An overall task with seriesType detected or has `getTargetSeries`, we add\n    // stub in each pipelines, it will set the overall task dirty when the pipeline\n    // progress. Moreover, to avoid call the overall task each frame (too frequent),\n    // we set the pipeline block.\n    if (seriesType) {\n        ecModel.eachRawSeriesByType(seriesType, createStub);\n    }\n    else if (getTargetSeries) {\n        getTargetSeries(ecModel, api).each(createStub);\n    }\n    // Otherwise, (usually it is legancy case), the overall task will only be\n    // executed when upstream dirty. Otherwise the progressive rendering of all\n    // pipelines will be disabled unexpectedly. But it still needs stubs to receive\n    // dirty info from upsteam.\n    else {\n        overallProgress = false;\n        each$1(ecModel.getSeries(), createStub);\n    }\n\n    function createStub(seriesModel) {\n        var pipelineId = seriesModel.uid;\n        var stub = agentStubMap.get(pipelineId) || agentStubMap.set(pipelineId, createTask(\n            {reset: stubReset, onDirty: stubOnDirty}\n        ));\n        stub.context = {\n            model: seriesModel,\n            overallProgress: overallProgress,\n            isOverallFilter: isOverallFilter\n        };\n        stub.agent = overallTask;\n        stub.__block = overallProgress;\n\n        pipe(scheduler, seriesModel, stub);\n    }\n\n    // Clear unused stubs.\n    var pipelineMap = scheduler._pipelineMap;\n    agentStubMap.each(function (stub, pipelineId) {\n        if (!pipelineMap.get(pipelineId)) {\n            stub.dispose();\n            agentStubMap.removeKey(pipelineId);\n        }\n    });\n}\n\nfunction overallTaskReset(context) {\n    context.overallReset(\n        context.ecModel, context.api, context.payload\n    );\n}\n\nfunction stubReset(context, upstreamContext) {\n    return context.overallProgress && stubProgress;\n}\n\nfunction stubProgress() {\n    this.agent.dirty();\n    this.getDownstream().dirty();\n}\n\nfunction stubOnDirty() {\n    this.agent && this.agent.dirty();\n}\n\nfunction seriesTaskPlan(context) {\n    return context.plan && context.plan(\n        context.model, context.ecModel, context.api, context.payload\n    );\n}\n\nfunction seriesTaskReset(context) {\n    if (context.useClearVisual) {\n        context.data.clearAllVisual();\n    }\n    var resetDefines = context.resetDefines = normalizeToArray(context.reset(\n        context.model, context.ecModel, context.api, context.payload\n    ));\n    if (resetDefines.length) {\n        return seriesTaskProgress;\n    }\n}\n\nfunction seriesTaskProgress(params, context) {\n    var data = context.data;\n    var resetDefines = context.resetDefines;\n\n    for (var k = 0; k < resetDefines.length; k++) {\n        var resetDefine = resetDefines[k];\n        if (resetDefine && resetDefine.dataEach) {\n            for (var i = params.start; i < params.end; i++) {\n                resetDefine.dataEach(data, i);\n            }\n        }\n        else if (resetDefine && resetDefine.progress) {\n            resetDefine.progress(params, data);\n        }\n    }\n}\n\nfunction seriesTaskCount(context) {\n    return context.data.count();\n}\n\nfunction pipe(scheduler, seriesModel, task) {\n    var pipelineId = seriesModel.uid;\n    var pipeline = scheduler._pipelineMap.get(pipelineId);\n    !pipeline.head && (pipeline.head = task);\n    pipeline.tail && pipeline.tail.pipe(task);\n    pipeline.tail = task;\n    task.__idxInPipeline = pipeline.count++;\n    task.__pipeline = pipeline;\n}\n\nScheduler.wrapStageHandler = function (stageHandler, visualType) {\n    if (isFunction$1(stageHandler)) {\n        stageHandler = {\n            overallReset: stageHandler,\n            seriesType: detectSeriseType(stageHandler)\n        };\n    }\n\n    stageHandler.uid = getUID('stageHandler');\n    visualType && (stageHandler.visualType = visualType);\n\n    return stageHandler;\n};\n\n\n\n/**\n * Only some legacy stage handlers (usually in echarts extensions) are pure function.\n * To ensure that they can work normally, they should work in block mode, that is,\n * they should not be started util the previous tasks finished. So they cause the\n * progressive rendering disabled. We try to detect the series type, to narrow down\n * the block range to only the series type they concern, but not all series.\n */\nfunction detectSeriseType(legacyFunc) {\n    seriesType = null;\n    try {\n        // Assume there is no async when calling `eachSeriesByType`.\n        legacyFunc(ecModelMock, apiMock);\n    }\n    catch (e) {\n    }\n    return seriesType;\n}\n\nvar ecModelMock = {};\nvar apiMock = {};\nvar seriesType;\n\nmockMethods(ecModelMock, GlobalModel);\nmockMethods(apiMock, ExtensionAPI);\necModelMock.eachSeriesByType = ecModelMock.eachRawSeriesByType = function (type) {\n    seriesType = type;\n};\necModelMock.eachComponent = function (cond) {\n    if (cond.mainType === 'series' && cond.subType) {\n        seriesType = cond.subType;\n    }\n};\n\nfunction mockMethods(target, Clz) {\n    for (var name in Clz.prototype) {\n        // Do not use hasOwnProperty\n        target[name] = noop;\n    }\n}\n\nvar colorAll = ['#37A2DA', '#32C5E9', '#67E0E3', '#9FE6B8', '#FFDB5C','#ff9f7f', '#fb7293', '#E062AE', '#E690D1', '#e7bcf3', '#9d96f5', '#8378EA', '#96BFFF'];\n\nvar lightTheme = {\n\n    color: colorAll,\n\n    colorLayer: [\n        ['#37A2DA', '#ffd85c', '#fd7b5f'],\n        ['#37A2DA', '#67E0E3', '#FFDB5C', '#ff9f7f', '#E062AE', '#9d96f5'],\n        ['#37A2DA', '#32C5E9', '#9FE6B8', '#FFDB5C', '#ff9f7f', '#fb7293', '#e7bcf3', '#8378EA', '#96BFFF'],\n        colorAll\n    ]\n};\n\nvar contrastColor = '#eee';\nvar axisCommon = function () {\n    return {\n        axisLine: {\n            lineStyle: {\n                color: contrastColor\n            }\n        },\n        axisTick: {\n            lineStyle: {\n                color: contrastColor\n            }\n        },\n        axisLabel: {\n            textStyle: {\n                color: contrastColor\n            }\n        },\n        splitLine: {\n            lineStyle: {\n                type: 'dashed',\n                color: '#aaa'\n            }\n        },\n        splitArea: {\n            areaStyle: {\n                color: contrastColor\n            }\n        }\n    };\n};\n\nvar colorPalette = ['#dd6b66','#759aa0','#e69d87','#8dc1a9','#ea7e53','#eedd78','#73a373','#73b9bc','#7289ab', '#91ca8c','#f49f42'];\nvar theme = {\n    color: colorPalette,\n    backgroundColor: '#333',\n    tooltip: {\n        axisPointer: {\n            lineStyle: {\n                color: contrastColor\n            },\n            crossStyle: {\n                color: contrastColor\n            }\n        }\n    },\n    legend: {\n        textStyle: {\n            color: contrastColor\n        }\n    },\n    textStyle: {\n        color: contrastColor\n    },\n    title: {\n        textStyle: {\n            color: contrastColor\n        }\n    },\n    toolbox: {\n        iconStyle: {\n            normal: {\n                borderColor: contrastColor\n            }\n        }\n    },\n    dataZoom: {\n        textStyle: {\n            color: contrastColor\n        }\n    },\n    visualMap: {\n        textStyle: {\n            color: contrastColor\n        }\n    },\n    timeline: {\n        lineStyle: {\n            color: contrastColor\n        },\n        itemStyle: {\n            normal: {\n                color: colorPalette[1]\n            }\n        },\n        label: {\n            normal: {\n                textStyle: {\n                    color: contrastColor\n                }\n            }\n        },\n        controlStyle: {\n            normal: {\n                color: contrastColor,\n                borderColor: contrastColor\n            }\n        }\n    },\n    timeAxis: axisCommon(),\n    logAxis: axisCommon(),\n    valueAxis: axisCommon(),\n    categoryAxis: axisCommon(),\n\n    line: {\n        symbol: 'circle'\n    },\n    graph: {\n        color: colorPalette\n    },\n    gauge: {\n        title: {\n            textStyle: {\n                color: contrastColor\n            }\n        }\n    },\n    candlestick: {\n        itemStyle: {\n            normal: {\n                color: '#FD1050',\n                color0: '#0CF49B',\n                borderColor: '#FD1050',\n                borderColor0: '#0CF49B'\n            }\n        }\n    }\n};\ntheme.categoryAxis.splitLine.show = false;\n\n/*!\n * ECharts, a free, powerful charting and visualization library.\n *\n * Copyright (c) 2017, Baidu Inc.\n * All rights reserved.\n *\n * LICENSE\n * https://github.com/ecomfe/echarts/blob/master/LICENSE.txt\n */\n\nvar assert = assert$1;\nvar each = each$1;\nvar isFunction = isFunction$1;\nvar isObject = isObject$1;\nvar parseClassType = ComponentModel.parseClassType;\n\nvar version = '4.0.4';\n\nvar dependencies = {\n    zrender: '4.0.3'\n};\n\nvar TEST_FRAME_REMAIN_TIME = 1;\n\nvar PRIORITY_PROCESSOR_FILTER = 1000;\nvar PRIORITY_PROCESSOR_STATISTIC = 5000;\n\nvar PRIORITY_VISUAL_LAYOUT = 1000;\nvar PRIORITY_VISUAL_GLOBAL = 2000;\nvar PRIORITY_VISUAL_CHART = 3000;\nvar PRIORITY_VISUAL_COMPONENT = 4000;\n// FIXME\n// necessary?\nvar PRIORITY_VISUAL_BRUSH = 5000;\n\nvar PRIORITY = {\n    PROCESSOR: {\n        FILTER: PRIORITY_PROCESSOR_FILTER,\n        STATISTIC: PRIORITY_PROCESSOR_STATISTIC\n    },\n    VISUAL: {\n        LAYOUT: PRIORITY_VISUAL_LAYOUT,\n        GLOBAL: PRIORITY_VISUAL_GLOBAL,\n        CHART: PRIORITY_VISUAL_CHART,\n        COMPONENT: PRIORITY_VISUAL_COMPONENT,\n        BRUSH: PRIORITY_VISUAL_BRUSH\n    }\n};\n\n// Main process have three entries: `setOption`, `dispatchAction` and `resize`,\n// where they must not be invoked nestedly, except the only case: invoke\n// dispatchAction with updateMethod \"none\" in main process.\n// This flag is used to carry out this rule.\n// All events will be triggered out side main process (i.e. when !this[IN_MAIN_PROCESS]).\nvar IN_MAIN_PROCESS = '__flagInMainProcess';\nvar OPTION_UPDATED = '__optionUpdated';\nvar ACTION_REG = /^[a-zA-Z0-9_]+$/;\n\n\nfunction createRegisterEventWithLowercaseName(method) {\n    return function (eventName, handler, context) {\n        // Event name is all lowercase\n        eventName = eventName && eventName.toLowerCase();\n        Eventful.prototype[method].call(this, eventName, handler, context);\n    };\n}\n\n/**\n * @module echarts~MessageCenter\n */\nfunction MessageCenter() {\n    Eventful.call(this);\n}\nMessageCenter.prototype.on = createRegisterEventWithLowercaseName('on');\nMessageCenter.prototype.off = createRegisterEventWithLowercaseName('off');\nMessageCenter.prototype.one = createRegisterEventWithLowercaseName('one');\nmixin(MessageCenter, Eventful);\n\n/**\n * @module echarts~ECharts\n */\nfunction ECharts(dom, theme$$1, opts) {\n    opts = opts || {};\n\n    // Get theme by name\n    if (typeof theme$$1 === 'string') {\n        theme$$1 = themeStorage[theme$$1];\n    }\n\n    /**\n     * @type {string}\n     */\n    this.id;\n\n    /**\n     * Group id\n     * @type {string}\n     */\n    this.group;\n\n    /**\n     * @type {HTMLElement}\n     * @private\n     */\n    this._dom = dom;\n\n    var defaultRenderer = 'canvas';\n    if (__DEV__) {\n        defaultRenderer = (\n            typeof window === 'undefined' ? global : window\n        ).__ECHARTS__DEFAULT__RENDERER__ || defaultRenderer;\n    }\n\n    /**\n     * @type {module:zrender/ZRender}\n     * @private\n     */\n    var zr = this._zr = init$1(dom, {\n        renderer: opts.renderer || defaultRenderer,\n        devicePixelRatio: opts.devicePixelRatio,\n        width: opts.width,\n        height: opts.height\n    });\n\n    /**\n     * Expect 60 pfs.\n     * @type {Function}\n     * @private\n     */\n    this._throttledZrFlush = throttle(bind(zr.flush, zr), 17);\n\n    var theme$$1 = clone(theme$$1);\n    theme$$1 && backwardCompat(theme$$1, true);\n    /**\n     * @type {Object}\n     * @private\n     */\n    this._theme = theme$$1;\n\n    /**\n     * @type {Array.<module:echarts/view/Chart>}\n     * @private\n     */\n    this._chartsViews = [];\n\n    /**\n     * @type {Object.<string, module:echarts/view/Chart>}\n     * @private\n     */\n    this._chartsMap = {};\n\n    /**\n     * @type {Array.<module:echarts/view/Component>}\n     * @private\n     */\n    this._componentsViews = [];\n\n    /**\n     * @type {Object.<string, module:echarts/view/Component>}\n     * @private\n     */\n    this._componentsMap = {};\n\n    /**\n     * @type {module:echarts/CoordinateSystem}\n     * @private\n     */\n    this._coordSysMgr = new CoordinateSystemManager();\n\n    /**\n     * @type {module:echarts/ExtensionAPI}\n     * @private\n     */\n    var api = this._api = createExtensionAPI(this);\n\n    // Sort on demand\n    function prioritySortFunc(a, b) {\n        return a.__prio - b.__prio;\n    }\n    sort(visualFuncs, prioritySortFunc);\n    sort(dataProcessorFuncs, prioritySortFunc);\n\n    /**\n     * @type {module:echarts/stream/Scheduler}\n     */\n    this._scheduler = new Scheduler(this, api, dataProcessorFuncs, visualFuncs);\n\n    Eventful.call(this);\n\n    /**\n     * @type {module:echarts~MessageCenter}\n     * @private\n     */\n    this._messageCenter = new MessageCenter();\n\n    // Init mouse events\n    this._initEvents();\n\n    // In case some people write `window.onresize = chart.resize`\n    this.resize = bind(this.resize, this);\n\n    // Can't dispatch action during rendering procedure\n    this._pendingActions = [];\n\n    zr.animation.on('frame', this._onframe, this);\n\n    bindRenderedEvent(zr, this);\n\n    // ECharts instance can be used as value.\n    setAsPrimitive(this);\n}\n\nvar echartsProto = ECharts.prototype;\n\nechartsProto._onframe = function () {\n    if (this._disposed) {\n        return;\n    }\n\n    var scheduler = this._scheduler;\n\n    // Lazy update\n    if (this[OPTION_UPDATED]) {\n        var silent = this[OPTION_UPDATED].silent;\n\n        this[IN_MAIN_PROCESS] = true;\n\n        prepare(this);\n        updateMethods.update.call(this);\n\n        this[IN_MAIN_PROCESS] = false;\n\n        this[OPTION_UPDATED] = false;\n\n        flushPendingActions.call(this, silent);\n\n        triggerUpdatedEvent.call(this, silent);\n    }\n    // Avoid do both lazy update and progress in one frame.\n    else if (scheduler.unfinished) {\n        // Stream progress.\n        var remainTime = TEST_FRAME_REMAIN_TIME;\n        var ecModel = this._model;\n        var api = this._api;\n        scheduler.unfinished = false;\n        do {\n            var startTime = +new Date();\n\n            scheduler.performSeriesTasks(ecModel);\n\n            // Currently dataProcessorFuncs do not check threshold.\n            scheduler.performDataProcessorTasks(ecModel);\n\n            updateStreamModes(this, ecModel);\n\n            // Do not update coordinate system here. Because that coord system update in\n            // each frame is not a good user experience. So we follow the rule that\n            // the extent of the coordinate system is determin in the first frame (the\n            // frame is executed immedietely after task reset.\n            // this._coordSysMgr.update(ecModel, api);\n\n            // console.log('--- ec frame visual ---', remainTime);\n            scheduler.performVisualTasks(ecModel);\n\n            renderSeries(this, this._model, api, 'remain');\n\n            remainTime -= (+new Date() - startTime);\n        }\n        while (remainTime > 0 && scheduler.unfinished);\n\n        // Call flush explicitly for trigger finished event.\n        if (!scheduler.unfinished) {\n            this._zr.flush();\n        }\n        // Else, zr flushing be ensue within the same frame,\n        // because zr flushing is after onframe event.\n    }\n};\n\n/**\n * @return {HTMLElement}\n */\nechartsProto.getDom = function () {\n    return this._dom;\n};\n\n/**\n * @return {module:zrender~ZRender}\n */\nechartsProto.getZr = function () {\n    return this._zr;\n};\n\n/**\n * Usage:\n * chart.setOption(option, notMerge, lazyUpdate);\n * chart.setOption(option, {\n *     notMerge: ...,\n *     lazyUpdate: ...,\n *     silent: ...\n * });\n *\n * @param {Object} option\n * @param {Object|boolean} [opts] opts or notMerge.\n * @param {boolean} [opts.notMerge=false]\n * @param {boolean} [opts.lazyUpdate=false] Useful when setOption frequently.\n */\nechartsProto.setOption = function (option, notMerge, lazyUpdate) {\n    if (__DEV__) {\n        assert(!this[IN_MAIN_PROCESS], '`setOption` should not be called during main process.');\n    }\n\n    var silent;\n    if (isObject(notMerge)) {\n        lazyUpdate = notMerge.lazyUpdate;\n        silent = notMerge.silent;\n        notMerge = notMerge.notMerge;\n    }\n\n    this[IN_MAIN_PROCESS] = true;\n\n    if (!this._model || notMerge) {\n        var optionManager = new OptionManager(this._api);\n        var theme$$1 = this._theme;\n        var ecModel = this._model = new GlobalModel(null, null, theme$$1, optionManager);\n        ecModel.scheduler = this._scheduler;\n        ecModel.init(null, null, theme$$1, optionManager);\n    }\n\n    this._model.setOption(option, optionPreprocessorFuncs);\n\n    if (lazyUpdate) {\n        this[OPTION_UPDATED] = {silent: silent};\n        this[IN_MAIN_PROCESS] = false;\n    }\n    else {\n        prepare(this);\n\n        updateMethods.update.call(this);\n\n        // Ensure zr refresh sychronously, and then pixel in canvas can be\n        // fetched after `setOption`.\n        this._zr.flush();\n\n        this[OPTION_UPDATED] = false;\n        this[IN_MAIN_PROCESS] = false;\n\n        flushPendingActions.call(this, silent);\n        triggerUpdatedEvent.call(this, silent);\n    }\n};\n\n/**\n * @DEPRECATED\n */\nechartsProto.setTheme = function () {\n    console.log('ECharts#setTheme() is DEPRECATED in ECharts 3.0');\n};\n\n/**\n * @return {module:echarts/model/Global}\n */\nechartsProto.getModel = function () {\n    return this._model;\n};\n\n/**\n * @return {Object}\n */\nechartsProto.getOption = function () {\n    return this._model && this._model.getOption();\n};\n\n/**\n * @return {number}\n */\nechartsProto.getWidth = function () {\n    return this._zr.getWidth();\n};\n\n/**\n * @return {number}\n */\nechartsProto.getHeight = function () {\n    return this._zr.getHeight();\n};\n\n/**\n * @return {number}\n */\nechartsProto.getDevicePixelRatio = function () {\n    return this._zr.painter.dpr || window.devicePixelRatio || 1;\n};\n\n/**\n * Get canvas which has all thing rendered\n * @param {Object} opts\n * @param {string} [opts.backgroundColor]\n * @return {string}\n */\nechartsProto.getRenderedCanvas = function (opts) {\n    if (!env$1.canvasSupported) {\n        return;\n    }\n    opts = opts || {};\n    opts.pixelRatio = opts.pixelRatio || 1;\n    opts.backgroundColor = opts.backgroundColor\n        || this._model.get('backgroundColor');\n    var zr = this._zr;\n    // var list = zr.storage.getDisplayList();\n    // Stop animations\n    // Never works before in init animation, so remove it.\n    // zrUtil.each(list, function (el) {\n    //     el.stopAnimation(true);\n    // });\n    return zr.painter.getRenderedCanvas(opts);\n};\n\n/**\n * Get svg data url\n * @return {string}\n */\nechartsProto.getSvgDataUrl = function () {\n    if (!env$1.svgSupported) {\n        return;\n    }\n\n    var zr = this._zr;\n    var list = zr.storage.getDisplayList();\n    // Stop animations\n    each$1(list, function (el) {\n        el.stopAnimation(true);\n    });\n\n    return zr.painter.pathToDataUrl();\n};\n\n/**\n * @return {string}\n * @param {Object} opts\n * @param {string} [opts.type='png']\n * @param {string} [opts.pixelRatio=1]\n * @param {string} [opts.backgroundColor]\n * @param {string} [opts.excludeComponents]\n */\nechartsProto.getDataURL = function (opts) {\n    opts = opts || {};\n    var excludeComponents = opts.excludeComponents;\n    var ecModel = this._model;\n    var excludesComponentViews = [];\n    var self = this;\n\n    each(excludeComponents, function (componentType) {\n        ecModel.eachComponent({\n            mainType: componentType\n        }, function (component) {\n            var view = self._componentsMap[component.__viewId];\n            if (!view.group.ignore) {\n                excludesComponentViews.push(view);\n                view.group.ignore = true;\n            }\n        });\n    });\n\n    var url = this._zr.painter.getType() === 'svg'\n        ? this.getSvgDataUrl()\n        : this.getRenderedCanvas(opts).toDataURL(\n            'image/' + (opts && opts.type || 'png')\n        );\n\n    each(excludesComponentViews, function (view) {\n        view.group.ignore = false;\n    });\n\n    return url;\n};\n\n\n/**\n * @return {string}\n * @param {Object} opts\n * @param {string} [opts.type='png']\n * @param {string} [opts.pixelRatio=1]\n * @param {string} [opts.backgroundColor]\n */\nechartsProto.getConnectedDataURL = function (opts) {\n    if (!env$1.canvasSupported) {\n        return;\n    }\n    var groupId = this.group;\n    var mathMin = Math.min;\n    var mathMax = Math.max;\n    var MAX_NUMBER = Infinity;\n    if (connectedGroups[groupId]) {\n        var left = MAX_NUMBER;\n        var top = MAX_NUMBER;\n        var right = -MAX_NUMBER;\n        var bottom = -MAX_NUMBER;\n        var canvasList = [];\n        var dpr = (opts && opts.pixelRatio) || 1;\n\n        each$1(instances, function (chart, id) {\n            if (chart.group === groupId) {\n                var canvas = chart.getRenderedCanvas(\n                    clone(opts)\n                );\n                var boundingRect = chart.getDom().getBoundingClientRect();\n                left = mathMin(boundingRect.left, left);\n                top = mathMin(boundingRect.top, top);\n                right = mathMax(boundingRect.right, right);\n                bottom = mathMax(boundingRect.bottom, bottom);\n                canvasList.push({\n                    dom: canvas,\n                    left: boundingRect.left,\n                    top: boundingRect.top\n                });\n            }\n        });\n\n        left *= dpr;\n        top *= dpr;\n        right *= dpr;\n        bottom *= dpr;\n        var width = right - left;\n        var height = bottom - top;\n        var targetCanvas = createCanvas();\n        targetCanvas.width = width;\n        targetCanvas.height = height;\n        var zr = init$1(targetCanvas);\n\n        each(canvasList, function (item) {\n            var img = new ZImage({\n                style: {\n                    x: item.left * dpr - left,\n                    y: item.top * dpr - top,\n                    image: item.dom\n                }\n            });\n            zr.add(img);\n        });\n        zr.refreshImmediately();\n\n        return targetCanvas.toDataURL('image/' + (opts && opts.type || 'png'));\n    }\n    else {\n        return this.getDataURL(opts);\n    }\n};\n\n/**\n * Convert from logical coordinate system to pixel coordinate system.\n * See CoordinateSystem#convertToPixel.\n * @param {string|Object} finder\n *        If string, e.g., 'geo', means {geoIndex: 0}.\n *        If Object, could contain some of these properties below:\n *        {\n *            seriesIndex / seriesId / seriesName,\n *            geoIndex / geoId, geoName,\n *            bmapIndex / bmapId / bmapName,\n *            xAxisIndex / xAxisId / xAxisName,\n *            yAxisIndex / yAxisId / yAxisName,\n *            gridIndex / gridId / gridName,\n *            ... (can be extended)\n *        }\n * @param {Array|number} value\n * @return {Array|number} result\n */\nechartsProto.convertToPixel = curry(doConvertPixel, 'convertToPixel');\n\n/**\n * Convert from pixel coordinate system to logical coordinate system.\n * See CoordinateSystem#convertFromPixel.\n * @param {string|Object} finder\n *        If string, e.g., 'geo', means {geoIndex: 0}.\n *        If Object, could contain some of these properties below:\n *        {\n *            seriesIndex / seriesId / seriesName,\n *            geoIndex / geoId / geoName,\n *            bmapIndex / bmapId / bmapName,\n *            xAxisIndex / xAxisId / xAxisName,\n *            yAxisIndex / yAxisId / yAxisName\n *            gridIndex / gridId / gridName,\n *            ... (can be extended)\n *        }\n * @param {Array|number} value\n * @return {Array|number} result\n */\nechartsProto.convertFromPixel = curry(doConvertPixel, 'convertFromPixel');\n\nfunction doConvertPixel(methodName, finder, value) {\n    var ecModel = this._model;\n    var coordSysList = this._coordSysMgr.getCoordinateSystems();\n    var result;\n\n    finder = parseFinder(ecModel, finder);\n\n    for (var i = 0; i < coordSysList.length; i++) {\n        var coordSys = coordSysList[i];\n        if (coordSys[methodName]\n            && (result = coordSys[methodName](ecModel, finder, value)) != null\n        ) {\n            return result;\n        }\n    }\n\n    if (__DEV__) {\n        console.warn(\n            'No coordinate system that supports ' + methodName + ' found by the given finder.'\n        );\n    }\n}\n\n/**\n * Is the specified coordinate systems or components contain the given pixel point.\n * @param {string|Object} finder\n *        If string, e.g., 'geo', means {geoIndex: 0}.\n *        If Object, could contain some of these properties below:\n *        {\n *            seriesIndex / seriesId / seriesName,\n *            geoIndex / geoId / geoName,\n *            bmapIndex / bmapId / bmapName,\n *            xAxisIndex / xAxisId / xAxisName,\n *            yAxisIndex / yAxisId / yAxisName,\n *            gridIndex / gridId / gridName,\n *            ... (can be extended)\n *        }\n * @param {Array|number} value\n * @return {boolean} result\n */\nechartsProto.containPixel = function (finder, value) {\n    var ecModel = this._model;\n    var result;\n\n    finder = parseFinder(ecModel, finder);\n\n    each$1(finder, function (models, key) {\n        key.indexOf('Models') >= 0 && each$1(models, function (model) {\n            var coordSys = model.coordinateSystem;\n            if (coordSys && coordSys.containPoint) {\n                result |= !!coordSys.containPoint(value);\n            }\n            else if (key === 'seriesModels') {\n                var view = this._chartsMap[model.__viewId];\n                if (view && view.containPoint) {\n                    result |= view.containPoint(value, model);\n                }\n                else {\n                    if (__DEV__) {\n                        console.warn(key + ': ' + (view\n                            ? 'The found component do not support containPoint.'\n                            : 'No view mapping to the found component.'\n                        ));\n                    }\n                }\n            }\n            else {\n                if (__DEV__) {\n                    console.warn(key + ': containPoint is not supported');\n                }\n            }\n        }, this);\n    }, this);\n\n    return !!result;\n};\n\n/**\n * Get visual from series or data.\n * @param {string|Object} finder\n *        If string, e.g., 'series', means {seriesIndex: 0}.\n *        If Object, could contain some of these properties below:\n *        {\n *            seriesIndex / seriesId / seriesName,\n *            dataIndex / dataIndexInside\n *        }\n *        If dataIndex is not specified, series visual will be fetched,\n *        but not data item visual.\n *        If all of seriesIndex, seriesId, seriesName are not specified,\n *        visual will be fetched from first series.\n * @param {string} visualType 'color', 'symbol', 'symbolSize'\n */\nechartsProto.getVisual = function (finder, visualType) {\n    var ecModel = this._model;\n\n    finder = parseFinder(ecModel, finder, {defaultMainType: 'series'});\n\n    var seriesModel = finder.seriesModel;\n\n    if (__DEV__) {\n        if (!seriesModel) {\n            console.warn('There is no specified seires model');\n        }\n    }\n\n    var data = seriesModel.getData();\n\n    var dataIndexInside = finder.hasOwnProperty('dataIndexInside')\n        ? finder.dataIndexInside\n        : finder.hasOwnProperty('dataIndex')\n        ? data.indexOfRawIndex(finder.dataIndex)\n        : null;\n\n    return dataIndexInside != null\n        ? data.getItemVisual(dataIndexInside, visualType)\n        : data.getVisual(visualType);\n};\n\n/**\n * Get view of corresponding component model\n * @param  {module:echarts/model/Component} componentModel\n * @return {module:echarts/view/Component}\n */\nechartsProto.getViewOfComponentModel = function (componentModel) {\n    return this._componentsMap[componentModel.__viewId];\n};\n\n/**\n * Get view of corresponding series model\n * @param  {module:echarts/model/Series} seriesModel\n * @return {module:echarts/view/Chart}\n */\nechartsProto.getViewOfSeriesModel = function (seriesModel) {\n    return this._chartsMap[seriesModel.__viewId];\n};\n\nvar updateMethods = {\n\n    prepareAndUpdate: function (payload) {\n        prepare(this);\n        updateMethods.update.call(this, payload);\n    },\n\n    /**\n     * @param {Object} payload\n     * @private\n     */\n    update: function (payload) {\n        // console.profile && console.profile('update');\n\n        var ecModel = this._model;\n        var api = this._api;\n        var zr = this._zr;\n        var coordSysMgr = this._coordSysMgr;\n        var scheduler = this._scheduler;\n\n        // update before setOption\n        if (!ecModel) {\n            return;\n        }\n\n        ecModel.restoreData(payload);\n\n        scheduler.performSeriesTasks(ecModel);\n\n        // TODO\n        // Save total ecModel here for undo/redo (after restoring data and before processing data).\n        // Undo (restoration of total ecModel) can be carried out in 'action' or outside API call.\n\n        // Create new coordinate system each update\n        // In LineView may save the old coordinate system and use it to get the orignal point\n        coordSysMgr.create(ecModel, api);\n\n        scheduler.performDataProcessorTasks(ecModel, payload);\n\n        // Current stream render is not supported in data process. So we can update\n        // stream modes after data processing, where the filtered data is used to\n        // deteming whether use progressive rendering.\n        updateStreamModes(this, ecModel);\n\n        // stackSeriesData(ecModel);\n\n        coordSysMgr.update(ecModel, api);\n\n        clearColorPalette(ecModel);\n        scheduler.performVisualTasks(ecModel, payload);\n\n        render(this, ecModel, api, payload);\n\n        // Set background\n        var backgroundColor = ecModel.get('backgroundColor') || 'transparent';\n\n        // In IE8\n        if (!env$1.canvasSupported) {\n            var colorArr = parse(backgroundColor);\n            backgroundColor = stringify(colorArr, 'rgb');\n            if (colorArr[3] === 0) {\n                backgroundColor = 'transparent';\n            }\n        }\n        else {\n            zr.setBackgroundColor(backgroundColor);\n        }\n\n        performPostUpdateFuncs(ecModel, api);\n\n        // console.profile && console.profileEnd('update');\n    },\n\n    /**\n     * @param {Object} payload\n     * @private\n     */\n    updateTransform: function (payload) {\n        var ecModel = this._model;\n        var ecIns = this;\n        var api = this._api;\n\n        // update before setOption\n        if (!ecModel) {\n            return;\n        }\n\n        // ChartView.markUpdateMethod(payload, 'updateTransform');\n\n        var componentDirtyList = [];\n        ecModel.eachComponent(function (componentType, componentModel) {\n            var componentView = ecIns.getViewOfComponentModel(componentModel);\n            if (componentView && componentView.__alive) {\n                if (componentView.updateTransform) {\n                    var result = componentView.updateTransform(componentModel, ecModel, api, payload);\n                    result && result.update && componentDirtyList.push(componentView);\n                }\n                else {\n                    componentDirtyList.push(componentView);\n                }\n            }\n        });\n\n        var seriesDirtyMap = createHashMap();\n        ecModel.eachSeries(function (seriesModel) {\n            var chartView = ecIns._chartsMap[seriesModel.__viewId];\n            if (chartView.updateTransform) {\n                var result = chartView.updateTransform(seriesModel, ecModel, api, payload);\n                result && result.update && seriesDirtyMap.set(seriesModel.uid, 1);\n            }\n            else {\n                seriesDirtyMap.set(seriesModel.uid, 1);\n            }\n        });\n\n        clearColorPalette(ecModel);\n        // Keep pipe to the exist pipeline because it depends on the render task of the full pipeline.\n        // this._scheduler.performVisualTasks(ecModel, payload, 'layout', true);\n        this._scheduler.performVisualTasks(\n            ecModel, payload, {setDirty: true, dirtyMap: seriesDirtyMap}\n        );\n\n        // Currently, not call render of components. Geo render cost a lot.\n        // renderComponents(ecIns, ecModel, api, payload, componentDirtyList);\n        renderSeries(ecIns, ecModel, api, payload, seriesDirtyMap);\n\n        performPostUpdateFuncs(ecModel, this._api);\n    },\n\n    /**\n     * @param {Object} payload\n     * @private\n     */\n    updateView: function (payload) {\n        var ecModel = this._model;\n\n        // update before setOption\n        if (!ecModel) {\n            return;\n        }\n\n        Chart.markUpdateMethod(payload, 'updateView');\n\n        clearColorPalette(ecModel);\n\n        // Keep pipe to the exist pipeline because it depends on the render task of the full pipeline.\n        this._scheduler.performVisualTasks(ecModel, payload, {setDirty: true});\n\n        render(this, this._model, this._api, payload);\n\n        performPostUpdateFuncs(ecModel, this._api);\n    },\n\n    /**\n     * @param {Object} payload\n     * @private\n     */\n    updateVisual: function (payload) {\n        updateMethods.update.call(this, payload);\n\n        // var ecModel = this._model;\n\n        // // update before setOption\n        // if (!ecModel) {\n        //     return;\n        // }\n\n        // ChartView.markUpdateMethod(payload, 'updateVisual');\n\n        // clearColorPalette(ecModel);\n\n        // // Keep pipe to the exist pipeline because it depends on the render task of the full pipeline.\n        // this._scheduler.performVisualTasks(ecModel, payload, {visualType: 'visual', setDirty: true});\n\n        // render(this, this._model, this._api, payload);\n\n        // performPostUpdateFuncs(ecModel, this._api);\n    },\n\n    /**\n     * @param {Object} payload\n     * @private\n     */\n    updateLayout: function (payload) {\n        updateMethods.update.call(this, payload);\n\n        // var ecModel = this._model;\n\n        // // update before setOption\n        // if (!ecModel) {\n        //     return;\n        // }\n\n        // ChartView.markUpdateMethod(payload, 'updateLayout');\n\n        // // Keep pipe to the exist pipeline because it depends on the render task of the full pipeline.\n        // // this._scheduler.performVisualTasks(ecModel, payload, 'layout', true);\n        // this._scheduler.performVisualTasks(ecModel, payload, {setDirty: true});\n\n        // render(this, this._model, this._api, payload);\n\n        // performPostUpdateFuncs(ecModel, this._api);\n    }\n};\n\nfunction prepare(ecIns) {\n    var ecModel = ecIns._model;\n    var scheduler = ecIns._scheduler;\n\n    scheduler.restorePipelines(ecModel);\n\n    scheduler.prepareStageTasks();\n\n    prepareView(ecIns, 'component', ecModel, scheduler);\n\n    prepareView(ecIns, 'chart', ecModel, scheduler);\n\n    scheduler.plan();\n}\n\n/**\n * @private\n */\nfunction updateDirectly(ecIns, method, payload, mainType, subType) {\n    var ecModel = ecIns._model;\n\n    // broadcast\n    if (!mainType) {\n        // FIXME\n        // Chart will not be update directly here, except set dirty.\n        // But there is no such scenario now.\n        each(ecIns._componentsViews.concat(ecIns._chartsViews), callView);\n        return;\n    }\n\n    var query = {};\n    query[mainType + 'Id'] = payload[mainType + 'Id'];\n    query[mainType + 'Index'] = payload[mainType + 'Index'];\n    query[mainType + 'Name'] = payload[mainType + 'Name'];\n\n    var condition = {mainType: mainType, query: query};\n    subType && (condition.subType = subType); // subType may be '' by parseClassType;\n\n    // If dispatchAction before setOption, do nothing.\n    ecModel && ecModel.eachComponent(condition, function (model, index) {\n        callView(ecIns[\n            mainType === 'series' ? '_chartsMap' : '_componentsMap'\n        ][model.__viewId]);\n    }, ecIns);\n\n    function callView(view) {\n        view && view.__alive && view[method] && view[method](\n            view.__model, ecModel, ecIns._api, payload\n        );\n    }\n}\n\n/**\n * Resize the chart\n * @param {Object} opts\n * @param {number} [opts.width] Can be 'auto' (the same as null/undefined)\n * @param {number} [opts.height] Can be 'auto' (the same as null/undefined)\n * @param {boolean} [opts.silent=false]\n */\nechartsProto.resize = function (opts) {\n    if (__DEV__) {\n        assert(!this[IN_MAIN_PROCESS], '`resize` should not be called during main process.');\n    }\n\n    this._zr.resize(opts);\n\n    var ecModel = this._model;\n\n    // Resize loading effect\n    this._loadingFX && this._loadingFX.resize();\n\n    if (!ecModel) {\n        return;\n    }\n\n    var optionChanged = ecModel.resetOption('media');\n\n    var silent = opts && opts.silent;\n\n    this[IN_MAIN_PROCESS] = true;\n\n    optionChanged && prepare(this);\n    updateMethods.update.call(this);\n\n    this[IN_MAIN_PROCESS] = false;\n\n    flushPendingActions.call(this, silent);\n\n    triggerUpdatedEvent.call(this, silent);\n};\n\nfunction updateStreamModes(ecIns, ecModel) {\n    var chartsMap = ecIns._chartsMap;\n    var scheduler = ecIns._scheduler;\n    ecModel.eachSeries(function (seriesModel) {\n        scheduler.updateStreamModes(seriesModel, chartsMap[seriesModel.__viewId]);\n    });\n}\n\n/**\n * Show loading effect\n * @param  {string} [name='default']\n * @param  {Object} [cfg]\n */\nechartsProto.showLoading = function (name, cfg) {\n    if (isObject(name)) {\n        cfg = name;\n        name = '';\n    }\n    name = name || 'default';\n\n    this.hideLoading();\n    if (!loadingEffects[name]) {\n        if (__DEV__) {\n            console.warn('Loading effects ' + name + ' not exists.');\n        }\n        return;\n    }\n    var el = loadingEffects[name](this._api, cfg);\n    var zr = this._zr;\n    this._loadingFX = el;\n\n    zr.add(el);\n};\n\n/**\n * Hide loading effect\n */\nechartsProto.hideLoading = function () {\n    this._loadingFX && this._zr.remove(this._loadingFX);\n    this._loadingFX = null;\n};\n\n/**\n * @param {Object} eventObj\n * @return {Object}\n */\nechartsProto.makeActionFromEvent = function (eventObj) {\n    var payload = extend({}, eventObj);\n    payload.type = eventActionMap[eventObj.type];\n    return payload;\n};\n\n/**\n * @pubilc\n * @param {Object} payload\n * @param {string} [payload.type] Action type\n * @param {Object|boolean} [opt] If pass boolean, means opt.silent\n * @param {boolean} [opt.silent=false] Whether trigger events.\n * @param {boolean} [opt.flush=undefined]\n *                  true: Flush immediately, and then pixel in canvas can be fetched\n *                      immediately. Caution: it might affect performance.\n *                  false: Not not flush.\n *                  undefined: Auto decide whether perform flush.\n */\nechartsProto.dispatchAction = function (payload, opt) {\n    if (!isObject(opt)) {\n        opt = {silent: !!opt};\n    }\n\n    if (!actions[payload.type]) {\n        return;\n    }\n\n    // Avoid dispatch action before setOption. Especially in `connect`.\n    if (!this._model) {\n        return;\n    }\n\n    // May dispatchAction in rendering procedure\n    if (this[IN_MAIN_PROCESS]) {\n        this._pendingActions.push(payload);\n        return;\n    }\n\n    doDispatchAction.call(this, payload, opt.silent);\n\n    if (opt.flush) {\n        this._zr.flush(true);\n    }\n    else if (opt.flush !== false && env$1.browser.weChat) {\n        // In WeChat embeded browser, `requestAnimationFrame` and `setInterval`\n        // hang when sliding page (on touch event), which cause that zr does not\n        // refresh util user interaction finished, which is not expected.\n        // But `dispatchAction` may be called too frequently when pan on touch\n        // screen, which impacts performance if do not throttle them.\n        this._throttledZrFlush();\n    }\n\n    flushPendingActions.call(this, opt.silent);\n\n    triggerUpdatedEvent.call(this, opt.silent);\n};\n\nfunction doDispatchAction(payload, silent) {\n    var payloadType = payload.type;\n    var escapeConnect = payload.escapeConnect;\n    var actionWrap = actions[payloadType];\n    var actionInfo = actionWrap.actionInfo;\n\n    var cptType = (actionInfo.update || 'update').split(':');\n    var updateMethod = cptType.pop();\n    cptType = cptType[0] != null && parseClassType(cptType[0]);\n\n    this[IN_MAIN_PROCESS] = true;\n\n    var payloads = [payload];\n    var batched = false;\n    // Batch action\n    if (payload.batch) {\n        batched = true;\n        payloads = map(payload.batch, function (item) {\n            item = defaults(extend({}, item), payload);\n            item.batch = null;\n            return item;\n        });\n    }\n\n    var eventObjBatch = [];\n    var eventObj;\n    var isHighDown = payloadType === 'highlight' || payloadType === 'downplay';\n\n    each(payloads, function (batchItem) {\n        // Action can specify the event by return it.\n        eventObj = actionWrap.action(batchItem, this._model, this._api);\n        // Emit event outside\n        eventObj = eventObj || extend({}, batchItem);\n        // Convert type to eventType\n        eventObj.type = actionInfo.event || eventObj.type;\n        eventObjBatch.push(eventObj);\n\n        // light update does not perform data process, layout and visual.\n        if (isHighDown) {\n            // method, payload, mainType, subType\n            updateDirectly(this, updateMethod, batchItem, 'series');\n        }\n        else if (cptType) {\n            updateDirectly(this, updateMethod, batchItem, cptType.main, cptType.sub);\n        }\n    }, this);\n\n    if (updateMethod !== 'none' && !isHighDown && !cptType) {\n        // Still dirty\n        if (this[OPTION_UPDATED]) {\n            // FIXME Pass payload ?\n            prepare(this);\n            updateMethods.update.call(this, payload);\n            this[OPTION_UPDATED] = false;\n        }\n        else {\n            updateMethods[updateMethod].call(this, payload);\n        }\n    }\n\n    // Follow the rule of action batch\n    if (batched) {\n        eventObj = {\n            type: actionInfo.event || payloadType,\n            escapeConnect: escapeConnect,\n            batch: eventObjBatch\n        };\n    }\n    else {\n        eventObj = eventObjBatch[0];\n    }\n\n    this[IN_MAIN_PROCESS] = false;\n\n    !silent && this._messageCenter.trigger(eventObj.type, eventObj);\n}\n\nfunction flushPendingActions(silent) {\n    var pendingActions = this._pendingActions;\n    while (pendingActions.length) {\n        var payload = pendingActions.shift();\n        doDispatchAction.call(this, payload, silent);\n    }\n}\n\nfunction triggerUpdatedEvent(silent) {\n    !silent && this.trigger('updated');\n}\n\n/**\n * Event `rendered` is triggered when zr\n * rendered. It is useful for realtime\n * snapshot (reflect animation).\n *\n * Event `finished` is triggered when:\n * (1) zrender rendering finished.\n * (2) initial animation finished.\n * (3) progressive rendering finished.\n * (4) no pending action.\n * (5) no delayed setOption needs to be processed.\n */\nfunction bindRenderedEvent(zr, ecIns) {\n    zr.on('rendered', function () {\n\n        ecIns.trigger('rendered');\n\n        // The `finished` event should not be triggered repeatly,\n        // so it should only be triggered when rendering indeed happend\n        // in zrender. (Consider the case that dipatchAction is keep\n        // triggering when mouse move).\n        if (\n            // Although zr is dirty if initial animation is not finished\n            // and this checking is called on frame, we also check\n            // animation finished for robustness.\n            zr.animation.isFinished()\n            && !ecIns[OPTION_UPDATED]\n            && !ecIns._scheduler.unfinished\n            && !ecIns._pendingActions.length\n        ) {\n            ecIns.trigger('finished');\n        }\n    });\n}\n\n/**\n * @param {Object} params\n * @param {number} params.seriesIndex\n * @param {Array|TypedArray} params.data\n */\nechartsProto.appendData = function (params) {\n    var seriesIndex = params.seriesIndex;\n    var ecModel = this.getModel();\n    var seriesModel = ecModel.getSeriesByIndex(seriesIndex);\n\n    if (__DEV__) {\n        assert(params.data && seriesModel);\n    }\n\n    seriesModel.appendData(params);\n\n    // Note: `appendData` does not support that update extent of coordinate\n    // system, util some scenario require that. In the expected usage of\n    // `appendData`, the initial extent of coordinate system should better\n    // be fixed by axis `min`/`max` setting or initial data, otherwise if\n    // the extent changed while `appendData`, the location of the painted\n    // graphic elements have to be changed, which make the usage of\n    // `appendData` meaningless.\n\n    this._scheduler.unfinished = true;\n};\n\n/**\n * Register event\n * @method\n */\nechartsProto.on = createRegisterEventWithLowercaseName('on');\nechartsProto.off = createRegisterEventWithLowercaseName('off');\nechartsProto.one = createRegisterEventWithLowercaseName('one');\n\n/**\n * Prepare view instances of charts and components\n * @param  {module:echarts/model/Global} ecModel\n * @private\n */\nfunction prepareView(ecIns, type, ecModel, scheduler) {\n    var isComponent = type === 'component';\n    var viewList = isComponent ? ecIns._componentsViews : ecIns._chartsViews;\n    var viewMap = isComponent ? ecIns._componentsMap : ecIns._chartsMap;\n    var zr = ecIns._zr;\n    var api = ecIns._api;\n\n    for (var i = 0; i < viewList.length; i++) {\n        viewList[i].__alive = false;\n    }\n\n    isComponent\n        ? ecModel.eachComponent(function (componentType, model) {\n            componentType !== 'series' && doPrepare(model);\n        })\n        : ecModel.eachSeries(doPrepare);\n\n    function doPrepare(model) {\n        // Consider: id same and type changed.\n        var viewId = '_ec_' + model.id + '_' + model.type;\n        var view = viewMap[viewId];\n        if (!view) {\n            var classType = parseClassType(model.type);\n            var Clazz = isComponent\n                ? Component.getClass(classType.main, classType.sub)\n                : Chart.getClass(classType.sub);\n\n            if (__DEV__) {\n                assert(Clazz, classType.sub + ' does not exist.');\n            }\n\n            view = new Clazz();\n            view.init(ecModel, api);\n            viewMap[viewId] = view;\n            viewList.push(view);\n            zr.add(view.group);\n        }\n\n        model.__viewId = view.__id = viewId;\n        view.__alive = true;\n        view.__model = model;\n        view.group.__ecComponentInfo = {\n            mainType: model.mainType,\n            index: model.componentIndex\n        };\n        !isComponent && scheduler.prepareView(view, model, ecModel, api);\n    }\n\n    for (var i = 0; i < viewList.length;) {\n        var view = viewList[i];\n        if (!view.__alive) {\n            !isComponent && view.renderTask.dispose();\n            zr.remove(view.group);\n            view.dispose(ecModel, api);\n            viewList.splice(i, 1);\n            delete viewMap[view.__id];\n            view.__id = view.group.__ecComponentInfo = null;\n        }\n        else {\n            i++;\n        }\n    }\n}\n\n// /**\n//  * Encode visual infomation from data after data processing\n//  *\n//  * @param {module:echarts/model/Global} ecModel\n//  * @param {object} layout\n//  * @param {boolean} [layoutFilter] `true`: only layout,\n//  *                                 `false`: only not layout,\n//  *                                 `null`/`undefined`: all.\n//  * @param {string} taskBaseTag\n//  * @private\n//  */\n// function startVisualEncoding(ecIns, ecModel, api, payload, layoutFilter) {\n//     each(visualFuncs, function (visual, index) {\n//         var isLayout = visual.isLayout;\n//         if (layoutFilter == null\n//             || (layoutFilter === false && !isLayout)\n//             || (layoutFilter === true && isLayout)\n//         ) {\n//             visual.func(ecModel, api, payload);\n//         }\n//     });\n// }\n\nfunction clearColorPalette(ecModel) {\n    ecModel.clearColorPalette();\n    ecModel.eachSeries(function (seriesModel) {\n        seriesModel.clearColorPalette();\n    });\n}\n\nfunction render(ecIns, ecModel, api, payload) {\n\n    renderComponents(ecIns, ecModel, api, payload);\n\n    each(ecIns._chartsViews, function (chart) {\n        chart.__alive = false;\n    });\n\n    renderSeries(ecIns, ecModel, api, payload);\n\n    // Remove groups of unrendered charts\n    each(ecIns._chartsViews, function (chart) {\n        if (!chart.__alive) {\n            chart.remove(ecModel, api);\n        }\n    });\n}\n\nfunction renderComponents(ecIns, ecModel, api, payload, dirtyList) {\n    each(dirtyList || ecIns._componentsViews, function (componentView) {\n        var componentModel = componentView.__model;\n        componentView.render(componentModel, ecModel, api, payload);\n\n        updateZ(componentModel, componentView);\n    });\n}\n\n/**\n * Render each chart and component\n * @private\n */\nfunction renderSeries(ecIns, ecModel, api, payload, dirtyMap) {\n    // Render all charts\n    var scheduler = ecIns._scheduler;\n    var unfinished;\n    ecModel.eachSeries(function (seriesModel) {\n        var chartView = ecIns._chartsMap[seriesModel.__viewId];\n        chartView.__alive = true;\n\n        var renderTask = chartView.renderTask;\n        scheduler.updatePayload(renderTask, payload);\n\n        if (dirtyMap && dirtyMap.get(seriesModel.uid)) {\n            renderTask.dirty();\n        }\n\n        unfinished |= renderTask.perform(scheduler.getPerformArgs(renderTask));\n\n        chartView.group.silent = !!seriesModel.get('silent');\n\n        updateZ(seriesModel, chartView);\n\n        updateBlend(seriesModel, chartView);\n    });\n    scheduler.unfinished |= unfinished;\n\n    // If use hover layer\n    updateHoverLayerStatus(ecIns._zr, ecModel);\n\n    // Add aria\n    aria(ecIns._zr.dom, ecModel);\n}\n\nfunction performPostUpdateFuncs(ecModel, api) {\n    each(postUpdateFuncs, function (func) {\n        func(ecModel, api);\n    });\n}\n\n\nvar MOUSE_EVENT_NAMES = [\n    'click', 'dblclick', 'mouseover', 'mouseout', 'mousemove',\n    'mousedown', 'mouseup', 'globalout', 'contextmenu'\n];\n\n/**\n * @private\n */\nechartsProto._initEvents = function () {\n    each(MOUSE_EVENT_NAMES, function (eveName) {\n        this._zr.on(eveName, function (e) {\n            var ecModel = this.getModel();\n            var el = e.target;\n            var params;\n\n            // no e.target when 'globalout'.\n            if (eveName === 'globalout') {\n                params = {};\n            }\n            else if (el && el.dataIndex != null) {\n                var dataModel = el.dataModel || ecModel.getSeriesByIndex(el.seriesIndex);\n                params = dataModel && dataModel.getDataParams(el.dataIndex, el.dataType) || {};\n            }\n            // If element has custom eventData of components\n            else if (el && el.eventData) {\n                params = extend({}, el.eventData);\n            }\n\n            if (params) {\n                params.event = e;\n                params.type = eveName;\n                this.trigger(eveName, params);\n            }\n\n        }, this);\n    }, this);\n\n    each(eventActionMap, function (actionType, eventType) {\n        this._messageCenter.on(eventType, function (event) {\n            this.trigger(eventType, event);\n        }, this);\n    }, this);\n};\n\n/**\n * @return {boolean}\n */\nechartsProto.isDisposed = function () {\n    return this._disposed;\n};\n\n/**\n * Clear\n */\nechartsProto.clear = function () {\n    this.setOption({ series: [] }, true);\n};\n\n/**\n * Dispose instance\n */\nechartsProto.dispose = function () {\n    if (this._disposed) {\n        if (__DEV__) {\n            console.warn('Instance ' + this.id + ' has been disposed');\n        }\n        return;\n    }\n    this._disposed = true;\n\n    setAttribute(this.getDom(), DOM_ATTRIBUTE_KEY, '');\n\n    var api = this._api;\n    var ecModel = this._model;\n\n    each(this._componentsViews, function (component) {\n        component.dispose(ecModel, api);\n    });\n    each(this._chartsViews, function (chart) {\n        chart.dispose(ecModel, api);\n    });\n\n    // Dispose after all views disposed\n    this._zr.dispose();\n\n    delete instances[this.id];\n};\n\nmixin(ECharts, Eventful);\n\nfunction updateHoverLayerStatus(zr, ecModel) {\n    var storage = zr.storage;\n    var elCount = 0;\n    storage.traverse(function (el) {\n        if (!el.isGroup) {\n            elCount++;\n        }\n    });\n    if (elCount > ecModel.get('hoverLayerThreshold') && !env$1.node) {\n        storage.traverse(function (el) {\n            if (!el.isGroup) {\n                // Don't switch back.\n                el.useHoverLayer = true;\n            }\n        });\n    }\n}\n\n/**\n * Update chart progressive and blend.\n * @param {module:echarts/model/Series|module:echarts/model/Component} model\n * @param {module:echarts/view/Component|module:echarts/view/Chart} view\n */\nfunction updateBlend(seriesModel, chartView) {\n    var blendMode = seriesModel.get('blendMode') || null;\n    if (__DEV__) {\n        if (!env$1.canvasSupported && blendMode && blendMode !== 'source-over') {\n            console.warn('Only canvas support blendMode');\n        }\n    }\n    chartView.group.traverse(function (el) {\n        // FIXME marker and other components\n        if (!el.isGroup) {\n            // Only set if blendMode is changed. In case element is incremental and don't wan't to rerender.\n            if (el.style.blend !== blendMode) {\n                el.setStyle('blend', blendMode);\n            }\n        }\n        if (el.eachPendingDisplayable) {\n            el.eachPendingDisplayable(function (displayable) {\n                displayable.setStyle('blend', blendMode);\n            });\n        }\n    });\n}\n\n/**\n * @param {module:echarts/model/Series|module:echarts/model/Component} model\n * @param {module:echarts/view/Component|module:echarts/view/Chart} view\n */\nfunction updateZ(model, view) {\n    var z = model.get('z');\n    var zlevel = model.get('zlevel');\n    // Set z and zlevel\n    view.group.traverse(function (el) {\n        if (el.type !== 'group') {\n            z != null && (el.z = z);\n            zlevel != null && (el.zlevel = zlevel);\n        }\n    });\n}\n\nfunction createExtensionAPI(ecInstance) {\n    var coordSysMgr = ecInstance._coordSysMgr;\n    return extend(new ExtensionAPI(ecInstance), {\n        // Inject methods\n        getCoordinateSystems: bind(\n            coordSysMgr.getCoordinateSystems, coordSysMgr\n        ),\n        getComponentByElement: function (el) {\n            while (el) {\n                var modelInfo = el.__ecComponentInfo;\n                if (modelInfo != null) {\n                    return ecInstance._model.getComponent(modelInfo.mainType, modelInfo.index);\n                }\n                el = el.parent;\n            }\n        }\n    });\n}\n\n/**\n * @type {Object} key: actionType.\n * @inner\n */\nvar actions = {};\n\n/**\n * Map eventType to actionType\n * @type {Object}\n */\nvar eventActionMap = {};\n\n/**\n * Data processor functions of each stage\n * @type {Array.<Object.<string, Function>>}\n * @inner\n */\nvar dataProcessorFuncs = [];\n\n/**\n * @type {Array.<Function>}\n * @inner\n */\nvar optionPreprocessorFuncs = [];\n\n/**\n * @type {Array.<Function>}\n * @inner\n */\nvar postUpdateFuncs = [];\n\n/**\n * Visual encoding functions of each stage\n * @type {Array.<Object.<string, Function>>}\n */\nvar visualFuncs = [];\n\n/**\n * Theme storage\n * @type {Object.<key, Object>}\n */\nvar themeStorage = {};\n/**\n * Loading effects\n */\nvar loadingEffects = {};\n\nvar instances = {};\nvar connectedGroups = {};\n\nvar idBase = new Date() - 0;\nvar groupIdBase = new Date() - 0;\nvar DOM_ATTRIBUTE_KEY = '_echarts_instance_';\n\nvar mapDataStores = {};\n\nfunction enableConnect(chart) {\n    var STATUS_PENDING = 0;\n    var STATUS_UPDATING = 1;\n    var STATUS_UPDATED = 2;\n    var STATUS_KEY = '__connectUpdateStatus';\n\n    function updateConnectedChartsStatus(charts, status) {\n        for (var i = 0; i < charts.length; i++) {\n            var otherChart = charts[i];\n            otherChart[STATUS_KEY] = status;\n        }\n    }\n\n    each(eventActionMap, function (actionType, eventType) {\n        chart._messageCenter.on(eventType, function (event) {\n            if (connectedGroups[chart.group] && chart[STATUS_KEY] !== STATUS_PENDING) {\n                if (event && event.escapeConnect) {\n                    return;\n                }\n\n                var action = chart.makeActionFromEvent(event);\n                var otherCharts = [];\n\n                each(instances, function (otherChart) {\n                    if (otherChart !== chart && otherChart.group === chart.group) {\n                        otherCharts.push(otherChart);\n                    }\n                });\n\n                updateConnectedChartsStatus(otherCharts, STATUS_PENDING);\n                each(otherCharts, function (otherChart) {\n                    if (otherChart[STATUS_KEY] !== STATUS_UPDATING) {\n                        otherChart.dispatchAction(action);\n                    }\n                });\n                updateConnectedChartsStatus(otherCharts, STATUS_UPDATED);\n            }\n        });\n    });\n}\n\n/**\n * @param {HTMLElement} dom\n * @param {Object} [theme]\n * @param {Object} opts\n * @param {number} [opts.devicePixelRatio] Use window.devicePixelRatio by default\n * @param {string} [opts.renderer] Currently only 'canvas' is supported.\n * @param {number} [opts.width] Use clientWidth of the input `dom` by default.\n *                              Can be 'auto' (the same as null/undefined)\n * @param {number} [opts.height] Use clientHeight of the input `dom` by default.\n *                               Can be 'auto' (the same as null/undefined)\n */\nfunction init(dom, theme$$1, opts) {\n    if (__DEV__) {\n        // Check version\n        if ((version$1.replace('.', '') - 0) < (dependencies.zrender.replace('.', '') - 0)) {\n            throw new Error(\n                'zrender/src ' + version$1\n                + ' is too old for ECharts ' + version\n                + '. Current version need ZRender '\n                + dependencies.zrender + '+'\n            );\n        }\n\n        if (!dom) {\n            throw new Error('Initialize failed: invalid dom.');\n        }\n    }\n\n    var existInstance = getInstanceByDom(dom);\n    if (existInstance) {\n        if (__DEV__) {\n            console.warn('There is a chart instance already initialized on the dom.');\n        }\n        return existInstance;\n    }\n\n    if (__DEV__) {\n        if (isDom(dom)\n            && dom.nodeName.toUpperCase() !== 'CANVAS'\n            && (\n                (!dom.clientWidth && (!opts || opts.width == null))\n                || (!dom.clientHeight && (!opts || opts.height == null))\n            )\n        ) {\n            console.warn('Can\\'t get dom width or height');\n        }\n    }\n\n    var chart = new ECharts(dom, theme$$1, opts);\n    chart.id = 'ec_' + idBase++;\n    instances[chart.id] = chart;\n\n    setAttribute(dom, DOM_ATTRIBUTE_KEY, chart.id);\n\n    enableConnect(chart);\n\n    return chart;\n}\n\n/**\n * @return {string|Array.<module:echarts~ECharts>} groupId\n */\nfunction connect(groupId) {\n    // Is array of charts\n    if (isArray(groupId)) {\n        var charts = groupId;\n        groupId = null;\n        // If any chart has group\n        each(charts, function (chart) {\n            if (chart.group != null) {\n                groupId = chart.group;\n            }\n        });\n        groupId = groupId || ('g_' + groupIdBase++);\n        each(charts, function (chart) {\n            chart.group = groupId;\n        });\n    }\n    connectedGroups[groupId] = true;\n    return groupId;\n}\n\n/**\n * @DEPRECATED\n * @return {string} groupId\n */\nfunction disConnect(groupId) {\n    connectedGroups[groupId] = false;\n}\n\n/**\n * @return {string} groupId\n */\nvar disconnect = disConnect;\n\n/**\n * Dispose a chart instance\n * @param  {module:echarts~ECharts|HTMLDomElement|string} chart\n */\nfunction dispose(chart) {\n    if (typeof chart === 'string') {\n        chart = instances[chart];\n    }\n    else if (!(chart instanceof ECharts)){\n        // Try to treat as dom\n        chart = getInstanceByDom(chart);\n    }\n    if ((chart instanceof ECharts) && !chart.isDisposed()) {\n        chart.dispose();\n    }\n}\n\n/**\n * @param  {HTMLElement} dom\n * @return {echarts~ECharts}\n */\nfunction getInstanceByDom(dom) {\n    return instances[getAttribute(dom, DOM_ATTRIBUTE_KEY)];\n}\n\n/**\n * @param {string} key\n * @return {echarts~ECharts}\n */\nfunction getInstanceById(key) {\n    return instances[key];\n}\n\n/**\n * Register theme\n */\nfunction registerTheme(name, theme$$1) {\n    themeStorage[name] = theme$$1;\n}\n\n/**\n * Register option preprocessor\n * @param {Function} preprocessorFunc\n */\nfunction registerPreprocessor(preprocessorFunc) {\n    optionPreprocessorFuncs.push(preprocessorFunc);\n}\n\n/**\n * @param {number} [priority=1000]\n * @param {Object|Function} processor\n */\nfunction registerProcessor(priority, processor) {\n    normalizeRegister(dataProcessorFuncs, priority, processor, PRIORITY_PROCESSOR_FILTER);\n}\n\n/**\n * Register postUpdater\n * @param {Function} postUpdateFunc\n */\nfunction registerPostUpdate(postUpdateFunc) {\n    postUpdateFuncs.push(postUpdateFunc);\n}\n\n/**\n * Usage:\n * registerAction('someAction', 'someEvent', function () { ... });\n * registerAction('someAction', function () { ... });\n * registerAction(\n *     {type: 'someAction', event: 'someEvent', update: 'updateView'},\n *     function () { ... }\n * );\n *\n * @param {(string|Object)} actionInfo\n * @param {string} actionInfo.type\n * @param {string} [actionInfo.event]\n * @param {string} [actionInfo.update]\n * @param {string} [eventName]\n * @param {Function} action\n */\nfunction registerAction(actionInfo, eventName, action) {\n    if (typeof eventName === 'function') {\n        action = eventName;\n        eventName = '';\n    }\n    var actionType = isObject(actionInfo)\n        ? actionInfo.type\n        : ([actionInfo, actionInfo = {\n            event: eventName\n        }][0]);\n\n    // Event name is all lowercase\n    actionInfo.event = (actionInfo.event || actionType).toLowerCase();\n    eventName = actionInfo.event;\n\n    // Validate action type and event name.\n    assert(ACTION_REG.test(actionType) && ACTION_REG.test(eventName));\n\n    if (!actions[actionType]) {\n        actions[actionType] = {action: action, actionInfo: actionInfo};\n    }\n    eventActionMap[eventName] = actionType;\n}\n\n/**\n * @param {string} type\n * @param {*} CoordinateSystem\n */\nfunction registerCoordinateSystem(type, CoordinateSystem$$1) {\n    CoordinateSystemManager.register(type, CoordinateSystem$$1);\n}\n\n/**\n * Get dimensions of specified coordinate system.\n * @param {string} type\n * @return {Array.<string|Object>}\n */\nfunction getCoordinateSystemDimensions(type) {\n    var coordSysCreator = CoordinateSystemManager.get(type);\n    if (coordSysCreator) {\n        return coordSysCreator.getDimensionsInfo\n                ? coordSysCreator.getDimensionsInfo()\n                : coordSysCreator.dimensions.slice();\n    }\n}\n\n/**\n * Layout is a special stage of visual encoding\n * Most visual encoding like color are common for different chart\n * But each chart has it's own layout algorithm\n *\n * @param {number} [priority=1000]\n * @param {Function} layoutTask\n */\nfunction registerLayout(priority, layoutTask) {\n    normalizeRegister(visualFuncs, priority, layoutTask, PRIORITY_VISUAL_LAYOUT, 'layout');\n}\n\n/**\n * @param {number} [priority=3000]\n * @param {module:echarts/stream/Task} visualTask\n */\nfunction registerVisual(priority, visualTask) {\n    normalizeRegister(visualFuncs, priority, visualTask, PRIORITY_VISUAL_CHART, 'visual');\n}\n\n/**\n * @param {Object|Function} fn: {seriesType, createOnAllSeries, performRawSeries, reset}\n */\nfunction normalizeRegister(targetList, priority, fn, defaultPriority, visualType) {\n    if (isFunction(priority) || isObject(priority)) {\n        fn = priority;\n        priority = defaultPriority;\n    }\n\n    if (__DEV__) {\n        if (isNaN(priority) || priority == null) {\n            throw new Error('Illegal priority');\n        }\n        // Check duplicate\n        each(targetList, function (wrap) {\n            assert(wrap.__raw !== fn);\n        });\n    }\n\n    var stageHandler = Scheduler.wrapStageHandler(fn, visualType);\n\n    stageHandler.__prio = priority;\n    stageHandler.__raw = fn;\n    targetList.push(stageHandler);\n\n    return stageHandler;\n}\n\n/**\n * @param {string} name\n */\nfunction registerLoading(name, loadingFx) {\n    loadingEffects[name] = loadingFx;\n}\n\n/**\n * @param {Object} opts\n * @param {string} [superClass]\n */\nfunction extendComponentModel(opts/*, superClass*/) {\n    // var Clazz = ComponentModel;\n    // if (superClass) {\n    //     var classType = parseClassType(superClass);\n    //     Clazz = ComponentModel.getClass(classType.main, classType.sub, true);\n    // }\n    return ComponentModel.extend(opts);\n}\n\n/**\n * @param {Object} opts\n * @param {string} [superClass]\n */\nfunction extendComponentView(opts/*, superClass*/) {\n    // var Clazz = ComponentView;\n    // if (superClass) {\n    //     var classType = parseClassType(superClass);\n    //     Clazz = ComponentView.getClass(classType.main, classType.sub, true);\n    // }\n    return Component.extend(opts);\n}\n\n/**\n * @param {Object} opts\n * @param {string} [superClass]\n */\nfunction extendSeriesModel(opts/*, superClass*/) {\n    // var Clazz = SeriesModel;\n    // if (superClass) {\n    //     superClass = 'series.' + superClass.replace('series.', '');\n    //     var classType = parseClassType(superClass);\n    //     Clazz = ComponentModel.getClass(classType.main, classType.sub, true);\n    // }\n    return SeriesModel.extend(opts);\n}\n\n/**\n * @param {Object} opts\n * @param {string} [superClass]\n */\nfunction extendChartView(opts/*, superClass*/) {\n    // var Clazz = ChartView;\n    // if (superClass) {\n    //     superClass = superClass.replace('series.', '');\n    //     var classType = parseClassType(superClass);\n    //     Clazz = ChartView.getClass(classType.main, true);\n    // }\n    return Chart.extend(opts);\n}\n\n/**\n * ZRender need a canvas context to do measureText.\n * But in node environment canvas may be created by node-canvas.\n * So we need to specify how to create a canvas instead of using document.createElement('canvas')\n *\n * Be careful of using it in the browser.\n *\n * @param {Function} creator\n * @example\n *     var Canvas = require('canvas');\n *     var echarts = require('echarts');\n *     echarts.setCanvasCreator(function () {\n *         // Small size is enough.\n *         return new Canvas(32, 32);\n *     });\n */\nfunction setCanvasCreator(creator) {\n    $override('createCanvas', creator);\n}\n\n/**\n * @param {string} mapName\n * @param {Object|string} geoJson\n * @param {Object} [specialAreas]\n *\n * @example\n *     $.get('USA.json', function (geoJson) {\n *         echarts.registerMap('USA', geoJson);\n *         // Or\n *         echarts.registerMap('USA', {\n *             geoJson: geoJson,\n *             specialAreas: {}\n *         })\n *     });\n */\nfunction registerMap(mapName, geoJson, specialAreas) {\n    if (geoJson.geoJson && !geoJson.features) {\n        specialAreas = geoJson.specialAreas;\n        geoJson = geoJson.geoJson;\n    }\n    if (typeof geoJson === 'string') {\n        geoJson = (typeof JSON !== 'undefined' && JSON.parse)\n            ? JSON.parse(geoJson) : (new Function('return (' + geoJson + ');'))();\n    }\n    mapDataStores[mapName] = {\n        geoJson: geoJson,\n        specialAreas: specialAreas\n    };\n}\n\n/**\n * @param {string} mapName\n * @return {Object}\n */\nfunction getMap(mapName) {\n    return mapDataStores[mapName];\n}\n\nregisterVisual(PRIORITY_VISUAL_GLOBAL, seriesColor);\nregisterPreprocessor(backwardCompat);\nregisterProcessor(PRIORITY_PROCESSOR_STATISTIC, dataStack);\nregisterLoading('default', loadingDefault);\n\n// Default actions\n\nregisterAction({\n    type: 'highlight',\n    event: 'highlight',\n    update: 'highlight'\n}, noop);\n\nregisterAction({\n    type: 'downplay',\n    event: 'downplay',\n    update: 'downplay'\n}, noop);\n\n// Default theme\nregisterTheme('light', lightTheme);\nregisterTheme('dark', theme);\n\n// For backward compatibility, where the namespace `dataTool` will\n// be mounted on `echarts` is the extension `dataTool` is imported.\nvar dataTool = {};\n\nfunction defaultKeyGetter(item) {\n    return item;\n}\n\n/**\n * @param {Array} oldArr\n * @param {Array} newArr\n * @param {Function} oldKeyGetter\n * @param {Function} newKeyGetter\n * @param {Object} [context] Can be visited by this.context in callback.\n */\nfunction DataDiffer(oldArr, newArr, oldKeyGetter, newKeyGetter, context) {\n    this._old = oldArr;\n    this._new = newArr;\n\n    this._oldKeyGetter = oldKeyGetter || defaultKeyGetter;\n    this._newKeyGetter = newKeyGetter || defaultKeyGetter;\n\n    this.context = context;\n}\n\nDataDiffer.prototype = {\n\n    constructor: DataDiffer,\n\n    /**\n     * Callback function when add a data\n     */\n    add: function (func) {\n        this._add = func;\n        return this;\n    },\n\n    /**\n     * Callback function when update a data\n     */\n    update: function (func) {\n        this._update = func;\n        return this;\n    },\n\n    /**\n     * Callback function when remove a data\n     */\n    remove: function (func) {\n        this._remove = func;\n        return this;\n    },\n\n    execute: function () {\n        var oldArr = this._old;\n        var newArr = this._new;\n\n        var oldDataIndexMap = {};\n        var newDataIndexMap = {};\n        var oldDataKeyArr = [];\n        var newDataKeyArr = [];\n        var i;\n\n        initIndexMap(oldArr, oldDataIndexMap, oldDataKeyArr, '_oldKeyGetter', this);\n        initIndexMap(newArr, newDataIndexMap, newDataKeyArr, '_newKeyGetter', this);\n\n        // Travel by inverted order to make sure order consistency\n        // when duplicate keys exists (consider newDataIndex.pop() below).\n        // For performance consideration, these code below do not look neat.\n        for (i = 0; i < oldArr.length; i++) {\n            var key = oldDataKeyArr[i];\n            var idx = newDataIndexMap[key];\n\n            // idx can never be empty array here. see 'set null' logic below.\n            if (idx != null) {\n                // Consider there is duplicate key (for example, use dataItem.name as key).\n                // We should make sure every item in newArr and oldArr can be visited.\n                var len = idx.length;\n                if (len) {\n                    len === 1 && (newDataIndexMap[key] = null);\n                    idx = idx.unshift();\n                }\n                else {\n                    newDataIndexMap[key] = null;\n                }\n                this._update && this._update(idx, i);\n            }\n            else {\n                this._remove && this._remove(i);\n            }\n        }\n\n        for (var i = 0; i < newDataKeyArr.length; i++) {\n            var key = newDataKeyArr[i];\n            if (newDataIndexMap.hasOwnProperty(key)) {\n                var idx = newDataIndexMap[key];\n                if (idx == null) {\n                    continue;\n                }\n                // idx can never be empty array here. see 'set null' logic above.\n                if (!idx.length) {\n                    this._add && this._add(idx);\n                }\n                else {\n                    for (var j = 0, len = idx.length; j < len; j++) {\n                        this._add && this._add(idx[j]);\n                    }\n                }\n            }\n        }\n    }\n};\n\nfunction initIndexMap(arr, map, keyArr, keyGetterName, dataDiffer) {\n    for (var i = 0; i < arr.length; i++) {\n        // Add prefix to avoid conflict with Object.prototype.\n        var key = '_ec_' + dataDiffer[keyGetterName](arr[i], i);\n        var existence = map[key];\n        if (existence == null) {\n            keyArr.push(key);\n            map[key] = i;\n        }\n        else {\n            if (!existence.length) {\n                map[key] = existence = [existence];\n            }\n            existence.push(i);\n        }\n    }\n}\n\nvar OTHER_DIMENSIONS = createHashMap([\n    'tooltip', 'label', 'itemName', 'itemId', 'seriesName'\n]);\n\nfunction summarizeDimensions(data) {\n    var summary = {};\n    var encode = summary.encode = {};\n    var notExtraCoordDimMap = createHashMap();\n    var defaultedLabel = [];\n\n    each$1(data.dimensions, function (dimName) {\n        var dimItem = data.getDimensionInfo(dimName);\n\n        var coordDim = dimItem.coordDim;\n        if (coordDim) {\n            if (__DEV__) {\n                assert$1(OTHER_DIMENSIONS.get(coordDim) == null);\n            }\n            var coordDimArr = encode[coordDim];\n            if (!encode.hasOwnProperty(coordDim)) {\n                coordDimArr = encode[coordDim] = [];\n            }\n            coordDimArr[dimItem.coordDimIndex] = dimName;\n\n            if (!dimItem.isExtraCoord) {\n                notExtraCoordDimMap.set(coordDim, 1);\n\n                // Use the last coord dim (and label friendly) as default label,\n                // because when dataset is used, it is hard to guess which dimension\n                // can be value dimension. If both show x, y on label is not look good,\n                // and conventionally y axis is focused more.\n                if (mayLabelDimType(dimItem.type)) {\n                    defaultedLabel[0] = dimName;\n                }\n            }\n        }\n\n        OTHER_DIMENSIONS.each(function (v, otherDim) {\n            var otherDimArr = encode[otherDim];\n            if (!encode.hasOwnProperty(otherDim)) {\n                otherDimArr = encode[otherDim] = [];\n            }\n\n            var dimIndex = dimItem.otherDims[otherDim];\n            if (dimIndex != null && dimIndex !== false) {\n                otherDimArr[dimIndex] = dimItem.name;\n            }\n        });\n    });\n\n    var dataDimsOnCoord = [];\n    var encodeFirstDimNotExtra = {};\n\n    notExtraCoordDimMap.each(function (v, coordDim) {\n        var dimArr = encode[coordDim];\n        // ??? FIXME extra coord should not be set in dataDimsOnCoord.\n        // But should fix the case that radar axes: simplify the logic\n        // of `completeDimension`, remove `extraPrefix`.\n        encodeFirstDimNotExtra[coordDim] = dimArr[0];\n        // Not necessary to remove duplicate, because a data\n        // dim canot on more than one coordDim.\n        dataDimsOnCoord = dataDimsOnCoord.concat(dimArr);\n    });\n\n    summary.dataDimsOnCoord = dataDimsOnCoord;\n    summary.encodeFirstDimNotExtra = encodeFirstDimNotExtra;\n\n    var encodeLabel = encode.label;\n    // FIXME `encode.label` is not recommanded, because formatter can not be set\n    // in this way. Use label.formatter instead. May be remove this approach someday.\n    if (encodeLabel && encodeLabel.length) {\n        defaultedLabel = encodeLabel.slice();\n    }\n\n    var defaultedTooltip = defaultedLabel.slice();\n    var encodeTooltip = encode.tooltip;\n    if (encodeTooltip && encodeTooltip.length) {\n        defaultedTooltip = encodeTooltip.slice();\n    }\n\n    encode.defaultedLabel = defaultedLabel;\n    encode.defaultedTooltip = defaultedTooltip;\n\n    return summary;\n}\n\nfunction getDimensionTypeByAxis(axisType) {\n    return axisType === 'category'\n        ? 'ordinal'\n        : axisType === 'time'\n        ? 'time'\n        : 'float';\n}\n\nfunction mayLabelDimType(dimType) {\n    // In most cases, ordinal and time do not suitable for label.\n    // Ordinal info can be displayed on axis. Time is too long.\n    return !(dimType === 'ordinal' || dimType === 'time');\n}\n\n// function findTheLastDimMayLabel(data) {\n//     // Get last value dim\n//     var dimensions = data.dimensions.slice();\n//     var valueType;\n//     var valueDim;\n//     while (dimensions.length && (\n//         valueDim = dimensions.pop(),\n//         valueType = data.getDimensionInfo(valueDim).type,\n//         valueType === 'ordinal' || valueType === 'time'\n//     )) {} // jshint ignore:line\n//     return valueDim;\n// }\n\n/**\n * List for data storage\n * @module echarts/data/List\n */\n\nvar isObject$4 = isObject$1;\n\nvar UNDEFINED = 'undefined';\nvar globalObj = typeof window === UNDEFINED ? global : window;\n\n// Use prefix to avoid index to be the same as otherIdList[idx],\n// which will cause weird udpate animation.\nvar ID_PREFIX = 'e\\0\\0';\n\nvar dataCtors = {\n    'float': typeof globalObj.Float64Array === UNDEFINED\n        ? Array : globalObj.Float64Array,\n    'int': typeof globalObj.Int32Array === UNDEFINED\n        ? Array : globalObj.Int32Array,\n    // Ordinal data type can be string or int\n    'ordinal': Array,\n    'number': Array,\n    'time': Array\n};\n\nvar CtorUint32Array = typeof globalObj.Uint32Array === UNDEFINED ? Array : globalObj.Uint32Array;\nvar CtorUint16Array = typeof globalObj.Uint16Array === UNDEFINED ? Array : globalObj.Uint16Array;\n\nfunction getIndicesCtor(list) {\n    // The possible max value in this._indicies is always this._rawCount despite of filtering.\n    return list._rawCount > 65535 ? CtorUint32Array : CtorUint16Array;\n}\n\nfunction cloneChunk(originalChunk) {\n    var Ctor = originalChunk.constructor;\n    // Only shallow clone is enough when Array.\n    return Ctor === Array ? originalChunk.slice() : new Ctor(originalChunk);\n}\n\nvar TRANSFERABLE_PROPERTIES = [\n    'hasItemOption', '_nameList', '_idList', '_calculationInfo', '_invertedIndicesMap',\n    '_rawData', '_rawExtent', '_chunkSize', '_chunkCount',\n    '_dimValueGetter', '_count', '_rawCount', '_nameDimIdx', '_idDimIdx'\n];\n\nfunction transferProperties(a, b) {\n    each$1(TRANSFERABLE_PROPERTIES.concat(b.__wrappedMethods || []), function (propName) {\n        if (b.hasOwnProperty(propName)) {\n            a[propName] = b[propName];\n        }\n    });\n\n    a.__wrappedMethods = b.__wrappedMethods;\n}\n\n\n\n\n\n\n/**\n * @constructor\n * @alias module:echarts/data/List\n *\n * @param {Array.<string|Object>} dimensions\n *      For example, ['someDimName', {name: 'someDimName', type: 'someDimType'}, ...].\n *      Dimensions should be concrete names like x, y, z, lng, lat, angle, radius\n *      Spetial fields: {\n *          ordinalMeta: <module:echarts/data/OrdinalMeta>\n *          createInvertedIndices: <boolean>\n *      }\n * @param {module:echarts/model/Model} hostModel\n */\nvar List = function (dimensions, hostModel) {\n\n    dimensions = dimensions || ['x', 'y'];\n\n    var dimensionInfos = {};\n    var dimensionNames = [];\n    var invertedIndicesMap = {};\n\n    for (var i = 0; i < dimensions.length; i++) {\n        // Use the original dimensions[i], where other flag props may exists.\n        var dimensionInfo = dimensions[i];\n\n        if (isString(dimensionInfo)) {\n            dimensionInfo = {name: dimensionInfo};\n        }\n\n        var dimensionName = dimensionInfo.name;\n        dimensionInfo.type = dimensionInfo.type || 'float';\n        if (!dimensionInfo.coordDim) {\n            dimensionInfo.coordDim = dimensionName;\n            dimensionInfo.coordDimIndex = 0;\n        }\n\n        dimensionInfo.otherDims = dimensionInfo.otherDims || {};\n        dimensionNames.push(dimensionName);\n        dimensionInfos[dimensionName] = dimensionInfo;\n\n        dimensionInfo.index = i;\n\n        if (dimensionInfo.createInvertedIndices) {\n            invertedIndicesMap[dimensionName] = [];\n        }\n    }\n\n    /**\n     * @readOnly\n     * @type {Array.<string>}\n     */\n    this.dimensions = dimensionNames;\n\n    /**\n     * Infomation of each data dimension, like data type.\n     * @type {Object}\n     */\n    this._dimensionInfos = dimensionInfos;\n\n    /**\n     * @type {module:echarts/model/Model}\n     */\n    this.hostModel = hostModel;\n\n    /**\n     * @type {module:echarts/model/Model}\n     */\n    this.dataType;\n\n    /**\n     * Indices stores the indices of data subset after filtered.\n     * This data subset will be used in chart.\n     * @type {Array.<number>}\n     * @readOnly\n     */\n    this._indices = null;\n\n    this._count = 0;\n    this._rawCount = 0;\n\n    /**\n     * Data storage\n     * @type {Object.<key, Array.<TypedArray|Array>>}\n     * @private\n     */\n    this._storage = {};\n\n    /**\n     * @type {Array.<string>}\n     */\n    this._nameList = [];\n    /**\n     * @type {Array.<string>}\n     */\n    this._idList = [];\n\n    /**\n     * Models of data option is stored sparse for optimizing memory cost\n     * @type {Array.<module:echarts/model/Model>}\n     * @private\n     */\n    this._optionModels = [];\n\n    /**\n     * Global visual properties after visual coding\n     * @type {Object}\n     * @private\n     */\n    this._visual = {};\n\n    /**\n     * Globel layout properties.\n     * @type {Object}\n     * @private\n     */\n    this._layout = {};\n\n    /**\n     * Item visual properties after visual coding\n     * @type {Array.<Object>}\n     * @private\n     */\n    this._itemVisuals = [];\n\n    /**\n     * Key: visual type, Value: boolean\n     * @type {Object}\n     * @readOnly\n     */\n    this.hasItemVisual = {};\n\n    /**\n     * Item layout properties after layout\n     * @type {Array.<Object>}\n     * @private\n     */\n    this._itemLayouts = [];\n\n    /**\n     * Graphic elemnents\n     * @type {Array.<module:zrender/Element>}\n     * @private\n     */\n    this._graphicEls = [];\n\n    /**\n     * Max size of each chunk.\n     * @type {number}\n     * @private\n     */\n    this._chunkSize = 1e5;\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this._chunkCount = 0;\n\n    /**\n     * @type {Array.<Array|Object>}\n     * @private\n     */\n    this._rawData;\n\n    /**\n     * Raw extent will not be cloned, but only transfered.\n     * It will not be calculated util needed.\n     * key: dim,\n     * value: {end: number, extent: Array.<number>}\n     * @type {Object}\n     * @private\n     */\n    this._rawExtent = {};\n\n    /**\n     * @type {Object}\n     * @private\n     */\n    this._extent = {};\n\n    /**\n     * key: dim\n     * value: extent\n     * @type {Object}\n     * @private\n     */\n    this._approximateExtent = {};\n\n    /**\n     * Cache summary info for fast visit. See \"dimensionHelper\".\n     * @type {Object}\n     * @private\n     */\n    this._dimensionsSummary = summarizeDimensions(this);\n\n    /**\n     * @type {Object.<Array|TypedArray>}\n     * @private\n     */\n    this._invertedIndicesMap = invertedIndicesMap;\n\n    /**\n     * @type {Object}\n     * @private\n     */\n    this._calculationInfo = {};\n};\n\nvar listProto = List.prototype;\n\nlistProto.type = 'list';\n\n/**\n * If each data item has it's own option\n * @type {boolean}\n */\nlistProto.hasItemOption = true;\n\n/**\n * Get dimension name\n * @param {string|number} dim\n *        Dimension can be concrete names like x, y, z, lng, lat, angle, radius\n *        Or a ordinal number. For example getDimensionInfo(0) will return 'x' or 'lng' or 'radius'\n * @return {string} Concrete dim name.\n */\nlistProto.getDimension = function (dim) {\n    if (!isNaN(dim)) {\n        dim = this.dimensions[dim] || dim;\n    }\n    return dim;\n};\n\n/**\n * Get type and calculation info of particular dimension\n * @param {string|number} dim\n *        Dimension can be concrete names like x, y, z, lng, lat, angle, radius\n *        Or a ordinal number. For example getDimensionInfo(0) will return 'x' or 'lng' or 'radius'\n */\nlistProto.getDimensionInfo = function (dim) {\n    // Do not clone, because there may be categories in dimInfo.\n    return this._dimensionInfos[this.getDimension(dim)];\n};\n\n/**\n * @return {Array.<string>} concrete dimension name list on coord.\n */\nlistProto.getDimensionsOnCoord = function () {\n    return this._dimensionsSummary.dataDimsOnCoord.slice();\n};\n\n/**\n * @param {string} coordDim\n * @param {number} [idx] A coordDim may map to more than one data dim.\n *        If idx is `true`, return a array of all mapped dims.\n *        If idx is not specified, return the first dim not extra.\n * @return {string|Array.<string>} concrete data dim.\n *        If idx is number, and not found, return null/undefined.\n *        If idx is `true`, and not found, return empty array (always return array).\n */\nlistProto.mapDimension = function (coordDim, idx) {\n    var dimensionsSummary = this._dimensionsSummary;\n\n    if (idx == null) {\n        return dimensionsSummary.encodeFirstDimNotExtra[coordDim];\n    }\n\n    var dims = dimensionsSummary.encode[coordDim];\n    return idx === true\n        // always return array if idx is `true`\n        ? (dims || []).slice()\n        : (dims && dims[idx]);\n};\n\n/**\n * Initialize from data\n * @param {Array.<Object|number|Array>} data source or data or data provider.\n * @param {Array.<string>} [nameLIst] The name of a datum is used on data diff and\n *        defualt label/tooltip.\n *        A name can be specified in encode.itemName,\n *        or dataItem.name (only for series option data),\n *        or provided in nameList from outside.\n * @param {Function} [dimValueGetter] (dataItem, dimName, dataIndex, dimIndex) => number\n */\nlistProto.initData = function (data, nameList, dimValueGetter) {\n\n    var notProvider = Source.isInstance(data) || isArrayLike(data);\n    if (notProvider) {\n        data = new DefaultDataProvider(data, this.dimensions.length);\n    }\n\n    if (__DEV__) {\n        if (!notProvider && (typeof data.getItem != 'function' || typeof data.count != 'function')) {\n            throw new Error('Inavlid data provider.');\n        }\n    }\n\n    this._rawData = data;\n\n    // Clear\n    this._storage = {};\n    this._indices = null;\n\n    this._nameList = nameList || [];\n\n    this._idList = [];\n\n    this._nameRepeatCount = {};\n\n    if (!dimValueGetter) {\n        this.hasItemOption = false;\n    }\n\n    /**\n     * @readOnly\n     */\n    this.defaultDimValueGetter = defaultDimValueGetters[\n        this._rawData.getSource().sourceFormat\n    ];\n\n    // Default dim value getter\n    this._dimValueGetter = dimValueGetter = dimValueGetter\n        || this.defaultDimValueGetter;\n\n    // Reset raw extent.\n    this._rawExtent = {};\n\n    this._initDataFromProvider(0, data.count());\n\n    // If data has no item option.\n    if (data.pure) {\n        this.hasItemOption = false;\n    }\n};\n\nlistProto.getProvider = function () {\n    return this._rawData;\n};\n\nlistProto.appendData = function (data) {\n    if (__DEV__) {\n        assert$1(!this._indices, 'appendData can only be called on raw data.');\n    }\n\n    var rawData = this._rawData;\n    var start = this.count();\n    rawData.appendData(data);\n    var end = rawData.count();\n    if (!rawData.persistent) {\n        end += start;\n    }\n    this._initDataFromProvider(start, end);\n};\n\nlistProto._initDataFromProvider = function (start, end) {\n    // Optimize.\n    if (start >= end) {\n        return;\n    }\n\n    var chunkSize = this._chunkSize;\n    var rawData = this._rawData;\n    var storage = this._storage;\n    var dimensions = this.dimensions;\n    var dimensionInfoMap = this._dimensionInfos;\n    var nameList = this._nameList;\n    var idList = this._idList;\n    var rawExtent = this._rawExtent;\n    var nameRepeatCount = this._nameRepeatCount = {};\n    var nameDimIdx;\n\n    var chunkCount = this._chunkCount;\n    var lastChunkIndex = chunkCount - 1;\n    for (var i = 0; i < dimensions.length; i++) {\n        var dim = dimensions[i];\n        if (!rawExtent[dim]) {\n            rawExtent[dim] = getInitialExtent();\n        }\n\n        var dimInfo = dimensionInfoMap[dim];\n        if (dimInfo.otherDims.itemName === 0) {\n            nameDimIdx = this._nameDimIdx = i;\n        }\n        if (dimInfo.otherDims.itemId === 0) {\n            this._idDimIdx = i;\n        }\n        var DataCtor = dataCtors[dimInfo.type];\n\n        if (!storage[dim]) {\n            storage[dim] = [];\n        }\n        var resizeChunkArray = storage[dim][lastChunkIndex];\n        if (resizeChunkArray && resizeChunkArray.length < chunkSize) {\n            var newStore = new DataCtor(Math.min(end - lastChunkIndex * chunkSize, chunkSize));\n            // The cost of the copy is probably inconsiderable\n            // within the initial chunkSize.\n            for (var j = 0; j < resizeChunkArray.length; j++) {\n                newStore[j] = resizeChunkArray[j];\n            }\n            storage[dim][lastChunkIndex] = newStore;\n        }\n\n        // Create new chunks.\n        for (var k = chunkCount * chunkSize; k < end; k += chunkSize) {\n            storage[dim].push(new DataCtor(Math.min(end - k, chunkSize)));\n        }\n        this._chunkCount = storage[dim].length;\n    }\n\n    for (var idx = start; idx < end; idx++) {\n        // NOTICE: Try not to write things into dataItem\n        var dataItem = rawData.getItem(idx);\n        // Each data item is value\n        // [1, 2]\n        // 2\n        // Bar chart, line chart which uses category axis\n        // only gives the 'y' value. 'x' value is the indices of category\n        // Use a tempValue to normalize the value to be a (x, y) value\n        var chunkIndex = Math.floor(idx / chunkSize);\n        var chunkOffset = idx % chunkSize;\n\n        // Store the data by dimensions\n        for (var k = 0; k < dimensions.length; k++) {\n            var dim = dimensions[k];\n            var dimStorage = storage[dim][chunkIndex];\n            // PENDING NULL is empty or zero\n            var val = this._dimValueGetter(dataItem, dim, idx, k);\n            dimStorage[chunkOffset] = val;\n\n            if (val < rawExtent[dim][0]) {\n                rawExtent[dim][0] = val;\n            }\n            if (val > rawExtent[dim][1]) {\n                rawExtent[dim][1] = val;\n            }\n        }\n\n        // ??? FIXME not check by pure but sourceFormat?\n        // TODO refactor these logic.\n        if (!rawData.pure) {\n            var name = nameList[idx];\n\n            if (dataItem && !name) {\n                if (nameDimIdx != null) {\n                    name = this._getNameFromStore(idx);\n                }\n                else if (dataItem.name != null) {\n                    // There is no other place to persistent dataItem.name,\n                    // so save it to nameList.\n                    nameList[idx] = name = dataItem.name;\n                }\n            }\n\n            // Try using the id in option\n            // id or name is used on dynamical data, mapping old and new items.\n            var id = dataItem == null ? null : dataItem.id;\n\n            if (id == null && name != null) {\n                // Use name as id and add counter to avoid same name\n                nameRepeatCount[name] = nameRepeatCount[name] || 0;\n                id = name;\n                if (nameRepeatCount[name] > 0) {\n                    id += '__ec__' + nameRepeatCount[name];\n                }\n                nameRepeatCount[name]++;\n            }\n            id != null && (idList[idx] = id);\n        }\n    }\n\n    if (!rawData.persistent && rawData.clean) {\n        // Clean unused data if data source is typed array.\n        rawData.clean();\n    }\n\n    this._rawCount = this._count = end;\n\n    // Reset data extent\n    this._extent = {};\n\n    prepareInvertedIndex(this);\n};\n\nfunction prepareInvertedIndex(list) {\n    var invertedIndicesMap = list._invertedIndicesMap;\n    each$1(invertedIndicesMap, function (invertedIndices, dim) {\n        var dimInfo = list._dimensionInfos[dim];\n\n        // Currently, only dimensions that has ordinalMeta can create inverted indices.\n        var ordinalMeta = dimInfo.ordinalMeta;\n        if (ordinalMeta) {\n            invertedIndices = invertedIndicesMap[dim] = new CtorUint32Array(\n                ordinalMeta.categories.length\n            );\n            // The default value of TypedArray is 0. To avoid miss\n            // mapping to 0, we should set it as NaN.\n            for (var i = 0; i < invertedIndices.length; i++) {\n                invertedIndices[i] = NaN;\n            }\n            for (var i = 0; i < list._count; i++) {\n                // Only support the case that all values are distinct.\n                invertedIndices[list.get(dim, i)] = i;\n            }\n        }\n    });\n}\n\n// TODO refactor\nlistProto._getNameFromStore = function (rawIndex) {\n    var nameDimIdx = this._nameDimIdx;\n    if (nameDimIdx != null) {\n        var chunkSize = this._chunkSize;\n        var chunkIndex = Math.floor(rawIndex / chunkSize);\n        var chunkOffset = rawIndex % chunkSize;\n        var dim = this.dimensions[nameDimIdx];\n        var ordinalMeta = this._dimensionInfos[dim].ordinalMeta;\n        if (ordinalMeta) {\n            return ordinalMeta.categories[rawIndex];\n        }\n        else {\n            var chunk = this._storage[dim][chunkIndex];\n            return chunk && chunk[chunkOffset];\n        }\n    }\n};\n\n// TODO refactor\nlistProto._getIdFromStore = function (rawIndex) {\n    var idDimIdx = this._idDimIdx;\n    if (idDimIdx != null) {\n        var chunkSize = this._chunkSize;\n        var chunkIndex = Math.floor(rawIndex / chunkSize);\n        var chunkOffset = rawIndex % chunkSize;\n        var dim = this.dimensions[idDimIdx];\n        var ordinalMeta = this._dimensionInfos[dim].ordinalMeta;\n        if (ordinalMeta) {\n            return ordinalMeta.categories[rawIndex];\n        }\n        else {\n            var chunk = this._storage[dim][chunkIndex];\n            return chunk && chunk[chunkOffset];\n        }\n    }\n};\n\n/**\n * @return {number}\n */\nlistProto.count = function () {\n    return this._count;\n};\n\nlistProto.getIndices = function () {\n    if (this._indices) {\n        var Ctor = this._indices.constructor;\n        return new Ctor(this._indices.buffer, 0, this._count);\n    }\n\n    var Ctor = getIndicesCtor(this);\n    var arr = new Ctor(this.count());\n    for (var i = 0; i < arr.length; i++) {\n        arr[i] = i;\n    }\n    return arr;\n};\n\n/**\n * Get value. Return NaN if idx is out of range.\n * @param {string} dim Dim must be concrete name.\n * @param {number} idx\n * @param {boolean} stack\n * @return {number}\n */\nlistProto.get = function (dim, idx /*, stack */) {\n    if (!(idx >= 0 && idx < this._count)) {\n        return NaN;\n    }\n    var storage = this._storage;\n    if (!storage[dim]) {\n        // TODO Warn ?\n        return NaN;\n    }\n\n    idx = this.getRawIndex(idx);\n\n    var chunkIndex = Math.floor(idx / this._chunkSize);\n    var chunkOffset = idx % this._chunkSize;\n\n    var chunkStore = storage[dim][chunkIndex];\n    var value = chunkStore[chunkOffset];\n    // FIXME ordinal data type is not stackable\n    // if (stack) {\n    //     var dimensionInfo = this._dimensionInfos[dim];\n    //     if (dimensionInfo && dimensionInfo.stackable) {\n    //         var stackedOn = this.stackedOn;\n    //         while (stackedOn) {\n    //             // Get no stacked data of stacked on\n    //             var stackedValue = stackedOn.get(dim, idx);\n    //             // Considering positive stack, negative stack and empty data\n    //             if ((value >= 0 && stackedValue > 0)  // Positive stack\n    //                 || (value <= 0 && stackedValue < 0) // Negative stack\n    //             ) {\n    //                 value += stackedValue;\n    //             }\n    //             stackedOn = stackedOn.stackedOn;\n    //         }\n    //     }\n    // }\n\n    return value;\n};\n\n/**\n * @param {string} dim concrete dim\n * @param {number} rawIndex\n * @return {number|string}\n */\nlistProto.getByRawIndex = function (dim, rawIdx) {\n    if (!(rawIdx >= 0 && rawIdx < this._rawCount)) {\n        return NaN;\n    }\n    var dimStore = this._storage[dim];\n    if (!dimStore) {\n        // TODO Warn ?\n        return NaN;\n    }\n\n    var chunkIndex = Math.floor(rawIdx / this._chunkSize);\n    var chunkOffset = rawIdx % this._chunkSize;\n    var chunkStore = dimStore[chunkIndex];\n    return chunkStore[chunkOffset];\n};\n\n/**\n * FIXME Use `get` on chrome maybe slow(in filterSelf and selectRange).\n * Hack a much simpler _getFast\n * @private\n */\nlistProto._getFast = function (dim, rawIdx) {\n    var chunkIndex = Math.floor(rawIdx / this._chunkSize);\n    var chunkOffset = rawIdx % this._chunkSize;\n    var chunkStore = this._storage[dim][chunkIndex];\n    return chunkStore[chunkOffset];\n};\n\n/**\n * Get value for multi dimensions.\n * @param {Array.<string>} [dimensions] If ignored, using all dimensions.\n * @param {number} idx\n * @return {number}\n */\nlistProto.getValues = function (dimensions, idx /*, stack */) {\n    var values = [];\n\n    if (!isArray(dimensions)) {\n        // stack = idx;\n        idx = dimensions;\n        dimensions = this.dimensions;\n    }\n\n    for (var i = 0, len = dimensions.length; i < len; i++) {\n        values.push(this.get(dimensions[i], idx /*, stack */));\n    }\n\n    return values;\n};\n\n/**\n * If value is NaN. Inlcuding '-'\n * Only check the coord dimensions.\n * @param {string} dim\n * @param {number} idx\n * @return {number}\n */\nlistProto.hasValue = function (idx) {\n    var dataDimsOnCoord = this._dimensionsSummary.dataDimsOnCoord;\n    var dimensionInfos = this._dimensionInfos;\n    for (var i = 0, len = dataDimsOnCoord.length; i < len; i++) {\n        if (\n            // Ordinal type can be string or number\n            dimensionInfos[dataDimsOnCoord[i]].type !== 'ordinal'\n            // FIXME check ordinal when using index?\n            && isNaN(this.get(dataDimsOnCoord[i], idx))\n        ) {\n            return false;\n        }\n    }\n    return true;\n};\n\n/**\n * Get extent of data in one dimension\n * @param {string} dim\n * @param {boolean} stack\n */\nlistProto.getDataExtent = function (dim /*, stack */) {\n    // Make sure use concrete dim as cache name.\n    dim = this.getDimension(dim);\n    var dimData = this._storage[dim];\n    var initialExtent = getInitialExtent();\n\n    // stack = !!((stack || false) && this.getCalculationInfo(dim));\n\n    if (!dimData) {\n        return initialExtent;\n    }\n\n    // Make more strict checkings to ensure hitting cache.\n    var currEnd = this.count();\n    // var cacheName = [dim, !!stack].join('_');\n    // var cacheName = dim;\n\n    // Consider the most cases when using data zoom, `getDataExtent`\n    // happened before filtering. We cache raw extent, which is not\n    // necessary to be cleared and recalculated when restore data.\n    var useRaw = !this._indices; // && !stack;\n    var dimExtent;\n\n    if (useRaw) {\n        return this._rawExtent[dim].slice();\n    }\n    dimExtent = this._extent[dim];\n    if (dimExtent) {\n        return dimExtent.slice();\n    }\n    dimExtent = initialExtent;\n\n    var min = dimExtent[0];\n    var max = dimExtent[1];\n\n    for (var i = 0; i < currEnd; i++) {\n        // var value = stack ? this.get(dim, i, true) : this._getFast(dim, this.getRawIndex(i));\n        var value = this._getFast(dim, this.getRawIndex(i));\n        value < min && (min = value);\n        value > max && (max = value);\n    }\n\n    dimExtent = [min, max];\n\n    this._extent[dim] = dimExtent;\n\n    return dimExtent;\n};\n\n/**\n * Optimize for the scenario that data is filtered by a given extent.\n * Consider that if data amount is more than hundreds of thousand,\n * extent calculation will cost more than 10ms and the cache will\n * be erased because of the filtering.\n */\nlistProto.getApproximateExtent = function (dim /*, stack */) {\n    dim = this.getDimension(dim);\n    return this._approximateExtent[dim] || this.getDataExtent(dim /*, stack */);\n};\n\nlistProto.setApproximateExtent = function (extent, dim /*, stack */) {\n    dim = this.getDimension(dim);\n    this._approximateExtent[dim] = extent.slice();\n};\n\n/**\n * @param {string} key\n * @return {*}\n */\nlistProto.getCalculationInfo = function (key) {\n    return this._calculationInfo[key];\n};\n\n/**\n * @param {string|Object} key or k-v object\n * @param {*} [value]\n */\nlistProto.setCalculationInfo = function (key, value) {\n    isObject$4(key)\n        ? extend(this._calculationInfo, key)\n        : (this._calculationInfo[key] = value);\n};\n\n/**\n * Get sum of data in one dimension\n * @param {string} dim\n */\nlistProto.getSum = function (dim /*, stack */) {\n    var dimData = this._storage[dim];\n    var sum = 0;\n    if (dimData) {\n        for (var i = 0, len = this.count(); i < len; i++) {\n            var value = this.get(dim, i /*, stack */);\n            if (!isNaN(value)) {\n                sum += value;\n            }\n        }\n    }\n    return sum;\n};\n\n// /**\n//  * Retreive the index with given value\n//  * @param {string} dim Concrete dimension.\n//  * @param {number} value\n//  * @return {number}\n//  */\n// Currently incorrect: should return dataIndex but not rawIndex.\n// Do not fix it until this method is to be used somewhere.\n// FIXME Precision of float value\n// listProto.indexOf = function (dim, value) {\n//     var storage = this._storage;\n//     var dimData = storage[dim];\n//     var chunkSize = this._chunkSize;\n//     if (dimData) {\n//         for (var i = 0, len = this.count(); i < len; i++) {\n//             var chunkIndex = Math.floor(i / chunkSize);\n//             var chunkOffset = i % chunkSize;\n//             if (dimData[chunkIndex][chunkOffset] === value) {\n//                 return i;\n//             }\n//         }\n//     }\n//     return -1;\n// };\n\n/**\n * Only support the dimension which inverted index created.\n * Do not support other cases until required.\n * @param {string} concrete dim\n * @param {number|string} value\n * @return {number} rawIndex\n */\nlistProto.rawIndexOf = function (dim, value) {\n    var invertedIndices = dim && this._invertedIndicesMap[dim];\n    if (__DEV__) {\n        if (!invertedIndices) {\n            throw new Error('Do not supported yet');\n        }\n    }\n    var rawIndex = invertedIndices[value];\n    if (rawIndex == null || isNaN(rawIndex)) {\n        return -1;\n    }\n    return rawIndex;\n};\n\n/**\n * Retreive the index with given name\n * @param {number} idx\n * @param {number} name\n * @return {number}\n */\nlistProto.indexOfName = function (name) {\n    for (var i = 0, len = this.count(); i < len; i++) {\n        if (this.getName(i) === name) {\n            return i;\n        }\n    }\n\n    return -1;\n};\n\n/**\n * Retreive the index with given raw data index\n * @param {number} idx\n * @param {number} name\n * @return {number}\n */\nlistProto.indexOfRawIndex = function (rawIndex) {\n    if (!this._indices) {\n        return rawIndex;\n    }\n\n    if (rawIndex >= this._rawCount || rawIndex < 0) {\n        return -1;\n    }\n\n    // Indices are ascending\n    var indices = this._indices;\n\n    // If rawIndex === dataIndex\n    var rawDataIndex = indices[rawIndex];\n    if (rawDataIndex != null && rawDataIndex < this._count && rawDataIndex === rawIndex) {\n        return rawIndex;\n    }\n\n    var left = 0;\n    var right = this._count - 1;\n    while (left <= right) {\n        var mid = (left + right) / 2 | 0;\n        if (indices[mid] < rawIndex) {\n            left = mid + 1;\n        }\n        else if (indices[mid] > rawIndex) {\n            right = mid - 1;\n        }\n        else {\n            return mid;\n        }\n    }\n    return -1;\n};\n\n/**\n * Retreive the index of nearest value\n * @param {string} dim\n * @param {number} value\n * @param {number} [maxDistance=Infinity]\n * @return {Array.<number>} Considere multiple points has the same value.\n */\nlistProto.indicesOfNearest = function (dim, value, maxDistance) {\n    var storage = this._storage;\n    var dimData = storage[dim];\n    var nearestIndices = [];\n\n    if (!dimData) {\n        return nearestIndices;\n    }\n\n    if (maxDistance == null) {\n        maxDistance = Infinity;\n    }\n\n    var minDist = Number.MAX_VALUE;\n    var minDiff = -1;\n    for (var i = 0, len = this.count(); i < len; i++) {\n        var diff = value - this.get(dim, i /*, stack */);\n        var dist = Math.abs(diff);\n        if (diff <= maxDistance && dist <= minDist) {\n            // For the case of two data are same on xAxis, which has sequence data.\n            // Show the nearest index\n            // https://github.com/ecomfe/echarts/issues/2869\n            if (dist < minDist || (diff >= 0 && minDiff < 0)) {\n                minDist = dist;\n                minDiff = diff;\n                nearestIndices.length = 0;\n            }\n            nearestIndices.push(i);\n        }\n    }\n    return nearestIndices;\n};\n\n/**\n * Get raw data index\n * @param {number} idx\n * @return {number}\n */\nlistProto.getRawIndex = getRawIndexWithoutIndices;\n\nfunction getRawIndexWithoutIndices(idx) {\n    return idx;\n}\n\nfunction getRawIndexWithIndices(idx) {\n    if (idx < this._count && idx >= 0) {\n        return this._indices[idx];\n    }\n    return -1;\n}\n\n/**\n * Get raw data item\n * @param {number} idx\n * @return {number}\n */\nlistProto.getRawDataItem = function (idx) {\n    if (!this._rawData.persistent) {\n        var val = [];\n        for (var i = 0; i < this.dimensions.length; i++) {\n            var dim = this.dimensions[i];\n            val.push(this.get(dim, idx));\n        }\n        return val;\n    }\n    else {\n        return this._rawData.getItem(this.getRawIndex(idx));\n    }\n};\n\n/**\n * @param {number} idx\n * @param {boolean} [notDefaultIdx=false]\n * @return {string}\n */\nlistProto.getName = function (idx) {\n    var rawIndex = this.getRawIndex(idx);\n    return this._nameList[rawIndex]\n        || this._getNameFromStore(rawIndex)\n        || '';\n};\n\n/**\n * @param {number} idx\n * @param {boolean} [notDefaultIdx=false]\n * @return {string}\n */\nlistProto.getId = function (idx) {\n    return getId(this, this.getRawIndex(idx));\n};\n\nfunction getId(list, rawIndex) {\n    var id = list._idList[rawIndex];\n    if (id == null) {\n        id = list._getIdFromStore(rawIndex);\n    }\n    if (id == null) {\n        // FIXME Check the usage in graph, should not use prefix.\n        id = ID_PREFIX + rawIndex;\n    }\n    return id;\n}\n\nfunction normalizeDimensions(dimensions) {\n    if (!isArray(dimensions)) {\n        dimensions = [dimensions];\n    }\n    return dimensions;\n}\n\nfunction validateDimensions(list, dims) {\n    for (var i = 0; i < dims.length; i++) {\n        // stroage may be empty when no data, so use\n        // dimensionInfos to check.\n        if (!list._dimensionInfos[dims[i]]) {\n            console.error('Unkown dimension ' + dims[i]);\n        }\n    }\n}\n\n/**\n * Data iteration\n * @param {string|Array.<string>}\n * @param {Function} cb\n * @param {*} [context=this]\n *\n * @example\n *  list.each('x', function (x, idx) {});\n *  list.each(['x', 'y'], function (x, y, idx) {});\n *  list.each(function (idx) {})\n */\nlistProto.each = function (dims, cb, context, contextCompat) {\n    'use strict';\n\n    if (!this._count) {\n        return;\n    }\n\n    if (typeof dims === 'function') {\n        contextCompat = context;\n        context = cb;\n        cb = dims;\n        dims = [];\n    }\n\n    // contextCompat just for compat echarts3\n    context = context || contextCompat || this;\n\n    dims = map(normalizeDimensions(dims), this.getDimension, this);\n\n    if (__DEV__) {\n        validateDimensions(this, dims);\n    }\n\n    var dimSize = dims.length;\n\n    for (var i = 0; i < this.count(); i++) {\n        // Simple optimization\n        switch (dimSize) {\n            case 0:\n                cb.call(context, i);\n                break;\n            case 1:\n                cb.call(context, this.get(dims[0], i), i);\n                break;\n            case 2:\n                cb.call(context, this.get(dims[0], i), this.get(dims[1], i), i);\n                break;\n            default:\n                var k = 0;\n                var value = [];\n                for (; k < dimSize; k++) {\n                    value[k] = this.get(dims[k], i);\n                }\n                // Index\n                value[k] = i;\n                cb.apply(context, value);\n        }\n    }\n};\n\n/**\n * Data filter\n * @param {string|Array.<string>}\n * @param {Function} cb\n * @param {*} [context=this]\n */\nlistProto.filterSelf = function (dimensions, cb, context, contextCompat) {\n    'use strict';\n\n    if (!this._count) {\n        return;\n    }\n\n    if (typeof dimensions === 'function') {\n        contextCompat = context;\n        context = cb;\n        cb = dimensions;\n        dimensions = [];\n    }\n\n    // contextCompat just for compat echarts3\n    context = context || contextCompat || this;\n\n    dimensions = map(\n        normalizeDimensions(dimensions), this.getDimension, this\n    );\n\n    if (__DEV__) {\n        validateDimensions(this, dimensions);\n    }\n\n\n    var count = this.count();\n    var Ctor = getIndicesCtor(this);\n    var newIndices = new Ctor(count);\n    var value = [];\n    var dimSize = dimensions.length;\n\n    var offset = 0;\n    var dim0 = dimensions[0];\n\n    for (var i = 0; i < count; i++) {\n        var keep;\n        var rawIdx = this.getRawIndex(i);\n        // Simple optimization\n        if (dimSize === 0) {\n            keep = cb.call(context, i);\n        }\n        else if (dimSize === 1) {\n            var val = this._getFast(dim0, rawIdx);\n            keep = cb.call(context, val, i);\n        }\n        else {\n            for (var k = 0; k < dimSize; k++) {\n                value[k] = this._getFast(dim0, rawIdx);\n            }\n            value[k] = i;\n            keep = cb.apply(context, value);\n        }\n        if (keep) {\n            newIndices[offset++] = rawIdx;\n        }\n    }\n\n    // Set indices after filtered.\n    if (offset < count) {\n        this._indices = newIndices;\n    }\n    this._count = offset;\n    // Reset data extent\n    this._extent = {};\n\n    this.getRawIndex = this._indices ? getRawIndexWithIndices : getRawIndexWithoutIndices;\n\n    return this;\n};\n\n/**\n * Select data in range. (For optimization of filter)\n * (Manually inline code, support 5 million data filtering in data zoom.)\n */\nlistProto.selectRange = function (range /*, stack */) {\n    'use strict';\n\n    if (!this._count) {\n        return;\n    }\n\n    // stack = stack || false;\n\n    var dimensions = [];\n    for (var dim in range) {\n        if (range.hasOwnProperty(dim)) {\n            dimensions.push(dim);\n        }\n    }\n\n    if (__DEV__) {\n        validateDimensions(this, dimensions);\n    }\n\n    var dimSize = dimensions.length;\n    if (!dimSize) {\n        return;\n    }\n\n    var originalCount = this.count();\n    var Ctor = getIndicesCtor(this);\n    var newIndices = new Ctor(originalCount);\n\n    var offset = 0;\n    var dim0 = dimensions[0];\n\n    var min = range[dim0][0];\n    var max = range[dim0][1];\n\n    var quickFinished = false;\n    if (!this._indices /* && !stack */) {\n        // Extreme optimization for common case. About 2x faster in chrome.\n        var idx = 0;\n        if (dimSize === 1) {\n            var dimStorage = this._storage[dimensions[0]];\n            for (var k = 0; k < this._chunkCount; k++) {\n                var chunkStorage = dimStorage[k];\n                var len = Math.min(this._count - k * this._chunkSize, this._chunkSize);\n                for (var i = 0; i < len; i++) {\n                    var val = chunkStorage[i];\n                    if (val >= min && val <= max) {\n                        newIndices[offset++] = idx;\n                    }\n                    idx++;\n                }\n            }\n            quickFinished = true;\n        }\n        else if (dimSize === 2) {\n            var dimStorage = this._storage[dim0];\n            var dimStorage2 = this._storage[dimensions[1]];\n            var min2 = range[dimensions[1]][0];\n            var max2 = range[dimensions[1]][1];\n            for (var k = 0; k < this._chunkCount; k++) {\n                var chunkStorage = dimStorage[k];\n                var chunkStorage2= dimStorage2[k];\n                var len = Math.min(this._count - k * this._chunkSize, this._chunkSize);\n                for (var i = 0; i < len; i++) {\n                    var val = chunkStorage[i];\n                    var val2 = chunkStorage2[i];\n                    if (val >= min && val <= max && val2 >= min2 && val2 <= max2) {\n                        newIndices[offset++] = idx;\n                    }\n                    idx++;\n                }\n            }\n            quickFinished = true;\n        }\n    }\n    if (!quickFinished) {\n        if (dimSize === 1) {\n            // stack = stack || !!this.getCalculationInfo(dim0);\n            for (var i = 0; i < originalCount; i++) {\n                var rawIndex = this.getRawIndex(i);\n                // var val = stack ? this.get(dim0, i, true) : this._getFast(dim0, rawIndex);\n                var val = this._getFast(dim0, rawIndex);\n                if (val >= min && val <= max) {\n                    newIndices[offset++] = rawIndex;\n                }\n            }\n        }\n        else {\n            for (var i = 0; i < originalCount; i++) {\n                var keep = true;\n                var rawIndex = this.getRawIndex(i);\n                for (var k = 0; k < dimSize; k++) {\n                    var dimk = dimensions[k];\n                    // var val = stack ? this.get(dimk, i, true) : this._getFast(dim, rawIndex);\n                    var val = this._getFast(dim, rawIndex);\n                    if (val < range[dimk][0] || val > range[dimk][1]) {\n                        keep = false;\n                    }\n                }\n                if (keep) {\n                    newIndices[offset++] = this.getRawIndex(i);\n                }\n            }\n        }\n    }\n\n    // Set indices after filtered.\n    if (offset < originalCount) {\n        this._indices = newIndices;\n    }\n    this._count = offset;\n    // Reset data extent\n    this._extent = {};\n\n    this.getRawIndex = this._indices ? getRawIndexWithIndices : getRawIndexWithoutIndices;\n\n    return this;\n};\n\n/**\n * Data mapping to a plain array\n * @param {string|Array.<string>} [dimensions]\n * @param {Function} cb\n * @param {*} [context=this]\n * @return {Array}\n */\nlistProto.mapArray = function (dimensions, cb, context, contextCompat) {\n    'use strict';\n\n    if (typeof dimensions === 'function') {\n        contextCompat = context;\n        context = cb;\n        cb = dimensions;\n        dimensions = [];\n    }\n\n    // contextCompat just for compat echarts3\n    context = context || contextCompat || this;\n\n    var result = [];\n    this.each(dimensions, function () {\n        result.push(cb && cb.apply(this, arguments));\n    }, context);\n    return result;\n};\n\n// Data in excludeDimensions is copied, otherwise transfered.\nfunction cloneListForMapAndSample(original, excludeDimensions) {\n    var allDimensions = original.dimensions;\n    var list = new List(\n        map(allDimensions, original.getDimensionInfo, original),\n        original.hostModel\n    );\n    // FIXME If needs stackedOn, value may already been stacked\n    transferProperties(list, original);\n\n    var storage = list._storage = {};\n    var originalStorage = original._storage;\n    var rawExtent = extend({}, original._rawExtent);\n\n    // Init storage\n    for (var i = 0; i < allDimensions.length; i++) {\n        var dim = allDimensions[i];\n        if (originalStorage[dim]) {\n            if (indexOf(excludeDimensions, dim) >= 0) {\n                storage[dim] = cloneDimStore(originalStorage[dim]);\n                rawExtent[dim] = getInitialExtent();\n            }\n            else {\n                // Direct reference for other dimensions\n                storage[dim] = originalStorage[dim];\n            }\n        }\n    }\n    return list;\n}\n\nfunction cloneDimStore(originalDimStore) {\n    var newDimStore = new Array(originalDimStore.length);\n    for (var j = 0; j < originalDimStore.length; j++) {\n        newDimStore[j] = cloneChunk(originalDimStore[j]);\n    }\n    return newDimStore;\n}\n\nfunction getInitialExtent() {\n    return [Infinity, -Infinity];\n}\n\n/**\n * Data mapping to a new List with given dimensions\n * @param {string|Array.<string>} dimensions\n * @param {Function} cb\n * @param {*} [context=this]\n * @return {Array}\n */\nlistProto.map = function (dimensions, cb, context, contextCompat) {\n    'use strict';\n\n    // contextCompat just for compat echarts3\n    context = context || contextCompat || this;\n\n    dimensions = map(\n        normalizeDimensions(dimensions), this.getDimension, this\n    );\n\n    if (__DEV__) {\n        validateDimensions(this, dimensions);\n    }\n\n    var list = cloneListForMapAndSample(this, dimensions);\n\n    // Following properties are all immutable.\n    // So we can reference to the same value\n    list._indices = this._indices;\n    list.getRawIndex = list._indices ? getRawIndexWithIndices : getRawIndexWithoutIndices;\n\n    var storage = list._storage;\n\n    var tmpRetValue = [];\n    var chunkSize = this._chunkSize;\n    var dimSize = dimensions.length;\n    var dataCount = this.count();\n    var values = [];\n    var rawExtent = list._rawExtent;\n\n    for (var dataIndex = 0; dataIndex < dataCount; dataIndex++) {\n        for (var dimIndex = 0; dimIndex < dimSize; dimIndex++) {\n            values[dimIndex] = this.get(dimensions[dimIndex], dataIndex /*, stack */);\n        }\n        values[dimSize] = dataIndex;\n\n        var retValue = cb && cb.apply(context, values);\n        if (retValue != null) {\n            // a number or string (in oridinal dimension)?\n            if (typeof retValue !== 'object') {\n                tmpRetValue[0] = retValue;\n                retValue = tmpRetValue;\n            }\n\n            var rawIndex = this.getRawIndex(dataIndex);\n            var chunkIndex = Math.floor(rawIndex / chunkSize);\n            var chunkOffset = rawIndex % chunkSize;\n\n            for (var i = 0; i < retValue.length; i++) {\n                var dim = dimensions[i];\n                var val = retValue[i];\n                var rawExtentOnDim = rawExtent[dim];\n\n                var dimStore = storage[dim];\n                if (dimStore) {\n                    dimStore[chunkIndex][chunkOffset] = val;\n                }\n\n                if (val < rawExtentOnDim[0]) {\n                    rawExtentOnDim[0] = val;\n                }\n                if (val > rawExtentOnDim[1]) {\n                    rawExtentOnDim[1] = val;\n                }\n            }\n        }\n    }\n\n    return list;\n};\n\n/**\n * Large data down sampling on given dimension\n * @param {string} dimension\n * @param {number} rate\n * @param {Function} sampleValue\n * @param {Function} sampleIndex Sample index for name and id\n */\nlistProto.downSample = function (dimension, rate, sampleValue, sampleIndex) {\n    var list = cloneListForMapAndSample(this, [dimension]);\n    var targetStorage = list._storage;\n\n    var frameValues = [];\n    var frameSize = Math.floor(1 / rate);\n\n    var dimStore = targetStorage[dimension];\n    var len = this.count();\n    var chunkSize = this._chunkSize;\n    var rawExtentOnDim = list._rawExtent[dimension];\n\n    var newIndices = new (getIndicesCtor(this))(len);\n\n    var offset = 0;\n    for (var i = 0; i < len; i += frameSize) {\n        // Last frame\n        if (frameSize > len - i) {\n            frameSize = len - i;\n            frameValues.length = frameSize;\n        }\n        for (var k = 0; k < frameSize; k++) {\n            var dataIdx = this.getRawIndex(i + k);\n            var originalChunkIndex = Math.floor(dataIdx / chunkSize);\n            var originalChunkOffset = dataIdx % chunkSize;\n            frameValues[k] = dimStore[originalChunkIndex][originalChunkOffset];\n        }\n        var value = sampleValue(frameValues);\n        var sampleFrameIdx = this.getRawIndex(\n            Math.min(i + sampleIndex(frameValues, value) || 0, len - 1)\n        );\n        var sampleChunkIndex = Math.floor(sampleFrameIdx / chunkSize);\n        var sampleChunkOffset = sampleFrameIdx % chunkSize;\n        // Only write value on the filtered data\n        dimStore[sampleChunkIndex][sampleChunkOffset] = value;\n\n        if (value < rawExtentOnDim[0]) {\n            rawExtentOnDim[0] = value;\n        }\n        if (value > rawExtentOnDim[1]) {\n            rawExtentOnDim[1] = value;\n        }\n\n        newIndices[offset++] = sampleFrameIdx;\n    }\n\n    list._count = offset;\n    list._indices = newIndices;\n\n    list.getRawIndex = getRawIndexWithIndices;\n\n    return list;\n};\n\n/**\n * Get model of one data item.\n *\n * @param {number} idx\n */\n// FIXME Model proxy ?\nlistProto.getItemModel = function (idx) {\n    var hostModel = this.hostModel;\n    return new Model(this.getRawDataItem(idx), hostModel, hostModel && hostModel.ecModel);\n};\n\n/**\n * Create a data differ\n * @param {module:echarts/data/List} otherList\n * @return {module:echarts/data/DataDiffer}\n */\nlistProto.diff = function (otherList) {\n    var thisList = this;\n\n    return new DataDiffer(\n        otherList ? otherList.getIndices() : [],\n        this.getIndices(),\n        function (idx) {\n            return getId(otherList, idx);\n        },\n        function (idx) {\n            return getId(thisList, idx);\n        }\n    );\n};\n/**\n * Get visual property.\n * @param {string} key\n */\nlistProto.getVisual = function (key) {\n    var visual = this._visual;\n    return visual && visual[key];\n};\n\n/**\n * Set visual property\n * @param {string|Object} key\n * @param {*} [value]\n *\n * @example\n *  setVisual('color', color);\n *  setVisual({\n *      'color': color\n *  });\n */\nlistProto.setVisual = function (key, val) {\n    if (isObject$4(key)) {\n        for (var name in key) {\n            if (key.hasOwnProperty(name)) {\n                this.setVisual(name, key[name]);\n            }\n        }\n        return;\n    }\n    this._visual = this._visual || {};\n    this._visual[key] = val;\n};\n\n/**\n * Set layout property.\n * @param {string|Object} key\n * @param {*} [val]\n */\nlistProto.setLayout = function (key, val) {\n    if (isObject$4(key)) {\n        for (var name in key) {\n            if (key.hasOwnProperty(name)) {\n                this.setLayout(name, key[name]);\n            }\n        }\n        return;\n    }\n    this._layout[key] = val;\n};\n\n/**\n * Get layout property.\n * @param  {string} key.\n * @return {*}\n */\nlistProto.getLayout = function (key) {\n    return this._layout[key];\n};\n\n/**\n * Get layout of single data item\n * @param {number} idx\n */\nlistProto.getItemLayout = function (idx) {\n    return this._itemLayouts[idx];\n};\n\n/**\n * Set layout of single data item\n * @param {number} idx\n * @param {Object} layout\n * @param {boolean=} [merge=false]\n */\nlistProto.setItemLayout = function (idx, layout, merge$$1) {\n    this._itemLayouts[idx] = merge$$1\n        ? extend(this._itemLayouts[idx] || {}, layout)\n        : layout;\n};\n\n/**\n * Clear all layout of single data item\n */\nlistProto.clearItemLayouts = function () {\n    this._itemLayouts.length = 0;\n};\n\n/**\n * Get visual property of single data item\n * @param {number} idx\n * @param {string} key\n * @param {boolean} [ignoreParent=false]\n */\nlistProto.getItemVisual = function (idx, key, ignoreParent) {\n    var itemVisual = this._itemVisuals[idx];\n    var val = itemVisual && itemVisual[key];\n    if (val == null && !ignoreParent) {\n        // Use global visual property\n        return this.getVisual(key);\n    }\n    return val;\n};\n\n/**\n * Set visual property of single data item\n *\n * @param {number} idx\n * @param {string|Object} key\n * @param {*} [value]\n *\n * @example\n *  setItemVisual(0, 'color', color);\n *  setItemVisual(0, {\n *      'color': color\n *  });\n */\nlistProto.setItemVisual = function (idx, key, value) {\n    var itemVisual = this._itemVisuals[idx] || {};\n    var hasItemVisual = this.hasItemVisual;\n    this._itemVisuals[idx] = itemVisual;\n\n    if (isObject$4(key)) {\n        for (var name in key) {\n            if (key.hasOwnProperty(name)) {\n                itemVisual[name] = key[name];\n                hasItemVisual[name] = true;\n            }\n        }\n        return;\n    }\n    itemVisual[key] = value;\n    hasItemVisual[key] = true;\n};\n\n/**\n * Clear itemVisuals and list visual.\n */\nlistProto.clearAllVisual = function () {\n    this._visual = {};\n    this._itemVisuals = [];\n    this.hasItemVisual = {};\n};\n\nvar setItemDataAndSeriesIndex = function (child) {\n    child.seriesIndex = this.seriesIndex;\n    child.dataIndex = this.dataIndex;\n    child.dataType = this.dataType;\n};\n/**\n * Set graphic element relative to data. It can be set as null\n * @param {number} idx\n * @param {module:zrender/Element} [el]\n */\nlistProto.setItemGraphicEl = function (idx, el) {\n    var hostModel = this.hostModel;\n\n    if (el) {\n        // Add data index and series index for indexing the data by element\n        // Useful in tooltip\n        el.dataIndex = idx;\n        el.dataType = this.dataType;\n        el.seriesIndex = hostModel && hostModel.seriesIndex;\n        if (el.type === 'group') {\n            el.traverse(setItemDataAndSeriesIndex, el);\n        }\n    }\n\n    this._graphicEls[idx] = el;\n};\n\n/**\n * @param {number} idx\n * @return {module:zrender/Element}\n */\nlistProto.getItemGraphicEl = function (idx) {\n    return this._graphicEls[idx];\n};\n\n/**\n * @param {Function} cb\n * @param {*} context\n */\nlistProto.eachItemGraphicEl = function (cb, context) {\n    each$1(this._graphicEls, function (el, idx) {\n        if (el) {\n            cb && cb.call(context, el, idx);\n        }\n    });\n};\n\n/**\n * Shallow clone a new list except visual and layout properties, and graph elements.\n * New list only change the indices.\n */\nlistProto.cloneShallow = function (list) {\n    if (!list) {\n        var dimensionInfoList = map(this.dimensions, this.getDimensionInfo, this);\n        list = new List(dimensionInfoList, this.hostModel);\n    }\n\n    // FIXME\n    list._storage = this._storage;\n\n    transferProperties(list, this);\n\n    // Clone will not change the data extent and indices\n    if (this._indices) {\n        var Ctor = this._indices.constructor;\n        list._indices = new Ctor(this._indices);\n    }\n    else {\n        list._indices = null;\n    }\n    list.getRawIndex = list._indices ? getRawIndexWithIndices : getRawIndexWithoutIndices;\n\n    list._extent = clone(this._extent);\n    list._approximateExtent = clone(this._approximateExtent);\n\n    return list;\n};\n\n/**\n * Wrap some method to add more feature\n * @param {string} methodName\n * @param {Function} injectFunction\n */\nlistProto.wrapMethod = function (methodName, injectFunction) {\n    var originalMethod = this[methodName];\n    if (typeof originalMethod !== 'function') {\n        return;\n    }\n    this.__wrappedMethods = this.__wrappedMethods || [];\n    this.__wrappedMethods.push(methodName);\n    this[methodName] = function () {\n        var res = originalMethod.apply(this, arguments);\n        return injectFunction.apply(this, [res].concat(slice(arguments)));\n    };\n};\n\n// Methods that create a new list based on this list should be listed here.\n// Notice that those method should `RETURN` the new list.\nlistProto.TRANSFERABLE_METHODS = ['cloneShallow', 'downSample', 'map'];\n// Methods that change indices of this list should be listed here.\nlistProto.CHANGABLE_METHODS = ['filterSelf', 'selectRange'];\n\n/**\n * @deprecated\n * Use `echarts/data/helper/createDimensions` instead.\n */\n\n/**\n * @see {module:echarts/test/ut/spec/data/completeDimensions}\n *\n * Complete the dimensions array, by user defined `dimension` and `encode`,\n * and guessing from the data structure.\n * If no 'value' dimension specified, the first no-named dimension will be\n * named as 'value'.\n *\n * @param {Array.<string>} sysDims Necessary dimensions, like ['x', 'y'], which\n *      provides not only dim template, but also default order.\n *      properties: 'name', 'type', 'displayName'.\n *      `name` of each item provides default coord name.\n *      [{dimsDef: [string...]}, ...] dimsDef of sysDim item provides default dim name, and\n *                                    provide dims count that the sysDim required.\n *      [{ordinalMeta}] can be specified.\n * @param {module:echarts/data/Source|Array|Object} source or data (for compatibal with pervious)\n * @param {Object} [opt]\n * @param {Array.<Object|string>} [opt.dimsDef] option.series.dimensions User defined dimensions\n *      For example: ['asdf', {name, type}, ...].\n * @param {Object|HashMap} [opt.encodeDef] option.series.encode {x: 2, y: [3, 1], tooltip: [1, 2], label: 3}\n * @param {string} [opt.generateCoord] Generate coord dim with the given name.\n *                 If not specified, extra dim names will be:\n *                 'value', 'value0', 'value1', ...\n * @param {number} [opt.generateCoordCount] By default, the generated dim name is `generateCoord`.\n *                 If `generateCoordCount` specified, the generated dim names will be:\n *                 `generateCoord` + 0, `generateCoord` + 1, ...\n *                 can be Infinity, indicate that use all of the remain columns.\n * @param {number} [opt.dimCount] If not specified, guess by the first data item.\n * @param {number} [opt.encodeDefaulter] If not specified, auto find the next available data dim.\n * @return {Array.<Object>} [{\n *      name: string mandatory,\n *      displayName: string, the origin name in dimsDef, see source helper.\n *                 If displayName given, the tooltip will displayed vertically.\n *      coordDim: string mandatory,\n *      coordDimIndex: number mandatory,\n *      type: string optional,\n *      otherDims: { never null/undefined\n *          tooltip: number optional,\n *          label: number optional,\n *          itemName: number optional,\n *          seriesName: number optional,\n *      },\n *      isExtraCoord: boolean true if coord is generated\n *          (not specified in encode and not series specified)\n *      other props ...\n * }]\n */\nfunction completeDimensions(sysDims, source, opt) {\n    if (!Source.isInstance(source)) {\n        source = Source.seriesDataToSource(source);\n    }\n\n    opt = opt || {};\n    sysDims = (sysDims || []).slice();\n    var dimsDef = (opt.dimsDef || []).slice();\n    var encodeDef = createHashMap(opt.encodeDef);\n    var dataDimNameMap = createHashMap();\n    var coordDimNameMap = createHashMap();\n    // var valueCandidate;\n    var result = [];\n\n    var dimCount = getDimCount(source, sysDims, dimsDef, opt.dimCount);\n\n    // Apply user defined dims (`name` and `type`) and init result.\n    for (var i = 0; i < dimCount; i++) {\n        var dimDefItem = dimsDef[i] = extend(\n            {}, isObject$1(dimsDef[i]) ? dimsDef[i] : {name: dimsDef[i]}\n        );\n        var userDimName = dimDefItem.name;\n        var resultItem = result[i] = {otherDims: {}};\n        // Name will be applied later for avoiding duplication.\n        if (userDimName != null && dataDimNameMap.get(userDimName) == null) {\n            // Only if `series.dimensions` is defined in option\n            // displayName, will be set, and dimension will be diplayed vertically in\n            // tooltip by default.\n            resultItem.name = resultItem.displayName = userDimName;\n            dataDimNameMap.set(userDimName, i);\n        }\n        dimDefItem.type != null && (resultItem.type = dimDefItem.type);\n        dimDefItem.displayName != null && (resultItem.displayName = dimDefItem.displayName);\n    }\n\n    // Set `coordDim` and `coordDimIndex` by `encodeDef` and normalize `encodeDef`.\n    encodeDef.each(function (dataDims, coordDim) {\n        dataDims = normalizeToArray(dataDims).slice();\n        var validDataDims = encodeDef.set(coordDim, []);\n        each$1(dataDims, function (resultDimIdx, idx) {\n            // The input resultDimIdx can be dim name or index.\n            isString(resultDimIdx) && (resultDimIdx = dataDimNameMap.get(resultDimIdx));\n            if (resultDimIdx != null && resultDimIdx < dimCount) {\n                validDataDims[idx] = resultDimIdx;\n                applyDim(result[resultDimIdx], coordDim, idx);\n            }\n        });\n    });\n\n    // Apply templetes and default order from `sysDims`.\n    var availDimIdx = 0;\n    each$1(sysDims, function (sysDimItem, sysDimIndex) {\n        var coordDim;\n        var sysDimItem;\n        var sysDimItemDimsDef;\n        var sysDimItemOtherDims;\n        if (isString(sysDimItem)) {\n            coordDim = sysDimItem;\n            sysDimItem = {};\n        }\n        else {\n            coordDim = sysDimItem.name;\n            var ordinalMeta = sysDimItem.ordinalMeta;\n            sysDimItem.ordinalMeta = null;\n            sysDimItem = clone(sysDimItem);\n            sysDimItem.ordinalMeta = ordinalMeta;\n            // `coordDimIndex` should not be set directly.\n            sysDimItemDimsDef = sysDimItem.dimsDef;\n            sysDimItemOtherDims = sysDimItem.otherDims;\n            sysDimItem.name = sysDimItem.coordDim = sysDimItem.coordDimIndex\n                = sysDimItem.dimsDef = sysDimItem.otherDims = null;\n        }\n\n        var dataDims = normalizeToArray(encodeDef.get(coordDim));\n        // dimensions provides default dim sequences.\n        if (!dataDims.length) {\n            for (var i = 0; i < (sysDimItemDimsDef && sysDimItemDimsDef.length || 1); i++) {\n                while (availDimIdx < result.length && result[availDimIdx].coordDim != null) {\n                    availDimIdx++;\n                }\n                availDimIdx < result.length && dataDims.push(availDimIdx++);\n            }\n        }\n\n        // Apply templates.\n        each$1(dataDims, function (resultDimIdx, coordDimIndex) {\n            var resultItem = result[resultDimIdx];\n            applyDim(defaults(resultItem, sysDimItem), coordDim, coordDimIndex);\n            if (resultItem.name == null && sysDimItemDimsDef) {\n                resultItem.name = resultItem.displayName = sysDimItemDimsDef[coordDimIndex];\n            }\n            // FIXME refactor, currently only used in case: {otherDims: {tooltip: false}}\n            sysDimItemOtherDims && defaults(resultItem.otherDims, sysDimItemOtherDims);\n        });\n    });\n\n    function applyDim(resultItem, coordDim, coordDimIndex) {\n        if (OTHER_DIMENSIONS.get(coordDim) != null) {\n            resultItem.otherDims[coordDim] = coordDimIndex;\n        }\n        else {\n            resultItem.coordDim = coordDim;\n            resultItem.coordDimIndex = coordDimIndex;\n            coordDimNameMap.set(coordDim, true);\n        }\n    }\n\n    // Make sure the first extra dim is 'value'.\n    var generateCoord = opt.generateCoord;\n    var generateCoordCount = opt.generateCoordCount;\n    var fromZero = generateCoordCount != null;\n    generateCoordCount = generateCoord ? (generateCoordCount || 1) : 0;\n    var extra = generateCoord || 'value';\n\n    // Set dim `name` and other `coordDim` and other props.\n    for (var resultDimIdx = 0; resultDimIdx < dimCount; resultDimIdx++) {\n        var resultItem = result[resultDimIdx] = result[resultDimIdx] || {};\n        var coordDim = resultItem.coordDim;\n\n        if (coordDim == null) {\n            resultItem.coordDim = genName(\n                extra, coordDimNameMap, fromZero\n            );\n            resultItem.coordDimIndex = 0;\n            if (!generateCoord || generateCoordCount <= 0) {\n                resultItem.isExtraCoord = true;\n            }\n            generateCoordCount--;\n        }\n\n        resultItem.name == null && (resultItem.name = genName(\n            resultItem.coordDim,\n            dataDimNameMap\n        ));\n\n        if (resultItem.type == null && guessOrdinal(source, resultDimIdx, resultItem.name)) {\n            resultItem.type = 'ordinal';\n        }\n    }\n\n    return result;\n}\n\n// ??? TODO\n// Originally detect dimCount by data[0]. Should we\n// optimize it to only by sysDims and dimensions and encode.\n// So only necessary dims will be initialized.\n// But\n// (1) custom series should be considered. where other dims\n// may be visited.\n// (2) sometimes user need to calcualte bubble size or use visualMap\n// on other dimensions besides coordSys needed.\n// So, dims that is not used by system, should be shared in storage?\nfunction getDimCount(source, sysDims, dimsDef, optDimCount) {\n    // Note that the result dimCount should not small than columns count\n    // of data, otherwise `dataDimNameMap` checking will be incorrect.\n    var dimCount = Math.max(\n        source.dimensionsDetectCount || 1,\n        sysDims.length,\n        dimsDef.length,\n        optDimCount || 0\n    );\n    each$1(sysDims, function (sysDimItem) {\n        var sysDimItemDimsDef = sysDimItem.dimsDef;\n        sysDimItemDimsDef && (dimCount = Math.max(dimCount, sysDimItemDimsDef.length));\n    });\n    return dimCount;\n}\n\nfunction genName(name, map$$1, fromZero) {\n    if (fromZero || map$$1.get(name) != null) {\n        var i = 0;\n        while (map$$1.get(name + i) != null) {\n            i++;\n        }\n        name += i;\n    }\n    map$$1.set(name, true);\n    return name;\n}\n\n/**\n * Substitute `completeDimensions`.\n * `completeDimensions` is to be deprecated.\n */\n/**\n * @param {module:echarts/data/Source|module:echarts/data/List} source or data.\n * @param {Object|Array} [opt]\n * @param {Array.<string|Object>} [opt.coordDimensions=[]]\n * @param {number} [opt.dimensionsCount]\n * @param {string} [opt.generateCoord]\n * @param {string} [opt.generateCoordCount]\n * @param {Array.<string|Object>} [opt.dimensionsDefine=source.dimensionsDefine] Overwrite source define.\n * @param {Object|HashMap} [opt.encodeDefine=source.encodeDefine] Overwrite source define.\n * @return {Array.<Object>} dimensionsInfo\n */\nvar createDimensions = function (source, opt) {\n    opt = opt || {};\n    return completeDimensions(opt.coordDimensions || [], source, {\n        dimsDef: opt.dimensionsDefine || source.dimensionsDefine,\n        encodeDef: opt.encodeDefine || source.encodeDefine,\n        dimCount: opt.dimensionsCount,\n        generateCoord: opt.generateCoord,\n        generateCoordCount: opt.generateCoordCount\n    });\n};\n\n/**\n * Note that it is too complicated to support 3d stack by value\n * (have to create two-dimension inverted index), so in 3d case\n * we just support that stacked by index.\n *\n * @param {module:echarts/model/Series} seriesModel\n * @param {Array.<string|Object>} dimensionInfoList The same as the input of <module:echarts/data/List>.\n *        The input dimensionInfoList will be modified.\n * @param {Object} [opt]\n * @param {boolean} [opt.stackedCoordDimension=''] Specify a coord dimension if needed.\n * @param {boolean} [opt.byIndex=false]\n * @return {Object} calculationInfo\n * {\n *     stackedDimension: string\n *     stackedByDimension: string\n *     isStackedByIndex: boolean\n *     stackedOverDimension: string\n *     stackResultDimension: string\n * }\n */\nfunction enableDataStack(seriesModel, dimensionInfoList, opt) {\n    opt = opt || {};\n    var byIndex = opt.byIndex;\n    var stackedCoordDimension = opt.stackedCoordDimension;\n\n    // Compatibal: when `stack` is set as '', do not stack.\n    var mayStack = !!(seriesModel && seriesModel.get('stack'));\n    var stackedByDimInfo;\n    var stackedDimInfo;\n    var stackResultDimension;\n    var stackedOverDimension;\n\n    each$1(dimensionInfoList, function (dimensionInfo, index) {\n        if (isString(dimensionInfo)) {\n            dimensionInfoList[index] = dimensionInfo = {name: dimensionInfo};\n        }\n\n        if (mayStack && !dimensionInfo.isExtraCoord) {\n            // Find the first ordinal dimension as the stackedByDimInfo.\n            if (!byIndex && !stackedByDimInfo && dimensionInfo.ordinalMeta) {\n                stackedByDimInfo = dimensionInfo;\n            }\n            // Find the first stackable dimension as the stackedDimInfo.\n            if (!stackedDimInfo\n                && dimensionInfo.type !== 'ordinal'\n                && dimensionInfo.type !== 'time'\n                && (!stackedCoordDimension || stackedCoordDimension === dimensionInfo.coordDim)\n            ) {\n                stackedDimInfo = dimensionInfo;\n            }\n        }\n    });\n\n    // Add stack dimension, they can be both calculated by coordinate system in `unionExtent`.\n    // That put stack logic in List is for using conveniently in echarts extensions, but it\n    // might not be a good way.\n    if (stackedDimInfo && (byIndex || stackedByDimInfo)) {\n        // Use a weird name that not duplicated with other names.\n        stackResultDimension = '__\\0ecstackresult';\n        stackedOverDimension = '__\\0ecstackedover';\n\n        // Create inverted index to fast query index by value.\n        if (stackedByDimInfo) {\n            stackedByDimInfo.createInvertedIndices = true;\n        }\n\n        var stackedDimCoordDim = stackedDimInfo.coordDim;\n        var stackedDimType = stackedDimInfo.type;\n        var stackedDimCoordIndex = 0;\n\n        each$1(dimensionInfoList, function (dimensionInfo) {\n            if (dimensionInfo.coordDim === stackedDimCoordDim) {\n                stackedDimCoordIndex++;\n            }\n        });\n\n        dimensionInfoList.push({\n            name: stackResultDimension,\n            coordDim: stackedDimCoordDim,\n            coordDimIndex: stackedDimCoordIndex,\n            type: stackedDimType,\n            isExtraCoord: true,\n            isCalculationCoord: true\n        });\n\n        stackedDimCoordIndex++;\n\n        dimensionInfoList.push({\n            name: stackedOverDimension,\n            // This dimension contains stack base (generally, 0), so do not set it as\n            // `stackedDimCoordDim` to avoid extent calculation, consider log scale.\n            coordDim: stackedOverDimension,\n            coordDimIndex: stackedDimCoordIndex,\n            type: stackedDimType,\n            isExtraCoord: true,\n            isCalculationCoord: true\n        });\n    }\n\n    return {\n        stackedDimension: stackedDimInfo && stackedDimInfo.name,\n        stackedByDimension: stackedByDimInfo && stackedByDimInfo.name,\n        isStackedByIndex: byIndex,\n        stackedOverDimension: stackedOverDimension,\n        stackResultDimension: stackResultDimension\n    };\n}\n\n/**\n * @param {module:echarts/data/List} data\n * @param {string} stackedDim\n * @param {string} [stackedByDim] If not input this parameter, check whether\n *                                stacked by index.\n */\nfunction isDimensionStacked(data, stackedDim, stackedByDim) {\n    return stackedDim\n        && stackedDim === data.getCalculationInfo('stackedDimension')\n        && (\n            stackedByDim != null\n                ? stackedByDim === data.getCalculationInfo('stackedByDimension')\n                : data.getCalculationInfo('isStackedByIndex')\n        );\n}\n\n/**\n * @param {module:echarts/data/Source|Array} source Or raw data.\n * @param {module:echarts/model/Series} seriesModel\n * @param {Object} [opt]\n * @param {string} [opt.generateCoord]\n */\nfunction createListFromArray(source, seriesModel, opt) {\n    opt = opt || {};\n\n    if (!Source.isInstance(source)) {\n        source = Source.seriesDataToSource(source);\n    }\n\n    var coordSysName = seriesModel.get('coordinateSystem');\n    var registeredCoordSys = CoordinateSystemManager.get(coordSysName);\n\n    var coordSysDefine = getCoordSysDefineBySeries(seriesModel);\n\n    var coordSysDimDefs;\n\n    if (coordSysDefine) {\n        coordSysDimDefs = map(coordSysDefine.coordSysDims, function (dim) {\n            var dimInfo = {name: dim};\n            var axisModel = coordSysDefine.axisMap.get(dim);\n            if (axisModel) {\n                var axisType = axisModel.get('type');\n                dimInfo.type = getDimensionTypeByAxis(axisType);\n                // dimInfo.stackable = isStackable(axisType);\n            }\n            return dimInfo;\n        });\n    }\n\n    if (!coordSysDimDefs) {\n        // Get dimensions from registered coordinate system\n        coordSysDimDefs = (registeredCoordSys && (\n            registeredCoordSys.getDimensionsInfo\n                ? registeredCoordSys.getDimensionsInfo()\n                : registeredCoordSys.dimensions.slice()\n        )) || ['x', 'y'];\n    }\n\n    var dimInfoList = createDimensions(source, {\n        coordDimensions: coordSysDimDefs,\n        generateCoord: opt.generateCoord\n    });\n\n    var firstCategoryDimIndex;\n    var hasNameEncode;\n    coordSysDefine && each$1(dimInfoList, function (dimInfo, dimIndex) {\n        var coordDim = dimInfo.coordDim;\n        var categoryAxisModel = coordSysDefine.categoryAxisMap.get(coordDim);\n        if (categoryAxisModel) {\n            if (firstCategoryDimIndex == null) {\n                firstCategoryDimIndex = dimIndex;\n            }\n            dimInfo.ordinalMeta = categoryAxisModel.getOrdinalMeta();\n        }\n        if (dimInfo.otherDims.itemName != null) {\n            hasNameEncode = true;\n        }\n    });\n    if (!hasNameEncode && firstCategoryDimIndex != null) {\n        dimInfoList[firstCategoryDimIndex].otherDims.itemName = 0;\n    }\n\n    var stackCalculationInfo = enableDataStack(seriesModel, dimInfoList);\n\n    var list = new List(dimInfoList, seriesModel);\n\n    list.setCalculationInfo(stackCalculationInfo);\n\n    var dimValueGetter = (firstCategoryDimIndex != null && isNeedCompleteOrdinalData(source))\n        ? function (itemOpt, dimName, dataIndex, dimIndex) {\n            // Use dataIndex as ordinal value in categoryAxis\n            return dimIndex === firstCategoryDimIndex\n                ? dataIndex\n                : this.defaultDimValueGetter(itemOpt, dimName, dataIndex, dimIndex);\n        }\n        : null;\n\n    list.hasItemOption = false;\n    list.initData(source, null, dimValueGetter);\n\n    return list;\n}\n\nfunction isNeedCompleteOrdinalData(source) {\n    if (source.sourceFormat === SOURCE_FORMAT_ORIGINAL) {\n        var sampleItem = firstDataNotNull(source.data || []);\n        return sampleItem != null\n            && !isArray(getDataItemValue(sampleItem));\n    }\n}\n\nfunction firstDataNotNull(data) {\n    var i = 0;\n    while (i < data.length && data[i] == null) {\n        i++;\n    }\n    return data[i];\n}\n\n/**\n * // Scale class management\n * @module echarts/scale/Scale\n */\n\n/**\n * @param {Object} [setting]\n */\nfunction Scale(setting) {\n    this._setting = setting || {};\n\n    /**\n     * Extent\n     * @type {Array.<number>}\n     * @protected\n     */\n    this._extent = [Infinity, -Infinity];\n\n    /**\n     * Step is calculated in adjustExtent\n     * @type {Array.<number>}\n     * @protected\n     */\n    this._interval = 0;\n\n    this.init && this.init.apply(this, arguments);\n}\n\n/**\n * Parse input val to valid inner number.\n * @param {*} val\n * @return {number}\n */\nScale.prototype.parse = function (val) {\n    // Notice: This would be a trap here, If the implementation\n    // of this method depends on extent, and this method is used\n    // before extent set (like in dataZoom), it would be wrong.\n    // Nevertheless, parse does not depend on extent generally.\n    return val;\n};\n\nScale.prototype.getSetting = function (name) {\n    return this._setting[name];\n};\n\nScale.prototype.contain = function (val) {\n    var extent = this._extent;\n    return val >= extent[0] && val <= extent[1];\n};\n\n/**\n * Normalize value to linear [0, 1], return 0.5 if extent span is 0\n * @param {number} val\n * @return {number}\n */\nScale.prototype.normalize = function (val) {\n    var extent = this._extent;\n    if (extent[1] === extent[0]) {\n        return 0.5;\n    }\n    return (val - extent[0]) / (extent[1] - extent[0]);\n};\n\n/**\n * Scale normalized value\n * @param {number} val\n * @return {number}\n */\nScale.prototype.scale = function (val) {\n    var extent = this._extent;\n    return val * (extent[1] - extent[0]) + extent[0];\n};\n\n/**\n * Set extent from data\n * @param {Array.<number>} other\n */\nScale.prototype.unionExtent = function (other) {\n    var extent = this._extent;\n    other[0] < extent[0] && (extent[0] = other[0]);\n    other[1] > extent[1] && (extent[1] = other[1]);\n    // not setExtent because in log axis it may transformed to power\n    // this.setExtent(extent[0], extent[1]);\n};\n\n/**\n * Set extent from data\n * @param {module:echarts/data/List} data\n * @param {string} dim\n */\nScale.prototype.unionExtentFromData = function (data, dim) {\n    this.unionExtent(data.getApproximateExtent(dim));\n};\n\n/**\n * Get extent\n * @return {Array.<number>}\n */\nScale.prototype.getExtent = function () {\n    return this._extent.slice();\n};\n\n/**\n * Set extent\n * @param {number} start\n * @param {number} end\n */\nScale.prototype.setExtent = function (start, end) {\n    var thisExtent = this._extent;\n    if (!isNaN(start)) {\n        thisExtent[0] = start;\n    }\n    if (!isNaN(end)) {\n        thisExtent[1] = end;\n    }\n};\n\n/**\n * @return {Array.<string>}\n */\nScale.prototype.getTicksLabels = function () {\n    var labels = [];\n    var ticks = this.getTicks();\n    for (var i = 0; i < ticks.length; i++) {\n        labels.push(this.getLabel(ticks[i]));\n    }\n    return labels;\n};\n\n/**\n * When axis extent depends on data and no data exists,\n * axis ticks should not be drawn, which is named 'blank'.\n */\nScale.prototype.isBlank = function () {\n    return this._isBlank;\n},\n\n/**\n * When axis extent depends on data and no data exists,\n * axis ticks should not be drawn, which is named 'blank'.\n */\nScale.prototype.setBlank = function (isBlank) {\n    this._isBlank = isBlank;\n};\n\n\nenableClassExtend(Scale);\nenableClassManagement(Scale, {\n    registerWhenExtend: true\n});\n\n/**\n * @constructor\n * @param {Object} [opt]\n * @param {Object} [opt.categories=[]]\n * @param {Object} [opt.needCollect=false]\n * @param {Object} [opt.deduplication=false]\n */\nfunction OrdinalMeta(opt) {\n\n    /**\n     * @readOnly\n     * @type {Array.<string>}\n     */\n    this.categories = opt.categories || [];\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this._needCollect = opt.needCollect;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this._deduplication = opt.deduplication;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this._map;\n}\n\n/**\n * @param {module:echarts/model/Model} axisModel\n * @return {module:echarts/data/OrdinalMeta}\n */\nOrdinalMeta.createByAxisModel = function (axisModel) {\n    var option = axisModel.option;\n    var data = option.data;\n    var categories = data && map(data, getName);\n\n    return new OrdinalMeta({\n        categories: categories,\n        needCollect: !categories,\n        // deduplication is default in axis.\n        deduplication: option.dedplication !== false\n    });\n};\n\nvar proto$1 = OrdinalMeta.prototype;\n\n/**\n * @param {string} category\n * @return {number} ordinal\n */\nproto$1.getOrdinal = function (category) {\n    return getOrCreateMap(this).get(category);\n};\n\n/**\n * @param {*} category\n * @return {number} The ordinal. If not found, return NaN.\n */\nproto$1.parseAndCollect = function (category) {\n    var index;\n    var needCollect = this._needCollect;\n\n    // The value of category dim can be the index of the given category set.\n    // This feature is only supported when !needCollect, because we should\n    // consider a common case: a value is 2017, which is a number but is\n    // expected to be tread as a category. This case usually happen in dataset,\n    // where it happent to be no need of the index feature.\n    if (typeof category !== 'string' && !needCollect) {\n        return category;\n    }\n\n    // Optimize for the scenario:\n    // category is ['2012-01-01', '2012-01-02', ...], where the input\n    // data has been ensured not duplicate and is large data.\n    // Notice, if a dataset dimension provide categroies, usually echarts\n    // should remove duplication except user tell echarts dont do that\n    // (set axis.deduplication = false), because echarts do not know whether\n    // the values in the category dimension has duplication (consider the\n    // parallel-aqi example)\n    if (needCollect && !this._deduplication) {\n        index = this.categories.length;\n        this.categories[index] = category;\n        return index;\n    }\n\n    var map$$1 = getOrCreateMap(this);\n    index = map$$1.get(category);\n\n    if (index == null) {\n        if (needCollect) {\n            index = this.categories.length;\n            this.categories[index] = category;\n            map$$1.set(category, index);\n        }\n        else {\n            index = NaN;\n        }\n    }\n\n    return index;\n};\n\n// Consider big data, do not create map until needed.\nfunction getOrCreateMap(ordinalMeta) {\n    return ordinalMeta._map || (\n        ordinalMeta._map = createHashMap(ordinalMeta.categories)\n    );\n}\n\nfunction getName(obj) {\n    if (isObject$1(obj) && obj.value != null) {\n        return obj.value;\n    }\n    else {\n        return obj + '';\n    }\n}\n\n/**\n * Linear continuous scale\n * @module echarts/coord/scale/Ordinal\n *\n * http://en.wikipedia.org/wiki/Level_of_measurement\n */\n\n// FIXME only one data\n\nvar scaleProto = Scale.prototype;\n\nvar OrdinalScale = Scale.extend({\n\n    type: 'ordinal',\n\n    /**\n     * @param {module:echarts/data/OrdianlMeta|Array.<string>} ordinalMeta\n     */\n    init: function (ordinalMeta, extent) {\n        // Caution: Should not use instanceof, consider ec-extensions using\n        // import approach to get OrdinalMeta class.\n        if (!ordinalMeta || isArray(ordinalMeta)) {\n            ordinalMeta = new OrdinalMeta({categories: ordinalMeta});\n        }\n        this._ordinalMeta = ordinalMeta;\n        this._extent = extent || [0, ordinalMeta.categories.length - 1];\n    },\n\n    parse: function (val) {\n        return typeof val === 'string'\n            ? this._ordinalMeta.getOrdinal(val)\n            // val might be float.\n            : Math.round(val);\n    },\n\n    contain: function (rank) {\n        rank = this.parse(rank);\n        return scaleProto.contain.call(this, rank)\n            && this._ordinalMeta.categories[rank] != null;\n    },\n\n    /**\n     * Normalize given rank or name to linear [0, 1]\n     * @param {number|string} [val]\n     * @return {number}\n     */\n    normalize: function (val) {\n        return scaleProto.normalize.call(this, this.parse(val));\n    },\n\n    scale: function (val) {\n        return Math.round(scaleProto.scale.call(this, val));\n    },\n\n    /**\n     * @return {Array}\n     */\n    getTicks: function () {\n        var ticks = [];\n        var extent = this._extent;\n        var rank = extent[0];\n\n        while (rank <= extent[1]) {\n            ticks.push(rank);\n            rank++;\n        }\n\n        return ticks;\n    },\n\n    /**\n     * Get item on rank n\n     * @param {number} n\n     * @return {string}\n     */\n    getLabel: function (n) {\n        return this._ordinalMeta.categories[n];\n    },\n\n    /**\n     * @return {number}\n     */\n    count: function () {\n        return this._extent[1] - this._extent[0] + 1;\n    },\n\n    /**\n     * @override\n     */\n    unionExtentFromData: function (data, dim) {\n        this.unionExtent(data.getApproximateExtent(dim));\n    },\n\n    niceTicks: noop,\n    niceExtent: noop\n});\n\n/**\n * @return {module:echarts/scale/Time}\n */\nOrdinalScale.create = function () {\n    return new OrdinalScale();\n};\n\n/**\n * For testable.\n */\n\nvar roundNumber$1 = round$1;\n\n/**\n * @param {Array.<number>} extent Both extent[0] and extent[1] should be valid number.\n *                                Should be extent[0] < extent[1].\n * @param {number} splitNumber splitNumber should be >= 1.\n * @param {number} [minInterval]\n * @param {number} [maxInterval]\n * @return {Object} {interval, intervalPrecision, niceTickExtent}\n */\nfunction intervalScaleNiceTicks(extent, splitNumber, minInterval, maxInterval) {\n    var result = {};\n    var span = extent[1] - extent[0];\n\n    var interval = result.interval = nice(span / splitNumber, true);\n    if (minInterval != null && interval < minInterval) {\n        interval = result.interval = minInterval;\n    }\n    if (maxInterval != null && interval > maxInterval) {\n        interval = result.interval = maxInterval;\n    }\n    // Tow more digital for tick.\n    var precision = result.intervalPrecision = getIntervalPrecision(interval);\n    // Niced extent inside original extent\n    var niceTickExtent = result.niceTickExtent = [\n        roundNumber$1(Math.ceil(extent[0] / interval) * interval, precision),\n        roundNumber$1(Math.floor(extent[1] / interval) * interval, precision)\n    ];\n\n    fixExtent(niceTickExtent, extent);\n\n    return result;\n}\n\n/**\n * @param {number} interval\n * @return {number} interval precision\n */\nfunction getIntervalPrecision(interval) {\n    // Tow more digital for tick.\n    return getPrecisionSafe(interval) + 2;\n}\n\nfunction clamp(niceTickExtent, idx, extent) {\n    niceTickExtent[idx] = Math.max(Math.min(niceTickExtent[idx], extent[1]), extent[0]);\n}\n\n// In some cases (e.g., splitNumber is 1), niceTickExtent may be out of extent.\nfunction fixExtent(niceTickExtent, extent) {\n    !isFinite(niceTickExtent[0]) && (niceTickExtent[0] = extent[0]);\n    !isFinite(niceTickExtent[1]) && (niceTickExtent[1] = extent[1]);\n    clamp(niceTickExtent, 0, extent);\n    clamp(niceTickExtent, 1, extent);\n    if (niceTickExtent[0] > niceTickExtent[1]) {\n        niceTickExtent[0] = niceTickExtent[1];\n    }\n}\n\nfunction intervalScaleGetTicks(interval, extent, niceTickExtent, intervalPrecision) {\n    var ticks = [];\n\n    // If interval is 0, return [];\n    if (!interval) {\n        return ticks;\n    }\n\n    // Consider this case: using dataZoom toolbox, zoom and zoom.\n    var safeLimit = 10000;\n\n    if (extent[0] < niceTickExtent[0]) {\n        ticks.push(extent[0]);\n    }\n    var tick = niceTickExtent[0];\n\n    while (tick <= niceTickExtent[1]) {\n        ticks.push(tick);\n        // Avoid rounding error\n        tick = roundNumber$1(tick + interval, intervalPrecision);\n        if (tick === ticks[ticks.length - 1]) {\n            // Consider out of safe float point, e.g.,\n            // -3711126.9907707 + 2e-10 === -3711126.9907707\n            break;\n        }\n        if (ticks.length > safeLimit) {\n            return [];\n        }\n    }\n    // Consider this case: the last item of ticks is smaller\n    // than niceTickExtent[1] and niceTickExtent[1] === extent[1].\n    if (extent[1] > (ticks.length ? ticks[ticks.length - 1] : niceTickExtent[1])) {\n        ticks.push(extent[1]);\n    }\n\n    return ticks;\n}\n\n/**\n * Interval scale\n * @module echarts/scale/Interval\n */\n\n\nvar roundNumber = round$1;\n\n/**\n * @alias module:echarts/coord/scale/Interval\n * @constructor\n */\nvar IntervalScale = Scale.extend({\n\n    type: 'interval',\n\n    _interval: 0,\n\n    _intervalPrecision: 2,\n\n    setExtent: function (start, end) {\n        var thisExtent = this._extent;\n        //start,end may be a Number like '25',so...\n        if (!isNaN(start)) {\n            thisExtent[0] = parseFloat(start);\n        }\n        if (!isNaN(end)) {\n            thisExtent[1] = parseFloat(end);\n        }\n    },\n\n    unionExtent: function (other) {\n        var extent = this._extent;\n        other[0] < extent[0] && (extent[0] = other[0]);\n        other[1] > extent[1] && (extent[1] = other[1]);\n\n        // unionExtent may called by it's sub classes\n        IntervalScale.prototype.setExtent.call(this, extent[0], extent[1]);\n    },\n    /**\n     * Get interval\n     */\n    getInterval: function () {\n        return this._interval;\n    },\n\n    /**\n     * Set interval\n     */\n    setInterval: function (interval) {\n        this._interval = interval;\n        // Dropped auto calculated niceExtent and use user setted extent\n        // We assume user wan't to set both interval, min, max to get a better result\n        this._niceExtent = this._extent.slice();\n\n        this._intervalPrecision = getIntervalPrecision(interval);\n    },\n\n    /**\n     * @return {Array.<number>}\n     */\n    getTicks: function () {\n        return intervalScaleGetTicks(\n            this._interval, this._extent, this._niceExtent, this._intervalPrecision\n        );\n    },\n\n    /**\n     * @return {Array.<string>}\n     */\n    getTicksLabels: function () {\n        var labels = [];\n        var ticks = this.getTicks();\n        for (var i = 0; i < ticks.length; i++) {\n            labels.push(this.getLabel(ticks[i]));\n        }\n        return labels;\n    },\n\n    /**\n     * @param {number} data\n     * @param {Object} [opt]\n     * @param {number|string} [opt.precision] If 'auto', use nice presision.\n     * @param {boolean} [opt.pad] returns 1.50 but not 1.5 if precision is 2.\n     * @return {string}\n     */\n    getLabel: function (data, opt) {\n        if (data == null) {\n            return '';\n        }\n\n        var precision = opt && opt.precision;\n\n        if (precision == null) {\n            precision = getPrecisionSafe(data) || 0;\n        }\n        else if (precision === 'auto') {\n            // Should be more precise then tick.\n            precision = this._intervalPrecision;\n        }\n\n        // (1) If `precision` is set, 12.005 should be display as '12.00500'.\n        // (2) Use roundNumber (toFixed) to avoid scientific notation like '3.5e-7'.\n        data = roundNumber(data, precision, true);\n\n        return addCommas(data);\n    },\n\n    /**\n     * Update interval and extent of intervals for nice ticks\n     *\n     * @param {number} [splitNumber = 5] Desired number of ticks\n     * @param {number} [minInterval]\n     * @param {number} [maxInterval]\n     */\n    niceTicks: function (splitNumber, minInterval, maxInterval) {\n        splitNumber = splitNumber || 5;\n        var extent = this._extent;\n        var span = extent[1] - extent[0];\n        if (!isFinite(span)) {\n            return;\n        }\n        // User may set axis min 0 and data are all negative\n        // FIXME If it needs to reverse ?\n        if (span < 0) {\n            span = -span;\n            extent.reverse();\n        }\n\n        var result = intervalScaleNiceTicks(\n            extent, splitNumber, minInterval, maxInterval\n        );\n\n        this._intervalPrecision = result.intervalPrecision;\n        this._interval = result.interval;\n        this._niceExtent = result.niceTickExtent;\n    },\n\n    /**\n     * Nice extent.\n     * @param {Object} opt\n     * @param {number} [opt.splitNumber = 5] Given approx tick number\n     * @param {boolean} [opt.fixMin=false]\n     * @param {boolean} [opt.fixMax=false]\n     * @param {boolean} [opt.minInterval]\n     * @param {boolean} [opt.maxInterval]\n     */\n    niceExtent: function (opt) {\n        var extent = this._extent;\n        // If extent start and end are same, expand them\n        if (extent[0] === extent[1]) {\n            if (extent[0] !== 0) {\n                // Expand extent\n                var expandSize = extent[0];\n                // In the fowllowing case\n                //      Axis has been fixed max 100\n                //      Plus data are all 100 and axis extent are [100, 100].\n                // Extend to the both side will cause expanded max is larger than fixed max.\n                // So only expand to the smaller side.\n                if (!opt.fixMax) {\n                    extent[1] += expandSize / 2;\n                    extent[0] -= expandSize / 2;\n                }\n                else {\n                    extent[0] -= expandSize / 2;\n                }\n            }\n            else {\n                extent[1] = 1;\n            }\n        }\n        var span = extent[1] - extent[0];\n        // If there are no data and extent are [Infinity, -Infinity]\n        if (!isFinite(span)) {\n            extent[0] = 0;\n            extent[1] = 1;\n        }\n\n        this.niceTicks(opt.splitNumber, opt.minInterval, opt.maxInterval);\n\n        // var extent = this._extent;\n        var interval = this._interval;\n\n        if (!opt.fixMin) {\n            extent[0] = roundNumber(Math.floor(extent[0] / interval) * interval);\n        }\n        if (!opt.fixMax) {\n            extent[1] = roundNumber(Math.ceil(extent[1] / interval) * interval);\n        }\n    }\n});\n\n/**\n * @return {module:echarts/scale/Time}\n */\nIntervalScale.create = function () {\n    return new IntervalScale();\n};\n\nvar STACK_PREFIX = '__ec_stack_';\n\nfunction getSeriesStackId(seriesModel) {\n    return seriesModel.get('stack') || STACK_PREFIX + seriesModel.seriesIndex;\n}\n\nfunction getAxisKey(axis) {\n    return axis.dim + axis.index;\n}\n\n/**\n * @param {Object} opt\n * @param {module:echarts/coord/Axis} opt.axis Only support category axis currently.\n * @param {number} opt.count Positive interger.\n * @param {number} [opt.barWidth]\n * @param {number} [opt.barMaxWidth]\n * @param {number} [opt.barGap]\n * @param {number} [opt.barCategoryGap]\n * @return {Object} {width, offset, offsetCenter} If axis.type is not 'category', return undefined.\n */\nfunction getLayoutOnAxis(opt, api) {\n    var params = [];\n    var baseAxis = opt.axis;\n    var axisKey = 'axis0';\n\n    if (baseAxis.type !== 'category') {\n        return;\n    }\n    var bandWidth = baseAxis.getBandWidth();\n\n    for (var i = 0; i < opt.count || 0; i++) {\n        params.push(defaults({\n            bandWidth: bandWidth,\n            axisKey: axisKey,\n            stackId: STACK_PREFIX + i\n        }, opt));\n    }\n    var widthAndOffsets = doCalBarWidthAndOffset(params, api);\n\n    var result = [];\n    for (var i = 0; i < opt.count; i++) {\n        var item = widthAndOffsets[axisKey][STACK_PREFIX + i];\n        item.offsetCenter = item.offset + item.width / 2;\n        result.push(item);\n    }\n\n    return result;\n}\n\nfunction calBarWidthAndOffset(barSeries, api) {\n    var seriesInfoList = map(barSeries, function (seriesModel) {\n        var data = seriesModel.getData();\n        var cartesian = seriesModel.coordinateSystem;\n        var baseAxis = cartesian.getBaseAxis();\n        var axisExtent = baseAxis.getExtent();\n        var bandWidth = baseAxis.type === 'category'\n            ? baseAxis.getBandWidth()\n            : (Math.abs(axisExtent[1] - axisExtent[0]) / data.count());\n\n        var barWidth = parsePercent$1(\n            seriesModel.get('barWidth'), bandWidth\n        );\n        var barMaxWidth = parsePercent$1(\n            seriesModel.get('barMaxWidth'), bandWidth\n        );\n        var barGap = seriesModel.get('barGap');\n        var barCategoryGap = seriesModel.get('barCategoryGap');\n\n        return {\n            bandWidth: bandWidth,\n            barWidth: barWidth,\n            barMaxWidth: barMaxWidth,\n            barGap: barGap,\n            barCategoryGap: barCategoryGap,\n            axisKey: getAxisKey(baseAxis),\n            stackId: getSeriesStackId(seriesModel)\n        };\n    });\n\n    return doCalBarWidthAndOffset(seriesInfoList, api);\n}\n\nfunction doCalBarWidthAndOffset(seriesInfoList, api) {\n    // Columns info on each category axis. Key is cartesian name\n    var columnsMap = {};\n\n    each$1(seriesInfoList, function (seriesInfo, idx) {\n        var axisKey = seriesInfo.axisKey;\n        var bandWidth = seriesInfo.bandWidth;\n        var columnsOnAxis = columnsMap[axisKey] || {\n            bandWidth: bandWidth,\n            remainedWidth: bandWidth,\n            autoWidthCount: 0,\n            categoryGap: '20%',\n            gap: '30%',\n            stacks: {}\n        };\n        var stacks = columnsOnAxis.stacks;\n        columnsMap[axisKey] = columnsOnAxis;\n\n        var stackId = seriesInfo.stackId;\n\n        if (!stacks[stackId]) {\n            columnsOnAxis.autoWidthCount++;\n        }\n        stacks[stackId] = stacks[stackId] || {\n            width: 0,\n            maxWidth: 0\n        };\n\n        // Caution: In a single coordinate system, these barGrid attributes\n        // will be shared by series. Consider that they have default values,\n        // only the attributes set on the last series will work.\n        // Do not change this fact unless there will be a break change.\n\n        // TODO\n        var barWidth = seriesInfo.barWidth;\n        if (barWidth && !stacks[stackId].width) {\n            // See #6312, do not restrict width.\n            stacks[stackId].width = barWidth;\n            barWidth = Math.min(columnsOnAxis.remainedWidth, barWidth);\n            columnsOnAxis.remainedWidth -= barWidth;\n        }\n\n        var barMaxWidth = seriesInfo.barMaxWidth;\n        barMaxWidth && (stacks[stackId].maxWidth = barMaxWidth);\n        var barGap = seriesInfo.barGap;\n        (barGap != null) && (columnsOnAxis.gap = barGap);\n        var barCategoryGap = seriesInfo.barCategoryGap;\n        (barCategoryGap != null) && (columnsOnAxis.categoryGap = barCategoryGap);\n    });\n\n    var result = {};\n\n    each$1(columnsMap, function (columnsOnAxis, coordSysName) {\n\n        result[coordSysName] = {};\n\n        var stacks = columnsOnAxis.stacks;\n        var bandWidth = columnsOnAxis.bandWidth;\n        var categoryGap = parsePercent$1(columnsOnAxis.categoryGap, bandWidth);\n        var barGapPercent = parsePercent$1(columnsOnAxis.gap, 1);\n\n        var remainedWidth = columnsOnAxis.remainedWidth;\n        var autoWidthCount = columnsOnAxis.autoWidthCount;\n        var autoWidth = (remainedWidth - categoryGap)\n            / (autoWidthCount + (autoWidthCount - 1) * barGapPercent);\n        autoWidth = Math.max(autoWidth, 0);\n\n        // Find if any auto calculated bar exceeded maxBarWidth\n        each$1(stacks, function (column, stack) {\n            var maxWidth = column.maxWidth;\n            if (maxWidth && maxWidth < autoWidth) {\n                maxWidth = Math.min(maxWidth, remainedWidth);\n                if (column.width) {\n                    maxWidth = Math.min(maxWidth, column.width);\n                }\n                remainedWidth -= maxWidth;\n                column.width = maxWidth;\n                autoWidthCount--;\n            }\n        });\n\n        // Recalculate width again\n        autoWidth = (remainedWidth - categoryGap)\n            / (autoWidthCount + (autoWidthCount - 1) * barGapPercent);\n        autoWidth = Math.max(autoWidth, 0);\n\n        var widthSum = 0;\n        var lastColumn;\n        each$1(stacks, function (column, idx) {\n            if (!column.width) {\n                column.width = autoWidth;\n            }\n            lastColumn = column;\n            widthSum += column.width * (1 + barGapPercent);\n        });\n        if (lastColumn) {\n            widthSum -= lastColumn.width * barGapPercent;\n        }\n\n        var offset = -widthSum / 2;\n        each$1(stacks, function (column, stackId) {\n            result[coordSysName][stackId] = result[coordSysName][stackId] || {\n                offset: offset,\n                width: column.width\n            };\n\n            offset += column.width * (1 + barGapPercent);\n        });\n    });\n\n    return result;\n}\n\n/**\n * @param {string} seriesType\n * @param {module:echarts/model/Global} ecModel\n * @param {module:echarts/ExtensionAPI} api\n */\nfunction layout(seriesType, ecModel, api) {\n\n    var seriesModels = [];\n    ecModel.eachSeriesByType(seriesType, function (seriesModel) {\n        // Check series coordinate, do layout for cartesian2d only\n        if (seriesModel.coordinateSystem && seriesModel.coordinateSystem.type === 'cartesian2d') {\n            seriesModels.push(seriesModel);\n        }\n    });\n\n    var barWidthAndOffset = calBarWidthAndOffset(seriesModels);\n\n    var lastStackCoords = {};\n    each$1(seriesModels, function (seriesModel) {\n\n        var data = seriesModel.getData();\n        var cartesian = seriesModel.coordinateSystem;\n        var baseAxis = cartesian.getBaseAxis();\n\n        var stackId = getSeriesStackId(seriesModel);\n        var columnLayoutInfo = barWidthAndOffset[getAxisKey(baseAxis)][stackId];\n        var columnOffset = columnLayoutInfo.offset;\n        var columnWidth = columnLayoutInfo.width;\n        var valueAxis = cartesian.getOtherAxis(baseAxis);\n\n        var barMinHeight = seriesModel.get('barMinHeight') || 0;\n\n        lastStackCoords[stackId] = lastStackCoords[stackId] || [];\n        data.setLayout({\n            offset: columnOffset,\n            size: columnWidth\n        });\n\n        var valueDim = data.mapDimension(valueAxis.dim);\n        var baseDim = data.mapDimension(baseAxis.dim);\n        var stacked = isDimensionStacked(data, valueDim, baseDim);\n        var isValueAxisH = valueAxis.isHorizontal();\n\n        var valueAxisStart = (baseAxis.onZero || stacked)\n            ? valueAxis.toGlobalCoord(valueAxis.dataToCoord(0))\n            : valueAxis.getGlobalExtent()[0];\n\n        for (var idx = 0, len = data.count(); idx < len; idx++) {\n            var value = data.get(valueDim, idx);\n            var baseValue = data.get(baseDim, idx);\n\n            if (isNaN(value)) {\n                continue;\n            }\n\n            var sign = value >= 0 ? 'p' : 'n';\n            var baseCoord = valueAxisStart;\n\n            // Because of the barMinHeight, we can not use the value in\n            // stackResultDimension directly.\n            if (stacked) {\n                // Only ordinal axis can be stacked.\n                if (!lastStackCoords[stackId][baseValue]) {\n                    lastStackCoords[stackId][baseValue] = {\n                        p: valueAxisStart, // Positive stack\n                        n: valueAxisStart  // Negative stack\n                    };\n                }\n                // Should also consider #4243\n                baseCoord = lastStackCoords[stackId][baseValue][sign];\n            }\n\n            var x;\n            var y;\n            var width;\n            var height;\n\n            if (isValueAxisH) {\n                var coord = cartesian.dataToPoint([value, baseValue]);\n                x = baseCoord;\n                y = coord[1] + columnOffset;\n                width = coord[0] - valueAxisStart;\n                height = columnWidth;\n\n                if (Math.abs(width) < barMinHeight) {\n                    width = (width < 0 ? -1 : 1) * barMinHeight;\n                }\n                stacked && (lastStackCoords[stackId][baseValue][sign] += width);\n            }\n            else {\n                var coord = cartesian.dataToPoint([baseValue, value]);\n                x = coord[0] + columnOffset;\n                y = baseCoord;\n                width = columnWidth;\n                height = coord[1] - valueAxisStart;\n\n                if (Math.abs(height) < barMinHeight) {\n                    // Include zero to has a positive bar\n                    height = (height <= 0 ? -1 : 1) * barMinHeight;\n                }\n                stacked && (lastStackCoords[stackId][baseValue][sign] += height);\n            }\n\n            data.setItemLayout(idx, {\n                x: x,\n                y: y,\n                width: width,\n                height: height\n            });\n        }\n\n    }, this);\n}\n\n// [About UTC and local time zone]:\n// In most cases, `number.parseDate` will treat input data string as local time\n// (except time zone is specified in time string). And `format.formateTime` returns\n// local time by default. option.useUTC is false by default. This design have\n// concidered these common case:\n// (1) Time that is persistent in server is in UTC, but it is needed to be diplayed\n// in local time by default.\n// (2) By default, the input data string (e.g., '2011-01-02') should be displayed\n// as its original time, without any time difference.\n\nvar intervalScaleProto = IntervalScale.prototype;\n\nvar mathCeil = Math.ceil;\nvar mathFloor = Math.floor;\nvar ONE_SECOND = 1000;\nvar ONE_MINUTE = ONE_SECOND * 60;\nvar ONE_HOUR = ONE_MINUTE * 60;\nvar ONE_DAY = ONE_HOUR * 24;\n\n// FIXME \nvar bisect = function (a, x, lo, hi) {\n    while (lo < hi) {\n        var mid = lo + hi >>> 1;\n        if (a[mid][1] < x) {\n            lo = mid + 1;\n        }\n        else {\n            hi  = mid;\n        }\n    }\n    return lo;\n};\n\n/**\n * @alias module:echarts/coord/scale/Time\n * @constructor\n */\nvar TimeScale = IntervalScale.extend({\n    type: 'time',\n\n    /**\n     * @override\n     */\n    getLabel: function (val) {\n        var stepLvl = this._stepLvl;\n\n        var date = new Date(val);\n\n        return formatTime(stepLvl[0], date, this.getSetting('useUTC'));\n    },\n\n    /**\n     * @override\n     */\n    niceExtent: function (opt) {\n        var extent = this._extent;\n        // If extent start and end are same, expand them\n        if (extent[0] === extent[1]) {\n            // Expand extent\n            extent[0] -= ONE_DAY;\n            extent[1] += ONE_DAY;\n        }\n        // If there are no data and extent are [Infinity, -Infinity]\n        if (extent[1] === -Infinity && extent[0] === Infinity) {\n            var d = new Date();\n            extent[1] = +new Date(d.getFullYear(), d.getMonth(), d.getDate());\n            extent[0] = extent[1] - ONE_DAY;\n        }\n\n        this.niceTicks(opt.splitNumber, opt.minInterval, opt.maxInterval);\n\n        // var extent = this._extent;\n        var interval = this._interval;\n\n        if (!opt.fixMin) {\n            extent[0] = round$1(mathFloor(extent[0] / interval) * interval);\n        }\n        if (!opt.fixMax) {\n            extent[1] = round$1(mathCeil(extent[1] / interval) * interval);\n        }\n    },\n\n    /**\n     * @override\n     */\n    niceTicks: function (approxTickNum, minInterval, maxInterval) {\n        approxTickNum = approxTickNum || 10;\n\n        var extent = this._extent;\n        var span = extent[1] - extent[0];\n        var approxInterval = span / approxTickNum;\n\n        if (minInterval != null && approxInterval < minInterval) {\n            approxInterval = minInterval;\n        }\n        if (maxInterval != null && approxInterval > maxInterval) {\n            approxInterval = maxInterval;\n        }\n\n        var scaleLevelsLen = scaleLevels.length;\n        var idx = bisect(scaleLevels, approxInterval, 0, scaleLevelsLen);\n\n        var level = scaleLevels[Math.min(idx, scaleLevelsLen - 1)];\n        var interval = level[1];\n        // Same with interval scale if span is much larger than 1 year\n        if (level[0] === 'year') {\n            var yearSpan = span / interval;\n\n            // From \"Nice Numbers for Graph Labels\" of Graphic Gems\n            // var niceYearSpan = numberUtil.nice(yearSpan, false);\n            var yearStep = nice(yearSpan / approxTickNum, true);\n\n            interval *= yearStep;\n        }\n\n        var timezoneOffset = this.getSetting('useUTC')\n            ? 0 : (new Date(+extent[0] || +extent[1])).getTimezoneOffset() * 60 * 1000;\n        var niceExtent = [\n            Math.round(mathCeil((extent[0] - timezoneOffset) / interval) * interval + timezoneOffset),\n            Math.round(mathFloor((extent[1] - timezoneOffset) / interval) * interval + timezoneOffset)\n        ];\n\n        fixExtent(niceExtent, extent);\n\n        this._stepLvl = level;\n        // Interval will be used in getTicks\n        this._interval = interval;\n        this._niceExtent = niceExtent;\n    },\n\n    parse: function (val) {\n        // val might be float.\n        return +parseDate(val);\n    }\n});\n\neach$1(['contain', 'normalize'], function (methodName) {\n    TimeScale.prototype[methodName] = function (val) {\n        return intervalScaleProto[methodName].call(this, this.parse(val));\n    };\n});\n\n// Steps from d3\nvar scaleLevels = [\n    // Format              interval\n    ['hh:mm:ss', ONE_SECOND],          // 1s\n    ['hh:mm:ss', ONE_SECOND * 5],      // 5s\n    ['hh:mm:ss', ONE_SECOND * 10],     // 10s\n    ['hh:mm:ss', ONE_SECOND * 15],     // 15s\n    ['hh:mm:ss', ONE_SECOND * 30],     // 30s\n    ['hh:mm\\nMM-dd', ONE_MINUTE],      // 1m\n    ['hh:mm\\nMM-dd', ONE_MINUTE * 5],  // 5m\n    ['hh:mm\\nMM-dd', ONE_MINUTE * 10], // 10m\n    ['hh:mm\\nMM-dd', ONE_MINUTE * 15], // 15m\n    ['hh:mm\\nMM-dd', ONE_MINUTE * 30], // 30m\n    ['hh:mm\\nMM-dd', ONE_HOUR],        // 1h\n    ['hh:mm\\nMM-dd', ONE_HOUR * 2],    // 2h\n    ['hh:mm\\nMM-dd', ONE_HOUR * 6],    // 6h\n    ['hh:mm\\nMM-dd', ONE_HOUR * 12],   // 12h\n    ['MM-dd\\nyyyy', ONE_DAY],          // 1d\n    ['MM-dd\\nyyyy', ONE_DAY * 2],      // 2d\n    ['MM-dd\\nyyyy', ONE_DAY * 3],      // 3d\n    ['MM-dd\\nyyyy', ONE_DAY * 4],      // 4d\n    ['MM-dd\\nyyyy', ONE_DAY * 5],      // 5d\n    ['MM-dd\\nyyyy', ONE_DAY * 6],      // 6d\n    ['week', ONE_DAY * 7],             // 7d\n    ['MM-dd\\nyyyy', ONE_DAY * 10],     // 10d\n    ['week', ONE_DAY * 14],            // 2w\n    ['week', ONE_DAY * 21],            // 3w\n    ['month', ONE_DAY * 31],           // 1M\n    ['week', ONE_DAY * 42],            // 6w\n    ['month', ONE_DAY * 62],           // 2M\n    ['week', ONE_DAY * 42],            // 10w\n    ['quarter', ONE_DAY * 380 / 4],    // 3M\n    ['month', ONE_DAY * 31 * 4],       // 4M\n    ['month', ONE_DAY * 31 * 5],       // 5M\n    ['half-year', ONE_DAY * 380 / 2],  // 6M\n    ['month', ONE_DAY * 31 * 8],       // 8M\n    ['month', ONE_DAY * 31 * 10],      // 10M\n    ['year', ONE_DAY * 380]            // 1Y\n];\n\n/**\n * @param {module:echarts/model/Model}\n * @return {module:echarts/scale/Time}\n */\nTimeScale.create = function (model) {\n    return new TimeScale({useUTC: model.ecModel.get('useUTC')});\n};\n\n/**\n * Log scale\n * @module echarts/scale/Log\n */\n\n// Use some method of IntervalScale\nvar scaleProto$1 = Scale.prototype;\nvar intervalScaleProto$1 = IntervalScale.prototype;\n\nvar getPrecisionSafe$1 = getPrecisionSafe;\nvar roundingErrorFix = round$1;\n\nvar mathFloor$1 = Math.floor;\nvar mathCeil$1 = Math.ceil;\nvar mathPow$1 = Math.pow;\n\nvar mathLog = Math.log;\n\nvar LogScale = Scale.extend({\n\n    type: 'log',\n\n    base: 10,\n\n    $constructor: function () {\n        Scale.apply(this, arguments);\n        this._originalScale = new IntervalScale();\n    },\n\n    /**\n     * @return {Array.<number>}\n     */\n    getTicks: function () {\n        var originalScale = this._originalScale;\n        var extent = this._extent;\n        var originalExtent = originalScale.getExtent();\n\n        return map(intervalScaleProto$1.getTicks.call(this), function (val) {\n            var powVal = round$1(mathPow$1(this.base, val));\n\n            // Fix #4158\n            powVal = (val === extent[0] && originalScale.__fixMin)\n                ? fixRoundingError(powVal, originalExtent[0])\n                : powVal;\n            powVal = (val === extent[1] && originalScale.__fixMax)\n                ? fixRoundingError(powVal, originalExtent[1])\n                : powVal;\n\n            return powVal;\n        }, this);\n    },\n\n    /**\n     * @param {number} val\n     * @return {string}\n     */\n    getLabel: intervalScaleProto$1.getLabel,\n\n    /**\n     * @param  {number} val\n     * @return {number}\n     */\n    scale: function (val) {\n        val = scaleProto$1.scale.call(this, val);\n        return mathPow$1(this.base, val);\n    },\n\n    /**\n     * @param {number} start\n     * @param {number} end\n     */\n    setExtent: function (start, end) {\n        var base = this.base;\n        start = mathLog(start) / mathLog(base);\n        end = mathLog(end) / mathLog(base);\n        intervalScaleProto$1.setExtent.call(this, start, end);\n    },\n\n    /**\n     * @return {number} end\n     */\n    getExtent: function () {\n        var base = this.base;\n        var extent = scaleProto$1.getExtent.call(this);\n        extent[0] = mathPow$1(base, extent[0]);\n        extent[1] = mathPow$1(base, extent[1]);\n\n        // Fix #4158\n        var originalScale = this._originalScale;\n        var originalExtent = originalScale.getExtent();\n        originalScale.__fixMin && (extent[0] = fixRoundingError(extent[0], originalExtent[0]));\n        originalScale.__fixMax && (extent[1] = fixRoundingError(extent[1], originalExtent[1]));\n\n        return extent;\n    },\n\n    /**\n     * @param  {Array.<number>} extent\n     */\n    unionExtent: function (extent) {\n        this._originalScale.unionExtent(extent);\n\n        var base = this.base;\n        extent[0] = mathLog(extent[0]) / mathLog(base);\n        extent[1] = mathLog(extent[1]) / mathLog(base);\n        scaleProto$1.unionExtent.call(this, extent);\n    },\n\n    /**\n     * @override\n     */\n    unionExtentFromData: function (data, dim) {\n        // TODO\n        // filter value that <= 0\n        this.unionExtent(data.getApproximateExtent(dim));\n    },\n\n    /**\n     * Update interval and extent of intervals for nice ticks\n     * @param  {number} [approxTickNum = 10] Given approx tick number\n     */\n    niceTicks: function (approxTickNum) {\n        approxTickNum = approxTickNum || 10;\n        var extent = this._extent;\n        var span = extent[1] - extent[0];\n        if (span === Infinity || span <= 0) {\n            return;\n        }\n\n        var interval = quantity(span);\n        var err = approxTickNum / span * interval;\n\n        // Filter ticks to get closer to the desired count.\n        if (err <= 0.5) {\n            interval *= 10;\n        }\n\n        // Interval should be integer\n        while (!isNaN(interval) && Math.abs(interval) < 1 && Math.abs(interval) > 0) {\n            interval *= 10;\n        }\n\n        var niceExtent = [\n            round$1(mathCeil$1(extent[0] / interval) * interval),\n            round$1(mathFloor$1(extent[1] / interval) * interval)\n        ];\n\n        this._interval = interval;\n        this._niceExtent = niceExtent;\n    },\n\n    /**\n     * Nice extent.\n     * @override\n     */\n    niceExtent: function (opt) {\n        intervalScaleProto$1.niceExtent.call(this, opt);\n\n        var originalScale = this._originalScale;\n        originalScale.__fixMin = opt.fixMin;\n        originalScale.__fixMax = opt.fixMax;\n    }\n\n});\n\neach$1(['contain', 'normalize'], function (methodName) {\n    LogScale.prototype[methodName] = function (val) {\n        val = mathLog(val) / mathLog(this.base);\n        return scaleProto$1[methodName].call(this, val);\n    };\n});\n\nLogScale.create = function () {\n    return new LogScale();\n};\n\nfunction fixRoundingError(val, originalVal) {\n    return roundingErrorFix(val, getPrecisionSafe$1(originalVal));\n}\n\n/**\n * Get axis scale extent before niced.\n * Item of returned array can only be number (including Infinity and NaN).\n */\nfunction getScaleExtent(scale, model) {\n    var scaleType = scale.type;\n\n    var min = model.getMin();\n    var max = model.getMax();\n    var fixMin = min != null;\n    var fixMax = max != null;\n    var originalExtent = scale.getExtent();\n\n    var axisDataLen;\n    var boundaryGap;\n    var span;\n    if (scaleType === 'ordinal') {\n        axisDataLen = model.getCategories().length;\n    }\n    else {\n        boundaryGap = model.get('boundaryGap');\n        if (!isArray(boundaryGap)) {\n            boundaryGap = [boundaryGap || 0, boundaryGap || 0];\n        }\n        if (typeof boundaryGap[0] === 'boolean') {\n            if (__DEV__) {\n                console.warn('Boolean type for boundaryGap is only '\n                    + 'allowed for ordinal axis. Please use string in '\n                    + 'percentage instead, e.g., \"20%\". Currently, '\n                    + 'boundaryGap is set to be 0.');\n            }\n            boundaryGap = [0, 0];\n        }\n        boundaryGap[0] = parsePercent$1(boundaryGap[0], 1);\n        boundaryGap[1] = parsePercent$1(boundaryGap[1], 1);\n        span = (originalExtent[1] - originalExtent[0])\n            || Math.abs(originalExtent[0]);\n    }\n\n    // Notice: When min/max is not set (that is, when there are null/undefined,\n    // which is the most common case), these cases should be ensured:\n    // (1) For 'ordinal', show all axis.data.\n    // (2) For others:\n    //      + `boundaryGap` is applied (if min/max set, boundaryGap is\n    //      disabled).\n    //      + If `needCrossZero`, min/max should be zero, otherwise, min/max should\n    //      be the result that originalExtent enlarged by boundaryGap.\n    // (3) If no data, it should be ensured that `scale.setBlank` is set.\n\n    // FIXME\n    // (1) When min/max is 'dataMin' or 'dataMax', should boundaryGap be able to used?\n    // (2) When `needCrossZero` and all data is positive/negative, should it be ensured\n    // that the results processed by boundaryGap are positive/negative?\n\n    if (min == null) {\n        min = scaleType === 'ordinal'\n            ? (axisDataLen ? 0 : NaN)\n            : originalExtent[0] - boundaryGap[0] * span;\n    }\n    if (max == null) {\n        max = scaleType === 'ordinal'\n            ? (axisDataLen ? axisDataLen - 1 : NaN)\n            : originalExtent[1] + boundaryGap[1] * span;\n    }\n\n    if (min === 'dataMin') {\n        min = originalExtent[0];\n    }\n    else if (typeof min === 'function') {\n        min = min({\n            min: originalExtent[0],\n            max: originalExtent[1]\n        });\n    }\n\n    if (max === 'dataMax') {\n        max = originalExtent[1];\n    }\n    else if (typeof max === 'function') {\n        max = max({\n            min: originalExtent[0],\n            max: originalExtent[1]\n        });\n    }\n\n    (min == null || !isFinite(min)) && (min = NaN);\n    (max == null || !isFinite(max)) && (max = NaN);\n\n    scale.setBlank(eqNaN(min) || eqNaN(max));\n\n    // Evaluate if axis needs cross zero\n    if (model.getNeedCrossZero()) {\n        // Axis is over zero and min is not set\n        if (min > 0 && max > 0 && !fixMin) {\n            min = 0;\n        }\n        // Axis is under zero and max is not set\n        if (min < 0 && max < 0 && !fixMax) {\n            max = 0;\n        }\n    }\n\n    // If bars are placed on a base axis of type time or interval account for axis boundary overflow and current axis\n    // is base axis\n    // FIXME\n    // (1) Consider support value axis, where below zero and axis `onZero` should be handled properly.\n    // (2) Refactor the logic with `barGrid`. Is it not need to `calBarWidthAndOffset` twice with different extent?\n    //     Should not depend on series type `bar`?\n    // (3) Fix that might overlap when using dataZoom.\n    // (4) Consider other chart types using `barGrid`?\n    // See #6728, #4862, `test/bar-overflow-time-plot.html`\n    var ecModel = model.ecModel;\n    if (ecModel && (scaleType === 'time' /*|| scaleType === 'interval' */)) {\n        var barSeriesModels = [];\n        var isBaseAxisAndHasBarSeries;\n\n        ecModel.eachSeriesByType('bar', function (seriesModel) {\n            if (seriesModel.coordinateSystem && seriesModel.coordinateSystem.type === 'cartesian2d') {\n                barSeriesModels.push(seriesModel);\n                isBaseAxisAndHasBarSeries |= seriesModel.getBaseAxis() === model.axis;\n            }\n        });\n\n        if (isBaseAxisAndHasBarSeries) {\n            // Adjust axis min and max to account for overflow\n            var adjustedScale = adjustScaleForOverflow(min, max, model, barSeriesModels);\n            min = adjustedScale.min;\n            max = adjustedScale.max;\n        }\n    }\n\n    return [min, max];\n}\n\nfunction adjustScaleForOverflow(min, max, model, barSeriesModels) {\n\n    // Get Axis Length\n    var axisExtent = model.axis.getExtent();\n    var axisLength = axisExtent[1] - axisExtent[0];\n\n    // Calculate placement of bars on axis\n    var barWidthAndOffset = calBarWidthAndOffset(barSeriesModels);\n\n    // Get bars on current base axis and calculate min and max overflow\n    var baseAxisKey = model.axis.dim + model.axis.index;\n    var barsOnCurrentAxis = barWidthAndOffset[baseAxisKey];\n    if (barsOnCurrentAxis === undefined) {\n        return {min: min, max: max};\n    }\n\n    var minOverflow = Infinity;\n    each$1(barsOnCurrentAxis, function (item) {\n        minOverflow = Math.min(item.offset, minOverflow);\n    });\n    var maxOverflow = -Infinity;\n    each$1(barsOnCurrentAxis, function (item) {\n        maxOverflow = Math.max(item.offset + item.width, maxOverflow);\n    });\n    minOverflow = Math.abs(minOverflow);\n    maxOverflow = Math.abs(maxOverflow);\n    var totalOverFlow = minOverflow + maxOverflow;\n\n    // Calulate required buffer based on old range and overflow\n    var oldRange = max - min;\n    var oldRangePercentOfNew = (1 - (minOverflow + maxOverflow) / axisLength);\n    var overflowBuffer = ((oldRange / oldRangePercentOfNew) - oldRange);\n\n    max += overflowBuffer * (maxOverflow / totalOverFlow);\n    min -= overflowBuffer * (minOverflow / totalOverFlow);\n\n    return {min: min, max: max};\n}\n\nfunction niceScaleExtent(scale, model) {\n    var extent = getScaleExtent(scale, model);\n    var fixMin = model.getMin() != null;\n    var fixMax = model.getMax() != null;\n    var splitNumber = model.get('splitNumber');\n\n    if (scale.type === 'log') {\n        scale.base = model.get('logBase');\n    }\n\n    var scaleType = scale.type;\n    scale.setExtent(extent[0], extent[1]);\n    scale.niceExtent({\n        splitNumber: splitNumber,\n        fixMin: fixMin,\n        fixMax: fixMax,\n        minInterval: (scaleType === 'interval' || scaleType === 'time')\n            ? model.get('minInterval') : null,\n        maxInterval: (scaleType === 'interval' || scaleType === 'time')\n            ? model.get('maxInterval') : null\n    });\n\n    // If some one specified the min, max. And the default calculated interval\n    // is not good enough. He can specify the interval. It is often appeared\n    // in angle axis with angle 0 - 360. Interval calculated in interval scale is hard\n    // to be 60.\n    // FIXME\n    var interval = model.get('interval');\n    if (interval != null) {\n        scale.setInterval && scale.setInterval(interval);\n    }\n}\n\n/**\n * @param {module:echarts/model/Model} model\n * @param {string} [axisType] Default retrieve from model.type\n * @return {module:echarts/scale/*}\n */\nfunction createScaleByModel(model, axisType) {\n    axisType = axisType || model.get('type');\n    if (axisType) {\n        switch (axisType) {\n            // Buildin scale\n            case 'category':\n                return new OrdinalScale(\n                    model.getOrdinalMeta\n                        ? model.getOrdinalMeta()\n                        : model.getCategories(),\n                    [Infinity, -Infinity]\n                );\n            case 'value':\n                return new IntervalScale();\n            // Extended scale, like time and log\n            default:\n                return (Scale.getClass(axisType) || IntervalScale).create(model);\n        }\n    }\n}\n\n/**\n * Check if the axis corss 0\n */\nfunction ifAxisCrossZero(axis) {\n    var dataExtent = axis.scale.getExtent();\n    var min = dataExtent[0];\n    var max = dataExtent[1];\n    return !((min > 0 && max > 0) || (min < 0 && max < 0));\n}\n\n/**\n * @param {Array.<number>} tickCoords In axis self coordinate.\n * @param {Array.<string>} labels\n * @param {string} font\n * @param {number} axisRotate 0: towards right horizontally, clock-wise is negative.\n * @param {number} [labelRotate=0] 0: towards right horizontally, clock-wise is negative.\n * @return {number}\n */\nfunction getAxisLabelInterval(tickCoords, labels, font, axisRotate, labelRotate) {\n    var textSpaceTakenRect;\n    var autoLabelInterval = 0;\n    var accumulatedLabelInterval = 0;\n    var rotation = (axisRotate - labelRotate) / 180 * Math.PI;\n\n    var step = 1;\n    if (labels.length > 40) {\n        // Simple optimization for large amount of labels\n        step = Math.floor(labels.length / 40);\n    }\n\n    for (var i = 0; i < tickCoords.length; i += step) {\n        var tickCoord = tickCoords[i];\n\n        // Not precise, do not consider align and vertical align\n        // and each distance from axis line yet.\n        var rect = getBoundingRect(\n            labels[i], font, 'center', 'top'\n        );\n        rect.x += tickCoord * Math.cos(rotation);\n        rect.y += tickCoord * Math.sin(rotation);\n\n        // Magic number\n        rect.width *= 1.3;\n        rect.height *= 1.3;\n\n        if (!textSpaceTakenRect) {\n            textSpaceTakenRect = rect.clone();\n        }\n        // There is no space for current label;\n        else if (textSpaceTakenRect.intersect(rect)) {\n            accumulatedLabelInterval++;\n            autoLabelInterval = Math.max(autoLabelInterval, accumulatedLabelInterval);\n        }\n        else {\n            textSpaceTakenRect.union(rect);\n            // Reset\n            accumulatedLabelInterval = 0;\n        }\n    }\n    if (autoLabelInterval === 0 && step > 1) {\n        return step;\n    }\n    return (autoLabelInterval + 1) * step - 1;\n}\n\n/**\n * @param {Object} axis\n * @param {Function} labelFormatter\n * @return {Array.<string>}\n */\nfunction getFormattedLabels(axis, labelFormatter) {\n    var scale = axis.scale;\n    var labels = scale.getTicksLabels();\n    var ticks = scale.getTicks();\n    if (typeof labelFormatter === 'string') {\n        labelFormatter = (function (tpl) {\n            return function (val) {\n                return tpl.replace('{value}', val != null ? val : '');\n            };\n        })(labelFormatter);\n        // Consider empty array\n        return map(labels, labelFormatter);\n    }\n    else if (typeof labelFormatter === 'function') {\n        return map(ticks, function (tick, idx) {\n            return labelFormatter(\n                getAxisRawValue(axis, tick),\n                idx\n            );\n        }, this);\n    }\n    else {\n        return labels;\n    }\n}\n\nfunction getAxisRawValue(axis, value) {\n    // In category axis with data zoom, tick is not the original\n    // index of axis.data. So tick should not be exposed to user\n    // in category axis.\n    return axis.type === 'category' ? axis.scale.getLabel(value) : value;\n}\n\nvar axisModelCommonMixin = {\n\n    /**\n     * Format labels\n     * @return {Array.<string>}\n     */\n    getFormattedLabels: function () {\n        return getFormattedLabels(\n            this.axis,\n            this.get('axisLabel.formatter')\n        );\n    },\n\n    /**\n     * @param {boolean} origin\n     * @return {number|string} min value or 'dataMin' or null/undefined (means auto) or NaN\n     */\n    getMin: function (origin) {\n        var option = this.option;\n        var min = (!origin && option.rangeStart != null)\n            ? option.rangeStart : option.min;\n\n        if (this.axis\n            && min != null\n            && min !== 'dataMin'\n            && typeof min !== 'function'\n            && !eqNaN(min)\n        ) {\n            min = this.axis.scale.parse(min);\n        }\n        return min;\n    },\n\n    /**\n     * @param {boolean} origin\n     * @return {number|string} max value or 'dataMax' or null/undefined (means auto) or NaN\n     */\n    getMax: function (origin) {\n        var option = this.option;\n        var max = (!origin && option.rangeEnd != null)\n            ? option.rangeEnd : option.max;\n\n        if (this.axis\n            && max != null\n            && max !== 'dataMax'\n            && typeof max !== 'function'\n            && !eqNaN(max)\n        ) {\n            max = this.axis.scale.parse(max);\n        }\n        return max;\n    },\n\n    /**\n     * @return {boolean}\n     */\n    getNeedCrossZero: function () {\n        var option = this.option;\n        return (option.rangeStart != null || option.rangeEnd != null)\n            ? false : !option.scale;\n    },\n\n    /**\n     * Should be implemented by each axis model if necessary.\n     * @return {module:echarts/model/Component} coordinate system model\n     */\n    getCoordSysModel: noop,\n\n    /**\n     * @param {number} rangeStart Can only be finite number or null/undefined or NaN.\n     * @param {number} rangeEnd Can only be finite number or null/undefined or NaN.\n     */\n    setRange: function (rangeStart, rangeEnd) {\n        this.option.rangeStart = rangeStart;\n        this.option.rangeEnd = rangeEnd;\n    },\n\n    /**\n     * Reset range\n     */\n    resetRange: function () {\n        // rangeStart and rangeEnd is readonly.\n        this.option.rangeStart = this.option.rangeEnd = null;\n    }\n};\n\n// Symbol factory\n\n/**\n * Triangle shape\n * @inner\n */\nvar Triangle = extendShape({\n    type: 'triangle',\n    shape: {\n        cx: 0,\n        cy: 0,\n        width: 0,\n        height: 0\n    },\n    buildPath: function (path, shape) {\n        var cx = shape.cx;\n        var cy = shape.cy;\n        var width = shape.width / 2;\n        var height = shape.height / 2;\n        path.moveTo(cx, cy - height);\n        path.lineTo(cx + width, cy + height);\n        path.lineTo(cx - width, cy + height);\n        path.closePath();\n    }\n});\n\n/**\n * Diamond shape\n * @inner\n */\nvar Diamond = extendShape({\n    type: 'diamond',\n    shape: {\n        cx: 0,\n        cy: 0,\n        width: 0,\n        height: 0\n    },\n    buildPath: function (path, shape) {\n        var cx = shape.cx;\n        var cy = shape.cy;\n        var width = shape.width / 2;\n        var height = shape.height / 2;\n        path.moveTo(cx, cy - height);\n        path.lineTo(cx + width, cy);\n        path.lineTo(cx, cy + height);\n        path.lineTo(cx - width, cy);\n        path.closePath();\n    }\n});\n\n/**\n * Pin shape\n * @inner\n */\nvar Pin = extendShape({\n    type: 'pin',\n    shape: {\n        // x, y on the cusp\n        x: 0,\n        y: 0,\n        width: 0,\n        height: 0\n    },\n\n    buildPath: function (path, shape) {\n        var x = shape.x;\n        var y = shape.y;\n        var w = shape.width / 5 * 3;\n        // Height must be larger than width\n        var h = Math.max(w, shape.height);\n        var r = w / 2;\n\n        // Dist on y with tangent point and circle center\n        var dy = r * r / (h - r);\n        var cy = y - h + r + dy;\n        var angle = Math.asin(dy / r);\n        // Dist on x with tangent point and circle center\n        var dx = Math.cos(angle) * r;\n\n        var tanX = Math.sin(angle);\n        var tanY = Math.cos(angle);\n\n        var cpLen = r * 0.6;\n        var cpLen2 = r * 0.7;\n\n        path.moveTo(x - dx, cy + dy);\n\n        path.arc(\n            x, cy, r,\n            Math.PI - angle,\n            Math.PI * 2 + angle\n        );\n        path.bezierCurveTo(\n            x + dx - tanX * cpLen, cy + dy + tanY * cpLen,\n            x, y - cpLen2,\n            x, y\n        );\n        path.bezierCurveTo(\n            x, y - cpLen2,\n            x - dx + tanX * cpLen, cy + dy + tanY * cpLen,\n            x - dx, cy + dy\n        );\n        path.closePath();\n    }\n});\n\n/**\n * Arrow shape\n * @inner\n */\nvar Arrow = extendShape({\n\n    type: 'arrow',\n\n    shape: {\n        x: 0,\n        y: 0,\n        width: 0,\n        height: 0\n    },\n\n    buildPath: function (ctx, shape) {\n        var height = shape.height;\n        var width = shape.width;\n        var x = shape.x;\n        var y = shape.y;\n        var dx = width / 3 * 2;\n        ctx.moveTo(x, y);\n        ctx.lineTo(x + dx, y + height);\n        ctx.lineTo(x, y + height / 4 * 3);\n        ctx.lineTo(x - dx, y + height);\n        ctx.lineTo(x, y);\n        ctx.closePath();\n    }\n});\n\n/**\n * Map of path contructors\n * @type {Object.<string, module:zrender/graphic/Path>}\n */\nvar symbolCtors = {\n\n    line: Line,\n\n    rect: Rect,\n\n    roundRect: Rect,\n\n    square: Rect,\n\n    circle: Circle,\n\n    diamond: Diamond,\n\n    pin: Pin,\n\n    arrow: Arrow,\n\n    triangle: Triangle\n};\n\nvar symbolShapeMakers = {\n\n    line: function (x, y, w, h, shape) {\n        // FIXME\n        shape.x1 = x;\n        shape.y1 = y + h / 2;\n        shape.x2 = x + w;\n        shape.y2 = y + h / 2;\n    },\n\n    rect: function (x, y, w, h, shape) {\n        shape.x = x;\n        shape.y = y;\n        shape.width = w;\n        shape.height = h;\n    },\n\n    roundRect: function (x, y, w, h, shape) {\n        shape.x = x;\n        shape.y = y;\n        shape.width = w;\n        shape.height = h;\n        shape.r = Math.min(w, h) / 4;\n    },\n\n    square: function (x, y, w, h, shape) {\n        var size = Math.min(w, h);\n        shape.x = x;\n        shape.y = y;\n        shape.width = size;\n        shape.height = size;\n    },\n\n    circle: function (x, y, w, h, shape) {\n        // Put circle in the center of square\n        shape.cx = x + w / 2;\n        shape.cy = y + h / 2;\n        shape.r = Math.min(w, h) / 2;\n    },\n\n    diamond: function (x, y, w, h, shape) {\n        shape.cx = x + w / 2;\n        shape.cy = y + h / 2;\n        shape.width = w;\n        shape.height = h;\n    },\n\n    pin: function (x, y, w, h, shape) {\n        shape.x = x + w / 2;\n        shape.y = y + h / 2;\n        shape.width = w;\n        shape.height = h;\n    },\n\n    arrow: function (x, y, w, h, shape) {\n        shape.x = x + w / 2;\n        shape.y = y + h / 2;\n        shape.width = w;\n        shape.height = h;\n    },\n\n    triangle: function (x, y, w, h, shape) {\n        shape.cx = x + w / 2;\n        shape.cy = y + h / 2;\n        shape.width = w;\n        shape.height = h;\n    }\n};\n\nvar symbolBuildProxies = {};\neach$1(symbolCtors, function (Ctor, name) {\n    symbolBuildProxies[name] = new Ctor();\n});\n\nvar SymbolClz = extendShape({\n\n    type: 'symbol',\n\n    shape: {\n        symbolType: '',\n        x: 0,\n        y: 0,\n        width: 0,\n        height: 0\n    },\n\n    beforeBrush: function () {\n        var style = this.style;\n        var shape = this.shape;\n        // FIXME\n        if (shape.symbolType === 'pin' && style.textPosition === 'inside') {\n            style.textPosition = ['50%', '40%'];\n            style.textAlign = 'center';\n            style.textVerticalAlign = 'middle';\n        }\n    },\n\n    buildPath: function (ctx, shape, inBundle) {\n        var symbolType = shape.symbolType;\n        var proxySymbol = symbolBuildProxies[symbolType];\n        if (shape.symbolType !== 'none') {\n            if (!proxySymbol) {\n                // Default rect\n                symbolType = 'rect';\n                proxySymbol = symbolBuildProxies[symbolType];\n            }\n            symbolShapeMakers[symbolType](\n                shape.x, shape.y, shape.width, shape.height, proxySymbol.shape\n            );\n            proxySymbol.buildPath(ctx, proxySymbol.shape, inBundle);\n        }\n    }\n});\n\n// Provide setColor helper method to avoid determine if set the fill or stroke outside\nfunction symbolPathSetColor(color, innerColor) {\n    if (this.type !== 'image') {\n        var symbolStyle = this.style;\n        var symbolShape = this.shape;\n        if (symbolShape && symbolShape.symbolType === 'line') {\n            symbolStyle.stroke = color;\n        }\n        else if (this.__isEmptyBrush) {\n            symbolStyle.stroke = color;\n            symbolStyle.fill = innerColor || '#fff';\n        }\n        else {\n            // FIXME  onlyStroke ?\n            symbolStyle.fill && (symbolStyle.fill = color);\n            symbolStyle.stroke && (symbolStyle.stroke = color);\n        }\n        this.dirty(false);\n    }\n}\n\n/**\n * Create a symbol element with given symbol configuration: shape, x, y, width, height, color\n * @param {string} symbolType\n * @param {number} x\n * @param {number} y\n * @param {number} w\n * @param {number} h\n * @param {string} color\n * @param {boolean} [keepAspect=false] whether to keep the ratio of w/h,\n *                            for path and image only.\n */\nfunction createSymbol(symbolType, x, y, w, h, color, keepAspect) {\n    // TODO Support image object, DynamicImage.\n\n    var isEmpty = symbolType.indexOf('empty') === 0;\n    if (isEmpty) {\n        symbolType = symbolType.substr(5, 1).toLowerCase() + symbolType.substr(6);\n    }\n    var symbolPath;\n\n    if (symbolType.indexOf('image://') === 0) {\n        symbolPath = makeImage(\n            symbolType.slice(8),\n            new BoundingRect(x, y, w, h),\n            keepAspect ? 'center' : 'cover'\n        );\n    }\n    else if (symbolType.indexOf('path://') === 0) {\n        symbolPath = makePath(\n            symbolType.slice(7),\n            {},\n            new BoundingRect(x, y, w, h),\n            keepAspect ? 'center' : 'cover'\n        );\n    }\n    else {\n        symbolPath = new SymbolClz({\n            shape: {\n                symbolType: symbolType,\n                x: x,\n                y: y,\n                width: w,\n                height: h\n            }\n        });\n    }\n\n    symbolPath.__isEmptyBrush = isEmpty;\n\n    symbolPath.setColor = symbolPathSetColor;\n\n    symbolPath.setColor(color);\n\n    return symbolPath;\n}\n\n// import createGraphFromNodeEdge from './chart/helper/createGraphFromNodeEdge';\n/**\n * Create a muti dimension List structure from seriesModel.\n * @param  {module:echarts/model/Model} seriesModel\n * @return {module:echarts/data/List} list\n */\nfunction createList(seriesModel) {\n    return createListFromArray(seriesModel.getSource(), seriesModel);\n}\n\nvar dataStack$1 = {\n    isDimensionStacked: isDimensionStacked,\n    enableDataStack: enableDataStack\n};\n\n/**\n * Create scale\n * @param {Array.<number>} dataExtent\n * @param {Object|module:echarts/Model} option\n */\nfunction createScale(dataExtent, option) {\n    var axisModel = option;\n    if (!Model.isInstance(option)) {\n        axisModel = new Model(option);\n        mixin(axisModel, axisModelCommonMixin);\n    }\n\n    var scale = createScaleByModel(axisModel);\n    scale.setExtent(dataExtent[0], dataExtent[1]);\n\n    niceScaleExtent(scale, axisModel);\n    return scale;\n}\n\n/**\n * Mixin common methods to axis model,\n *\n * Inlcude methods\n * `getFormattedLabels() => Array.<string>`\n * `getCategories() => Array.<string>`\n * `getMin(origin: boolean) => number`\n * `getMax(origin: boolean) => number`\n * `getNeedCrossZero() => boolean`\n * `setRange(start: number, end: number)`\n * `resetRange()`\n */\nfunction mixinAxisModelCommonMethods(Model$$1) {\n    mixin(Model$$1, axisModelCommonMixin);\n}\n\nvar helper = (Object.freeze || Object)({\n\tcreateList: createList,\n\tgetLayoutRect: getLayoutRect,\n\tdataStack: dataStack$1,\n\tcreateScale: createScale,\n\tmixinAxisModelCommonMethods: mixinAxisModelCommonMethods,\n\tcompleteDimensions: completeDimensions,\n\tcreateDimensions: createDimensions,\n\tcreateSymbol: createSymbol\n});\n\nvar EPSILON$3 = 1e-8;\n\nfunction isAroundEqual$1(a, b) {\n    return Math.abs(a - b) < EPSILON$3;\n}\n\nfunction contain$1(points, x, y) {\n    var w = 0;\n    var p = points[0];\n\n    if (!p) {\n        return false;\n    }\n\n    for (var i = 1; i < points.length; i++) {\n        var p2 = points[i];\n        w += windingLine(p[0], p[1], p2[0], p2[1], x, y);\n        p = p2;\n    }\n\n    // Close polygon\n    var p0 = points[0];\n    if (!isAroundEqual$1(p[0], p0[0]) || !isAroundEqual$1(p[1], p0[1])) {\n        w += windingLine(p[0], p[1], p0[0], p0[1], x, y);\n    }\n\n    return w !== 0;\n}\n\n/**\n * @module echarts/coord/geo/Region\n */\n\n/**\n * @param {string} name\n * @param {Array} geometries\n * @param {Array.<number>} cp\n */\nfunction Region(name, geometries, cp) {\n\n    /**\n     * @type {string}\n     * @readOnly\n     */\n    this.name = name;\n\n    /**\n     * @type {Array.<Array>}\n     * @readOnly\n     */\n    this.geometries = geometries;\n\n    if (!cp) {\n        var rect = this.getBoundingRect();\n        cp = [\n            rect.x + rect.width / 2,\n            rect.y + rect.height / 2\n        ];\n    }\n    else {\n        cp = [cp[0], cp[1]];\n    }\n    /**\n     * @type {Array.<number>}\n     */\n    this.center = cp;\n}\n\nRegion.prototype = {\n\n    constructor: Region,\n\n    properties: null,\n\n    /**\n     * @return {module:zrender/core/BoundingRect}\n     */\n    getBoundingRect: function () {\n        var rect = this._rect;\n        if (rect) {\n            return rect;\n        }\n\n        var MAX_NUMBER = Number.MAX_VALUE;\n        var min$$1 = [MAX_NUMBER, MAX_NUMBER];\n        var max$$1 = [-MAX_NUMBER, -MAX_NUMBER];\n        var min2 = [];\n        var max2 = [];\n        var geometries = this.geometries;\n        for (var i = 0; i < geometries.length; i++) {\n            // Only support polygon\n            if (geometries[i].type !== 'polygon') {\n                continue;\n            }\n            // Doesn't consider hole\n            var exterior = geometries[i].exterior;\n            fromPoints(exterior, min2, max2);\n            min(min$$1, min$$1, min2);\n            max(max$$1, max$$1, max2);\n        }\n        // No data\n        if (i === 0) {\n            min$$1[0] = min$$1[1] = max$$1[0] = max$$1[1] = 0;\n        }\n\n        return (this._rect = new BoundingRect(\n            min$$1[0], min$$1[1], max$$1[0] - min$$1[0], max$$1[1] - min$$1[1]\n        ));\n    },\n\n    /**\n     * @param {<Array.<number>} coord\n     * @return {boolean}\n     */\n    contain: function (coord) {\n        var rect = this.getBoundingRect();\n        var geometries = this.geometries;\n        if (!rect.contain(coord[0], coord[1])) {\n            return false;\n        }\n        loopGeo: for (var i = 0, len$$1 = geometries.length; i < len$$1; i++) {\n            // Only support polygon.\n            if (geometries[i].type !== 'polygon') {\n                continue;\n            }\n            var exterior = geometries[i].exterior;\n            var interiors = geometries[i].interiors;\n            if (contain$1(exterior, coord[0], coord[1])) {\n                // Not in the region if point is in the hole.\n                for (var k = 0; k < (interiors ? interiors.length : 0); k++) {\n                    if (contain$1(interiors[k])) {\n                        continue loopGeo;\n                    }\n                }\n                return true;\n            }\n        }\n        return false;\n    },\n\n    transformTo: function (x, y, width, height) {\n        var rect = this.getBoundingRect();\n        var aspect = rect.width / rect.height;\n        if (!width) {\n            width = aspect * height;\n        }\n        else if (!height) {\n            height = width / aspect ;\n        }\n        var target = new BoundingRect(x, y, width, height);\n        var transform = rect.calculateTransform(target);\n        var geometries = this.geometries;\n        for (var i = 0; i < geometries.length; i++) {\n            // Only support polygon.\n            if (geometries[i].type !== 'polygon') {\n                continue;\n            }\n            var exterior = geometries[i].exterior;\n            var interiors = geometries[i].interiors;\n            for (var p = 0; p < exterior.length; p++) {\n                applyTransform(exterior[p], exterior[p], transform);\n            }\n            for (var h = 0; h < (interiors ? interiors.length : 0); h++) {\n                for (var p = 0; p < interiors[h].length; p++) {\n                    applyTransform(interiors[h][p], interiors[h][p], transform);\n                }\n            }\n        }\n        rect = this._rect;\n        rect.copy(target);\n        // Update center\n        this.center = [\n            rect.x + rect.width / 2,\n            rect.y + rect.height / 2\n        ];\n    }\n};\n\n/**\n * Parse and decode geo json\n * @module echarts/coord/geo/parseGeoJson\n */\n\nfunction decode(json) {\n    if (!json.UTF8Encoding) {\n        return json;\n    }\n    var encodeScale = json.UTF8Scale;\n    if (encodeScale == null) {\n        encodeScale = 1024;\n    }\n\n    var features = json.features;\n\n    for (var f = 0; f < features.length; f++) {\n        var feature = features[f];\n        var geometry = feature.geometry;\n        var coordinates = geometry.coordinates;\n        var encodeOffsets = geometry.encodeOffsets;\n\n        for (var c = 0; c < coordinates.length; c++) {\n            var coordinate = coordinates[c];\n\n            if (geometry.type === 'Polygon') {\n                coordinates[c] = decodePolygon(\n                    coordinate,\n                    encodeOffsets[c],\n                    encodeScale\n                );\n            }\n            else if (geometry.type === 'MultiPolygon') {\n                for (var c2 = 0; c2 < coordinate.length; c2++) {\n                    var polygon = coordinate[c2];\n                    coordinate[c2] = decodePolygon(\n                        polygon,\n                        encodeOffsets[c][c2],\n                        encodeScale\n                    );\n                }\n            }\n        }\n    }\n    // Has been decoded\n    json.UTF8Encoding = false;\n    return json;\n}\n\nfunction decodePolygon(coordinate, encodeOffsets, encodeScale) {\n    var result = [];\n    var prevX = encodeOffsets[0];\n    var prevY = encodeOffsets[1];\n\n    for (var i = 0; i < coordinate.length; i += 2) {\n        var x = coordinate.charCodeAt(i) - 64;\n        var y = coordinate.charCodeAt(i + 1) - 64;\n        // ZigZag decoding\n        x = (x >> 1) ^ (-(x & 1));\n        y = (y >> 1) ^ (-(y & 1));\n        // Delta deocding\n        x += prevX;\n        y += prevY;\n\n        prevX = x;\n        prevY = y;\n        // Dequantize\n        result.push([x / encodeScale, y / encodeScale]);\n    }\n\n    return result;\n}\n\n/**\n * @alias module:echarts/coord/geo/parseGeoJson\n * @param {Object} geoJson\n * @return {module:zrender/container/Group}\n */\nvar parseGeoJson$1 = function (geoJson) {\n\n    decode(geoJson);\n\n    return map(filter(geoJson.features, function (featureObj) {\n        // Output of mapshaper may have geometry null\n        return featureObj.geometry\n            && featureObj.properties\n            && featureObj.geometry.coordinates.length > 0;\n    }), function (featureObj) {\n        var properties = featureObj.properties;\n        var geo = featureObj.geometry;\n\n        var coordinates = geo.coordinates;\n\n        var geometries = [];\n        if (geo.type === 'Polygon') {\n            geometries.push({\n                type: 'polygon',\n                // According to the GeoJSON specification.\n                // First must be exterior, and the rest are all interior(holes).\n                exterior: coordinates[0],\n                interiors: coordinates.slice(1)\n            });\n        }\n        if (geo.type === 'MultiPolygon') {\n            each$1(coordinates, function (item) {\n                if (item[0]) {\n                    geometries.push({\n                        type: 'polygon',\n                        exterior: item[0],\n                        interiors: item.slice(1)\n                    });\n                }\n            });\n        }\n\n        var region = new Region(\n            properties.name,\n            geometries,\n            properties.cp\n        );\n        region.properties = properties;\n        return region;\n    });\n};\n\nvar linearMap$1 = linearMap;\n\nfunction fixExtentWithBands(extent, nTick) {\n    var size = extent[1] - extent[0];\n    var len = nTick;\n    var margin = size / len / 2;\n    extent[0] += margin;\n    extent[1] -= margin;\n}\n\nvar normalizedExtent = [0, 1];\n/**\n * @name module:echarts/coord/CartesianAxis\n * @constructor\n */\nvar Axis = function (dim, scale, extent) {\n\n    /**\n     * Axis dimension. Such as 'x', 'y', 'z', 'angle', 'radius'\n     * @type {string}\n     */\n    this.dim = dim;\n\n    /**\n     * Axis scale\n     * @type {module:echarts/coord/scale/*}\n     */\n    this.scale = scale;\n\n    /**\n     * @type {Array.<number>}\n     * @private\n     */\n    this._extent = extent || [0, 0];\n\n    /**\n     * @type {boolean}\n     */\n    this.inverse = false;\n\n    /**\n     * Usually true when axis has a ordinal scale\n     * @type {boolean}\n     */\n    this.onBand = false;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this._labelInterval;\n};\n\nAxis.prototype = {\n\n    constructor: Axis,\n\n    /**\n     * If axis extent contain given coord\n     * @param {number} coord\n     * @return {boolean}\n     */\n    contain: function (coord) {\n        var extent = this._extent;\n        var min = Math.min(extent[0], extent[1]);\n        var max = Math.max(extent[0], extent[1]);\n        return coord >= min && coord <= max;\n    },\n\n    /**\n     * If axis extent contain given data\n     * @param {number} data\n     * @return {boolean}\n     */\n    containData: function (data) {\n        return this.contain(this.dataToCoord(data));\n    },\n\n    /**\n     * Get coord extent.\n     * @return {Array.<number>}\n     */\n    getExtent: function () {\n        return this._extent.slice();\n    },\n\n    /**\n     * Get precision used for formatting\n     * @param {Array.<number>} [dataExtent]\n     * @return {number}\n     */\n    getPixelPrecision: function (dataExtent) {\n        return getPixelPrecision(\n            dataExtent || this.scale.getExtent(),\n            this._extent\n        );\n    },\n\n    /**\n     * Set coord extent\n     * @param {number} start\n     * @param {number} end\n     */\n    setExtent: function (start, end) {\n        var extent = this._extent;\n        extent[0] = start;\n        extent[1] = end;\n    },\n\n    /**\n     * Convert data to coord. Data is the rank if it has an ordinal scale\n     * @param {number} data\n     * @param  {boolean} clamp\n     * @return {number}\n     */\n    dataToCoord: function (data, clamp) {\n        var extent = this._extent;\n        var scale = this.scale;\n        data = scale.normalize(data);\n\n        if (this.onBand && scale.type === 'ordinal') {\n            extent = extent.slice();\n            fixExtentWithBands(extent, scale.count());\n        }\n\n        return linearMap$1(data, normalizedExtent, extent, clamp);\n    },\n\n    /**\n     * Convert coord to data. Data is the rank if it has an ordinal scale\n     * @param {number} coord\n     * @param  {boolean} clamp\n     * @return {number}\n     */\n    coordToData: function (coord, clamp) {\n        var extent = this._extent;\n        var scale = this.scale;\n\n        if (this.onBand && scale.type === 'ordinal') {\n            extent = extent.slice();\n            fixExtentWithBands(extent, scale.count());\n        }\n\n        var t = linearMap$1(coord, extent, normalizedExtent, clamp);\n\n        return this.scale.scale(t);\n    },\n\n    /**\n     * Convert pixel point to data in axis\n     * @param {Array.<number>} point\n     * @param  {boolean} clamp\n     * @return {number} data\n     */\n    pointToData: function (point, clamp) {\n        // Should be implemented in derived class if necessary.\n    },\n\n    /**\n     * @return {Array.<number>}\n     */\n    getTicksCoords: function (alignWithLabel) {\n        if (this.onBand && !alignWithLabel) {\n            var bands = this.getBands();\n            var coords = [];\n            for (var i = 0; i < bands.length; i++) {\n                coords.push(bands[i][0]);\n            }\n            if (bands[i - 1]) {\n                coords.push(bands[i - 1][1]);\n            }\n            return coords;\n        }\n        else {\n            return map(this.scale.getTicks(), this.dataToCoord, this);\n        }\n    },\n\n    /**\n     * Coords of labels are on the ticks or on the middle of bands\n     * @return {Array.<number>}\n     */\n    getLabelsCoords: function () {\n        return map(this.scale.getTicks(), this.dataToCoord, this);\n    },\n\n    /**\n     * Get bands.\n     *\n     * If axis has labels [1, 2, 3, 4]. Bands on the axis are\n     * |---1---|---2---|---3---|---4---|.\n     *\n     * @return {Array}\n     */\n        // FIXME Situation when labels is on ticks\n    getBands: function () {\n        var extent = this.getExtent();\n        var bands = [];\n        var len = this.scale.count();\n        var start = extent[0];\n        var end = extent[1];\n        var span = end - start;\n\n        for (var i = 0; i < len; i++) {\n            bands.push([\n                span * i / len + start,\n                span * (i + 1) / len + start\n            ]);\n        }\n        return bands;\n    },\n\n    /**\n     * Get width of band\n     * @return {number}\n     */\n    getBandWidth: function () {\n        var axisExtent = this._extent;\n        var dataExtent = this.scale.getExtent();\n\n        var len = dataExtent[1] - dataExtent[0] + (this.onBand ? 1 : 0);\n        // Fix #2728, avoid NaN when only one data.\n        len === 0 && (len = 1);\n\n        var size = Math.abs(axisExtent[1] - axisExtent[0]);\n\n        return Math.abs(size) / len;\n    },\n\n    /**\n     * @abstract\n     * @return {boolean} Is horizontal\n     */\n    isHorizontal: null,\n\n    /**\n     * @abstract\n     * @return {number} Get axis rotate, by degree.\n     */\n    getRotate: null,\n\n    /**\n     * Get interval of the axis label.\n     * To get precise result, at least one of `getRotate` and `isHorizontal`\n     * should be implemented.\n     * @return {number}\n     */\n    getLabelInterval: function () {\n        var labelInterval = this._labelInterval;\n        if (!labelInterval) {\n            var axisModel = this.model;\n            var labelModel = axisModel.getModel('axisLabel');\n            labelInterval = labelModel.get('interval');\n\n            if (this.type === 'category'\n                && (labelInterval == null || labelInterval === 'auto')\n            ) {\n                labelInterval = getAxisLabelInterval(\n                    map(this.scale.getTicks(), this.dataToCoord, this),\n                    axisModel.getFormattedLabels(),\n                    labelModel.getFont(),\n                    this.getRotate\n                        ? this.getRotate()\n                        : (this.isHorizontal && !this.isHorizontal())\n                        ? 90\n                        : 0,\n                    labelModel.get('rotate')\n                );\n            }\n\n            this._labelInterval = labelInterval;\n        }\n        return labelInterval;\n    }\n\n};\n\n/**\n * Do not mount those modules on 'src/echarts' for better tree shaking.\n */\n\nvar parseGeoJson = parseGeoJson$1;\n\nvar ecUtil = {};\neach$1([\n        'map', 'each', 'filter', 'indexOf', 'inherits', 'reduce', 'filter',\n        'bind', 'curry', 'isArray', 'isString', 'isObject', 'isFunction',\n        'extend', 'defaults', 'clone', 'merge'\n    ],\n    function (name) {\n        ecUtil[name] = zrUtil[name];\n    }\n);\n\nvar DatasetModel = extendComponentModel({\n\n    type: 'dataset',\n\n    /**\n     * @protected\n     */\n    defaultOption: {\n\n        // 'row', 'column'\n        seriesLayoutBy: SERIES_LAYOUT_BY_COLUMN,\n\n        // null/'auto': auto detect header, see \"module:echarts/data/helper/sourceHelper\"\n        sourceHeader: null,\n\n        dimensions: null,\n\n        source: null\n    },\n\n    optionUpdated: function () {\n        detectSourceFormat(this);\n    }\n\n});\n\nextendComponentView({type: 'dataset'});\n\nSeriesModel.extend({\n\n    type: 'series.line',\n\n    dependencies: ['grid', 'polar'],\n\n    getInitialData: function (option, ecModel) {\n        if (__DEV__) {\n            var coordSys = option.coordinateSystem;\n            if (coordSys !== 'polar' && coordSys !== 'cartesian2d') {\n                throw new Error('Line not support coordinateSystem besides cartesian and polar');\n            }\n        }\n        return createListFromArray(this.getSource(), this);\n    },\n\n    defaultOption: {\n        zlevel: 0,                  // \n        z: 2,                       // \n        coordinateSystem: 'cartesian2d',\n        legendHoverLink: true,\n\n        hoverAnimation: true,\n        // stack: null\n        // xAxisIndex: 0,\n        // yAxisIndex: 0,\n\n        // polarIndex: 0,\n\n        // If clip the overflow value\n        clipOverflow: true,\n        // cursor: null,\n\n        label: {\n            position: 'top'\n        },\n        // itemStyle: {\n        // },\n\n        lineStyle: {\n            width: 2,\n            type: 'solid'\n        },\n        // areaStyle: {\n            // origin of areaStyle. Valid values:\n            // `'auto'/null/undefined`: from axisLine to data\n            // `'start'`: from min to data\n            // `'end'`: from data to max\n            // origin: 'auto'\n        // },\n        // false, 'start', 'end', 'middle'\n        step: false,\n\n        // Disabled if step is true\n        smooth: false,\n        smoothMonotone: null,\n        // \n        symbol: 'emptyCircle',\n        // \n        symbolSize: 4,\n        // \n        symbolRotate: null,\n\n        //  symbol,  tooltip hover \n        showSymbol: true,\n        // \n        showAllSymbol: false,\n\n        // \n        connectNulls: false,\n\n        // 'average', 'max', 'min', 'sum'\n        sampling: 'none',\n\n        animationEasing: 'linear',\n\n        // Disable progressive\n        progressive: 0,\n        hoverLayerThreshold: Infinity\n    }\n});\n\n/**\n * @param {module:echarts/data/List} data\n * @param {number} dataIndex\n * @return {string} label string. Not null/undefined\n */\nfunction getDefaultLabel(data, dataIndex) {\n    var labelDims = data.mapDimension('defaultedLabel', true);\n    var len = labelDims.length;\n\n    // Simple optimization (in lots of cases, label dims length is 1)\n    if (len === 1) {\n        return retrieveRawValue(data, dataIndex, labelDims[0]);\n    }\n    else if (len) {\n        var vals = [];\n        for (var i = 0; i < labelDims.length; i++) {\n            var val = retrieveRawValue(data, dataIndex, labelDims[i]);\n            vals.push(val);\n        }\n        return vals.join(' ');\n    }\n}\n\n/**\n * @module echarts/chart/helper/Symbol\n */\n\nfunction getSymbolSize(data, idx) {\n    var symbolSize = data.getItemVisual(idx, 'symbolSize');\n    return symbolSize instanceof Array\n        ? symbolSize.slice()\n        : [+symbolSize, +symbolSize];\n}\n\nfunction getScale(symbolSize) {\n    return [symbolSize[0] / 2, symbolSize[1] / 2];\n}\n\n/**\n * @constructor\n * @alias {module:echarts/chart/helper/Symbol}\n * @param {module:echarts/data/List} data\n * @param {number} idx\n * @extends {module:zrender/graphic/Group}\n */\nfunction SymbolClz$1(data, idx, seriesScope) {\n    Group.call(this);\n    this.updateData(data, idx, seriesScope);\n}\n\nvar symbolProto = SymbolClz$1.prototype;\n\nfunction driftSymbol(dx, dy) {\n    this.parent.drift(dx, dy);\n}\n\nsymbolProto._createSymbol = function (symbolType, data, idx, symbolSize) {\n    // Remove paths created before\n    this.removeAll();\n\n    var color = data.getItemVisual(idx, 'color');\n\n    // var symbolPath = createSymbol(\n    //     symbolType, -0.5, -0.5, 1, 1, color\n    // );\n    // If width/height are set too small (e.g., set to 1) on ios10\n    // and macOS Sierra, a circle stroke become a rect, no matter what\n    // the scale is set. So we set width/height as 2. See #4150.\n    var symbolPath = createSymbol(\n        symbolType, -1, -1, 2, 2, color\n    );\n\n    symbolPath.attr({\n        z2: 100,\n        culling: true,\n        scale: getScale(symbolSize)\n    });\n    // Rewrite drift method\n    symbolPath.drift = driftSymbol;\n\n    this._symbolType = symbolType;\n\n    this.add(symbolPath);\n};\n\n/**\n * Stop animation\n * @param {boolean} toLastFrame\n */\nsymbolProto.stopSymbolAnimation = function (toLastFrame) {\n    this.childAt(0).stopAnimation(toLastFrame);\n};\n\n/**\n * FIXME:\n * Caution: This method breaks the encapsulation of this module,\n * but it indeed brings convenience. So do not use the method\n * unless you detailedly know all the implements of `Symbol`,\n * especially animation.\n *\n * Get symbol path element.\n */\nsymbolProto.getSymbolPath = function () {\n    return this.childAt(0);\n};\n\n/**\n * Get scale(aka, current symbol size).\n * Including the change caused by animation\n */\nsymbolProto.getScale = function () {\n    return this.childAt(0).scale;\n};\n\n/**\n * Highlight symbol\n */\nsymbolProto.highlight = function () {\n    this.childAt(0).trigger('emphasis');\n};\n\n/**\n * Downplay symbol\n */\nsymbolProto.downplay = function () {\n    this.childAt(0).trigger('normal');\n};\n\n/**\n * @param {number} zlevel\n * @param {number} z\n */\nsymbolProto.setZ = function (zlevel, z) {\n    var symbolPath = this.childAt(0);\n    symbolPath.zlevel = zlevel;\n    symbolPath.z = z;\n};\n\nsymbolProto.setDraggable = function (draggable) {\n    var symbolPath = this.childAt(0);\n    symbolPath.draggable = draggable;\n    symbolPath.cursor = draggable ? 'move' : 'pointer';\n};\n\n/**\n * Update symbol properties\n * @param {module:echarts/data/List} data\n * @param {number} idx\n * @param {Object} [seriesScope]\n * @param {Object} [seriesScope.itemStyle]\n * @param {Object} [seriesScope.hoverItemStyle]\n * @param {Object} [seriesScope.symbolRotate]\n * @param {Object} [seriesScope.symbolOffset]\n * @param {module:echarts/model/Model} [seriesScope.labelModel]\n * @param {module:echarts/model/Model} [seriesScope.hoverLabelModel]\n * @param {boolean} [seriesScope.hoverAnimation]\n * @param {Object} [seriesScope.cursorStyle]\n * @param {module:echarts/model/Model} [seriesScope.itemModel]\n * @param {string} [seriesScope.symbolInnerColor]\n * @param {Object} [seriesScope.fadeIn=false]\n */\nsymbolProto.updateData = function (data, idx, seriesScope) {\n    this.silent = false;\n\n    var symbolType = data.getItemVisual(idx, 'symbol') || 'circle';\n    var seriesModel = data.hostModel;\n    var symbolSize = getSymbolSize(data, idx);\n    var isInit = symbolType !== this._symbolType;\n\n    if (isInit) {\n        this._createSymbol(symbolType, data, idx, symbolSize);\n    }\n    else {\n        var symbolPath = this.childAt(0);\n        symbolPath.silent = false;\n        updateProps(symbolPath, {\n            scale: getScale(symbolSize)\n        }, seriesModel, idx);\n    }\n\n    this._updateCommon(data, idx, symbolSize, seriesScope);\n\n    if (isInit) {\n        var symbolPath = this.childAt(0);\n        var fadeIn = seriesScope && seriesScope.fadeIn;\n\n        var target = {scale: symbolPath.scale.slice()};\n        fadeIn && (target.style = {opacity: symbolPath.style.opacity});\n\n        symbolPath.scale = [0, 0];\n        fadeIn && (symbolPath.style.opacity = 0);\n\n        initProps(symbolPath, target, seriesModel, idx);\n    }\n\n    this._seriesModel = seriesModel;\n};\n\n// Update common properties\nvar normalStyleAccessPath = ['itemStyle'];\nvar emphasisStyleAccessPath = ['emphasis', 'itemStyle'];\nvar normalLabelAccessPath = ['label'];\nvar emphasisLabelAccessPath = ['emphasis', 'label'];\n\n/**\n * @param {module:echarts/data/List} data\n * @param {number} idx\n * @param {Array.<number>} symbolSize\n * @param {Object} [seriesScope]\n */\nsymbolProto._updateCommon = function (data, idx, symbolSize, seriesScope) {\n    var symbolPath = this.childAt(0);\n    var seriesModel = data.hostModel;\n    var color = data.getItemVisual(idx, 'color');\n\n    // Reset style\n    if (symbolPath.type !== 'image') {\n        symbolPath.useStyle({\n            strokeNoScale: true\n        });\n    }\n\n    var itemStyle = seriesScope && seriesScope.itemStyle;\n    var hoverItemStyle = seriesScope && seriesScope.hoverItemStyle;\n    var symbolRotate = seriesScope && seriesScope.symbolRotate;\n    var symbolOffset = seriesScope && seriesScope.symbolOffset;\n    var labelModel = seriesScope && seriesScope.labelModel;\n    var hoverLabelModel = seriesScope && seriesScope.hoverLabelModel;\n    var hoverAnimation = seriesScope && seriesScope.hoverAnimation;\n    var cursorStyle = seriesScope && seriesScope.cursorStyle;\n\n    if (!seriesScope || data.hasItemOption) {\n        var itemModel = (seriesScope && seriesScope.itemModel)\n            ? seriesScope.itemModel : data.getItemModel(idx);\n\n        // Color must be excluded.\n        // Because symbol provide setColor individually to set fill and stroke\n        itemStyle = itemModel.getModel(normalStyleAccessPath).getItemStyle(['color']);\n        hoverItemStyle = itemModel.getModel(emphasisStyleAccessPath).getItemStyle();\n\n        symbolRotate = itemModel.getShallow('symbolRotate');\n        symbolOffset = itemModel.getShallow('symbolOffset');\n\n        labelModel = itemModel.getModel(normalLabelAccessPath);\n        hoverLabelModel = itemModel.getModel(emphasisLabelAccessPath);\n        hoverAnimation = itemModel.getShallow('hoverAnimation');\n        cursorStyle = itemModel.getShallow('cursor');\n    }\n    else {\n        hoverItemStyle = extend({}, hoverItemStyle);\n    }\n\n    var elStyle = symbolPath.style;\n\n    symbolPath.attr('rotation', (symbolRotate || 0) * Math.PI / 180 || 0);\n\n    if (symbolOffset) {\n        symbolPath.attr('position', [\n            parsePercent$1(symbolOffset[0], symbolSize[0]),\n            parsePercent$1(symbolOffset[1], symbolSize[1])\n        ]);\n    }\n\n    cursorStyle && symbolPath.attr('cursor', cursorStyle);\n\n    // PENDING setColor before setStyle!!!\n    symbolPath.setColor(color, seriesScope && seriesScope.symbolInnerColor);\n\n    symbolPath.setStyle(itemStyle);\n\n    var opacity = data.getItemVisual(idx, 'opacity');\n    if (opacity != null) {\n        elStyle.opacity = opacity;\n    }\n\n    var useNameLabel = seriesScope && seriesScope.useNameLabel;\n\n    setLabelStyle(\n        elStyle, hoverItemStyle, labelModel, hoverLabelModel,\n        {\n            labelFetcher: seriesModel,\n            labelDataIndex: idx,\n            defaultText: getLabelDefaultText,\n            isRectText: true,\n            autoColor: color\n        }\n    );\n\n    // Do not execute util needed.\n    function getLabelDefaultText(idx, opt) {\n        return useNameLabel ? data.getName(idx) : getDefaultLabel(data, idx);\n    }\n\n    symbolPath.off('mouseover')\n        .off('mouseout')\n        .off('emphasis')\n        .off('normal');\n\n    symbolPath.hoverStyle = hoverItemStyle;\n\n    // FIXME\n    // Do not use symbol.trigger('emphasis'), but use symbol.highlight() instead.\n    setHoverStyle(symbolPath);\n\n    var scale = getScale(symbolSize);\n\n    if (hoverAnimation && seriesModel.isAnimationEnabled()) {\n        var onEmphasis = function() {\n            // Do not support this hover animation util some scenario required.\n            // Animation can only be supported in hover layer when using `el.incremetal`.\n            if (this.incremental) {\n                return;\n            }\n            var ratio = scale[1] / scale[0];\n            this.animateTo({\n                scale: [\n                    Math.max(scale[0] * 1.1, scale[0] + 3),\n                    Math.max(scale[1] * 1.1, scale[1] + 3 * ratio)\n                ]\n            }, 400, 'elasticOut');\n        };\n        var onNormal = function() {\n            if (this.incremental) {\n                return;\n            }\n            this.animateTo({\n                scale: scale\n            }, 400, 'elasticOut');\n        };\n        symbolPath.on('mouseover', onEmphasis)\n            .on('mouseout', onNormal)\n            .on('emphasis', onEmphasis)\n            .on('normal', onNormal);\n    }\n};\n\n/**\n * @param {Function} cb\n * @param {Object} [opt]\n * @param {Object} [opt.keepLabel=true]\n */\nsymbolProto.fadeOut = function (cb, opt) {\n    var symbolPath = this.childAt(0);\n    // Avoid mistaken hover when fading out\n    this.silent = symbolPath.silent = true;\n    // Not show text when animating\n    !(opt && opt.keepLabel) && (symbolPath.style.text = null);\n\n    updateProps(\n        symbolPath,\n        {\n            style: {opacity: 0},\n            scale: [0, 0]\n        },\n        this._seriesModel,\n        this.dataIndex,\n        cb\n    );\n};\n\ninherits(SymbolClz$1, Group);\n\n/**\n * @module echarts/chart/helper/SymbolDraw\n */\n\n/**\n * @constructor\n * @alias module:echarts/chart/helper/SymbolDraw\n * @param {module:zrender/graphic/Group} [symbolCtor]\n */\nfunction SymbolDraw(symbolCtor) {\n    this.group = new Group();\n\n    this._symbolCtor = symbolCtor || SymbolClz$1;\n}\n\nvar symbolDrawProto = SymbolDraw.prototype;\n\nfunction symbolNeedsDraw(data, point, idx, opt) {\n    return point && !isNaN(point[0]) && !isNaN(point[1])\n        && !(opt.isIgnore && opt.isIgnore(idx))\n        // We do not set clipShape on group, because it will\n        // cut part of the symbol element shape.\n        && !(opt.clipShape && !opt.clipShape.contain(point[0], point[1]))\n        && data.getItemVisual(idx, 'symbol') !== 'none';\n}\n/**\n * Update symbols draw by new data\n * @param {module:echarts/data/List} data\n * @param {Object} [opt] Or isIgnore\n * @param {Function} [opt.isIgnore]\n * @param {Object} [opt.clipShape]\n */\nsymbolDrawProto.updateData = function (data, opt) {\n    opt = normalizeUpdateOpt(opt);\n\n    var group = this.group;\n    var seriesModel = data.hostModel;\n    var oldData = this._data;\n    var SymbolCtor = this._symbolCtor;\n\n    var seriesScope = makeSeriesScope(data);\n\n    // There is no oldLineData only when first rendering or switching from\n    // stream mode to normal mode, where previous elements should be removed.\n    if (!oldData) {\n        group.removeAll();\n    }\n\n    data.diff(oldData)\n        .add(function (newIdx) {\n            var point = data.getItemLayout(newIdx);\n            if (symbolNeedsDraw(data, point, newIdx, opt)) {\n                var symbolEl = new SymbolCtor(data, newIdx, seriesScope);\n                symbolEl.attr('position', point);\n                data.setItemGraphicEl(newIdx, symbolEl);\n                group.add(symbolEl);\n            }\n        })\n        .update(function (newIdx, oldIdx) {\n            var symbolEl = oldData.getItemGraphicEl(oldIdx);\n            var point = data.getItemLayout(newIdx);\n            if (!symbolNeedsDraw(data, point, newIdx, opt)) {\n                group.remove(symbolEl);\n                return;\n            }\n            if (!symbolEl) {\n                symbolEl = new SymbolCtor(data, newIdx);\n                symbolEl.attr('position', point);\n            }\n            else {\n                symbolEl.updateData(data, newIdx, seriesScope);\n                updateProps(symbolEl, {\n                    position: point\n                }, seriesModel);\n            }\n\n            // Add back\n            group.add(symbolEl);\n\n            data.setItemGraphicEl(newIdx, symbolEl);\n        })\n        .remove(function (oldIdx) {\n            var el = oldData.getItemGraphicEl(oldIdx);\n            el && el.fadeOut(function () {\n                group.remove(el);\n            });\n        })\n        .execute();\n\n    this._data = data;\n};\n\nsymbolDrawProto.isPersistent = function () {\n    return true;\n};\n\nsymbolDrawProto.updateLayout = function () {\n    var data = this._data;\n    if (data) {\n        // Not use animation\n        data.eachItemGraphicEl(function (el, idx) {\n            var point = data.getItemLayout(idx);\n            el.attr('position', point);\n        });\n    }\n};\n\nsymbolDrawProto.incrementalPrepareUpdate = function (data) {\n    this._seriesScope = makeSeriesScope(data);\n    this._data = null;\n    this.group.removeAll();\n};\n\n/**\n * Update symbols draw by new data\n * @param {module:echarts/data/List} data\n * @param {Object} [opt] Or isIgnore\n * @param {Function} [opt.isIgnore]\n * @param {Object} [opt.clipShape]\n */\nsymbolDrawProto.incrementalUpdate = function (taskParams, data, opt) {\n    opt = normalizeUpdateOpt(opt);\n\n    function updateIncrementalAndHover(el) {\n        if (!el.isGroup) {\n            el.incremental = el.useHoverLayer = true;\n        }\n    }\n    for (var idx = taskParams.start; idx < taskParams.end; idx++) {\n        var point = data.getItemLayout(idx);\n        if (symbolNeedsDraw(data, point, idx, opt)) {\n            var el = new this._symbolCtor(data, idx, this._seriesScope);\n            el.traverse(updateIncrementalAndHover);\n            el.attr('position', point);\n            this.group.add(el);\n            data.setItemGraphicEl(idx, el);\n        }\n    }\n};\n\nfunction normalizeUpdateOpt(opt) {\n    if (opt != null && !isObject$1(opt)) {\n        opt = {isIgnore: opt};\n    }\n    return opt || {};\n}\n\nsymbolDrawProto.remove = function (enableAnimation) {\n    var group = this.group;\n    var data = this._data;\n    // Incremental model do not have this._data.\n    if (data && enableAnimation) {\n        data.eachItemGraphicEl(function (el) {\n            el.fadeOut(function () {\n                group.remove(el);\n            });\n        });\n    }\n    else {\n        group.removeAll();\n    }\n};\n\nfunction makeSeriesScope(data) {\n    var seriesModel = data.hostModel;\n    return {\n        itemStyle: seriesModel.getModel('itemStyle').getItemStyle(['color']),\n        hoverItemStyle: seriesModel.getModel('emphasis.itemStyle').getItemStyle(),\n        symbolRotate: seriesModel.get('symbolRotate'),\n        symbolOffset: seriesModel.get('symbolOffset'),\n        hoverAnimation: seriesModel.get('hoverAnimation'),\n        labelModel: seriesModel.getModel('label'),\n        hoverLabelModel: seriesModel.getModel('emphasis.label'),\n        cursorStyle: seriesModel.get('cursor')\n    };\n}\n\n/**\n * @param {Object} coordSys\n * @param {module:echarts/data/List} data\n * @param {string} valueOrigin lineSeries.option.areaStyle.origin\n */\nfunction prepareDataCoordInfo(coordSys, data, valueOrigin) {\n    var baseAxis = coordSys.getBaseAxis();\n    var valueAxis = coordSys.getOtherAxis(baseAxis);\n    var valueStart = getValueStart(valueAxis, valueOrigin);\n\n    var baseAxisDim = baseAxis.dim;\n    var valueAxisDim = valueAxis.dim;\n    var valueDim = data.mapDimension(valueAxisDim);\n    var baseDim = data.mapDimension(baseAxisDim);\n    var baseDataOffset = valueAxisDim === 'x' || valueAxisDim === 'radius' ? 1 : 0;\n\n    var stacked = isDimensionStacked(data, valueDim, baseDim);\n\n    var dataDimsForPoint = map(coordSys.dimensions, function (coordDim) {\n        return data.mapDimension(coordDim);\n    });\n\n    return {\n        dataDimsForPoint: dataDimsForPoint,\n        valueStart: valueStart,\n        valueAxisDim: valueAxisDim,\n        baseAxisDim: baseAxisDim,\n        stacked: stacked,\n        valueDim: valueDim,\n        baseDim: baseDim,\n        baseDataOffset: baseDataOffset,\n        stackedOverDimension: data.getCalculationInfo('stackedOverDimension')\n    };\n}\n\nfunction getValueStart(valueAxis, valueOrigin) {\n    var valueStart = 0;\n    var extent = valueAxis.scale.getExtent();\n\n    if (valueOrigin === 'start') {\n        valueStart = extent[0];\n    }\n    else if (valueOrigin === 'end') {\n        valueStart = extent[1];\n    }\n    // auto\n    else {\n        // Both positive\n        if (extent[0] > 0) {\n            valueStart = extent[0];\n        }\n        // Both negative\n        else if (extent[1] < 0) {\n            valueStart = extent[1];\n        }\n        // If is one positive, and one negative, onZero shall be true\n    }\n\n    return valueStart;\n}\n\nfunction getStackedOnPoint(dataCoordInfo, coordSys, data, idx) {\n    var value = NaN;\n    if (dataCoordInfo.stacked) {\n        value = data.get(data.getCalculationInfo('stackedOverDimension'), idx);\n    }\n    if (isNaN(value)) {\n        value = dataCoordInfo.valueStart;\n    }\n\n    var baseDataOffset = dataCoordInfo.baseDataOffset;\n    var stackedData = [];\n    stackedData[baseDataOffset] = data.get(dataCoordInfo.baseDim, idx);\n    stackedData[1 - baseDataOffset] = value;\n\n    return coordSys.dataToPoint(stackedData);\n}\n\n// var arrayDiff = require('zrender/src/core/arrayDiff');\n// 'zrender/src/core/arrayDiff' has been used before, but it did\n// not do well in performance when roam with fixed dataZoom window.\n\n// function convertToIntId(newIdList, oldIdList) {\n//     // Generate int id instead of string id.\n//     // Compare string maybe slow in score function of arrDiff\n\n//     // Assume id in idList are all unique\n//     var idIndicesMap = {};\n//     var idx = 0;\n//     for (var i = 0; i < newIdList.length; i++) {\n//         idIndicesMap[newIdList[i]] = idx;\n//         newIdList[i] = idx++;\n//     }\n//     for (var i = 0; i < oldIdList.length; i++) {\n//         var oldId = oldIdList[i];\n//         // Same with newIdList\n//         if (idIndicesMap[oldId]) {\n//             oldIdList[i] = idIndicesMap[oldId];\n//         }\n//         else {\n//             oldIdList[i] = idx++;\n//         }\n//     }\n// }\n\nfunction diffData(oldData, newData) {\n    var diffResult = [];\n\n    newData.diff(oldData)\n        .add(function (idx) {\n            diffResult.push({cmd: '+', idx: idx});\n        })\n        .update(function (newIdx, oldIdx) {\n            diffResult.push({cmd: '=', idx: oldIdx, idx1: newIdx});\n        })\n        .remove(function (idx) {\n            diffResult.push({cmd: '-', idx: idx});\n        })\n        .execute();\n\n    return diffResult;\n}\n\nvar lineAnimationDiff = function (\n    oldData, newData,\n    oldStackedOnPoints, newStackedOnPoints,\n    oldCoordSys, newCoordSys,\n    oldValueOrigin, newValueOrigin\n) {\n    var diff = diffData(oldData, newData);\n\n    // var newIdList = newData.mapArray(newData.getId);\n    // var oldIdList = oldData.mapArray(oldData.getId);\n\n    // convertToIntId(newIdList, oldIdList);\n\n    // // FIXME One data ?\n    // diff = arrayDiff(oldIdList, newIdList);\n\n    var currPoints = [];\n    var nextPoints = [];\n    // Points for stacking base line\n    var currStackedPoints = [];\n    var nextStackedPoints = [];\n\n    var status = [];\n    var sortedIndices = [];\n    var rawIndices = [];\n\n    var newDataOldCoordInfo = prepareDataCoordInfo(oldCoordSys, newData, oldValueOrigin);\n    var oldDataNewCoordInfo = prepareDataCoordInfo(newCoordSys, oldData, newValueOrigin);\n\n    for (var i = 0; i < diff.length; i++) {\n        var diffItem = diff[i];\n        var pointAdded = true;\n\n        // FIXME, animation is not so perfect when dataZoom window moves fast\n        // Which is in case remvoing or add more than one data in the tail or head\n        switch (diffItem.cmd) {\n            case '=':\n                var currentPt = oldData.getItemLayout(diffItem.idx);\n                var nextPt = newData.getItemLayout(diffItem.idx1);\n                // If previous data is NaN, use next point directly\n                if (isNaN(currentPt[0]) || isNaN(currentPt[1])) {\n                    currentPt = nextPt.slice();\n                }\n                currPoints.push(currentPt);\n                nextPoints.push(nextPt);\n\n                currStackedPoints.push(oldStackedOnPoints[diffItem.idx]);\n                nextStackedPoints.push(newStackedOnPoints[diffItem.idx1]);\n\n                rawIndices.push(newData.getRawIndex(diffItem.idx1));\n                break;\n            case '+':\n                var idx = diffItem.idx;\n                currPoints.push(\n                    oldCoordSys.dataToPoint([\n                        newData.get(newDataOldCoordInfo.dataDimsForPoint[0], idx),\n                        newData.get(newDataOldCoordInfo.dataDimsForPoint[1], idx)\n                    ])\n                );\n\n                nextPoints.push(newData.getItemLayout(idx).slice());\n\n                currStackedPoints.push(\n                    getStackedOnPoint(newDataOldCoordInfo, oldCoordSys, newData, idx)\n                );\n                nextStackedPoints.push(newStackedOnPoints[idx]);\n\n                rawIndices.push(newData.getRawIndex(idx));\n                break;\n            case '-':\n                var idx = diffItem.idx;\n                var rawIndex = oldData.getRawIndex(idx);\n                // Data is replaced. In the case of dynamic data queue\n                // FIXME FIXME FIXME\n                if (rawIndex !== idx) {\n                    currPoints.push(oldData.getItemLayout(idx));\n                    nextPoints.push(newCoordSys.dataToPoint([\n                        oldData.get(oldDataNewCoordInfo.dataDimsForPoint[0], idx),\n                        oldData.get(oldDataNewCoordInfo.dataDimsForPoint[1], idx)\n                    ]));\n\n                    currStackedPoints.push(oldStackedOnPoints[idx]);\n                    nextStackedPoints.push(\n                        getStackedOnPoint(oldDataNewCoordInfo, newCoordSys, oldData, idx)\n                    );\n\n                    rawIndices.push(rawIndex);\n                }\n                else {\n                    pointAdded = false;\n                }\n        }\n\n        // Original indices\n        if (pointAdded) {\n            status.push(diffItem);\n            sortedIndices.push(sortedIndices.length);\n        }\n    }\n\n    // Diff result may be crossed if all items are changed\n    // Sort by data index\n    sortedIndices.sort(function (a, b) {\n        return rawIndices[a] - rawIndices[b];\n    });\n\n    var sortedCurrPoints = [];\n    var sortedNextPoints = [];\n\n    var sortedCurrStackedPoints = [];\n    var sortedNextStackedPoints = [];\n\n    var sortedStatus = [];\n    for (var i = 0; i < sortedIndices.length; i++) {\n        var idx = sortedIndices[i];\n        sortedCurrPoints[i] = currPoints[idx];\n        sortedNextPoints[i] = nextPoints[idx];\n\n        sortedCurrStackedPoints[i] = currStackedPoints[idx];\n        sortedNextStackedPoints[i] = nextStackedPoints[idx];\n\n        sortedStatus[i] = status[idx];\n    }\n\n    return {\n        current: sortedCurrPoints,\n        next: sortedNextPoints,\n\n        stackedOnCurrent: sortedCurrStackedPoints,\n        stackedOnNext: sortedNextStackedPoints,\n\n        status: sortedStatus\n    };\n};\n\n// Poly path support NaN point\n\nvar vec2Min = min;\nvar vec2Max = max;\n\nvar scaleAndAdd$1 = scaleAndAdd;\nvar v2Copy = copy;\n\n// Temporary variable\nvar v = [];\nvar cp0 = [];\nvar cp1 = [];\n\nfunction isPointNull(p) {\n    return isNaN(p[0]) || isNaN(p[1]);\n}\n\nfunction drawSegment(\n    ctx, points, start, segLen, allLen,\n    dir, smoothMin, smoothMax, smooth, smoothMonotone, connectNulls\n) {\n    if (smoothMonotone == null) {\n        if (isMono(points, 'x')) {\n            return drawMono(ctx, points, start, segLen, allLen,\n                dir, smoothMin, smoothMax, smooth, 'x', connectNulls);\n        }\n        else if (isMono(points, 'y')) {\n            return drawMono(ctx, points, start, segLen, allLen,\n                dir, smoothMin, smoothMax, smooth, 'y', connectNulls);\n        }\n        else {\n            return drawNonMono.apply(this, arguments);\n        }\n    }\n    else if (smoothMonotone !== 'none' && isMono(points, smoothMonotone)) {\n        return drawMono.apply(this, arguments);\n    }\n    else {\n        return drawNonMono.apply(this, arguments);\n    }\n}\n\n/**\n * Check if points is in monotone.\n *\n * @param {number[][]} points         Array of points which is in [x, y] form\n * @param {string}     smoothMonotone 'x', 'y', or 'none', stating for which\n *                                    dimension that is checking.\n *                                    If is 'none', `drawNonMono` should be\n *                                    called.\n *                                    If is undefined, either being monotone\n *                                    in 'x' or 'y' will call `drawMono`.\n */\nfunction isMono(points, smoothMonotone) {\n    if (points.length <= 1) {\n        return true;\n    }\n\n    var dim = smoothMonotone === 'x' ? 0 : 1;\n    var last = points[0][dim];\n    var lastDiff = 0;\n    for (var i = 1; i < points.length; ++i) {\n        var diff = points[i][dim] - last;\n        if (!isNaN(diff) && !isNaN(lastDiff)\n            && diff !== 0 && lastDiff !== 0\n            && ((diff >= 0) !== (lastDiff >= 0))\n        ) {\n            return false;\n        }\n        if (!isNaN(diff) && diff !== 0) {\n            lastDiff = diff;\n            last = points[i][dim];\n        }\n    }\n    return true;\n}\n\n/**\n * Draw smoothed line in monotone, in which only vertical or horizontal bezier\n * control points will be used. This should be used when points are monotone\n * either in x or y dimension.\n */\nfunction drawMono(\n    ctx, points, start, segLen, allLen,\n    dir, smoothMin, smoothMax, smooth, smoothMonotone, connectNulls\n) {\n    var prevIdx = 0;\n    var idx = start;\n    for (var k = 0; k < segLen; k++) {\n        var p = points[idx];\n        if (idx >= allLen || idx < 0) {\n            break;\n        }\n        if (isPointNull(p)) {\n            if (connectNulls) {\n                idx += dir;\n                continue;\n            }\n            break;\n        }\n\n        if (idx === start) {\n            ctx[dir > 0 ? 'moveTo' : 'lineTo'](p[0], p[1]);\n        }\n        else {\n            if (smooth > 0) {\n                var prevP = points[prevIdx];\n                var dim = smoothMonotone === 'y' ? 1 : 0;\n\n                // Length of control point to p, either in x or y, but not both\n                var ctrlLen = (p[dim] - prevP[dim]) * smooth;\n\n                v2Copy(cp0, prevP);\n                cp0[dim] = prevP[dim] + ctrlLen;\n\n                v2Copy(cp1, p);\n                cp1[dim] = p[dim] - ctrlLen;\n\n                ctx.bezierCurveTo(\n                    cp0[0], cp0[1],\n                    cp1[0], cp1[1],\n                    p[0], p[1]\n                );\n            }\n            else {\n                ctx.lineTo(p[0], p[1]);\n            }\n        }\n\n        prevIdx = idx;\n        idx += dir;\n    }\n\n    return k;\n}\n\n/**\n * Draw smoothed line in non-monotone, in may cause undesired curve in extreme\n * situations. This should be used when points are non-monotone neither in x or\n * y dimension.\n */\nfunction drawNonMono(\n    ctx, points, start, segLen, allLen,\n    dir, smoothMin, smoothMax, smooth, smoothMonotone, connectNulls\n) {\n    var prevIdx = 0;\n    var idx = start;\n    for (var k = 0; k < segLen; k++) {\n        var p = points[idx];\n        if (idx >= allLen || idx < 0) {\n            break;\n        }\n        if (isPointNull(p)) {\n            if (connectNulls) {\n                idx += dir;\n                continue;\n            }\n            break;\n        }\n\n        if (idx === start) {\n            ctx[dir > 0 ? 'moveTo' : 'lineTo'](p[0], p[1]);\n            v2Copy(cp0, p);\n        }\n        else {\n            if (smooth > 0) {\n                var nextIdx = idx + dir;\n                var nextP = points[nextIdx];\n                if (connectNulls) {\n                    // Find next point not null\n                    while (nextP && isPointNull(points[nextIdx])) {\n                        nextIdx += dir;\n                        nextP = points[nextIdx];\n                    }\n                }\n\n                var ratioNextSeg = 0.5;\n                var prevP = points[prevIdx];\n                var nextP = points[nextIdx];\n                // Last point\n                if (!nextP || isPointNull(nextP)) {\n                    v2Copy(cp1, p);\n                }\n                else {\n                    // If next data is null in not connect case\n                    if (isPointNull(nextP) && !connectNulls) {\n                        nextP = p;\n                    }\n\n                    sub(v, nextP, prevP);\n\n                    var lenPrevSeg;\n                    var lenNextSeg;\n                    if (smoothMonotone === 'x' || smoothMonotone === 'y') {\n                        var dim = smoothMonotone === 'x' ? 0 : 1;\n                        lenPrevSeg = Math.abs(p[dim] - prevP[dim]);\n                        lenNextSeg = Math.abs(p[dim] - nextP[dim]);\n                    }\n                    else {\n                        lenPrevSeg = dist(p, prevP);\n                        lenNextSeg = dist(p, nextP);\n                    }\n\n                    // Use ratio of seg length\n                    ratioNextSeg = lenNextSeg / (lenNextSeg + lenPrevSeg);\n\n                    scaleAndAdd$1(cp1, p, v, -smooth * (1 - ratioNextSeg));\n                }\n                // Smooth constraint\n                vec2Min(cp0, cp0, smoothMax);\n                vec2Max(cp0, cp0, smoothMin);\n                vec2Min(cp1, cp1, smoothMax);\n                vec2Max(cp1, cp1, smoothMin);\n\n                ctx.bezierCurveTo(\n                    cp0[0], cp0[1],\n                    cp1[0], cp1[1],\n                    p[0], p[1]\n                );\n                // cp0 of next segment\n                scaleAndAdd$1(cp0, p, v, smooth * ratioNextSeg);\n            }\n            else {\n                ctx.lineTo(p[0], p[1]);\n            }\n        }\n\n        prevIdx = idx;\n        idx += dir;\n    }\n\n    return k;\n}\n\nfunction getBoundingBox(points, smoothConstraint) {\n    var ptMin = [Infinity, Infinity];\n    var ptMax = [-Infinity, -Infinity];\n    if (smoothConstraint) {\n        for (var i = 0; i < points.length; i++) {\n            var pt = points[i];\n            if (pt[0] < ptMin[0]) { ptMin[0] = pt[0]; }\n            if (pt[1] < ptMin[1]) { ptMin[1] = pt[1]; }\n            if (pt[0] > ptMax[0]) { ptMax[0] = pt[0]; }\n            if (pt[1] > ptMax[1]) { ptMax[1] = pt[1]; }\n        }\n    }\n    return {\n        min: smoothConstraint ? ptMin : ptMax,\n        max: smoothConstraint ? ptMax : ptMin\n    };\n}\n\nvar Polyline$1 = Path.extend({\n\n    type: 'ec-polyline',\n\n    shape: {\n        points: [],\n\n        smooth: 0,\n\n        smoothConstraint: true,\n\n        smoothMonotone: null,\n\n        connectNulls: false\n    },\n\n    style: {\n        fill: null,\n\n        stroke: '#000'\n    },\n\n    brush: fixClipWithShadow(Path.prototype.brush),\n\n    buildPath: function (ctx, shape) {\n        var points = shape.points;\n\n        var i = 0;\n        var len$$1 = points.length;\n\n        var result = getBoundingBox(points, shape.smoothConstraint);\n\n        if (shape.connectNulls) {\n            // Must remove first and last null values avoid draw error in polygon\n            for (; len$$1 > 0; len$$1--) {\n                if (!isPointNull(points[len$$1 - 1])) {\n                    break;\n                }\n            }\n            for (; i < len$$1; i++) {\n                if (!isPointNull(points[i])) {\n                    break;\n                }\n            }\n        }\n        while (i < len$$1) {\n            i += drawSegment(\n                ctx, points, i, len$$1, len$$1,\n                1, result.min, result.max, shape.smooth,\n                shape.smoothMonotone, shape.connectNulls\n            ) + 1;\n        }\n    }\n});\n\nvar Polygon$1 = Path.extend({\n\n    type: 'ec-polygon',\n\n    shape: {\n        points: [],\n\n        // Offset between stacked base points and points\n        stackedOnPoints: [],\n\n        smooth: 0,\n\n        stackedOnSmooth: 0,\n\n        smoothConstraint: true,\n\n        smoothMonotone: null,\n\n        connectNulls: false\n    },\n\n    brush: fixClipWithShadow(Path.prototype.brush),\n\n    buildPath: function (ctx, shape) {\n        var points = shape.points;\n        var stackedOnPoints = shape.stackedOnPoints;\n\n        var i = 0;\n        var len$$1 = points.length;\n        var smoothMonotone = shape.smoothMonotone;\n        var bbox = getBoundingBox(points, shape.smoothConstraint);\n        var stackedOnBBox = getBoundingBox(stackedOnPoints, shape.smoothConstraint);\n\n        if (shape.connectNulls) {\n            // Must remove first and last null values avoid draw error in polygon\n            for (; len$$1 > 0; len$$1--) {\n                if (!isPointNull(points[len$$1 - 1])) {\n                    break;\n                }\n            }\n            for (; i < len$$1; i++) {\n                if (!isPointNull(points[i])) {\n                    break;\n                }\n            }\n        }\n        while (i < len$$1) {\n            var k = drawSegment(\n                ctx, points, i, len$$1, len$$1,\n                1, bbox.min, bbox.max, shape.smooth,\n                smoothMonotone, shape.connectNulls\n            );\n            drawSegment(\n                ctx, stackedOnPoints, i + k - 1, k, len$$1,\n                -1, stackedOnBBox.min, stackedOnBBox.max, shape.stackedOnSmooth,\n                smoothMonotone, shape.connectNulls\n            );\n            i += k + 1;\n\n            ctx.closePath();\n        }\n    }\n});\n\n// FIXME step not support polar\n\nfunction isPointsSame(points1, points2) {\n    if (points1.length !== points2.length) {\n        return;\n    }\n    for (var i = 0; i < points1.length; i++) {\n        var p1 = points1[i];\n        var p2 = points2[i];\n        if (p1[0] !== p2[0] || p1[1] !== p2[1]) {\n            return;\n        }\n    }\n    return true;\n}\n\nfunction getSmooth(smooth) {\n    return typeof (smooth) === 'number' ? smooth : (smooth ? 0.5 : 0);\n}\n\nfunction getAxisExtentWithGap(axis) {\n    var extent = axis.getGlobalExtent();\n    if (axis.onBand) {\n        // Remove extra 1px to avoid line miter in clipped edge\n        var halfBandWidth = axis.getBandWidth() / 2 - 1;\n        var dir = extent[1] > extent[0] ? 1 : -1;\n        extent[0] += dir * halfBandWidth;\n        extent[1] -= dir * halfBandWidth;\n    }\n    return extent;\n}\n\n/**\n * @param {module:echarts/coord/cartesian/Cartesian2D|module:echarts/coord/polar/Polar} coordSys\n * @param {module:echarts/data/List} data\n * @param {Object} dataCoordInfo\n * @param {Array.<Array.<number>>} points\n */\nfunction getStackedOnPoints(coordSys, data, dataCoordInfo) {\n    if (!dataCoordInfo.valueDim) {\n        return [];\n    }\n\n    var points = [];\n    for (var idx = 0, len = data.count(); idx < len; idx++) {\n        points.push(getStackedOnPoint(dataCoordInfo, coordSys, data, idx));\n    }\n\n    return points;\n}\n\nfunction createGridClipShape(cartesian, hasAnimation, seriesModel) {\n    var xExtent = getAxisExtentWithGap(cartesian.getAxis('x'));\n    var yExtent = getAxisExtentWithGap(cartesian.getAxis('y'));\n    var isHorizontal = cartesian.getBaseAxis().isHorizontal();\n\n    var x = Math.min(xExtent[0], xExtent[1]);\n    var y = Math.min(yExtent[0], yExtent[1]);\n    var width = Math.max(xExtent[0], xExtent[1]) - x;\n    var height = Math.max(yExtent[0], yExtent[1]) - y;\n    var lineWidth = seriesModel.get('lineStyle.width') || 2;\n    // Expand clip shape to avoid clipping when line value exceeds axis\n    var expandSize = seriesModel.get('clipOverflow') ? lineWidth / 2 : Math.max(width, height);\n    if (isHorizontal) {\n        y -= expandSize;\n        height += expandSize * 2;\n    }\n    else {\n        x -= expandSize;\n        width += expandSize * 2;\n    }\n\n    var clipPath = new Rect({\n        shape: {\n            x: x,\n            y: y,\n            width: width,\n            height: height\n        }\n    });\n\n    if (hasAnimation) {\n        clipPath.shape[isHorizontal ? 'width' : 'height'] = 0;\n        initProps(clipPath, {\n            shape: {\n                width: width,\n                height: height\n            }\n        }, seriesModel);\n    }\n\n    return clipPath;\n}\n\nfunction createPolarClipShape(polar, hasAnimation, seriesModel) {\n    var angleAxis = polar.getAngleAxis();\n    var radiusAxis = polar.getRadiusAxis();\n\n    var radiusExtent = radiusAxis.getExtent();\n    var angleExtent = angleAxis.getExtent();\n\n    var RADIAN = Math.PI / 180;\n\n    var clipPath = new Sector({\n        shape: {\n            cx: polar.cx,\n            cy: polar.cy,\n            r0: radiusExtent[0],\n            r: radiusExtent[1],\n            startAngle: -angleExtent[0] * RADIAN,\n            endAngle: -angleExtent[1] * RADIAN,\n            clockwise: angleAxis.inverse\n        }\n    });\n\n    if (hasAnimation) {\n        clipPath.shape.endAngle = -angleExtent[0] * RADIAN;\n        initProps(clipPath, {\n            shape: {\n                endAngle: -angleExtent[1] * RADIAN\n            }\n        }, seriesModel);\n    }\n\n    return clipPath;\n}\n\nfunction createClipShape(coordSys, hasAnimation, seriesModel) {\n    return coordSys.type === 'polar'\n        ? createPolarClipShape(coordSys, hasAnimation, seriesModel)\n        : createGridClipShape(coordSys, hasAnimation, seriesModel);\n}\n\nfunction turnPointsIntoStep(points, coordSys, stepTurnAt) {\n    var baseAxis = coordSys.getBaseAxis();\n    var baseIndex = baseAxis.dim === 'x' || baseAxis.dim === 'radius' ? 0 : 1;\n\n    var stepPoints = [];\n    for (var i = 0; i < points.length - 1; i++) {\n        var nextPt = points[i + 1];\n        var pt = points[i];\n        stepPoints.push(pt);\n\n        var stepPt = [];\n        switch (stepTurnAt) {\n            case 'end':\n                stepPt[baseIndex] = nextPt[baseIndex];\n                stepPt[1 - baseIndex] = pt[1 - baseIndex];\n                // default is start\n                stepPoints.push(stepPt);\n                break;\n            case 'middle':\n                // default is start\n                var middle = (pt[baseIndex] + nextPt[baseIndex]) / 2;\n                var stepPt2 = [];\n                stepPt[baseIndex] = stepPt2[baseIndex] = middle;\n                stepPt[1 - baseIndex] = pt[1 - baseIndex];\n                stepPt2[1 - baseIndex] = nextPt[1 - baseIndex];\n                stepPoints.push(stepPt);\n                stepPoints.push(stepPt2);\n                break;\n            default:\n                stepPt[baseIndex] = pt[baseIndex];\n                stepPt[1 - baseIndex] = nextPt[1 - baseIndex];\n                // default is start\n                stepPoints.push(stepPt);\n        }\n    }\n    // Last points\n    points[i] && stepPoints.push(points[i]);\n    return stepPoints;\n}\n\nfunction getVisualGradient(data, coordSys) {\n    var visualMetaList = data.getVisual('visualMeta');\n    if (!visualMetaList || !visualMetaList.length || !data.count()) {\n        // When data.count() is 0, gradient range can not be calculated.\n        return;\n    }\n\n    if (coordSys.type !== 'cartesian2d') {\n        if (__DEV__) {\n            console.warn('Visual map on line style is only supported on cartesian2d.');\n        }\n        return;\n    }\n\n    var coordDim;\n    var visualMeta;\n\n    for (var i = visualMetaList.length - 1; i >= 0; i--) {\n        var dimIndex = visualMetaList[i].dimension;\n        var dimName = data.dimensions[dimIndex];\n        var dimInfo = data.getDimensionInfo(dimName);\n        coordDim = dimInfo && dimInfo.coordDim;\n        // Can only be x or y\n        if (coordDim === 'x' || coordDim === 'y') {\n            visualMeta = visualMetaList[i];\n            break;\n        }\n    }\n\n    if (!visualMeta) {\n        if (__DEV__) {\n            console.warn('Visual map on line style only support x or y dimension.');\n        }\n        return;\n    }\n\n    // If the area to be rendered is bigger than area defined by LinearGradient,\n    // the canvas spec prescribes that the color of the first stop and the last\n    // stop should be used. But if two stops are added at offset 0, in effect\n    // browsers use the color of the second stop to render area outside\n    // LinearGradient. So we can only infinitesimally extend area defined in\n    // LinearGradient to render `outerColors`.\n\n    var axis = coordSys.getAxis(coordDim);\n\n    // dataToCoor mapping may not be linear, but must be monotonic.\n    var colorStops = map(visualMeta.stops, function (stop) {\n        return {\n            coord: axis.toGlobalCoord(axis.dataToCoord(stop.value)),\n            color: stop.color\n        };\n    });\n    var stopLen = colorStops.length;\n    var outerColors = visualMeta.outerColors.slice();\n\n    if (stopLen && colorStops[0].coord > colorStops[stopLen - 1].coord) {\n        colorStops.reverse();\n        outerColors.reverse();\n    }\n\n    var tinyExtent = 10; // Arbitrary value: 10px\n    var minCoord = colorStops[0].coord - tinyExtent;\n    var maxCoord = colorStops[stopLen - 1].coord + tinyExtent;\n    var coordSpan = maxCoord - minCoord;\n\n    if (coordSpan < 1e-3) {\n        return 'transparent';\n    }\n\n    each$1(colorStops, function (stop) {\n        stop.offset = (stop.coord - minCoord) / coordSpan;\n    });\n    colorStops.push({\n        offset: stopLen ? colorStops[stopLen - 1].offset : 0.5,\n        color: outerColors[1] || 'transparent'\n    });\n    colorStops.unshift({ // notice colorStops.length have been changed.\n        offset: stopLen ? colorStops[0].offset : 0.5,\n        color: outerColors[0] || 'transparent'\n    });\n\n    // zrUtil.each(colorStops, function (colorStop) {\n    //     // Make sure each offset has rounded px to avoid not sharp edge\n    //     colorStop.offset = (Math.round(colorStop.offset * (end - start) + start) - start) / (end - start);\n    // });\n\n    var gradient = new LinearGradient(0, 0, 0, 0, colorStops, true);\n    gradient[coordDim] = minCoord;\n    gradient[coordDim + '2'] = maxCoord;\n\n    return gradient;\n}\n\nChart.extend({\n\n    type: 'line',\n\n    init: function () {\n        var lineGroup = new Group();\n\n        var symbolDraw = new SymbolDraw();\n        this.group.add(symbolDraw.group);\n\n        this._symbolDraw = symbolDraw;\n        this._lineGroup = lineGroup;\n    },\n\n    render: function (seriesModel, ecModel, api) {\n        var coordSys = seriesModel.coordinateSystem;\n        var group = this.group;\n        var data = seriesModel.getData();\n        var lineStyleModel = seriesModel.getModel('lineStyle');\n        var areaStyleModel = seriesModel.getModel('areaStyle');\n\n        var points = data.mapArray(data.getItemLayout);\n\n        var isCoordSysPolar = coordSys.type === 'polar';\n        var prevCoordSys = this._coordSys;\n\n        var symbolDraw = this._symbolDraw;\n        var polyline = this._polyline;\n        var polygon = this._polygon;\n\n        var lineGroup = this._lineGroup;\n\n        var hasAnimation = seriesModel.get('animation');\n\n        var isAreaChart = !areaStyleModel.isEmpty();\n\n        var valueOrigin = areaStyleModel.get('origin');\n        var dataCoordInfo = prepareDataCoordInfo(coordSys, data, valueOrigin);\n\n        var stackedOnPoints = getStackedOnPoints(coordSys, data, dataCoordInfo);\n\n        var showSymbol = seriesModel.get('showSymbol');\n\n        var isSymbolIgnore = showSymbol && !isCoordSysPolar && !seriesModel.get('showAllSymbol')\n            && this._getSymbolIgnoreFunc(data, coordSys);\n\n        // Remove temporary symbols\n        var oldData = this._data;\n        oldData && oldData.eachItemGraphicEl(function (el, idx) {\n            if (el.__temp) {\n                group.remove(el);\n                oldData.setItemGraphicEl(idx, null);\n            }\n        });\n\n        // Remove previous created symbols if showSymbol changed to false\n        if (!showSymbol) {\n            symbolDraw.remove();\n        }\n\n        group.add(lineGroup);\n\n        // FIXME step not support polar\n        var step = !isCoordSysPolar && seriesModel.get('step');\n        // Initialization animation or coordinate system changed\n        if (\n            !(polyline && prevCoordSys.type === coordSys.type && step === this._step)\n        ) {\n            showSymbol && symbolDraw.updateData(data, {\n                isIgnore: isSymbolIgnore,\n                clipShape: createClipShape(coordSys, false, seriesModel)\n            });\n\n            if (step) {\n                // TODO If stacked series is not step\n                points = turnPointsIntoStep(points, coordSys, step);\n                stackedOnPoints = turnPointsIntoStep(stackedOnPoints, coordSys, step);\n            }\n\n            polyline = this._newPolyline(points, coordSys, hasAnimation);\n            if (isAreaChart) {\n                polygon = this._newPolygon(\n                    points, stackedOnPoints,\n                    coordSys, hasAnimation\n                );\n            }\n            lineGroup.setClipPath(createClipShape(coordSys, true, seriesModel));\n        }\n        else {\n            if (isAreaChart && !polygon) {\n                // If areaStyle is added\n                polygon = this._newPolygon(\n                    points, stackedOnPoints,\n                    coordSys, hasAnimation\n                );\n            }\n            else if (polygon && !isAreaChart) {\n                // If areaStyle is removed\n                lineGroup.remove(polygon);\n                polygon = this._polygon = null;\n            }\n\n            var coordSysClipShape = createClipShape(coordSys, false, seriesModel);\n\n            // Update clipPath\n            lineGroup.setClipPath(coordSysClipShape);\n\n            // Always update, or it is wrong in the case turning on legend\n            // because points are not changed\n            showSymbol && symbolDraw.updateData(data, {\n                isIgnore: isSymbolIgnore,\n                clipShape: coordSysClipShape\n            });\n\n            // Stop symbol animation and sync with line points\n            // FIXME performance?\n            data.eachItemGraphicEl(function (el) {\n                el.stopAnimation(true);\n            });\n\n            // In the case data zoom triggerred refreshing frequently\n            // Data may not change if line has a category axis. So it should animate nothing\n            if (!isPointsSame(this._stackedOnPoints, stackedOnPoints)\n                || !isPointsSame(this._points, points)\n            ) {\n                if (hasAnimation) {\n                    this._updateAnimation(\n                        data, stackedOnPoints, coordSys, api, step, valueOrigin\n                    );\n                }\n                else {\n                    // Not do it in update with animation\n                    if (step) {\n                        // TODO If stacked series is not step\n                        points = turnPointsIntoStep(points, coordSys, step);\n                        stackedOnPoints = turnPointsIntoStep(stackedOnPoints, coordSys, step);\n                    }\n\n                    polyline.setShape({\n                        points: points\n                    });\n                    polygon && polygon.setShape({\n                        points: points,\n                        stackedOnPoints: stackedOnPoints\n                    });\n                }\n            }\n        }\n\n        var visualColor = getVisualGradient(data, coordSys) || data.getVisual('color');\n\n        polyline.useStyle(defaults(\n            // Use color in lineStyle first\n            lineStyleModel.getLineStyle(),\n            {\n                fill: 'none',\n                stroke: visualColor,\n                lineJoin: 'bevel'\n            }\n        ));\n\n        var smooth = seriesModel.get('smooth');\n        smooth = getSmooth(seriesModel.get('smooth'));\n        polyline.setShape({\n            smooth: smooth,\n            smoothMonotone: seriesModel.get('smoothMonotone'),\n            connectNulls: seriesModel.get('connectNulls')\n        });\n\n        if (polygon) {\n            var stackedOnSeries = data.getCalculationInfo('stackedOnSeries');\n            var stackedOnSmooth = 0;\n\n            polygon.useStyle(defaults(\n                areaStyleModel.getAreaStyle(),\n                {\n                    fill: visualColor,\n                    opacity: 0.7,\n                    lineJoin: 'bevel'\n                }\n            ));\n\n            if (stackedOnSeries) {\n                stackedOnSmooth = getSmooth(stackedOnSeries.get('smooth'));\n            }\n\n            polygon.setShape({\n                smooth: smooth,\n                stackedOnSmooth: stackedOnSmooth,\n                smoothMonotone: seriesModel.get('smoothMonotone'),\n                connectNulls: seriesModel.get('connectNulls')\n            });\n        }\n\n        this._data = data;\n        // Save the coordinate system for transition animation when data changed\n        this._coordSys = coordSys;\n        this._stackedOnPoints = stackedOnPoints;\n        this._points = points;\n        this._step = step;\n        this._valueOrigin = valueOrigin;\n    },\n\n    dispose: function () {},\n\n    highlight: function (seriesModel, ecModel, api, payload) {\n        var data = seriesModel.getData();\n        var dataIndex = queryDataIndex(data, payload);\n\n        if (!(dataIndex instanceof Array) && dataIndex != null && dataIndex >= 0) {\n            var symbol = data.getItemGraphicEl(dataIndex);\n            if (!symbol) {\n                // Create a temporary symbol if it is not exists\n                var pt = data.getItemLayout(dataIndex);\n                if (!pt) {\n                    // Null data\n                    return;\n                }\n                symbol = new SymbolClz$1(data, dataIndex);\n                symbol.position = pt;\n                symbol.setZ(\n                    seriesModel.get('zlevel'),\n                    seriesModel.get('z')\n                );\n                symbol.ignore = isNaN(pt[0]) || isNaN(pt[1]);\n                symbol.__temp = true;\n                data.setItemGraphicEl(dataIndex, symbol);\n\n                // Stop scale animation\n                symbol.stopSymbolAnimation(true);\n\n                this.group.add(symbol);\n            }\n            symbol.highlight();\n        }\n        else {\n            // Highlight whole series\n            Chart.prototype.highlight.call(\n                this, seriesModel, ecModel, api, payload\n            );\n        }\n    },\n\n    downplay: function (seriesModel, ecModel, api, payload) {\n        var data = seriesModel.getData();\n        var dataIndex = queryDataIndex(data, payload);\n        if (dataIndex != null && dataIndex >= 0) {\n            var symbol = data.getItemGraphicEl(dataIndex);\n            if (symbol) {\n                if (symbol.__temp) {\n                    data.setItemGraphicEl(dataIndex, null);\n                    this.group.remove(symbol);\n                }\n                else {\n                    symbol.downplay();\n                }\n            }\n        }\n        else {\n            // FIXME\n            // can not downplay completely.\n            // Downplay whole series\n            Chart.prototype.downplay.call(\n                this, seriesModel, ecModel, api, payload\n            );\n        }\n    },\n\n    /**\n     * @param {module:zrender/container/Group} group\n     * @param {Array.<Array.<number>>} points\n     * @private\n     */\n    _newPolyline: function (points) {\n        var polyline = this._polyline;\n        // Remove previous created polyline\n        if (polyline) {\n            this._lineGroup.remove(polyline);\n        }\n\n        polyline = new Polyline$1({\n            shape: {\n                points: points\n            },\n            silent: true,\n            z2: 10\n        });\n\n        this._lineGroup.add(polyline);\n\n        this._polyline = polyline;\n\n        return polyline;\n    },\n\n    /**\n     * @param {module:zrender/container/Group} group\n     * @param {Array.<Array.<number>>} stackedOnPoints\n     * @param {Array.<Array.<number>>} points\n     * @private\n     */\n    _newPolygon: function (points, stackedOnPoints) {\n        var polygon = this._polygon;\n        // Remove previous created polygon\n        if (polygon) {\n            this._lineGroup.remove(polygon);\n        }\n\n        polygon = new Polygon$1({\n            shape: {\n                points: points,\n                stackedOnPoints: stackedOnPoints\n            },\n            silent: true\n        });\n\n        this._lineGroup.add(polygon);\n\n        this._polygon = polygon;\n        return polygon;\n    },\n    /**\n     * @private\n     */\n    _getSymbolIgnoreFunc: function (data, coordSys) {\n        var categoryAxis = coordSys.getAxesByScale('ordinal')[0];\n        // `getLabelInterval` is provided by echarts/component/axis\n        if (categoryAxis && categoryAxis.isLabelIgnored) {\n            return bind(categoryAxis.isLabelIgnored, categoryAxis);\n        }\n    },\n\n    /**\n     * @private\n     */\n    // FIXME Two value axis\n    _updateAnimation: function (data, stackedOnPoints, coordSys, api, step, valueOrigin) {\n        var polyline = this._polyline;\n        var polygon = this._polygon;\n        var seriesModel = data.hostModel;\n\n        var diff = lineAnimationDiff(\n            this._data, data,\n            this._stackedOnPoints, stackedOnPoints,\n            this._coordSys, coordSys,\n            this._valueOrigin, valueOrigin\n        );\n\n        var current = diff.current;\n        var stackedOnCurrent = diff.stackedOnCurrent;\n        var next = diff.next;\n        var stackedOnNext = diff.stackedOnNext;\n        if (step) {\n            // TODO If stacked series is not step\n            current = turnPointsIntoStep(diff.current, coordSys, step);\n            stackedOnCurrent = turnPointsIntoStep(diff.stackedOnCurrent, coordSys, step);\n            next = turnPointsIntoStep(diff.next, coordSys, step);\n            stackedOnNext = turnPointsIntoStep(diff.stackedOnNext, coordSys, step);\n        }\n        // `diff.current` is subset of `current` (which should be ensured by\n        // turnPointsIntoStep), so points in `__points` can be updated when\n        // points in `current` are update during animation.\n        polyline.shape.__points = diff.current;\n        polyline.shape.points = current;\n\n        updateProps(polyline, {\n            shape: {\n                points: next\n            }\n        }, seriesModel);\n\n        if (polygon) {\n            polygon.setShape({\n                points: current,\n                stackedOnPoints: stackedOnCurrent\n            });\n            updateProps(polygon, {\n                shape: {\n                    points: next,\n                    stackedOnPoints: stackedOnNext\n                }\n            }, seriesModel);\n        }\n\n        var updatedDataInfo = [];\n        var diffStatus = diff.status;\n\n        for (var i = 0; i < diffStatus.length; i++) {\n            var cmd = diffStatus[i].cmd;\n            if (cmd === '=') {\n                var el = data.getItemGraphicEl(diffStatus[i].idx1);\n                if (el) {\n                    updatedDataInfo.push({\n                        el: el,\n                        ptIdx: i    // Index of points\n                    });\n                }\n            }\n        }\n\n        if (polyline.animators && polyline.animators.length) {\n            polyline.animators[0].during(function () {\n                for (var i = 0; i < updatedDataInfo.length; i++) {\n                    var el = updatedDataInfo[i].el;\n                    el.attr('position', polyline.shape.__points[updatedDataInfo[i].ptIdx]);\n                }\n            });\n        }\n    },\n\n    remove: function (ecModel) {\n        var group = this.group;\n        var oldData = this._data;\n        this._lineGroup.removeAll();\n        this._symbolDraw.remove(true);\n        // Remove temporary created elements when highlighting\n        oldData && oldData.eachItemGraphicEl(function (el, idx) {\n            if (el.__temp) {\n                group.remove(el);\n                oldData.setItemGraphicEl(idx, null);\n            }\n        });\n\n        this._polyline =\n        this._polygon =\n        this._coordSys =\n        this._points =\n        this._stackedOnPoints =\n        this._data = null;\n    }\n});\n\nvar visualSymbol = function (seriesType, defaultSymbolType, legendSymbol) {\n    // Encoding visual for all series include which is filtered for legend drawing\n    return {\n        seriesType: seriesType,\n        performRawSeries: true,\n        reset: function (seriesModel, ecModel, api) {\n            var data = seriesModel.getData();\n\n            var symbolType = seriesModel.get('symbol') || defaultSymbolType;\n            var symbolSize = seriesModel.get('symbolSize');\n\n            data.setVisual({\n                legendSymbol: legendSymbol || symbolType,\n                symbol: symbolType,\n                symbolSize: symbolSize\n            });\n\n            // Only visible series has each data be visual encoded\n            if (ecModel.isSeriesFiltered(seriesModel)) {\n                return;\n            }\n\n            var hasCallback = typeof symbolSize === 'function';\n\n            function dataEach(data, idx) {\n                if (typeof symbolSize === 'function') {\n                    var rawValue = seriesModel.getRawValue(idx);\n                    // FIXME\n                    var params = seriesModel.getDataParams(idx);\n                    data.setItemVisual(idx, 'symbolSize', symbolSize(rawValue, params));\n                }\n\n                if (data.hasItemOption) {\n                    var itemModel = data.getItemModel(idx);\n                    var itemSymbolType = itemModel.getShallow('symbol', true);\n                    var itemSymbolSize = itemModel.getShallow('symbolSize', true);\n                    // If has item symbol\n                    if (itemSymbolType != null) {\n                        data.setItemVisual(idx, 'symbol', itemSymbolType);\n                    }\n                    if (itemSymbolSize != null) {\n                        // PENDING Transform symbolSize ?\n                        data.setItemVisual(idx, 'symbolSize', itemSymbolSize);\n                    }\n                }\n            }\n\n            return { dataEach: (data.hasItemOption || hasCallback) ? dataEach : null };\n        }\n    };\n};\n\nvar pointsLayout = function (seriesType) {\n    return {\n        seriesType: seriesType,\n\n        plan: createRenderPlanner(),\n\n        reset: function (seriesModel) {\n            var data = seriesModel.getData();\n            var coordSys = seriesModel.coordinateSystem;\n            var pipelineContext = seriesModel.pipelineContext;\n            var isLargeRender = pipelineContext.large;\n\n            if (!coordSys) {\n                return;\n            }\n\n            var dims = map(coordSys.dimensions, function (dim) {\n                return data.mapDimension(dim);\n            }).slice(0, 2);\n            var dimLen = dims.length;\n\n            if (isDimensionStacked(data, dims[0], dims[1])) {\n                dims[0] = data.getCalculationInfo('stackResultDimension');\n            }\n            if (isDimensionStacked(data, dims[1], dims[0])) {\n                dims[1] = data.getCalculationInfo('stackResultDimension');\n            }\n\n            function progress(params, data) {\n                var segCount = params.end - params.start;\n                var points = isLargeRender && new Float32Array(segCount * dimLen);\n\n                for (var i = params.start, offset = 0, tmpIn = [], tmpOut = []; i < params.end; i++) {\n                    var point;\n\n                    if (dimLen === 1) {\n                        var x = data.get(dims[0], i, true);\n                        point = !isNaN(x) && coordSys.dataToPoint(x, null, tmpOut);\n                    }\n                    else {\n                        var x = tmpIn[0] = data.get(dims[0], i, true);\n                        var y = tmpIn[1] = data.get(dims[1], i, true);\n                        // Also {Array.<number>}, not undefined to avoid if...else... statement\n                        point = !isNaN(x) && !isNaN(y) && coordSys.dataToPoint(tmpIn, null, tmpOut);\n                    }\n\n                    if (isLargeRender) {\n                        points[offset++] = point ? point[0] : NaN;\n                        points[offset++] = point ? point[1] : NaN;\n                    }\n                    else {\n                        data.setItemLayout(i, (point && point.slice()) || [NaN, NaN]);\n                    }\n                }\n\n                isLargeRender && data.setLayout('symbolPoints', points);\n            }\n\n            return dimLen && {progress: progress};\n        }\n    };\n};\n\nvar samplers = {\n    average: function (frame) {\n        var sum = 0;\n        var count = 0;\n        for (var i = 0; i < frame.length; i++) {\n            if (!isNaN(frame[i])) {\n                sum += frame[i];\n                count++;\n            }\n        }\n        // Return NaN if count is 0\n        return count === 0 ? NaN : sum / count;\n    },\n    sum: function (frame) {\n        var sum = 0;\n        for (var i = 0; i < frame.length; i++) {\n            // Ignore NaN\n            sum += frame[i] || 0;\n        }\n        return sum;\n    },\n    max: function (frame) {\n        var max = -Infinity;\n        for (var i = 0; i < frame.length; i++) {\n            frame[i] > max && (max = frame[i]);\n        }\n        return max;\n    },\n    min: function (frame) {\n        var min = Infinity;\n        for (var i = 0; i < frame.length; i++) {\n            frame[i] < min && (min = frame[i]);\n        }\n        return min;\n    },\n    // TODO\n    // Median\n    nearest: function (frame) {\n        return frame[0];\n    }\n};\n\nvar indexSampler = function (frame, value) {\n    return Math.round(frame.length / 2);\n};\n\nvar dataSample = function (seriesType) {\n    return {\n        seriesType: seriesType,\n        reset: function (seriesModel, ecModel, api) {\n            var data = seriesModel.getData();\n            var sampling = seriesModel.get('sampling');\n            var coordSys = seriesModel.coordinateSystem;\n            // Only cartesian2d support down sampling\n            if (coordSys.type === 'cartesian2d' && sampling) {\n                var baseAxis = coordSys.getBaseAxis();\n                var valueAxis = coordSys.getOtherAxis(baseAxis);\n                var extent = baseAxis.getExtent();\n                // Coordinste system has been resized\n                var size = extent[1] - extent[0];\n                var rate = Math.round(data.count() / size);\n                if (rate > 1) {\n                    var sampler;\n                    if (typeof sampling === 'string') {\n                        sampler = samplers[sampling];\n                    }\n                    else if (typeof sampling === 'function') {\n                        sampler = sampling;\n                    }\n                    if (sampler) {\n                        seriesModel.setData(data.downSample(\n                            valueAxis.dim, 1 / rate, sampler, indexSampler\n                        ));\n                    }\n                }\n            }\n        }\n    };\n};\n\n/**\n * Cartesian coordinate system\n * @module  echarts/coord/Cartesian\n *\n */\n\nfunction dimAxisMapper(dim) {\n    return this._axes[dim];\n}\n\n/**\n * @alias module:echarts/coord/Cartesian\n * @constructor\n */\nvar Cartesian = function (name) {\n    this._axes = {};\n\n    this._dimList = [];\n\n    /**\n     * @type {string}\n     */\n    this.name = name || '';\n};\n\nCartesian.prototype = {\n\n    constructor: Cartesian,\n\n    type: 'cartesian',\n\n    /**\n     * Get axis\n     * @param  {number|string} dim\n     * @return {module:echarts/coord/Cartesian~Axis}\n     */\n    getAxis: function (dim) {\n        return this._axes[dim];\n    },\n\n    /**\n     * Get axes list\n     * @return {Array.<module:echarts/coord/Cartesian~Axis>}\n     */\n    getAxes: function () {\n        return map(this._dimList, dimAxisMapper, this);\n    },\n\n    /**\n     * Get axes list by given scale type\n     */\n    getAxesByScale: function (scaleType) {\n        scaleType = scaleType.toLowerCase();\n        return filter(\n            this.getAxes(),\n            function (axis) {\n                return axis.scale.type === scaleType;\n            }\n        );\n    },\n\n    /**\n     * Add axis\n     * @param {module:echarts/coord/Cartesian.Axis}\n     */\n    addAxis: function (axis) {\n        var dim = axis.dim;\n\n        this._axes[dim] = axis;\n\n        this._dimList.push(dim);\n    },\n\n    /**\n     * Convert data to coord in nd space\n     * @param {Array.<number>|Object.<string, number>} val\n     * @return {Array.<number>|Object.<string, number>}\n     */\n    dataToCoord: function (val) {\n        return this._dataCoordConvert(val, 'dataToCoord');\n    },\n\n    /**\n     * Convert coord in nd space to data\n     * @param  {Array.<number>|Object.<string, number>} val\n     * @return {Array.<number>|Object.<string, number>}\n     */\n    coordToData: function (val) {\n        return this._dataCoordConvert(val, 'coordToData');\n    },\n\n    _dataCoordConvert: function (input, method) {\n        var dimList = this._dimList;\n\n        var output = input instanceof Array ? [] : {};\n\n        for (var i = 0; i < dimList.length; i++) {\n            var dim = dimList[i];\n            var axis = this._axes[dim];\n\n            output[dim] = axis[method](input[dim]);\n        }\n\n        return output;\n    }\n};\n\nfunction Cartesian2D(name) {\n\n    Cartesian.call(this, name);\n}\n\nCartesian2D.prototype = {\n\n    constructor: Cartesian2D,\n\n    type: 'cartesian2d',\n\n    /**\n     * @type {Array.<string>}\n     * @readOnly\n     */\n    dimensions: ['x', 'y'],\n\n    /**\n     * Base axis will be used on stacking.\n     *\n     * @return {module:echarts/coord/cartesian/Axis2D}\n     */\n    getBaseAxis: function () {\n        return this.getAxesByScale('ordinal')[0]\n            || this.getAxesByScale('time')[0]\n            || this.getAxis('x');\n    },\n\n    /**\n     * If contain point\n     * @param {Array.<number>} point\n     * @return {boolean}\n     */\n    containPoint: function (point) {\n        var axisX = this.getAxis('x');\n        var axisY = this.getAxis('y');\n        return axisX.contain(axisX.toLocalCoord(point[0]))\n            && axisY.contain(axisY.toLocalCoord(point[1]));\n    },\n\n    /**\n     * If contain data\n     * @param {Array.<number>} data\n     * @return {boolean}\n     */\n    containData: function (data) {\n        return this.getAxis('x').containData(data[0])\n            && this.getAxis('y').containData(data[1]);\n    },\n\n    /**\n     * @param {Array.<number>} data\n     * @param {Array.<number>} out\n     * @return {Array.<number>}\n     */\n    dataToPoint: function (data, reserved, out) {\n        var xAxis = this.getAxis('x');\n        var yAxis = this.getAxis('y');\n        out = out || [];\n        out[0] = xAxis.toGlobalCoord(xAxis.dataToCoord(data[0]));\n        out[1] = yAxis.toGlobalCoord(yAxis.dataToCoord(data[1]));\n        return out;\n    },\n\n    /**\n     * @param {Array.<number>} data\n     * @param {Array.<number>} out\n     * @return {Array.<number>}\n     */\n    clampData: function (data, out) {\n        var xAxisExtent = this.getAxis('x').scale.getExtent();\n        var yAxisExtent = this.getAxis('y').scale.getExtent();\n        out = out || [];\n        out[0] = Math.min(\n            Math.max(Math.min(xAxisExtent[0], xAxisExtent[1]), data[0]),\n            Math.max(xAxisExtent[0], xAxisExtent[1])\n        );\n        out[1] = Math.min(\n            Math.max(Math.min(yAxisExtent[0], yAxisExtent[1]), data[1]),\n            Math.max(yAxisExtent[0], yAxisExtent[1])\n        );\n\n        return out;\n    },\n\n    /**\n     * @param {Array.<number>} point\n     * @param {Array.<number>} out\n     * @return {Array.<number>}\n     */\n    pointToData: function (point, out) {\n        var xAxis = this.getAxis('x');\n        var yAxis = this.getAxis('y');\n        out = out || [];\n        out[0] = xAxis.coordToData(xAxis.toLocalCoord(point[0]));\n        out[1] = yAxis.coordToData(yAxis.toLocalCoord(point[1]));\n        return out;\n    },\n\n    /**\n     * Get other axis\n     * @param {module:echarts/coord/cartesian/Axis2D} axis\n     */\n    getOtherAxis: function (axis) {\n        return this.getAxis(axis.dim === 'x' ? 'y' : 'x');\n    }\n\n};\n\ninherits(Cartesian2D, Cartesian);\n\n/**\n * Extend axis 2d\n * @constructor module:echarts/coord/cartesian/Axis2D\n * @extends {module:echarts/coord/cartesian/Axis}\n * @param {string} dim\n * @param {*} scale\n * @param {Array.<number>} coordExtent\n * @param {string} axisType\n * @param {string} position\n */\nvar Axis2D = function (dim, scale, coordExtent, axisType, position) {\n    Axis.call(this, dim, scale, coordExtent);\n    /**\n     * Axis type\n     *  - 'category'\n     *  - 'value'\n     *  - 'time'\n     *  - 'log'\n     * @type {string}\n     */\n    this.type = axisType || 'value';\n\n    /**\n     * Axis position\n     *  - 'top'\n     *  - 'bottom'\n     *  - 'left'\n     *  - 'right'\n     */\n    this.position = position || 'bottom';\n};\n\nAxis2D.prototype = {\n\n    constructor: Axis2D,\n\n    /**\n     * Index of axis, can be used as key\n     */\n    index: 0,\n    /**\n     * If axis is on the zero position of the other axis\n     * @type {boolean}\n     */\n    onZero: false,\n\n    /**\n     * Axis model\n     * @param {module:echarts/coord/cartesian/AxisModel}\n     */\n    model: null,\n\n    isHorizontal: function () {\n        var position = this.position;\n        return position === 'top' || position === 'bottom';\n    },\n\n    /**\n     * Each item cooresponds to this.getExtent(), which\n     * means globalExtent[0] may greater than globalExtent[1],\n     * unless `asc` is input.\n     *\n     * @param {boolean} [asc]\n     * @return {Array.<number>}\n     */\n    getGlobalExtent: function (asc) {\n        var ret = this.getExtent();\n        ret[0] = this.toGlobalCoord(ret[0]);\n        ret[1] = this.toGlobalCoord(ret[1]);\n        asc && ret[0] > ret[1] && ret.reverse();\n        return ret;\n    },\n\n    getOtherAxis: function () {\n        this.grid.getOtherAxis();\n    },\n\n    /**\n     * If label is ignored.\n     * Automatically used when axis is category and label can not be all shown\n     * @param  {number}  idx\n     * @return {boolean}\n     */\n    isLabelIgnored: function (idx) {\n        if (this.type === 'category') {\n            var labelInterval = this.getLabelInterval();\n            return ((typeof labelInterval === 'function')\n                && !labelInterval(idx, this.scale.getLabel(idx)))\n                || idx % (labelInterval + 1);\n        }\n    },\n\n    /**\n     * @override\n     */\n    pointToData: function (point, clamp) {\n        return this.coordToData(this.toLocalCoord(point[this.dim === 'x' ? 0 : 1]), clamp);\n    },\n\n    /**\n     * Transform global coord to local coord,\n     * i.e. var localCoord = axis.toLocalCoord(80);\n     * designate by module:echarts/coord/cartesian/Grid.\n     * @type {Function}\n     */\n    toLocalCoord: null,\n\n    /**\n     * Transform global coord to local coord,\n     * i.e. var globalCoord = axis.toLocalCoord(40);\n     * designate by module:echarts/coord/cartesian/Grid.\n     * @type {Function}\n     */\n    toGlobalCoord: null\n\n};\n\ninherits(Axis2D, Axis);\n\nvar defaultOption = {\n    show: true,\n    zlevel: 0,                  // \n    z: 0,                       // \n    // \n    inverse: false,\n\n    // \n    name: '',\n    // 'start' | 'middle' | 'end'\n    nameLocation: 'end',\n    // degree\n    nameRotate: null, // Adapt to axis rotate, when nameLocation is 'middle'.\n    nameTruncate: {\n        maxWidth: null,\n        ellipsis: '...',\n        placeholder: '.'\n    },\n    // \n    nameTextStyle: {},\n    // \n    nameGap: 15,\n\n    silent: false, // Default false to support tooltip.\n    triggerEvent: false, // Default false to avoid legacy user event listener fail.\n\n    tooltip: {\n        show: false\n    },\n\n    axisPointer: {},\n\n    // \n    axisLine: {\n        // show\n        show: true,\n        onZero: true,\n        onZeroAxisIndex: null,\n        // lineStyle\n        lineStyle: {\n            color: '#333',\n            width: 1,\n            type: 'solid'\n        },\n        // \n        symbol: ['none', 'none'],\n        symbolSize: [10, 15]\n    },\n    // \n    axisTick: {\n        // show\n        show: true,\n        // grid\n        inside: false,\n        // length\n        length: 5,\n        // lineStyle\n        lineStyle: {\n            width: 1\n        }\n    },\n    // axis.axisLabel\n    axisLabel: {\n        show: true,\n        // grid\n        inside: false,\n        rotate: 0,\n        showMinLabel: null, // true | false | null (auto)\n        showMaxLabel: null, // true | false | null (auto)\n        margin: 8,\n        // formatter: null,\n        // TEXTSTYLE\n        fontSize: 12\n    },\n    // \n    splitLine: {\n        // show\n        show: true,\n        // lineStylelineStyle\n        lineStyle: {\n            color: ['#ccc'],\n            width: 1,\n            type: 'solid'\n        }\n    },\n    // \n    splitArea: {\n        // show\n        show: false,\n        // areaStyleareaStyle\n        areaStyle: {\n            color: ['rgba(250,250,250,0.3)','rgba(200,200,200,0.3)']\n        }\n    }\n};\n\nvar axisDefault = {};\n\naxisDefault.categoryAxis = merge({\n    // \n    boundaryGap: true,\n    // Set false to faster category collection.\n    // Only usefull in the case like: category is\n    // ['2012-01-01', '2012-01-02', ...], where the input\n    // data has been ensured not duplicate and is large data.\n    // null means \"auto\":\n    // if axis.data provided, do not deduplication,\n    // else do deduplication.\n    deduplication: null,\n    // splitArea: {\n        // show: false\n    // },\n    splitLine: {\n        show: false\n    },\n    // \n    axisTick: {\n        // If tick is align with label when boundaryGap is true\n        alignWithLabel: false,\n        interval: 'auto'\n    },\n    // axis.axisLabel\n    axisLabel: {\n        interval: 'auto'\n    }\n}, defaultOption);\n\naxisDefault.valueAxis = merge({\n    // \n    boundaryGap: [0, 0],\n\n    // TODO\n    // min/max: [30, datamin, 60] or [20, datamin] or [datamin, 60]\n\n    // ,  'dataMin' \n    // min: null,\n    //  'dataMax' \n    // max: null,\n    // Readonly prop, specifies start value of the range when using data zoom.\n    // rangeStart: null\n    // Readonly prop, specifies end value of the range when using data zoom.\n    // rangeEnd: null\n    // 0_min_max\n    // scale: false,\n    // 5\n    splitNumber: 5\n    // Minimum interval\n    // minInterval: null\n    // maxInterval: null\n}, defaultOption);\n\n// FIXME\naxisDefault.timeAxis = defaults({\n    scale: true,\n    min: 'dataMin',\n    max: 'dataMax'\n}, axisDefault.valueAxis);\n\naxisDefault.logAxis = defaults({\n    scale: true,\n    logBase: 10\n}, axisDefault.valueAxis);\n\n// FIXME axisType is fixed ?\nvar AXIS_TYPES = ['value', 'category', 'time', 'log'];\n\n/**\n * Generate sub axis model class\n * @param {string} axisName 'x' 'y' 'radius' 'angle' 'parallel'\n * @param {module:echarts/model/Component} BaseAxisModelClass\n * @param {Function} axisTypeDefaulter\n * @param {Object} [extraDefaultOption]\n */\nvar axisModelCreator = function (axisName, BaseAxisModelClass, axisTypeDefaulter, extraDefaultOption) {\n\n    each$1(AXIS_TYPES, function (axisType) {\n\n        BaseAxisModelClass.extend({\n\n            /**\n             * @readOnly\n             */\n            type: axisName + 'Axis.' + axisType,\n\n            mergeDefaultAndTheme: function (option, ecModel) {\n                var layoutMode = this.layoutMode;\n                var inputPositionParams = layoutMode\n                    ? getLayoutParams(option) : {};\n\n                var themeModel = ecModel.getTheme();\n                merge(option, themeModel.get(axisType + 'Axis'));\n                merge(option, this.getDefaultOption());\n\n                option.type = axisTypeDefaulter(axisName, option);\n\n                if (layoutMode) {\n                    mergeLayoutParam(option, inputPositionParams, layoutMode);\n                }\n            },\n\n            /**\n             * @override\n             */\n            optionUpdated: function () {\n                var thisOption = this.option;\n                if (thisOption.type === 'category') {\n                    this.__ordinalMeta = OrdinalMeta.createByAxisModel(this);\n                }\n            },\n\n            /**\n             * Should not be called before all of 'getInitailData' finished.\n             * Because categories are collected during initializing data.\n             */\n            getCategories: function () {\n                // FIXME\n                // warning if called before all of 'getInitailData' finished.\n                if (this.option.type === 'category') {\n                    return this.__ordinalMeta.categories;\n                }\n            },\n\n            getOrdinalMeta: function () {\n                return this.__ordinalMeta;\n            },\n\n            defaultOption: mergeAll(\n                [\n                    {},\n                    axisDefault[axisType + 'Axis'],\n                    extraDefaultOption\n                ],\n                true\n            )\n        });\n    });\n\n    ComponentModel.registerSubTypeDefaulter(\n        axisName + 'Axis',\n        curry(axisTypeDefaulter, axisName)\n    );\n};\n\nvar AxisModel = ComponentModel.extend({\n\n    type: 'cartesian2dAxis',\n\n    /**\n     * @type {module:echarts/coord/cartesian/Axis2D}\n     */\n    axis: null,\n\n    /**\n     * @override\n     */\n    init: function () {\n        AxisModel.superApply(this, 'init', arguments);\n        this.resetRange();\n    },\n\n    /**\n     * @override\n     */\n    mergeOption: function () {\n        AxisModel.superApply(this, 'mergeOption', arguments);\n        this.resetRange();\n    },\n\n    /**\n     * @override\n     */\n    restoreData: function () {\n        AxisModel.superApply(this, 'restoreData', arguments);\n        this.resetRange();\n    },\n\n    /**\n     * @override\n     * @return {module:echarts/model/Component}\n     */\n    getCoordSysModel: function () {\n        return this.ecModel.queryComponents({\n            mainType: 'grid',\n            index: this.option.gridIndex,\n            id: this.option.gridId\n        })[0];\n    }\n\n});\n\nfunction getAxisType(axisDim, option) {\n    // Default axis with data is category axis\n    return option.type || (option.data ? 'category' : 'value');\n}\n\nmerge(AxisModel.prototype, axisModelCommonMixin);\n\nvar extraOption = {\n    // gridIndex: 0,\n    // gridId: '',\n\n    // Offset is for multiple axis on the same position\n    offset: 0\n};\n\naxisModelCreator('x', AxisModel, getAxisType, extraOption);\naxisModelCreator('y', AxisModel, getAxisType, extraOption);\n\n// Grid \n//  Cartesian2D \n\nComponentModel.extend({\n\n    type: 'grid',\n\n    dependencies: ['xAxis', 'yAxis'],\n\n    layoutMode: 'box',\n\n    /**\n     * @type {module:echarts/coord/cartesian/Grid}\n     */\n    coordinateSystem: null,\n\n    defaultOption: {\n        show: false,\n        zlevel: 0,\n        z: 0,\n        left: '10%',\n        top: 60,\n        right: '10%',\n        bottom: 60,\n        // If grid size contain label\n        containLabel: false,\n        // width: {totalWidth} - left - right,\n        // height: {totalHeight} - top - bottom,\n        backgroundColor: 'rgba(0,0,0,0)',\n        borderWidth: 1,\n        borderColor: '#ccc'\n    }\n});\n\n/**\n * Grid is a region which contains at most 4 cartesian systems\n *\n * TODO Default cartesian\n */\n\n// Depends on GridModel, AxisModel, which performs preprocess.\nvar each$6 = each$1;\nvar ifAxisCrossZero$1 = ifAxisCrossZero;\nvar niceScaleExtent$1 = niceScaleExtent;\n\n/**\n * Check if the axis is used in the specified grid\n * @inner\n */\nfunction isAxisUsedInTheGrid(axisModel, gridModel, ecModel) {\n    return axisModel.getCoordSysModel() === gridModel;\n}\n\nfunction rotateTextRect(textRect, rotate) {\n  var rotateRadians = rotate * Math.PI / 180;\n  var boundingBox = textRect.plain();\n  var beforeWidth = boundingBox.width;\n  var beforeHeight = boundingBox.height;\n  var afterWidth = beforeWidth * Math.cos(rotateRadians) + beforeHeight * Math.sin(rotateRadians);\n  var afterHeight = beforeWidth * Math.sin(rotateRadians) + beforeHeight * Math.cos(rotateRadians);\n  var rotatedRect = new BoundingRect(boundingBox.x, boundingBox.y, afterWidth, afterHeight);\n\n  return rotatedRect;\n}\n\nfunction getLabelUnionRect(axis) {\n    var axisModel = axis.model;\n    var labels = axisModel.get('axisLabel.show') ? axisModel.getFormattedLabels() : [];\n    var axisLabelModel = axisModel.getModel('axisLabel');\n    var rect;\n    var step = 1;\n    var labelCount = labels.length;\n    if (labelCount > 40) {\n        // Simple optimization for large amount of labels\n        step = Math.ceil(labelCount / 40);\n    }\n    for (var i = 0; i < labelCount; i += step) {\n        if (!axis.isLabelIgnored(i)) {\n            var unrotatedSingleRect = axisLabelModel.getTextRect(labels[i]);\n            var singleRect = rotateTextRect(unrotatedSingleRect, axisLabelModel.get('rotate') || 0);\n\n            rect ? rect.union(singleRect) : (rect = singleRect);\n        }\n    }\n    return rect;\n}\n\nfunction Grid(gridModel, ecModel, api) {\n    /**\n     * @type {Object.<string, module:echarts/coord/cartesian/Cartesian2D>}\n     * @private\n     */\n    this._coordsMap = {};\n\n    /**\n     * @type {Array.<module:echarts/coord/cartesian/Cartesian>}\n     * @private\n     */\n    this._coordsList = [];\n\n    /**\n     * @type {Object.<string, module:echarts/coord/cartesian/Axis2D>}\n     * @private\n     */\n    this._axesMap = {};\n\n    /**\n     * @type {Array.<module:echarts/coord/cartesian/Axis2D>}\n     * @private\n     */\n    this._axesList = [];\n\n    this._initCartesian(gridModel, ecModel, api);\n\n    this.model = gridModel;\n}\n\nvar gridProto = Grid.prototype;\n\ngridProto.type = 'grid';\n\ngridProto.axisPointerEnabled = true;\n\ngridProto.getRect = function () {\n    return this._rect;\n};\n\ngridProto.update = function (ecModel, api) {\n\n    var axesMap = this._axesMap;\n\n    this._updateScale(ecModel, this.model);\n\n    each$6(axesMap.x, function (xAxis) {\n        niceScaleExtent$1(xAxis.scale, xAxis.model);\n    });\n    each$6(axesMap.y, function (yAxis) {\n        niceScaleExtent$1(yAxis.scale, yAxis.model);\n    });\n    each$6(axesMap.x, function (xAxis) {\n        fixAxisOnZero(axesMap, 'y', xAxis);\n    });\n    each$6(axesMap.y, function (yAxis) {\n        fixAxisOnZero(axesMap, 'x', yAxis);\n    });\n\n    // Resize again if containLabel is enabled\n    // FIXME It may cause getting wrong grid size in data processing stage\n    this.resize(this.model, api);\n};\n\nfunction fixAxisOnZero(axesMap, otherAxisDim, axis) {\n    // onZero can not be enabled in these two situations:\n    // 1. When any other axis is a category axis.\n    // 2. When no axis is cross 0 point.\n    var axes = axesMap[otherAxisDim];\n\n    if (!axis.onZero) {\n        return;\n    }\n\n    var onZeroAxisIndex = axis.onZeroAxisIndex;\n\n    // If target axis is specified.\n    if (onZeroAxisIndex != null) {\n        var otherAxis = axes[onZeroAxisIndex];\n        if (otherAxis && canNotOnZeroToAxis(otherAxis)) {\n            axis.onZero = false;\n        }\n        return;\n    }\n\n    for (var idx in axes) {\n        if (axes.hasOwnProperty(idx)) {\n            var otherAxis = axes[idx];\n            if (otherAxis && !canNotOnZeroToAxis(otherAxis)) {\n                onZeroAxisIndex = +idx;\n                break;\n            }\n        }\n    }\n\n    if (onZeroAxisIndex == null) {\n        axis.onZero = false;\n    }\n    axis.onZeroAxisIndex = onZeroAxisIndex;\n}\n\nfunction canNotOnZeroToAxis(axis) {\n    return axis.type === 'category' || axis.type === 'time' || !ifAxisCrossZero$1(axis);\n}\n\n/**\n * Resize the grid\n * @param {module:echarts/coord/cartesian/GridModel} gridModel\n * @param {module:echarts/ExtensionAPI} api\n */\ngridProto.resize = function (gridModel, api, ignoreContainLabel) {\n\n    var gridRect = getLayoutRect(\n        gridModel.getBoxLayoutParams(), {\n            width: api.getWidth(),\n            height: api.getHeight()\n        });\n\n    this._rect = gridRect;\n\n    var axesList = this._axesList;\n\n    adjustAxes();\n\n    // Minus label size\n    if (!ignoreContainLabel && gridModel.get('containLabel')) {\n        each$6(axesList, function (axis) {\n            if (!axis.model.get('axisLabel.inside')) {\n                var labelUnionRect = getLabelUnionRect(axis);\n                if (labelUnionRect) {\n                    var dim = axis.isHorizontal() ? 'height' : 'width';\n                    var margin = axis.model.get('axisLabel.margin');\n                    gridRect[dim] -= labelUnionRect[dim] + margin;\n                    if (axis.position === 'top') {\n                        gridRect.y += labelUnionRect.height + margin;\n                    }\n                    else if (axis.position === 'left')  {\n                        gridRect.x += labelUnionRect.width + margin;\n                    }\n                }\n            }\n        });\n\n        adjustAxes();\n    }\n\n    function adjustAxes() {\n        each$6(axesList, function (axis) {\n            var isHorizontal = axis.isHorizontal();\n            var extent = isHorizontal ? [0, gridRect.width] : [0, gridRect.height];\n            var idx = axis.inverse ? 1 : 0;\n            axis.setExtent(extent[idx], extent[1 - idx]);\n            updateAxisTransform(axis, isHorizontal ? gridRect.x : gridRect.y);\n        });\n    }\n};\n\n/**\n * @param {string} axisType\n * @param {number} [axisIndex]\n */\ngridProto.getAxis = function (axisType, axisIndex) {\n    var axesMapOnDim = this._axesMap[axisType];\n    if (axesMapOnDim != null) {\n        if (axisIndex == null) {\n            // Find first axis\n            for (var name in axesMapOnDim) {\n                if (axesMapOnDim.hasOwnProperty(name)) {\n                    return axesMapOnDim[name];\n                }\n            }\n        }\n        return axesMapOnDim[axisIndex];\n    }\n};\n\n/**\n * @return {Array.<module:echarts/coord/Axis>}\n */\ngridProto.getAxes = function () {\n    return this._axesList.slice();\n};\n\n/**\n * Usage:\n *      grid.getCartesian(xAxisIndex, yAxisIndex);\n *      grid.getCartesian(xAxisIndex);\n *      grid.getCartesian(null, yAxisIndex);\n *      grid.getCartesian({xAxisIndex: ..., yAxisIndex: ...});\n *\n * @param {number|Object} [xAxisIndex]\n * @param {number} [yAxisIndex]\n */\ngridProto.getCartesian = function (xAxisIndex, yAxisIndex) {\n    if (xAxisIndex != null && yAxisIndex != null) {\n        var key = 'x' + xAxisIndex + 'y' + yAxisIndex;\n        return this._coordsMap[key];\n    }\n\n    if (isObject$1(xAxisIndex)) {\n        yAxisIndex = xAxisIndex.yAxisIndex;\n        xAxisIndex = xAxisIndex.xAxisIndex;\n    }\n    // When only xAxisIndex or yAxisIndex given, find its first cartesian.\n    for (var i = 0, coordList = this._coordsList; i < coordList.length; i++) {\n        if (coordList[i].getAxis('x').index === xAxisIndex\n            || coordList[i].getAxis('y').index === yAxisIndex\n        ) {\n            return coordList[i];\n        }\n    }\n};\n\ngridProto.getCartesians = function () {\n    return this._coordsList.slice();\n};\n\n/**\n * @implements\n * see {module:echarts/CoodinateSystem}\n */\ngridProto.convertToPixel = function (ecModel, finder, value) {\n    var target = this._findConvertTarget(ecModel, finder);\n\n    return target.cartesian\n        ? target.cartesian.dataToPoint(value)\n        : target.axis\n        ? target.axis.toGlobalCoord(target.axis.dataToCoord(value))\n        : null;\n};\n\n/**\n * @implements\n * see {module:echarts/CoodinateSystem}\n */\ngridProto.convertFromPixel = function (ecModel, finder, value) {\n    var target = this._findConvertTarget(ecModel, finder);\n\n    return target.cartesian\n        ? target.cartesian.pointToData(value)\n        : target.axis\n        ? target.axis.coordToData(target.axis.toLocalCoord(value))\n        : null;\n};\n\n/**\n * @inner\n */\ngridProto._findConvertTarget = function (ecModel, finder) {\n    var seriesModel = finder.seriesModel;\n    var xAxisModel = finder.xAxisModel\n        || (seriesModel && seriesModel.getReferringComponents('xAxis')[0]);\n    var yAxisModel = finder.yAxisModel\n        || (seriesModel && seriesModel.getReferringComponents('yAxis')[0]);\n    var gridModel = finder.gridModel;\n    var coordsList = this._coordsList;\n    var cartesian;\n    var axis;\n\n    if (seriesModel) {\n        cartesian = seriesModel.coordinateSystem;\n        indexOf(coordsList, cartesian) < 0 && (cartesian = null);\n    }\n    else if (xAxisModel && yAxisModel) {\n        cartesian = this.getCartesian(xAxisModel.componentIndex, yAxisModel.componentIndex);\n    }\n    else if (xAxisModel) {\n        axis = this.getAxis('x', xAxisModel.componentIndex);\n    }\n    else if (yAxisModel) {\n        axis = this.getAxis('y', yAxisModel.componentIndex);\n    }\n    // Lowest priority.\n    else if (gridModel) {\n        var grid = gridModel.coordinateSystem;\n        if (grid === this) {\n            cartesian = this._coordsList[0];\n        }\n    }\n\n    return {cartesian: cartesian, axis: axis};\n};\n\n/**\n * @implements\n * see {module:echarts/CoodinateSystem}\n */\ngridProto.containPoint = function (point) {\n    var coord = this._coordsList[0];\n    if (coord) {\n        return coord.containPoint(point);\n    }\n};\n\n/**\n * Initialize cartesian coordinate systems\n * @private\n */\ngridProto._initCartesian = function (gridModel, ecModel, api) {\n    var axisPositionUsed = {\n        left: false,\n        right: false,\n        top: false,\n        bottom: false\n    };\n\n    var axesMap = {\n        x: {},\n        y: {}\n    };\n    var axesCount = {\n        x: 0,\n        y: 0\n    };\n\n    /// Create axis\n    ecModel.eachComponent('xAxis', createAxisCreator('x'), this);\n    ecModel.eachComponent('yAxis', createAxisCreator('y'), this);\n\n    if (!axesCount.x || !axesCount.y) {\n        // Roll back when there no either x or y axis\n        this._axesMap = {};\n        this._axesList = [];\n        return;\n    }\n\n    this._axesMap = axesMap;\n\n    /// Create cartesian2d\n    each$6(axesMap.x, function (xAxis, xAxisIndex) {\n        each$6(axesMap.y, function (yAxis, yAxisIndex) {\n            var key = 'x' + xAxisIndex + 'y' + yAxisIndex;\n            var cartesian = new Cartesian2D(key);\n\n            cartesian.grid = this;\n            cartesian.model = gridModel;\n\n            this._coordsMap[key] = cartesian;\n            this._coordsList.push(cartesian);\n\n            cartesian.addAxis(xAxis);\n            cartesian.addAxis(yAxis);\n        }, this);\n    }, this);\n\n    function createAxisCreator(axisType) {\n        return function (axisModel, idx) {\n            if (!isAxisUsedInTheGrid(axisModel, gridModel, ecModel)) {\n                return;\n            }\n\n            var axisPosition = axisModel.get('position');\n            if (axisType === 'x') {\n                // Fix position\n                if (axisPosition !== 'top' && axisPosition !== 'bottom') {\n                    // Default bottom of X\n                    axisPosition = 'bottom';\n                    if (axisPositionUsed[axisPosition]) {\n                        axisPosition = axisPosition === 'top' ? 'bottom' : 'top';\n                    }\n                }\n            }\n            else {\n                // Fix position\n                if (axisPosition !== 'left' && axisPosition !== 'right') {\n                    // Default left of Y\n                    axisPosition = 'left';\n                    if (axisPositionUsed[axisPosition]) {\n                        axisPosition = axisPosition === 'left' ? 'right' : 'left';\n                    }\n                }\n            }\n            axisPositionUsed[axisPosition] = true;\n\n            var axis = new Axis2D(\n                axisType, createScaleByModel(axisModel),\n                [0, 0],\n                axisModel.get('type'),\n                axisPosition\n            );\n\n            var isCategory = axis.type === 'category';\n            axis.onBand = isCategory && axisModel.get('boundaryGap');\n            axis.inverse = axisModel.get('inverse');\n\n            axis.onZero = axisModel.get('axisLine.onZero');\n            axis.onZeroAxisIndex = axisModel.get('axisLine.onZeroAxisIndex');\n\n            // Inject axis into axisModel\n            axisModel.axis = axis;\n\n            // Inject axisModel into axis\n            axis.model = axisModel;\n\n            // Inject grid info axis\n            axis.grid = this;\n\n            // Index of axis, can be used as key\n            axis.index = idx;\n\n            this._axesList.push(axis);\n\n            axesMap[axisType][idx] = axis;\n            axesCount[axisType]++;\n        };\n    }\n};\n\n/**\n * Update cartesian properties from series\n * @param  {module:echarts/model/Option} option\n * @private\n */\ngridProto._updateScale = function (ecModel, gridModel) {\n    // Reset scale\n    each$1(this._axesList, function (axis) {\n        axis.scale.setExtent(Infinity, -Infinity);\n    });\n    ecModel.eachSeries(function (seriesModel) {\n        if (isCartesian2D(seriesModel)) {\n            var axesModels = findAxesModels(seriesModel, ecModel);\n            var xAxisModel = axesModels[0];\n            var yAxisModel = axesModels[1];\n\n            if (!isAxisUsedInTheGrid(xAxisModel, gridModel, ecModel)\n                || !isAxisUsedInTheGrid(yAxisModel, gridModel, ecModel)\n            ) {\n                return;\n            }\n\n            var cartesian = this.getCartesian(\n                xAxisModel.componentIndex, yAxisModel.componentIndex\n            );\n            var data = seriesModel.getData();\n            var xAxis = cartesian.getAxis('x');\n            var yAxis = cartesian.getAxis('y');\n\n            if (data.type === 'list') {\n                unionExtent(data, xAxis, seriesModel);\n                unionExtent(data, yAxis, seriesModel);\n            }\n        }\n    }, this);\n\n    function unionExtent(data, axis, seriesModel) {\n        each$6(data.mapDimension(axis.dim, true), function (dim) {\n            axis.scale.unionExtentFromData(data, dim);\n        });\n    }\n};\n\n/**\n * @param {string} [dim] 'x' or 'y' or 'auto' or null/undefined\n * @return {Object} {baseAxes: [], otherAxes: []}\n */\ngridProto.getTooltipAxes = function (dim) {\n    var baseAxes = [];\n    var otherAxes = [];\n\n    each$6(this.getCartesians(), function (cartesian) {\n        var baseAxis = (dim != null && dim !== 'auto')\n            ? cartesian.getAxis(dim) : cartesian.getBaseAxis();\n        var otherAxis = cartesian.getOtherAxis(baseAxis);\n        indexOf(baseAxes, baseAxis) < 0 && baseAxes.push(baseAxis);\n        indexOf(otherAxes, otherAxis) < 0 && otherAxes.push(otherAxis);\n    });\n\n    return {baseAxes: baseAxes, otherAxes: otherAxes};\n};\n\n/**\n * @inner\n */\nfunction updateAxisTransform(axis, coordBase) {\n    var axisExtent = axis.getExtent();\n    var axisExtentSum = axisExtent[0] + axisExtent[1];\n\n    // Fast transform\n    axis.toGlobalCoord = axis.dim === 'x'\n        ? function (coord) {\n            return coord + coordBase;\n        }\n        : function (coord) {\n            return axisExtentSum - coord + coordBase;\n        };\n    axis.toLocalCoord = axis.dim === 'x'\n        ? function (coord) {\n            return coord - coordBase;\n        }\n        : function (coord) {\n            return axisExtentSum - coord + coordBase;\n        };\n}\n\nvar axesTypes = ['xAxis', 'yAxis'];\n/**\n * @inner\n */\nfunction findAxesModels(seriesModel, ecModel) {\n    return map(axesTypes, function (axisType) {\n        var axisModel = seriesModel.getReferringComponents(axisType)[0];\n\n        if (__DEV__) {\n            if (!axisModel) {\n                throw new Error(axisType + ' \"' + retrieve(\n                    seriesModel.get(axisType + 'Index'),\n                    seriesModel.get(axisType + 'Id'),\n                    0\n                ) + '\" not found');\n            }\n        }\n        return axisModel;\n    });\n}\n\n/**\n * @inner\n */\nfunction isCartesian2D(seriesModel) {\n    return seriesModel.get('coordinateSystem') === 'cartesian2d';\n}\n\nGrid.create = function (ecModel, api) {\n    var grids = [];\n    ecModel.eachComponent('grid', function (gridModel, idx) {\n        var grid = new Grid(gridModel, ecModel, api);\n        grid.name = 'grid_' + idx;\n        // dataSampling requires axis extent, so resize\n        // should be performed in create stage.\n        grid.resize(gridModel, api, true);\n\n        gridModel.coordinateSystem = grid;\n\n        grids.push(grid);\n    });\n\n    // Inject the coordinateSystems into seriesModel\n    ecModel.eachSeries(function (seriesModel) {\n        if (!isCartesian2D(seriesModel)) {\n            return;\n        }\n\n        var axesModels = findAxesModels(seriesModel, ecModel);\n        var xAxisModel = axesModels[0];\n        var yAxisModel = axesModels[1];\n\n        var gridModel = xAxisModel.getCoordSysModel();\n\n        if (__DEV__) {\n            if (!gridModel) {\n                throw new Error(\n                    'Grid \"' + retrieve(\n                        xAxisModel.get('gridIndex'),\n                        xAxisModel.get('gridId'),\n                        0\n                    ) + '\" not found'\n                );\n            }\n            if (xAxisModel.getCoordSysModel() !== yAxisModel.getCoordSysModel()) {\n                throw new Error('xAxis and yAxis must use the same grid');\n            }\n        }\n\n        var grid = gridModel.coordinateSystem;\n\n        seriesModel.coordinateSystem = grid.getCartesian(\n            xAxisModel.componentIndex, yAxisModel.componentIndex\n        );\n    });\n\n    return grids;\n};\n\n// For deciding which dimensions to use when creating list data\nGrid.dimensions = Grid.prototype.dimensions = Cartesian2D.prototype.dimensions;\n\nCoordinateSystemManager.register('cartesian2d', Grid);\n\nvar PI$2 = Math.PI;\n\nfunction makeAxisEventDataBase(axisModel) {\n    var eventData = {\n        componentType: axisModel.mainType\n    };\n    eventData[axisModel.mainType + 'Index'] = axisModel.componentIndex;\n    return eventData;\n}\n\n/**\n * A final axis is translated and rotated from a \"standard axis\".\n * So opt.position and opt.rotation is required.\n *\n * A standard axis is and axis from [0, 0] to [0, axisExtent[1]],\n * for example: (0, 0) ------------> (0, 50)\n *\n * nameDirection or tickDirection or labelDirection is 1 means tick\n * or label is below the standard axis, whereas is -1 means above\n * the standard axis. labelOffset means offset between label and axis,\n * which is useful when 'onZero', where axisLabel is in the grid and\n * label in outside grid.\n *\n * Tips: like always,\n * positive rotation represents anticlockwise, and negative rotation\n * represents clockwise.\n * The direction of position coordinate is the same as the direction\n * of screen coordinate.\n *\n * Do not need to consider axis 'inverse', which is auto processed by\n * axis extent.\n *\n * @param {module:zrender/container/Group} group\n * @param {Object} axisModel\n * @param {Object} opt Standard axis parameters.\n * @param {Array.<number>} opt.position [x, y]\n * @param {number} opt.rotation by radian\n * @param {number} [opt.nameDirection=1] 1 or -1 Used when nameLocation is 'middle' or 'center'.\n * @param {number} [opt.tickDirection=1] 1 or -1\n * @param {number} [opt.labelDirection=1] 1 or -1\n * @param {number} [opt.labelOffset=0] Usefull when onZero.\n * @param {string} [opt.axisLabelShow] default get from axisModel.\n * @param {string} [opt.axisName] default get from axisModel.\n * @param {number} [opt.axisNameAvailableWidth]\n * @param {number} [opt.labelRotate] by degree, default get from axisModel.\n * @param {number} [opt.labelInterval] Default label interval when label\n *                                     interval from model is null or 'auto'.\n * @param {number} [opt.strokeContainThreshold] Default label interval when label\n * @param {number} [opt.nameTruncateMaxWidth]\n */\nvar AxisBuilder = function (axisModel, opt) {\n\n    /**\n     * @readOnly\n     */\n    this.opt = opt;\n\n    /**\n     * @readOnly\n     */\n    this.axisModel = axisModel;\n\n    // Default value\n    defaults(\n        opt,\n        {\n            labelOffset: 0,\n            nameDirection: 1,\n            tickDirection: 1,\n            labelDirection: 1,\n            silent: true\n        }\n    );\n\n    /**\n     * @readOnly\n     */\n    this.group = new Group();\n\n    // FIXME Not use a seperate text group?\n    var dumbGroup = new Group({\n        position: opt.position.slice(),\n        rotation: opt.rotation\n    });\n\n    // this.group.add(dumbGroup);\n    // this._dumbGroup = dumbGroup;\n\n    dumbGroup.updateTransform();\n    this._transform = dumbGroup.transform;\n\n    this._dumbGroup = dumbGroup;\n};\n\nAxisBuilder.prototype = {\n\n    constructor: AxisBuilder,\n\n    hasBuilder: function (name) {\n        return !!builders[name];\n    },\n\n    add: function (name) {\n        builders[name].call(this);\n    },\n\n    getGroup: function () {\n        return this.group;\n    }\n\n};\n\nvar builders = {\n\n    /**\n     * @private\n     */\n    axisLine: function () {\n        var opt = this.opt;\n        var axisModel = this.axisModel;\n\n        if (!axisModel.get('axisLine.show')) {\n            return;\n        }\n\n        var extent = this.axisModel.axis.getExtent();\n\n        var matrix = this._transform;\n        var pt1 = [extent[0], 0];\n        var pt2 = [extent[1], 0];\n        if (matrix) {\n            applyTransform(pt1, pt1, matrix);\n            applyTransform(pt2, pt2, matrix);\n        }\n\n        var lineStyle = extend(\n            {\n                lineCap: 'round'\n            },\n            axisModel.getModel('axisLine.lineStyle').getLineStyle()\n        );\n\n        this.group.add(new Line(subPixelOptimizeLine({\n            // Id for animation\n            anid: 'line',\n\n            shape: {\n                x1: pt1[0],\n                y1: pt1[1],\n                x2: pt2[0],\n                y2: pt2[1]\n            },\n            style: lineStyle,\n            strokeContainThreshold: opt.strokeContainThreshold || 5,\n            silent: true,\n            z2: 1\n        })));\n\n        var arrows = axisModel.get('axisLine.symbol');\n        var arrowSize = axisModel.get('axisLine.symbolSize');\n\n        var arrowOffset = axisModel.get('axisLine.symbolOffset') || 0;\n        if (typeof arrowOffset === 'number') {\n            arrowOffset = [arrowOffset, arrowOffset];\n        }\n\n        if (arrows != null) {\n            if (typeof arrows === 'string') {\n                // Use the same arrow for start and end point\n                arrows = [arrows, arrows];\n            }\n            if (typeof arrowSize === 'string'\n                || typeof arrowSize === 'number'\n            ) {\n                // Use the same size for width and height\n                arrowSize = [arrowSize, arrowSize];\n            }\n\n            var symbolWidth = arrowSize[0];\n            var symbolHeight = arrowSize[1];\n\n            each$1([{\n                rotate: opt.rotation + Math.PI / 2,\n                offset: arrowOffset[0],\n                r: 0\n            }, {\n                rotate: opt.rotation - Math.PI / 2,\n                offset: arrowOffset[1],\n                r: Math.sqrt((pt1[0] - pt2[0]) * (pt1[0] - pt2[0])\n                    + (pt1[1] - pt2[1]) * (pt1[1] - pt2[1]))\n            }], function (point, index) {\n                if (arrows[index] !== 'none' && arrows[index] != null) {\n                    var symbol = createSymbol(\n                        arrows[index],\n                        -symbolWidth / 2,\n                        -symbolHeight / 2,\n                        symbolWidth,\n                        symbolHeight,\n                        lineStyle.stroke,\n                        true\n                    );\n\n                    // Calculate arrow position with offset\n                    var r = point.r + point.offset;\n                    var pos = [\n                        pt1[0] + r * Math.cos(opt.rotation),\n                        pt1[1] - r * Math.sin(opt.rotation)\n                    ];\n\n                    symbol.attr({\n                        rotation: point.rotate,\n                        position: pos,\n                        silent: true\n                    });\n                    this.group.add(symbol);\n                }\n            }, this);\n        }\n    },\n\n    /**\n     * @private\n     */\n    axisTickLabel: function () {\n        var axisModel = this.axisModel;\n        var opt = this.opt;\n\n        var tickEls = buildAxisTick(this, axisModel, opt);\n        var labelEls = buildAxisLabel(this, axisModel, opt);\n\n        fixMinMaxLabelShow(axisModel, labelEls, tickEls);\n    },\n\n    /**\n     * @private\n     */\n    axisName: function () {\n        var opt = this.opt;\n        var axisModel = this.axisModel;\n        var name = retrieve(opt.axisName, axisModel.get('name'));\n\n        if (!name) {\n            return;\n        }\n\n        var nameLocation = axisModel.get('nameLocation');\n        var nameDirection = opt.nameDirection;\n        var textStyleModel = axisModel.getModel('nameTextStyle');\n        var gap = axisModel.get('nameGap') || 0;\n\n        var extent = this.axisModel.axis.getExtent();\n        var gapSignal = extent[0] > extent[1] ? -1 : 1;\n        var pos = [\n            nameLocation === 'start'\n                ? extent[0] - gapSignal * gap\n                : nameLocation === 'end'\n                ? extent[1] + gapSignal * gap\n                : (extent[0] + extent[1]) / 2, // 'middle'\n            // Reuse labelOffset.\n            isNameLocationCenter(nameLocation) ? opt.labelOffset + nameDirection * gap : 0\n        ];\n\n        var labelLayout;\n\n        var nameRotation = axisModel.get('nameRotate');\n        if (nameRotation != null) {\n            nameRotation = nameRotation * PI$2 / 180; // To radian.\n        }\n\n        var axisNameAvailableWidth;\n\n        if (isNameLocationCenter(nameLocation)) {\n            labelLayout = innerTextLayout(\n                opt.rotation,\n                nameRotation != null ? nameRotation : opt.rotation, // Adapt to axis.\n                nameDirection\n            );\n        }\n        else {\n            labelLayout = endTextLayout(\n                opt, nameLocation, nameRotation || 0, extent\n            );\n\n            axisNameAvailableWidth = opt.axisNameAvailableWidth;\n            if (axisNameAvailableWidth != null) {\n                axisNameAvailableWidth = Math.abs(\n                    axisNameAvailableWidth / Math.sin(labelLayout.rotation)\n                );\n                !isFinite(axisNameAvailableWidth) && (axisNameAvailableWidth = null);\n            }\n        }\n\n        var textFont = textStyleModel.getFont();\n\n        var truncateOpt = axisModel.get('nameTruncate', true) || {};\n        var ellipsis = truncateOpt.ellipsis;\n        var maxWidth = retrieve(\n            opt.nameTruncateMaxWidth, truncateOpt.maxWidth, axisNameAvailableWidth\n        );\n        // FIXME\n        // truncate rich text? (consider performance)\n        var truncatedText = (ellipsis != null && maxWidth != null)\n            ? truncateText$1(\n                name, maxWidth, textFont, ellipsis,\n                {minChar: 2, placeholder: truncateOpt.placeholder}\n            )\n            : name;\n\n        var tooltipOpt = axisModel.get('tooltip', true);\n\n        var mainType = axisModel.mainType;\n        var formatterParams = {\n            componentType: mainType,\n            name: name,\n            $vars: ['name']\n        };\n        formatterParams[mainType + 'Index'] = axisModel.componentIndex;\n\n        var textEl = new Text({\n            // Id for animation\n            anid: 'name',\n\n            __fullText: name,\n            __truncatedText: truncatedText,\n\n            position: pos,\n            rotation: labelLayout.rotation,\n            silent: isSilent(axisModel),\n            z2: 1,\n            tooltip: (tooltipOpt && tooltipOpt.show)\n                ? extend({\n                    content: name,\n                    formatter: function () {\n                        return name;\n                    },\n                    formatterParams: formatterParams\n                }, tooltipOpt)\n                : null\n        });\n\n        setTextStyle(textEl.style, textStyleModel, {\n            text: truncatedText,\n            textFont: textFont,\n            textFill: textStyleModel.getTextColor()\n                || axisModel.get('axisLine.lineStyle.color'),\n            textAlign: labelLayout.textAlign,\n            textVerticalAlign: labelLayout.textVerticalAlign\n        });\n\n        if (axisModel.get('triggerEvent')) {\n            textEl.eventData = makeAxisEventDataBase(axisModel);\n            textEl.eventData.targetType = 'axisName';\n            textEl.eventData.name = name;\n        }\n\n        // FIXME\n        this._dumbGroup.add(textEl);\n        textEl.updateTransform();\n\n        this.group.add(textEl);\n\n        textEl.decomposeTransform();\n    }\n\n};\n\n/**\n * @public\n * @static\n * @param {Object} opt\n * @param {number} axisRotation in radian\n * @param {number} textRotation in radian\n * @param {number} direction\n * @return {Object} {\n *  rotation, // according to axis\n *  textAlign,\n *  textVerticalAlign\n * }\n */\nvar innerTextLayout = AxisBuilder.innerTextLayout = function (axisRotation, textRotation, direction) {\n    var rotationDiff = remRadian(textRotation - axisRotation);\n    var textAlign;\n    var textVerticalAlign;\n\n    if (isRadianAroundZero(rotationDiff)) { // Label is parallel with axis line.\n        textVerticalAlign = direction > 0 ? 'top' : 'bottom';\n        textAlign = 'center';\n    }\n    else if (isRadianAroundZero(rotationDiff - PI$2)) { // Label is inverse parallel with axis line.\n        textVerticalAlign = direction > 0 ? 'bottom' : 'top';\n        textAlign = 'center';\n    }\n    else {\n        textVerticalAlign = 'middle';\n\n        if (rotationDiff > 0 && rotationDiff < PI$2) {\n            textAlign = direction > 0 ? 'right' : 'left';\n        }\n        else {\n            textAlign = direction > 0 ? 'left' : 'right';\n        }\n    }\n\n    return {\n        rotation: rotationDiff,\n        textAlign: textAlign,\n        textVerticalAlign: textVerticalAlign\n    };\n};\n\nfunction endTextLayout(opt, textPosition, textRotate, extent) {\n    var rotationDiff = remRadian(textRotate - opt.rotation);\n    var textAlign;\n    var textVerticalAlign;\n    var inverse = extent[0] > extent[1];\n    var onLeft = (textPosition === 'start' && !inverse)\n        || (textPosition !== 'start' && inverse);\n\n    if (isRadianAroundZero(rotationDiff - PI$2 / 2)) {\n        textVerticalAlign = onLeft ? 'bottom' : 'top';\n        textAlign = 'center';\n    }\n    else if (isRadianAroundZero(rotationDiff - PI$2 * 1.5)) {\n        textVerticalAlign = onLeft ? 'top' : 'bottom';\n        textAlign = 'center';\n    }\n    else {\n        textVerticalAlign = 'middle';\n        if (rotationDiff < PI$2 * 1.5 && rotationDiff > PI$2 / 2) {\n            textAlign = onLeft ? 'left' : 'right';\n        }\n        else {\n            textAlign = onLeft ? 'right' : 'left';\n        }\n    }\n\n    return {\n        rotation: rotationDiff,\n        textAlign: textAlign,\n        textVerticalAlign: textVerticalAlign\n    };\n}\n\nfunction isSilent(axisModel) {\n    var tooltipOpt = axisModel.get('tooltip');\n    return axisModel.get('silent')\n        // Consider mouse cursor, add these restrictions.\n        || !(\n            axisModel.get('triggerEvent') || (tooltipOpt && tooltipOpt.show)\n        );\n}\n\nfunction fixMinMaxLabelShow(axisModel, labelEls, tickEls) {\n    // If min or max are user set, we need to check\n    // If the tick on min(max) are overlap on their neighbour tick\n    // If they are overlapped, we need to hide the min(max) tick label\n    var showMinLabel = axisModel.get('axisLabel.showMinLabel');\n    var showMaxLabel = axisModel.get('axisLabel.showMaxLabel');\n\n    // FIXME\n    // Have not consider onBand yet, where tick els is more than label els.\n\n    labelEls = labelEls || [];\n    tickEls = tickEls || [];\n\n    var firstLabel = labelEls[0];\n    var nextLabel = labelEls[1];\n    var lastLabel = labelEls[labelEls.length - 1];\n    var prevLabel = labelEls[labelEls.length - 2];\n\n    var firstTick = tickEls[0];\n    var nextTick = tickEls[1];\n    var lastTick = tickEls[tickEls.length - 1];\n    var prevTick = tickEls[tickEls.length - 2];\n\n    if (showMinLabel === false) {\n        ignoreEl(firstLabel);\n        ignoreEl(firstTick);\n    }\n    else if (isTwoLabelOverlapped(firstLabel, nextLabel)) {\n        if (showMinLabel) {\n            ignoreEl(nextLabel);\n            ignoreEl(nextTick);\n        }\n        else {\n            ignoreEl(firstLabel);\n            ignoreEl(firstTick);\n        }\n    }\n\n    if (showMaxLabel === false) {\n        ignoreEl(lastLabel);\n        ignoreEl(lastTick);\n    }\n    else if (isTwoLabelOverlapped(prevLabel, lastLabel)) {\n        if (showMaxLabel) {\n            ignoreEl(prevLabel);\n            ignoreEl(prevTick);\n        }\n        else {\n            ignoreEl(lastLabel);\n            ignoreEl(lastTick);\n        }\n    }\n}\n\nfunction ignoreEl(el) {\n    el && (el.ignore = true);\n}\n\nfunction isTwoLabelOverlapped(current, next, labelLayout) {\n    // current and next has the same rotation.\n    var firstRect = current && current.getBoundingRect().clone();\n    var nextRect = next && next.getBoundingRect().clone();\n\n    if (!firstRect || !nextRect) {\n        return;\n    }\n\n    // When checking intersect of two rotated labels, we use mRotationBack\n    // to avoid that boundingRect is enlarge when using `boundingRect.applyTransform`.\n    var mRotationBack = identity([]);\n    rotate(mRotationBack, mRotationBack, -current.rotation);\n\n    firstRect.applyTransform(mul$1([], mRotationBack, current.getLocalTransform()));\n    nextRect.applyTransform(mul$1([], mRotationBack, next.getLocalTransform()));\n\n    return firstRect.intersect(nextRect);\n}\n\nfunction isNameLocationCenter(nameLocation) {\n    return nameLocation === 'middle' || nameLocation === 'center';\n}\n\n/**\n * @static\n */\nvar ifIgnoreOnTick$1 = AxisBuilder.ifIgnoreOnTick = function (\n    axis,\n    i,\n    interval,\n    ticksCnt,\n    showMinLabel,\n    showMaxLabel\n) {\n    if (i === 0 && showMinLabel || i === ticksCnt - 1 && showMaxLabel) {\n        return false;\n    }\n\n    // FIXME\n    // Have not consider label overlap (if label is too long) yet.\n\n    var rawTick;\n    var scale$$1 = axis.scale;\n    return scale$$1.type === 'ordinal'\n        && (\n            typeof interval === 'function'\n                ? (\n                    rawTick = scale$$1.getTicks()[i],\n                    !interval(rawTick, scale$$1.getLabel(rawTick))\n                )\n                : i % (interval + 1)\n        );\n};\n\n/**\n * @static\n */\nvar getInterval$1 = AxisBuilder.getInterval = function (model, labelInterval) {\n    var interval = model.get('interval');\n    if (interval == null || interval == 'auto') {\n        interval = labelInterval;\n    }\n    return interval;\n};\n\nfunction buildAxisTick(axisBuilder, axisModel, opt) {\n    var axis = axisModel.axis;\n\n    if (!axisModel.get('axisTick.show') || axis.scale.isBlank()) {\n        return;\n    }\n\n    var tickModel = axisModel.getModel('axisTick');\n\n    var lineStyleModel = tickModel.getModel('lineStyle');\n    var tickLen = tickModel.get('length');\n\n    var tickInterval = getInterval$1(tickModel, opt.labelInterval);\n    var ticksCoords = axis.getTicksCoords(tickModel.get('alignWithLabel'));\n    // FIXME\n    // Corresponds to ticksCoords ?\n    var ticks = axis.scale.getTicks();\n\n    var showMinLabel = axisModel.get('axisLabel.showMinLabel');\n    var showMaxLabel = axisModel.get('axisLabel.showMaxLabel');\n\n    var pt1 = [];\n    var pt2 = [];\n    var matrix = axisBuilder._transform;\n\n    var tickEls = [];\n\n    var ticksCnt = ticksCoords.length;\n    for (var i = 0; i < ticksCnt; i++) {\n        // Only ordinal scale support tick interval\n        if (ifIgnoreOnTick$1(\n            axis, i, tickInterval, ticksCnt,\n            showMinLabel, showMaxLabel\n        )) {\n            continue;\n        }\n\n        var tickCoord = ticksCoords[i];\n\n        pt1[0] = tickCoord;\n        pt1[1] = 0;\n        pt2[0] = tickCoord;\n        pt2[1] = opt.tickDirection * tickLen;\n\n        if (matrix) {\n            applyTransform(pt1, pt1, matrix);\n            applyTransform(pt2, pt2, matrix);\n        }\n        // Tick line, Not use group transform to have better line draw\n        var tickEl = new Line(subPixelOptimizeLine({\n            // Id for animation\n            anid: 'tick_' + ticks[i],\n\n            shape: {\n                x1: pt1[0],\n                y1: pt1[1],\n                x2: pt2[0],\n                y2: pt2[1]\n            },\n            style: defaults(\n                lineStyleModel.getLineStyle(),\n                {\n                    stroke: axisModel.get('axisLine.lineStyle.color')\n                }\n            ),\n            z2: 2,\n            silent: true\n        }));\n        axisBuilder.group.add(tickEl);\n        tickEls.push(tickEl);\n    }\n\n    return tickEls;\n}\n\nfunction buildAxisLabel(axisBuilder, axisModel, opt) {\n    var axis = axisModel.axis;\n    var show = retrieve(opt.axisLabelShow, axisModel.get('axisLabel.show'));\n\n    if (!show || axis.scale.isBlank()) {\n        return;\n    }\n\n    var labelModel = axisModel.getModel('axisLabel');\n    var labelMargin = labelModel.get('margin');\n    var ticks = axis.scale.getTicks();\n    var labels = axisModel.getFormattedLabels();\n\n    // Special label rotate.\n    var labelRotation = (\n        retrieve(opt.labelRotate, labelModel.get('rotate')) || 0\n    ) * PI$2 / 180;\n\n    var labelLayout = innerTextLayout(opt.rotation, labelRotation, opt.labelDirection);\n    var categoryData = axisModel.getCategories();\n\n    var labelEls = [];\n    var silent = isSilent(axisModel);\n    var triggerEvent = axisModel.get('triggerEvent');\n\n    var showMinLabel = axisModel.get('axisLabel.showMinLabel');\n    var showMaxLabel = axisModel.get('axisLabel.showMaxLabel');\n\n    each$1(ticks, function (tickVal, index) {\n        if (ifIgnoreOnTick$1(\n            axis, index, opt.labelInterval, ticks.length,\n            showMinLabel, showMaxLabel\n        )) {\n                return;\n        }\n\n        var itemLabelModel = labelModel;\n        if (categoryData && categoryData[tickVal] && categoryData[tickVal].textStyle) {\n            itemLabelModel = new Model(\n                categoryData[tickVal].textStyle, labelModel, axisModel.ecModel\n            );\n        }\n\n        var textColor = itemLabelModel.getTextColor()\n            || axisModel.get('axisLine.lineStyle.color');\n\n        var tickCoord = axis.dataToCoord(tickVal);\n        var pos = [\n            tickCoord,\n            opt.labelOffset + opt.labelDirection * labelMargin\n        ];\n        var labelStr = axis.scale.getLabel(tickVal);\n\n        var textEl = new Text({\n            // Id for animation\n            anid: 'label_' + tickVal,\n            position: pos,\n            rotation: labelLayout.rotation,\n            silent: silent,\n            z2: 10\n        });\n\n        setTextStyle(textEl.style, itemLabelModel, {\n            text: labels[index],\n            textAlign: itemLabelModel.getShallow('align', true)\n                || labelLayout.textAlign,\n            textVerticalAlign: itemLabelModel.getShallow('verticalAlign', true)\n                || itemLabelModel.getShallow('baseline', true)\n                || labelLayout.textVerticalAlign,\n            textFill: typeof textColor === 'function'\n                ? textColor(\n                    // (1) In category axis with data zoom, tick is not the original\n                    // index of axis.data. So tick should not be exposed to user\n                    // in category axis.\n                    // (2) Compatible with previous version, which always returns labelStr.\n                    // But in interval scale labelStr is like '223,445', which maked\n                    // user repalce ','. So we modify it to return original val but remain\n                    // it as 'string' to avoid error in replacing.\n                    axis.type === 'category' ? labelStr : axis.type === 'value' ? tickVal + '' : tickVal,\n                    index\n                )\n                : textColor\n        });\n\n        // Pack data for mouse event\n        if (triggerEvent) {\n            textEl.eventData = makeAxisEventDataBase(axisModel);\n            textEl.eventData.targetType = 'axisLabel';\n            textEl.eventData.value = labelStr;\n        }\n\n        // FIXME\n        axisBuilder._dumbGroup.add(textEl);\n        textEl.updateTransform();\n\n        labelEls.push(textEl);\n        axisBuilder.group.add(textEl);\n\n        textEl.decomposeTransform();\n\n    });\n\n    return labelEls;\n}\n\nvar each$7 = each$1;\nvar curry$1 = curry;\n\n// Build axisPointerModel, mergin tooltip.axisPointer model for each axis.\n// allAxesInfo should be updated when setOption performed.\nfunction collect(ecModel, api) {\n    var result = {\n        /**\n         * key: makeKey(axis.model)\n         * value: {\n         *      axis,\n         *      coordSys,\n         *      axisPointerModel,\n         *      triggerTooltip,\n         *      involveSeries,\n         *      snap,\n         *      seriesModels,\n         *      seriesDataCount\n         * }\n         */\n        axesInfo: {},\n        seriesInvolved: false,\n        /**\n         * key: makeKey(coordSys.model)\n         * value: Object: key makeKey(axis.model), value: axisInfo\n         */\n        coordSysAxesInfo: {},\n        coordSysMap: {}\n    };\n\n    collectAxesInfo(result, ecModel, api);\n\n    // Check seriesInvolved for performance, in case too many series in some chart.\n    result.seriesInvolved && collectSeriesInfo(result, ecModel);\n\n    return result;\n}\n\nfunction collectAxesInfo(result, ecModel, api) {\n    var globalTooltipModel = ecModel.getComponent('tooltip');\n    var globalAxisPointerModel = ecModel.getComponent('axisPointer');\n    // links can only be set on global.\n    var linksOption = globalAxisPointerModel.get('link', true) || [];\n    var linkGroups = [];\n\n    // Collect axes info.\n    each$7(api.getCoordinateSystems(), function (coordSys) {\n        // Some coordinate system do not support axes, like geo.\n        if (!coordSys.axisPointerEnabled) {\n            return;\n        }\n\n        var coordSysKey = makeKey(coordSys.model);\n        var axesInfoInCoordSys = result.coordSysAxesInfo[coordSysKey] = {};\n        result.coordSysMap[coordSysKey] = coordSys;\n\n        // Set tooltip (like 'cross') is a convienent way to show axisPointer\n        // for user. So we enable seting tooltip on coordSys model.\n        var coordSysModel = coordSys.model;\n        var baseTooltipModel = coordSysModel.getModel('tooltip', globalTooltipModel);\n\n        each$7(coordSys.getAxes(), curry$1(saveTooltipAxisInfo, false, null));\n\n        // If axis tooltip used, choose tooltip axis for each coordSys.\n        // Notice this case: coordSys is `grid` but not `cartesian2D` here.\n        if (coordSys.getTooltipAxes\n            && globalTooltipModel\n            // If tooltip.showContent is set as false, tooltip will not\n            // show but axisPointer will show as normal.\n            && baseTooltipModel.get('show')\n        ) {\n            // Compatible with previous logic. But series.tooltip.trigger: 'axis'\n            // or series.data[n].tooltip.trigger: 'axis' are not support any more.\n            var triggerAxis = baseTooltipModel.get('trigger') === 'axis';\n            var cross = baseTooltipModel.get('axisPointer.type') === 'cross';\n            var tooltipAxes = coordSys.getTooltipAxes(baseTooltipModel.get('axisPointer.axis'));\n            if (triggerAxis || cross) {\n                each$7(tooltipAxes.baseAxes, curry$1(\n                    saveTooltipAxisInfo, cross ? 'cross' : true, triggerAxis\n                ));\n            }\n            if (cross) {\n                each$7(tooltipAxes.otherAxes, curry$1(saveTooltipAxisInfo, 'cross', false));\n            }\n        }\n\n        // fromTooltip: true | false | 'cross'\n        // triggerTooltip: true | false | null\n        function saveTooltipAxisInfo(fromTooltip, triggerTooltip, axis) {\n            var axisPointerModel = axis.model.getModel('axisPointer', globalAxisPointerModel);\n\n            var axisPointerShow = axisPointerModel.get('show');\n            if (!axisPointerShow || (\n                axisPointerShow === 'auto'\n                && !fromTooltip\n                && !isHandleTrigger(axisPointerModel)\n            )) {\n                return;\n            }\n\n            if (triggerTooltip == null) {\n                triggerTooltip = axisPointerModel.get('triggerTooltip');\n            }\n\n            axisPointerModel = fromTooltip\n                ? makeAxisPointerModel(\n                    axis, baseTooltipModel, globalAxisPointerModel, ecModel,\n                    fromTooltip, triggerTooltip\n                )\n                : axisPointerModel;\n\n            var snap = axisPointerModel.get('snap');\n            var key = makeKey(axis.model);\n            var involveSeries = triggerTooltip || snap || axis.type === 'category';\n\n            // If result.axesInfo[key] exist, override it (tooltip has higher priority).\n            var axisInfo = result.axesInfo[key] = {\n                key: key,\n                axis: axis,\n                coordSys: coordSys,\n                axisPointerModel: axisPointerModel,\n                triggerTooltip: triggerTooltip,\n                involveSeries: involveSeries,\n                snap: snap,\n                useHandle: isHandleTrigger(axisPointerModel),\n                seriesModels: []\n            };\n            axesInfoInCoordSys[key] = axisInfo;\n            result.seriesInvolved |= involveSeries;\n\n            var groupIndex = getLinkGroupIndex(linksOption, axis);\n            if (groupIndex != null) {\n                var linkGroup = linkGroups[groupIndex] || (linkGroups[groupIndex] = {axesInfo: {}});\n                linkGroup.axesInfo[key] = axisInfo;\n                linkGroup.mapper = linksOption[groupIndex].mapper;\n                axisInfo.linkGroup = linkGroup;\n            }\n        }\n    });\n}\n\nfunction makeAxisPointerModel(\n    axis, baseTooltipModel, globalAxisPointerModel, ecModel, fromTooltip, triggerTooltip\n) {\n    var tooltipAxisPointerModel = baseTooltipModel.getModel('axisPointer');\n    var volatileOption = {};\n\n    each$7(\n        [\n            'type', 'snap', 'lineStyle', 'shadowStyle', 'label',\n            'animation', 'animationDurationUpdate', 'animationEasingUpdate', 'z'\n        ],\n        function (field) {\n            volatileOption[field] = clone(tooltipAxisPointerModel.get(field));\n        }\n    );\n\n    // category axis do not auto snap, otherwise some tick that do not\n    // has value can not be hovered. value/time/log axis default snap if\n    // triggered from tooltip and trigger tooltip.\n    volatileOption.snap = axis.type !== 'category' && !!triggerTooltip;\n\n    // Compatibel with previous behavior, tooltip axis do not show label by default.\n    // Only these properties can be overrided from tooltip to axisPointer.\n    if (tooltipAxisPointerModel.get('type') === 'cross') {\n        volatileOption.type = 'line';\n    }\n    var labelOption = volatileOption.label || (volatileOption.label = {});\n    // Follow the convention, do not show label when triggered by tooltip by default.\n    labelOption.show == null && (labelOption.show = false);\n\n    if (fromTooltip === 'cross') {\n        // When 'cross', both axes show labels.\n        var tooltipAxisPointerLabelShow = tooltipAxisPointerModel.get('label.show');\n        labelOption.show = tooltipAxisPointerLabelShow != null ? tooltipAxisPointerLabelShow : true;\n        // If triggerTooltip, this is a base axis, which should better not use cross style\n        // (cross style is dashed by default)\n        if (!triggerTooltip) {\n            var crossStyle = volatileOption.lineStyle = tooltipAxisPointerModel.get('crossStyle');\n            crossStyle && defaults(labelOption, crossStyle.textStyle);\n        }\n    }\n\n    return axis.model.getModel(\n        'axisPointer',\n        new Model(volatileOption, globalAxisPointerModel, ecModel)\n    );\n}\n\nfunction collectSeriesInfo(result, ecModel) {\n    // Prepare data for axis trigger\n    ecModel.eachSeries(function (seriesModel) {\n\n        // Notice this case: this coordSys is `cartesian2D` but not `grid`.\n        var coordSys = seriesModel.coordinateSystem;\n        var seriesTooltipTrigger = seriesModel.get('tooltip.trigger', true);\n        var seriesTooltipShow = seriesModel.get('tooltip.show', true);\n        if (!coordSys\n            || seriesTooltipTrigger === 'none'\n            || seriesTooltipTrigger === false\n            || seriesTooltipTrigger === 'item'\n            || seriesTooltipShow === false\n            || seriesModel.get('axisPointer.show', true) === false\n        ) {\n            return;\n        }\n\n        each$7(result.coordSysAxesInfo[makeKey(coordSys.model)], function (axisInfo) {\n            var axis = axisInfo.axis;\n            if (coordSys.getAxis(axis.dim) === axis) {\n                axisInfo.seriesModels.push(seriesModel);\n                axisInfo.seriesDataCount == null && (axisInfo.seriesDataCount = 0);\n                axisInfo.seriesDataCount += seriesModel.getData().count();\n            }\n        });\n\n    }, this);\n}\n\n/**\n * For example:\n * {\n *     axisPointer: {\n *         links: [{\n *             xAxisIndex: [2, 4],\n *             yAxisIndex: 'all'\n *         }, {\n *             xAxisId: ['a5', 'a7'],\n *             xAxisName: 'xxx'\n *         }]\n *     }\n * }\n */\nfunction getLinkGroupIndex(linksOption, axis) {\n    var axisModel = axis.model;\n    var dim = axis.dim;\n    for (var i = 0; i < linksOption.length; i++) {\n        var linkOption = linksOption[i] || {};\n        if (checkPropInLink(linkOption[dim + 'AxisId'], axisModel.id)\n            || checkPropInLink(linkOption[dim + 'AxisIndex'], axisModel.componentIndex)\n            || checkPropInLink(linkOption[dim + 'AxisName'], axisModel.name)\n        ) {\n            return i;\n        }\n    }\n}\n\nfunction checkPropInLink(linkPropValue, axisPropValue) {\n    return linkPropValue === 'all'\n        || (isArray(linkPropValue) && indexOf(linkPropValue, axisPropValue) >= 0)\n        || linkPropValue === axisPropValue;\n}\n\nfunction fixValue(axisModel) {\n    var axisInfo = getAxisInfo(axisModel);\n    if (!axisInfo) {\n        return;\n    }\n\n    var axisPointerModel = axisInfo.axisPointerModel;\n    var scale = axisInfo.axis.scale;\n    var option = axisPointerModel.option;\n    var status = axisPointerModel.get('status');\n    var value = axisPointerModel.get('value');\n\n    // Parse init value for category and time axis.\n    if (value != null) {\n        value = scale.parse(value);\n    }\n\n    var useHandle = isHandleTrigger(axisPointerModel);\n    // If `handle` used, `axisPointer` will always be displayed, so value\n    // and status should be initialized.\n    if (status == null) {\n        option.status = useHandle ? 'show' : 'hide';\n    }\n\n    var extent = scale.getExtent().slice();\n    extent[0] > extent[1] && extent.reverse();\n\n    if (// Pick a value on axis when initializing.\n        value == null\n        // If both `handle` and `dataZoom` are used, value may be out of axis extent,\n        // where we should re-pick a value to keep `handle` displaying normally.\n        || value > extent[1]\n    ) {\n        // Make handle displayed on the end of the axis when init, which looks better.\n        value = extent[1];\n    }\n    if (value < extent[0]) {\n        value = extent[0];\n    }\n\n    option.value = value;\n\n    if (useHandle) {\n        option.status = axisInfo.axis.scale.isBlank() ? 'hide' : 'show';\n    }\n}\n\nfunction getAxisInfo(axisModel) {\n    var coordSysAxesInfo = (axisModel.ecModel.getComponent('axisPointer') || {}).coordSysAxesInfo;\n    return coordSysAxesInfo && coordSysAxesInfo.axesInfo[makeKey(axisModel)];\n}\n\nfunction getAxisPointerModel(axisModel) {\n    var axisInfo = getAxisInfo(axisModel);\n    return axisInfo && axisInfo.axisPointerModel;\n}\n\nfunction isHandleTrigger(axisPointerModel) {\n    return !!axisPointerModel.get('handle.show');\n}\n\n/**\n * @param {module:echarts/model/Model} model\n * @return {string} unique key\n */\nfunction makeKey(model) {\n    return model.type + '||' + model.id;\n}\n\n/**\n * Base class of AxisView.\n */\nvar AxisView = extendComponentView({\n\n    type: 'axis',\n\n    /**\n     * @private\n     */\n    _axisPointer: null,\n\n    /**\n     * @protected\n     * @type {string}\n     */\n    axisPointerClass: null,\n\n    /**\n     * @override\n     */\n    render: function (axisModel, ecModel, api, payload) {\n        // FIXME\n        // This process should proformed after coordinate systems updated\n        // (axis scale updated), and should be performed each time update.\n        // So put it here temporarily, although it is not appropriate to\n        // put a model-writing procedure in `view`.\n        this.axisPointerClass && fixValue(axisModel);\n\n        AxisView.superApply(this, 'render', arguments);\n\n        updateAxisPointer(this, axisModel, ecModel, api, payload, true);\n    },\n\n    /**\n     * Action handler.\n     * @public\n     * @param {module:echarts/coord/cartesian/AxisModel} axisModel\n     * @param {module:echarts/model/Global} ecModel\n     * @param {module:echarts/ExtensionAPI} api\n     * @param {Object} payload\n     */\n    updateAxisPointer: function (axisModel, ecModel, api, payload, force) {\n        updateAxisPointer(this, axisModel, ecModel, api, payload, false);\n    },\n\n    /**\n     * @override\n     */\n    remove: function (ecModel, api) {\n        var axisPointer = this._axisPointer;\n        axisPointer && axisPointer.remove(api);\n        AxisView.superApply(this, 'remove', arguments);\n    },\n\n    /**\n     * @override\n     */\n    dispose: function (ecModel, api) {\n        disposeAxisPointer(this, api);\n        AxisView.superApply(this, 'dispose', arguments);\n    }\n\n});\n\nfunction updateAxisPointer(axisView, axisModel, ecModel, api, payload, forceRender) {\n    var Clazz = AxisView.getAxisPointerClass(axisView.axisPointerClass);\n    if (!Clazz) {\n        return;\n    }\n    var axisPointerModel = getAxisPointerModel(axisModel);\n    axisPointerModel\n        ? (axisView._axisPointer || (axisView._axisPointer = new Clazz()))\n            .render(axisModel, axisPointerModel, api, forceRender)\n        : disposeAxisPointer(axisView, api);\n}\n\nfunction disposeAxisPointer(axisView, ecModel, api) {\n    var axisPointer = axisView._axisPointer;\n    axisPointer && axisPointer.dispose(ecModel, api);\n    axisView._axisPointer = null;\n}\n\nvar axisPointerClazz = [];\n\nAxisView.registerAxisPointerClass = function (type, clazz) {\n    if (__DEV__) {\n        if (axisPointerClazz[type]) {\n            throw new Error('axisPointer ' + type + ' exists');\n        }\n    }\n    axisPointerClazz[type] = clazz;\n};\n\nAxisView.getAxisPointerClass = function (type) {\n    return type && axisPointerClazz[type];\n};\n\n/**\n * @param {Object} opt {labelInside}\n * @return {Object} {\n *  position, rotation, labelDirection, labelOffset,\n *  tickDirection, labelRotate, labelInterval, z2\n * }\n */\nfunction layout$1(gridModel, axisModel, opt) {\n    opt = opt || {};\n    var grid = gridModel.coordinateSystem;\n    var axis = axisModel.axis;\n    var layout = {};\n\n    var rawAxisPosition = axis.position;\n    var axisPosition = axis.onZero ? 'onZero' : rawAxisPosition;\n    var axisDim = axis.dim;\n\n    var rect = grid.getRect();\n    var rectBound = [rect.x, rect.x + rect.width, rect.y, rect.y + rect.height];\n    var idx = {left: 0, right: 1, top: 0, bottom: 1, onZero: 2};\n    var axisOffset = axisModel.get('offset') || 0;\n\n    var posBound = axisDim === 'x'\n        ? [rectBound[2] - axisOffset, rectBound[3] + axisOffset]\n        : [rectBound[0] - axisOffset, rectBound[1] + axisOffset];\n\n    if (axis.onZero) {\n        var otherAxis = grid.getAxis(axisDim === 'x' ? 'y' : 'x', axis.onZeroAxisIndex);\n        var onZeroCoord = otherAxis.toGlobalCoord(otherAxis.dataToCoord(0));\n        posBound[idx['onZero']] = Math.max(Math.min(onZeroCoord, posBound[1]), posBound[0]);\n    }\n\n    // Axis position\n    layout.position = [\n        axisDim === 'y' ? posBound[idx[axisPosition]] : rectBound[0],\n        axisDim === 'x' ? posBound[idx[axisPosition]] : rectBound[3]\n    ];\n\n    // Axis rotation\n    layout.rotation = Math.PI / 2 * (axisDim === 'x' ? 0 : 1);\n\n    // Tick and label direction, x y is axisDim\n    var dirMap = {top: -1, bottom: 1, left: -1, right: 1};\n\n    layout.labelDirection = layout.tickDirection = layout.nameDirection = dirMap[rawAxisPosition];\n    layout.labelOffset = axis.onZero ? posBound[idx[rawAxisPosition]] - posBound[idx['onZero']] : 0;\n\n    if (axisModel.get('axisTick.inside')) {\n        layout.tickDirection = -layout.tickDirection;\n    }\n    if (retrieve(opt.labelInside, axisModel.get('axisLabel.inside'))) {\n        layout.labelDirection = -layout.labelDirection;\n    }\n\n    // Special label rotation\n    var labelRotate = axisModel.get('axisLabel.rotate');\n    layout.labelRotate = axisPosition === 'top' ? -labelRotate : labelRotate;\n\n    // label interval when auto mode.\n    layout.labelInterval = axis.getLabelInterval();\n\n    // Over splitLine and splitArea\n    layout.z2 = 1;\n\n    return layout;\n}\n\nvar ifIgnoreOnTick = AxisBuilder.ifIgnoreOnTick;\nvar getInterval = AxisBuilder.getInterval;\n\nvar axisBuilderAttrs = [\n    'axisLine', 'axisTickLabel', 'axisName'\n];\nvar selfBuilderAttrs = [\n    'splitArea', 'splitLine'\n];\n\n// function getAlignWithLabel(model, axisModel) {\n//     var alignWithLabel = model.get('alignWithLabel');\n//     if (alignWithLabel === 'auto') {\n//         alignWithLabel = axisModel.get('axisTick.alignWithLabel');\n//     }\n//     return alignWithLabel;\n// }\n\nvar CartesianAxisView = AxisView.extend({\n\n    type: 'cartesianAxis',\n\n    axisPointerClass: 'CartesianAxisPointer',\n\n    /**\n     * @override\n     */\n    render: function (axisModel, ecModel, api, payload) {\n\n        this.group.removeAll();\n\n        var oldAxisGroup = this._axisGroup;\n        this._axisGroup = new Group();\n\n        this.group.add(this._axisGroup);\n\n        if (!axisModel.get('show')) {\n            return;\n        }\n\n        var gridModel = axisModel.getCoordSysModel();\n\n        var layout = layout$1(gridModel, axisModel);\n\n        var axisBuilder = new AxisBuilder(axisModel, layout);\n\n        each$1(axisBuilderAttrs, axisBuilder.add, axisBuilder);\n\n        this._axisGroup.add(axisBuilder.getGroup());\n\n        each$1(selfBuilderAttrs, function (name) {\n            if (axisModel.get(name + '.show')) {\n                this['_' + name](axisModel, gridModel, layout.labelInterval);\n            }\n        }, this);\n\n        groupTransition(oldAxisGroup, this._axisGroup, axisModel);\n\n        CartesianAxisView.superCall(this, 'render', axisModel, ecModel, api, payload);\n    },\n\n    /**\n     * @param {module:echarts/coord/cartesian/AxisModel} axisModel\n     * @param {module:echarts/coord/cartesian/GridModel} gridModel\n     * @param {number|Function} labelInterval\n     * @private\n     */\n    _splitLine: function (axisModel, gridModel, labelInterval) {\n        var axis = axisModel.axis;\n\n        if (axis.scale.isBlank()) {\n            return;\n        }\n\n        var splitLineModel = axisModel.getModel('splitLine');\n        var lineStyleModel = splitLineModel.getModel('lineStyle');\n        var lineColors = lineStyleModel.get('color');\n\n        var lineInterval = getInterval(splitLineModel, labelInterval);\n\n        lineColors = isArray(lineColors) ? lineColors : [lineColors];\n\n        var gridRect = gridModel.coordinateSystem.getRect();\n        var isHorizontal = axis.isHorizontal();\n\n        var lineCount = 0;\n\n        var ticksCoords = axis.getTicksCoords(\n            // splitLineModel.get('alignWithLabel')\n        );\n        var ticks = axis.scale.getTicks();\n\n        var showMinLabel = axisModel.get('axisLabel.showMinLabel');\n        var showMaxLabel = axisModel.get('axisLabel.showMaxLabel');\n\n        var p1 = [];\n        var p2 = [];\n        // Simple optimization\n        // Batching the lines if color are the same\n        var lineStyle = lineStyleModel.getLineStyle();\n        for (var i = 0; i < ticksCoords.length; i++) {\n            if (ifIgnoreOnTick(\n                axis, i, lineInterval, ticksCoords.length,\n                showMinLabel, showMaxLabel\n            )) {\n                continue;\n            }\n\n            var tickCoord = axis.toGlobalCoord(ticksCoords[i]);\n\n            if (isHorizontal) {\n                p1[0] = tickCoord;\n                p1[1] = gridRect.y;\n                p2[0] = tickCoord;\n                p2[1] = gridRect.y + gridRect.height;\n            }\n            else {\n                p1[0] = gridRect.x;\n                p1[1] = tickCoord;\n                p2[0] = gridRect.x + gridRect.width;\n                p2[1] = tickCoord;\n            }\n\n            var colorIndex = (lineCount++) % lineColors.length;\n            this._axisGroup.add(new Line(subPixelOptimizeLine({\n                anid: 'line_' + ticks[i],\n\n                shape: {\n                    x1: p1[0],\n                    y1: p1[1],\n                    x2: p2[0],\n                    y2: p2[1]\n                },\n                style: defaults({\n                    stroke: lineColors[colorIndex]\n                }, lineStyle),\n                silent: true\n            })));\n        }\n    },\n\n    /**\n     * @param {module:echarts/coord/cartesian/AxisModel} axisModel\n     * @param {module:echarts/coord/cartesian/GridModel} gridModel\n     * @param {number|Function} labelInterval\n     * @private\n     */\n    _splitArea: function (axisModel, gridModel, labelInterval) {\n        var axis = axisModel.axis;\n\n        if (axis.scale.isBlank()) {\n            return;\n        }\n\n        var splitAreaModel = axisModel.getModel('splitArea');\n        var areaStyleModel = splitAreaModel.getModel('areaStyle');\n        var areaColors = areaStyleModel.get('color');\n\n        var gridRect = gridModel.coordinateSystem.getRect();\n\n        var ticksCoords = axis.getTicksCoords(\n            // splitAreaModel.get('alignWithLabel')\n        );\n        var ticks = axis.scale.getTicks();\n\n        var prevX = axis.toGlobalCoord(ticksCoords[0]);\n        var prevY = axis.toGlobalCoord(ticksCoords[0]);\n\n        var count = 0;\n\n        var areaInterval = getInterval(splitAreaModel, labelInterval);\n\n        var areaStyle = areaStyleModel.getAreaStyle();\n        areaColors = isArray(areaColors) ? areaColors : [areaColors];\n\n        var showMinLabel = axisModel.get('axisLabel.showMinLabel');\n        var showMaxLabel = axisModel.get('axisLabel.showMaxLabel');\n\n        for (var i = 1; i < ticksCoords.length; i++) {\n            if (ifIgnoreOnTick(\n                axis, i, areaInterval, ticksCoords.length,\n                showMinLabel, showMaxLabel\n            ) && (i < ticksCoords.length - 1)) {\n                continue;\n            }\n\n            var tickCoord = axis.toGlobalCoord(ticksCoords[i]);\n\n            var x;\n            var y;\n            var width;\n            var height;\n            if (axis.isHorizontal()) {\n                x = prevX;\n                y = gridRect.y;\n                width = tickCoord - x;\n                height = gridRect.height;\n            }\n            else {\n                x = gridRect.x;\n                y = prevY;\n                width = gridRect.width;\n                height = tickCoord - y;\n            }\n\n            var colorIndex = (count++) % areaColors.length;\n            this._axisGroup.add(new Rect({\n                anid: 'area_' + ticks[i],\n\n                shape: {\n                    x: x,\n                    y: y,\n                    width: width,\n                    height: height\n                },\n                style: defaults({\n                    fill: areaColors[colorIndex]\n                }, areaStyle),\n                silent: true\n            }));\n\n            prevX = x + width;\n            prevY = y + height;\n        }\n    }\n});\n\nCartesianAxisView.extend({\n    type: 'xAxis'\n});\nCartesianAxisView.extend({\n    type: 'yAxis'\n});\n\n// Grid view\nextendComponentView({\n\n    type: 'grid',\n\n    render: function (gridModel, ecModel) {\n        this.group.removeAll();\n        if (gridModel.get('show')) {\n            this.group.add(new Rect({\n                shape: gridModel.coordinateSystem.getRect(),\n                style: defaults({\n                    fill: gridModel.get('backgroundColor')\n                }, gridModel.getItemStyle()),\n                silent: true,\n                z2: -1\n            }));\n        }\n    }\n\n});\n\nregisterPreprocessor(function (option) {\n    // Only create grid when need\n    if (option.xAxis && option.yAxis && !option.grid) {\n        option.grid = {};\n    }\n});\n\n// In case developer forget to include grid component\nregisterVisual(visualSymbol('line', 'circle', 'line'));\nregisterLayout(pointsLayout('line'));\n\n// Down sample after filter\nregisterProcessor(\n    PRIORITY.PROCESSOR.STATISTIC,\n    dataSample('line')\n);\n\nvar BaseBarSeries = SeriesModel.extend({\n\n    type: 'series.__base_bar__',\n\n    getInitialData: function (option, ecModel) {\n        return createListFromArray(this.getSource(), this);\n    },\n\n    getMarkerPosition: function (value) {\n        var coordSys = this.coordinateSystem;\n        if (coordSys) {\n            // PENDING if clamp ?\n            var pt = coordSys.dataToPoint(coordSys.clampData(value));\n            var data = this.getData();\n            var offset = data.getLayout('offset');\n            var size = data.getLayout('size');\n            var offsetIndex = coordSys.getBaseAxis().isHorizontal() ? 0 : 1;\n            pt[offsetIndex] += offset + size / 2;\n            return pt;\n        }\n        return [NaN, NaN];\n    },\n\n    defaultOption: {\n        zlevel: 0,                  // \n        z: 2,                       // \n        coordinateSystem: 'cartesian2d',\n        legendHoverLink: true,\n        // stack: null\n\n        // Cartesian coordinate system\n        // xAxisIndex: 0,\n        // yAxisIndex: 0,\n\n        // 0\n        barMinHeight: 0,\n        // 0\n        barMinAngle: 0,\n        // cursor: null,\n\n        // barMaxWidth: null,\n        // \n        // barWidth: null,\n        // 30%\n        // barGap: '30%',\n        // 20%\n        // barCategoryGap: '20%',\n        // label: {\n        //      show: false\n        // },\n        itemStyle: {},\n        emphasis: {}\n    }\n});\n\nBaseBarSeries.extend({\n\n    type: 'series.bar',\n\n    dependencies: ['grid', 'polar'],\n\n    brushSelector: 'rect'\n});\n\nfunction setLabel(\n    normalStyle, hoverStyle, itemModel, color, seriesModel, dataIndex, labelPositionOutside\n) {\n    var labelModel = itemModel.getModel('label');\n    var hoverLabelModel = itemModel.getModel('emphasis.label');\n\n    setLabelStyle(\n        normalStyle, hoverStyle, labelModel, hoverLabelModel,\n        {\n            labelFetcher: seriesModel,\n            labelDataIndex: dataIndex,\n            defaultText: getDefaultLabel(seriesModel.getData(), dataIndex),\n            isRectText: true,\n            autoColor: color\n        }\n    );\n\n    fixPosition(normalStyle);\n    fixPosition(hoverStyle);\n}\n\nfunction fixPosition(style, labelPositionOutside) {\n    if (style.textPosition === 'outside') {\n        style.textPosition = labelPositionOutside;\n    }\n}\n\nvar getBarItemStyle = makeStyleMapper(\n    [\n        ['fill', 'color'],\n        ['stroke', 'borderColor'],\n        ['lineWidth', 'borderWidth'],\n        // Compatitable with 2\n        ['stroke', 'barBorderColor'],\n        ['lineWidth', 'barBorderWidth'],\n        ['opacity'],\n        ['shadowBlur'],\n        ['shadowOffsetX'],\n        ['shadowOffsetY'],\n        ['shadowColor']\n    ]\n);\n\nvar barItemStyle = {\n    getBarItemStyle: function (excludes) {\n        var style = getBarItemStyle(this, excludes);\n        if (this.getBorderLineDash) {\n            var lineDash = this.getBorderLineDash();\n            lineDash && (style.lineDash = lineDash);\n        }\n        return style;\n    }\n};\n\nvar BAR_BORDER_WIDTH_QUERY = ['itemStyle', 'barBorderWidth'];\n\n// FIXME\n// Just for compatible with ec2.\nextend(Model.prototype, barItemStyle);\n\nextendChartView({\n\n    type: 'bar',\n\n    render: function (seriesModel, ecModel, api) {\n        var coordinateSystemType = seriesModel.get('coordinateSystem');\n\n        if (coordinateSystemType === 'cartesian2d'\n            || coordinateSystemType === 'polar'\n        ) {\n            this._render(seriesModel, ecModel, api);\n        }\n        else if (__DEV__) {\n            console.warn('Only cartesian2d and polar supported for bar.');\n        }\n\n        return this.group;\n    },\n\n    dispose: noop,\n\n    _render: function (seriesModel, ecModel, api) {\n        var group = this.group;\n        var data = seriesModel.getData();\n        var oldData = this._data;\n\n        var coord = seriesModel.coordinateSystem;\n        var baseAxis = coord.getBaseAxis();\n        var isHorizontalOrRadial;\n\n        if (coord.type === 'cartesian2d') {\n            isHorizontalOrRadial = baseAxis.isHorizontal();\n        }\n        else if (coord.type === 'polar') {\n            isHorizontalOrRadial = baseAxis.dim === 'angle';\n        }\n\n        var animationModel = seriesModel.isAnimationEnabled() ? seriesModel : null;\n\n        data.diff(oldData)\n            .add(function (dataIndex) {\n                if (!data.hasValue(dataIndex)) {\n                    return;\n                }\n\n                var itemModel = data.getItemModel(dataIndex);\n                var layout = getLayout[coord.type](data, dataIndex, itemModel);\n                var el = elementCreator[coord.type](\n                    data, dataIndex, itemModel, layout, isHorizontalOrRadial, animationModel\n                );\n                data.setItemGraphicEl(dataIndex, el);\n                group.add(el);\n\n                updateStyle(\n                    el, data, dataIndex, itemModel, layout,\n                    seriesModel, isHorizontalOrRadial, coord.type === 'polar'\n                );\n            })\n            .update(function (newIndex, oldIndex) {\n                var el = oldData.getItemGraphicEl(oldIndex);\n\n                if (!data.hasValue(newIndex)) {\n                    group.remove(el);\n                    return;\n                }\n\n                var itemModel = data.getItemModel(newIndex);\n                var layout = getLayout[coord.type](data, newIndex, itemModel);\n\n                if (el) {\n                    updateProps(el, {shape: layout}, animationModel, newIndex);\n                }\n                else {\n                    el = elementCreator[coord.type](\n                        data, newIndex, itemModel, layout, isHorizontalOrRadial, animationModel, true\n                    );\n                }\n\n                data.setItemGraphicEl(newIndex, el);\n                // Add back\n                group.add(el);\n\n                updateStyle(\n                    el, data, newIndex, itemModel, layout,\n                    seriesModel, isHorizontalOrRadial, coord.type === 'polar'\n                );\n            })\n            .remove(function (dataIndex) {\n                var el = oldData.getItemGraphicEl(dataIndex);\n                if (coord.type === 'cartesian2d') {\n                    el && removeRect(dataIndex, animationModel, el);\n                }\n                else {\n                    el && removeSector(dataIndex, animationModel, el);\n                }\n            })\n            .execute();\n\n        this._data = data;\n    },\n\n    remove: function (ecModel, api) {\n        var group = this.group;\n        var data = this._data;\n        if (ecModel.get('animation')) {\n            if (data) {\n                data.eachItemGraphicEl(function (el) {\n                    if (el.type === 'sector') {\n                        removeSector(el.dataIndex, ecModel, el);\n                    }\n                    else {\n                        removeRect(el.dataIndex, ecModel, el);\n                    }\n                });\n            }\n        }\n        else {\n            group.removeAll();\n        }\n    }\n});\n\nvar elementCreator = {\n\n    cartesian2d: function (\n        data, dataIndex, itemModel, layout, isHorizontal,\n        animationModel, isUpdate\n    ) {\n        var rect = new Rect({shape: extend({}, layout)});\n\n        // Animation\n        if (animationModel) {\n            var rectShape = rect.shape;\n            var animateProperty = isHorizontal ? 'height' : 'width';\n            var animateTarget = {};\n            rectShape[animateProperty] = 0;\n            animateTarget[animateProperty] = layout[animateProperty];\n            graphic[isUpdate ? 'updateProps' : 'initProps'](rect, {\n                shape: animateTarget\n            }, animationModel, dataIndex);\n        }\n\n        return rect;\n    },\n\n    polar: function (\n        data, dataIndex, itemModel, layout, isRadial,\n        animationModel, isUpdate\n    ) {\n        // Keep the same logic with bar in catesion: use end value to control\n        // direction. Notice that if clockwise is true (by default), the sector\n        // will always draw clockwisely, no matter whether endAngle is greater\n        // or less than startAngle.\n        var clockwise = layout.startAngle < layout.endAngle;\n        var sector = new Sector({\n            shape: defaults({clockwise: clockwise}, layout)\n        });\n\n        // Animation\n        if (animationModel) {\n            var sectorShape = sector.shape;\n            var animateProperty = isRadial ? 'r' : 'endAngle';\n            var animateTarget = {};\n            sectorShape[animateProperty] = isRadial ? 0 : layout.startAngle;\n            animateTarget[animateProperty] = layout[animateProperty];\n            graphic[isUpdate ? 'updateProps' : 'initProps'](sector, {\n                shape: animateTarget\n            }, animationModel, dataIndex);\n        }\n\n        return sector;\n    }\n};\n\nfunction removeRect(dataIndex, animationModel, el) {\n    // Not show text when animating\n    el.style.text = null;\n    updateProps(el, {\n        shape: {\n            width: 0\n        }\n    }, animationModel, dataIndex, function () {\n        el.parent && el.parent.remove(el);\n    });\n}\n\nfunction removeSector(dataIndex, animationModel, el) {\n    // Not show text when animating\n    el.style.text = null;\n    updateProps(el, {\n        shape: {\n            r: el.shape.r0\n        }\n    }, animationModel, dataIndex, function () {\n        el.parent && el.parent.remove(el);\n    });\n}\n\nvar getLayout = {\n    cartesian2d: function (data, dataIndex, itemModel) {\n        var layout = data.getItemLayout(dataIndex);\n        var fixedLineWidth = getLineWidth(itemModel, layout);\n\n        // fix layout with lineWidth\n        var signX = layout.width > 0 ? 1 : -1;\n        var signY = layout.height > 0 ? 1 : -1;\n        return {\n            x: layout.x + signX * fixedLineWidth / 2,\n            y: layout.y + signY * fixedLineWidth / 2,\n            width: layout.width - signX * fixedLineWidth,\n            height: layout.height - signY * fixedLineWidth\n        };\n    },\n\n    polar: function (data, dataIndex, itemModel) {\n        var layout = data.getItemLayout(dataIndex);\n        return {\n            cx: layout.cx,\n            cy: layout.cy,\n            r0: layout.r0,\n            r: layout.r,\n            startAngle: layout.startAngle,\n            endAngle: layout.endAngle\n        };\n    }\n};\n\nfunction updateStyle(\n    el, data, dataIndex, itemModel, layout, seriesModel, isHorizontal, isPolar\n) {\n    var color = data.getItemVisual(dataIndex, 'color');\n    var opacity = data.getItemVisual(dataIndex, 'opacity');\n    var itemStyleModel = itemModel.getModel('itemStyle');\n    var hoverStyle = itemModel.getModel('emphasis.itemStyle').getBarItemStyle();\n\n    if (!isPolar) {\n        el.setShape('r', itemStyleModel.get('barBorderRadius') || 0);\n    }\n\n    el.useStyle(defaults(\n        {\n            fill: color,\n            opacity: opacity\n        },\n        itemStyleModel.getBarItemStyle()\n    ));\n\n    var cursorStyle = itemModel.getShallow('cursor');\n    cursorStyle && el.attr('cursor', cursorStyle);\n\n    var labelPositionOutside = isHorizontal\n        ? (layout.height > 0 ? 'bottom' : 'top')\n        : (layout.width > 0 ? 'left' : 'right');\n\n    if (!isPolar) {\n        setLabel(\n            el.style, hoverStyle, itemModel, color,\n            seriesModel, dataIndex, labelPositionOutside\n        );\n    }\n\n    setHoverStyle(el, hoverStyle);\n}\n\n// In case width or height are too small.\nfunction getLineWidth(itemModel, rawLayout) {\n    var lineWidth = itemModel.get(BAR_BORDER_WIDTH_QUERY) || 0;\n    return Math.min(lineWidth, Math.abs(rawLayout.width), Math.abs(rawLayout.height));\n}\n\n// In case developer forget to include grid component\nregisterLayout(curry(layout, 'bar'));\n\n// Visual coding for legend\nregisterVisual(function (ecModel) {\n    ecModel.eachSeriesByType('bar', function (seriesModel) {\n        var data = seriesModel.getData();\n        data.setVisual('legendSymbol', 'roundRect');\n    });\n});\n\n/**\n * [Usage]:\n * (1)\n * createListSimply(seriesModel, ['value']);\n * (2)\n * createListSimply(seriesModel, {\n *     coordDimensions: ['value'],\n *     dimensionsCount: 5\n * });\n *\n * @param {module:echarts/model/Series} seriesModel\n * @param {Object|Array.<string|Object>} opt opt or coordDimensions\n *        The options in opt, see `echarts/data/helper/createDimensions`\n * @param {Array.<string>} [nameList]\n * @return {module:echarts/data/List}\n */\nvar createListSimply = function (seriesModel, opt, nameList) {\n    opt = isArray(opt) && {coordDimensions: opt} || extend({}, opt);\n\n    var source = seriesModel.getSource();\n\n    var dimensionsInfo = createDimensions(source, opt);\n\n    var list = new List(dimensionsInfo, seriesModel);\n    list.initData(source, nameList);\n\n    return list;\n};\n\n/**\n * Data selectable mixin for chart series.\n * To eanble data select, option of series must have `selectedMode`.\n * And each data item will use `selected` to toggle itself selected status\n */\n\nvar selectableMixin = {\n\n    /**\n     * @param {Array.<Object>} targetList [{name, value, selected}, ...]\n     *        If targetList is an array, it should like [{name: ..., value: ...}, ...].\n     *        If targetList is a \"List\", it must have coordDim: 'value' dimension and name.\n     */\n    updateSelectedMap: function (targetList) {\n        this._targetList = isArray(targetList) ? targetList.slice() : [];\n\n        this._selectTargetMap = reduce(targetList || [], function (targetMap, target) {\n            targetMap.set(target.name, target);\n            return targetMap;\n        }, createHashMap());\n    },\n\n    /**\n     * Either name or id should be passed as input here.\n     * If both of them are defined, id is used.\n     *\n     * @param {string|undefined} name name of data\n     * @param {number|undefined} id dataIndex of data\n     */\n    // PENGING If selectedMode is null ?\n    select: function (name, id) {\n        var target = id != null\n            ? this._targetList[id]\n            : this._selectTargetMap.get(name);\n        var selectedMode = this.get('selectedMode');\n        if (selectedMode === 'single') {\n            this._selectTargetMap.each(function (target) {\n                target.selected = false;\n            });\n        }\n        target && (target.selected = true);\n    },\n\n    /**\n     * Either name or id should be passed as input here.\n     * If both of them are defined, id is used.\n     *\n     * @param {string|undefined} name name of data\n     * @param {number|undefined} id dataIndex of data\n     */\n    unSelect: function (name, id) {\n        var target = id != null\n            ? this._targetList[id]\n            : this._selectTargetMap.get(name);\n        // var selectedMode = this.get('selectedMode');\n        // selectedMode !== 'single' && target && (target.selected = false);\n        target && (target.selected = false);\n    },\n\n    /**\n     * Either name or id should be passed as input here.\n     * If both of them are defined, id is used.\n     *\n     * @param {string|undefined} name name of data\n     * @param {number|undefined} id dataIndex of data\n     */\n    toggleSelected: function (name, id) {\n        var target = id != null\n            ? this._targetList[id]\n            : this._selectTargetMap.get(name);\n        if (target != null) {\n            this[target.selected ? 'unSelect' : 'select'](name, id);\n            return target.selected;\n        }\n    },\n\n    /**\n     * Either name or id should be passed as input here.\n     * If both of them are defined, id is used.\n     *\n     * @param {string|undefined} name name of data\n     * @param {number|undefined} id dataIndex of data\n     */\n    isSelected: function (name, id) {\n        var target = id != null\n            ? this._targetList[id]\n            : this._selectTargetMap.get(name);\n        return target && target.selected;\n    }\n};\n\nvar PieSeries = extendSeriesModel({\n\n    type: 'series.pie',\n\n    // Overwrite\n    init: function (option) {\n        PieSeries.superApply(this, 'init', arguments);\n\n        // Enable legend selection for each data item\n        // Use a function instead of direct access because data reference may changed\n        this.legendDataProvider = function () {\n            return this.getRawData();\n        };\n\n        this.updateSelectedMap(this._createSelectableList());\n\n        this._defaultLabelLine(option);\n    },\n\n    // Overwrite\n    mergeOption: function (newOption) {\n        PieSeries.superCall(this, 'mergeOption', newOption);\n\n        this.updateSelectedMap(this._createSelectableList());\n    },\n\n    getInitialData: function (option, ecModel) {\n        return createListSimply(this, ['value']);\n    },\n\n    _createSelectableList: function () {\n        var data = this.getRawData();\n        var valueDim = data.mapDimension('value');\n        var targetList = [];\n        for (var i = 0, len = data.count(); i < len; i++) {\n            targetList.push({\n                name: data.getName(i),\n                value: data.get(valueDim, i),\n                selected: retrieveRawAttr(data, i, 'selected')\n            });\n        }\n        return targetList;\n    },\n\n    // Overwrite\n    getDataParams: function (dataIndex) {\n        var data = this.getData();\n        var params = PieSeries.superCall(this, 'getDataParams', dataIndex);\n        // FIXME toFixed?\n\n        var valueList = [];\n        data.each(data.mapDimension('value'), function (value) {\n            valueList.push(value);\n        });\n\n        params.percent = getPercentWithPrecision(\n            valueList,\n            dataIndex,\n            data.hostModel.get('percentPrecision')\n        );\n\n        params.$vars.push('percent');\n        return params;\n    },\n\n    _defaultLabelLine: function (option) {\n        // Extend labelLine emphasis\n        defaultEmphasis(option, 'labelLine', ['show']);\n\n        var labelLineNormalOpt = option.labelLine;\n        var labelLineEmphasisOpt = option.emphasis.labelLine;\n        // Not show label line if `label.normal.show = false`\n        labelLineNormalOpt.show = labelLineNormalOpt.show\n            && option.label.show;\n        labelLineEmphasisOpt.show = labelLineEmphasisOpt.show\n            && option.emphasis.label.show;\n    },\n\n    defaultOption: {\n        zlevel: 0,\n        z: 2,\n        legendHoverLink: true,\n\n        hoverAnimation: true,\n        // \n        center: ['50%', '50%'],\n        radius: [0, '75%'],\n        // \n        clockwise: true,\n        startAngle: 90,\n        // 0\n        minAngle: 0,\n        // \n        selectedOffset: 10,\n        // \n        hoverOffset: 10,\n\n        // If use strategy to avoid label overlapping\n        avoidLabelOverlap: true,\n        // singlemultiple\n        // selectedMode: false,\n        // 'radius' | 'area'\n        // roseType: null,\n\n        percentPrecision: 2,\n\n        // If still show when all data zero.\n        stillShowZeroSum: true,\n\n        // cursor: null,\n\n        label: {\n            // If rotate around circle\n            rotate: false,\n            show: true,\n            // 'outer', 'inside', 'center'\n            position: 'outer'\n            // formatter: Tooltip.formatter\n            // TEXTSTYLE\n            // distance: positioninnerlabel()\n        },\n        // Enabled when label.normal.position is 'outer'\n        labelLine: {\n            show: true,\n            // \n            length: 15,\n            // \n            length2: 15,\n            smooth: false,\n            lineStyle: {\n                // color: ,\n                width: 1,\n                type: 'solid'\n            }\n        },\n        itemStyle: {\n            borderWidth: 1\n        },\n\n        // Animation type canbe expansion, scale\n        animationType: 'expansion',\n\n        animationEasing: 'cubicOut'\n    }\n});\n\nmixin(PieSeries, selectableMixin);\n\n/**\n * @param {module:echarts/model/Series} seriesModel\n * @param {boolean} hasAnimation\n * @inner\n */\nfunction updateDataSelected(uid, seriesModel, hasAnimation, api) {\n    var data = seriesModel.getData();\n    var dataIndex = this.dataIndex;\n    var name = data.getName(dataIndex);\n    var selectedOffset = seriesModel.get('selectedOffset');\n\n    api.dispatchAction({\n        type: 'pieToggleSelect',\n        from: uid,\n        name: name,\n        seriesId: seriesModel.id\n    });\n\n    data.each(function (idx) {\n        toggleItemSelected(\n            data.getItemGraphicEl(idx),\n            data.getItemLayout(idx),\n            seriesModel.isSelected(data.getName(idx)),\n            selectedOffset,\n            hasAnimation\n        );\n    });\n}\n\n/**\n * @param {module:zrender/graphic/Sector} el\n * @param {Object} layout\n * @param {boolean} isSelected\n * @param {number} selectedOffset\n * @param {boolean} hasAnimation\n * @inner\n */\nfunction toggleItemSelected(el, layout, isSelected, selectedOffset, hasAnimation) {\n    var midAngle = (layout.startAngle + layout.endAngle) / 2;\n\n    var dx = Math.cos(midAngle);\n    var dy = Math.sin(midAngle);\n\n    var offset = isSelected ? selectedOffset : 0;\n    var position = [dx * offset, dy * offset];\n\n    hasAnimation\n        // animateTo will stop revious animation like update transition\n        ? el.animate()\n            .when(200, {\n                position: position\n            })\n            .start('bounceOut')\n        : el.attr('position', position);\n}\n\n/**\n * Piece of pie including Sector, Label, LabelLine\n * @constructor\n * @extends {module:zrender/graphic/Group}\n */\nfunction PiePiece(data, idx) {\n\n    Group.call(this);\n\n    var sector = new Sector({\n        z2: 2\n    });\n    var polyline = new Polyline();\n    var text = new Text();\n    this.add(sector);\n    this.add(polyline);\n    this.add(text);\n\n    this.updateData(data, idx, true);\n\n    // Hover to change label and labelLine\n    function onEmphasis() {\n        polyline.ignore = polyline.hoverIgnore;\n        text.ignore = text.hoverIgnore;\n    }\n    function onNormal() {\n        polyline.ignore = polyline.normalIgnore;\n        text.ignore = text.normalIgnore;\n    }\n    this.on('emphasis', onEmphasis)\n        .on('normal', onNormal)\n        .on('mouseover', onEmphasis)\n        .on('mouseout', onNormal);\n}\n\nvar piePieceProto = PiePiece.prototype;\n\npiePieceProto.updateData = function (data, idx, firstCreate) {\n\n    var sector = this.childAt(0);\n\n    var seriesModel = data.hostModel;\n    var itemModel = data.getItemModel(idx);\n    var layout = data.getItemLayout(idx);\n    var sectorShape = extend({}, layout);\n    sectorShape.label = null;\n\n    if (firstCreate) {\n        sector.setShape(sectorShape);\n\n        var animationType = seriesModel.getShallow('animationType');\n        if (animationType === 'scale') {\n            sector.shape.r = layout.r0;\n            initProps(sector, {\n                shape: {\n                    r: layout.r\n                }\n            }, seriesModel, idx);\n        }\n        // Expansion\n        else {\n            sector.shape.endAngle = layout.startAngle;\n            updateProps(sector, {\n                shape: {\n                    endAngle: layout.endAngle\n                }\n            }, seriesModel, idx);\n        }\n\n    }\n    else {\n        updateProps(sector, {\n            shape: sectorShape\n        }, seriesModel, idx);\n    }\n\n    // Update common style\n    var visualColor = data.getItemVisual(idx, 'color');\n\n    sector.useStyle(\n        defaults(\n            {\n                lineJoin: 'bevel',\n                fill: visualColor\n            },\n            itemModel.getModel('itemStyle').getItemStyle()\n        )\n    );\n    sector.hoverStyle = itemModel.getModel('emphasis.itemStyle').getItemStyle();\n\n    var cursorStyle = itemModel.getShallow('cursor');\n    cursorStyle && sector.attr('cursor', cursorStyle);\n\n    // Toggle selected\n    toggleItemSelected(\n        this,\n        data.getItemLayout(idx),\n        seriesModel.isSelected(null, idx),\n        seriesModel.get('selectedOffset'),\n        seriesModel.get('animation')\n    );\n\n    function onEmphasis() {\n        // Sector may has animation of updating data. Force to move to the last frame\n        // Or it may stopped on the wrong shape\n        sector.stopAnimation(true);\n        sector.animateTo({\n            shape: {\n                r: layout.r + seriesModel.get('hoverOffset')\n            }\n        }, 300, 'elasticOut');\n    }\n    function onNormal() {\n        sector.stopAnimation(true);\n        sector.animateTo({\n            shape: {\n                r: layout.r\n            }\n        }, 300, 'elasticOut');\n    }\n    sector.off('mouseover').off('mouseout').off('emphasis').off('normal');\n    if (itemModel.get('hoverAnimation') && seriesModel.isAnimationEnabled()) {\n        sector\n            .on('mouseover', onEmphasis)\n            .on('mouseout', onNormal)\n            .on('emphasis', onEmphasis)\n            .on('normal', onNormal);\n    }\n\n    this._updateLabel(data, idx);\n\n    setHoverStyle(this);\n};\n\npiePieceProto._updateLabel = function (data, idx) {\n\n    var labelLine = this.childAt(1);\n    var labelText = this.childAt(2);\n\n    var seriesModel = data.hostModel;\n    var itemModel = data.getItemModel(idx);\n    var layout = data.getItemLayout(idx);\n    var labelLayout = layout.label;\n    var visualColor = data.getItemVisual(idx, 'color');\n\n    updateProps(labelLine, {\n        shape: {\n            points: labelLayout.linePoints || [\n                [labelLayout.x, labelLayout.y], [labelLayout.x, labelLayout.y], [labelLayout.x, labelLayout.y]\n            ]\n        }\n    }, seriesModel, idx);\n\n    updateProps(labelText, {\n        style: {\n            x: labelLayout.x,\n            y: labelLayout.y\n        }\n    }, seriesModel, idx);\n    labelText.attr({\n        rotation: labelLayout.rotation,\n        origin: [labelLayout.x, labelLayout.y],\n        z2: 10\n    });\n\n    var labelModel = itemModel.getModel('label');\n    var labelHoverModel = itemModel.getModel('emphasis.label');\n    var labelLineModel = itemModel.getModel('labelLine');\n    var labelLineHoverModel = itemModel.getModel('emphasis.labelLine');\n    var visualColor = data.getItemVisual(idx, 'color');\n\n    setLabelStyle(\n        labelText.style, labelText.hoverStyle = {}, labelModel, labelHoverModel,\n        {\n            labelFetcher: data.hostModel,\n            labelDataIndex: idx,\n            defaultText: data.getName(idx),\n            autoColor: visualColor,\n            useInsideStyle: !!labelLayout.inside\n        },\n        {\n            textAlign: labelLayout.textAlign,\n            textVerticalAlign: labelLayout.verticalAlign,\n            opacity: data.getItemVisual(idx, 'opacity')\n        }\n    );\n\n    labelText.ignore = labelText.normalIgnore = !labelModel.get('show');\n    labelText.hoverIgnore = !labelHoverModel.get('show');\n\n    labelLine.ignore = labelLine.normalIgnore = !labelLineModel.get('show');\n    labelLine.hoverIgnore = !labelLineHoverModel.get('show');\n\n    // Default use item visual color\n    labelLine.setStyle({\n        stroke: visualColor,\n        opacity: data.getItemVisual(idx, 'opacity')\n    });\n    labelLine.setStyle(labelLineModel.getModel('lineStyle').getLineStyle());\n\n    labelLine.hoverStyle = labelLineHoverModel.getModel('lineStyle').getLineStyle();\n\n    var smooth = labelLineModel.get('smooth');\n    if (smooth && smooth === true) {\n        smooth = 0.4;\n    }\n    labelLine.setShape({\n        smooth: smooth\n    });\n};\n\ninherits(PiePiece, Group);\n\n\n// Pie view\nvar PieView = Chart.extend({\n\n    type: 'pie',\n\n    init: function () {\n        var sectorGroup = new Group();\n        this._sectorGroup = sectorGroup;\n    },\n\n    render: function (seriesModel, ecModel, api, payload) {\n        if (payload && (payload.from === this.uid)) {\n            return;\n        }\n\n        var data = seriesModel.getData();\n        var oldData = this._data;\n        var group = this.group;\n\n        var hasAnimation = ecModel.get('animation');\n        var isFirstRender = !oldData;\n        var animationType = seriesModel.get('animationType');\n\n        var onSectorClick = curry(\n            updateDataSelected, this.uid, seriesModel, hasAnimation, api\n        );\n\n        var selectedMode = seriesModel.get('selectedMode');\n\n        data.diff(oldData)\n            .add(function (idx) {\n                var piePiece = new PiePiece(data, idx);\n                // Default expansion animation\n                if (isFirstRender && animationType !== 'scale') {\n                    piePiece.eachChild(function (child) {\n                        child.stopAnimation(true);\n                    });\n                }\n\n                selectedMode && piePiece.on('click', onSectorClick);\n\n                data.setItemGraphicEl(idx, piePiece);\n\n                group.add(piePiece);\n            })\n            .update(function (newIdx, oldIdx) {\n                var piePiece = oldData.getItemGraphicEl(oldIdx);\n\n                piePiece.updateData(data, newIdx);\n\n                piePiece.off('click');\n                selectedMode && piePiece.on('click', onSectorClick);\n                group.add(piePiece);\n                data.setItemGraphicEl(newIdx, piePiece);\n            })\n            .remove(function (idx) {\n                var piePiece = oldData.getItemGraphicEl(idx);\n                group.remove(piePiece);\n            })\n            .execute();\n\n        if (\n            hasAnimation && isFirstRender && data.count() > 0\n            // Default expansion animation\n            && animationType !== 'scale'\n        ) {\n            var shape = data.getItemLayout(0);\n            var r = Math.max(api.getWidth(), api.getHeight()) / 2;\n\n            var removeClipPath = bind(group.removeClipPath, group);\n            group.setClipPath(this._createClipPath(\n                shape.cx, shape.cy, r, shape.startAngle, shape.clockwise, removeClipPath, seriesModel\n            ));\n        }\n\n        this._data = data;\n    },\n\n    dispose: function () {},\n\n    _createClipPath: function (\n        cx, cy, r, startAngle, clockwise, cb, seriesModel\n    ) {\n        var clipPath = new Sector({\n            shape: {\n                cx: cx,\n                cy: cy,\n                r0: 0,\n                r: r,\n                startAngle: startAngle,\n                endAngle: startAngle,\n                clockwise: clockwise\n            }\n        });\n\n        initProps(clipPath, {\n            shape: {\n                endAngle: startAngle + (clockwise ? 1 : -1) * Math.PI * 2\n            }\n        }, seriesModel, cb);\n\n        return clipPath;\n    },\n\n    /**\n     * @implement\n     */\n    containPoint: function (point, seriesModel) {\n        var data = seriesModel.getData();\n        var itemLayout = data.getItemLayout(0);\n        if (itemLayout) {\n            var dx = point[0] - itemLayout.cx;\n            var dy = point[1] - itemLayout.cy;\n            var radius = Math.sqrt(dx * dx + dy * dy);\n            return radius <= itemLayout.r && radius >= itemLayout.r0;\n        }\n    }\n\n});\n\nvar createDataSelectAction = function (seriesType, actionInfos) {\n    each$1(actionInfos, function (actionInfo) {\n        actionInfo.update = 'updateView';\n        /**\n         * @payload\n         * @property {string} seriesName\n         * @property {string} name\n         */\n        registerAction(actionInfo, function (payload, ecModel) {\n            var selected = {};\n            ecModel.eachComponent(\n                {mainType: 'series', subType: seriesType, query: payload},\n                function (seriesModel) {\n                    if (seriesModel[actionInfo.method]) {\n                        seriesModel[actionInfo.method](\n                            payload.name,\n                            payload.dataIndex\n                        );\n                    }\n                    var data = seriesModel.getData();\n                    // Create selected map\n                    data.each(function (idx) {\n                        var name = data.getName(idx);\n                        selected[name] = seriesModel.isSelected(name)\n                            || false;\n                    });\n                }\n            );\n            return {\n                name: payload.name,\n                selected: selected\n            };\n        });\n    });\n};\n\n// Pick color from palette for each data item.\n// Applicable for charts that require applying color palette\n// in data level (like pie, funnel, chord).\nvar dataColor = function (seriesType) {\n    return {\n        getTargetSeries: function (ecModel) {\n            // Pie and funnel may use diferrent scope\n            var paletteScope = {};\n            var seiresModelMap = createHashMap();\n\n            ecModel.eachSeriesByType(seriesType, function (seriesModel) {\n                seriesModel.__paletteScope = paletteScope;\n                seiresModelMap.set(seriesModel.uid, seriesModel);\n            });\n\n            return seiresModelMap;\n        },\n        reset: function (seriesModel, ecModel) {\n            var dataAll = seriesModel.getRawData();\n            var idxMap = {};\n            var data = seriesModel.getData();\n\n            data.each(function (idx) {\n                var rawIdx = data.getRawIndex(idx);\n                idxMap[rawIdx] = idx;\n            });\n\n            dataAll.each(function (rawIdx) {\n                var filteredIdx = idxMap[rawIdx];\n\n                // If series.itemStyle.normal.color is a function. itemVisual may be encoded\n                var singleDataColor = filteredIdx != null\n                    && data.getItemVisual(filteredIdx, 'color', true);\n\n                if (!singleDataColor) {\n                    // FIXME Performance\n                    var itemModel = dataAll.getItemModel(rawIdx);\n\n                    var color = itemModel.get('itemStyle.color')\n                        || seriesModel.getColorFromPalette(\n                            dataAll.getName(rawIdx) || (rawIdx + ''), seriesModel.__paletteScope,\n                            dataAll.count()\n                        );\n                    // Legend may use the visual info in data before processed\n                    dataAll.setItemVisual(rawIdx, 'color', color);\n\n                    // Data is not filtered\n                    if (filteredIdx != null) {\n                        data.setItemVisual(filteredIdx, 'color', color);\n                    }\n                }\n                else {\n                    // Set data all color for legend\n                    dataAll.setItemVisual(rawIdx, 'color', singleDataColor);\n                }\n            });\n        }\n    };\n};\n\n// FIXME emphasis label position is not same with normal label position\n\nfunction adjustSingleSide(list, cx, cy, r, dir, viewWidth, viewHeight) {\n    list.sort(function (a, b) {\n        return a.y - b.y;\n    });\n\n    // \n    function shiftDown(start, end, delta, dir) {\n        for (var j = start; j < end; j++) {\n            list[j].y += delta;\n            if (j > start\n                && j + 1 < end\n                && list[j + 1].y > list[j].y + list[j].height\n            ) {\n                shiftUp(j, delta / 2);\n                return;\n            }\n        }\n\n        shiftUp(end - 1, delta / 2);\n    }\n\n    // \n    function shiftUp(end, delta) {\n        for (var j = end; j >= 0; j--) {\n            list[j].y -= delta;\n            if (j > 0\n                && list[j].y > list[j - 1].y + list[j - 1].height\n            ) {\n                break;\n            }\n        }\n    }\n\n    function changeX(list, isDownList, cx, cy, r, dir) {\n        var lastDeltaX = dir > 0\n            ? isDownList                // \n                ? Number.MAX_VALUE      // \n                : 0                     // \n            : isDownList                // \n                ? Number.MAX_VALUE      // \n                : 0;                    // \n\n        for (var i = 0, l = list.length; i < l; i++) {\n            // Not change x for center label\n            if (list[i].position === 'center') {\n                continue;\n            }\n            var deltaY = Math.abs(list[i].y - cy);\n            var length = list[i].len;\n            var length2 = list[i].len2;\n            var deltaX = (deltaY < r + length)\n                ? Math.sqrt(\n                        (r + length + length2) * (r + length + length2)\n                        - deltaY * deltaY\n                    )\n                : Math.abs(list[i].x - cx);\n            if (isDownList && deltaX >= lastDeltaX) {\n                // \n                deltaX = lastDeltaX - 10;\n            }\n            if (!isDownList && deltaX <= lastDeltaX) {\n                // \n                deltaX = lastDeltaX + 10;\n            }\n\n            list[i].x = cx + deltaX * dir;\n            lastDeltaX = deltaX;\n        }\n    }\n\n    var lastY = 0;\n    var delta;\n    var len = list.length;\n    var upList = [];\n    var downList = [];\n    for (var i = 0; i < len; i++) {\n        delta = list[i].y - lastY;\n        if (delta < 0) {\n            shiftDown(i, len, -delta, dir);\n        }\n        lastY = list[i].y + list[i].height;\n    }\n    if (viewHeight - lastY < 0) {\n        shiftUp(len - 1, lastY - viewHeight);\n    }\n    for (var i = 0; i < len; i++) {\n        if (list[i].y >= cy) {\n            downList.push(list[i]);\n        }\n        else {\n            upList.push(list[i]);\n        }\n    }\n    changeX(upList, false, cx, cy, r, dir);\n    changeX(downList, true, cx, cy, r, dir);\n}\n\nfunction avoidOverlap(labelLayoutList, cx, cy, r, viewWidth, viewHeight) {\n    var leftList = [];\n    var rightList = [];\n    for (var i = 0; i < labelLayoutList.length; i++) {\n        if (labelLayoutList[i].x < cx) {\n            leftList.push(labelLayoutList[i]);\n        }\n        else {\n            rightList.push(labelLayoutList[i]);\n        }\n    }\n\n    adjustSingleSide(rightList, cx, cy, r, 1, viewWidth, viewHeight);\n    adjustSingleSide(leftList, cx, cy, r, -1, viewWidth, viewHeight);\n\n    for (var i = 0; i < labelLayoutList.length; i++) {\n        var linePoints = labelLayoutList[i].linePoints;\n        if (linePoints) {\n            var dist = linePoints[1][0] - linePoints[2][0];\n            if (labelLayoutList[i].x < cx) {\n                linePoints[2][0] = labelLayoutList[i].x + 3;\n            }\n            else {\n                linePoints[2][0] = labelLayoutList[i].x - 3;\n            }\n            linePoints[1][1] = linePoints[2][1] = labelLayoutList[i].y;\n            linePoints[1][0] = linePoints[2][0] + dist;\n        }\n    }\n}\n\nvar labelLayout = function (seriesModel, r, viewWidth, viewHeight) {\n    var data = seriesModel.getData();\n    var labelLayoutList = [];\n    var cx;\n    var cy;\n    var hasLabelRotate = false;\n\n    data.each(function (idx) {\n        var layout = data.getItemLayout(idx);\n\n        var itemModel = data.getItemModel(idx);\n        var labelModel = itemModel.getModel('label');\n        // Use position in normal or emphasis\n        var labelPosition = labelModel.get('position') || itemModel.get('emphasis.label.position');\n\n        var labelLineModel = itemModel.getModel('labelLine');\n        var labelLineLen = labelLineModel.get('length');\n        var labelLineLen2 = labelLineModel.get('length2');\n\n        var midAngle = (layout.startAngle + layout.endAngle) / 2;\n        var dx = Math.cos(midAngle);\n        var dy = Math.sin(midAngle);\n\n        var textX;\n        var textY;\n        var linePoints;\n        var textAlign;\n\n        cx = layout.cx;\n        cy = layout.cy;\n\n        var isLabelInside = labelPosition === 'inside' || labelPosition === 'inner';\n        if (labelPosition === 'center') {\n            textX = layout.cx;\n            textY = layout.cy;\n            textAlign = 'center';\n        }\n        else {\n            var x1 = (isLabelInside ? (layout.r + layout.r0) / 2 * dx : layout.r * dx) + cx;\n            var y1 = (isLabelInside ? (layout.r + layout.r0) / 2 * dy : layout.r * dy) + cy;\n\n            textX = x1 + dx * 3;\n            textY = y1 + dy * 3;\n\n            if (!isLabelInside) {\n                // For roseType\n                var x2 = x1 + dx * (labelLineLen + r - layout.r);\n                var y2 = y1 + dy * (labelLineLen + r - layout.r);\n                var x3 = x2 + ((dx < 0 ? -1 : 1) * labelLineLen2);\n                var y3 = y2;\n\n                textX = x3 + (dx < 0 ? -5 : 5);\n                textY = y3;\n                linePoints = [[x1, y1], [x2, y2], [x3, y3]];\n            }\n\n            textAlign = isLabelInside ? 'center' : (dx > 0 ? 'left' : 'right');\n        }\n        var font = labelModel.getFont();\n\n        var labelRotate = labelModel.get('rotate')\n            ? (dx < 0 ? -midAngle + Math.PI : -midAngle) : 0;\n        var text = seriesModel.getFormattedLabel(idx, 'normal')\n                    || data.getName(idx);\n        var textRect = getBoundingRect(\n            text, font, textAlign, 'top'\n        );\n        hasLabelRotate = !!labelRotate;\n        layout.label = {\n            x: textX,\n            y: textY,\n            position: labelPosition,\n            height: textRect.height,\n            len: labelLineLen,\n            len2: labelLineLen2,\n            linePoints: linePoints,\n            textAlign: textAlign,\n            verticalAlign: 'middle',\n            rotation: labelRotate,\n            inside: isLabelInside\n        };\n\n        // Not layout the inside label\n        if (!isLabelInside) {\n            labelLayoutList.push(layout.label);\n        }\n    });\n    if (!hasLabelRotate && seriesModel.get('avoidLabelOverlap')) {\n        avoidOverlap(labelLayoutList, cx, cy, r, viewWidth, viewHeight);\n    }\n};\n\nvar PI2$4 = Math.PI * 2;\nvar RADIAN = Math.PI / 180;\n\nvar pieLayout = function (seriesType, ecModel, api, payload) {\n    ecModel.eachSeriesByType(seriesType, function (seriesModel) {\n        var data = seriesModel.getData();\n        var valueDim = data.mapDimension('value');\n\n        var center = seriesModel.get('center');\n        var radius = seriesModel.get('radius');\n\n        if (!isArray(radius)) {\n            radius = [0, radius];\n        }\n        if (!isArray(center)) {\n            center = [center, center];\n        }\n\n        var width = api.getWidth();\n        var height = api.getHeight();\n        var size = Math.min(width, height);\n        var cx = parsePercent$1(center[0], width);\n        var cy = parsePercent$1(center[1], height);\n        var r0 = parsePercent$1(radius[0], size / 2);\n        var r = parsePercent$1(radius[1], size / 2);\n\n        var startAngle = -seriesModel.get('startAngle') * RADIAN;\n\n        var minAngle = seriesModel.get('minAngle') * RADIAN;\n\n        var validDataCount = 0;\n        data.each(valueDim, function (value) {\n            !isNaN(value) && validDataCount++;\n        });\n\n        var sum = data.getSum(valueDim);\n        // Sum may be 0\n        var unitRadian = Math.PI / (sum || validDataCount) * 2;\n\n        var clockwise = seriesModel.get('clockwise');\n\n        var roseType = seriesModel.get('roseType');\n        var stillShowZeroSum = seriesModel.get('stillShowZeroSum');\n\n        // [0...max]\n        var extent = data.getDataExtent(valueDim);\n        extent[0] = 0;\n\n        // In the case some sector angle is smaller than minAngle\n        var restAngle = PI2$4;\n        var valueSumLargerThanMinAngle = 0;\n\n        var currentAngle = startAngle;\n        var dir = clockwise ? 1 : -1;\n\n        data.each(valueDim, function (value, idx) {\n            var angle;\n            if (isNaN(value)) {\n                data.setItemLayout(idx, {\n                    angle: NaN,\n                    startAngle: NaN,\n                    endAngle: NaN,\n                    clockwise: clockwise,\n                    cx: cx,\n                    cy: cy,\n                    r0: r0,\n                    r: roseType\n                        ? NaN\n                        : r\n                });\n                return;\n            }\n\n            // FIXME  2.0  roseType  area \n            if (roseType !== 'area') {\n                angle = (sum === 0 && stillShowZeroSum)\n                    ? unitRadian : (value * unitRadian);\n            }\n            else {\n                angle = PI2$4 / validDataCount;\n            }\n\n            if (angle < minAngle) {\n                angle = minAngle;\n                restAngle -= minAngle;\n            }\n            else {\n                valueSumLargerThanMinAngle += value;\n            }\n\n            var endAngle = currentAngle + dir * angle;\n            data.setItemLayout(idx, {\n                angle: angle,\n                startAngle: currentAngle,\n                endAngle: endAngle,\n                clockwise: clockwise,\n                cx: cx,\n                cy: cy,\n                r0: r0,\n                r: roseType\n                    ? linearMap(value, extent, [r0, r])\n                    : r\n            });\n\n            currentAngle = endAngle;\n        });\n\n        // Some sector is constrained by minAngle\n        // Rest sectors needs recalculate angle\n        if (restAngle < PI2$4 && validDataCount) {\n            // Average the angle if rest angle is not enough after all angles is\n            // Constrained by minAngle\n            if (restAngle <= 1e-3) {\n                var angle = PI2$4 / validDataCount;\n                data.each(valueDim, function (value, idx) {\n                    if (!isNaN(value)) {\n                        var layout = data.getItemLayout(idx);\n                        layout.angle = angle;\n                        layout.startAngle = startAngle + dir * idx * angle;\n                        layout.endAngle = startAngle + dir * (idx + 1) * angle;\n                    }\n                });\n            }\n            else {\n                unitRadian = restAngle / valueSumLargerThanMinAngle;\n                currentAngle = startAngle;\n                data.each(valueDim, function (value, idx) {\n                    if (!isNaN(value)) {\n                        var layout = data.getItemLayout(idx);\n                        var angle = layout.angle === minAngle\n                            ? minAngle : value * unitRadian;\n                        layout.startAngle = currentAngle;\n                        layout.endAngle = currentAngle + dir * angle;\n                        currentAngle += dir * angle;\n                    }\n                });\n            }\n        }\n\n        labelLayout(seriesModel, r, width, height);\n    });\n};\n\nvar dataFilter = function (seriesType) {\n    return {\n        seriesType: seriesType,\n        reset: function (seriesModel, ecModel) {\n            var legendModels = ecModel.findComponents({\n                mainType: 'legend'\n            });\n            if (!legendModels || !legendModels.length) {\n                return;\n            }\n            var data = seriesModel.getData();\n            data.filterSelf(function (idx) {\n                var name = data.getName(idx);\n                // If in any legend component the status is not selected.\n                for (var i = 0; i < legendModels.length; i++) {\n                    if (!legendModels[i].isSelected(name)) {\n                        return false;\n                    }\n                }\n                return true;\n            });\n        }\n    };\n};\n\ncreateDataSelectAction('pie', [{\n    type: 'pieToggleSelect',\n    event: 'pieselectchanged',\n    method: 'toggleSelected'\n}, {\n    type: 'pieSelect',\n    event: 'pieselected',\n    method: 'select'\n}, {\n    type: 'pieUnSelect',\n    event: 'pieunselected',\n    method: 'unSelect'\n}]);\n\nregisterVisual(dataColor('pie'));\nregisterLayout(curry(pieLayout, 'pie'));\nregisterProcessor(dataFilter('pie'));\n\nSeriesModel.extend({\n\n    type: 'series.scatter',\n\n    dependencies: ['grid', 'polar', 'geo', 'singleAxis', 'calendar'],\n\n    getInitialData: function (option, ecModel) {\n        return createListFromArray(this.getSource(), this);\n    },\n\n    brushSelector: 'point',\n\n    getProgressive: function () {\n        var progressive = this.option.progressive;\n        if (progressive == null) {\n            // PENDING\n            return this.option.large ? 5e3 : this.get('progressive');\n        }\n        return progressive;\n    },\n\n    getProgressiveThreshold: function () {\n        var progressiveThreshold = this.option.progressiveThreshold;\n        if (progressiveThreshold == null) {\n            // PENDING\n            return this.option.large ? 1e4 : this.get('progressiveThreshold');\n        }\n        return progressiveThreshold;\n    },\n\n    defaultOption: {\n        coordinateSystem: 'cartesian2d',\n        zlevel: 0,\n        z: 2,\n        legendHoverLink: true,\n\n        hoverAnimation: true,\n        // Cartesian coordinate system\n        // xAxisIndex: 0,\n        // yAxisIndex: 0,\n\n        // Polar coordinate system\n        // polarIndex: 0,\n\n        // Geo coordinate system\n        // geoIndex: 0,\n\n        // symbol: null,        // \n        symbolSize: 10,          // symbolSize * 2\n        // symbolRotate: null,  // \n\n        large: false,\n        // Available when large is true\n        largeThreshold: 2000,\n        // cursor: null,\n\n        // label: {\n            // show: false\n            // distance: 5,\n            // formatter: Tooltip.formatter\n            // position: 'top''right'\n            //           'inside'|'left'|'right'|'top'|'bottom'\n            // TEXTSTYLE\n        // },\n        itemStyle: {\n            opacity: 0.8\n            // color: \n        },\n\n        progressive: null\n    }\n\n});\n\n// TODO Batch by color\n\nvar BOOST_SIZE_THRESHOLD = 4;\n\nvar LargeSymbolPath = extendShape({\n\n    shape: {\n        points: null\n    },\n\n    symbolProxy: null,\n\n    buildPath: function (path, shape) {\n        var points = shape.points;\n        var size = shape.size;\n\n        var symbolProxy = this.symbolProxy;\n        var symbolProxyShape = symbolProxy.shape;\n        var ctx = path.getContext ? path.getContext() : path;\n        var canBoost = ctx && size[0] < BOOST_SIZE_THRESHOLD;\n\n        // Do draw in afterBrush.\n        if (canBoost) {\n            return;\n        }\n\n        for (var i = 0; i < points.length;) {\n            var x = points[i++];\n            var y = points[i++];\n\n            if (isNaN(x) || isNaN(y)) {\n                continue;\n            }\n\n            symbolProxyShape.x = x - size[0] / 2;\n            symbolProxyShape.y = y - size[1] / 2;\n            symbolProxyShape.width = size[0];\n            symbolProxyShape.height = size[1];\n\n            symbolProxy.buildPath(path, symbolProxyShape, true);\n        }\n    },\n\n    afterBrush: function (ctx) {\n        var shape = this.shape;\n        var points = shape.points;\n        var size = shape.size;\n        var canBoost = size[0] < BOOST_SIZE_THRESHOLD;\n\n        if (!canBoost) {\n            return;\n        }\n\n        this.setTransform(ctx);\n        // PENDING If style or other canvas status changed?\n        for (var i = 0; i < points.length;) {\n            var x = points[i++];\n            var y = points[i++];\n            if (isNaN(x) || isNaN(y)) {\n                continue;\n            }\n            // fillRect is faster than building a rect path and draw.\n            // And it support light globalCompositeOperation.\n            ctx.fillRect(\n                x - size[0] / 2, y - size[1] / 2,\n                size[0], size[1]\n            );\n        }\n\n        this.restoreTransform(ctx);\n    },\n\n    findDataIndex: function (x, y) {\n        // TODO ???\n        // Consider transform\n\n        var shape = this.shape;\n        var points = shape.points;\n        var size = shape.size;\n\n        var w = Math.max(size[0], 4);\n        var h = Math.max(size[1], 4);\n\n        // Not consider transform\n        // Treat each element as a rect\n        // top down traverse\n        for (var idx = points.length / 2 - 1; idx >= 0; idx--) {\n            var i = idx * 2;\n            var x0 = points[i] - w / 2;\n            var y0 = points[i + 1] - h / 2;\n            if (x >= x0 && y >= y0 && x <= x0 + w && y <= y0 + h) {\n                return idx;\n            }\n        }\n\n        return -1;\n    }\n});\n\nfunction LargeSymbolDraw() {\n    this.group = new Group();\n}\n\nvar largeSymbolProto = LargeSymbolDraw.prototype;\n\nlargeSymbolProto.isPersistent = function () {\n    return !this._incremental;\n};\n\n/**\n * Update symbols draw by new data\n * @param {module:echarts/data/List} data\n */\nlargeSymbolProto.updateData = function (data) {\n    this.group.removeAll();\n    var symbolEl = new LargeSymbolPath({\n        rectHover: true,\n        cursor: 'default'\n    });\n\n    symbolEl.setShape({\n        points: data.getLayout('symbolPoints')\n    });\n    this._setCommon(symbolEl, data);\n    this.group.add(symbolEl);\n\n    this._incremental = null;\n};\n\nlargeSymbolProto.updateLayout = function (data) {\n    if (this._incremental) {\n        return;\n    }\n\n    var points = data.getLayout('symbolPoints');\n    this.group.eachChild(function (child) {\n        if (child.startIndex != null) {\n            var len = (child.endIndex - child.startIndex) * 2;\n            var byteOffset = child.startIndex * 4 * 2;\n            points = new Float32Array(points.buffer, byteOffset, len);\n        }\n        child.setShape('points', points);\n    });\n};\n\nlargeSymbolProto.incrementalPrepareUpdate = function (data) {\n    this.group.removeAll();\n\n    this._clearIncremental();\n    // Only use incremental displayables when data amount is larger than 2 million.\n    // PENDING Incremental data?\n    if (data.count() > 2e6) {\n        if (!this._incremental) {\n            this._incremental = new IncrementalDisplayble({\n                silent: true\n            });\n        }\n        this.group.add(this._incremental);\n    }\n    else {\n        this._incremental = null;\n    }\n};\n\nlargeSymbolProto.incrementalUpdate = function (taskParams, data) {\n    var symbolEl;\n    if (this._incremental) {\n        symbolEl = new LargeSymbolPath();\n        this._incremental.addDisplayable(symbolEl, true);\n    }\n    else {\n        symbolEl = new LargeSymbolPath({\n            rectHover: true,\n            cursor: 'default',\n            startIndex: taskParams.start,\n            endIndex: taskParams.end\n        });\n        symbolEl.incremental = true;\n        this.group.add(symbolEl);\n    }\n\n    symbolEl.setShape({\n        points: data.getLayout('symbolPoints')\n    });\n    this._setCommon(symbolEl, data, !!this._incremental);\n};\n\nlargeSymbolProto._setCommon = function (symbolEl, data, isIncremental) {\n    var hostModel = data.hostModel;\n\n    // TODO\n    // if (data.hasItemVisual.symbolSize) {\n    //     // TODO typed array?\n    //     symbolEl.setShape('sizes', data.mapArray(\n    //         function (idx) {\n    //             var size = data.getItemVisual(idx, 'symbolSize');\n    //             return (size instanceof Array) ? size : [size, size];\n    //         }\n    //     ));\n    // }\n    // else {\n    var size = data.getVisual('symbolSize');\n    symbolEl.setShape('size', (size instanceof Array) ? size : [size, size]);\n    // }\n\n    // Create symbolProxy to build path for each data\n    symbolEl.symbolProxy = createSymbol(\n        data.getVisual('symbol'), 0, 0, 0, 0\n    );\n    // Use symbolProxy setColor method\n    symbolEl.setColor = symbolEl.symbolProxy.setColor;\n\n    var extrudeShadow = symbolEl.shape.size[0] < BOOST_SIZE_THRESHOLD;\n    symbolEl.useStyle(\n        // Draw shadow when doing fillRect is extremely slow.\n        hostModel.getModel('itemStyle').getItemStyle(extrudeShadow ? ['color', 'shadowBlur', 'shadowColor'] : ['color'])\n    );\n\n    var visualColor = data.getVisual('color');\n    if (visualColor) {\n        symbolEl.setColor(visualColor);\n    }\n\n    if (!isIncremental) {\n        // Enable tooltip\n        // PENDING May have performance issue when path is extremely large\n        symbolEl.seriesIndex = hostModel.seriesIndex;\n        symbolEl.on('mousemove', function (e) {\n            symbolEl.dataIndex = null;\n            var dataIndex = symbolEl.findDataIndex(e.offsetX, e.offsetY);\n            if (dataIndex >= 0) {\n                // Provide dataIndex for tooltip\n                symbolEl.dataIndex = dataIndex + (symbolEl.startIndex || 0);\n            }\n        });\n    }\n};\n\nlargeSymbolProto.remove = function () {\n    this._clearIncremental();\n    this._incremental = null;\n    this.group.removeAll();\n};\n\nlargeSymbolProto._clearIncremental = function () {\n    var incremental = this._incremental;\n    if (incremental) {\n        incremental.clearDisplaybles();\n    }\n};\n\nextendChartView({\n\n    type: 'scatter',\n\n    render: function (seriesModel, ecModel, api) {\n        var data = seriesModel.getData();\n\n        var symbolDraw = this._updateSymbolDraw(data, seriesModel);\n        symbolDraw.updateData(data);\n\n        this._finished = true;\n    },\n\n    incrementalPrepareRender: function (seriesModel, ecModel, api) {\n        var data = seriesModel.getData();\n        var symbolDraw = this._updateSymbolDraw(data, seriesModel);\n\n        symbolDraw.incrementalPrepareUpdate(data);\n\n        this._finished = false;\n    },\n\n    incrementalRender: function (taskParams, seriesModel, ecModel) {\n        this._symbolDraw.incrementalUpdate(taskParams, seriesModel.getData());\n\n        this._finished = taskParams.end === seriesModel.getData().count();\n    },\n\n    updateTransform: function (seriesModel, ecModel, api) {\n        var data = seriesModel.getData();\n        // Must mark group dirty and make sure the incremental layer will be cleared\n        // PENDING\n        this.group.dirty();\n\n        if (!this._finished || data.count() > 1e4 || !this._symbolDraw.isPersistent()) {\n            return {\n                update: true\n            };\n        }\n        else {\n            var res = pointsLayout().reset(seriesModel);\n            if (res.progress) {\n                res.progress({ start: 0, end: data.count() }, data);\n            }\n\n            this._symbolDraw.updateLayout(data);\n        }\n    },\n\n    _updateSymbolDraw: function (data, seriesModel) {\n        var symbolDraw = this._symbolDraw;\n        var pipelineContext = seriesModel.pipelineContext;\n        var isLargeDraw = pipelineContext.large;\n\n        if (!symbolDraw || isLargeDraw !== this._isLargeDraw) {\n            symbolDraw && symbolDraw.remove();\n            symbolDraw = this._symbolDraw = isLargeDraw\n                ? new LargeSymbolDraw()\n                : new SymbolDraw();\n            this._isLargeDraw = isLargeDraw;\n            this.group.removeAll();\n        }\n\n        this.group.add(symbolDraw.group);\n\n        return symbolDraw;\n    },\n\n    remove: function (ecModel, api) {\n        this._symbolDraw && this._symbolDraw.remove(true);\n        this._symbolDraw = null;\n    },\n\n    dispose: function () {}\n});\n\n// import * as zrUtil from 'zrender/src/core/util';\n\n// In case developer forget to include grid component\nregisterVisual(visualSymbol('scatter', 'circle'));\nregisterLayout(pointsLayout('scatter'));\n\n// echarts.registerProcessor(function (ecModel, api) {\n//     ecModel.eachSeriesByType('scatter', function (seriesModel) {\n//         var data = seriesModel.getData();\n//         var coordSys = seriesModel.coordinateSystem;\n//         if (coordSys.type !== 'geo') {\n//             return;\n//         }\n//         var startPt = coordSys.pointToData([0, 0]);\n//         var endPt = coordSys.pointToData([api.getWidth(), api.getHeight()]);\n\n//         var dims = zrUtil.map(coordSys.dimensions, function (dim) {\n//             return data.mapDimension(dim);\n//         });\n//         var range = {};\n//         range[dims[0]] = [Math.min(startPt[0], endPt[0]), Math.max(startPt[0], endPt[0])];\n//         range[dims[1]] = [Math.min(startPt[1], endPt[1]), Math.max(startPt[1], endPt[1])];\n\n//         data.selectRange(range);\n//     });\n// });\n\nfunction IndicatorAxis(dim, scale, radiusExtent) {\n    Axis.call(this, dim, scale, radiusExtent);\n\n    /**\n     * Axis type\n     *  - 'category'\n     *  - 'value'\n     *  - 'time'\n     *  - 'log'\n     * @type {string}\n     */\n    this.type = 'value';\n\n    this.angle = 0;\n\n    /**\n     * Indicator name\n     * @type {string}\n     */\n    this.name = '';\n    /**\n     * @type {module:echarts/model/Model}\n     */\n    this.model;\n}\n\ninherits(IndicatorAxis, Axis);\n\n// TODO clockwise\n\nfunction Radar(radarModel, ecModel, api) {\n\n    this._model = radarModel;\n    /**\n     * Radar dimensions\n     * @type {Array.<string>}\n     */\n    this.dimensions = [];\n\n    this._indicatorAxes = map(radarModel.getIndicatorModels(), function (indicatorModel, idx) {\n        var dim = 'indicator_' + idx;\n        var indicatorAxis = new IndicatorAxis(dim, new IntervalScale());\n        indicatorAxis.name = indicatorModel.get('name');\n        // Inject model and axis\n        indicatorAxis.model = indicatorModel;\n        indicatorModel.axis = indicatorAxis;\n        this.dimensions.push(dim);\n        return indicatorAxis;\n    }, this);\n\n    this.resize(radarModel, api);\n\n    /**\n     * @type {number}\n     * @readOnly\n     */\n    this.cx;\n    /**\n     * @type {number}\n     * @readOnly\n     */\n    this.cy;\n    /**\n     * @type {number}\n     * @readOnly\n     */\n    this.r;\n    /**\n     * @type {number}\n     * @readOnly\n     */\n    this.startAngle;\n}\n\nRadar.prototype.getIndicatorAxes = function () {\n    return this._indicatorAxes;\n};\n\nRadar.prototype.dataToPoint = function (value, indicatorIndex) {\n    var indicatorAxis = this._indicatorAxes[indicatorIndex];\n\n    return this.coordToPoint(indicatorAxis.dataToCoord(value), indicatorIndex);\n};\n\nRadar.prototype.coordToPoint = function (coord, indicatorIndex) {\n    var indicatorAxis = this._indicatorAxes[indicatorIndex];\n    var angle = indicatorAxis.angle;\n    var x = this.cx + coord * Math.cos(angle);\n    var y = this.cy - coord * Math.sin(angle);\n    return [x, y];\n};\n\nRadar.prototype.pointToData = function (pt) {\n    var dx = pt[0] - this.cx;\n    var dy = pt[1] - this.cy;\n    var radius = Math.sqrt(dx * dx + dy * dy);\n    dx /= radius;\n    dy /= radius;\n\n    var radian = Math.atan2(-dy, dx);\n\n    // Find the closest angle\n    // FIXME index can calculated directly\n    var minRadianDiff = Infinity;\n    var closestAxis;\n    var closestAxisIdx = -1;\n    for (var i = 0; i < this._indicatorAxes.length; i++) {\n        var indicatorAxis = this._indicatorAxes[i];\n        var diff = Math.abs(radian - indicatorAxis.angle);\n        if (diff < minRadianDiff) {\n            closestAxis = indicatorAxis;\n            closestAxisIdx = i;\n            minRadianDiff = diff;\n        }\n    }\n\n    return [closestAxisIdx, +(closestAxis && closestAxis.coodToData(radius))];\n};\n\nRadar.prototype.resize = function (radarModel, api) {\n    var center = radarModel.get('center');\n    var viewWidth = api.getWidth();\n    var viewHeight = api.getHeight();\n    var viewSize = Math.min(viewWidth, viewHeight) / 2;\n    this.cx = parsePercent$1(center[0], viewWidth);\n    this.cy = parsePercent$1(center[1], viewHeight);\n\n    this.startAngle = radarModel.get('startAngle') * Math.PI / 180;\n\n    this.r = parsePercent$1(radarModel.get('radius'), viewSize);\n\n    each$1(this._indicatorAxes, function (indicatorAxis, idx) {\n        indicatorAxis.setExtent(0, this.r);\n        var angle = (this.startAngle + idx * Math.PI * 2 / this._indicatorAxes.length);\n        // Normalize to [-PI, PI]\n        angle = Math.atan2(Math.sin(angle), Math.cos(angle));\n        indicatorAxis.angle = angle;\n    }, this);\n};\n\nRadar.prototype.update = function (ecModel, api) {\n    var indicatorAxes = this._indicatorAxes;\n    var radarModel = this._model;\n    each$1(indicatorAxes, function (indicatorAxis) {\n        indicatorAxis.scale.setExtent(Infinity, -Infinity);\n    });\n    ecModel.eachSeriesByType('radar', function (radarSeries, idx) {\n        if (radarSeries.get('coordinateSystem') !== 'radar'\n            || ecModel.getComponent('radar', radarSeries.get('radarIndex')) !== radarModel\n        ) {\n            return;\n        }\n        var data = radarSeries.getData();\n        each$1(indicatorAxes, function (indicatorAxis) {\n            indicatorAxis.scale.unionExtentFromData(data, data.mapDimension(indicatorAxis.dim));\n        });\n    }, this);\n\n    var splitNumber = radarModel.get('splitNumber');\n\n    function increaseInterval(interval) {\n        var exp10 = Math.pow(10, Math.floor(Math.log(interval) / Math.LN10));\n        // Increase interval\n        var f = interval / exp10;\n        if (f === 2) {\n            f = 5;\n        }\n        else { // f is 2 or 5\n            f *= 2;\n        }\n        return f * exp10;\n    }\n    // Force all the axis fixing the maxSplitNumber.\n    each$1(indicatorAxes, function (indicatorAxis, idx) {\n        var rawExtent = getScaleExtent(indicatorAxis.scale, indicatorAxis.model);\n        niceScaleExtent(indicatorAxis.scale, indicatorAxis.model);\n\n        var axisModel = indicatorAxis.model;\n        var scale = indicatorAxis.scale;\n        var fixedMin = axisModel.getMin();\n        var fixedMax = axisModel.getMax();\n        var interval = scale.getInterval();\n\n        if (fixedMin != null && fixedMax != null) {\n            // User set min, max, divide to get new interval\n            scale.setExtent(+fixedMin, +fixedMax);\n            scale.setInterval(\n                (fixedMax - fixedMin) / splitNumber\n            );\n        }\n        else if (fixedMin != null) {\n            var max;\n            // User set min, expand extent on the other side\n            do {\n                max = fixedMin + interval * splitNumber;\n                scale.setExtent(+fixedMin, max);\n                // Interval must been set after extent\n                // FIXME\n                scale.setInterval(interval);\n\n                interval = increaseInterval(interval);\n            } while (max < rawExtent[1] && isFinite(max) && isFinite(rawExtent[1]));\n        }\n        else if (fixedMax != null) {\n            var min;\n            // User set min, expand extent on the other side\n            do {\n                min = fixedMax - interval * splitNumber;\n                scale.setExtent(min, +fixedMax);\n                scale.setInterval(interval);\n                interval = increaseInterval(interval);\n            } while (min > rawExtent[0] && isFinite(min) && isFinite(rawExtent[0]));\n        }\n        else {\n            var nicedSplitNumber = scale.getTicks().length - 1;\n            if (nicedSplitNumber > splitNumber) {\n                interval = increaseInterval(interval);\n            }\n            // PENDING\n            var center = Math.round((rawExtent[0] + rawExtent[1]) / 2 / interval) * interval;\n            var halfSplitNumber = Math.round(splitNumber / 2);\n            scale.setExtent(\n                round$1(center - halfSplitNumber * interval),\n                round$1(center + (splitNumber - halfSplitNumber) * interval)\n            );\n            scale.setInterval(interval);\n        }\n    });\n};\n\n/**\n * Radar dimensions is based on the data\n * @type {Array}\n */\nRadar.dimensions = [];\n\nRadar.create = function (ecModel, api) {\n    var radarList = [];\n    ecModel.eachComponent('radar', function (radarModel) {\n        var radar = new Radar(radarModel, ecModel, api);\n        radarList.push(radar);\n        radarModel.coordinateSystem = radar;\n    });\n    ecModel.eachSeriesByType('radar', function (radarSeries) {\n        if (radarSeries.get('coordinateSystem') === 'radar') {\n            // Inject coordinate system\n            radarSeries.coordinateSystem = radarList[radarSeries.get('radarIndex') || 0];\n        }\n    });\n    return radarList;\n};\n\nCoordinateSystemManager.register('radar', Radar);\n\nvar valueAxisDefault = axisDefault.valueAxis;\n\nfunction defaultsShow(opt, show) {\n    return defaults({\n        show: show\n    }, opt);\n}\n\nvar RadarModel = extendComponentModel({\n\n    type: 'radar',\n\n    optionUpdated: function () {\n        var boundaryGap = this.get('boundaryGap');\n        var splitNumber = this.get('splitNumber');\n        var scale = this.get('scale');\n        var axisLine = this.get('axisLine');\n        var axisTick = this.get('axisTick');\n        var axisLabel = this.get('axisLabel');\n        var nameTextStyle = this.get('name');\n        var showName = this.get('name.show');\n        var nameFormatter = this.get('name.formatter');\n        var nameGap = this.get('nameGap');\n        var triggerEvent = this.get('triggerEvent');\n\n        var indicatorModels = map(this.get('indicator') || [], function (indicatorOpt) {\n            // PENDING\n            if (indicatorOpt.max != null && indicatorOpt.max > 0 && !indicatorOpt.min) {\n                indicatorOpt.min = 0;\n            }\n            else if (indicatorOpt.min != null && indicatorOpt.min < 0 && !indicatorOpt.max) {\n                indicatorOpt.max = 0;\n            }\n            var iNameTextStyle = nameTextStyle;\n            if(indicatorOpt.color != null) {\n                iNameTextStyle = defaults({color: indicatorOpt.color}, nameTextStyle);\n            }\n            // Use same configuration\n            indicatorOpt = merge(clone(indicatorOpt), {\n                boundaryGap: boundaryGap,\n                splitNumber: splitNumber,\n                scale: scale,\n                axisLine: axisLine,\n                axisTick: axisTick,\n                axisLabel: axisLabel,\n                // Competitable with 2 and use text\n                name: indicatorOpt.text,\n                nameLocation: 'end',\n                nameGap: nameGap,\n                // min: 0,\n                nameTextStyle: iNameTextStyle,\n                triggerEvent: triggerEvent\n            }, false);\n            if (!showName) {\n                indicatorOpt.name = '';\n            }\n            if (typeof nameFormatter === 'string') {\n                var indName = indicatorOpt.name;\n                indicatorOpt.name = nameFormatter.replace('{value}', indName != null ? indName : '');\n            }\n            else if (typeof nameFormatter === 'function') {\n                indicatorOpt.name = nameFormatter(\n                    indicatorOpt.name, indicatorOpt\n                );\n            }\n            var model = extend(\n                new Model(indicatorOpt, null, this.ecModel),\n                axisModelCommonMixin\n            );\n\n            // For triggerEvent.\n            model.mainType = 'radar';\n            model.componentIndex = this.componentIndex;\n\n            return model;\n        }, this);\n\n        this.getIndicatorModels = function () {\n            return indicatorModels;\n        };\n    },\n\n    defaultOption: {\n\n        zlevel: 0,\n\n        z: 0,\n\n        center: ['50%', '50%'],\n\n        radius: '75%',\n\n        startAngle: 90,\n\n        name: {\n            show: true\n            // formatter: null\n            // textStyle: {}\n        },\n\n        boundaryGap: [0, 0],\n\n        splitNumber: 5,\n\n        nameGap: 15,\n\n        scale: false,\n\n        // Polygon or circle\n        shape: 'polygon',\n\n        axisLine: merge(\n            {\n                lineStyle: {\n                    color: '#bbb'\n                }\n            },\n            valueAxisDefault.axisLine\n        ),\n        axisLabel: defaultsShow(valueAxisDefault.axisLabel, false),\n        axisTick: defaultsShow(valueAxisDefault.axisTick, false),\n        splitLine: defaultsShow(valueAxisDefault.splitLine, true),\n        splitArea: defaultsShow(valueAxisDefault.splitArea, true),\n\n        // {text, min, max}\n        indicator: []\n    }\n});\n\nvar axisBuilderAttrs$1 = [\n    'axisLine', 'axisTickLabel', 'axisName'\n];\n\nextendComponentView({\n\n    type: 'radar',\n\n    render: function (radarModel, ecModel, api) {\n        var group = this.group;\n        group.removeAll();\n\n        this._buildAxes(radarModel);\n        this._buildSplitLineAndArea(radarModel);\n    },\n\n    _buildAxes: function (radarModel) {\n        var radar = radarModel.coordinateSystem;\n        var indicatorAxes = radar.getIndicatorAxes();\n        var axisBuilders = map(indicatorAxes, function (indicatorAxis) {\n            var axisBuilder = new AxisBuilder(indicatorAxis.model, {\n                position: [radar.cx, radar.cy],\n                rotation: indicatorAxis.angle,\n                labelDirection: -1,\n                tickDirection: -1,\n                nameDirection: 1\n            });\n            return axisBuilder;\n        });\n\n        each$1(axisBuilders, function (axisBuilder) {\n            each$1(axisBuilderAttrs$1, axisBuilder.add, axisBuilder);\n            this.group.add(axisBuilder.getGroup());\n        }, this);\n    },\n\n    _buildSplitLineAndArea: function (radarModel) {\n        var radar = radarModel.coordinateSystem;\n        var indicatorAxes = radar.getIndicatorAxes();\n        if (!indicatorAxes.length) {\n            return;\n        }\n        var shape = radarModel.get('shape');\n        var splitLineModel = radarModel.getModel('splitLine');\n        var splitAreaModel = radarModel.getModel('splitArea');\n        var lineStyleModel = splitLineModel.getModel('lineStyle');\n        var areaStyleModel = splitAreaModel.getModel('areaStyle');\n\n        var showSplitLine = splitLineModel.get('show');\n        var showSplitArea = splitAreaModel.get('show');\n        var splitLineColors = lineStyleModel.get('color');\n        var splitAreaColors = areaStyleModel.get('color');\n\n        splitLineColors = isArray(splitLineColors) ? splitLineColors : [splitLineColors];\n        splitAreaColors = isArray(splitAreaColors) ? splitAreaColors : [splitAreaColors];\n\n        var splitLines = [];\n        var splitAreas = [];\n\n        function getColorIndex(areaOrLine, areaOrLineColorList, idx) {\n            var colorIndex = idx % areaOrLineColorList.length;\n            areaOrLine[colorIndex] = areaOrLine[colorIndex] || [];\n            return colorIndex;\n        }\n\n        if (shape === 'circle') {\n            var ticksRadius = indicatorAxes[0].getTicksCoords();\n            var cx = radar.cx;\n            var cy = radar.cy;\n            for (var i = 0; i < ticksRadius.length; i++) {\n                if (showSplitLine) {\n                    var colorIndex = getColorIndex(splitLines, splitLineColors, i);\n                    splitLines[colorIndex].push(new Circle({\n                        shape: {\n                            cx: cx,\n                            cy: cy,\n                            r: ticksRadius[i]\n                        }\n                    }));\n                }\n                if (showSplitArea && i < ticksRadius.length - 1) {\n                    var colorIndex = getColorIndex(splitAreas, splitAreaColors, i);\n                    splitAreas[colorIndex].push(new Ring({\n                        shape: {\n                            cx: cx,\n                            cy: cy,\n                            r0: ticksRadius[i],\n                            r: ticksRadius[i + 1]\n                        }\n                    }));\n                }\n            }\n        }\n        // Polyyon\n        else {\n            var realSplitNumber;\n            var axesTicksPoints = map(indicatorAxes, function (indicatorAxis, idx) {\n                var ticksCoords = indicatorAxis.getTicksCoords();\n                realSplitNumber = realSplitNumber == null\n                    ? ticksCoords.length - 1\n                    : Math.min(ticksCoords.length - 1, realSplitNumber);\n                return map(ticksCoords, function (tickCoord) {\n                    return radar.coordToPoint(tickCoord, idx);\n                });\n            });\n\n            var prevPoints = [];\n            for (var i = 0; i <= realSplitNumber; i++) {\n                var points = [];\n                for (var j = 0; j < indicatorAxes.length; j++) {\n                    points.push(axesTicksPoints[j][i]);\n                }\n                // Close\n                if (points[0]) {\n                    points.push(points[0].slice());\n                }\n                else {\n                    if (__DEV__) {\n                        console.error('Can\\'t draw value axis ' + i);\n                    }\n                }\n\n                if (showSplitLine) {\n                    var colorIndex = getColorIndex(splitLines, splitLineColors, i);\n                    splitLines[colorIndex].push(new Polyline({\n                        shape: {\n                            points: points\n                        }\n                    }));\n                }\n                if (showSplitArea && prevPoints) {\n                    var colorIndex = getColorIndex(splitAreas, splitAreaColors, i - 1);\n                    splitAreas[colorIndex].push(new Polygon({\n                        shape: {\n                            points: points.concat(prevPoints)\n                        }\n                    }));\n                }\n                prevPoints = points.slice().reverse();\n            }\n        }\n\n        var lineStyle = lineStyleModel.getLineStyle();\n        var areaStyle = areaStyleModel.getAreaStyle();\n        // Add splitArea before splitLine\n        each$1(splitAreas, function (splitAreas, idx) {\n            this.group.add(mergePath(\n                splitAreas, {\n                    style: defaults({\n                        stroke: 'none',\n                        fill: splitAreaColors[idx % splitAreaColors.length]\n                    }, areaStyle),\n                    silent: true\n                }\n            ));\n        }, this);\n\n        each$1(splitLines, function (splitLines, idx) {\n            this.group.add(mergePath(\n                splitLines, {\n                    style: defaults({\n                        fill: 'none',\n                        stroke: splitLineColors[idx % splitLineColors.length]\n                    }, lineStyle),\n                    silent: true\n                }\n            ));\n        }, this);\n\n    }\n});\n\nvar RadarSeries = SeriesModel.extend({\n\n    type: 'series.radar',\n\n    dependencies: ['radar'],\n\n\n    // Overwrite\n    init: function (option) {\n        RadarSeries.superApply(this, 'init', arguments);\n\n        // Enable legend selection for each data item\n        // Use a function instead of direct access because data reference may changed\n        this.legendDataProvider = function () {\n            return this.getRawData();\n        };\n    },\n\n    getInitialData: function (option, ecModel) {\n        return createListSimply(this, {\n            generateCoord: 'indicator_',\n            generateCoordCount: Infinity\n        });\n    },\n\n    formatTooltip: function (dataIndex) {\n        var data = this.getData();\n        var coordSys = this.coordinateSystem;\n        var indicatorAxes = coordSys.getIndicatorAxes();\n        var name = this.getData().getName(dataIndex);\n        return encodeHTML(name === '' ? this.name : name) + '<br/>'\n            + map(indicatorAxes, function (axis, idx) {\n                var val = data.get(data.mapDimension(axis.dim), dataIndex);\n                return encodeHTML(axis.name + ' : ' + val);\n            }).join('<br />');\n    },\n\n    defaultOption: {\n        zlevel: 0,\n        z: 2,\n        coordinateSystem: 'radar',\n        legendHoverLink: true,\n        radarIndex: 0,\n        lineStyle: {\n            width: 2,\n            type: 'solid'\n        },\n        label: {\n            position: 'top'\n        },\n        // areaStyle: {\n        // },\n        // itemStyle: {}\n        symbol: 'emptyCircle',\n        symbolSize: 4\n        // symbolRotate: null\n    }\n});\n\nfunction normalizeSymbolSize(symbolSize) {\n    if (!isArray(symbolSize)) {\n        symbolSize = [+symbolSize, +symbolSize];\n    }\n    return symbolSize;\n}\n\nextendChartView({\n\n    type: 'radar',\n\n    render: function (seriesModel, ecModel, api) {\n        var polar = seriesModel.coordinateSystem;\n        var group = this.group;\n\n        var data = seriesModel.getData();\n        var oldData = this._data;\n\n        function createSymbol$$1(data, idx) {\n            var symbolType = data.getItemVisual(idx, 'symbol') || 'circle';\n            var color = data.getItemVisual(idx, 'color');\n            if (symbolType === 'none') {\n                return;\n            }\n            var symbolSize = normalizeSymbolSize(\n                data.getItemVisual(idx, 'symbolSize')\n            );\n            var symbolPath = createSymbol(\n                symbolType, -1, -1, 2, 2, color\n            );\n            symbolPath.attr({\n                style: {\n                    strokeNoScale: true\n                },\n                z2: 100,\n                scale: [symbolSize[0] / 2, symbolSize[1] / 2]\n            });\n            return symbolPath;\n        }\n\n        function updateSymbols(oldPoints, newPoints, symbolGroup, data, idx, isInit) {\n            // Simply rerender all\n            symbolGroup.removeAll();\n            for (var i = 0; i < newPoints.length - 1; i++) {\n                var symbolPath = createSymbol$$1(data, idx);\n                if (symbolPath) {\n                    symbolPath.__dimIdx = i;\n                    if (oldPoints[i]) {\n                        symbolPath.attr('position', oldPoints[i]);\n                        graphic[isInit ? 'initProps' : 'updateProps'](\n                            symbolPath, {\n                                position: newPoints[i]\n                            }, seriesModel, idx\n                        );\n                    }\n                    else {\n                        symbolPath.attr('position', newPoints[i]);\n                    }\n                    symbolGroup.add(symbolPath);\n                }\n            }\n        }\n\n        function getInitialPoints(points) {\n            return map(points, function (pt) {\n                return [polar.cx, polar.cy];\n            });\n        }\n        data.diff(oldData)\n            .add(function (idx) {\n                var points = data.getItemLayout(idx);\n                if (!points) {\n                    return;\n                }\n                var polygon = new Polygon();\n                var polyline = new Polyline();\n                var target = {\n                    shape: {\n                        points: points\n                    }\n                };\n                polygon.shape.points = getInitialPoints(points);\n                polyline.shape.points = getInitialPoints(points);\n                initProps(polygon, target, seriesModel, idx);\n                initProps(polyline, target, seriesModel, idx);\n\n                var itemGroup = new Group();\n                var symbolGroup = new Group();\n                itemGroup.add(polyline);\n                itemGroup.add(polygon);\n                itemGroup.add(symbolGroup);\n\n                updateSymbols(\n                    polyline.shape.points, points, symbolGroup, data, idx, true\n                );\n\n                data.setItemGraphicEl(idx, itemGroup);\n            })\n            .update(function (newIdx, oldIdx) {\n                var itemGroup = oldData.getItemGraphicEl(oldIdx);\n                var polyline = itemGroup.childAt(0);\n                var polygon = itemGroup.childAt(1);\n                var symbolGroup = itemGroup.childAt(2);\n                var target = {\n                    shape: {\n                        points: data.getItemLayout(newIdx)\n                    }\n                };\n                if (!target.shape.points) {\n                    return;\n                }\n                updateSymbols(\n                    polyline.shape.points, target.shape.points, symbolGroup, data, newIdx, false\n                );\n\n                updateProps(polyline, target, seriesModel);\n                updateProps(polygon, target, seriesModel);\n\n                data.setItemGraphicEl(newIdx, itemGroup);\n            })\n            .remove(function (idx) {\n                group.remove(oldData.getItemGraphicEl(idx));\n            })\n            .execute();\n\n        data.eachItemGraphicEl(function (itemGroup, idx) {\n            var itemModel = data.getItemModel(idx);\n            var polyline = itemGroup.childAt(0);\n            var polygon = itemGroup.childAt(1);\n            var symbolGroup = itemGroup.childAt(2);\n            var color = data.getItemVisual(idx, 'color');\n\n            group.add(itemGroup);\n\n            polyline.useStyle(\n                defaults(\n                    itemModel.getModel('lineStyle').getLineStyle(),\n                    {\n                        fill: 'none',\n                        stroke: color\n                    }\n                )\n            );\n            polyline.hoverStyle = itemModel.getModel('emphasis.lineStyle').getLineStyle();\n\n            var areaStyleModel = itemModel.getModel('areaStyle');\n            var hoverAreaStyleModel = itemModel.getModel('emphasis.areaStyle');\n            var polygonIgnore = areaStyleModel.isEmpty() && areaStyleModel.parentModel.isEmpty();\n            var hoverPolygonIgnore = hoverAreaStyleModel.isEmpty() && hoverAreaStyleModel.parentModel.isEmpty();\n\n            hoverPolygonIgnore = hoverPolygonIgnore && polygonIgnore;\n            polygon.ignore = polygonIgnore;\n\n            polygon.useStyle(\n                defaults(\n                    areaStyleModel.getAreaStyle(),\n                    {\n                        fill: color,\n                        opacity: 0.7\n                    }\n                )\n            );\n            polygon.hoverStyle = hoverAreaStyleModel.getAreaStyle();\n\n            var itemStyle = itemModel.getModel('itemStyle').getItemStyle(['color']);\n            var itemHoverStyle = itemModel.getModel('emphasis.itemStyle').getItemStyle();\n            var labelModel = itemModel.getModel('label');\n            var labelHoverModel = itemModel.getModel('emphasis.label');\n            symbolGroup.eachChild(function (symbolPath) {\n                symbolPath.setStyle(itemStyle);\n                symbolPath.hoverStyle = clone(itemHoverStyle);\n\n                setLabelStyle(\n                    symbolPath.style, symbolPath.hoverStyle, labelModel, labelHoverModel,\n                    {\n                        labelFetcher: data.hostModel,\n                        labelDataIndex: idx,\n                        labelDimIndex: symbolPath.__dimIdx,\n                        defaultText: data.get(data.dimensions[symbolPath.__dimIdx], idx),\n                        autoColor: color,\n                        isRectText: true\n                    }\n                );\n            });\n\n            function onEmphasis() {\n                polygon.attr('ignore', hoverPolygonIgnore);\n            }\n\n            function onNormal() {\n                polygon.attr('ignore', polygonIgnore);\n            }\n\n            itemGroup.off('mouseover').off('mouseout').off('normal').off('emphasis');\n            itemGroup.on('emphasis', onEmphasis)\n                .on('mouseover', onEmphasis)\n                .on('normal', onNormal)\n                .on('mouseout', onNormal);\n\n            setHoverStyle(itemGroup);\n        });\n\n        this._data = data;\n    },\n\n    remove: function () {\n        this.group.removeAll();\n        this._data = null;\n    },\n\n    dispose: function () {}\n});\n\nvar radarLayout = function (ecModel) {\n    ecModel.eachSeriesByType('radar', function (seriesModel) {\n        var data = seriesModel.getData();\n        var points = [];\n        var coordSys = seriesModel.coordinateSystem;\n        if (!coordSys) {\n            return;\n        }\n\n        function pointsConverter(val, idx) {\n            points[idx] = points[idx] || [];\n            points[idx][i] = coordSys.dataToPoint(val, i);\n        }\n        var axes = coordSys.getIndicatorAxes();\n        for (var i = 0; i < coordSys.getIndicatorAxes().length; i++) {\n            data.each(data.mapDimension(axes[i].dim), pointsConverter);\n        }\n\n        data.each(function (idx) {\n            // Close polygon\n            points[idx][0] && points[idx].push(points[idx][0].slice());\n            data.setItemLayout(idx, points[idx]);\n        });\n    });\n};\n\n// Backward compat for radar chart in 2\nvar backwardCompat$1 = function (option) {\n    var polarOptArr = option.polar;\n    if (polarOptArr) {\n        if (!isArray(polarOptArr)) {\n            polarOptArr = [polarOptArr];\n        }\n        var polarNotRadar = [];\n        each$1(polarOptArr, function (polarOpt, idx) {\n            if (polarOpt.indicator) {\n                if (polarOpt.type && !polarOpt.shape) {\n                    polarOpt.shape = polarOpt.type;\n                }\n                option.radar = option.radar || [];\n                if (!isArray(option.radar)) {\n                    option.radar = [option.radar];\n                }\n                option.radar.push(polarOpt);\n            }\n            else {\n                polarNotRadar.push(polarOpt);\n            }\n        });\n        option.polar = polarNotRadar;\n    }\n    each$1(option.series, function (seriesOpt) {\n        if (seriesOpt && seriesOpt.type === 'radar' && seriesOpt.polarIndex) {\n            seriesOpt.radarIndex = seriesOpt.polarIndex;\n        }\n    });\n};\n\n// Must use radar component\nregisterVisual(dataColor('radar'));\nregisterVisual(visualSymbol('radar', 'circle'));\nregisterLayout(radarLayout);\nregisterProcessor(dataFilter('radar'));\nregisterPreprocessor(backwardCompat$1);\n\n/**\n * Simple view coordinate system\n * Mapping given x, y to transformd view x, y\n */\n\nvar v2ApplyTransform$1 = applyTransform;\n\n// Dummy transform node\nfunction TransformDummy() {\n    Transformable.call(this);\n}\nmixin(TransformDummy, Transformable);\n\nfunction View(name) {\n    /**\n     * @type {string}\n     */\n    this.name = name;\n\n    /**\n     * @type {Object}\n     */\n    this.zoomLimit;\n\n    Transformable.call(this);\n\n    this._roamTransformable = new TransformDummy();\n\n    this._rawTransformable = new TransformDummy();\n\n    this._center;\n    this._zoom;\n}\n\nView.prototype = {\n\n    constructor: View,\n\n    type: 'view',\n\n    /**\n     * @param {Array.<string>}\n     * @readOnly\n     */\n    dimensions: ['x', 'y'],\n\n    /**\n     * Set bounding rect\n     * @param {number} x\n     * @param {number} y\n     * @param {number} width\n     * @param {number} height\n     */\n\n    // PENDING to getRect\n    setBoundingRect: function (x, y, width, height) {\n        this._rect = new BoundingRect(x, y, width, height);\n        return this._rect;\n    },\n\n    /**\n     * @return {module:zrender/core/BoundingRect}\n     */\n    // PENDING to getRect\n    getBoundingRect: function () {\n        return this._rect;\n    },\n\n    /**\n     * @param {number} x\n     * @param {number} y\n     * @param {number} width\n     * @param {number} height\n     */\n    setViewRect: function (x, y, width, height) {\n        this.transformTo(x, y, width, height);\n        this._viewRect = new BoundingRect(x, y, width, height);\n    },\n\n    /**\n     * Transformed to particular position and size\n     * @param {number} x\n     * @param {number} y\n     * @param {number} width\n     * @param {number} height\n     */\n    transformTo: function (x, y, width, height) {\n        var rect = this.getBoundingRect();\n        var rawTransform = this._rawTransformable;\n\n        rawTransform.transform = rect.calculateTransform(\n            new BoundingRect(x, y, width, height)\n        );\n\n        rawTransform.decomposeTransform();\n\n        this._updateTransform();\n    },\n\n    /**\n     * Set center of view\n     * @param {Array.<number>} [centerCoord]\n     */\n    setCenter: function (centerCoord) {\n        if (!centerCoord) {\n            return;\n        }\n        this._center = centerCoord;\n\n        this._updateCenterAndZoom();\n    },\n\n    /**\n     * @param {number} zoom\n     */\n    setZoom: function (zoom) {\n        zoom = zoom || 1;\n\n        var zoomLimit = this.zoomLimit;\n        if (zoomLimit) {\n            if (zoomLimit.max != null) {\n                zoom = Math.min(zoomLimit.max, zoom);\n            }\n            if (zoomLimit.min != null) {\n                zoom = Math.max(zoomLimit.min, zoom);\n            }\n        }\n        this._zoom = zoom;\n\n        this._updateCenterAndZoom();\n    },\n\n    /**\n     * Get default center without roam\n     */\n    getDefaultCenter: function () {\n        // Rect before any transform\n        var rawRect = this.getBoundingRect();\n        var cx = rawRect.x + rawRect.width / 2;\n        var cy = rawRect.y + rawRect.height / 2;\n\n        return [cx, cy];\n    },\n\n    getCenter: function () {\n        return this._center || this.getDefaultCenter();\n    },\n\n    getZoom: function () {\n        return this._zoom || 1;\n    },\n\n    /**\n     * @return {Array.<number}\n     */\n    getRoamTransform: function () {\n        return this._roamTransformable.getLocalTransform();\n    },\n\n    /**\n     * Remove roam\n     */\n\n    _updateCenterAndZoom: function () {\n        // Must update after view transform updated\n        var rawTransformMatrix = this._rawTransformable.getLocalTransform();\n        var roamTransform = this._roamTransformable;\n        var defaultCenter = this.getDefaultCenter();\n        var center = this.getCenter();\n        var zoom = this.getZoom();\n\n        center = applyTransform([], center, rawTransformMatrix);\n        defaultCenter = applyTransform([], defaultCenter, rawTransformMatrix);\n\n        roamTransform.origin = center;\n        roamTransform.position = [\n            defaultCenter[0] - center[0],\n            defaultCenter[1] - center[1]\n        ];\n        roamTransform.scale = [zoom, zoom];\n\n        this._updateTransform();\n    },\n\n    /**\n     * Update transform from roam and mapLocation\n     * @private\n     */\n    _updateTransform: function () {\n        var roamTransformable = this._roamTransformable;\n        var rawTransformable = this._rawTransformable;\n\n        rawTransformable.parent = roamTransformable;\n        roamTransformable.updateTransform();\n        rawTransformable.updateTransform();\n\n        copy$1(this.transform || (this.transform = []), rawTransformable.transform || create$1());\n\n        this._rawTransform = rawTransformable.getLocalTransform();\n\n        this.invTransform = this.invTransform || [];\n        invert(this.invTransform, this.transform);\n\n        this.decomposeTransform();\n    },\n\n    /**\n     * @return {module:zrender/core/BoundingRect}\n     */\n    getViewRect: function () {\n        return this._viewRect;\n    },\n\n    /**\n     * Get view rect after roam transform\n     * @return {module:zrender/core/BoundingRect}\n     */\n    getViewRectAfterRoam: function () {\n        var rect = this.getBoundingRect().clone();\n        rect.applyTransform(this.transform);\n        return rect;\n    },\n\n    /**\n     * Convert a single (lon, lat) data item to (x, y) point.\n     * @param {Array.<number>} data\n     * @param {boolean} noRoam\n     * @param {Array.<number>} [out]\n     * @return {Array.<number>}\n     */\n    dataToPoint: function (data, noRoam, out) {\n        var transform = noRoam ? this._rawTransform : this.transform;\n        out = out || [];\n        return transform\n            ? v2ApplyTransform$1(out, data, transform)\n            : copy(out, data);\n    },\n\n    /**\n     * Convert a (x, y) point to (lon, lat) data\n     * @param {Array.<number>} point\n     * @return {Array.<number>}\n     */\n    pointToData: function (point) {\n        var invTransform = this.invTransform;\n        return invTransform\n            ? v2ApplyTransform$1([], point, invTransform)\n            : [point[0], point[1]];\n    },\n\n    /**\n     * @implements\n     * see {module:echarts/CoodinateSystem}\n     */\n    convertToPixel: curry(doConvert$1, 'dataToPoint'),\n\n    /**\n     * @implements\n     * see {module:echarts/CoodinateSystem}\n     */\n    convertFromPixel: curry(doConvert$1, 'pointToData'),\n\n    /**\n     * @implements\n     * see {module:echarts/CoodinateSystem}\n     */\n    containPoint: function (point) {\n        return this.getViewRectAfterRoam().contain(point[0], point[1]);\n    }\n\n    /**\n     * @return {number}\n     */\n    // getScalarScale: function () {\n    //     // Use determinant square root of transform to mutiply scalar\n    //     var m = this.transform;\n    //     var det = Math.sqrt(Math.abs(m[0] * m[3] - m[2] * m[1]));\n    //     return det;\n    // }\n};\n\nmixin(View, Transformable);\n\nfunction doConvert$1(methodName, ecModel, finder, value) {\n    var seriesModel = finder.seriesModel;\n    var coordSys = seriesModel ? seriesModel.coordinateSystem : null; // e.g., graph.\n    return coordSys === this ? coordSys[methodName](value) : null;\n}\n\n// Fix for \n\nvar geoCoord = [126, 25];\n\nvar points$1 = [\n    [[0,3.5],[7,11.2],[15,11.9],[30,7],[42,0.7],[52,0.7],\n        [56,7.7],[59,0.7],[64,0.7],[64,0],[5,0],[0,3.5]],\n    [[13,16.1],[19,14.7],[16,21.7],[11,23.1],[13,16.1]],\n    [[12,32.2],[14,38.5],[15,38.5],[13,32.2],[12,32.2]],\n    [[16,47.6],[12,53.2],[13,53.2],[18,47.6],[16,47.6]],\n    [[6,64.4],[8,70],[9,70],[8,64.4],[6,64.4]],\n    [[23,82.6],[29,79.8],[30,79.8],[25,82.6],[23,82.6]],\n    [[37,70.7],[43,62.3],[44,62.3],[39,70.7],[37,70.7]],\n    [[48,51.1],[51,45.5],[53,45.5],[50,51.1],[48,51.1]],\n    [[51,35],[51,28.7],[53,28.7],[53,35],[51,35]],\n    [[52,22.4],[55,17.5],[56,17.5],[53,22.4],[52,22.4]],\n    [[58,12.6],[62,7],[63,7],[60,12.6],[58,12.6]],\n    [[0,3.5],[0,93.1],[64,93.1],[64,0],[63,0],[63,92.4],\n        [1,92.4],[1,3.5],[0,3.5]]\n];\n\nfor (var i$1 = 0; i$1 < points$1.length; i$1++) {\n    for (var k = 0; k < points$1[i$1].length; k++) {\n        points$1[i$1][k][0] /= 10.5;\n        points$1[i$1][k][1] /= -10.5 / 0.75;\n\n        points$1[i$1][k][0] += geoCoord[0];\n        points$1[i$1][k][1] += geoCoord[1];\n    }\n}\n\nvar fixNanhai = function (geo) {\n    if (geo.map === 'china') {\n        geo.regions.push(new Region(\n            '',\n            map(points$1, function (exterior) {\n                return {\n                    type: 'polygon',\n                    exterior: exterior\n                };\n            }), geoCoord\n        ));\n    }\n};\n\nvar coordsOffsetMap = {\n    '' : [32, 80],\n    // \n    '': [0, -10],\n    '': [10, 5],\n    '': [-10, 10],\n    //'': [-10, 0],\n    '': [5, 5]\n};\n\nvar fixTextCoord = function (geo) {\n    each$1(geo.regions, function (region) {\n        var coordFix = coordsOffsetMap[region.name];\n        if (coordFix) {\n            var cp = region.center;\n            cp[0] += coordFix[0] / 10.5;\n            cp[1] += -coordFix[1] / (10.5 / 0.75);\n        }\n    });\n};\n\nvar geoCoordMap = {\n    'Russia': [100, 60],\n    'United States': [-99, 38],\n    'United States of America': [-99, 38]\n};\n\nvar fixGeoCoord = function (geo) {\n    each$1(geo.regions, function (region) {\n        var geoCoord = geoCoordMap[region.name];\n        if (geoCoord) {\n            var cp = region.center;\n            cp[0] = geoCoord[0];\n            cp[1] = geoCoord[1];\n        }\n    });\n};\n\n// Fix for \n\n// var Region = require('../Region');\n// var zrUtil = require('zrender/src/core/util');\n\n// var geoCoord = [126, 25];\n\nvar points$2 = [\n    [\n        [123.45165252685547, 25.73527164402261],\n        [123.49731445312499, 25.73527164402261],\n        [123.49731445312499, 25.750734064600884],\n        [123.45165252685547, 25.750734064600884],\n        [123.45165252685547, 25.73527164402261]\n    ]\n];\n\nvar fixDiaoyuIsland = function (geo) {\n    if (geo.map === 'china') {\n        for (var i = 0, len = geo.regions.length; i < len; ++i) {\n            if (geo.regions[i].name === '') {\n                geo.regions[i].geometries.push({\n                    type: 'polygon',\n                    exterior: points$2[0]\n                });\n            }\n        }\n    }\n};\n\n// Geo fix functions\nvar geoFixFuncs = [\n    fixNanhai,\n    fixTextCoord,\n    fixGeoCoord,\n    fixDiaoyuIsland\n];\n\n/**\n * [Geo description]\n * @param {string} name Geo name\n * @param {string} map Map type\n * @param {Object} geoJson\n * @param {Object} [specialAreas]\n *        Specify the positioned areas by left, top, width, height\n * @param {Object.<string, string>} [nameMap]\n *        Specify name alias\n */\nfunction Geo(name, map$$1, geoJson, specialAreas, nameMap) {\n\n    View.call(this, name);\n\n    /**\n     * Map type\n     * @type {string}\n     */\n    this.map = map$$1;\n\n    this._nameCoordMap = createHashMap();\n\n    this.loadGeoJson(geoJson, specialAreas, nameMap);\n}\n\nGeo.prototype = {\n\n    constructor: Geo,\n\n    type: 'geo',\n\n    /**\n     * @param {Array.<string>}\n     * @readOnly\n     */\n    dimensions: ['lng', 'lat'],\n\n    /**\n     * If contain given lng,lat coord\n     * @param {Array.<number>}\n     * @readOnly\n     */\n    containCoord: function (coord) {\n        var regions = this.regions;\n        for (var i = 0; i < regions.length; i++) {\n            if (regions[i].contain(coord)) {\n                return true;\n            }\n        }\n        return false;\n    },\n    /**\n     * @param {Object} geoJson\n     * @param {Object} [specialAreas]\n     *        Specify the positioned areas by left, top, width, height\n     * @param {Object.<string, string>} [nameMap]\n     *        Specify name alias\n     */\n    loadGeoJson: function (geoJson, specialAreas, nameMap) {\n        // https://jsperf.com/try-catch-performance-overhead\n        try {\n            this.regions = geoJson ? parseGeoJson$1(geoJson) : [];\n        }\n        catch (e) {\n            throw 'Invalid geoJson format\\n' + e.message;\n        }\n        specialAreas = specialAreas || {};\n        nameMap = nameMap || {};\n        var regions = this.regions;\n        var regionsMap = createHashMap();\n        for (var i = 0; i < regions.length; i++) {\n            var regionName = regions[i].name;\n            // Try use the alias in nameMap\n            regionName = nameMap.hasOwnProperty(regionName) ? nameMap[regionName] : regionName;\n            regions[i].name = regionName;\n\n            regionsMap.set(regionName, regions[i]);\n            // Add geoJson\n            this.addGeoCoord(regionName, regions[i].center);\n\n            // Some area like Alaska in USA map needs to be tansformed\n            // to look better\n            var specialArea = specialAreas[regionName];\n            if (specialArea) {\n                regions[i].transformTo(\n                    specialArea.left, specialArea.top, specialArea.width, specialArea.height\n                );\n            }\n        }\n\n        this._regionsMap = regionsMap;\n\n        this._rect = null;\n\n        each$1(geoFixFuncs, function (fixFunc) {\n            fixFunc(this);\n        }, this);\n    },\n\n    // Overwrite\n    transformTo: function (x, y, width, height) {\n        var rect = this.getBoundingRect();\n\n        rect = rect.clone();\n        // Longitute is inverted\n        rect.y = -rect.y - rect.height;\n\n        var rawTransformable = this._rawTransformable;\n\n        rawTransformable.transform = rect.calculateTransform(\n            new BoundingRect(x, y, width, height)\n        );\n\n        rawTransformable.decomposeTransform();\n\n        var scale = rawTransformable.scale;\n        scale[1] = -scale[1];\n\n        rawTransformable.updateTransform();\n\n        this._updateTransform();\n    },\n\n    /**\n     * @param {string} name\n     * @return {module:echarts/coord/geo/Region}\n     */\n    getRegion: function (name) {\n        return this._regionsMap.get(name);\n    },\n\n    getRegionByCoord: function (coord) {\n        var regions = this.regions;\n        for (var i = 0; i < regions.length; i++) {\n            if (regions[i].contain(coord)) {\n                return regions[i];\n            }\n        }\n    },\n\n    /**\n     * Add geoCoord for indexing by name\n     * @param {string} name\n     * @param {Array.<number>} geoCoord\n     */\n    addGeoCoord: function (name, geoCoord) {\n        this._nameCoordMap.set(name, geoCoord);\n    },\n\n    /**\n     * Get geoCoord by name\n     * @param {string} name\n     * @return {Array.<number>}\n     */\n    getGeoCoord: function (name) {\n        return this._nameCoordMap.get(name);\n    },\n\n    // Overwrite\n    getBoundingRect: function () {\n        if (this._rect) {\n            return this._rect;\n        }\n        var rect;\n\n        var regions = this.regions;\n        for (var i = 0; i < regions.length; i++) {\n            var regionRect = regions[i].getBoundingRect();\n            rect = rect || regionRect.clone();\n            rect.union(regionRect);\n        }\n        // FIXME Always return new ?\n        return (this._rect = rect || new BoundingRect(0, 0, 0, 0));\n    },\n\n    /**\n     * @param {string|Array.<number>} data\n     * @param {boolean} noRoam\n     * @param {Array.<number>} [out]\n     * @return {Array.<number>}\n     */\n    dataToPoint: function (data, noRoam, out) {\n        if (typeof data === 'string') {\n            // Map area name to geoCoord\n            data = this.getGeoCoord(data);\n        }\n        if (data) {\n            return View.prototype.dataToPoint.call(this, data, noRoam, out);\n        }\n    },\n\n    /**\n     * @inheritDoc\n     */\n    convertToPixel: curry(doConvert, 'dataToPoint'),\n\n    /**\n     * @inheritDoc\n     */\n    convertFromPixel: curry(doConvert, 'pointToData')\n\n};\n\nmixin(Geo, View);\n\nfunction doConvert(methodName, ecModel, finder, value) {\n    var geoModel = finder.geoModel;\n    var seriesModel = finder.seriesModel;\n\n    var coordSys = geoModel\n        ? geoModel.coordinateSystem\n        : seriesModel\n        ? (\n            seriesModel.coordinateSystem // For map.\n            || (seriesModel.getReferringComponents('geo')[0] || {}).coordinateSystem\n        )\n        : null;\n\n    return coordSys === this ? coordSys[methodName](value) : null;\n}\n\n/**\n * Resize method bound to the geo\n * @param {module:echarts/coord/geo/GeoModel|module:echarts/chart/map/MapModel} geoModel\n * @param {module:echarts/ExtensionAPI} api\n */\nfunction resizeGeo(geoModel, api) {\n\n    var boundingCoords = geoModel.get('boundingCoords');\n    if (boundingCoords != null) {\n        var leftTop = boundingCoords[0];\n        var rightBottom = boundingCoords[1];\n        if (isNaN(leftTop[0]) || isNaN(leftTop[1]) || isNaN(rightBottom[0]) || isNaN(rightBottom[1])) {\n            if (__DEV__) {\n                console.error('Invalid boundingCoords');\n            }\n        }\n        else {\n            this.setBoundingRect(leftTop[0], leftTop[1], rightBottom[0] - leftTop[0], rightBottom[1] - leftTop[1]);\n        }\n    }\n\n    var rect = this.getBoundingRect();\n\n    var boxLayoutOption;\n\n    var center = geoModel.get('layoutCenter');\n    var size = geoModel.get('layoutSize');\n\n    var viewWidth = api.getWidth();\n    var viewHeight = api.getHeight();\n\n    var aspectScale = geoModel.get('aspectScale') || 0.75;\n    var aspect = rect.width / rect.height * aspectScale;\n\n    var useCenterAndSize = false;\n\n    if (center && size) {\n        center = [\n            parsePercent$1(center[0], viewWidth),\n            parsePercent$1(center[1], viewHeight)\n        ];\n        size = parsePercent$1(size, Math.min(viewWidth, viewHeight));\n\n        if (!isNaN(center[0]) && !isNaN(center[1]) && !isNaN(size)) {\n            useCenterAndSize = true;\n        }\n        else {\n            if (__DEV__) {\n                console.warn('Given layoutCenter or layoutSize data are invalid. Use left/top/width/height instead.');\n            }\n        }\n    }\n\n    var viewRect;\n    if (useCenterAndSize) {\n        var viewRect = {};\n        if (aspect > 1) {\n            // Width is same with size\n            viewRect.width = size;\n            viewRect.height = size / aspect;\n        }\n        else {\n            viewRect.height = size;\n            viewRect.width = size * aspect;\n        }\n        viewRect.y = center[1] - viewRect.height / 2;\n        viewRect.x = center[0] - viewRect.width / 2;\n    }\n    else {\n        // Use left/top/width/height\n        boxLayoutOption = geoModel.getBoxLayoutParams();\n\n        // 0.75 rate\n        boxLayoutOption.aspect = aspect;\n\n        viewRect = getLayoutRect(boxLayoutOption, {\n            width: viewWidth,\n            height: viewHeight\n        });\n    }\n\n    this.setViewRect(viewRect.x, viewRect.y, viewRect.width, viewRect.height);\n\n    this.setCenter(geoModel.get('center'));\n    this.setZoom(geoModel.get('zoom'));\n}\n\n/**\n * @param {module:echarts/coord/Geo} geo\n * @param {module:echarts/model/Model} model\n * @inner\n */\nfunction setGeoCoords(geo, model) {\n    each$1(model.get('geoCoord'), function (geoCoord, name) {\n        geo.addGeoCoord(name, geoCoord);\n    });\n}\n\nif (__DEV__) {\n    var mapNotExistsError = function (name) {\n        console.error('Map ' + name + ' not exists. You can download map file on http://echarts.baidu.com/download-map.html');\n    };\n}\n\nvar geoCreator = {\n\n    // For deciding which dimensions to use when creating list data\n    dimensions: Geo.prototype.dimensions,\n\n    create: function (ecModel, api) {\n        var geoList = [];\n\n        // FIXME Create each time may be slow\n        ecModel.eachComponent('geo', function (geoModel, idx) {\n            var name = geoModel.get('map');\n            var mapData = getMap(name);\n            if (__DEV__) {\n                if (!mapData) {\n                    mapNotExistsError(name);\n                }\n            }\n            var geo = new Geo(\n                name + idx, name,\n                mapData && mapData.geoJson, mapData && mapData.specialAreas,\n                geoModel.get('nameMap')\n            );\n            geo.zoomLimit = geoModel.get('scaleLimit');\n            geoList.push(geo);\n\n            setGeoCoords(geo, geoModel);\n\n            geoModel.coordinateSystem = geo;\n            geo.model = geoModel;\n\n            // Inject resize method\n            geo.resize = resizeGeo;\n\n            geo.resize(geoModel, api);\n        });\n\n        ecModel.eachSeries(function (seriesModel) {\n            var coordSys = seriesModel.get('coordinateSystem');\n            if (coordSys === 'geo') {\n                var geoIndex = seriesModel.get('geoIndex') || 0;\n                seriesModel.coordinateSystem = geoList[geoIndex];\n            }\n        });\n\n        // If has map series\n        var mapModelGroupBySeries = {};\n\n        ecModel.eachSeriesByType('map', function (seriesModel) {\n            if (!seriesModel.getHostGeoModel()) {\n                var mapType = seriesModel.getMapType();\n                mapModelGroupBySeries[mapType] = mapModelGroupBySeries[mapType] || [];\n                mapModelGroupBySeries[mapType].push(seriesModel);\n            }\n        });\n\n        each$1(mapModelGroupBySeries, function (mapSeries, mapType) {\n            var mapData = getMap(mapType);\n            if (__DEV__) {\n                if (!mapData) {\n                    mapNotExistsError(mapSeries[0].get('map'));\n                }\n            }\n\n            var nameMapList = map(mapSeries, function (singleMapSeries) {\n                return singleMapSeries.get('nameMap');\n            });\n            var geo = new Geo(\n                mapType, mapType,\n                mapData && mapData.geoJson, mapData && mapData.specialAreas,\n                mergeAll(nameMapList)\n            );\n            geo.zoomLimit = retrieve.apply(null, map(mapSeries, function (singleMapSeries) {\n                return singleMapSeries.get('scaleLimit');\n            }));\n            geoList.push(geo);\n\n            // Inject resize method\n            geo.resize = resizeGeo;\n\n            geo.resize(mapSeries[0], api);\n\n            each$1(mapSeries, function (singleMapSeries) {\n                singleMapSeries.coordinateSystem = geo;\n\n                setGeoCoords(geo, singleMapSeries);\n            });\n        });\n\n        return geoList;\n    },\n\n    /**\n     * Fill given regions array\n     * @param  {Array.<Object>} originRegionArr\n     * @param  {string} mapName\n     * @param  {Object} [nameMap]\n     * @return {Array}\n     */\n    getFilledRegions: function (originRegionArr, mapName, nameMap) {\n        // Not use the original\n        var regionsArr = (originRegionArr || []).slice();\n        nameMap = nameMap || {};\n\n        var map$$1 = getMap(mapName);\n        var geoJson = map$$1 && map$$1.geoJson;\n        if (!geoJson) {\n            if (__DEV__) {\n                mapNotExistsError(mapName);\n            }\n            return originRegionArr;\n        }\n\n        var dataNameMap = createHashMap();\n        var features = geoJson.features;\n        for (var i = 0; i < regionsArr.length; i++) {\n            dataNameMap.set(regionsArr[i].name, regionsArr[i]);\n        }\n\n        for (var i = 0; i < features.length; i++) {\n            var name = features[i].properties.name;\n            if (!dataNameMap.get(name)) {\n                if (nameMap.hasOwnProperty(name)) {\n                    name = nameMap[name];\n                }\n                regionsArr.push({\n                    name: name\n                });\n            }\n        }\n        return regionsArr;\n    }\n};\n\nregisterCoordinateSystem('geo', geoCreator);\n\nvar MapSeries = SeriesModel.extend({\n\n    type: 'series.map',\n\n    dependencies: ['geo'],\n\n    layoutMode: 'box',\n\n    /**\n     * Only first map series of same mapType will drawMap\n     * @type {boolean}\n     */\n    needsDrawMap: false,\n\n    /**\n     * Group of all map series with same mapType\n     * @type {boolean}\n     */\n    seriesGroup: [],\n\n    init: function (option) {\n\n        // this._fillOption(option, this.getMapType());\n        // this.option = option;\n\n        MapSeries.superApply(this, 'init', arguments);\n\n        this.updateSelectedMap(this._createSelectableList());\n    },\n\n    getInitialData: function (option) {\n        return createListSimply(this, ['value']);\n    },\n\n    mergeOption: function (newOption) {\n        // this._fillOption(newOption, this.getMapType());\n\n        MapSeries.superApply(this, 'mergeOption', arguments);\n\n        this.updateSelectedMap(this._createSelectableList());\n    },\n\n    _createSelectableList: function () {\n        var data = this.getRawData();\n        var valueDim = data.mapDimension('value');\n        var targetList = [];\n        for (var i = 0, len = data.count(); i < len; i++) {\n            targetList.push({\n                name: data.getName(i),\n                value: data.get(valueDim, i),\n                selected: retrieveRawAttr(data, i, 'selected')\n            });\n        }\n\n        targetList = geoCreator.getFilledRegions(targetList, this.getMapType(), this.option.nameMap);\n\n        return targetList;\n    },\n\n    /**\n     * If no host geo model, return null, which means using a\n     * inner exclusive geo model.\n     */\n    getHostGeoModel: function () {\n        var geoIndex = this.option.geoIndex;\n        return geoIndex != null\n            ? this.dependentModels.geo[geoIndex]\n            : null;\n    },\n\n    getMapType: function () {\n        return (this.getHostGeoModel() || this).option.map;\n    },\n\n    _fillOption: function (option, mapName) {\n        // Shallow clone\n        // option = zrUtil.extend({}, option);\n\n        // option.data = geoCreator.getFilledRegions(option.data, mapName, option.nameMap);\n\n        // return option;\n    },\n\n    getRawValue: function (dataIndex) {\n        // Use value stored in data instead because it is calculated from multiple series\n        // FIXME Provide all value of multiple series ?\n        var data = this.getData();\n        return data.get(data.mapDimension('value'), dataIndex);\n    },\n\n    /**\n     * Get model of region\n     * @param  {string} name\n     * @return {module:echarts/model/Model}\n     */\n    getRegionModel: function (regionName) {\n        var data = this.getData();\n        return data.getItemModel(data.indexOfName(regionName));\n    },\n\n    /**\n     * Map tooltip formatter\n     *\n     * @param {number} dataIndex\n     */\n    formatTooltip: function (dataIndex) {\n        // FIXME orignalData and data is a bit confusing\n        var data = this.getData();\n        var formattedValue = addCommas(this.getRawValue(dataIndex));\n        var name = data.getName(dataIndex);\n\n        var seriesGroup = this.seriesGroup;\n        var seriesNames = [];\n        for (var i = 0; i < seriesGroup.length; i++) {\n            var otherIndex = seriesGroup[i].originalData.indexOfName(name);\n            var valueDim = data.mapDimension('value');\n            if (!isNaN(seriesGroup[i].originalData.get(valueDim, otherIndex))) {\n                seriesNames.push(\n                    encodeHTML(seriesGroup[i].name)\n                );\n            }\n        }\n\n        return seriesNames.join(', ') + '<br />'\n            + encodeHTML(name + ' : ' + formattedValue);\n    },\n\n    /**\n     * @implement\n     */\n    getTooltipPosition: function (dataIndex) {\n        if (dataIndex != null) {\n            var name = this.getData().getName(dataIndex);\n            var geo = this.coordinateSystem;\n            var region = geo.getRegion(name);\n\n            return region && geo.dataToPoint(region.center);\n        }\n    },\n\n    setZoom: function (zoom) {\n        this.option.zoom = zoom;\n    },\n\n    setCenter: function (center) {\n        this.option.center = center;\n    },\n\n    defaultOption: {\n        // \n        zlevel: 0,\n        // \n        z: 2,\n\n        coordinateSystem: 'geo',\n\n        // map should be explicitly specified since ec3.\n        map: '',\n\n        // If `geoIndex` is not specified, a exclusive geo will be\n        // created. Otherwise use the specified geo component, and\n        // `map` and `mapType` are ignored.\n        // geoIndex: 0,\n\n        // 'center' | 'left' | 'right' | 'x%' | {number}\n        left: 'center',\n        // 'center' | 'top' | 'bottom' | 'x%' | {number}\n        top: 'center',\n        // right\n        // bottom\n        // width:\n        // height\n\n        // Aspect is width / height. Inited to be geoJson bbox aspect\n        // This parameter is used for scale this aspect\n        aspectScale: 0.75,\n\n        ///// Layout with center and size\n        // If you wan't to put map in a fixed size box with right aspect ratio\n        // This two properties may more conveninet\n        // layoutCenter: [50%, 50%]\n        // layoutSize: 100\n\n\n        // \n        // 'sum' | 'average' | 'max' | 'min'\n        // mapValueCalculation: 'sum',\n        // \n        // mapValuePrecision: 0,\n\n\n        // \n        showLegendSymbol: true,\n        // singlemultiple\n        // selectedMode: false,\n        dataRangeHoverLink: true,\n        // \n        // roam: false,\n\n        // Define left-top, right-bottom coords to control view\n        // For example, [ [180, 90], [-180, -90] ],\n        // higher priority than center and zoom\n        boundingCoords: null,\n\n        // Default on center of map\n        center: null,\n\n        zoom: 1,\n\n        scaleLimit: null,\n\n        label: {\n            show: false,\n            color: '#000'\n        },\n        // scaleLimit: null,\n        itemStyle: {\n            borderWidth: 0.5,\n            borderColor: '#444',\n            areaColor: '#eee'\n        },\n\n        emphasis: {\n            label: {\n                show: true,\n                color: 'rgb(100,0,0)'\n            },\n            itemStyle: {\n                areaColor: 'rgba(255,215,0,0.8)'\n            }\n        }\n    }\n\n});\n\nmixin(MapSeries, selectableMixin);\n\nvar ATTR = '\\0_ec_interaction_mutex';\n\nfunction take(zr, resourceKey, userKey) {\n    var store = getStore(zr);\n    store[resourceKey] = userKey;\n}\n\nfunction release(zr, resourceKey, userKey) {\n    var store = getStore(zr);\n    var uKey = store[resourceKey];\n\n    if (uKey === userKey) {\n        store[resourceKey] = null;\n    }\n}\n\nfunction isTaken(zr, resourceKey) {\n    return !!getStore(zr)[resourceKey];\n}\n\nfunction getStore(zr) {\n    return zr[ATTR] || (zr[ATTR] = {});\n}\n\n/**\n * payload: {\n *     type: 'takeGlobalCursor',\n *     key: 'dataZoomSelect', or 'brush', or ...,\n *         If no userKey, release global cursor.\n * }\n */\nregisterAction(\n    {type: 'takeGlobalCursor', event: 'globalCursorTaken', update: 'update'},\n    function () {}\n);\n\n/**\n * @alias module:echarts/component/helper/RoamController\n * @constructor\n * @mixin {module:zrender/mixin/Eventful}\n *\n * @param {module:zrender/zrender~ZRender} zr\n */\nfunction RoamController(zr) {\n\n    /**\n     * @type {Function}\n     */\n    this.pointerChecker;\n\n    /**\n     * @type {module:zrender}\n     */\n    this._zr = zr;\n\n    /**\n     * @type {Object}\n     */\n    this._opt = {};\n\n    // Avoid two roamController bind the same handler\n    var bind$$1 = bind;\n    var mousedownHandler = bind$$1(mousedown, this);\n    var mousemoveHandler = bind$$1(mousemove, this);\n    var mouseupHandler = bind$$1(mouseup, this);\n    var mousewheelHandler = bind$$1(mousewheel, this);\n    var pinchHandler = bind$$1(pinch, this);\n\n    Eventful.call(this);\n\n    /**\n     * @param {Function} pointerChecker\n     *                   input: x, y\n     *                   output: boolean\n     */\n    this.setPointerChecker = function (pointerChecker) {\n        this.pointerChecker = pointerChecker;\n    };\n\n    /**\n     * Notice: only enable needed types. For example, if 'zoom'\n     * is not needed, 'zoom' should not be enabled, otherwise\n     * default mousewheel behaviour (scroll page) will be disabled.\n     *\n     * @param  {boolean|string} [controlType=true] Specify the control type,\n     *                          which can be null/undefined or true/false\n     *                          or 'pan/move' or 'zoom'/'scale'\n     * @param {Object} [opt]\n     * @param {Object} [opt.zoomOnMouseWheel=true]\n     * @param {Object} [opt.moveOnMouseMove=true]\n     * @param {Object} [opt.preventDefaultMouseMove=true] When pan.\n     */\n    this.enable = function (controlType, opt) {\n\n        // Disable previous first\n        this.disable();\n\n        this._opt = defaults(clone(opt) || {}, {\n            zoomOnMouseWheel: true,\n            moveOnMouseMove: true,\n            preventDefaultMouseMove: true\n        });\n\n        if (controlType == null) {\n            controlType = true;\n        }\n\n        if (controlType === true || (controlType === 'move' || controlType === 'pan')) {\n            zr.on('mousedown', mousedownHandler);\n            zr.on('mousemove', mousemoveHandler);\n            zr.on('mouseup', mouseupHandler);\n        }\n        if (controlType === true || (controlType === 'scale' || controlType === 'zoom')) {\n            zr.on('mousewheel', mousewheelHandler);\n            zr.on('pinch', pinchHandler);\n        }\n    };\n\n    this.disable = function () {\n        zr.off('mousedown', mousedownHandler);\n        zr.off('mousemove', mousemoveHandler);\n        zr.off('mouseup', mouseupHandler);\n        zr.off('mousewheel', mousewheelHandler);\n        zr.off('pinch', pinchHandler);\n    };\n\n    this.dispose = this.disable;\n\n    this.isDragging = function () {\n        return this._dragging;\n    };\n\n    this.isPinching = function () {\n        return this._pinching;\n    };\n}\n\nmixin(RoamController, Eventful);\n\n\nfunction mousedown(e) {\n    if (notLeftMouse(e)\n        || (e.target && e.target.draggable)\n    ) {\n        return;\n    }\n\n    var x = e.offsetX;\n    var y = e.offsetY;\n\n    // Only check on mosedown, but not mousemove.\n    // Mouse can be out of target when mouse moving.\n    if (this.pointerChecker && this.pointerChecker(e, x, y)) {\n        this._x = x;\n        this._y = y;\n        this._dragging = true;\n    }\n}\n\nfunction mousemove(e) {\n    if (notLeftMouse(e)\n        || !checkKeyBinding(this, 'moveOnMouseMove', e)\n        || !this._dragging\n        || e.gestureEvent === 'pinch'\n        || isTaken(this._zr, 'globalPan')\n    ) {\n        return;\n    }\n\n    var x = e.offsetX;\n    var y = e.offsetY;\n\n    var oldX = this._x;\n    var oldY = this._y;\n\n    var dx = x - oldX;\n    var dy = y - oldY;\n\n    this._x = x;\n    this._y = y;\n\n    this._opt.preventDefaultMouseMove && stop(e.event);\n\n    this.trigger('pan', dx, dy, oldX, oldY, x, y);\n}\n\nfunction mouseup(e) {\n    if (!notLeftMouse(e)) {\n        this._dragging = false;\n    }\n}\n\nfunction mousewheel(e) {\n    // wheelDelta maybe -0 in chrome mac.\n    if (!checkKeyBinding(this, 'zoomOnMouseWheel', e) || e.wheelDelta === 0) {\n        return;\n    }\n\n    // Convenience:\n    // Mac and VM Windows on Mac: scroll up: zoom out.\n    // Windows: scroll up: zoom in.\n    var zoomDelta = e.wheelDelta > 0 ? 1.1 : 1 / 1.1;\n    zoom.call(this, e, zoomDelta, e.offsetX, e.offsetY);\n}\n\nfunction pinch(e) {\n    if (isTaken(this._zr, 'globalPan')) {\n        return;\n    }\n    var zoomDelta = e.pinchScale > 1 ? 1.1 : 1 / 1.1;\n    zoom.call(this, e, zoomDelta, e.pinchX, e.pinchY);\n}\n\nfunction zoom(e, zoomDelta, zoomX, zoomY) {\n    if (this.pointerChecker && this.pointerChecker(e, zoomX, zoomY)) {\n        // When mouse is out of roamController rect,\n        // default befavoius should not be be disabled, otherwise\n        // page sliding is disabled, contrary to expectation.\n        stop(e.event);\n\n        this.trigger('zoom', zoomDelta, zoomX, zoomY);\n    }\n}\n\nfunction checkKeyBinding(roamController, prop, e) {\n    var setting = roamController._opt[prop];\n    return setting\n        && (!isString(setting) || e.event[setting + 'Key']);\n}\n\n/**\n * For geo and graph.\n *\n * @param {Object} controllerHost\n * @param {module:zrender/Element} controllerHost.target\n */\nfunction updateViewOnPan(controllerHost, dx, dy) {\n    var target = controllerHost.target;\n    var pos = target.position;\n    pos[0] += dx;\n    pos[1] += dy;\n    target.dirty();\n}\n\n/**\n * For geo and graph.\n *\n * @param {Object} controllerHost\n * @param {module:zrender/Element} controllerHost.target\n * @param {number} controllerHost.zoom\n * @param {number} controllerHost.zoomLimit like: {min: 1, max: 2}\n */\nfunction updateViewOnZoom(controllerHost, zoomDelta, zoomX, zoomY) {\n    var target = controllerHost.target;\n    var zoomLimit = controllerHost.zoomLimit;\n    var pos = target.position;\n    var scale = target.scale;\n\n    var newZoom = controllerHost.zoom = controllerHost.zoom || 1;\n    newZoom *= zoomDelta;\n    if (zoomLimit) {\n        var zoomMin = zoomLimit.min || 0;\n        var zoomMax = zoomLimit.max || Infinity;\n        newZoom = Math.max(\n            Math.min(zoomMax, newZoom),\n            zoomMin\n        );\n    }\n    var zoomScale = newZoom / controllerHost.zoom;\n    controllerHost.zoom = newZoom;\n    // Keep the mouse center when scaling\n    pos[0] -= (zoomX - pos[0]) * (zoomScale - 1);\n    pos[1] -= (zoomY - pos[1]) * (zoomScale - 1);\n    scale[0] *= zoomScale;\n    scale[1] *= zoomScale;\n\n    target.dirty();\n}\n\nvar IRRELEVANT_EXCLUDES = {'axisPointer': 1, 'tooltip': 1, 'brush': 1};\n\n/**\n * Avoid that: mouse click on a elements that is over geo or graph,\n * but roam is triggered.\n */\nfunction onIrrelevantElement(e, api, targetCoordSysModel) {\n    var model = api.getComponentByElement(e.topTarget);\n    // If model is axisModel, it works only if it is injected with coordinateSystem.\n    var coordSys = model && model.coordinateSystem;\n    return model\n        && model !== targetCoordSysModel\n        && !IRRELEVANT_EXCLUDES[model.mainType]\n        && (coordSys && coordSys.model !== targetCoordSysModel);\n}\n\nfunction getFixedItemStyle(model, scale) {\n    var itemStyle = model.getItemStyle();\n    var areaColor = model.get('areaColor');\n\n    // If user want the color not to be changed when hover,\n    // they should both set areaColor and color to be null.\n    if (areaColor != null) {\n        itemStyle.fill = areaColor;\n    }\n\n    return itemStyle;\n}\n\nfunction updateMapSelectHandler(mapDraw, mapOrGeoModel, group, api, fromView) {\n    group.off('click');\n    group.off('mousedown');\n\n    if (mapOrGeoModel.get('selectedMode')) {\n\n        group.on('mousedown', function () {\n            mapDraw._mouseDownFlag = true;\n        });\n\n        group.on('click', function (e) {\n            if (!mapDraw._mouseDownFlag) {\n                return;\n            }\n            mapDraw._mouseDownFlag = false;\n\n            var el = e.target;\n            while (!el.__regions) {\n                el = el.parent;\n            }\n            if (!el) {\n                return;\n            }\n\n            var action = {\n                type: (mapOrGeoModel.mainType === 'geo' ? 'geo' : 'map') + 'ToggleSelect',\n                batch: map(el.__regions, function (region) {\n                    return {\n                        name: region.name,\n                        from: fromView.uid\n                    };\n                })\n            };\n            action[mapOrGeoModel.mainType + 'Id'] = mapOrGeoModel.id;\n\n            api.dispatchAction(action);\n\n            updateMapSelected(mapOrGeoModel, group);\n        });\n    }\n}\n\nfunction updateMapSelected(mapOrGeoModel, group) {\n    // FIXME\n    group.eachChild(function (otherRegionEl) {\n        each$1(otherRegionEl.__regions, function (region) {\n            otherRegionEl.trigger(mapOrGeoModel.isSelected(region.name) ? 'emphasis' : 'normal');\n        });\n    });\n}\n\n/**\n * @alias module:echarts/component/helper/MapDraw\n * @param {module:echarts/ExtensionAPI} api\n * @param {boolean} updateGroup\n */\nfunction MapDraw(api, updateGroup) {\n\n    var group = new Group();\n\n    /**\n     * @type {module:echarts/component/helper/RoamController}\n     * @private\n     */\n    this._controller = new RoamController(api.getZr());\n\n    /**\n     * @type {Object} {target, zoom, zoomLimit}\n     * @private\n     */\n    this._controllerHost = {target: updateGroup ? group : null};\n\n    /**\n     * @type {module:zrender/container/Group}\n     * @readOnly\n     */\n    this.group = group;\n\n    /**\n     * @type {boolean}\n     * @private\n     */\n    this._updateGroup = updateGroup;\n\n    /**\n     * This flag is used to make sure that only one among\n     * `pan`, `zoom`, `click` can occurs, otherwise 'selected'\n     * action may be triggered when `pan`, which is unexpected.\n     * @type {booelan}\n     */\n    this._mouseDownFlag;\n}\n\nMapDraw.prototype = {\n\n    constructor: MapDraw,\n\n    draw: function (mapOrGeoModel, ecModel, api, fromView, payload) {\n\n        var isGeo = mapOrGeoModel.mainType === 'geo';\n\n        // Map series has data. GEO model that controlled by map series\n        // will be assigned with map data. Other GEO model has no data.\n        var data = mapOrGeoModel.getData && mapOrGeoModel.getData();\n        isGeo && ecModel.eachComponent({mainType: 'series', subType: 'map'}, function (mapSeries) {\n            if (!data && mapSeries.getHostGeoModel() === mapOrGeoModel) {\n                data = mapSeries.getData();\n            }\n        });\n\n        var geo = mapOrGeoModel.coordinateSystem;\n\n        var group = this.group;\n\n        var scale = geo.scale;\n        var groupNewProp = {\n            position: geo.position,\n            scale: scale\n        };\n\n        // No animation when first draw or in action\n        if (!group.childAt(0) || payload) {\n            group.attr(groupNewProp);\n        }\n        else {\n            updateProps(group, groupNewProp, mapOrGeoModel);\n        }\n\n        group.removeAll();\n\n        var itemStyleAccessPath = ['itemStyle'];\n        var hoverItemStyleAccessPath = ['emphasis', 'itemStyle'];\n        var labelAccessPath = ['label'];\n        var hoverLabelAccessPath = ['emphasis', 'label'];\n        var nameMap = createHashMap();\n\n        each$1(geo.regions, function (region) {\n\n            // Consider in GeoJson properties.name may be duplicated, for example,\n            // there is multiple region named \"United Kindom\" or \"France\" (so many\n            // colonies). And it is not appropriate to merge them in geo, which\n            // will make them share the same label and bring trouble in label\n            // location calculation.\n            var regionGroup = nameMap.get(region.name)\n                || nameMap.set(region.name, new Group());\n\n            var compoundPath = new CompoundPath({\n                shape: {\n                    paths: []\n                }\n            });\n            regionGroup.add(compoundPath);\n\n            var regionModel = mapOrGeoModel.getRegionModel(region.name) || mapOrGeoModel;\n\n            var itemStyleModel = regionModel.getModel(itemStyleAccessPath);\n            var hoverItemStyleModel = regionModel.getModel(hoverItemStyleAccessPath);\n            var itemStyle = getFixedItemStyle(itemStyleModel, scale);\n            var hoverItemStyle = getFixedItemStyle(hoverItemStyleModel, scale);\n\n            var labelModel = regionModel.getModel(labelAccessPath);\n            var hoverLabelModel = regionModel.getModel(hoverLabelAccessPath);\n\n            var dataIdx;\n            // Use the itemStyle in data if has data\n            if (data) {\n                dataIdx = data.indexOfName(region.name);\n                // Only visual color of each item will be used. It can be encoded by dataRange\n                // But visual color of series is used in symbol drawing\n                //\n                // Visual color for each series is for the symbol draw\n                var visualColor = data.getItemVisual(dataIdx, 'color', true);\n                if (visualColor) {\n                    itemStyle.fill = visualColor;\n                }\n            }\n\n            each$1(region.geometries, function (geometry) {\n                if (geometry.type !== 'polygon') {\n                    return;\n                }\n                compoundPath.shape.paths.push(new Polygon({\n                    shape: {\n                        points: geometry.exterior\n                    }\n                }));\n\n                for (var i = 0; i < (geometry.interiors ? geometry.interiors.length : 0); i++) {\n                    compoundPath.shape.paths.push(new Polygon({\n                        shape: {\n                            points: geometry.interiors[i]\n                        }\n                    }));\n                }\n            });\n\n            compoundPath.setStyle(itemStyle);\n            compoundPath.style.strokeNoScale = true;\n            compoundPath.culling = true;\n            // Label\n            var showLabel = labelModel.get('show');\n            var hoverShowLabel = hoverLabelModel.get('show');\n\n            var isDataNaN = data && isNaN(data.get(data.mapDimension('value'), dataIdx));\n            var itemLayout = data && data.getItemLayout(dataIdx);\n            // In the following cases label will be drawn\n            // 1. In map series and data value is NaN\n            // 2. In geo component\n            // 4. Region has no series legendSymbol, which will be add a showLabel flag in mapSymbolLayout\n            if (\n                (isGeo || isDataNaN && (showLabel || hoverShowLabel))\n                || (itemLayout && itemLayout.showLabel)\n                ) {\n                var query = !isGeo ? dataIdx : region.name;\n                var labelFetcher;\n\n                // Consider dataIdx not found.\n                if (!data || dataIdx >= 0) {\n                    labelFetcher = mapOrGeoModel;\n                }\n\n                var textEl = new Text({\n                    position: region.center.slice(),\n                    scale: [1 / scale[0], 1 / scale[1]],\n                    z2: 10,\n                    silent: true\n                });\n\n                setLabelStyle(\n                    textEl.style, textEl.hoverStyle = {}, labelModel, hoverLabelModel,\n                    {\n                        labelFetcher: labelFetcher,\n                        labelDataIndex: query,\n                        defaultText: region.name,\n                        useInsideStyle: false\n                    },\n                    {\n                        textAlign: 'center',\n                        textVerticalAlign: 'middle'\n                    }\n                );\n\n                regionGroup.add(textEl);\n            }\n\n            // setItemGraphicEl, setHoverStyle after all polygons and labels\n            // are added to the rigionGroup\n            if (data) {\n                data.setItemGraphicEl(dataIdx, regionGroup);\n            }\n            else {\n                var regionModel = mapOrGeoModel.getRegionModel(region.name);\n                // Package custom mouse event for geo component\n                compoundPath.eventData = {\n                    componentType: 'geo',\n                    geoIndex: mapOrGeoModel.componentIndex,\n                    name: region.name,\n                    region: (regionModel && regionModel.option) || {}\n                };\n            }\n\n            var groupRegions = regionGroup.__regions || (regionGroup.__regions = []);\n            groupRegions.push(region);\n\n            setHoverStyle(\n                regionGroup,\n                hoverItemStyle,\n                {hoverSilentOnTouch: !!mapOrGeoModel.get('selectedMode')}\n            );\n\n            group.add(regionGroup);\n        });\n\n        this._updateController(mapOrGeoModel, ecModel, api);\n\n        updateMapSelectHandler(this, mapOrGeoModel, group, api, fromView);\n\n        updateMapSelected(mapOrGeoModel, group);\n    },\n\n    remove: function () {\n        this.group.removeAll();\n        this._controller.dispose();\n        this._controllerHost = {};\n    },\n\n    _updateController: function (mapOrGeoModel, ecModel, api) {\n        var geo = mapOrGeoModel.coordinateSystem;\n        var controller = this._controller;\n        var controllerHost = this._controllerHost;\n\n        controllerHost.zoomLimit = mapOrGeoModel.get('scaleLimit');\n        controllerHost.zoom = geo.getZoom();\n\n        // roamType is will be set default true if it is null\n        controller.enable(mapOrGeoModel.get('roam') || false);\n        var mainType = mapOrGeoModel.mainType;\n\n        function makeActionBase() {\n            var action = {\n                type: 'geoRoam',\n                componentType: mainType\n            };\n            action[mainType + 'Id'] = mapOrGeoModel.id;\n            return action;\n        }\n\n        controller.off('pan').on('pan', function (dx, dy) {\n            this._mouseDownFlag = false;\n\n            updateViewOnPan(controllerHost, dx, dy);\n\n            api.dispatchAction(extend(makeActionBase(), {\n                dx: dx,\n                dy: dy\n            }));\n        }, this);\n\n        controller.off('zoom').on('zoom', function (zoom, mouseX, mouseY) {\n            this._mouseDownFlag = false;\n\n            updateViewOnZoom(controllerHost, zoom, mouseX, mouseY);\n\n            api.dispatchAction(extend(makeActionBase(), {\n                zoom: zoom,\n                originX: mouseX,\n                originY: mouseY\n            }));\n\n            if (this._updateGroup) {\n                var group = this.group;\n                var scale = group.scale;\n                group.traverse(function (el) {\n                    if (el.type === 'text') {\n                        el.attr('scale', [1 / scale[0], 1 / scale[1]]);\n                    }\n                });\n            }\n        }, this);\n\n        controller.setPointerChecker(function (e, x, y) {\n            return geo.getViewRectAfterRoam().contain(x, y)\n                && !onIrrelevantElement(e, api, mapOrGeoModel);\n        });\n    }\n};\n\nextendChartView({\n\n    type: 'map',\n\n    render: function (mapModel, ecModel, api, payload) {\n        // Not render if it is an toggleSelect action from self\n        if (payload && payload.type === 'mapToggleSelect'\n            && payload.from === this.uid\n        ) {\n            return;\n        }\n\n        var group = this.group;\n        group.removeAll();\n\n        if (mapModel.getHostGeoModel()) {\n            return;\n        }\n\n        // Not update map if it is an roam action from self\n        if (!(payload && payload.type === 'geoRoam'\n                && payload.componentType === 'series'\n                && payload.seriesId === mapModel.id\n            )\n        ) {\n            if (mapModel.needsDrawMap) {\n                var mapDraw = this._mapDraw || new MapDraw(api, true);\n                group.add(mapDraw.group);\n\n                mapDraw.draw(mapModel, ecModel, api, this, payload);\n\n                this._mapDraw = mapDraw;\n            }\n            else {\n                // Remove drawed map\n                this._mapDraw && this._mapDraw.remove();\n                this._mapDraw = null;\n            }\n        }\n        else {\n            var mapDraw = this._mapDraw;\n            mapDraw && group.add(mapDraw.group);\n        }\n\n        mapModel.get('showLegendSymbol') && ecModel.getComponent('legend')\n            && this._renderSymbols(mapModel, ecModel, api);\n    },\n\n    remove: function () {\n        this._mapDraw && this._mapDraw.remove();\n        this._mapDraw = null;\n        this.group.removeAll();\n    },\n\n    dispose: function () {\n        this._mapDraw && this._mapDraw.remove();\n        this._mapDraw = null;\n    },\n\n    _renderSymbols: function (mapModel, ecModel, api) {\n        var originalData = mapModel.originalData;\n        var group = this.group;\n\n        originalData.each(originalData.mapDimension('value'), function (value, idx) {\n            if (isNaN(value)) {\n                return;\n            }\n\n            var layout = originalData.getItemLayout(idx);\n\n            if (!layout || !layout.point) {\n                // Not exists in map\n                return;\n            }\n\n            var point = layout.point;\n            var offset = layout.offset;\n\n            var circle = new Circle({\n                style: {\n                    // Because the special of map draw.\n                    // Which needs statistic of multiple series and draw on one map.\n                    // And each series also need a symbol with legend color\n                    //\n                    // Layout and visual are put one the different data\n                    fill: mapModel.getData().getVisual('color')\n                },\n                shape: {\n                    cx: point[0] + offset * 9,\n                    cy: point[1],\n                    r: 3\n                },\n                silent: true,\n                // Do not overlap the first series, on which labels are displayed.\n                z2: !offset ? 10 : 8\n            });\n\n            // First data on the same region\n            if (!offset) {\n                var fullData = mapModel.mainSeries.getData();\n                var name = originalData.getName(idx);\n\n                var fullIndex = fullData.indexOfName(name);\n\n                var itemModel = originalData.getItemModel(idx);\n                var labelModel = itemModel.getModel('label');\n                var hoverLabelModel = itemModel.getModel('emphasis.label');\n\n                var polygonGroups = fullData.getItemGraphicEl(fullIndex);\n\n                var normalText = retrieve2(\n                    mapModel.getFormattedLabel(idx, 'normal'),\n                    name\n                );\n                var emphasisText = retrieve2(\n                    mapModel.getFormattedLabel(idx, 'emphasis'),\n                    normalText\n                );\n\n                var onEmphasis = function () {\n                    var hoverStyle = setTextStyle({}, hoverLabelModel, {\n                        text: hoverLabelModel.get('show') ? emphasisText : null\n                    }, {isRectText: true, useInsideStyle: false}, true);\n                    circle.style.extendFrom(hoverStyle);\n                    // Make label upper than others if overlaps.\n                    circle.__mapOriginalZ2 = circle.z2;\n                    circle.z2 += 1;\n                };\n\n                var onNormal = function () {\n                    setTextStyle(circle.style, labelModel, {\n                        text: labelModel.get('show') ? normalText : null,\n                        textPosition: labelModel.getShallow('position') || 'bottom'\n                    }, {isRectText: true, useInsideStyle: false});\n\n                    if (circle.__mapOriginalZ2 != null) {\n                        circle.z2 = circle.__mapOriginalZ2;\n                        circle.__mapOriginalZ2 = null;\n                    }\n                };\n\n                polygonGroups.on('mouseover', onEmphasis)\n                    .on('mouseout', onNormal)\n                    .on('emphasis', onEmphasis)\n                    .on('normal', onNormal);\n\n                onNormal();\n            }\n\n            group.add(circle);\n        });\n    }\n});\n\n/**\n * @param {module:echarts/coord/View} view\n * @param {Object} payload\n * @param {Object} [zoomLimit]\n */\nfunction updateCenterAndZoom(\n    view, payload, zoomLimit\n) {\n    var previousZoom = view.getZoom();\n    var center = view.getCenter();\n    var zoom = payload.zoom;\n\n    var point = view.dataToPoint(center);\n\n    if (payload.dx != null && payload.dy != null) {\n        point[0] -= payload.dx;\n        point[1] -= payload.dy;\n\n        var center = view.pointToData(point);\n        view.setCenter(center);\n    }\n    if (zoom != null) {\n        if (zoomLimit) {\n            var zoomMin = zoomLimit.min || 0;\n            var zoomMax = zoomLimit.max || Infinity;\n            zoom = Math.max(\n                Math.min(previousZoom * zoom, zoomMax),\n                zoomMin\n            ) / previousZoom;\n        }\n\n        // Zoom on given point(originX, originY)\n        view.scale[0] *= zoom;\n        view.scale[1] *= zoom;\n        var position = view.position;\n        var fixX = (payload.originX - position[0]) * (zoom - 1);\n        var fixY = (payload.originY - position[1]) * (zoom - 1);\n\n        position[0] -= fixX;\n        position[1] -= fixY;\n\n        view.updateTransform();\n        // Get the new center\n        var center = view.pointToData(point);\n        view.setCenter(center);\n        view.setZoom(zoom * previousZoom);\n    }\n\n    return {\n        center: view.getCenter(),\n        zoom: view.getZoom()\n    };\n}\n\n/**\n * @payload\n * @property {string} [componentType=series]\n * @property {number} [dx]\n * @property {number} [dy]\n * @property {number} [zoom]\n * @property {number} [originX]\n * @property {number} [originY]\n */\nregisterAction({\n    type: 'geoRoam',\n    event: 'geoRoam',\n    update: 'updateTransform'\n}, function (payload, ecModel) {\n    var componentType = payload.componentType || 'series';\n\n    ecModel.eachComponent(\n        { mainType: componentType, query: payload },\n        function (componentModel) {\n            var geo = componentModel.coordinateSystem;\n            if (geo.type !== 'geo') {\n                return;\n            }\n\n            var res = updateCenterAndZoom(\n                geo, payload, componentModel.get('scaleLimit')\n            );\n\n            componentModel.setCenter\n                && componentModel.setCenter(res.center);\n\n            componentModel.setZoom\n                && componentModel.setZoom(res.zoom);\n\n            // All map series with same `map` use the same geo coordinate system\n            // So the center and zoom must be in sync. Include the series not selected by legend\n            if (componentType === 'series') {\n                each$1(componentModel.seriesGroup, function (seriesModel) {\n                    seriesModel.setCenter(res.center);\n                    seriesModel.setZoom(res.zoom);\n                });\n            }\n        }\n    );\n});\n\nvar mapSymbolLayout = function (ecModel) {\n\n    var processedMapType = {};\n\n    ecModel.eachSeriesByType('map', function (mapSeries) {\n        var mapType = mapSeries.getMapType();\n        if (mapSeries.getHostGeoModel() || processedMapType[mapType]) {\n            return;\n        }\n\n        var mapSymbolOffsets = {};\n\n        each$1(mapSeries.seriesGroup, function (subMapSeries) {\n            var geo = subMapSeries.coordinateSystem;\n            var data = subMapSeries.originalData;\n            if (subMapSeries.get('showLegendSymbol') && ecModel.getComponent('legend')) {\n                data.each(data.mapDimension('value'), function (value, idx) {\n                    var name = data.getName(idx);\n                    var region = geo.getRegion(name);\n\n                    // If input series.data is [11, 22, '-'/null/undefined, 44],\n                    // it will be filled with NaN: [11, 22, NaN, 44] and NaN will\n                    // not be drawn. So here must validate if value is NaN.\n                    if (!region || isNaN(value)) {\n                        return;\n                    }\n\n                    var offset = mapSymbolOffsets[name] || 0;\n\n                    var point = geo.dataToPoint(region.center);\n\n                    mapSymbolOffsets[name] = offset + 1;\n\n                    data.setItemLayout(idx, {\n                        point: point,\n                        offset: offset\n                    });\n                });\n            }\n        });\n\n        // Show label of those region not has legendSymbol(which is offset 0)\n        var data = mapSeries.getData();\n        data.each(function (idx) {\n            var name = data.getName(idx);\n            var layout = data.getItemLayout(idx) || {};\n            layout.showLabel = !mapSymbolOffsets[name];\n            data.setItemLayout(idx, layout);\n        });\n\n        processedMapType[mapType] = true;\n    });\n};\n\nvar mapVisual = function (ecModel) {\n    ecModel.eachSeriesByType('map', function (seriesModel) {\n        var colorList = seriesModel.get('color');\n        var itemStyleModel = seriesModel.getModel('itemStyle');\n\n        var areaColor = itemStyleModel.get('areaColor');\n        var color = itemStyleModel.get('color')\n            || colorList[seriesModel.seriesIndex % colorList.length];\n\n        seriesModel.getData().setVisual({\n            'areaColor': areaColor,\n            'color': color\n        });\n    });\n};\n\n// FIXME \n/**\n * @param {Array.<module:echarts/data/List>} datas\n * @param {string} statisticType 'average' 'sum'\n * @inner\n */\nfunction dataStatistics(datas, statisticType) {\n    var dataNameMap = {};\n\n    each$1(datas, function (data) {\n        data.each(data.mapDimension('value'), function (value, idx) {\n            // Add prefix to avoid conflict with Object.prototype.\n            var mapKey = 'ec-' + data.getName(idx);\n            dataNameMap[mapKey] = dataNameMap[mapKey] || [];\n            if (!isNaN(value)) {\n                dataNameMap[mapKey].push(value);\n            }\n        });\n    });\n\n    return datas[0].map(datas[0].mapDimension('value'), function (value, idx) {\n        var mapKey = 'ec-' + datas[0].getName(idx);\n        var sum = 0;\n        var min = Infinity;\n        var max = -Infinity;\n        var len = dataNameMap[mapKey].length;\n        for (var i = 0; i < len; i++) {\n            min = Math.min(min, dataNameMap[mapKey][i]);\n            max = Math.max(max, dataNameMap[mapKey][i]);\n            sum += dataNameMap[mapKey][i];\n        }\n        var result;\n        if (statisticType === 'min') {\n            result = min;\n        }\n        else if (statisticType === 'max') {\n            result = max;\n        }\n        else if (statisticType === 'average') {\n            result = sum / len;\n        }\n        else {\n            result = sum;\n        }\n        return len === 0 ? NaN : result;\n    });\n}\n\nvar mapDataStatistic = function (ecModel) {\n    var seriesGroups = {};\n    ecModel.eachSeriesByType('map', function (seriesModel) {\n        var hostGeoModel = seriesModel.getHostGeoModel();\n        var key = hostGeoModel ? 'o' + hostGeoModel.id : 'i' + seriesModel.getMapType();\n        (seriesGroups[key] = seriesGroups[key] || []).push(seriesModel);\n    });\n\n    each$1(seriesGroups, function (seriesList, key) {\n        var data = dataStatistics(\n            map(seriesList, function (seriesModel) {\n                return seriesModel.getData();\n            }),\n            seriesList[0].get('mapValueCalculation')\n        );\n\n        for (var i = 0; i < seriesList.length; i++) {\n            seriesList[i].originalData = seriesList[i].getData();\n        }\n\n        // FIXME Put where?\n        for (var i = 0; i < seriesList.length; i++) {\n            seriesList[i].seriesGroup = seriesList;\n            seriesList[i].needsDrawMap = i === 0 && !seriesList[i].getHostGeoModel();\n\n            seriesList[i].setData(data.cloneShallow());\n            seriesList[i].mainSeries = seriesList[0];\n        }\n    });\n};\n\nvar backwardCompat$2 = function (option) {\n    // Save geoCoord\n    var mapSeries = [];\n    each$1(option.series, function (seriesOpt) {\n        if (seriesOpt && seriesOpt.type === 'map') {\n            mapSeries.push(seriesOpt);\n            seriesOpt.map = seriesOpt.map || seriesOpt.mapType;\n            // Put x, y, width, height, x2, y2 in the top level\n            defaults(seriesOpt, seriesOpt.mapLocation);\n        }\n    });\n};\n\nregisterLayout(mapSymbolLayout);\nregisterVisual(mapVisual);\nregisterProcessor(PRIORITY.PROCESSOR.STATISTIC, mapDataStatistic);\nregisterPreprocessor(backwardCompat$2);\n\ncreateDataSelectAction('map', [{\n    type: 'mapToggleSelect',\n    event: 'mapselectchanged',\n    method: 'toggleSelected'\n}, {\n    type: 'mapSelect',\n    event: 'mapselected',\n    method: 'select'\n}, {\n    type: 'mapUnSelect',\n    event: 'mapunselected',\n    method: 'unSelect'\n}]);\n\n/**\n * Link lists and struct (graph or tree)\n */\n\nvar each$8 = each$1;\n\nvar DATAS = '\\0__link_datas';\nvar MAIN_DATA = '\\0__link_mainData';\n\n// Caution:\n// In most case, either list or its shallow clones (see list.cloneShallow)\n// is active in echarts process. So considering heap memory consumption,\n// we do not clone tree or graph, but share them among list and its shallow clones.\n// But in some rare case, we have to keep old list (like do animation in chart). So\n// please take care that both the old list and the new list share the same tree/graph.\n\n/**\n * @param {Object} opt\n * @param {module:echarts/data/List} opt.mainData\n * @param {Object} [opt.struct] For example, instance of Graph or Tree.\n * @param {string} [opt.structAttr] designation: list[structAttr] = struct;\n * @param {Object} [opt.datas] {dataType: data},\n *                 like: {node: nodeList, edge: edgeList}.\n *                 Should contain mainData.\n * @param {Object} [opt.datasAttr] {dataType: attr},\n *                 designation: struct[datasAttr[dataType]] = list;\n */\nfunction linkList(opt) {\n    var mainData = opt.mainData;\n    var datas = opt.datas;\n\n    if (!datas) {\n        datas = {main: mainData};\n        opt.datasAttr = {main: 'data'};\n    }\n    opt.datas = opt.mainData = null;\n\n    linkAll(mainData, datas, opt);\n\n    // Porxy data original methods.\n    each$8(datas, function (data) {\n        each$8(mainData.TRANSFERABLE_METHODS, function (methodName) {\n            data.wrapMethod(methodName, curry(transferInjection, opt));\n        });\n\n    });\n\n    // Beyond transfer, additional features should be added to `cloneShallow`.\n    mainData.wrapMethod('cloneShallow', curry(cloneShallowInjection, opt));\n\n    // Only mainData trigger change, because struct.update may trigger\n    // another changable methods, which may bring about dead lock.\n    each$8(mainData.CHANGABLE_METHODS, function (methodName) {\n        mainData.wrapMethod(methodName, curry(changeInjection, opt));\n    });\n\n    // Make sure datas contains mainData.\n    assert$1(datas[mainData.dataType] === mainData);\n}\n\nfunction transferInjection(opt, res) {\n    if (isMainData(this)) {\n        // Transfer datas to new main data.\n        var datas = extend({}, this[DATAS]);\n        datas[this.dataType] = res;\n        linkAll(res, datas, opt);\n    }\n    else {\n        // Modify the reference in main data to point newData.\n        linkSingle(res, this.dataType, this[MAIN_DATA], opt);\n    }\n    return res;\n}\n\nfunction changeInjection(opt, res) {\n    opt.struct && opt.struct.update(this);\n    return res;\n}\n\nfunction cloneShallowInjection(opt, res) {\n    // cloneShallow, which brings about some fragilities, may be inappropriate\n    // to be exposed as an API. So for implementation simplicity we can make\n    // the restriction that cloneShallow of not-mainData should not be invoked\n    // outside, but only be invoked here.\n    each$8(res[DATAS], function (data, dataType) {\n        data !== res && linkSingle(data.cloneShallow(), dataType, res, opt);\n    });\n    return res;\n}\n\n/**\n * Supplement method to List.\n *\n * @public\n * @param {string} [dataType] If not specified, return mainData.\n * @return {module:echarts/data/List}\n */\nfunction getLinkedData(dataType) {\n    var mainData = this[MAIN_DATA];\n    return (dataType == null || mainData == null)\n        ? mainData\n        : mainData[DATAS][dataType];\n}\n\nfunction isMainData(data) {\n    return data[MAIN_DATA] === data;\n}\n\nfunction linkAll(mainData, datas, opt) {\n    mainData[DATAS] = {};\n    each$8(datas, function (data, dataType) {\n        linkSingle(data, dataType, mainData, opt);\n    });\n}\n\nfunction linkSingle(data, dataType, mainData, opt) {\n    mainData[DATAS][dataType] = data;\n    data[MAIN_DATA] = mainData;\n    data.dataType = dataType;\n\n    if (opt.struct) {\n        data[opt.structAttr] = opt.struct;\n        opt.struct[opt.datasAttr[dataType]] = data;\n    }\n\n    // Supplement method.\n    data.getLinkedData = getLinkedData;\n}\n\n/**\n * Tree data structure\n *\n * @module echarts/data/Tree\n */\n\n/**\n * @constructor module:echarts/data/Tree~TreeNode\n * @param {string} name\n * @param {module:echarts/data/Tree} hostTree\n */\nvar TreeNode = function (name, hostTree) {\n    /**\n     * @type {string}\n     */\n    this.name = name || '';\n\n    /**\n     * Depth of node\n     *\n     * @type {number}\n     * @readOnly\n     */\n    this.depth = 0;\n\n    /**\n     * Height of the subtree rooted at this node.\n     * @type {number}\n     * @readOnly\n     */\n    this.height = 0;\n\n    /**\n     * @type {module:echarts/data/Tree~TreeNode}\n     * @readOnly\n     */\n    this.parentNode = null;\n\n    /**\n     * Reference to list item.\n     * Do not persistent dataIndex outside,\n     * besause it may be changed by list.\n     * If dataIndex -1,\n     * this node is logical deleted (filtered) in list.\n     *\n     * @type {Object}\n     * @readOnly\n     */\n    this.dataIndex = -1;\n\n    /**\n     * @type {Array.<module:echarts/data/Tree~TreeNode>}\n     * @readOnly\n     */\n    this.children = [];\n\n    /**\n     * @type {Array.<module:echarts/data/Tree~TreeNode>}\n     * @pubilc\n     */\n    this.viewChildren = [];\n\n    /**\n     * @type {moduel:echarts/data/Tree}\n     * @readOnly\n     */\n    this.hostTree = hostTree;\n};\n\nTreeNode.prototype = {\n\n    constructor: TreeNode,\n\n    /**\n     * The node is removed.\n     * @return {boolean} is removed.\n     */\n    isRemoved: function () {\n        return this.dataIndex < 0;\n    },\n\n    /**\n     * Travel this subtree (include this node).\n     * Usage:\n     *    node.eachNode(function () { ... }); // preorder\n     *    node.eachNode('preorder', function () { ... }); // preorder\n     *    node.eachNode('postorder', function () { ... }); // postorder\n     *    node.eachNode(\n     *        {order: 'postorder', attr: 'viewChildren'},\n     *        function () { ... }\n     *    ); // postorder\n     *\n     * @param {(Object|string)} options If string, means order.\n     * @param {string=} options.order 'preorder' or 'postorder'\n     * @param {string=} options.attr 'children' or 'viewChildren'\n     * @param {Function} cb If in preorder and return false,\n     *                      its subtree will not be visited.\n     * @param {Object} [context]\n     */\n    eachNode: function (options, cb, context) {\n        if (typeof options === 'function') {\n            context = cb;\n            cb = options;\n            options = null;\n        }\n\n        options = options || {};\n        if (isString(options)) {\n            options = {order: options};\n        }\n\n        var order = options.order || 'preorder';\n        var children = this[options.attr || 'children'];\n\n        var suppressVisitSub;\n        order === 'preorder' && (suppressVisitSub = cb.call(context, this));\n\n        for (var i = 0; !suppressVisitSub && i < children.length; i++) {\n            children[i].eachNode(options, cb, context);\n        }\n\n        order === 'postorder' && cb.call(context, this);\n    },\n\n    /**\n     * Update depth and height of this subtree.\n     *\n     * @param  {number} depth\n     */\n    updateDepthAndHeight: function (depth) {\n        var height = 0;\n        this.depth = depth;\n        for (var i = 0; i < this.children.length; i++) {\n            var child = this.children[i];\n            child.updateDepthAndHeight(depth + 1);\n            if (child.height > height) {\n                height = child.height;\n            }\n        }\n        this.height = height + 1;\n    },\n\n    /**\n     * @param  {string} id\n     * @return {module:echarts/data/Tree~TreeNode}\n     */\n    getNodeById: function (id) {\n        if (this.getId() === id) {\n            return this;\n        }\n        for (var i = 0, children = this.children, len = children.length; i < len; i++) {\n            var res = children[i].getNodeById(id);\n            if (res) {\n                return res;\n            }\n        }\n    },\n\n    /**\n     * @param {module:echarts/data/Tree~TreeNode} node\n     * @return {boolean}\n     */\n    contains: function (node) {\n        if (node === this) {\n            return true;\n        }\n        for (var i = 0, children = this.children, len = children.length; i < len; i++) {\n            var res = children[i].contains(node);\n            if (res) {\n                return res;\n            }\n        }\n    },\n\n    /**\n     * @param {boolean} includeSelf Default false.\n     * @return {Array.<module:echarts/data/Tree~TreeNode>} order: [root, child, grandchild, ...]\n     */\n    getAncestors: function (includeSelf) {\n        var ancestors = [];\n        var node = includeSelf ? this : this.parentNode;\n        while (node) {\n            ancestors.push(node);\n            node = node.parentNode;\n        }\n        ancestors.reverse();\n        return ancestors;\n    },\n\n    /**\n     * @param {string|Array=} [dimension='value'] Default 'value'. can be 0, 1, 2, 3\n     * @return {number} Value.\n     */\n    getValue: function (dimension) {\n        var data = this.hostTree.data;\n        return data.get(data.getDimension(dimension || 'value'), this.dataIndex);\n    },\n\n    /**\n     * @param {Object} layout\n     * @param {boolean=} [merge=false]\n     */\n    setLayout: function (layout, merge$$1) {\n        this.dataIndex >= 0\n            && this.hostTree.data.setItemLayout(this.dataIndex, layout, merge$$1);\n    },\n\n    /**\n     * @return {Object} layout\n     */\n    getLayout: function () {\n        return this.hostTree.data.getItemLayout(this.dataIndex);\n    },\n\n    /**\n     * @param {string} [path]\n     * @return {module:echarts/model/Model}\n     */\n    getModel: function (path) {\n        if (this.dataIndex < 0) {\n            return;\n        }\n        var hostTree = this.hostTree;\n        var itemModel = hostTree.data.getItemModel(this.dataIndex);\n        var levelModel = this.getLevelModel();\n        var leavesModel;\n        if (!levelModel && (this.children.length === 0 || (this.children.length !== 0 && this.isExpand === false))) {\n            leavesModel = this.getLeavesModel();\n        }\n        return itemModel.getModel(path, (levelModel || leavesModel || hostTree.hostModel).getModel(path));\n    },\n\n    /**\n     * @return {module:echarts/model/Model}\n     */\n    getLevelModel: function () {\n        return (this.hostTree.levelModels || [])[this.depth];\n    },\n\n    /**\n     * @return {module:echarts/model/Model}\n     */\n    getLeavesModel: function () {\n        return this.hostTree.leavesModel;\n    },\n\n    /**\n     * @example\n     *  setItemVisual('color', color);\n     *  setItemVisual({\n     *      'color': color\n     *  });\n     */\n    setVisual: function (key, value) {\n        this.dataIndex >= 0\n            && this.hostTree.data.setItemVisual(this.dataIndex, key, value);\n    },\n\n    /**\n     * Get item visual\n     */\n    getVisual: function (key, ignoreParent) {\n        return this.hostTree.data.getItemVisual(this.dataIndex, key, ignoreParent);\n    },\n\n    /**\n     * @public\n     * @return {number}\n     */\n    getRawIndex: function () {\n        return this.hostTree.data.getRawIndex(this.dataIndex);\n    },\n\n    /**\n     * @public\n     * @return {string}\n     */\n    getId: function () {\n        return this.hostTree.data.getId(this.dataIndex);\n    },\n\n    /**\n     * if this is an ancestor of another node\n     *\n     * @public\n     * @param {TreeNode} node another node\n     * @return {boolean} if is ancestor\n     */\n    isAncestorOf: function (node) {\n        var parent = node.parentNode;\n        while (parent) {\n            if (parent === this) {\n                return true;\n            }\n            parent = parent.parentNode;\n        }\n        return false;\n    },\n\n    /**\n     * if this is an descendant of another node\n     *\n     * @public\n     * @param {TreeNode} node another node\n     * @return {boolean} if is descendant\n     */\n    isDescendantOf: function (node) {\n        return node !== this && node.isAncestorOf(this);\n    }\n};\n\n/**\n * @constructor\n * @alias module:echarts/data/Tree\n * @param {module:echarts/model/Model} hostModel\n * @param {Array.<Object>} levelOptions\n * @param {Object} leavesOption\n */\nfunction Tree(hostModel, levelOptions, leavesOption) {\n    /**\n     * @type {module:echarts/data/Tree~TreeNode}\n     * @readOnly\n     */\n    this.root;\n\n    /**\n     * @type {module:echarts/data/List}\n     * @readOnly\n     */\n    this.data;\n\n    /**\n     * Index of each item is the same as the raw index of coresponding list item.\n     * @private\n     * @type {Array.<module:echarts/data/Tree~TreeNode}\n     */\n    this._nodes = [];\n\n    /**\n     * @private\n     * @readOnly\n     * @type {module:echarts/model/Model}\n     */\n    this.hostModel = hostModel;\n\n    /**\n     * @private\n     * @readOnly\n     * @type {Array.<module:echarts/model/Model}\n     */\n    this.levelModels = map(levelOptions || [], function (levelDefine) {\n        return new Model(levelDefine, hostModel, hostModel.ecModel);\n    });\n\n    this.leavesModel = new Model(leavesOption || {}, hostModel, hostModel.ecModel);\n}\n\nTree.prototype = {\n\n    constructor: Tree,\n\n    type: 'tree',\n\n    /**\n     * Travel this subtree (include this node).\n     * Usage:\n     *    node.eachNode(function () { ... }); // preorder\n     *    node.eachNode('preorder', function () { ... }); // preorder\n     *    node.eachNode('postorder', function () { ... }); // postorder\n     *    node.eachNode(\n     *        {order: 'postorder', attr: 'viewChildren'},\n     *        function () { ... }\n     *    ); // postorder\n     *\n     * @param {(Object|string)} options If string, means order.\n     * @param {string=} options.order 'preorder' or 'postorder'\n     * @param {string=} options.attr 'children' or 'viewChildren'\n     * @param {Function} cb\n     * @param {Object}   [context]\n     */\n    eachNode: function(options, cb, context) {\n        this.root.eachNode(options, cb, context);\n    },\n\n    /**\n     * @param {number} dataIndex\n     * @return {module:echarts/data/Tree~TreeNode}\n     */\n    getNodeByDataIndex: function (dataIndex) {\n        var rawIndex = this.data.getRawIndex(dataIndex);\n        return this._nodes[rawIndex];\n    },\n\n    /**\n     * @param {string} name\n     * @return {module:echarts/data/Tree~TreeNode}\n     */\n    getNodeByName: function (name) {\n        return this.root.getNodeByName(name);\n    },\n\n    /**\n     * Update item available by list,\n     * when list has been performed options like 'filterSelf' or 'map'.\n     */\n    update: function () {\n        var data = this.data;\n        var nodes = this._nodes;\n\n        for (var i = 0, len = nodes.length; i < len; i++) {\n            nodes[i].dataIndex = -1;\n        }\n\n        for (var i = 0, len = data.count(); i < len; i++) {\n            nodes[data.getRawIndex(i)].dataIndex = i;\n        }\n    },\n\n    /**\n     * Clear all layouts\n     */\n    clearLayouts: function () {\n        this.data.clearItemLayouts();\n    }\n};\n\n/**\n * data node format:\n * {\n *     name: ...\n *     value: ...\n *     children: [\n *         {\n *             name: ...\n *             value: ...\n *             children: ...\n *         },\n *         ...\n *     ]\n * }\n *\n * @static\n * @param {Object} dataRoot Root node.\n * @param {module:echarts/model/Model} hostModel\n * @param {Object} treeOptions\n * @param {Array.<Object>} treeOptions.levels\n * @param {Array.<Object>} treeOptions.leaves\n * @return module:echarts/data/Tree\n */\nTree.createTree = function (dataRoot, hostModel, treeOptions) {\n\n    var tree = new Tree(hostModel, treeOptions.levels, treeOptions.leaves);\n    var listData = [];\n    var dimMax = 1;\n\n    buildHierarchy(dataRoot);\n\n    function buildHierarchy(dataNode, parentNode) {\n        var value = dataNode.value;\n        dimMax = Math.max(dimMax, isArray(value) ? value.length : 1);\n\n        listData.push(dataNode);\n\n        var node = new TreeNode(dataNode.name, tree);\n        parentNode\n            ? addChild(node, parentNode)\n            : (tree.root = node);\n\n        tree._nodes.push(node);\n\n        var children = dataNode.children;\n        if (children) {\n            for (var i = 0; i < children.length; i++) {\n                buildHierarchy(children[i], node);\n            }\n        }\n    }\n\n    tree.root.updateDepthAndHeight(0);\n\n    var dimensionsInfo = createDimensions(listData, {\n        coordDimensions: ['value'],\n        dimensionsCount: dimMax\n    });\n\n    var list = new List(dimensionsInfo, hostModel);\n    list.initData(listData);\n\n    linkList({\n        mainData: list,\n        struct: tree,\n        structAttr: 'tree'\n    });\n\n    tree.update();\n\n    return tree;\n};\n\n/**\n * It is needed to consider the mess of 'list', 'hostModel' when creating a TreeNote,\n * so this function is not ready and not necessary to be public.\n *\n * @param {(module:echarts/data/Tree~TreeNode|Object)} child\n */\nfunction addChild(child, node) {\n    var children = node.children;\n    if (child.parentNode === node) {\n        return;\n    }\n\n    children.push(child);\n    child.parentNode = node;\n}\n\n/**\n * @file Create data struct and define tree view's series model\n */\n\nSeriesModel.extend({\n\n    type: 'series.tree',\n\n    layoutInfo: null,\n\n    // can support the position parameters 'left', 'top','right','bottom', 'width',\n    // 'height' in the setOption() with 'merge' mode normal.\n    layoutMode: 'box',\n\n    /**\n     * Init a tree data structure from data in option series\n     * @param  {Object} option  the object used to config echarts view\n     * @return {module:echarts/data/List} storage initial data\n     */\n    getInitialData: function (option) {\n\n        //create an virtual root\n        var root = {name: option.name, children: option.data};\n\n        var leaves = option.leaves || {};\n\n        var treeOption = {};\n\n        treeOption.leaves = leaves;\n\n        var tree = Tree.createTree(root, this, treeOption);\n\n        var treeDepth = 0;\n\n        tree.eachNode('preorder', function (node) {\n            if (node.depth > treeDepth) {\n                treeDepth = node.depth;\n            }\n        });\n\n        var expandAndCollapse = option.expandAndCollapse;\n        var expandTreeDepth = (expandAndCollapse && option.initialTreeDepth >= 0)\n            ? option.initialTreeDepth : treeDepth;\n\n        tree.root.eachNode('preorder', function (node) {\n            var item = node.hostTree.data.getRawDataItem(node.dataIndex);\n            node.isExpand = (item && item.collapsed != null)\n                ? !item.collapsed\n                : node.depth <= expandTreeDepth;\n        });\n\n        return tree.data;\n    },\n\n    /**\n     * @override\n     * @param {number} dataIndex\n     */\n    formatTooltip: function (dataIndex) {\n        var tree = this.getData().tree;\n        var realRoot = tree.root.children[0];\n        var node = tree.getNodeByDataIndex(dataIndex);\n        var value = node.getValue();\n        var name = node.name;\n        while (node && (node !== realRoot)) {\n            name = node.parentNode.name + '.' + name;\n            node = node.parentNode;\n        }\n        return encodeHTML(name + (\n            (isNaN(value) || value == null) ? '' : ' : ' + value\n        ));\n    },\n\n    defaultOption: {\n        zlevel: 0,\n        z: 2,\n\n        // the position of the whole view\n        left: '12%',\n        top: '12%',\n        right: '12%',\n        bottom: '12%',\n\n        // the layout of the tree, two value can be selected, 'orthogonal' or 'radial'\n        layout: 'orthogonal',\n\n        // the orient of orthoginal layout, can be setted to 'horizontal' or 'vertical'\n        orient: 'horizontal',\n\n        symbol: 'emptyCircle',\n\n        symbolSize: 7,\n\n        expandAndCollapse: true,\n\n        initialTreeDepth: 2,\n\n        lineStyle: {\n            color: '#ccc',\n            width: 1.5,\n            curveness: 0.5\n        },\n\n        itemStyle: {\n            color: 'lightsteelblue',\n            borderColor: '#c23531',\n            borderWidth: 1.5\n        },\n\n        label: {\n            show: true,\n            color: '#555'\n        },\n\n        leaves: {\n            label: {\n                show: true\n            }\n        },\n\n        animationEasing: 'linear',\n\n        animationDuration: 700,\n\n        animationDurationUpdate: 1000\n    }\n});\n\n/**\n * @file The layout algorithm of node-link tree diagrams. Here we using Reingold-Tilford algorithm to drawing\n *       the tree.\n * @see https://github.com/d3/d3-hierarchy\n */\n\n/**\n * Initialize all computational message for following algorithm\n * @param  {module:echarts/data/Tree~TreeNode} root   The virtual root of the tree\n */\nfunction init$2(root) {\n    root.hierNode = {\n        defaultAncestor: null,\n        ancestor: root,\n        prelim: 0,\n        modifier: 0,\n        change: 0,\n        shift: 0,\n        i: 0,\n        thread: null\n    };\n\n    var nodes = [root];\n    var node;\n    var children;\n\n    while (node = nodes.pop()) { // jshint ignore:line\n        children = node.children;\n        if (node.isExpand && children.length) {\n            var n = children.length;\n            for (var i = n - 1; i >= 0; i--) {\n                var child = children[i];\n                child.hierNode = {\n                    defaultAncestor: null,\n                    ancestor: child,\n                    prelim: 0,\n                    modifier: 0,\n                    change: 0,\n                    shift: 0,\n                    i: i,\n                    thread: null\n                };\n                nodes.push(child);\n            }\n        }\n    }\n}\n\n/**\n * Computes a preliminary x coordinate for node. Before that, this function is\n * applied recursively to the children of node, as well as the function\n * apportion(). After spacing out the children by calling executeShifts(), the\n * node is placed to the midpoint of its outermost children.\n * @param  {module:echarts/data/Tree~TreeNode} node\n * @param {Function} separation\n */\nfunction firstWalk(node, separation) {\n    var children = node.isExpand ? node.children : [];\n    var siblings = node.parentNode.children;\n    var subtreeW = node.hierNode.i ? siblings[node.hierNode.i -1] : null;\n    if (children.length) {\n        executeShifts(node);\n        var midPoint = (children[0].hierNode.prelim + children[children.length - 1].hierNode.prelim) / 2;\n        if (subtreeW) {\n            node.hierNode.prelim = subtreeW.hierNode.prelim + separation(node, subtreeW);\n            node.hierNode.modifier = node.hierNode.prelim - midPoint;\n        }\n        else {\n            node.hierNode.prelim = midPoint;\n        }\n    }\n    else if (subtreeW) {\n        node.hierNode.prelim = subtreeW.hierNode.prelim + separation(node, subtreeW);\n    }\n    node.parentNode.hierNode.defaultAncestor = apportion(node, subtreeW, node.parentNode.hierNode.defaultAncestor || siblings[0], separation);\n}\n\n\n/**\n * Computes all real x-coordinates by summing up the modifiers recursively.\n * @param  {module:echarts/data/Tree~TreeNode} node\n */\nfunction secondWalk(node) {\n    var nodeX = node.hierNode.prelim + node.parentNode.hierNode.modifier;\n    node.setLayout({x: nodeX}, true);\n    node.hierNode.modifier += node.parentNode.hierNode.modifier;\n}\n\n\nfunction separation(cb) {\n    return arguments.length ? cb : defaultSeparation;\n}\n\n/**\n * Transform the common coordinate to radial coordinate\n * @param  {number} x\n * @param  {number} y\n * @return {Object}\n */\nfunction radialCoordinate(x, y) {\n    var radialCoor = {};\n    x -= Math.PI / 2;\n    radialCoor.x = y * Math.cos(x);\n    radialCoor.y = y * Math.sin(x);\n    return radialCoor;\n}\n\n/**\n * Get the layout position of the whole view\n * @param {module:echarts/model/Series} seriesModel  the model object of sankey series\n * @param {module:echarts/ExtensionAPI} api  provide the API list that the developer can call\n * @return {module:zrender/core/BoundingRect}  size of rect to draw the sankey view\n */\nfunction getViewRect(seriesModel, api) {\n    return getLayoutRect(\n        seriesModel.getBoxLayoutParams(), {\n            width: api.getWidth(),\n            height: api.getHeight()\n        }\n    );\n}\n\n/**\n * All other shifts, applied to the smaller subtrees between w- and w+, are\n * performed by this function.\n * @param  {module:echarts/data/Tree~TreeNode} node\n */\nfunction executeShifts(node) {\n    var children = node.children;\n    var n = children.length;\n    var shift = 0;\n    var change = 0;\n    while (--n >= 0) {\n        var child = children[n];\n        child.hierNode.prelim += shift;\n        child.hierNode.modifier += shift;\n        change += child.hierNode.change;\n        shift += child.hierNode.shift + change;\n    }\n}\n\n/**\n * The core of the algorithm. Here, a new subtree is combined with the\n * previous subtrees. Threads are used to traverse the inside and outside\n * contours of the left and right subtree up to the highest common level.\n * Whenever two nodes of the inside contours conflict, we compute the left\n * one of the greatest uncommon ancestors using the function nextAncestor()\n * and call moveSubtree() to shift the subtree and prepare the shifts of\n * smaller subtrees. Finally, we add a new thread (if necessary).\n * @param  {module:echarts/data/Tree~TreeNode} subtreeV\n * @param  {module:echarts/data/Tree~TreeNode} subtreeW\n * @param  {module:echarts/data/Tree~TreeNode} ancestor\n * @param  {Function} separation\n * @return {module:echarts/data/Tree~TreeNode}\n */\nfunction apportion(subtreeV, subtreeW, ancestor, separation) {\n\n    if (subtreeW) {\n        var nodeOutRight = subtreeV;\n        var nodeInRight = subtreeV;\n        var nodeOutLeft = nodeInRight.parentNode.children[0];\n        var nodeInLeft = subtreeW;\n\n        var sumOutRight = nodeOutRight.hierNode.modifier;\n        var sumInRight = nodeInRight.hierNode.modifier;\n        var sumOutLeft = nodeOutLeft.hierNode.modifier;\n        var sumInLeft = nodeInLeft.hierNode.modifier;\n\n        while (nodeInLeft = nextRight(nodeInLeft), nodeInRight = nextLeft(nodeInRight), nodeInLeft && nodeInRight) {\n            nodeOutRight = nextRight(nodeOutRight);\n            nodeOutLeft = nextLeft(nodeOutLeft);\n            nodeOutRight.hierNode.ancestor = subtreeV;\n            var shift = nodeInLeft.hierNode.prelim + sumInLeft - nodeInRight.hierNode.prelim\n                    - sumInRight + separation(nodeInLeft, nodeInRight);\n            if (shift > 0) {\n                moveSubtree(nextAncestor(nodeInLeft, subtreeV, ancestor), subtreeV, shift);\n                sumInRight += shift;\n                sumOutRight += shift;\n            }\n            sumInLeft += nodeInLeft.hierNode.modifier;\n            sumInRight += nodeInRight.hierNode.modifier;\n            sumOutRight += nodeOutRight.hierNode.modifier;\n            sumOutLeft += nodeOutLeft.hierNode.modifier;\n        }\n        if (nodeInLeft && !nextRight(nodeOutRight)) {\n            nodeOutRight.hierNode.thread = nodeInLeft;\n            nodeOutRight.hierNode.modifier += sumInLeft - sumOutRight;\n\n        }\n        if (nodeInRight && !nextLeft(nodeOutLeft)) {\n            nodeOutLeft.hierNode.thread = nodeInRight;\n            nodeOutLeft.hierNode.modifier += sumInRight - sumOutLeft;\n            ancestor = subtreeV;\n        }\n    }\n    return ancestor;\n}\n\n/**\n * This function is used to traverse the right contour of a subtree.\n * It returns the rightmost child of node or the thread of node. The function\n * returns null if and only if node is on the highest depth of its subtree.\n * @param  {module:echarts/data/Tree~TreeNode} node\n * @return {module:echarts/data/Tree~TreeNode}\n */\nfunction nextRight(node) {\n    var children = node.children;\n    return children.length && node.isExpand ? children[children.length - 1] : node.hierNode.thread;\n}\n\n/**\n * This function is used to traverse the left contour of a subtree (or a subforest).\n * It returns the leftmost child of node or the thread of node. The function\n * returns null if and only if node is on the highest depth of its subtree.\n * @param  {module:echarts/data/Tree~TreeNode} node\n * @return {module:echarts/data/Tree~TreeNode}\n */\nfunction nextLeft(node) {\n    var children = node.children;\n    return children.length && node.isExpand ? children[0] : node.hierNode.thread;\n}\n\n/**\n * If nodeInLefts ancestor is a sibling of node, returns nodeInLefts ancestor.\n * Otherwise, returns the specified ancestor.\n * @param  {module:echarts/data/Tree~TreeNode} nodeInLeft\n * @param  {module:echarts/data/Tree~TreeNode} node\n * @param  {module:echarts/data/Tree~TreeNode} ancestor\n * @return {module:echarts/data/Tree~TreeNode}\n */\nfunction nextAncestor(nodeInLeft, node, ancestor) {\n    return nodeInLeft.hierNode.ancestor.parentNode === node.parentNode\n        ? nodeInLeft.hierNode.ancestor : ancestor;\n}\n\n/**\n * Shifts the current subtree rooted at wr. This is done by increasing prelim(w+) and modifier(w+) by shift.\n * @param  {module:echarts/data/Tree~TreeNode} wl\n * @param  {module:echarts/data/Tree~TreeNode} wr\n * @param  {number} shift [description]\n */\nfunction moveSubtree(wl, wr,shift) {\n    var change = shift / (wr.hierNode.i - wl.hierNode.i);\n    wr.hierNode.change -= change;\n    wr.hierNode.shift += shift;\n    wr.hierNode.modifier += shift;\n    wr.hierNode.prelim += shift;\n    wl.hierNode.change += change;\n}\n\nfunction defaultSeparation(node1, node2) {\n    return node1.parentNode === node2.parentNode ? 1 : 2;\n}\n\n/**\n * @file  This file used to draw tree view\n */\n\nextendChartView({\n\n    type: 'tree',\n\n    /**\n     * Init the chart\n     * @override\n     * @param  {module:echarts/model/Global} ecModel\n     * @param  {module:echarts/ExtensionAPI} api\n     */\n    init: function (ecModel, api) {\n\n        /**\n         * @private\n         * @type {module:echarts/data/Tree}\n         */\n        this._oldTree;\n\n        /**\n         * @private\n         * @type {module:zrender/container/Group}\n         */\n        this._mainGroup = new Group();\n\n        this.group.add(this._mainGroup);\n    },\n\n    render: function (seriesModel, ecModel, api, payload) {\n\n        var data = seriesModel.getData();\n\n        var layoutInfo = seriesModel.layoutInfo;\n\n        var group = this._mainGroup;\n\n        var layout = seriesModel.get('layout');\n\n        if (layout === 'radial') {\n            group.attr('position', [layoutInfo.x + layoutInfo.width / 2, layoutInfo.y + layoutInfo.height / 2]);\n        }\n        else {\n            group.attr('position', [layoutInfo.x, layoutInfo.y]);\n        }\n\n        var oldData = this._data;\n\n        var seriesScope = {\n            expandAndCollapse: seriesModel.get('expandAndCollapse'),\n            layout: layout,\n            orient: seriesModel.get('orient'),\n            curvature: seriesModel.get('lineStyle.curveness'),\n            symbolRotate: seriesModel.get('symbolRotate'),\n            symbolOffset: seriesModel.get('symbolOffset'),\n            hoverAnimation: seriesModel.get('hoverAnimation'),\n            useNameLabel: true,\n            fadeIn: true\n        };\n\n        data.diff(oldData)\n            .add(function (newIdx) {\n                if (symbolNeedsDraw$1(data, newIdx)) {\n                    // create node and edge\n                    updateNode(data, newIdx, null, group, seriesModel, seriesScope);\n                }\n            })\n            .update(function (newIdx, oldIdx) {\n                var symbolEl = oldData.getItemGraphicEl(oldIdx);\n                if (!symbolNeedsDraw$1(data, newIdx)) {\n                    symbolEl && removeNode(data, newIdx, symbolEl, group, seriesModel, seriesScope);\n                    return;\n                }\n                // update  node and edge\n                updateNode(data, newIdx, symbolEl, group, seriesModel, seriesScope);\n            })\n            .remove(function (oldIdx) {\n                var symbolEl = oldData.getItemGraphicEl(oldIdx);\n                removeNode(data, oldIdx, symbolEl, group, seriesModel, seriesScope);\n            })\n            .execute();\n\n        if (seriesScope.expandAndCollapse === true) {\n            data.eachItemGraphicEl(function (el, dataIndex) {\n                el.off('click').on('click', function () {\n                    api.dispatchAction({\n                        type: 'treeExpandAndCollapse',\n                        seriesId: seriesModel.id,\n                        dataIndex: dataIndex\n                    });\n                });\n            });\n        }\n\n        this._data = data;\n    },\n\n    dispose: function () {},\n\n    remove: function () {\n        this._mainGroup.removeAll();\n        this._data = null;\n    }\n\n});\n\nfunction symbolNeedsDraw$1(data, dataIndex) {\n    var layout = data.getItemLayout(dataIndex);\n\n    return layout\n        && !isNaN(layout.x) && !isNaN(layout.y)\n        && data.getItemVisual(dataIndex, 'symbol') !== 'none';\n}\n\nfunction getTreeNodeStyle(node, itemModel, seriesScope) {\n    seriesScope.itemModel = itemModel;\n    seriesScope.itemStyle = itemModel.getModel('itemStyle').getItemStyle();\n    seriesScope.hoverItemStyle = itemModel.getModel('emphasis.itemStyle').getItemStyle();\n    seriesScope.lineStyle = itemModel.getModel('lineStyle').getLineStyle();\n    seriesScope.labelModel = itemModel.getModel('label');\n    seriesScope.hoverLabelModel = itemModel.getModel('emphasis.label');\n\n    if (node.isExpand === false && node.children.length !== 0) {\n        seriesScope.symbolInnerColor = seriesScope.itemStyle.fill;\n    }\n    else {\n        seriesScope.symbolInnerColor = '#fff';\n    }\n\n    return seriesScope;\n}\n\nfunction updateNode(data, dataIndex, symbolEl, group, seriesModel, seriesScope) {\n    var isInit = !symbolEl;\n    var node = data.tree.getNodeByDataIndex(dataIndex);\n    var itemModel = node.getModel();\n    var seriesScope = getTreeNodeStyle(node, itemModel, seriesScope);\n    var virtualRoot = data.tree.root;\n\n    var source = node.parentNode === virtualRoot ? node : node.parentNode || node;\n    var sourceSymbolEl = data.getItemGraphicEl(source.dataIndex);\n    var sourceLayout = source.getLayout();\n    var sourceOldLayout = sourceSymbolEl\n        ? {\n            x: sourceSymbolEl.position[0],\n            y: sourceSymbolEl.position[1],\n            rawX: sourceSymbolEl.__radialOldRawX,\n            rawY: sourceSymbolEl.__radialOldRawY\n        }\n        : sourceLayout;\n    var targetLayout = node.getLayout();\n\n    if (isInit) {\n        symbolEl = new SymbolClz$1(data, dataIndex, seriesScope);\n        symbolEl.attr('position', [sourceOldLayout.x, sourceOldLayout.y]);\n    }\n    else {\n        symbolEl.updateData(data, dataIndex, seriesScope);\n    }\n\n    symbolEl.__radialOldRawX = symbolEl.__radialRawX;\n    symbolEl.__radialOldRawY = symbolEl.__radialRawY;\n    symbolEl.__radialRawX = targetLayout.rawX;\n    symbolEl.__radialRawY = targetLayout.rawY;\n\n    group.add(symbolEl);\n    data.setItemGraphicEl(dataIndex, symbolEl);\n    updateProps(symbolEl, {\n        position: [targetLayout.x, targetLayout.y]\n    }, seriesModel);\n\n    var symbolPath = symbolEl.getSymbolPath();\n\n    if (seriesScope.layout === 'radial') {\n        var realRoot = virtualRoot.children[0];\n        var rootLayout = realRoot.getLayout();\n        var length = realRoot.children.length;\n        var rad;\n        var isLeft;\n\n        if (targetLayout.x === rootLayout.x && node.isExpand === true) {\n            var center = {};\n            center.x = (realRoot.children[0].getLayout().x + realRoot.children[length - 1].getLayout().x) / 2;\n            center.y = (realRoot.children[0].getLayout().y + realRoot.children[length - 1].getLayout().y) / 2;\n            rad = Math.atan2(center.y - rootLayout.y, center.x - rootLayout.x);\n            if (rad < 0) {\n                rad = Math.PI * 2 + rad;\n            }\n            isLeft = center.x < rootLayout.x;\n            if (isLeft) {\n                rad = rad - Math.PI;\n            }\n        }\n        else {\n            rad = Math.atan2(targetLayout.y - rootLayout.y, targetLayout.x - rootLayout.x);\n            if (rad < 0) {\n                rad = Math.PI * 2 + rad;\n            }\n            if (node.children.length === 0 || (node.children.length !== 0 && node.isExpand === false)) {\n                isLeft = targetLayout.x < rootLayout.x;\n                if (isLeft) {\n                    rad = rad - Math.PI;\n                }\n            }\n            else {\n                isLeft = targetLayout.x > rootLayout.x;\n                if (!isLeft) {\n                    rad = rad - Math.PI;\n                }\n            }\n        }\n\n        var textPosition = isLeft ? 'left' : 'right';\n        symbolPath.setStyle({\n            textPosition: textPosition,\n            textRotation: -rad,\n            textOrigin: 'center',\n            verticalAlign: 'middle'\n        });\n    }\n\n    if (node.parentNode && node.parentNode !== virtualRoot) {\n        var edge = symbolEl.__edge;\n        if (!edge) {\n            edge = symbolEl.__edge = new BezierCurve({\n                shape: getEdgeShape(seriesScope, sourceOldLayout, sourceOldLayout),\n                style: defaults({opacity: 0}, seriesScope.lineStyle)\n            });\n        }\n\n        updateProps(edge, {\n            shape: getEdgeShape(seriesScope, sourceLayout, targetLayout),\n            style: {opacity: 1}\n        }, seriesModel);\n\n        group.add(edge);\n    }\n}\n\nfunction removeNode(data, dataIndex, symbolEl, group, seriesModel, seriesScope) {\n    var node = data.tree.getNodeByDataIndex(dataIndex);\n    var virtualRoot = data.tree.root;\n    var itemModel = node.getModel();\n    var seriesScope = getTreeNodeStyle(node, itemModel, seriesScope);\n\n    var source = node.parentNode === virtualRoot ? node : node.parentNode || node;\n    var sourceLayout;\n    while (sourceLayout = source.getLayout(), sourceLayout == null) {\n        source = source.parentNode === virtualRoot ? source : source.parentNode || source;\n    }\n\n    updateProps(symbolEl, {\n        position: [sourceLayout.x + 1, sourceLayout.y + 1]\n    }, seriesModel, function () {\n        group.remove(symbolEl);\n        data.setItemGraphicEl(dataIndex, null);\n    });\n\n    symbolEl.fadeOut(null, {keepLabel: true});\n\n    var edge = symbolEl.__edge;\n    if (edge) {\n        updateProps(edge, {\n            shape: getEdgeShape(seriesScope, sourceLayout, sourceLayout),\n            style: {\n                opacity: 0\n            }\n        }, seriesModel, function () {\n            group.remove(edge);\n        });\n    }\n}\n\nfunction getEdgeShape(seriesScope, sourceLayout, targetLayout) {\n    var cpx1;\n    var cpy1;\n    var cpx2;\n    var cpy2;\n    var orient = seriesScope.orient;\n\n    if (seriesScope.layout === 'radial') {\n        var x1 = sourceLayout.rawX;\n        var y1 = sourceLayout.rawY;\n        var x2 = targetLayout.rawX;\n        var y2 = targetLayout.rawY;\n\n        var radialCoor1 = radialCoordinate(x1, y1);\n        var radialCoor2 = radialCoordinate(x1, y1 + (y2 - y1) * seriesScope.curvature);\n        var radialCoor3 = radialCoordinate(x2, y2 + (y1 - y2) * seriesScope.curvature);\n        var radialCoor4 = radialCoordinate(x2, y2);\n\n        return {\n            x1: radialCoor1.x,\n            y1: radialCoor1.y,\n            x2: radialCoor4.x,\n            y2: radialCoor4.y,\n            cpx1: radialCoor2.x,\n            cpy1: radialCoor2.y,\n            cpx2: radialCoor3.x,\n            cpy2: radialCoor3.y\n        };\n    }\n    else {\n        var x1 = sourceLayout.x;\n        var y1 = sourceLayout.y;\n        var x2 = targetLayout.x;\n        var y2 = targetLayout.y;\n\n        if (orient === 'horizontal') {\n            cpx1 = x1 + (x2 - x1) * seriesScope.curvature;\n            cpy1 = y1;\n            cpx2 = x2 + (x1 - x2) * seriesScope.curvature;\n            cpy2 = y2;\n        }\n        if (orient === 'vertical') {\n            cpx1 = x1;\n            cpy1 = y1 + (y2 - y1) * seriesScope.curvature;\n            cpx2 = x2;\n            cpy2 = y2 + (y1 - y2) * seriesScope.curvature;\n        }\n        return {\n            x1: x1,\n            y1: y1,\n            x2: x2,\n            y2: y2,\n            cpx1: cpx1,\n            cpy1: cpy1,\n            cpx2: cpx2,\n            cpy2: cpy2\n        };\n    }\n}\n\nregisterAction({\n    type: 'treeExpandAndCollapse',\n    event: 'treeExpandAndCollapse',\n    update: 'update'\n}, function (payload, ecModel) {\n    ecModel.eachComponent({mainType: 'series', subType: 'tree', query: payload}, function (seriesModel) {\n        var dataIndex = payload.dataIndex;\n        var tree = seriesModel.getData().tree;\n        var node = tree.getNodeByDataIndex(dataIndex);\n        node.isExpand = !node.isExpand;\n\n    });\n});\n\n/**\n * Traverse the tree from bottom to top and do something\n * @param  {module:echarts/data/Tree~TreeNode} root  The real root of the tree\n * @param  {Function} callback\n */\nfunction eachAfter (root, callback, separation) {\n    var nodes = [root];\n    var next = [];\n    var node;\n\n    while (node = nodes.pop()) { // jshint ignore:line\n        next.push(node);\n        if (node.isExpand) {\n            var children = node.children;\n            if (children.length) {\n                for (var i = 0; i < children.length; i++) {\n                    nodes.push(children[i]);\n                }\n            }\n        }\n    }\n\n    while (node = next.pop()) { // jshint ignore:line\n        callback(node, separation);\n    }\n}\n\n/**\n * Traverse the tree from top to bottom and do something\n * @param  {module:echarts/data/Tree~TreeNode} root  The real root of the tree\n * @param  {Function} callback\n */\nfunction eachBefore (root, callback) {\n    var nodes = [root];\n    var node;\n    while (node = nodes.pop()) { // jshint ignore:line\n        callback(node);\n        if (node.isExpand) {\n            var children = node.children;\n            if (children.length) {\n                for (var i = children.length - 1; i >= 0; i--) {\n                    nodes.push(children[i]);\n                }\n            }\n        }\n    }\n}\n\nvar commonLayout = function (seriesModel, api) {\n\n    var layoutInfo = getViewRect(seriesModel, api);\n    seriesModel.layoutInfo = layoutInfo;\n\n    var layout = seriesModel.get('layout');\n    var width = 0;\n    var height = 0;\n    var separation$$1 = null;\n    if (layout === 'radial') {\n        width = 2 * Math.PI;\n        height = Math.min(layoutInfo.height, layoutInfo.width) / 2;\n        separation$$1 = separation(function (node1, node2) {\n            return (node1.parentNode === node2.parentNode ? 1 : 2) / node1.depth;\n        });\n    }\n    else {\n        width = layoutInfo.width;\n        height = layoutInfo.height;\n        separation$$1 = separation();\n    }\n\n    var virtualRoot = seriesModel.getData().tree.root;\n    var realRoot = virtualRoot.children[0];\n    init$2(virtualRoot);\n    eachAfter(realRoot, firstWalk, separation$$1);\n    virtualRoot.hierNode.modifier = - realRoot.hierNode.prelim;\n    eachBefore(realRoot, secondWalk);\n\n    var left = realRoot;\n    var right = realRoot;\n    var bottom = realRoot;\n    eachBefore(realRoot, function (node) {\n        var x = node.getLayout().x;\n        if (x < left.getLayout().x) {\n            left = node;\n        }\n        if (x > right.getLayout().x) {\n            right = node;\n        }\n        if (node.depth > bottom.depth) {\n            bottom = node;\n        }\n    });\n\n    var delta = left === right ? 1 : separation$$1(left, right) / 2;\n    var tx = delta - left.getLayout().x;\n    var kx = 0;\n    var ky = 0;\n    var coorX = 0;\n    var coorY = 0;\n    if (layout === 'radial') {\n        kx = width / (right.getLayout().x + delta + tx);\n        // here we use (node.depth - 1), bucause the real root's depth is 1\n        ky = height/ ((bottom.depth - 1) || 1);\n        eachBefore(realRoot, function (node) {\n            coorX = (node.getLayout().x + tx) * kx;\n            coorY = (node.depth - 1) * ky;\n            var finalCoor = radialCoordinate(coorX, coorY);\n            node.setLayout({x: finalCoor.x, y: finalCoor.y, rawX: coorX, rawY: coorY}, true);\n        });\n    }\n    else {\n        if (seriesModel.get('orient') === 'horizontal') {\n            ky = height / (right.getLayout().x + delta + tx);\n            kx = width / ((bottom.depth - 1) || 1);\n            eachBefore(realRoot, function (node) {\n                coorY = (node.getLayout().x + tx) * ky;\n                coorX = (node.depth - 1) * kx;\n                node.setLayout({x: coorX, y: coorY}, true);\n            });\n        }\n        else {\n            kx = width / (right.getLayout().x + delta + tx);\n            ky = height / ((bottom.depth - 1) || 1);\n            eachBefore(realRoot, function (node) {\n                coorX = (node.getLayout().x + tx) * kx;\n                coorY = (node.depth - 1) * ky;\n                node.setLayout({x: coorX, y: coorY}, true);\n            });\n        }\n    }\n};\n\nvar orthogonalLayout = function (ecModel, api) {\n    ecModel.eachSeriesByType('tree', function (seriesModel) {\n        commonLayout(seriesModel, api);\n    });\n};\n\nvar radialLayout = function (ecModel, api) {\n    ecModel.eachSeriesByType('tree', function (seriesModel) {\n        commonLayout(seriesModel, api);\n    });\n};\n\nregisterVisual(visualSymbol('tree', 'circle'));\nregisterLayout(orthogonalLayout);\nregisterLayout(radialLayout);\n\nfunction retrieveTargetInfo(payload, validPayloadTypes, seriesModel) {\n    if (payload && indexOf(validPayloadTypes, payload.type) >= 0) {\n        var root = seriesModel.getData().tree.root;\n        var targetNode = payload.targetNode;\n        if (targetNode && root.contains(targetNode)) {\n            return {node: targetNode};\n        }\n\n        var targetNodeId = payload.targetNodeId;\n        if (targetNodeId != null && (targetNode = root.getNodeById(targetNodeId))) {\n            return {node: targetNode};\n        }\n    }\n}\n\n// Not includes the given node at the last item.\nfunction getPathToRoot(node) {\n    var path = [];\n    while (node) {\n        node = node.parentNode;\n        node && path.push(node);\n    }\n    return path.reverse();\n}\n\nfunction aboveViewRoot(viewRoot, node) {\n    var viewPath = getPathToRoot(viewRoot);\n    return indexOf(viewPath, node) >= 0;\n}\n\n// From root to the input node (the input node will be included).\nfunction wrapTreePathInfo(node, seriesModel) {\n    var treePathInfo = [];\n\n    while (node) {\n        var nodeDataIndex = node.dataIndex;\n        treePathInfo.push({\n            name: node.name,\n            dataIndex: nodeDataIndex,\n            value: seriesModel.getRawValue(nodeDataIndex)\n        });\n        node = node.parentNode;\n    }\n\n    treePathInfo.reverse();\n\n    return treePathInfo;\n}\n\nSeriesModel.extend({\n\n    type: 'series.treemap',\n\n    layoutMode: 'box',\n\n    dependencies: ['grid', 'polar'],\n\n    /**\n     * @type {module:echarts/data/Tree~Node}\n     */\n    _viewRoot: null,\n\n    defaultOption: {\n        // Disable progressive rendering\n        progressive: 0,\n        hoverLayerThreshold: Infinity,\n        // center: ['50%', '50%'],          // not supported in ec3.\n        // size: ['80%', '80%'],            // deprecated, compatible with ec2.\n        left: 'center',\n        top: 'middle',\n        right: null,\n        bottom: null,\n        width: '80%',\n        height: '80%',\n        sort: true,                         // Can be null or false or true\n                                            // (order by desc default, asc not supported yet (strange effect))\n        clipWindow: 'origin',               // Size of clipped window when zooming. 'origin' or 'fullscreen'\n        squareRatio: 0.5 * (1 + Math.sqrt(5)), // golden ratio\n        leafDepth: null,                    // Nodes on depth from root are regarded as leaves.\n                                            // Count from zero (zero represents only view root).\n        drillDownIcon: '',                 // Use html character temporarily because it is complicated\n                                            // to align specialized icon. \n\n        zoomToNodeRatio: 0.32 * 0.32,       // Be effective when using zoomToNode. Specify the proportion of the\n                                            // target node area in the view area.\n        roam: true,                         // true, false, 'scale' or 'zoom', 'move'.\n        nodeClick: 'zoomToNode',            // Leaf node click behaviour: 'zoomToNode', 'link', false.\n                                            // If leafDepth is set and clicking a node which has children but\n                                            // be on left depth, the behaviour would be changing root. Otherwise\n                                            // use behavious defined above.\n        animation: true,\n        animationDurationUpdate: 900,\n        animationEasing: 'quinticInOut',\n        breadcrumb: {\n            show: true,\n            height: 22,\n            left: 'center',\n            top: 'bottom',\n            // right\n            // bottom\n            emptyItemWidth: 25,             // Width of empty node.\n            itemStyle: {\n                color: 'rgba(0,0,0,0.7)', //'#5793f3',\n                borderColor: 'rgba(255,255,255,0.7)',\n                borderWidth: 1,\n                shadowColor: 'rgba(150,150,150,1)',\n                shadowBlur: 3,\n                shadowOffsetX: 0,\n                shadowOffsetY: 0,\n                textStyle: {\n                    color: '#fff'\n                }\n            },\n            emphasis: {\n                textStyle: {}\n            }\n        },\n        label: {\n            show: true,\n            // Do not use textDistance, for ellipsis rect just the same as treemap node rect.\n            distance: 0,\n            padding: 5,\n            position: 'inside', // Can be [5, '5%'] or position stirng like 'insideTopLeft', ...\n            // formatter: null,\n            color: '#fff',\n            ellipsis: true\n            // align\n            // verticalAlign\n        },\n        upperLabel: {                   // Label when node is parent.\n            show: false,\n            position: [0, '50%'],\n            height: 20,\n            // formatter: null,\n            color: '#fff',\n            ellipsis: true,\n            // align: null,\n            verticalAlign: 'middle'\n        },\n        itemStyle: {\n            color: null,            // Can be 'none' if not necessary.\n            colorAlpha: null,       // Can be 'none' if not necessary.\n            colorSaturation: null,  // Can be 'none' if not necessary.\n            borderWidth: 0,\n            gapWidth: 0,\n            borderColor: '#fff',\n            borderColorSaturation: null // If specified, borderColor will be ineffective, and the\n                                        // border color is evaluated by color of current node and\n                                        // borderColorSaturation.\n        },\n        emphasis: {\n            upperLabel: {\n                show: true,\n                position: [0, '50%'],\n                color: '#fff',\n                ellipsis: true,\n                verticalAlign: 'middle'\n            }\n        },\n\n        visualDimension: 0,                 // Can be 0, 1, 2, 3.\n        visualMin: null,\n        visualMax: null,\n\n        color: [],                  // + treemapSeries.color should not be modified. Please only modified\n                                    // level[n].color (if necessary).\n                                    // + Specify color list of each level. level[0].color would be global\n                                    // color list if not specified. (see method `setDefault`).\n                                    // + But set as a empty array to forbid fetch color from global palette\n                                    // when using nodeModel.get('color'), otherwise nodes on deep level\n                                    // will always has color palette set and are not able to inherit color\n                                    // from parent node.\n                                    // + TreemapSeries.color can not be set as 'none', otherwise effect\n                                    // legend color fetching (see seriesColor.js).\n        colorAlpha: null,           // Array. Specify color alpha range of each level, like [0.2, 0.8]\n        colorSaturation: null,      // Array. Specify color saturation of each level, like [0.2, 0.5]\n        colorMappingBy: 'index',    // 'value' or 'index' or 'id'.\n        visibleMin: 10,             // If area less than this threshold (unit: pixel^2), node will not\n                                    // be rendered. Only works when sort is 'asc' or 'desc'.\n        childrenVisibleMin: null,   // If area of a node less than this threshold (unit: pixel^2),\n                                    // grandchildren will not show.\n                                    // Why grandchildren? If not grandchildren but children,\n                                    // some siblings show children and some not,\n                                    // the appearance may be mess and not consistent,\n        levels: []                  // Each item: {\n                                    //     visibleMin, itemStyle, visualDimension, label\n                                    // }\n        // data: {\n        //      value: [],\n        //      children: [],\n        //      link: 'http://xxx.xxx.xxx',\n        //      target: 'blank' or 'self'\n        // }\n    },\n\n    /**\n     * @override\n     */\n    getInitialData: function (option, ecModel) {\n        // Create a virtual root.\n        var root = {name: option.name, children: option.data};\n\n        completeTreeValue(root);\n\n        var levels = option.levels || [];\n\n        levels = option.levels = setDefault(levels, ecModel);\n\n        var treeOption = {};\n\n        treeOption.levels = levels;\n\n        // Make sure always a new tree is created when setOption,\n        // in TreemapView, we check whether oldTree === newTree\n        // to choose mappings approach among old shapes and new shapes.\n        return Tree.createTree(root, this, treeOption).data;\n    },\n\n    optionUpdated: function () {\n        this.resetViewRoot();\n    },\n\n    /**\n     * @override\n     * @param {number} dataIndex\n     * @param {boolean} [mutipleSeries=false]\n     */\n    formatTooltip: function (dataIndex) {\n        var data = this.getData();\n        var value = this.getRawValue(dataIndex);\n        var formattedValue = isArray(value)\n            ? addCommas(value[0]) : addCommas(value);\n        var name = data.getName(dataIndex);\n\n        return encodeHTML(name + ': ' + formattedValue);\n    },\n\n    /**\n     * Add tree path to tooltip param\n     *\n     * @override\n     * @param {number} dataIndex\n     * @return {Object}\n     */\n    getDataParams: function (dataIndex) {\n        var params = SeriesModel.prototype.getDataParams.apply(this, arguments);\n\n        var node = this.getData().tree.getNodeByDataIndex(dataIndex);\n        params.treePathInfo = wrapTreePathInfo(node, this);\n\n        return params;\n    },\n\n    /**\n     * @public\n     * @param {Object} layoutInfo {\n     *                                x: containerGroup x\n     *                                y: containerGroup y\n     *                                width: containerGroup width\n     *                                height: containerGroup height\n     *                            }\n     */\n    setLayoutInfo: function (layoutInfo) {\n        /**\n         * @readOnly\n         * @type {Object}\n         */\n        this.layoutInfo = this.layoutInfo || {};\n        extend(this.layoutInfo, layoutInfo);\n    },\n\n    /**\n     * @param  {string} id\n     * @return {number} index\n     */\n    mapIdToIndex: function (id) {\n        // A feature is implemented:\n        // index is monotone increasing with the sequence of\n        // input id at the first time.\n        // This feature can make sure that each data item and its\n        // mapped color have the same index between data list and\n        // color list at the beginning, which is useful for user\n        // to adjust data-color mapping.\n\n        /**\n         * @private\n         * @type {Object}\n         */\n        var idIndexMap = this._idIndexMap;\n\n        if (!idIndexMap) {\n            idIndexMap = this._idIndexMap = createHashMap();\n            /**\n             * @private\n             * @type {number}\n             */\n            this._idIndexMapCount = 0;\n        }\n\n        var index = idIndexMap.get(id);\n        if (index == null) {\n            idIndexMap.set(id, index = this._idIndexMapCount++);\n        }\n\n        return index;\n    },\n\n    getViewRoot: function () {\n        return this._viewRoot;\n    },\n\n    /**\n     * @param {module:echarts/data/Tree~Node} [viewRoot]\n     */\n    resetViewRoot: function (viewRoot) {\n        viewRoot\n            ? (this._viewRoot = viewRoot)\n            : (viewRoot = this._viewRoot);\n\n        var root = this.getRawData().tree.root;\n\n        if (!viewRoot\n            || (viewRoot !== root && !root.contains(viewRoot))\n        ) {\n            this._viewRoot = root;\n        }\n    }\n});\n\n/**\n * @param {Object} dataNode\n */\nfunction completeTreeValue(dataNode) {\n    // Postorder travel tree.\n    // If value of none-leaf node is not set,\n    // calculate it by suming up the value of all children.\n    var sum = 0;\n\n    each$1(dataNode.children, function (child) {\n\n        completeTreeValue(child);\n\n        var childValue = child.value;\n        isArray(childValue) && (childValue = childValue[0]);\n\n        sum += childValue;\n    });\n\n    var thisValue = dataNode.value;\n    if (isArray(thisValue)) {\n        thisValue = thisValue[0];\n    }\n\n    if (thisValue == null || isNaN(thisValue)) {\n        thisValue = sum;\n    }\n    // Value should not less than 0.\n    if (thisValue < 0) {\n        thisValue = 0;\n    }\n\n    isArray(dataNode.value)\n        ? (dataNode.value[0] = thisValue)\n        : (dataNode.value = thisValue);\n}\n\n/**\n * set default to level configuration\n */\nfunction setDefault(levels, ecModel) {\n    var globalColorList = ecModel.get('color');\n\n    if (!globalColorList) {\n        return;\n    }\n\n    levels = levels || [];\n    var hasColorDefine;\n    each$1(levels, function (levelDefine) {\n        var model = new Model(levelDefine);\n        var modelColor = model.get('color');\n\n        if (model.get('itemStyle.color')\n            || (modelColor && modelColor !== 'none')\n        ) {\n            hasColorDefine = true;\n        }\n    });\n\n    if (!hasColorDefine) {\n        var level0 = levels[0] || (levels[0] = {});\n        level0.color = globalColorList.slice();\n    }\n\n    return levels;\n}\n\nvar TEXT_PADDING = 8;\nvar ITEM_GAP = 8;\nvar ARRAY_LENGTH = 5;\n\nfunction Breadcrumb(containerGroup) {\n    /**\n     * @private\n     * @type {module:zrender/container/Group}\n     */\n    this.group = new Group();\n\n    containerGroup.add(this.group);\n}\n\nBreadcrumb.prototype = {\n\n    constructor: Breadcrumb,\n\n    render: function (seriesModel, api, targetNode, onSelect) {\n        var model = seriesModel.getModel('breadcrumb');\n        var thisGroup = this.group;\n\n        thisGroup.removeAll();\n\n        if (!model.get('show') || !targetNode) {\n            return;\n        }\n\n        var normalStyleModel = model.getModel('itemStyle');\n        // var emphasisStyleModel = model.getModel('emphasis.itemStyle');\n        var textStyleModel = normalStyleModel.getModel('textStyle');\n\n        var layoutParam = {\n            pos: {\n                left: model.get('left'),\n                right: model.get('right'),\n                top: model.get('top'),\n                bottom: model.get('bottom')\n            },\n            box: {\n                width: api.getWidth(),\n                height: api.getHeight()\n            },\n            emptyItemWidth: model.get('emptyItemWidth'),\n            totalWidth: 0,\n            renderList: []\n        };\n\n        this._prepare(targetNode, layoutParam, textStyleModel);\n        this._renderContent(seriesModel, layoutParam, normalStyleModel, textStyleModel, onSelect);\n\n        positionElement(thisGroup, layoutParam.pos, layoutParam.box);\n    },\n\n    /**\n     * Prepare render list and total width\n     * @private\n     */\n    _prepare: function (targetNode, layoutParam, textStyleModel) {\n        for (var node = targetNode; node; node = node.parentNode) {\n            var text = node.getModel().get('name');\n            var textRect = textStyleModel.getTextRect(text);\n            var itemWidth = Math.max(\n                textRect.width + TEXT_PADDING * 2,\n                layoutParam.emptyItemWidth\n            );\n            layoutParam.totalWidth += itemWidth + ITEM_GAP;\n            layoutParam.renderList.push({node: node, text: text, width: itemWidth});\n        }\n    },\n\n    /**\n     * @private\n     */\n    _renderContent: function (\n        seriesModel, layoutParam, normalStyleModel, textStyleModel, onSelect\n    ) {\n        // Start rendering.\n        var lastX = 0;\n        var emptyItemWidth = layoutParam.emptyItemWidth;\n        var height = seriesModel.get('breadcrumb.height');\n        var availableSize = getAvailableSize(layoutParam.pos, layoutParam.box);\n        var totalWidth = layoutParam.totalWidth;\n        var renderList = layoutParam.renderList;\n\n        for (var i = renderList.length - 1; i >= 0; i--) {\n            var item = renderList[i];\n            var itemNode = item.node;\n            var itemWidth = item.width;\n            var text = item.text;\n\n            // Hdie text and shorten width if necessary.\n            if (totalWidth > availableSize.width) {\n                totalWidth -= itemWidth - emptyItemWidth;\n                itemWidth = emptyItemWidth;\n                text = null;\n            }\n\n            var el = new Polygon({\n                shape: {\n                    points: makeItemPoints(\n                        lastX, 0, itemWidth, height,\n                        i === renderList.length - 1, i === 0\n                    )\n                },\n                style: defaults(\n                    normalStyleModel.getItemStyle(),\n                    {\n                        lineJoin: 'bevel',\n                        text: text,\n                        textFill: textStyleModel.getTextColor(),\n                        textFont: textStyleModel.getFont()\n                    }\n                ),\n                z: 10,\n                onclick: curry(onSelect, itemNode)\n            });\n            this.group.add(el);\n\n            packEventData(el, seriesModel, itemNode);\n\n            lastX += itemWidth + ITEM_GAP;\n        }\n    },\n\n    /**\n     * @override\n     */\n    remove: function () {\n        this.group.removeAll();\n    }\n};\n\nfunction makeItemPoints(x, y, itemWidth, itemHeight, head, tail) {\n    var points = [\n        [head ? x : x - ARRAY_LENGTH, y],\n        [x + itemWidth, y],\n        [x + itemWidth, y + itemHeight],\n        [head ? x : x - ARRAY_LENGTH, y + itemHeight]\n    ];\n    !tail && points.splice(2, 0, [x + itemWidth + ARRAY_LENGTH, y + itemHeight / 2]);\n    !head && points.push([x, y + itemHeight / 2]);\n    return points;\n}\n\n// Package custom mouse event.\nfunction packEventData(el, seriesModel, itemNode) {\n    el.eventData = {\n        componentType: 'series',\n        componentSubType: 'treemap',\n        seriesIndex: seriesModel.componentIndex,\n        seriesName: seriesModel.name,\n        seriesType: 'treemap',\n        selfType: 'breadcrumb', // Distinguish with click event on treemap node.\n        nodeData: {\n            dataIndex: itemNode && itemNode.dataIndex,\n            name: itemNode && itemNode.name\n        },\n        treePathInfo: itemNode && wrapTreePathInfo(itemNode, seriesModel)\n    };\n}\n\n/**\n * @param {number} [time=500] Time in ms\n * @param {string} [easing='linear']\n * @param {number} [delay=0]\n * @param {Function} [callback]\n *\n * @example\n *  // Animate position\n *  animation\n *      .createWrap()\n *      .add(el1, {position: [10, 10]})\n *      .add(el2, {shape: {width: 500}, style: {fill: 'red'}}, 400)\n *      .done(function () { // done })\n *      .start('cubicOut');\n */\nfunction createWrap() {\n\n    var storage = [];\n    var elExistsMap = {};\n    var doneCallback;\n\n    return {\n\n        /**\n         * Caution: a el can only be added once, otherwise 'done'\n         * might not be called. This method checks this (by el.id),\n         * suppresses adding and returns false when existing el found.\n         *\n         * @param {modele:zrender/Element} el\n         * @param {Object} target\n         * @param {number} [time=500]\n         * @param {number} [delay=0]\n         * @param {string} [easing='linear']\n         * @return {boolean} Whether adding succeeded.\n         *\n         * @example\n         *     add(el, target, time, delay, easing);\n         *     add(el, target, time, easing);\n         *     add(el, target, time);\n         *     add(el, target);\n         */\n        add: function (el, target, time, delay, easing) {\n            if (isString(delay)) {\n                easing = delay;\n                delay = 0;\n            }\n\n            if (elExistsMap[el.id]) {\n                return false;\n            }\n            elExistsMap[el.id] = 1;\n\n            storage.push(\n                {el: el, target: target, time: time, delay: delay, easing: easing}\n            );\n\n            return true;\n        },\n\n        /**\n         * Only execute when animation finished. Will not execute when any\n         * of 'stop' or 'stopAnimation' called.\n         *\n         * @param {Function} callback\n         */\n        done: function (callback) {\n            doneCallback = callback;\n            return this;\n        },\n\n        /**\n         * Will stop exist animation firstly.\n         */\n        start: function () {\n            var count = storage.length;\n\n            for (var i = 0, len = storage.length; i < len; i++) {\n                var item = storage[i];\n                item.el.animateTo(item.target, item.time, item.delay, item.easing, done);\n            }\n\n            return this;\n\n            function done() {\n                count--;\n                if (!count) {\n                    storage.length = 0;\n                    elExistsMap = {};\n                    doneCallback && doneCallback();\n                }\n            }\n        }\n    };\n}\n\nvar bind$1 = bind;\nvar Group$2 = Group;\nvar Rect$1 = Rect;\nvar each$9 = each$1;\n\nvar DRAG_THRESHOLD = 3;\nvar PATH_LABEL_NOAMAL = ['label'];\nvar PATH_LABEL_EMPHASIS = ['emphasis', 'label'];\nvar PATH_UPPERLABEL_NORMAL = ['upperLabel'];\nvar PATH_UPPERLABEL_EMPHASIS = ['emphasis', 'upperLabel'];\nvar Z_BASE = 10; // Should bigger than every z.\nvar Z_BG = 1;\nvar Z_CONTENT = 2;\n\nvar getItemStyleEmphasis = makeStyleMapper([\n    ['fill', 'color'],\n    // `borderColor` and `borderWidth` has been occupied,\n    // so use `stroke` to indicate the stroke of the rect.\n    ['stroke', 'strokeColor'],\n    ['lineWidth', 'strokeWidth'],\n    ['shadowBlur'],\n    ['shadowOffsetX'],\n    ['shadowOffsetY'],\n    ['shadowColor']\n]);\nvar getItemStyleNormal = function (model) {\n    // Normal style props should include emphasis style props.\n    var itemStyle = getItemStyleEmphasis(model);\n    // Clear styles set by emphasis.\n    itemStyle.stroke = itemStyle.fill = itemStyle.lineWidth = null;\n    return itemStyle;\n};\n\nextendChartView({\n\n    type: 'treemap',\n\n    /**\n     * @override\n     */\n    init: function (o, api) {\n\n        /**\n         * @private\n         * @type {module:zrender/container/Group}\n         */\n        this._containerGroup;\n\n        /**\n         * @private\n         * @type {Object.<string, Array.<module:zrender/container/Group>>}\n         */\n        this._storage = createStorage();\n\n        /**\n         * @private\n         * @type {module:echarts/data/Tree}\n         */\n        this._oldTree;\n\n        /**\n         * @private\n         * @type {module:echarts/chart/treemap/Breadcrumb}\n         */\n        this._breadcrumb;\n\n        /**\n         * @private\n         * @type {module:echarts/component/helper/RoamController}\n         */\n        this._controller;\n\n        /**\n         * 'ready', 'animating'\n         * @private\n         */\n        this._state = 'ready';\n    },\n\n    /**\n     * @override\n     */\n    render: function (seriesModel, ecModel, api, payload) {\n\n        var models = ecModel.findComponents({\n            mainType: 'series', subType: 'treemap', query: payload\n        });\n        if (indexOf(models, seriesModel) < 0) {\n            return;\n        }\n\n        this.seriesModel = seriesModel;\n        this.api = api;\n        this.ecModel = ecModel;\n\n        var types = ['treemapZoomToNode', 'treemapRootToNode'];\n        var targetInfo = retrieveTargetInfo(payload, types, seriesModel);\n        var payloadType = payload && payload.type;\n        var layoutInfo = seriesModel.layoutInfo;\n        var isInit = !this._oldTree;\n        var thisStorage = this._storage;\n\n        // Mark new root when action is treemapRootToNode.\n        var reRoot = (payloadType === 'treemapRootToNode' && targetInfo && thisStorage)\n            ? {\n                rootNodeGroup: thisStorage.nodeGroup[targetInfo.node.getRawIndex()],\n                direction: payload.direction\n            }\n            : null;\n\n        var containerGroup = this._giveContainerGroup(layoutInfo);\n\n        var renderResult = this._doRender(containerGroup, seriesModel, reRoot);\n        (\n            !isInit && (\n                !payloadType\n                || payloadType === 'treemapZoomToNode'\n                || payloadType === 'treemapRootToNode'\n            )\n        )\n            ? this._doAnimation(containerGroup, renderResult, seriesModel, reRoot)\n            : renderResult.renderFinally();\n\n        this._resetController(api);\n\n        this._renderBreadcrumb(seriesModel, api, targetInfo);\n    },\n\n    /**\n     * @private\n     */\n    _giveContainerGroup: function (layoutInfo) {\n        var containerGroup = this._containerGroup;\n        if (!containerGroup) {\n            // FIXME\n            // containerGroupclipclip\n            containerGroup = this._containerGroup = new Group$2();\n            this._initEvents(containerGroup);\n            this.group.add(containerGroup);\n        }\n        containerGroup.attr('position', [layoutInfo.x, layoutInfo.y]);\n\n        return containerGroup;\n    },\n\n    /**\n     * @private\n     */\n    _doRender: function (containerGroup, seriesModel, reRoot) {\n        var thisTree = seriesModel.getData().tree;\n        var oldTree = this._oldTree;\n\n        // Clear last shape records.\n        var lastsForAnimation = createStorage();\n        var thisStorage = createStorage();\n        var oldStorage = this._storage;\n        var willInvisibleEls = [];\n        var doRenderNode = curry(\n            renderNode, seriesModel,\n            thisStorage, oldStorage, reRoot,\n            lastsForAnimation, willInvisibleEls\n        );\n\n        // Notice: when thisTree and oldTree are the same tree (see list.cloneShallow),\n        // the oldTree is actually losted, so we can not find all of the old graphic\n        // elements from tree. So we use this stragegy: make element storage, move\n        // from old storage to new storage, clear old storage.\n\n        dualTravel(\n            thisTree.root ? [thisTree.root] : [],\n            (oldTree && oldTree.root) ? [oldTree.root] : [],\n            containerGroup,\n            thisTree === oldTree || !oldTree,\n            0\n        );\n\n        // Process all removing.\n        var willDeleteEls = clearStorage(oldStorage);\n\n        this._oldTree = thisTree;\n        this._storage = thisStorage;\n\n        return {\n            lastsForAnimation: lastsForAnimation,\n            willDeleteEls: willDeleteEls,\n            renderFinally: renderFinally\n        };\n\n        function dualTravel(thisViewChildren, oldViewChildren, parentGroup, sameTree, depth) {\n            // When 'render' is triggered by action,\n            // 'this' and 'old' may be the same tree,\n            // we use rawIndex in that case.\n            if (sameTree) {\n                oldViewChildren = thisViewChildren;\n                each$9(thisViewChildren, function (child, index) {\n                    !child.isRemoved() && processNode(index, index);\n                });\n            }\n            // Diff hierarchically (diff only in each subtree, but not whole).\n            // because, consistency of view is important.\n            else {\n                (new DataDiffer(oldViewChildren, thisViewChildren, getKey, getKey))\n                    .add(processNode)\n                    .update(processNode)\n                    .remove(curry(processNode, null))\n                    .execute();\n            }\n\n            function getKey(node) {\n                // Identify by name or raw index.\n                return node.getId();\n            }\n\n            function processNode(newIndex, oldIndex) {\n                var thisNode = newIndex != null ? thisViewChildren[newIndex] : null;\n                var oldNode = oldIndex != null ? oldViewChildren[oldIndex] : null;\n\n                var group = doRenderNode(thisNode, oldNode, parentGroup, depth);\n\n                group && dualTravel(\n                    thisNode && thisNode.viewChildren || [],\n                    oldNode && oldNode.viewChildren || [],\n                    group,\n                    sameTree,\n                    depth + 1\n                );\n            }\n        }\n\n        function clearStorage(storage) {\n            var willDeleteEls = createStorage();\n            storage && each$9(storage, function (store, storageName) {\n                var delEls = willDeleteEls[storageName];\n                each$9(store, function (el) {\n                    el && (delEls.push(el), el.__tmWillDelete = 1);\n                });\n            });\n            return willDeleteEls;\n        }\n\n        function renderFinally() {\n            each$9(willDeleteEls, function (els) {\n                each$9(els, function (el) {\n                    el.parent && el.parent.remove(el);\n                });\n            });\n            each$9(willInvisibleEls, function (el) {\n                el.invisible = true;\n                // Setting invisible is for optimizing, so no need to set dirty,\n                // just mark as invisible.\n                el.dirty();\n            });\n        }\n    },\n\n    /**\n     * @private\n     */\n    _doAnimation: function (containerGroup, renderResult, seriesModel, reRoot) {\n        if (!seriesModel.get('animation')) {\n            return;\n        }\n\n        var duration = seriesModel.get('animationDurationUpdate');\n        var easing = seriesModel.get('animationEasing');\n        var animationWrap = createWrap();\n\n        // Make delete animations.\n        each$9(renderResult.willDeleteEls, function (store, storageName) {\n            each$9(store, function (el, rawIndex) {\n                if (el.invisible) {\n                    return;\n                }\n\n                var parent = el.parent; // Always has parent, and parent is nodeGroup.\n                var target;\n\n                if (reRoot && reRoot.direction === 'drillDown') {\n                    target = parent === reRoot.rootNodeGroup\n                        // This is the content element of view root.\n                        // Only `content` will enter this branch, because\n                        // `background` and `nodeGroup` will not be deleted.\n                        ? {\n                            shape: {\n                                x: 0,\n                                y: 0,\n                                width: parent.__tmNodeWidth,\n                                height: parent.__tmNodeHeight\n                            },\n                            style: {\n                                opacity: 0\n                            }\n                        }\n                        // Others.\n                        : {style: {opacity: 0}};\n                }\n                else {\n                    var targetX = 0;\n                    var targetY = 0;\n\n                    if (!parent.__tmWillDelete) {\n                        // Let node animate to right-bottom corner, cooperating with fadeout,\n                        // which is appropriate for user understanding.\n                        // Divided by 2 for reRoot rolling up effect.\n                        targetX = parent.__tmNodeWidth / 2;\n                        targetY = parent.__tmNodeHeight / 2;\n                    }\n\n                    target = storageName === 'nodeGroup'\n                        ? {position: [targetX, targetY], style: {opacity: 0}}\n                        : {\n                            shape: {x: targetX, y: targetY, width: 0, height: 0},\n                            style: {opacity: 0}\n                        };\n                }\n\n                target && animationWrap.add(el, target, duration, easing);\n            });\n        });\n\n        // Make other animations\n        each$9(this._storage, function (store, storageName) {\n            each$9(store, function (el, rawIndex) {\n                var last = renderResult.lastsForAnimation[storageName][rawIndex];\n                var target = {};\n\n                if (!last) {\n                    return;\n                }\n\n                if (storageName === 'nodeGroup') {\n                    if (last.old) {\n                        target.position = el.position.slice();\n                        el.attr('position', last.old);\n                    }\n                }\n                else {\n                    if (last.old) {\n                        target.shape = extend({}, el.shape);\n                        el.setShape(last.old);\n                    }\n\n                    if (last.fadein) {\n                        el.setStyle('opacity', 0);\n                        target.style = {opacity: 1};\n                    }\n                    // When animation is stopped for succedent animation starting,\n                    // el.style.opacity might not be 1\n                    else if (el.style.opacity !== 1) {\n                        target.style = {opacity: 1};\n                    }\n                }\n\n                animationWrap.add(el, target, duration, easing);\n            });\n        }, this);\n\n        this._state = 'animating';\n\n        animationWrap\n            .done(bind$1(function () {\n                this._state = 'ready';\n                renderResult.renderFinally();\n            }, this))\n            .start();\n    },\n\n    /**\n     * @private\n     */\n    _resetController: function (api) {\n        var controller = this._controller;\n\n        // Init controller.\n        if (!controller) {\n            controller = this._controller = new RoamController(api.getZr());\n            controller.enable(this.seriesModel.get('roam'));\n            controller.on('pan', bind$1(this._onPan, this));\n            controller.on('zoom', bind$1(this._onZoom, this));\n        }\n\n        var rect = new BoundingRect(0, 0, api.getWidth(), api.getHeight());\n        controller.setPointerChecker(function (e, x, y) {\n            return rect.contain(x, y);\n        });\n    },\n\n    /**\n     * @private\n     */\n    _clearController: function () {\n        var controller = this._controller;\n        if (controller) {\n            controller.dispose();\n            controller = null;\n        }\n    },\n\n    /**\n     * @private\n     */\n    _onPan: function (dx, dy) {\n        if (this._state !== 'animating'\n            && (Math.abs(dx) > DRAG_THRESHOLD || Math.abs(dy) > DRAG_THRESHOLD)\n        ) {\n            // These param must not be cached.\n            var root = this.seriesModel.getData().tree.root;\n\n            if (!root) {\n                return;\n            }\n\n            var rootLayout = root.getLayout();\n\n            if (!rootLayout) {\n                return;\n            }\n\n            this.api.dispatchAction({\n                type: 'treemapMove',\n                from: this.uid,\n                seriesId: this.seriesModel.id,\n                rootRect: {\n                    x: rootLayout.x + dx, y: rootLayout.y + dy,\n                    width: rootLayout.width, height: rootLayout.height\n                }\n            });\n        }\n    },\n\n    /**\n     * @private\n     */\n    _onZoom: function (scale, mouseX, mouseY) {\n        if (this._state !== 'animating') {\n            // These param must not be cached.\n            var root = this.seriesModel.getData().tree.root;\n\n            if (!root) {\n                return;\n            }\n\n            var rootLayout = root.getLayout();\n\n            if (!rootLayout) {\n                return;\n            }\n\n            var rect = new BoundingRect(\n                rootLayout.x, rootLayout.y, rootLayout.width, rootLayout.height\n            );\n            var layoutInfo = this.seriesModel.layoutInfo;\n\n            // Transform mouse coord from global to containerGroup.\n            mouseX -= layoutInfo.x;\n            mouseY -= layoutInfo.y;\n\n            // Scale root bounding rect.\n            var m = create$1();\n            translate(m, m, [-mouseX, -mouseY]);\n            scale$1(m, m, [scale, scale]);\n            translate(m, m, [mouseX, mouseY]);\n\n            rect.applyTransform(m);\n\n            this.api.dispatchAction({\n                type: 'treemapRender',\n                from: this.uid,\n                seriesId: this.seriesModel.id,\n                rootRect: {\n                    x: rect.x, y: rect.y,\n                    width: rect.width, height: rect.height\n                }\n            });\n        }\n    },\n\n    /**\n     * @private\n     */\n    _initEvents: function (containerGroup) {\n        containerGroup.on('click', function (e) {\n            if (this._state !== 'ready') {\n                return;\n            }\n\n            var nodeClick = this.seriesModel.get('nodeClick', true);\n\n            if (!nodeClick) {\n                return;\n            }\n\n            var targetInfo = this.findTarget(e.offsetX, e.offsetY);\n\n            if (!targetInfo) {\n                return;\n            }\n\n            var node = targetInfo.node;\n            if (node.getLayout().isLeafRoot) {\n                this._rootToNode(targetInfo);\n            }\n            else {\n                if (nodeClick === 'zoomToNode') {\n                    this._zoomToNode(targetInfo);\n                }\n                else if (nodeClick === 'link') {\n                    var itemModel = node.hostTree.data.getItemModel(node.dataIndex);\n                    var link = itemModel.get('link', true);\n                    var linkTarget = itemModel.get('target', true) || 'blank';\n                    link && window.open(link, linkTarget);\n                }\n            }\n\n        }, this);\n    },\n\n    /**\n     * @private\n     */\n    _renderBreadcrumb: function (seriesModel, api, targetInfo) {\n        if (!targetInfo) {\n            targetInfo = seriesModel.get('leafDepth', true) != null\n                ? {node: seriesModel.getViewRoot()}\n                // FIXME\n                // better way?\n                // Find breadcrumb tail on center of containerGroup.\n                : this.findTarget(api.getWidth() / 2, api.getHeight() / 2);\n\n            if (!targetInfo) {\n                targetInfo = {node: seriesModel.getData().tree.root};\n            }\n        }\n\n        (this._breadcrumb || (this._breadcrumb = new Breadcrumb(this.group)))\n            .render(seriesModel, api, targetInfo.node, bind$1(onSelect, this));\n\n        function onSelect(node) {\n            if (this._state !== 'animating') {\n                aboveViewRoot(seriesModel.getViewRoot(), node)\n                    ? this._rootToNode({node: node})\n                    : this._zoomToNode({node: node});\n            }\n        }\n    },\n\n    /**\n     * @override\n     */\n    remove: function () {\n        this._clearController();\n        this._containerGroup && this._containerGroup.removeAll();\n        this._storage = createStorage();\n        this._state = 'ready';\n        this._breadcrumb && this._breadcrumb.remove();\n    },\n\n    dispose: function () {\n        this._clearController();\n    },\n\n    /**\n     * @private\n     */\n    _zoomToNode: function (targetInfo) {\n        this.api.dispatchAction({\n            type: 'treemapZoomToNode',\n            from: this.uid,\n            seriesId: this.seriesModel.id,\n            targetNode: targetInfo.node\n        });\n    },\n\n    /**\n     * @private\n     */\n    _rootToNode: function (targetInfo) {\n        this.api.dispatchAction({\n            type: 'treemapRootToNode',\n            from: this.uid,\n            seriesId: this.seriesModel.id,\n            targetNode: targetInfo.node\n        });\n    },\n\n    /**\n     * @public\n     * @param {number} x Global coord x.\n     * @param {number} y Global coord y.\n     * @return {Object} info If not found, return undefined;\n     * @return {number} info.node Target node.\n     * @return {number} info.offsetX x refer to target node.\n     * @return {number} info.offsetY y refer to target node.\n     */\n    findTarget: function (x, y) {\n        var targetInfo;\n        var viewRoot = this.seriesModel.getViewRoot();\n\n        viewRoot.eachNode({attr: 'viewChildren', order: 'preorder'}, function (node) {\n            var bgEl = this._storage.background[node.getRawIndex()];\n            // If invisible, there might be no element.\n            if (bgEl) {\n                var point = bgEl.transformCoordToLocal(x, y);\n                var shape = bgEl.shape;\n\n                // For performance consideration, dont use 'getBoundingRect'.\n                if (shape.x <= point[0]\n                    && point[0] <= shape.x + shape.width\n                    && shape.y <= point[1]\n                    && point[1] <= shape.y + shape.height\n                ) {\n                    targetInfo = {node: node, offsetX: point[0], offsetY: point[1]};\n                }\n                else {\n                    return false; // Suppress visit subtree.\n                }\n            }\n        }, this);\n\n        return targetInfo;\n    }\n\n});\n\n/**\n * @inner\n */\nfunction createStorage() {\n    return {nodeGroup: [], background: [], content: []};\n}\n\n/**\n * @inner\n * @return Return undefined means do not travel further.\n */\nfunction renderNode(\n    seriesModel, thisStorage, oldStorage, reRoot,\n    lastsForAnimation, willInvisibleEls,\n    thisNode, oldNode, parentGroup, depth\n) {\n    // Whether under viewRoot.\n    if (!thisNode) {\n        // Deleting nodes will be performed finally. This method just find\n        // element from old storage, or create new element, set them to new\n        // storage, and set styles.\n        return;\n    }\n\n    // -------------------------------------------------------------------\n    // Start of closure variables available in \"Procedures in renderNode\".\n\n    var thisLayout = thisNode.getLayout();\n\n    if (!thisLayout || !thisLayout.isInView) {\n        return;\n    }\n\n    var thisWidth = thisLayout.width;\n    var thisHeight = thisLayout.height;\n    var borderWidth = thisLayout.borderWidth;\n    var thisInvisible = thisLayout.invisible;\n\n    var thisRawIndex = thisNode.getRawIndex();\n    var oldRawIndex = oldNode && oldNode.getRawIndex();\n\n    var thisViewChildren = thisNode.viewChildren;\n    var upperHeight = thisLayout.upperHeight;\n    var isParent = thisViewChildren && thisViewChildren.length;\n    var itemStyleNormalModel = thisNode.getModel('itemStyle');\n    var itemStyleEmphasisModel = thisNode.getModel('emphasis.itemStyle');\n\n    // End of closure ariables available in \"Procedures in renderNode\".\n    // -----------------------------------------------------------------\n\n    // Node group\n    var group = giveGraphic('nodeGroup', Group$2);\n\n    if (!group) {\n        return;\n    }\n\n    parentGroup.add(group);\n    // x,y are not set when el is above view root.\n    group.attr('position', [thisLayout.x || 0, thisLayout.y || 0]);\n    group.__tmNodeWidth = thisWidth;\n    group.__tmNodeHeight = thisHeight;\n\n    if (thisLayout.isAboveViewRoot) {\n        return group;\n    }\n\n    // Background\n    var bg = giveGraphic('background', Rect$1, depth, Z_BG);\n    bg && renderBackground(group, bg, isParent && thisLayout.upperHeight);\n\n    // No children, render content.\n    if (!isParent) {\n        var content = giveGraphic('content', Rect$1, depth, Z_CONTENT);\n        content && renderContent(group, content);\n    }\n\n    return group;\n\n    // ----------------------------\n    // | Procedures in renderNode |\n    // ----------------------------\n\n    function renderBackground(group, bg, useUpperLabel) {\n        // For tooltip.\n        bg.dataIndex = thisNode.dataIndex;\n        bg.seriesIndex = seriesModel.seriesIndex;\n\n        bg.setShape({x: 0, y: 0, width: thisWidth, height: thisHeight});\n        var visualBorderColor = thisNode.getVisual('borderColor', true);\n        var emphasisBorderColor = itemStyleEmphasisModel.get('borderColor');\n\n        updateStyle(bg, function () {\n            var normalStyle = getItemStyleNormal(itemStyleNormalModel);\n            normalStyle.fill = visualBorderColor;\n            var emphasisStyle = getItemStyleEmphasis(itemStyleEmphasisModel);\n            emphasisStyle.fill = emphasisBorderColor;\n\n            if (useUpperLabel) {\n                var upperLabelWidth = thisWidth - 2 * borderWidth;\n\n                prepareText(\n                    normalStyle, emphasisStyle, visualBorderColor, upperLabelWidth, upperHeight,\n                    {x: borderWidth, y: 0, width: upperLabelWidth, height: upperHeight}\n                );\n            }\n            // For old bg.\n            else {\n                normalStyle.text = emphasisStyle.text = null;\n            }\n\n            bg.setStyle(normalStyle);\n            setHoverStyle(bg, emphasisStyle);\n        });\n\n        group.add(bg);\n    }\n\n    function renderContent(group, content) {\n        // For tooltip.\n        content.dataIndex = thisNode.dataIndex;\n        content.seriesIndex = seriesModel.seriesIndex;\n\n        var contentWidth = Math.max(thisWidth - 2 * borderWidth, 0);\n        var contentHeight = Math.max(thisHeight - 2 * borderWidth, 0);\n\n        content.culling = true;\n        content.setShape({\n            x: borderWidth,\n            y: borderWidth,\n            width: contentWidth,\n            height: contentHeight\n        });\n\n        var visualColor = thisNode.getVisual('color', true);\n        updateStyle(content, function () {\n            var normalStyle = getItemStyleNormal(itemStyleNormalModel);\n            normalStyle.fill = visualColor;\n            var emphasisStyle = getItemStyleEmphasis(itemStyleEmphasisModel);\n\n            prepareText(normalStyle, emphasisStyle, visualColor, contentWidth, contentHeight);\n\n            content.setStyle(normalStyle);\n            setHoverStyle(content, emphasisStyle);\n        });\n\n        group.add(content);\n    }\n\n    function updateStyle(element, cb) {\n        if (!thisInvisible) {\n            // If invisible, do not set visual, otherwise the element will\n            // change immediately before animation. We think it is OK to\n            // remain its origin color when moving out of the view window.\n            cb();\n\n            if (!element.__tmWillVisible) {\n                element.invisible = false;\n            }\n        }\n        else {\n            // Delay invisible setting utill animation finished,\n            // avoid element vanish suddenly before animation.\n            !element.invisible && willInvisibleEls.push(element);\n        }\n    }\n\n    function prepareText(normalStyle, emphasisStyle, visualColor, width, height, upperLabelRect) {\n        var nodeModel = thisNode.getModel();\n        var text = retrieve(\n            seriesModel.getFormattedLabel(\n                thisNode.dataIndex, 'normal', null, null, upperLabelRect ? 'upperLabel' : 'label'\n            ),\n            nodeModel.get('name')\n        );\n        if (!upperLabelRect && thisLayout.isLeafRoot) {\n            var iconChar = seriesModel.get('drillDownIcon', true);\n            text = iconChar ? iconChar + ' ' + text : text;\n        }\n\n        var normalLabelModel = nodeModel.getModel(\n            upperLabelRect ? PATH_UPPERLABEL_NORMAL : PATH_LABEL_NOAMAL\n        );\n        var emphasisLabelModel = nodeModel.getModel(\n            upperLabelRect ? PATH_UPPERLABEL_EMPHASIS : PATH_LABEL_EMPHASIS\n        );\n\n        var isShow = normalLabelModel.getShallow('show');\n\n        setLabelStyle(\n            normalStyle, emphasisStyle, normalLabelModel, emphasisLabelModel,\n            {\n                defaultText: isShow ? text : null,\n                autoColor: visualColor,\n                isRectText: true\n            }\n        );\n\n        upperLabelRect && (normalStyle.textRect = clone(upperLabelRect));\n\n        normalStyle.truncate = (isShow && normalLabelModel.get('ellipsis'))\n            ? {\n                outerWidth: width,\n                outerHeight: height,\n                minChar: 2\n            }\n            : null;\n    }\n\n    function giveGraphic(storageName, Ctor, depth, z) {\n        var element = oldRawIndex != null && oldStorage[storageName][oldRawIndex];\n        var lasts = lastsForAnimation[storageName];\n\n        if (element) {\n            // Remove from oldStorage\n            oldStorage[storageName][oldRawIndex] = null;\n            prepareAnimationWhenHasOld(lasts, element, storageName);\n        }\n        // If invisible and no old element, do not create new element (for optimizing).\n        else if (!thisInvisible) {\n            element = new Ctor({z: calculateZ(depth, z)});\n            element.__tmDepth = depth;\n            element.__tmStorageName = storageName;\n            prepareAnimationWhenNoOld(lasts, element, storageName);\n        }\n\n        // Set to thisStorage\n        return (thisStorage[storageName][thisRawIndex] = element);\n    }\n\n    function prepareAnimationWhenHasOld(lasts, element, storageName) {\n        var lastCfg = lasts[thisRawIndex] = {};\n        lastCfg.old = storageName === 'nodeGroup'\n            ? element.position.slice()\n            : extend({}, element.shape);\n    }\n\n    // If a element is new, we need to find the animation start point carefully,\n    // otherwise it will looks strange when 'zoomToNode'.\n    function prepareAnimationWhenNoOld(lasts, element, storageName) {\n        var lastCfg = lasts[thisRawIndex] = {};\n        var parentNode = thisNode.parentNode;\n\n        if (parentNode && (!reRoot || reRoot.direction === 'drillDown')) {\n            var parentOldX = 0;\n            var parentOldY = 0;\n\n            // New nodes appear from right-bottom corner in 'zoomToNode' animation.\n            // For convenience, get old bounding rect from background.\n            var parentOldBg = lastsForAnimation.background[parentNode.getRawIndex()];\n            if (!reRoot && parentOldBg && parentOldBg.old) {\n                parentOldX = parentOldBg.old.width;\n                parentOldY = parentOldBg.old.height;\n            }\n\n            // When no parent old shape found, its parent is new too,\n            // so we can just use {x:0, y:0}.\n            lastCfg.old = storageName === 'nodeGroup'\n                ? [0, parentOldY]\n                : {x: parentOldX, y: parentOldY, width: 0, height: 0};\n        }\n\n        // Fade in, user can be aware that these nodes are new.\n        lastCfg.fadein = storageName !== 'nodeGroup';\n    }\n}\n\n// We can not set all backgroud with the same z, Because the behaviour of\n// drill down and roll up differ background creation sequence from tree\n// hierarchy sequence, which cause that lowser background element overlap\n// upper ones. So we calculate z based on depth.\n// Moreover, we try to shrink down z interval to [0, 1] to avoid that\n// treemap with large z overlaps other components.\nfunction calculateZ(depth, zInLevel) {\n    var zb = depth * Z_BASE + zInLevel;\n    return (zb - 1) / zb;\n}\n\n/**\n * @file Treemap action\n */\n\nvar noop$1 = function () {};\n\nvar actionTypes = [\n    'treemapZoomToNode',\n    'treemapRender',\n    'treemapMove'\n];\n\nfor (var i$2 = 0; i$2 < actionTypes.length; i$2++) {\n    registerAction({type: actionTypes[i$2], update: 'updateView'}, noop$1);\n}\n\nregisterAction(\n    {type: 'treemapRootToNode', update: 'updateView'},\n    function (payload, ecModel) {\n\n        ecModel.eachComponent(\n            {mainType: 'series', subType: 'treemap', query: payload},\n            handleRootToNode\n        );\n\n        function handleRootToNode(model, index) {\n            var types = ['treemapZoomToNode', 'treemapRootToNode'];\n            var targetInfo = retrieveTargetInfo(payload, types, model);\n\n            if (targetInfo) {\n                var originViewRoot = model.getViewRoot();\n                if (originViewRoot) {\n                    payload.direction = aboveViewRoot(originViewRoot, targetInfo.node)\n                        ? 'rollUp' : 'drillDown';\n                }\n                model.resetViewRoot(targetInfo.node);\n            }\n        }\n    }\n);\n\nvar each$10 = each$1;\nvar isObject$5 = isObject$1;\n\nvar CATEGORY_DEFAULT_VISUAL_INDEX = -1;\n\n/**\n * @param {Object} option\n * @param {string} [option.type] See visualHandlers.\n * @param {string} [option.mappingMethod] 'linear' or 'piecewise' or 'category' or 'fixed'\n * @param {Array.<number>=} [option.dataExtent] [minExtent, maxExtent],\n *                                              required when mappingMethod is 'linear'\n * @param {Array.<Object>=} [option.pieceList] [\n *                                             {value: someValue},\n *                                             {interval: [min1, max1], visual: {...}},\n *                                             {interval: [min2, max2]}\n *                                             ],\n *                                            required when mappingMethod is 'piecewise'.\n *                                            Visual for only each piece can be specified.\n * @param {Array.<string|Object>=} [option.categories] ['cate1', 'cate2']\n *                                            required when mappingMethod is 'category'.\n *                                            If no option.categories, categories is set\n *                                            as [0, 1, 2, ...].\n * @param {boolean} [option.loop=false] Whether loop mapping when mappingMethod is 'category'.\n * @param {(Array|Object|*)} [option.visual]  Visual data.\n *                                            when mappingMethod is 'category',\n *                                            visual data can be array or object\n *                                            (like: {cate1: '#222', none: '#fff'})\n *                                            or primary types (which represents\n *                                            defualt category visual), otherwise visual\n *                                            can be array or primary (which will be\n *                                            normalized to array).\n *\n */\nvar VisualMapping = function (option) {\n    var mappingMethod = option.mappingMethod;\n    var visualType = option.type;\n\n    /**\n     * @readOnly\n     * @type {Object}\n     */\n    var thisOption = this.option = clone(option);\n\n    /**\n     * @readOnly\n     * @type {string}\n     */\n    this.type = visualType;\n\n    /**\n     * @readOnly\n     * @type {string}\n     */\n    this.mappingMethod = mappingMethod;\n\n    /**\n     * @private\n     * @type {Function}\n     */\n    this._normalizeData = normalizers[mappingMethod];\n\n    var visualHandler = visualHandlers[visualType];\n\n    /**\n     * @public\n     * @type {Function}\n     */\n    this.applyVisual = visualHandler.applyVisual;\n\n    /**\n     * @public\n     * @type {Function}\n     */\n    this.getColorMapper = visualHandler.getColorMapper;\n\n    /**\n     * @private\n     * @type {Function}\n     */\n    this._doMap = visualHandler._doMap[mappingMethod];\n\n    if (mappingMethod === 'piecewise') {\n        normalizeVisualRange(thisOption);\n        preprocessForPiecewise(thisOption);\n    }\n    else if (mappingMethod === 'category') {\n        thisOption.categories\n            ? preprocessForSpecifiedCategory(thisOption)\n            // categories is ordinal when thisOption.categories not specified,\n            // which need no more preprocess except normalize visual.\n            : normalizeVisualRange(thisOption, true);\n    }\n    else { // mappingMethod === 'linear' or 'fixed'\n        assert$1(mappingMethod !== 'linear' || thisOption.dataExtent);\n        normalizeVisualRange(thisOption);\n    }\n};\n\nVisualMapping.prototype = {\n\n    constructor: VisualMapping,\n\n    mapValueToVisual: function (value) {\n        var normalized = this._normalizeData(value);\n        return this._doMap(normalized, value);\n    },\n\n    getNormalizer: function () {\n        return bind(this._normalizeData, this);\n    }\n};\n\nvar visualHandlers = VisualMapping.visualHandlers = {\n\n    color: {\n\n        applyVisual: makeApplyVisual('color'),\n\n        /**\n         * Create a mapper function\n         * @return {Function}\n         */\n        getColorMapper: function () {\n            var thisOption = this.option;\n\n            return bind(\n                thisOption.mappingMethod === 'category'\n                    ? function (value, isNormalized) {\n                        !isNormalized && (value = this._normalizeData(value));\n                        return doMapCategory.call(this, value);\n                    }\n                    : function (value, isNormalized, out) {\n                        // If output rgb array\n                        // which will be much faster and useful in pixel manipulation\n                        var returnRGBArray = !!out;\n                        !isNormalized && (value = this._normalizeData(value));\n                        out = fastLerp(value, thisOption.parsedVisual, out);\n                        return returnRGBArray ? out : stringify(out, 'rgba');\n                    },\n                this\n            );\n        },\n\n        _doMap: {\n            linear: function (normalized) {\n                return stringify(\n                    fastLerp(normalized, this.option.parsedVisual),\n                    'rgba'\n                );\n            },\n            category: doMapCategory,\n            piecewise: function (normalized, value) {\n                var result = getSpecifiedVisual.call(this, value);\n                if (result == null) {\n                    result = stringify(\n                        fastLerp(normalized, this.option.parsedVisual),\n                        'rgba'\n                    );\n                }\n                return result;\n            },\n            fixed: doMapFixed\n        }\n    },\n\n    colorHue: makePartialColorVisualHandler(function (color, value) {\n        return modifyHSL(color, value);\n    }),\n\n    colorSaturation: makePartialColorVisualHandler(function (color, value) {\n        return modifyHSL(color, null, value);\n    }),\n\n    colorLightness: makePartialColorVisualHandler(function (color, value) {\n        return modifyHSL(color, null, null, value);\n    }),\n\n    colorAlpha: makePartialColorVisualHandler(function (color, value) {\n        return modifyAlpha(color, value);\n    }),\n\n    opacity: {\n        applyVisual: makeApplyVisual('opacity'),\n        _doMap: makeDoMap([0, 1])\n    },\n\n    symbol: {\n        applyVisual: function (value, getter, setter) {\n            var symbolCfg = this.mapValueToVisual(value);\n            if (isString(symbolCfg)) {\n                setter('symbol', symbolCfg);\n            }\n            else if (isObject$5(symbolCfg)) {\n                for (var name in symbolCfg) {\n                    if (symbolCfg.hasOwnProperty(name)) {\n                        setter(name, symbolCfg[name]);\n                    }\n                }\n            }\n        },\n        _doMap: {\n            linear: doMapToArray,\n            category: doMapCategory,\n            piecewise: function (normalized, value) {\n                var result = getSpecifiedVisual.call(this, value);\n                if (result == null) {\n                    result = doMapToArray.call(this, normalized);\n                }\n                return result;\n            },\n            fixed: doMapFixed\n        }\n    },\n\n    symbolSize: {\n        applyVisual: makeApplyVisual('symbolSize'),\n        _doMap: makeDoMap([0, 1])\n    }\n};\n\n\nfunction preprocessForPiecewise(thisOption) {\n    var pieceList = thisOption.pieceList;\n    thisOption.hasSpecialVisual = false;\n\n    each$1(pieceList, function (piece, index) {\n        piece.originIndex = index;\n        // piece.visual is \"result visual value\" but not\n        // a visual range, so it does not need to be normalized.\n        if (piece.visual != null) {\n            thisOption.hasSpecialVisual = true;\n        }\n    });\n}\n\nfunction preprocessForSpecifiedCategory(thisOption) {\n    // Hash categories.\n    var categories = thisOption.categories;\n    var visual = thisOption.visual;\n\n    var categoryMap = thisOption.categoryMap = {};\n    each$10(categories, function (cate, index) {\n        categoryMap[cate] = index;\n    });\n\n    // Process visual map input.\n    if (!isArray(visual)) {\n        var visualArr = [];\n\n        if (isObject$1(visual)) {\n            each$10(visual, function (v, cate) {\n                var index = categoryMap[cate];\n                visualArr[index != null ? index : CATEGORY_DEFAULT_VISUAL_INDEX] = v;\n            });\n        }\n        else { // Is primary type, represents default visual.\n            visualArr[CATEGORY_DEFAULT_VISUAL_INDEX] = visual;\n        }\n\n        visual = setVisualToOption(thisOption, visualArr);\n    }\n\n    // Remove categories that has no visual,\n    // then we can mapping them to CATEGORY_DEFAULT_VISUAL_INDEX.\n    for (var i = categories.length - 1; i >= 0; i--) {\n        if (visual[i] == null) {\n            delete categoryMap[categories[i]];\n            categories.pop();\n        }\n    }\n}\n\nfunction normalizeVisualRange(thisOption, isCategory) {\n    var visual = thisOption.visual;\n    var visualArr = [];\n\n    if (isObject$1(visual)) {\n        each$10(visual, function (v) {\n            visualArr.push(v);\n        });\n    }\n    else if (visual != null) {\n        visualArr.push(visual);\n    }\n\n    var doNotNeedPair = {color: 1, symbol: 1};\n\n    if (!isCategory\n        && visualArr.length === 1\n        && !doNotNeedPair.hasOwnProperty(thisOption.type)\n    ) {\n        // Do not care visualArr.length === 0, which is illegal.\n        visualArr[1] = visualArr[0];\n    }\n\n    setVisualToOption(thisOption, visualArr);\n}\n\nfunction makePartialColorVisualHandler(applyValue) {\n    return {\n        applyVisual: function (value, getter, setter) {\n            value = this.mapValueToVisual(value);\n            // Must not be array value\n            setter('color', applyValue(getter('color'), value));\n        },\n        _doMap: makeDoMap([0, 1])\n    };\n}\n\nfunction doMapToArray(normalized) {\n    var visual = this.option.visual;\n    return visual[\n        Math.round(linearMap(normalized, [0, 1], [0, visual.length - 1], true))\n    ] || {};\n}\n\nfunction makeApplyVisual(visualType) {\n    return function (value, getter, setter) {\n        setter(visualType, this.mapValueToVisual(value));\n    };\n}\n\nfunction doMapCategory(normalized) {\n    var visual = this.option.visual;\n    return visual[\n        (this.option.loop && normalized !== CATEGORY_DEFAULT_VISUAL_INDEX)\n            ? normalized % visual.length\n            : normalized\n    ];\n}\n\nfunction doMapFixed() {\n    return this.option.visual[0];\n}\n\nfunction makeDoMap(sourceExtent) {\n    return {\n        linear: function (normalized) {\n            return linearMap(normalized, sourceExtent, this.option.visual, true);\n        },\n        category: doMapCategory,\n        piecewise: function (normalized, value) {\n            var result = getSpecifiedVisual.call(this, value);\n            if (result == null) {\n                result = linearMap(normalized, sourceExtent, this.option.visual, true);\n            }\n            return result;\n        },\n        fixed: doMapFixed\n    };\n}\n\nfunction getSpecifiedVisual(value) {\n    var thisOption = this.option;\n    var pieceList = thisOption.pieceList;\n    if (thisOption.hasSpecialVisual) {\n        var pieceIndex = VisualMapping.findPieceIndex(value, pieceList);\n        var piece = pieceList[pieceIndex];\n        if (piece && piece.visual) {\n            return piece.visual[this.type];\n        }\n    }\n}\n\nfunction setVisualToOption(thisOption, visualArr) {\n    thisOption.visual = visualArr;\n    if (thisOption.type === 'color') {\n        thisOption.parsedVisual = map(visualArr, function (item) {\n            return parse(item);\n        });\n    }\n    return visualArr;\n}\n\n\n/**\n * Normalizers by mapping methods.\n */\nvar normalizers = {\n\n    linear: function (value) {\n        return linearMap(value, this.option.dataExtent, [0, 1], true);\n    },\n\n    piecewise: function (value) {\n        var pieceList = this.option.pieceList;\n        var pieceIndex = VisualMapping.findPieceIndex(value, pieceList, true);\n        if (pieceIndex != null) {\n            return linearMap(pieceIndex, [0, pieceList.length - 1], [0, 1], true);\n        }\n    },\n\n    category: function (value) {\n        var index = this.option.categories\n            ? this.option.categoryMap[value]\n            : value; // ordinal\n        return index == null ? CATEGORY_DEFAULT_VISUAL_INDEX : index;\n    },\n\n    fixed: noop\n};\n\n\n\n/**\n * List available visual types.\n *\n * @public\n * @return {Array.<string>}\n */\nVisualMapping.listVisualTypes = function () {\n    var visualTypes = [];\n    each$1(visualHandlers, function (handler, key) {\n        visualTypes.push(key);\n    });\n    return visualTypes;\n};\n\n/**\n * @public\n */\nVisualMapping.addVisualHandler = function (name, handler) {\n    visualHandlers[name] = handler;\n};\n\n/**\n * @public\n */\nVisualMapping.isValidType = function (visualType) {\n    return visualHandlers.hasOwnProperty(visualType);\n};\n\n/**\n * Convinent method.\n * Visual can be Object or Array or primary type.\n *\n * @public\n */\nVisualMapping.eachVisual = function (visual, callback, context) {\n    if (isObject$1(visual)) {\n        each$1(visual, callback, context);\n    }\n    else {\n        callback.call(context, visual);\n    }\n};\n\nVisualMapping.mapVisual = function (visual, callback, context) {\n    var isPrimary;\n    var newVisual = isArray(visual)\n        ? []\n        : isObject$1(visual)\n        ? {}\n        : (isPrimary = true, null);\n\n    VisualMapping.eachVisual(visual, function (v, key) {\n        var newVal = callback.call(context, v, key);\n        isPrimary ? (newVisual = newVal) : (newVisual[key] = newVal);\n    });\n    return newVisual;\n};\n\n/**\n * @public\n * @param {Object} obj\n * @return {Object} new object containers visual values.\n *                 If no visuals, return null.\n */\nVisualMapping.retrieveVisuals = function (obj) {\n    var ret = {};\n    var hasVisual;\n\n    obj && each$10(visualHandlers, function (h, visualType) {\n        if (obj.hasOwnProperty(visualType)) {\n            ret[visualType] = obj[visualType];\n            hasVisual = true;\n        }\n    });\n\n    return hasVisual ? ret : null;\n};\n\n/**\n * Give order to visual types, considering colorSaturation, colorAlpha depends on color.\n *\n * @public\n * @param {(Object|Array)} visualTypes If Object, like: {color: ..., colorSaturation: ...}\n *                                     IF Array, like: ['color', 'symbol', 'colorSaturation']\n * @return {Array.<string>} Sorted visual types.\n */\nVisualMapping.prepareVisualTypes = function (visualTypes) {\n    if (isObject$5(visualTypes)) {\n        var types = [];\n        each$10(visualTypes, function (item, type) {\n            types.push(type);\n        });\n        visualTypes = types;\n    }\n    else if (isArray(visualTypes)) {\n        visualTypes = visualTypes.slice();\n    }\n    else {\n        return [];\n    }\n\n    visualTypes.sort(function (type1, type2) {\n        // color should be front of colorSaturation, colorAlpha, ...\n        // symbol and symbolSize do not matter.\n        return (type2 === 'color' && type1 !== 'color' && type1.indexOf('color') === 0)\n            ? 1 : -1;\n    });\n\n    return visualTypes;\n};\n\n/**\n * 'color', 'colorSaturation', 'colorAlpha', ... are depends on 'color'.\n * Other visuals are only depends on themself.\n *\n * @public\n * @param {string} visualType1\n * @param {string} visualType2\n * @return {boolean}\n */\nVisualMapping.dependsOn = function (visualType1, visualType2) {\n    return visualType2 === 'color'\n        ? !!(visualType1 && visualType1.indexOf(visualType2) === 0)\n        : visualType1 === visualType2;\n};\n\n/**\n * @param {number} value\n * @param {Array.<Object>} pieceList [{value: ..., interval: [min, max]}, ...]\n *                         Always from small to big.\n * @param {boolean} [findClosestWhenOutside=false]\n * @return {number} index\n */\nVisualMapping.findPieceIndex = function (value, pieceList, findClosestWhenOutside) {\n    var possibleI;\n    var abs = Infinity;\n\n    // value has the higher priority.\n    for (var i = 0, len = pieceList.length; i < len; i++) {\n        var pieceValue = pieceList[i].value;\n        if (pieceValue != null) {\n            if (pieceValue === value\n                // FIXME\n                // It is supposed to compare value according to value type of dimension,\n                // but currently value type can exactly be string or number.\n                // Compromise for numeric-like string (like '12'), especially\n                // in the case that visualMap.categories is ['22', '33'].\n                || (typeof pieceValue === 'string' && pieceValue === value + '')\n            ) {\n                return i;\n            }\n            findClosestWhenOutside && updatePossible(pieceValue, i);\n        }\n    }\n\n    for (var i = 0, len = pieceList.length; i < len; i++) {\n        var piece = pieceList[i];\n        var interval = piece.interval;\n        var close = piece.close;\n\n        if (interval) {\n            if (interval[0] === -Infinity) {\n                if (littleThan(close[1], value, interval[1])) {\n                    return i;\n                }\n            }\n            else if (interval[1] === Infinity) {\n                if (littleThan(close[0], interval[0], value)) {\n                    return i;\n                }\n            }\n            else if (\n                littleThan(close[0], interval[0], value)\n                && littleThan(close[1], value, interval[1])\n            ) {\n                return i;\n            }\n            findClosestWhenOutside && updatePossible(interval[0], i);\n            findClosestWhenOutside && updatePossible(interval[1], i);\n        }\n    }\n\n    if (findClosestWhenOutside) {\n        return value === Infinity\n            ? pieceList.length - 1\n            : value === -Infinity\n            ? 0\n            : possibleI;\n    }\n\n    function updatePossible(val, index) {\n        var newAbs = Math.abs(val - value);\n        if (newAbs < abs) {\n            abs = newAbs;\n            possibleI = index;\n        }\n    }\n\n};\n\nfunction littleThan(close, a, b) {\n    return close ? a <= b : a < b;\n}\n\nvar isArray$2 = isArray;\n\nvar ITEM_STYLE_NORMAL = 'itemStyle';\n\nvar treemapVisual = {\n    seriesType: 'treemap',\n    reset: function (seriesModel, ecModel, api, payload) {\n        var tree = seriesModel.getData().tree;\n        var root = tree.root;\n        var seriesItemStyleModel = seriesModel.getModel(ITEM_STYLE_NORMAL);\n\n        if (root.isRemoved()) {\n            return;\n        }\n\n        var levelItemStyles = map(tree.levelModels, function (levelModel) {\n            return levelModel ? levelModel.get(ITEM_STYLE_NORMAL) : null;\n        });\n\n        travelTree(\n            root, // Visual should calculate from tree root but not view root.\n            {},\n            levelItemStyles,\n            seriesItemStyleModel,\n            seriesModel.getViewRoot().getAncestors(),\n            seriesModel\n        );\n    }\n};\n\nfunction travelTree(\n    node, designatedVisual, levelItemStyles, seriesItemStyleModel,\n    viewRootAncestors, seriesModel\n) {\n    var nodeModel = node.getModel();\n    var nodeLayout = node.getLayout();\n\n    // Optimize\n    if (!nodeLayout || nodeLayout.invisible || !nodeLayout.isInView) {\n        return;\n    }\n\n    var nodeItemStyleModel = node.getModel(ITEM_STYLE_NORMAL);\n    var levelItemStyle = levelItemStyles[node.depth];\n    var visuals = buildVisuals(\n        nodeItemStyleModel, designatedVisual, levelItemStyle, seriesItemStyleModel\n    );\n\n    // calculate border color\n    var borderColor = nodeItemStyleModel.get('borderColor');\n    var borderColorSaturation = nodeItemStyleModel.get('borderColorSaturation');\n    var thisNodeColor;\n    if (borderColorSaturation != null) {\n        // For performance, do not always execute 'calculateColor'.\n        thisNodeColor = calculateColor(visuals, node);\n        borderColor = calculateBorderColor(borderColorSaturation, thisNodeColor);\n    }\n    node.setVisual('borderColor', borderColor);\n\n    var viewChildren = node.viewChildren;\n    if (!viewChildren || !viewChildren.length) {\n        thisNodeColor = calculateColor(visuals, node);\n        // Apply visual to this node.\n        node.setVisual('color', thisNodeColor);\n    }\n    else {\n        var mapping = buildVisualMapping(\n            node, nodeModel, nodeLayout, nodeItemStyleModel, visuals, viewChildren\n        );\n\n        // Designate visual to children.\n        each$1(viewChildren, function (child, index) {\n            // If higher than viewRoot, only ancestors of viewRoot is needed to visit.\n            if (child.depth >= viewRootAncestors.length\n                || child === viewRootAncestors[child.depth]\n            ) {\n                var childVisual = mapVisual$1(\n                    nodeModel, visuals, child, index, mapping, seriesModel\n                );\n                travelTree(\n                    child, childVisual, levelItemStyles, seriesItemStyleModel,\n                    viewRootAncestors, seriesModel\n                );\n            }\n        });\n    }\n}\n\nfunction buildVisuals(\n    nodeItemStyleModel, designatedVisual, levelItemStyle, seriesItemStyleModel\n) {\n    var visuals = extend({}, designatedVisual);\n\n    each$1(['color', 'colorAlpha', 'colorSaturation'], function (visualName) {\n        // Priority: thisNode > thisLevel > parentNodeDesignated > seriesModel\n        var val = nodeItemStyleModel.get(visualName, true); // Ignore parent\n        val == null && levelItemStyle && (val = levelItemStyle[visualName]);\n        val == null && (val = designatedVisual[visualName]);\n        val == null && (val = seriesItemStyleModel.get(visualName));\n\n        val != null && (visuals[visualName] = val);\n    });\n\n    return visuals;\n}\n\nfunction calculateColor(visuals) {\n    var color = getValueVisualDefine(visuals, 'color');\n\n    if (color) {\n        var colorAlpha = getValueVisualDefine(visuals, 'colorAlpha');\n        var colorSaturation = getValueVisualDefine(visuals, 'colorSaturation');\n        if (colorSaturation) {\n            color = modifyHSL(color, null, null, colorSaturation);\n        }\n        if (colorAlpha) {\n            color = modifyAlpha(color, colorAlpha);\n        }\n\n        return color;\n    }\n}\n\nfunction calculateBorderColor(borderColorSaturation, thisNodeColor) {\n    return thisNodeColor != null\n            ? modifyHSL(thisNodeColor, null, null, borderColorSaturation)\n            : null;\n}\n\nfunction getValueVisualDefine(visuals, name) {\n    var value = visuals[name];\n    if (value != null && value !== 'none') {\n        return value;\n    }\n}\n\nfunction buildVisualMapping(\n    node, nodeModel, nodeLayout, nodeItemStyleModel, visuals, viewChildren\n) {\n    if (!viewChildren || !viewChildren.length) {\n        return;\n    }\n\n    var rangeVisual = getRangeVisual(nodeModel, 'color')\n        || (\n            visuals.color != null\n            && visuals.color !== 'none'\n            && (\n                getRangeVisual(nodeModel, 'colorAlpha')\n                || getRangeVisual(nodeModel, 'colorSaturation')\n            )\n        );\n\n    if (!rangeVisual) {\n        return;\n    }\n\n    var visualMin = nodeModel.get('visualMin');\n    var visualMax = nodeModel.get('visualMax');\n    var dataExtent = nodeLayout.dataExtent.slice();\n    visualMin != null && visualMin < dataExtent[0] && (dataExtent[0] = visualMin);\n    visualMax != null && visualMax > dataExtent[1] && (dataExtent[1] = visualMax);\n\n    var colorMappingBy = nodeModel.get('colorMappingBy');\n    var opt = {\n        type: rangeVisual.name,\n        dataExtent: dataExtent,\n        visual: rangeVisual.range\n    };\n    if (opt.type === 'color'\n        && (colorMappingBy === 'index' || colorMappingBy === 'id')\n    ) {\n        opt.mappingMethod = 'category';\n        opt.loop = true;\n        // categories is ordinal, so do not set opt.categories.\n    }\n    else {\n        opt.mappingMethod = 'linear';\n    }\n\n    var mapping = new VisualMapping(opt);\n    mapping.__drColorMappingBy = colorMappingBy;\n\n    return mapping;\n}\n\n// Notice: If we dont have the attribute 'colorRange', but only use\n// attribute 'color' to represent both concepts of 'colorRange' and 'color',\n// (It means 'colorRange' when 'color' is Array, means 'color' when not array),\n// this problem will be encountered:\n// If a level-1 node dont have children, and its siblings has children,\n// and colorRange is set on level-1, then the node can not be colored.\n// So we separate 'colorRange' and 'color' to different attributes.\nfunction getRangeVisual(nodeModel, name) {\n    // 'colorRange', 'colorARange', 'colorSRange'.\n    // If not exsits on this node, fetch from levels and series.\n    var range = nodeModel.get(name);\n    return (isArray$2(range) && range.length) ? {name: name, range: range} : null;\n}\n\nfunction mapVisual$1(nodeModel, visuals, child, index, mapping, seriesModel) {\n    var childVisuals = extend({}, visuals);\n\n    if (mapping) {\n        var mappingType = mapping.type;\n        var colorMappingBy = mappingType === 'color' && mapping.__drColorMappingBy;\n        var value =\n            colorMappingBy === 'index'\n            ? index\n            : colorMappingBy === 'id'\n            ? seriesModel.mapIdToIndex(child.getId())\n            : child.getValue(nodeModel.get('visualDimension'));\n\n        childVisuals[mappingType] = mapping.mapValueToVisual(value);\n    }\n\n    return childVisuals;\n}\n\nvar mathMax$4 = Math.max;\nvar mathMin$4 = Math.min;\nvar retrieveValue = retrieve;\nvar each$11 = each$1;\n\nvar PATH_BORDER_WIDTH = ['itemStyle', 'borderWidth'];\nvar PATH_GAP_WIDTH = ['itemStyle', 'gapWidth'];\nvar PATH_UPPER_LABEL_SHOW = ['upperLabel', 'show'];\nvar PATH_UPPER_LABEL_HEIGHT = ['upperLabel', 'height'];\n\n/**\n * @public\n */\nvar treemapLayout = {\n    seriesType: 'treemap',\n    reset: function (seriesModel, ecModel, api, payload) {\n        // Layout result in each node:\n        // {x, y, width, height, area, borderWidth}\n        var ecWidth = api.getWidth();\n        var ecHeight = api.getHeight();\n        var seriesOption = seriesModel.option;\n\n        var layoutInfo = getLayoutRect(\n            seriesModel.getBoxLayoutParams(),\n            {\n                width: api.getWidth(),\n                height: api.getHeight()\n            }\n        );\n\n        var size = seriesOption.size || []; // Compatible with ec2.\n        var containerWidth = parsePercent$1(\n            retrieveValue(layoutInfo.width, size[0]),\n            ecWidth\n        );\n        var containerHeight = parsePercent$1(\n            retrieveValue(layoutInfo.height, size[1]),\n            ecHeight\n        );\n\n        // Fetch payload info.\n        var payloadType = payload && payload.type;\n        var types = ['treemapZoomToNode', 'treemapRootToNode'];\n        var targetInfo = retrieveTargetInfo(payload, types, seriesModel);\n        var rootRect = (payloadType === 'treemapRender' || payloadType === 'treemapMove')\n            ? payload.rootRect : null;\n        var viewRoot = seriesModel.getViewRoot();\n        var viewAbovePath = getPathToRoot(viewRoot);\n\n        if (payloadType !== 'treemapMove') {\n            var rootSize = payloadType === 'treemapZoomToNode'\n                ? estimateRootSize(\n                    seriesModel, targetInfo, viewRoot, containerWidth, containerHeight\n                )\n                : rootRect\n                ? [rootRect.width, rootRect.height]\n                : [containerWidth, containerHeight];\n\n            var sort = seriesOption.sort;\n            if (sort && sort !== 'asc' && sort !== 'desc') {\n                sort = 'desc';\n            }\n            var options = {\n                squareRatio: seriesOption.squareRatio,\n                sort: sort,\n                leafDepth: seriesOption.leafDepth\n            };\n\n            // layout should be cleared because using updateView but not update.\n            viewRoot.hostTree.clearLayouts();\n\n            // TODO\n            // optimize: if out of view clip, do not layout.\n            // But take care that if do not render node out of view clip,\n            // how to calculate start po\n\n            var viewRootLayout = {\n                x: 0, y: 0,\n                width: rootSize[0], height: rootSize[1],\n                area: rootSize[0] * rootSize[1]\n            };\n            viewRoot.setLayout(viewRootLayout);\n\n            squarify(viewRoot, options, false, 0);\n            // Supplement layout.\n            var viewRootLayout = viewRoot.getLayout();\n            each$11(viewAbovePath, function (node, index) {\n                var childValue = (viewAbovePath[index + 1] || viewRoot).getValue();\n                node.setLayout(extend(\n                    {dataExtent: [childValue, childValue], borderWidth: 0, upperHeight: 0},\n                    viewRootLayout\n                ));\n            });\n        }\n\n        var treeRoot = seriesModel.getData().tree.root;\n\n        treeRoot.setLayout(\n            calculateRootPosition(layoutInfo, rootRect, targetInfo),\n            true\n        );\n\n        seriesModel.setLayoutInfo(layoutInfo);\n\n        // FIXME\n        // clipec\n        prunning(\n            treeRoot,\n            // Transform to base element coordinate system.\n            new BoundingRect(-layoutInfo.x, -layoutInfo.y, ecWidth, ecHeight),\n            viewAbovePath,\n            viewRoot,\n            0\n        );\n    }\n};\n\n/**\n * Layout treemap with squarify algorithm.\n * @see https://graphics.ethz.ch/teaching/scivis_common/Literature/squarifiedTreeMaps.pdf\n * @see https://github.com/mbostock/d3/blob/master/src/layout/treemap.js\n *\n * @protected\n * @param {module:echarts/data/Tree~TreeNode} node\n * @param {Object} options\n * @param {string} options.sort 'asc' or 'desc'\n * @param {number} options.squareRatio\n * @param {boolean} hideChildren\n * @param {number} depth\n */\nfunction squarify(node, options, hideChildren, depth) {\n    var width;\n    var height;\n\n    if (node.isRemoved()) {\n        return;\n    }\n\n    var thisLayout = node.getLayout();\n    width = thisLayout.width;\n    height = thisLayout.height;\n\n    // Considering border and gap\n    var nodeModel = node.getModel();\n    var borderWidth = nodeModel.get(PATH_BORDER_WIDTH);\n    var halfGapWidth = nodeModel.get(PATH_GAP_WIDTH) / 2;\n    var upperLabelHeight = getUpperLabelHeight(nodeModel);\n    var upperHeight = Math.max(borderWidth, upperLabelHeight);\n    var layoutOffset = borderWidth - halfGapWidth;\n    var layoutOffsetUpper = upperHeight - halfGapWidth;\n    var nodeModel = node.getModel();\n\n    node.setLayout({\n        borderWidth: borderWidth,\n        upperHeight: upperHeight,\n        upperLabelHeight: upperLabelHeight\n    }, true);\n\n    width = mathMax$4(width - 2 * layoutOffset, 0);\n    height = mathMax$4(height - layoutOffset - layoutOffsetUpper, 0);\n\n    var totalArea = width * height;\n    var viewChildren = initChildren(\n        node, nodeModel, totalArea, options, hideChildren, depth\n    );\n\n    if (!viewChildren.length) {\n        return;\n    }\n\n    var rect = {x: layoutOffset, y: layoutOffsetUpper, width: width, height: height};\n    var rowFixedLength = mathMin$4(width, height);\n    var best = Infinity; // the best row score so far\n    var row = [];\n    row.area = 0;\n\n    for (var i = 0, len = viewChildren.length; i < len;) {\n        var child = viewChildren[i];\n\n        row.push(child);\n        row.area += child.getLayout().area;\n        var score = worst(row, rowFixedLength, options.squareRatio);\n\n        // continue with this orientation\n        if (score <= best) {\n            i++;\n            best = score;\n        }\n        // abort, and try a different orientation\n        else {\n            row.area -= row.pop().getLayout().area;\n            position(row, rowFixedLength, rect, halfGapWidth, false);\n            rowFixedLength = mathMin$4(rect.width, rect.height);\n            row.length = row.area = 0;\n            best = Infinity;\n        }\n    }\n\n    if (row.length) {\n        position(row, rowFixedLength, rect, halfGapWidth, true);\n    }\n\n    if (!hideChildren) {\n        var childrenVisibleMin = nodeModel.get('childrenVisibleMin');\n        if (childrenVisibleMin != null && totalArea < childrenVisibleMin) {\n            hideChildren = true;\n        }\n    }\n\n    for (var i = 0, len = viewChildren.length; i < len; i++) {\n        squarify(viewChildren[i], options, hideChildren, depth + 1);\n    }\n}\n\n/**\n * Set area to each child, and calculate data extent for visual coding.\n */\nfunction initChildren(node, nodeModel, totalArea, options, hideChildren, depth) {\n    var viewChildren = node.children || [];\n    var orderBy = options.sort;\n    orderBy !== 'asc' && orderBy !== 'desc' && (orderBy = null);\n\n    var overLeafDepth = options.leafDepth != null && options.leafDepth <= depth;\n\n    // leafDepth has higher priority.\n    if (hideChildren && !overLeafDepth) {\n        return (node.viewChildren = []);\n    }\n\n    // Sort children, order by desc.\n    viewChildren = filter(viewChildren, function (child) {\n        return !child.isRemoved();\n    });\n\n    sort$1(viewChildren, orderBy);\n\n    var info = statistic(nodeModel, viewChildren, orderBy);\n\n    if (info.sum === 0) {\n        return (node.viewChildren = []);\n    }\n\n    info.sum = filterByThreshold(nodeModel, totalArea, info.sum, orderBy, viewChildren);\n\n    if (info.sum === 0) {\n        return (node.viewChildren = []);\n    }\n\n    // Set area to each child.\n    for (var i = 0, len = viewChildren.length; i < len; i++) {\n        var area = viewChildren[i].getValue() / info.sum * totalArea;\n        // Do not use setLayout({...}, true), because it is needed to clear last layout.\n        viewChildren[i].setLayout({area: area});\n    }\n\n    if (overLeafDepth) {\n        viewChildren.length && node.setLayout({isLeafRoot: true}, true);\n        viewChildren.length = 0;\n    }\n\n    node.viewChildren = viewChildren;\n    node.setLayout({dataExtent: info.dataExtent}, true);\n\n    return viewChildren;\n}\n\n/**\n * Consider 'visibleMin'. Modify viewChildren and get new sum.\n */\nfunction filterByThreshold(nodeModel, totalArea, sum, orderBy, orderedChildren) {\n\n    // visibleMin is not supported yet when no option.sort.\n    if (!orderBy) {\n        return sum;\n    }\n\n    var visibleMin = nodeModel.get('visibleMin');\n    var len = orderedChildren.length;\n    var deletePoint = len;\n\n    // Always travel from little value to big value.\n    for (var i = len - 1; i >= 0; i--) {\n        var value = orderedChildren[\n            orderBy === 'asc' ? len - i - 1 : i\n        ].getValue();\n\n        if (value / sum * totalArea < visibleMin) {\n            deletePoint = i;\n            sum -= value;\n        }\n    }\n\n    orderBy === 'asc'\n        ? orderedChildren.splice(0, len - deletePoint)\n        : orderedChildren.splice(deletePoint, len - deletePoint);\n\n    return sum;\n}\n\n/**\n * Sort\n */\nfunction sort$1(viewChildren, orderBy) {\n    if (orderBy) {\n        viewChildren.sort(function (a, b) {\n            var diff = orderBy === 'asc'\n                ?  a.getValue() - b.getValue() : b.getValue() - a.getValue();\n            return diff === 0\n                ? (orderBy === 'asc'\n                    ? a.dataIndex - b.dataIndex : b.dataIndex - a.dataIndex\n                )\n                : diff;\n        });\n    }\n    return viewChildren;\n}\n\n/**\n * Statistic\n */\nfunction statistic(nodeModel, children, orderBy) {\n    // Calculate sum.\n    var sum = 0;\n    for (var i = 0, len = children.length; i < len; i++) {\n        sum += children[i].getValue();\n    }\n\n    // Statistic data extent for latter visual coding.\n    // Notice: data extent should be calculate based on raw children\n    // but not filtered view children, otherwise visual mapping will not\n    // be stable when zoom (where children is filtered by visibleMin).\n\n    var dimension = nodeModel.get('visualDimension');\n    var dataExtent;\n\n    // The same as area dimension.\n    if (!children || !children.length) {\n        dataExtent = [NaN, NaN];\n    }\n    else if (dimension === 'value' && orderBy) {\n        dataExtent = [\n            children[children.length - 1].getValue(),\n            children[0].getValue()\n        ];\n        orderBy === 'asc' && dataExtent.reverse();\n    }\n    // Other dimension.\n    else {\n        var dataExtent = [Infinity, -Infinity];\n        each$11(children, function (child) {\n            var value = child.getValue(dimension);\n            value < dataExtent[0] && (dataExtent[0] = value);\n            value > dataExtent[1] && (dataExtent[1] = value);\n        });\n    }\n\n    return {sum: sum, dataExtent: dataExtent};\n}\n\n/**\n * Computes the score for the specified row,\n * as the worst aspect ratio.\n */\nfunction worst(row, rowFixedLength, ratio) {\n    var areaMax = 0;\n    var areaMin = Infinity;\n\n    for (var i = 0, area, len = row.length; i < len; i++) {\n        area = row[i].getLayout().area;\n        if (area) {\n            area < areaMin && (areaMin = area);\n            area > areaMax && (areaMax = area);\n        }\n    }\n\n    var squareArea = row.area * row.area;\n    var f = rowFixedLength * rowFixedLength * ratio;\n\n    return squareArea\n        ? mathMax$4(\n            (f * areaMax) / squareArea,\n            squareArea / (f * areaMin)\n        )\n        : Infinity;\n}\n\n/**\n * Positions the specified row of nodes. Modifies `rect`.\n */\nfunction position(row, rowFixedLength, rect, halfGapWidth, flush) {\n    // When rowFixedLength === rect.width,\n    // it is horizontal subdivision,\n    // rowFixedLength is the width of the subdivision,\n    // rowOtherLength is the height of the subdivision,\n    // and nodes will be positioned from left to right.\n\n    // wh[idx0WhenH] means: when horizontal,\n    //      wh[idx0WhenH] => wh[0] => 'width'.\n    //      xy[idx1WhenH] => xy[1] => 'y'.\n    var idx0WhenH = rowFixedLength === rect.width ? 0 : 1;\n    var idx1WhenH = 1 - idx0WhenH;\n    var xy = ['x', 'y'];\n    var wh = ['width', 'height'];\n\n    var last = rect[xy[idx0WhenH]];\n    var rowOtherLength = rowFixedLength\n        ? row.area / rowFixedLength : 0;\n\n    if (flush || rowOtherLength > rect[wh[idx1WhenH]]) {\n        rowOtherLength = rect[wh[idx1WhenH]]; // over+underflow\n    }\n    for (var i = 0, rowLen = row.length; i < rowLen; i++) {\n        var node = row[i];\n        var nodeLayout = {};\n        var step = rowOtherLength\n            ? node.getLayout().area / rowOtherLength : 0;\n\n        var wh1 = nodeLayout[wh[idx1WhenH]] = mathMax$4(rowOtherLength - 2 * halfGapWidth, 0);\n\n        // We use Math.max/min to avoid negative width/height when considering gap width.\n        var remain = rect[xy[idx0WhenH]] + rect[wh[idx0WhenH]] - last;\n        var modWH = (i === rowLen - 1 || remain < step) ? remain : step;\n        var wh0 = nodeLayout[wh[idx0WhenH]] = mathMax$4(modWH - 2 * halfGapWidth, 0);\n\n        nodeLayout[xy[idx1WhenH]] = rect[xy[idx1WhenH]] + mathMin$4(halfGapWidth, wh1 / 2);\n        nodeLayout[xy[idx0WhenH]] = last + mathMin$4(halfGapWidth, wh0 / 2);\n\n        last += modWH;\n        node.setLayout(nodeLayout, true);\n    }\n\n    rect[xy[idx1WhenH]] += rowOtherLength;\n    rect[wh[idx1WhenH]] -= rowOtherLength;\n}\n\n// Return [containerWidth, containerHeight] as defualt.\nfunction estimateRootSize(seriesModel, targetInfo, viewRoot, containerWidth, containerHeight) {\n    // If targetInfo.node exists, we zoom to the node,\n    // so estimate whold width and heigth by target node.\n    var currNode = (targetInfo || {}).node;\n    var defaultSize = [containerWidth, containerHeight];\n\n    if (!currNode || currNode === viewRoot) {\n        return defaultSize;\n    }\n\n    var parent;\n    var viewArea = containerWidth * containerHeight;\n    var area = viewArea * seriesModel.option.zoomToNodeRatio;\n\n    while (parent = currNode.parentNode) { // jshint ignore:line\n        var sum = 0;\n        var siblings = parent.children;\n\n        for (var i = 0, len = siblings.length; i < len; i++) {\n            sum += siblings[i].getValue();\n        }\n        var currNodeValue = currNode.getValue();\n        if (currNodeValue === 0) {\n            return defaultSize;\n        }\n        area *= sum / currNodeValue;\n\n        // Considering border, suppose aspect ratio is 1.\n        var parentModel = parent.getModel();\n        var borderWidth = parentModel.get(PATH_BORDER_WIDTH);\n        var upperHeight = Math.max(borderWidth, getUpperLabelHeight(parentModel, borderWidth));\n        area += 4 * borderWidth * borderWidth\n            + (3 * borderWidth + upperHeight) * Math.pow(area, 0.5);\n\n        area > MAX_SAFE_INTEGER && (area = MAX_SAFE_INTEGER);\n\n        currNode = parent;\n    }\n\n    area < viewArea && (area = viewArea);\n    var scale = Math.pow(area / viewArea, 0.5);\n\n    return [containerWidth * scale, containerHeight * scale];\n}\n\n// Root postion base on coord of containerGroup\nfunction calculateRootPosition(layoutInfo, rootRect, targetInfo) {\n    if (rootRect) {\n        return {x: rootRect.x, y: rootRect.y};\n    }\n\n    var defaultPosition = {x: 0, y: 0};\n    if (!targetInfo) {\n        return defaultPosition;\n    }\n\n    // If targetInfo is fetched by 'retrieveTargetInfo',\n    // old tree and new tree are the same tree,\n    // so the node still exists and we can visit it.\n\n    var targetNode = targetInfo.node;\n    var layout = targetNode.getLayout();\n\n    if (!layout) {\n        return defaultPosition;\n    }\n\n    // Transform coord from local to container.\n    var targetCenter = [layout.width / 2, layout.height / 2];\n    var node = targetNode;\n    while (node) {\n        var nodeLayout = node.getLayout();\n        targetCenter[0] += nodeLayout.x;\n        targetCenter[1] += nodeLayout.y;\n        node = node.parentNode;\n    }\n\n    return {\n        x: layoutInfo.width / 2 - targetCenter[0],\n        y: layoutInfo.height / 2 - targetCenter[1]\n    };\n}\n\n// Mark nodes visible for prunning when visual coding and rendering.\n// Prunning depends on layout and root position, so we have to do it after layout.\nfunction prunning(node, clipRect, viewAbovePath, viewRoot, depth) {\n    var nodeLayout = node.getLayout();\n    var nodeInViewAbovePath = viewAbovePath[depth];\n    var isAboveViewRoot = nodeInViewAbovePath && nodeInViewAbovePath === node;\n\n    if (\n        (nodeInViewAbovePath && !isAboveViewRoot)\n        || (depth === viewAbovePath.length && node !== viewRoot)\n    ) {\n        return;\n    }\n\n    node.setLayout({\n        // isInView means: viewRoot sub tree + viewAbovePath\n        isInView: true,\n        // invisible only means: outside view clip so that the node can not\n        // see but still layout for animation preparation but not render.\n        invisible: !isAboveViewRoot && !clipRect.intersect(nodeLayout),\n        isAboveViewRoot: isAboveViewRoot\n    }, true);\n\n    // Transform to child coordinate.\n    var childClipRect = new BoundingRect(\n        clipRect.x - nodeLayout.x,\n        clipRect.y - nodeLayout.y,\n        clipRect.width,\n        clipRect.height\n    );\n\n    each$11(node.viewChildren || [], function (child) {\n        prunning(child, childClipRect, viewAbovePath, viewRoot, depth + 1);\n    });\n}\n\nfunction getUpperLabelHeight(model) {\n    return model.get(PATH_UPPER_LABEL_SHOW) ? model.get(PATH_UPPER_LABEL_HEIGHT) : 0;\n}\n\nregisterVisual(treemapVisual);\nregisterLayout(treemapLayout);\n\n/**\n * Graph data structure\n *\n * @module echarts/data/Graph\n * @author Yi Shen(https://www.github.com/pissang)\n */\n\n// id may be function name of Object, add a prefix to avoid this problem.\nfunction generateNodeKey (id) {\n    return '_EC_' + id;\n}\n/**\n * @alias module:echarts/data/Graph\n * @constructor\n * @param {boolean} directed\n */\nvar Graph = function(directed) {\n    /**\n     * \n     * @type {boolean}\n     * @private\n     */\n    this._directed = directed || false;\n\n    /**\n     * @type {Array.<module:echarts/data/Graph.Node>}\n     * @readOnly\n     */\n    this.nodes = [];\n\n    /**\n     * @type {Array.<module:echarts/data/Graph.Edge>}\n     * @readOnly\n     */\n    this.edges = [];\n\n    /**\n     * @type {Object.<string, module:echarts/data/Graph.Node>}\n     * @private\n     */\n    this._nodesMap = {};\n    /**\n     * @type {Object.<string, module:echarts/data/Graph.Edge>}\n     * @private\n     */\n    this._edgesMap = {};\n\n    /**\n     * @type {module:echarts/data/List}\n     * @readOnly\n     */\n    this.data;\n\n    /**\n     * @type {module:echarts/data/List}\n     * @readOnly\n     */\n    this.edgeData;\n};\n\nvar graphProto = Graph.prototype;\n/**\n * @type {string}\n */\ngraphProto.type = 'graph';\n\n/**\n * If is directed graph\n * @return {boolean}\n */\ngraphProto.isDirected = function () {\n    return this._directed;\n};\n\n/**\n * Add a new node\n * @param {string} id\n * @param {number} [dataIndex]\n */\ngraphProto.addNode = function (id, dataIndex) {\n    id = id || ('' + dataIndex);\n\n    var nodesMap = this._nodesMap;\n\n    if (nodesMap[generateNodeKey(id)]) {\n        if (__DEV__) {\n            console.error('Graph nodes have duplicate name or id');\n        }\n        return;\n    }\n\n    var node = new Node(id, dataIndex);\n    node.hostGraph = this;\n\n    this.nodes.push(node);\n\n    nodesMap[generateNodeKey(id)] = node;\n    return node;\n};\n\n/**\n * Get node by data index\n * @param  {number} dataIndex\n * @return {module:echarts/data/Graph~Node}\n */\ngraphProto.getNodeByIndex = function (dataIndex) {\n    var rawIdx = this.data.getRawIndex(dataIndex);\n    return this.nodes[rawIdx];\n};\n/**\n * Get node by id\n * @param  {string} id\n * @return {module:echarts/data/Graph.Node}\n */\ngraphProto.getNodeById = function (id) {\n    return this._nodesMap[generateNodeKey(id)];\n};\n\n/**\n * Add a new edge\n * @param {number|string|module:echarts/data/Graph.Node} n1\n * @param {number|string|module:echarts/data/Graph.Node} n2\n * @param {number} [dataIndex=-1]\n * @return {module:echarts/data/Graph.Edge}\n */\ngraphProto.addEdge = function (n1, n2, dataIndex) {\n    var nodesMap = this._nodesMap;\n    var edgesMap = this._edgesMap;\n\n    // PNEDING\n    if (typeof n1 === 'number') {\n        n1 = this.nodes[n1];\n    }\n    if (typeof n2 === 'number') {\n        n2 = this.nodes[n2];\n    }\n\n    if (!Node.isInstance(n1)) {\n        n1 = nodesMap[generateNodeKey(n1)];\n    }\n    if (!Node.isInstance(n2)) {\n        n2 = nodesMap[generateNodeKey(n2)];\n    }\n    if (!n1 || !n2) {\n        return;\n    }\n\n    var key = n1.id + '-' + n2.id;\n    // PENDING\n    if (edgesMap[key]) {\n        return;\n    }\n\n    var edge = new Edge(n1, n2, dataIndex);\n    edge.hostGraph = this;\n\n    if (this._directed) {\n        n1.outEdges.push(edge);\n        n2.inEdges.push(edge);\n    }\n    n1.edges.push(edge);\n    if (n1 !== n2) {\n        n2.edges.push(edge);\n    }\n\n    this.edges.push(edge);\n    edgesMap[key] = edge;\n\n    return edge;\n};\n\n/**\n * Get edge by data index\n * @param  {number} dataIndex\n * @return {module:echarts/data/Graph~Node}\n */\ngraphProto.getEdgeByIndex = function (dataIndex) {\n    var rawIdx = this.edgeData.getRawIndex(dataIndex);\n    return this.edges[rawIdx];\n};\n/**\n * Get edge by two linked nodes\n * @param  {module:echarts/data/Graph.Node|string} n1\n * @param  {module:echarts/data/Graph.Node|string} n2\n * @return {module:echarts/data/Graph.Edge}\n */\ngraphProto.getEdge = function (n1, n2) {\n    if (Node.isInstance(n1)) {\n        n1 = n1.id;\n    }\n    if (Node.isInstance(n2)) {\n        n2 = n2.id;\n    }\n\n    var edgesMap = this._edgesMap;\n\n    if (this._directed) {\n        return edgesMap[n1 + '-' + n2];\n    } else {\n        return edgesMap[n1 + '-' + n2]\n            || edgesMap[n2 + '-' + n1];\n    }\n};\n\n/**\n * Iterate all nodes\n * @param  {Function} cb\n * @param  {*} [context]\n */\ngraphProto.eachNode = function (cb, context) {\n    var nodes = this.nodes;\n    var len = nodes.length;\n    for (var i = 0; i < len; i++) {\n        if (nodes[i].dataIndex >= 0) {\n            cb.call(context, nodes[i], i);\n        }\n    }\n};\n\n/**\n * Iterate all edges\n * @param  {Function} cb\n * @param  {*} [context]\n */\ngraphProto.eachEdge = function (cb, context) {\n    var edges = this.edges;\n    var len = edges.length;\n    for (var i = 0; i < len; i++) {\n        if (edges[i].dataIndex >= 0\n            && edges[i].node1.dataIndex >= 0\n            && edges[i].node2.dataIndex >= 0\n        ) {\n            cb.call(context, edges[i], i);\n        }\n    }\n};\n\n/**\n * Breadth first traverse\n * @param {Function} cb\n * @param {module:echarts/data/Graph.Node} startNode\n * @param {string} [direction='none'] 'none'|'in'|'out'\n * @param {*} [context]\n */\ngraphProto.breadthFirstTraverse = function (\n    cb, startNode, direction, context\n) {\n    if (!Node.isInstance(startNode)) {\n        startNode = this._nodesMap[generateNodeKey(startNode)];\n    }\n    if (!startNode) {\n        return;\n    }\n\n    var edgeType = direction === 'out'\n        ? 'outEdges' : (direction === 'in' ? 'inEdges' : 'edges');\n\n    for (var i = 0; i < this.nodes.length; i++) {\n        this.nodes[i].__visited = false;\n    }\n\n    if (cb.call(context, startNode, null)) {\n        return;\n    }\n\n    var queue = [startNode];\n    while (queue.length) {\n        var currentNode = queue.shift();\n        var edges = currentNode[edgeType];\n\n        for (var i = 0; i < edges.length; i++) {\n            var e = edges[i];\n            var otherNode = e.node1 === currentNode\n                ? e.node2 : e.node1;\n            if (!otherNode.__visited) {\n                if (cb.call(context, otherNode, currentNode)) {\n                    // Stop traversing\n                    return;\n                }\n                queue.push(otherNode);\n                otherNode.__visited = true;\n            }\n        }\n    }\n};\n\n// TODO\n// graphProto.depthFirstTraverse = function (\n//     cb, startNode, direction, context\n// ) {\n\n// };\n\n// Filter update\ngraphProto.update = function () {\n    var data = this.data;\n    var edgeData = this.edgeData;\n    var nodes = this.nodes;\n    var edges = this.edges;\n\n    for (var i = 0, len = nodes.length; i < len; i++) {\n        nodes[i].dataIndex = -1;\n    }\n    for (var i = 0, len = data.count(); i < len; i++) {\n        nodes[data.getRawIndex(i)].dataIndex = i;\n    }\n\n    edgeData.filterSelf(function (idx) {\n        var edge = edges[edgeData.getRawIndex(idx)];\n        return edge.node1.dataIndex >= 0 && edge.node2.dataIndex >= 0;\n    });\n\n    // Update edge\n    for (var i = 0, len = edges.length; i < len; i++) {\n        edges[i].dataIndex = -1;\n    }\n    for (var i = 0, len = edgeData.count(); i < len; i++) {\n        edges[edgeData.getRawIndex(i)].dataIndex = i;\n    }\n};\n\n/**\n * @return {module:echarts/data/Graph}\n */\ngraphProto.clone = function () {\n    var graph = new Graph(this._directed);\n    var nodes = this.nodes;\n    var edges = this.edges;\n    for (var i = 0; i < nodes.length; i++) {\n        graph.addNode(nodes[i].id, nodes[i].dataIndex);\n    }\n    for (var i = 0; i < edges.length; i++) {\n        var e = edges[i];\n        graph.addEdge(e.node1.id, e.node2.id, e.dataIndex);\n    }\n    return graph;\n};\n\n\n/**\n * @alias module:echarts/data/Graph.Node\n */\nfunction Node(id, dataIndex) {\n    /**\n    * @type {string}\n    */\n    this.id = id == null ? '' : id;\n\n    /**\n    * @type {Array.<module:echarts/data/Graph.Edge>}\n    */\n    this.inEdges = [];\n    /**\n    * @type {Array.<module:echarts/data/Graph.Edge>}\n    */\n    this.outEdges = [];\n    /**\n    * @type {Array.<module:echarts/data/Graph.Edge>}\n    */\n    this.edges = [];\n    /**\n     * @type {module:echarts/data/Graph}\n     */\n    this.hostGraph;\n\n    /**\n     * @type {number}\n     */\n    this.dataIndex = dataIndex == null ? -1 : dataIndex;\n}\n\nNode.prototype = {\n\n    constructor: Node,\n\n    /**\n     * @return {number}\n     */\n    degree: function () {\n        return this.edges.length;\n    },\n\n    /**\n     * @return {number}\n     */\n    inDegree: function () {\n        return this.inEdges.length;\n    },\n\n    /**\n    * @return {number}\n    */\n    outDegree: function () {\n        return this.outEdges.length;\n    },\n\n    /**\n     * @param {string} [path]\n     * @return {module:echarts/model/Model}\n     */\n    getModel: function (path) {\n        if (this.dataIndex < 0) {\n            return;\n        }\n        var graph = this.hostGraph;\n        var itemModel = graph.data.getItemModel(this.dataIndex);\n\n        return itemModel.getModel(path);\n    }\n};\n\n/**\n * \n * @alias module:echarts/data/Graph.Edge\n * @param {module:echarts/data/Graph.Node} n1\n * @param {module:echarts/data/Graph.Node} n2\n * @param {number} [dataIndex=-1]\n */\nfunction Edge(n1, n2, dataIndex) {\n\n    /**\n     * 1\n     * @type {module:echarts/data/Graph.Node}\n     */\n    this.node1 = n1;\n\n    /**\n     * 2\n     * @type {module:echarts/data/Graph.Node}\n     */\n    this.node2 = n2;\n\n    this.dataIndex = dataIndex == null ? -1 : dataIndex;\n}\n\n/**\n * @param {string} [path]\n * @return {module:echarts/model/Model}\n */\n    Edge.prototype.getModel = function (path) {\n    if (this.dataIndex < 0) {\n        return;\n    }\n    var graph = this.hostGraph;\n    var itemModel = graph.edgeData.getItemModel(this.dataIndex);\n\n    return itemModel.getModel(path);\n};\n\nvar createGraphDataProxyMixin = function (hostName, dataName) {\n    return {\n        /**\n         * @param {string=} [dimension='value'] Default 'value'. can be 'a', 'b', 'c', 'd', 'e'.\n         * @return {number}\n         */\n        getValue: function (dimension) {\n            var data = this[hostName][dataName];\n            return data.get(data.getDimension(dimension || 'value'), this.dataIndex);\n        },\n\n        /**\n         * @param {Object|string} key\n         * @param {*} [value]\n         */\n        setVisual: function (key, value) {\n            this.dataIndex >= 0\n                && this[hostName][dataName].setItemVisual(this.dataIndex, key, value);\n        },\n\n        /**\n         * @param {string} key\n         * @return {boolean}\n         */\n        getVisual: function (key, ignoreParent) {\n            return this[hostName][dataName].getItemVisual(this.dataIndex, key, ignoreParent);\n        },\n\n        /**\n         * @param {Object} layout\n         * @return {boolean} [merge=false]\n         */\n        setLayout: function (layout, merge$$1) {\n            this.dataIndex >= 0\n                && this[hostName][dataName].setItemLayout(this.dataIndex, layout, merge$$1);\n        },\n\n        /**\n         * @return {Object}\n         */\n        getLayout: function () {\n            return this[hostName][dataName].getItemLayout(this.dataIndex);\n        },\n\n        /**\n         * @return {module:zrender/Element}\n         */\n        getGraphicEl: function () {\n            return this[hostName][dataName].getItemGraphicEl(this.dataIndex);\n        },\n\n        /**\n         * @return {number}\n         */\n        getRawIndex: function () {\n            return this[hostName][dataName].getRawIndex(this.dataIndex);\n        }\n    };\n};\n\nmixin(Node, createGraphDataProxyMixin('hostGraph', 'data'));\nmixin(Edge, createGraphDataProxyMixin('hostGraph', 'edgeData'));\n\nGraph.Node = Node;\nGraph.Edge = Edge;\n\nenableClassCheck(Node);\nenableClassCheck(Edge);\n\nvar createGraphFromNodeEdge = function (nodes, edges, seriesModel, directed, beforeLink) {\n    // ??? TODO\n    // support dataset?\n    var graph = new Graph(directed);\n    for (var i = 0; i < nodes.length; i++) {\n        graph.addNode(retrieve(\n            // Id, name, dataIndex\n            nodes[i].id, nodes[i].name, i\n        ), i);\n    }\n\n    var linkNameList = [];\n    var validEdges = [];\n    var linkCount = 0;\n    for (var i = 0; i < edges.length; i++) {\n        var link = edges[i];\n        var source = link.source;\n        var target = link.target;\n        // addEdge may fail when source or target not exists\n        if (graph.addEdge(source, target, linkCount)) {\n            validEdges.push(link);\n            linkNameList.push(retrieve(link.id, source + ' > ' + target));\n            linkCount++;\n        }\n    }\n\n    var coordSys = seriesModel.get('coordinateSystem');\n    var nodeData;\n    if (coordSys === 'cartesian2d' || coordSys === 'polar') {\n        nodeData = createListFromArray(nodes, seriesModel);\n    }\n    else {\n        // FIXME\n        var coordSysCtor = CoordinateSystemManager.get(coordSys);\n        // FIXME\n        var dimensionNames = createDimensions(nodes, {\n            coordDimensions: (\n                (coordSysCtor && coordSysCtor.type !== 'view')\n                    ? (coordSysCtor.dimensions || []) : []\n            ).concat(['value'])\n        });\n        nodeData = new List(dimensionNames, seriesModel);\n        nodeData.initData(nodes);\n    }\n\n    var edgeData = new List(['value'], seriesModel);\n    edgeData.initData(validEdges, linkNameList);\n\n    beforeLink && beforeLink(nodeData, edgeData);\n\n    linkList({\n        mainData: nodeData,\n        struct: graph,\n        structAttr: 'graph',\n        datas: {node: nodeData, edge: edgeData},\n        datasAttr: {node: 'data', edge: 'edgeData'}\n    });\n\n    // Update dataIndex of nodes and edges because invalid edge may be removed\n    graph.update();\n\n    return graph;\n};\n\nvar GraphSeries = extendSeriesModel({\n\n    type: 'series.graph',\n\n    init: function (option) {\n        GraphSeries.superApply(this, 'init', arguments);\n\n        // Provide data for legend select\n        this.legendDataProvider = function () {\n            return this._categoriesData;\n        };\n\n        this.fillDataTextStyle(option.edges || option.links);\n\n        this._updateCategoriesData();\n    },\n\n    mergeOption: function (option) {\n        GraphSeries.superApply(this, 'mergeOption', arguments);\n\n        this.fillDataTextStyle(option.edges || option.links);\n\n        this._updateCategoriesData();\n    },\n\n    mergeDefaultAndTheme: function (option) {\n        GraphSeries.superApply(this, 'mergeDefaultAndTheme', arguments);\n        defaultEmphasis(option, ['edgeLabel'], ['show']);\n    },\n\n    getInitialData: function (option, ecModel) {\n        var edges = option.edges || option.links || [];\n        var nodes = option.data || option.nodes || [];\n        var self = this;\n\n        if (nodes && edges) {\n            return createGraphFromNodeEdge(nodes, edges, this, true, beforeLink).data;\n        }\n\n        function beforeLink(nodeData, edgeData) {\n            // Overwrite nodeData.getItemModel to\n            nodeData.wrapMethod('getItemModel', function (model) {\n                var categoriesModels = self._categoriesModels;\n                var categoryIdx = model.getShallow('category');\n                var categoryModel = categoriesModels[categoryIdx];\n                if (categoryModel) {\n                    categoryModel.parentModel = model.parentModel;\n                    model.parentModel = categoryModel;\n                }\n                return model;\n            });\n\n            var edgeLabelModel = self.getModel('edgeLabel');\n            // For option `edgeLabel` can be found by label.xxx.xxx on item mode.\n            var fakeSeriesModel = new Model(\n                {label: edgeLabelModel.option},\n                edgeLabelModel.parentModel,\n                ecModel\n            );\n\n            edgeData.wrapMethod('getItemModel', function (model) {\n                model.customizeGetParent(edgeGetParent);\n                return model;\n            });\n\n            function edgeGetParent(path) {\n                path = this.parsePath(path);\n                return (path && path[0] === 'label')\n                    ? fakeSeriesModel\n                    : this.parentModel;\n            }\n        }\n    },\n\n    /**\n     * @return {module:echarts/data/Graph}\n     */\n    getGraph: function () {\n        return this.getData().graph;\n    },\n\n    /**\n     * @return {module:echarts/data/List}\n     */\n    getEdgeData: function () {\n        return this.getGraph().edgeData;\n    },\n\n    /**\n     * @return {module:echarts/data/List}\n     */\n    getCategoriesData: function () {\n        return this._categoriesData;\n    },\n\n    /**\n     * @override\n     */\n    formatTooltip: function (dataIndex, multipleSeries, dataType) {\n        if (dataType === 'edge') {\n            var nodeData = this.getData();\n            var params = this.getDataParams(dataIndex, dataType);\n            var edge = nodeData.graph.getEdgeByIndex(dataIndex);\n            var sourceName = nodeData.getName(edge.node1.dataIndex);\n            var targetName = nodeData.getName(edge.node2.dataIndex);\n\n            var html = [];\n            sourceName != null && html.push(sourceName);\n            targetName != null && html.push(targetName);\n            html = encodeHTML(html.join(' > '));\n\n            if (params.value) {\n                html += ' : ' + encodeHTML(params.value);\n            }\n            return html;\n        }\n        else { // dataType === 'node' or empty\n            return GraphSeries.superApply(this, 'formatTooltip', arguments);\n        }\n    },\n\n    _updateCategoriesData: function () {\n        var categories = map(this.option.categories || [], function (category) {\n            // Data must has value\n            return category.value != null ? category : extend({\n                value: 0\n            }, category);\n        });\n        var categoriesData = new List(['value'], this);\n        categoriesData.initData(categories);\n\n        this._categoriesData = categoriesData;\n\n        this._categoriesModels = categoriesData.mapArray(function (idx) {\n            return categoriesData.getItemModel(idx, true);\n        });\n    },\n\n    setZoom: function (zoom) {\n        this.option.zoom = zoom;\n    },\n\n    setCenter: function (center) {\n        this.option.center = center;\n    },\n\n    isAnimationEnabled: function () {\n        return GraphSeries.superCall(this, 'isAnimationEnabled')\n            // Not enable animation when do force layout\n            && !(this.get('layout') === 'force' && this.get('force.layoutAnimation'));\n    },\n\n    defaultOption: {\n        zlevel: 0,\n        z: 2,\n\n        coordinateSystem: 'view',\n\n        // Default option for all coordinate systems\n        // xAxisIndex: 0,\n        // yAxisIndex: 0,\n        // polarIndex: 0,\n        // geoIndex: 0,\n\n        legendHoverLink: true,\n\n        hoverAnimation: true,\n\n        layout: null,\n\n        focusNodeAdjacency: false,\n\n        // Configuration of circular layout\n        circular: {\n            rotateLabel: false\n        },\n        // Configuration of force directed layout\n        force: {\n            initLayout: null,\n            // Node repulsion. Can be an array to represent range.\n            repulsion: [0, 50],\n            gravity: 0.1,\n\n            // Edge length. Can be an array to represent range.\n            edgeLength: 30,\n\n            layoutAnimation: true\n        },\n\n        left: 'center',\n        top: 'center',\n        // right: null,\n        // bottom: null,\n        // width: '80%',\n        // height: '80%',\n\n        symbol: 'circle',\n        symbolSize: 10,\n\n        edgeSymbol: ['none', 'none'],\n        edgeSymbolSize: 10,\n        edgeLabel: {\n            position: 'middle'\n        },\n\n        draggable: false,\n\n        roam: false,\n\n        // Default on center of graph\n        center: null,\n\n        zoom: 1,\n        // Symbol size scale ratio in roam\n        nodeScaleRatio: 0.6,\n        // cursor: null,\n\n        // categories: [],\n\n        // data: []\n        // Or\n        // nodes: []\n        //\n        // links: []\n        // Or\n        // edges: []\n\n        label: {\n            show: false,\n            formatter: '{b}'\n        },\n\n        itemStyle: {},\n\n        lineStyle: {\n            color: '#aaa',\n            width: 1,\n            curveness: 0,\n            opacity: 0.5\n        },\n        emphasis: {\n            label: {\n                show: true\n            }\n        }\n    }\n});\n\n/**\n * Line path for bezier and straight line draw\n */\n\nvar straightLineProto = Line.prototype;\nvar bezierCurveProto = BezierCurve.prototype;\n\nfunction isLine(shape) {\n    return isNaN(+shape.cpx1) || isNaN(+shape.cpy1);\n}\n\nvar LinePath = extendShape({\n\n    type: 'ec-line',\n\n    style: {\n        stroke: '#000',\n        fill: null\n    },\n\n    shape: {\n        x1: 0,\n        y1: 0,\n        x2: 0,\n        y2: 0,\n        percent: 1,\n        cpx1: null,\n        cpy1: null\n    },\n\n    buildPath: function (ctx, shape) {\n        (isLine(shape) ? straightLineProto : bezierCurveProto).buildPath(ctx, shape);\n    },\n\n    pointAt: function (t) {\n        return isLine(this.shape)\n            ? straightLineProto.pointAt.call(this, t)\n            : bezierCurveProto.pointAt.call(this, t);\n    },\n\n    tangentAt: function (t) {\n        var shape = this.shape;\n        var p = isLine(shape)\n            ? [shape.x2 - shape.x1, shape.y2 - shape.y1]\n            : bezierCurveProto.tangentAt.call(this, t);\n        return normalize(p, p);\n    }\n});\n\n/**\n * @module echarts/chart/helper/Line\n */\n\nvar SYMBOL_CATEGORIES = ['fromSymbol', 'toSymbol'];\n\nfunction makeSymbolTypeKey(symbolCategory) {\n    return '_' + symbolCategory + 'Type';\n}\n/**\n * @inner\n */\nfunction createSymbol$1(name, lineData, idx) {\n    var color = lineData.getItemVisual(idx, 'color');\n    var symbolType = lineData.getItemVisual(idx, name);\n    var symbolSize = lineData.getItemVisual(idx, name + 'Size');\n\n    if (!symbolType || symbolType === 'none') {\n        return;\n    }\n\n    if (!isArray(symbolSize)) {\n        symbolSize = [symbolSize, symbolSize];\n    }\n    var symbolPath = createSymbol(\n        symbolType, -symbolSize[0] / 2, -symbolSize[1] / 2,\n        symbolSize[0], symbolSize[1], color\n    );\n\n    symbolPath.name = name;\n\n    return symbolPath;\n}\n\nfunction createLine(points) {\n    var line = new LinePath({\n        name: 'line'\n    });\n    setLinePoints(line.shape, points);\n    return line;\n}\n\nfunction setLinePoints(targetShape, points) {\n    var p1 = points[0];\n    var p2 = points[1];\n    var cp1 = points[2];\n    targetShape.x1 = p1[0];\n    targetShape.y1 = p1[1];\n    targetShape.x2 = p2[0];\n    targetShape.y2 = p2[1];\n    targetShape.percent = 1;\n\n    if (cp1) {\n        targetShape.cpx1 = cp1[0];\n        targetShape.cpy1 = cp1[1];\n    }\n    else {\n        targetShape.cpx1 = NaN;\n        targetShape.cpy1 = NaN;\n    }\n}\n\nfunction updateSymbolAndLabelBeforeLineUpdate () {\n    var lineGroup = this;\n    var symbolFrom = lineGroup.childOfName('fromSymbol');\n    var symbolTo = lineGroup.childOfName('toSymbol');\n    var label = lineGroup.childOfName('label');\n    // Quick reject\n    if (!symbolFrom && !symbolTo && label.ignore) {\n        return;\n    }\n\n    var invScale = 1;\n    var parentNode = this.parent;\n    while (parentNode) {\n        if (parentNode.scale) {\n            invScale /= parentNode.scale[0];\n        }\n        parentNode = parentNode.parent;\n    }\n\n    var line = lineGroup.childOfName('line');\n    // If line not changed\n    // FIXME Parent scale changed\n    if (!this.__dirty && !line.__dirty) {\n        return;\n    }\n\n    var percent = line.shape.percent;\n    var fromPos = line.pointAt(0);\n    var toPos = line.pointAt(percent);\n\n    var d = sub([], toPos, fromPos);\n    normalize(d, d);\n\n    if (symbolFrom) {\n        symbolFrom.attr('position', fromPos);\n        var tangent = line.tangentAt(0);\n        symbolFrom.attr('rotation', Math.PI / 2 - Math.atan2(\n            tangent[1], tangent[0]\n        ));\n        symbolFrom.attr('scale', [invScale * percent, invScale * percent]);\n    }\n    if (symbolTo) {\n        symbolTo.attr('position', toPos);\n        var tangent = line.tangentAt(1);\n        symbolTo.attr('rotation', -Math.PI / 2 - Math.atan2(\n            tangent[1], tangent[0]\n        ));\n        symbolTo.attr('scale', [invScale * percent, invScale * percent]);\n    }\n\n    if (!label.ignore) {\n        label.attr('position', toPos);\n\n        var textPosition;\n        var textAlign;\n        var textVerticalAlign;\n\n        var distance$$1 = 5 * invScale;\n        // End\n        if (label.__position === 'end') {\n            textPosition = [d[0] * distance$$1 + toPos[0], d[1] * distance$$1 + toPos[1]];\n            textAlign = d[0] > 0.8 ? 'left' : (d[0] < -0.8 ? 'right' : 'center');\n            textVerticalAlign = d[1] > 0.8 ? 'top' : (d[1] < -0.8 ? 'bottom' : 'middle');\n        }\n        // Middle\n        else if (label.__position === 'middle') {\n            var halfPercent = percent / 2;\n            var tangent = line.tangentAt(halfPercent);\n            var n = [tangent[1], -tangent[0]];\n            var cp = line.pointAt(halfPercent);\n            if (n[1] > 0) {\n                n[0] = -n[0];\n                n[1] = -n[1];\n            }\n            textPosition = [cp[0] + n[0] * distance$$1, cp[1] + n[1] * distance$$1];\n            textAlign = 'center';\n            textVerticalAlign = 'bottom';\n            var rotation = -Math.atan2(tangent[1], tangent[0]);\n            if (toPos[0] < fromPos[0]) {\n                rotation = Math.PI + rotation;\n            }\n            label.attr('rotation', rotation);\n        }\n        // Start\n        else {\n            textPosition = [-d[0] * distance$$1 + fromPos[0], -d[1] * distance$$1 + fromPos[1]];\n            textAlign = d[0] > 0.8 ? 'right' : (d[0] < -0.8 ? 'left' : 'center');\n            textVerticalAlign = d[1] > 0.8 ? 'bottom' : (d[1] < -0.8 ? 'top' : 'middle');\n        }\n        label.attr({\n            style: {\n                // Use the user specified text align and baseline first\n                textVerticalAlign: label.__verticalAlign || textVerticalAlign,\n                textAlign: label.__textAlign || textAlign\n            },\n            position: textPosition,\n            scale: [invScale, invScale]\n        });\n    }\n}\n\n/**\n * @constructor\n * @extends {module:zrender/graphic/Group}\n * @alias {module:echarts/chart/helper/Line}\n */\nfunction Line$1(lineData, idx, seriesScope) {\n    Group.call(this);\n\n    this._createLine(lineData, idx, seriesScope);\n}\n\nvar lineProto = Line$1.prototype;\n\n// Update symbol position and rotation\nlineProto.beforeUpdate = updateSymbolAndLabelBeforeLineUpdate;\n\nlineProto._createLine = function (lineData, idx, seriesScope) {\n    var seriesModel = lineData.hostModel;\n    var linePoints = lineData.getItemLayout(idx);\n\n    var line = createLine(linePoints);\n    line.shape.percent = 0;\n    initProps(line, {\n        shape: {\n            percent: 1\n        }\n    }, seriesModel, idx);\n\n    this.add(line);\n\n    var label = new Text({\n        name: 'label'\n    });\n    this.add(label);\n\n    each$1(SYMBOL_CATEGORIES, function (symbolCategory) {\n        var symbol = createSymbol$1(symbolCategory, lineData, idx);\n        // symbols must added after line to make sure\n        // it will be updated after line#update.\n        // Or symbol position and rotation update in line#beforeUpdate will be one frame slow\n        this.add(symbol);\n        this[makeSymbolTypeKey(symbolCategory)] = lineData.getItemVisual(idx, symbolCategory);\n    }, this);\n\n    this._updateCommonStl(lineData, idx, seriesScope);\n};\n\nlineProto.updateData = function (lineData, idx, seriesScope) {\n    var seriesModel = lineData.hostModel;\n\n    var line = this.childOfName('line');\n    var linePoints = lineData.getItemLayout(idx);\n    var target = {\n        shape: {}\n    };\n    setLinePoints(target.shape, linePoints);\n    updateProps(line, target, seriesModel, idx);\n\n    each$1(SYMBOL_CATEGORIES, function (symbolCategory) {\n        var symbolType = lineData.getItemVisual(idx, symbolCategory);\n        var key = makeSymbolTypeKey(symbolCategory);\n        // Symbol changed\n        if (this[key] !== symbolType) {\n            this.remove(this.childOfName(symbolCategory));\n            var symbol = createSymbol$1(symbolCategory, lineData, idx);\n            this.add(symbol);\n        }\n        this[key] = symbolType;\n    }, this);\n\n    this._updateCommonStl(lineData, idx, seriesScope);\n};\n\nlineProto._updateCommonStl = function (lineData, idx, seriesScope) {\n    var seriesModel = lineData.hostModel;\n\n    var line = this.childOfName('line');\n\n    var lineStyle = seriesScope && seriesScope.lineStyle;\n    var hoverLineStyle = seriesScope && seriesScope.hoverLineStyle;\n    var labelModel = seriesScope && seriesScope.labelModel;\n    var hoverLabelModel = seriesScope && seriesScope.hoverLabelModel;\n\n    // Optimization for large dataset\n    if (!seriesScope || lineData.hasItemOption) {\n        var itemModel = lineData.getItemModel(idx);\n\n        lineStyle = itemModel.getModel('lineStyle').getLineStyle();\n        hoverLineStyle = itemModel.getModel('emphasis.lineStyle').getLineStyle();\n\n        labelModel = itemModel.getModel('label');\n        hoverLabelModel = itemModel.getModel('emphasis.label');\n    }\n\n    var visualColor = lineData.getItemVisual(idx, 'color');\n    var visualOpacity = retrieve3(\n        lineData.getItemVisual(idx, 'opacity'),\n        lineStyle.opacity,\n        1\n    );\n\n    line.useStyle(defaults(\n        {\n            strokeNoScale: true,\n            fill: 'none',\n            stroke: visualColor,\n            opacity: visualOpacity\n        },\n        lineStyle\n    ));\n    line.hoverStyle = hoverLineStyle;\n\n    // Update symbol\n    each$1(SYMBOL_CATEGORIES, function (symbolCategory) {\n        var symbol = this.childOfName(symbolCategory);\n        if (symbol) {\n            symbol.setColor(visualColor);\n            symbol.setStyle({\n                opacity: visualOpacity\n            });\n        }\n    }, this);\n\n    var showLabel = labelModel.getShallow('show');\n    var hoverShowLabel = hoverLabelModel.getShallow('show');\n\n    var label = this.childOfName('label');\n    var defaultLabelColor;\n    var normalText;\n    var emphasisText;\n\n    if (showLabel || hoverShowLabel) {\n        defaultLabelColor = visualColor || '#000';\n\n        normalText = seriesModel.getFormattedLabel(idx, 'normal', lineData.dataType);\n        if (normalText == null) {\n            var rawVal = seriesModel.getRawValue(idx);\n            normalText = rawVal == null\n                ? lineData.getName(idx)\n                : isFinite(rawVal)\n                ? round$1(rawVal)\n                : rawVal;\n        }\n        emphasisText = retrieve2(\n            seriesModel.getFormattedLabel(idx, 'emphasis', lineData.dataType),\n            normalText\n        );\n    }\n\n    // label.afterUpdate = lineAfterUpdate;\n    if (showLabel) {\n        var labelStyle = setTextStyle(label.style, labelModel, {\n            text: normalText\n        }, {\n            autoColor: defaultLabelColor\n        });\n\n        label.__textAlign = labelStyle.textAlign;\n        label.__verticalAlign = labelStyle.textVerticalAlign;\n        // 'start', 'middle', 'end'\n        label.__position = labelModel.get('position') || 'middle';\n    }\n    else {\n        label.setStyle('text', null);\n    }\n\n    if (hoverShowLabel) {\n        // Only these properties supported in this emphasis style here.\n        label.hoverStyle = {\n            text: emphasisText,\n            textFill: hoverLabelModel.getTextColor(true),\n            // For merging hover style to normal style, do not use\n            // `hoverLabelModel.getFont()` here.\n            fontStyle: hoverLabelModel.getShallow('fontStyle'),\n            fontWeight: hoverLabelModel.getShallow('fontWeight'),\n            fontSize: hoverLabelModel.getShallow('fontSize'),\n            fontFamily: hoverLabelModel.getShallow('fontFamily')\n        };\n    }\n    else {\n        label.hoverStyle = {\n            text: null\n        };\n    }\n\n    label.ignore = !showLabel && !hoverShowLabel;\n\n    setHoverStyle(this);\n};\n\nlineProto.highlight = function () {\n    this.trigger('emphasis');\n};\n\nlineProto.downplay = function () {\n    this.trigger('normal');\n};\n\nlineProto.updateLayout = function (lineData, idx) {\n    this.setLinePoints(lineData.getItemLayout(idx));\n};\n\nlineProto.setLinePoints = function (points) {\n    var linePath = this.childOfName('line');\n    setLinePoints(linePath.shape, points);\n    linePath.dirty();\n};\n\ninherits(Line$1, Group);\n\n/**\n * @module echarts/chart/helper/LineDraw\n */\n\n// import IncrementalDisplayable from 'zrender/src/graphic/IncrementalDisplayable';\n\n/**\n * @alias module:echarts/component/marker/LineDraw\n * @constructor\n */\nfunction LineDraw(ctor) {\n    this._ctor = ctor || Line$1;\n\n    this.group = new Group();\n}\n\nvar lineDrawProto = LineDraw.prototype;\n\nlineDrawProto.isPersistent = function () {\n    return true;\n};\n\n/**\n * @param {module:echarts/data/List} lineData\n */\nlineDrawProto.updateData = function (lineData) {\n    var lineDraw = this;\n    var group = lineDraw.group;\n\n    var oldLineData = lineDraw._lineData;\n    lineDraw._lineData = lineData;\n\n    // There is no oldLineData only when first rendering or switching from\n    // stream mode to normal mode, where previous elements should be removed.\n    if (!oldLineData) {\n        group.removeAll();\n    }\n\n    var seriesScope = makeSeriesScope$1(lineData);\n\n    lineData.diff(oldLineData)\n        .add(function (idx) {\n            doAdd(lineDraw, lineData, idx, seriesScope);\n        })\n        .update(function (newIdx, oldIdx) {\n            doUpdate(lineDraw, oldLineData, lineData, oldIdx, newIdx, seriesScope);\n        })\n        .remove(function (idx) {\n            group.remove(oldLineData.getItemGraphicEl(idx));\n        })\n        .execute();\n};\n\nfunction doAdd(lineDraw, lineData, idx, seriesScope) {\n    var itemLayout = lineData.getItemLayout(idx);\n\n    if (!lineNeedsDraw(itemLayout)) {\n        return;\n    }\n\n    var el = new lineDraw._ctor(lineData, idx, seriesScope);\n    lineData.setItemGraphicEl(idx, el);\n    lineDraw.group.add(el);\n}\n\nfunction doUpdate(lineDraw, oldLineData, newLineData, oldIdx, newIdx, seriesScope) {\n    var itemEl = oldLineData.getItemGraphicEl(oldIdx);\n\n    if (!lineNeedsDraw(newLineData.getItemLayout(newIdx))) {\n        lineDraw.group.remove(itemEl);\n        return;\n    }\n\n    if (!itemEl) {\n        itemEl = new lineDraw._ctor(newLineData, newIdx, seriesScope);\n    }\n    else {\n        itemEl.updateData(newLineData, newIdx, seriesScope);\n    }\n\n    newLineData.setItemGraphicEl(newIdx, itemEl);\n\n    lineDraw.group.add(itemEl);\n}\n\nlineDrawProto.updateLayout = function () {\n    var lineData = this._lineData;\n    lineData.eachItemGraphicEl(function (el, idx) {\n        el.updateLayout(lineData, idx);\n    }, this);\n};\n\nlineDrawProto.incrementalPrepareUpdate = function (lineData) {\n    this._seriesScope = makeSeriesScope$1(lineData);\n    this._lineData = null;\n    this.group.removeAll();\n};\n\nlineDrawProto.incrementalUpdate = function (taskParams, lineData) {\n    function updateIncrementalAndHover(el) {\n        if (!el.isGroup) {\n            el.incremental = el.useHoverLayer = true;\n        }\n    }\n\n    for (var idx = taskParams.start; idx < taskParams.end; idx++) {\n        var itemLayout = lineData.getItemLayout(idx);\n\n        if (lineNeedsDraw(itemLayout)) {\n            var el = new this._ctor(lineData, idx, this._seriesScope);\n            el.traverse(updateIncrementalAndHover);\n            this.group.add(el);\n        }\n    }\n};\n\nfunction makeSeriesScope$1(lineData) {\n    var hostModel = lineData.hostModel;\n    return {\n        lineStyle: hostModel.getModel('lineStyle').getLineStyle(),\n        hoverLineStyle: hostModel.getModel('emphasis.lineStyle').getLineStyle(),\n        labelModel: hostModel.getModel('label'),\n        hoverLabelModel: hostModel.getModel('emphasis.label')\n    };\n}\n\nlineDrawProto.remove = function () {\n    this._clearIncremental();\n    this._incremental = null;\n    this.group.removeAll();\n};\n\nlineDrawProto._clearIncremental = function () {\n    var incremental = this._incremental;\n    if (incremental) {\n        incremental.clearDisplaybles();\n    }\n};\n\nfunction isPointNaN(pt) {\n    return isNaN(pt[0]) || isNaN(pt[1]);\n}\n\nfunction lineNeedsDraw(pts) {\n    return !isPointNaN(pts[0]) && !isPointNaN(pts[1]);\n}\n\nvar v1 = [];\nvar v2 = [];\nvar v3 = [];\nvar quadraticAt$1 = quadraticAt;\nvar v2DistSquare = distSquare;\nvar mathAbs$1 = Math.abs;\nfunction intersectCurveCircle(curvePoints, center, radius) {\n    var p0 = curvePoints[0];\n    var p1 = curvePoints[1];\n    var p2 = curvePoints[2];\n\n    var d = Infinity;\n    var t;\n    var radiusSquare = radius * radius;\n    var interval = 0.1;\n\n    for (var _t = 0.1; _t <= 0.9; _t += 0.1) {\n        v1[0] = quadraticAt$1(p0[0], p1[0], p2[0], _t);\n        v1[1] = quadraticAt$1(p0[1], p1[1], p2[1], _t);\n        var diff = mathAbs$1(v2DistSquare(v1, center) - radiusSquare);\n        if (diff < d) {\n            d = diff;\n            t = _t;\n        }\n    }\n\n    // Assume the segment is monotoneFind root through Bisection method\n    // At most 32 iteration\n    for (var i = 0; i < 32; i++) {\n        // var prev = t - interval;\n        var next = t + interval;\n        // v1[0] = quadraticAt(p0[0], p1[0], p2[0], prev);\n        // v1[1] = quadraticAt(p0[1], p1[1], p2[1], prev);\n        v2[0] = quadraticAt$1(p0[0], p1[0], p2[0], t);\n        v2[1] = quadraticAt$1(p0[1], p1[1], p2[1], t);\n        v3[0] = quadraticAt$1(p0[0], p1[0], p2[0], next);\n        v3[1] = quadraticAt$1(p0[1], p1[1], p2[1], next);\n\n        var diff = v2DistSquare(v2, center) - radiusSquare;\n        if (mathAbs$1(diff) < 1e-2) {\n            break;\n        }\n\n        // var prevDiff = v2DistSquare(v1, center) - radiusSquare;\n        var nextDiff = v2DistSquare(v3, center) - radiusSquare;\n\n        interval /= 2;\n        if (diff < 0) {\n            if (nextDiff >= 0) {\n                t = t + interval;\n            }\n            else {\n                t = t - interval;\n            }\n        }\n        else {\n            if (nextDiff >= 0) {\n                t = t - interval;\n            }\n            else {\n                t = t + interval;\n            }\n        }\n    }\n\n    return t;\n}\n\n// Adjust edge to avoid\nvar adjustEdge = function (graph, scale$$1) {\n    var tmp0 = [];\n    var quadraticSubdivide$$1 = quadraticSubdivide;\n    var pts = [[], [], []];\n    var pts2 = [[], []];\n    var v = [];\n    scale$$1 /= 2;\n\n    function getSymbolSize(node) {\n        var symbolSize = node.getVisual('symbolSize');\n        if (symbolSize instanceof Array) {\n            symbolSize = (symbolSize[0] + symbolSize[1]) / 2;\n        }\n        return symbolSize;\n    }\n    graph.eachEdge(function (edge, idx) {\n        var linePoints = edge.getLayout();\n        var fromSymbol = edge.getVisual('fromSymbol');\n        var toSymbol = edge.getVisual('toSymbol');\n\n        if (!linePoints.__original) {\n            linePoints.__original = [\n                clone$1(linePoints[0]),\n                clone$1(linePoints[1])\n            ];\n            if (linePoints[2]) {\n                linePoints.__original.push(clone$1(linePoints[2]));\n            }\n        }\n        var originalPoints = linePoints.__original;\n        // Quadratic curve\n        if (linePoints[2] != null) {\n            copy(pts[0], originalPoints[0]);\n            copy(pts[1], originalPoints[2]);\n            copy(pts[2], originalPoints[1]);\n            if (fromSymbol && fromSymbol != 'none') {\n                var symbolSize = getSymbolSize(edge.node1);\n\n                var t = intersectCurveCircle(pts, originalPoints[0], symbolSize * scale$$1);\n                // Subdivide and get the second\n                quadraticSubdivide$$1(pts[0][0], pts[1][0], pts[2][0], t, tmp0);\n                pts[0][0] = tmp0[3];\n                pts[1][0] = tmp0[4];\n                quadraticSubdivide$$1(pts[0][1], pts[1][1], pts[2][1], t, tmp0);\n                pts[0][1] = tmp0[3];\n                pts[1][1] = tmp0[4];\n            }\n            if (toSymbol && toSymbol != 'none') {\n                var symbolSize = getSymbolSize(edge.node2);\n\n                var t = intersectCurveCircle(pts, originalPoints[1], symbolSize * scale$$1);\n                // Subdivide and get the first\n                quadraticSubdivide$$1(pts[0][0], pts[1][0], pts[2][0], t, tmp0);\n                pts[1][0] = tmp0[1];\n                pts[2][0] = tmp0[2];\n                quadraticSubdivide$$1(pts[0][1], pts[1][1], pts[2][1], t, tmp0);\n                pts[1][1] = tmp0[1];\n                pts[2][1] = tmp0[2];\n            }\n            // Copy back to layout\n            copy(linePoints[0], pts[0]);\n            copy(linePoints[1], pts[2]);\n            copy(linePoints[2], pts[1]);\n        }\n        // Line\n        else {\n            copy(pts2[0], originalPoints[0]);\n            copy(pts2[1], originalPoints[1]);\n\n            sub(v, pts2[1], pts2[0]);\n            normalize(v, v);\n            if (fromSymbol && fromSymbol != 'none') {\n\n                var symbolSize = getSymbolSize(edge.node1);\n\n                scaleAndAdd(pts2[0], pts2[0], v, symbolSize * scale$$1);\n            }\n            if (toSymbol && toSymbol != 'none') {\n                var symbolSize = getSymbolSize(edge.node2);\n\n                scaleAndAdd(pts2[1], pts2[1], v, -symbolSize * scale$$1);\n            }\n            copy(linePoints[0], pts2[0]);\n            copy(linePoints[1], pts2[1]);\n        }\n    });\n};\n\nvar nodeOpacityPath = ['itemStyle', 'opacity'];\nvar lineOpacityPath = ['lineStyle', 'opacity'];\n\nfunction getItemOpacity(item, opacityPath) {\n    return item.getVisual('opacity') || item.getModel().get(opacityPath);\n}\n\nfunction fadeOutItem(item, opacityPath, opacityRatio) {\n    var el = item.getGraphicEl();\n\n    var opacity = getItemOpacity(item, opacityPath);\n    if (opacityRatio != null) {\n        opacity == null && (opacity = 1);\n        opacity *= opacityRatio;\n    }\n\n    el.downplay && el.downplay();\n    el.traverse(function (child) {\n        if (child.type !== 'group') {\n            child.setStyle('opacity', opacity);\n        }\n    });\n}\n\nfunction fadeInItem(item, opacityPath) {\n    var opacity = getItemOpacity(item, opacityPath);\n    var el = item.getGraphicEl();\n\n    el.highlight && el.highlight();\n    el.traverse(function (child) {\n        if (child.type !== 'group') {\n            child.setStyle('opacity', opacity);\n        }\n    });\n}\n\nextendChartView({\n\n    type: 'graph',\n\n    init: function (ecModel, api) {\n        var symbolDraw = new SymbolDraw();\n        var lineDraw = new LineDraw();\n        var group = this.group;\n\n        this._controller = new RoamController(api.getZr());\n        this._controllerHost = {target: group};\n\n        group.add(symbolDraw.group);\n        group.add(lineDraw.group);\n\n        this._symbolDraw = symbolDraw;\n        this._lineDraw = lineDraw;\n\n        this._firstRender = true;\n    },\n\n    render: function (seriesModel, ecModel, api) {\n        var coordSys = seriesModel.coordinateSystem;\n\n        this._model = seriesModel;\n        this._nodeScaleRatio = seriesModel.get('nodeScaleRatio');\n\n        var symbolDraw = this._symbolDraw;\n        var lineDraw = this._lineDraw;\n\n        var group = this.group;\n\n        if (coordSys.type === 'view') {\n            var groupNewProp = {\n                position: coordSys.position,\n                scale: coordSys.scale\n            };\n            if (this._firstRender) {\n                group.attr(groupNewProp);\n            }\n            else {\n                updateProps(group, groupNewProp, seriesModel);\n            }\n        }\n        // Fix edge contact point with node\n        adjustEdge(seriesModel.getGraph(), this._getNodeGlobalScale(seriesModel));\n\n        var data = seriesModel.getData();\n        symbolDraw.updateData(data);\n\n        var edgeData = seriesModel.getEdgeData();\n        lineDraw.updateData(edgeData);\n\n        this._updateNodeAndLinkScale();\n\n        this._updateController(seriesModel, ecModel, api);\n\n        clearTimeout(this._layoutTimeout);\n        var forceLayout = seriesModel.forceLayout;\n        var layoutAnimation = seriesModel.get('force.layoutAnimation');\n        if (forceLayout) {\n            this._startForceLayoutIteration(forceLayout, layoutAnimation);\n        }\n\n        data.eachItemGraphicEl(function (el, idx) {\n            var itemModel = data.getItemModel(idx);\n            // Update draggable\n            el.off('drag').off('dragend');\n            var draggable = data.getItemModel(idx).get('draggable');\n            if (draggable) {\n                el.on('drag', function () {\n                    if (forceLayout) {\n                        forceLayout.warmUp();\n                        !this._layouting\n                            && this._startForceLayoutIteration(forceLayout, layoutAnimation);\n                        forceLayout.setFixed(idx);\n                        // Write position back to layout\n                        data.setItemLayout(idx, el.position);\n                    }\n                }, this).on('dragend', function () {\n                    if (forceLayout) {\n                        forceLayout.setUnfixed(idx);\n                    }\n                }, this);\n            }\n            el.setDraggable(draggable && forceLayout);\n\n            el.off('mouseover', el.__focusNodeAdjacency);\n            el.off('mouseout', el.__unfocusNodeAdjacency);\n\n            if (itemModel.get('focusNodeAdjacency')) {\n                el.on('mouseover', el.__focusNodeAdjacency = function () {\n                    api.dispatchAction({\n                        type: 'focusNodeAdjacency',\n                        seriesId: seriesModel.id,\n                        dataIndex: el.dataIndex\n                    });\n                });\n                el.on('mouseout', el.__unfocusNodeAdjacency = function () {\n                    api.dispatchAction({\n                        type: 'unfocusNodeAdjacency',\n                        seriesId: seriesModel.id\n                    });\n                });\n\n            }\n\n        }, this);\n\n        data.graph.eachEdge(function (edge) {\n            var el = edge.getGraphicEl();\n\n            el.off('mouseover', el.__focusNodeAdjacency);\n            el.off('mouseout', el.__unfocusNodeAdjacency);\n\n            if (edge.getModel().get('focusNodeAdjacency')) {\n                el.on('mouseover', el.__focusNodeAdjacency = function () {\n                    api.dispatchAction({\n                        type: 'focusNodeAdjacency',\n                        seriesId: seriesModel.id,\n                        edgeDataIndex: edge.dataIndex\n                    });\n                });\n                el.on('mouseout', el.__unfocusNodeAdjacency = function () {\n                    api.dispatchAction({\n                        type: 'unfocusNodeAdjacency',\n                        seriesId: seriesModel.id\n                    });\n                });\n            }\n        });\n\n        var circularRotateLabel = seriesModel.get('layout') === 'circular'\n            && seriesModel.get('circular.rotateLabel');\n        var cx = data.getLayout('cx');\n        var cy = data.getLayout('cy');\n        data.eachItemGraphicEl(function (el, idx) {\n            var symbolPath = el.getSymbolPath();\n            if (circularRotateLabel) {\n                var pos = data.getItemLayout(idx);\n                var rad = Math.atan2(pos[1] - cy, pos[0] - cx);\n                if (rad < 0) {\n                    rad = Math.PI * 2 + rad;\n                }\n                var isLeft = pos[0] < cx;\n                if (isLeft) {\n                    rad = rad - Math.PI;\n                }\n                var textPosition = isLeft ? 'left' : 'right';\n                symbolPath.setStyle({\n                    textRotation: -rad,\n                    textPosition: textPosition,\n                    textOrigin: 'center'\n                });\n                symbolPath.hoverStyle && (symbolPath.hoverStyle.textPosition = textPosition);\n            }\n            else {\n                symbolPath.setStyle({\n                    textRotation: 0\n                });\n            }\n        });\n\n        this._firstRender = false;\n    },\n\n    dispose: function () {\n        this._controller && this._controller.dispose();\n        this._controllerHost = {};\n    },\n\n    focusNodeAdjacency: function (seriesModel, ecModel, api, payload) {\n        var data = this._model.getData();\n        var graph = data.graph;\n        var dataIndex = payload.dataIndex;\n        var edgeDataIndex = payload.edgeDataIndex;\n\n        var node = graph.getNodeByIndex(dataIndex);\n        var edge = graph.getEdgeByIndex(edgeDataIndex);\n\n        if (!node && !edge) {\n            return;\n        }\n\n        graph.eachNode(function (node) {\n            fadeOutItem(node, nodeOpacityPath, 0.1);\n        });\n        graph.eachEdge(function (edge) {\n            fadeOutItem(edge, lineOpacityPath, 0.1);\n        });\n\n        if (node) {\n            fadeInItem(node, nodeOpacityPath);\n            each$1(node.edges, function (adjacentEdge) {\n                if (adjacentEdge.dataIndex < 0) {\n                    return;\n                }\n                fadeInItem(adjacentEdge, lineOpacityPath);\n                fadeInItem(adjacentEdge.node1, nodeOpacityPath);\n                fadeInItem(adjacentEdge.node2, nodeOpacityPath);\n            });\n        }\n        if (edge) {\n            fadeInItem(edge, lineOpacityPath);\n            fadeInItem(edge.node1, nodeOpacityPath);\n            fadeInItem(edge.node2, nodeOpacityPath);\n        }\n    },\n\n    unfocusNodeAdjacency: function (seriesModel, ecModel, api, payload) {\n        var graph = this._model.getData().graph;\n\n        graph.eachNode(function (node) {\n            fadeOutItem(node, nodeOpacityPath);\n        });\n        graph.eachEdge(function (edge) {\n            fadeOutItem(edge, lineOpacityPath);\n        });\n    },\n\n    _startForceLayoutIteration: function (forceLayout, layoutAnimation) {\n        var self = this;\n        (function step() {\n            forceLayout.step(function (stopped) {\n                self.updateLayout(self._model);\n                (self._layouting = !stopped) && (\n                    layoutAnimation\n                        ? (self._layoutTimeout = setTimeout(step, 16))\n                        : step()\n                );\n            });\n        })();\n    },\n\n    _updateController: function (seriesModel, ecModel, api) {\n        var controller = this._controller;\n        var controllerHost = this._controllerHost;\n        var group = this.group;\n\n        controller.setPointerChecker(function (e, x, y) {\n            var rect = group.getBoundingRect();\n            rect.applyTransform(group.transform);\n            return rect.contain(x, y)\n                && !onIrrelevantElement(e, api, seriesModel);\n        });\n\n        if (seriesModel.coordinateSystem.type !== 'view') {\n            controller.disable();\n            return;\n        }\n        controller.enable(seriesModel.get('roam'));\n        controllerHost.zoomLimit = seriesModel.get('scaleLimit');\n        controllerHost.zoom = seriesModel.coordinateSystem.getZoom();\n\n        controller\n            .off('pan')\n            .off('zoom')\n            .on('pan', function (dx, dy) {\n                updateViewOnPan(controllerHost, dx, dy);\n                api.dispatchAction({\n                    seriesId: seriesModel.id,\n                    type: 'graphRoam',\n                    dx: dx,\n                    dy: dy\n                });\n            })\n            .on('zoom', function (zoom, mouseX, mouseY) {\n                updateViewOnZoom(controllerHost, zoom, mouseX, mouseY);\n                api.dispatchAction({\n                    seriesId: seriesModel.id,\n                    type: 'graphRoam',\n                    zoom:  zoom,\n                    originX: mouseX,\n                    originY: mouseY\n                });\n                this._updateNodeAndLinkScale();\n                adjustEdge(seriesModel.getGraph(), this._getNodeGlobalScale(seriesModel));\n                this._lineDraw.updateLayout();\n            }, this);\n    },\n\n    _updateNodeAndLinkScale: function () {\n        var seriesModel = this._model;\n        var data = seriesModel.getData();\n\n        var nodeScale = this._getNodeGlobalScale(seriesModel);\n        var invScale = [nodeScale, nodeScale];\n\n        data.eachItemGraphicEl(function (el, idx) {\n            el.attr('scale', invScale);\n        });\n    },\n\n    _getNodeGlobalScale: function (seriesModel) {\n        var coordSys = seriesModel.coordinateSystem;\n        if (coordSys.type !== 'view') {\n            return 1;\n        }\n\n        var nodeScaleRatio = this._nodeScaleRatio;\n\n        var groupScale = coordSys.scale;\n        var groupZoom = (groupScale && groupScale[0]) || 1;\n        // Scale node when zoom changes\n        var roamZoom = coordSys.getZoom();\n        var nodeScale = (roamZoom - 1) * nodeScaleRatio + 1;\n\n        return nodeScale / groupZoom;\n    },\n\n    updateLayout: function (seriesModel) {\n        adjustEdge(seriesModel.getGraph(), this._getNodeGlobalScale(seriesModel));\n\n        this._symbolDraw.updateLayout();\n        this._lineDraw.updateLayout();\n    },\n\n    remove: function (ecModel, api) {\n        this._symbolDraw && this._symbolDraw.remove();\n        this._lineDraw && this._lineDraw.remove();\n    }\n});\n\nvar actionInfo = {\n    type: 'graphRoam',\n    event: 'graphRoam',\n    update: 'none'\n};\n\n/**\n * @payload\n * @property {string} name Series name\n * @property {number} [dx]\n * @property {number} [dy]\n * @property {number} [zoom]\n * @property {number} [originX]\n * @property {number} [originY]\n */\nregisterAction(actionInfo, function (payload, ecModel) {\n    ecModel.eachComponent({mainType: 'series', query: payload}, function (seriesModel) {\n        var coordSys = seriesModel.coordinateSystem;\n\n        var res = updateCenterAndZoom(coordSys, payload);\n\n        seriesModel.setCenter\n            && seriesModel.setCenter(res.center);\n\n        seriesModel.setZoom\n            && seriesModel.setZoom(res.zoom);\n    });\n});\n\n\n/**\n * @payload\n * @property {number} [seriesIndex]\n * @property {string} [seriesId]\n * @property {string} [seriesName]\n * @property {number} [dataIndex]\n */\nregisterAction({\n    type: 'focusNodeAdjacency',\n    event: 'focusNodeAdjacency',\n    update: 'series.graph:focusNodeAdjacency'\n}, function () {});\n\n/**\n * @payload\n * @property {number} [seriesIndex]\n * @property {string} [seriesId]\n * @property {string} [seriesName]\n */\nregisterAction({\n    type: 'unfocusNodeAdjacency',\n    event: 'unfocusNodeAdjacency',\n    update: 'series.graph:unfocusNodeAdjacency'\n}, function () {});\n\nvar categoryFilter = function (ecModel) {\n    var legendModels = ecModel.findComponents({\n        mainType: 'legend'\n    });\n    if (!legendModels || !legendModels.length) {\n        return;\n    }\n    ecModel.eachSeriesByType('graph', function (graphSeries) {\n        var categoriesData = graphSeries.getCategoriesData();\n        var graph = graphSeries.getGraph();\n        var data = graph.data;\n\n        var categoryNames = categoriesData.mapArray(categoriesData.getName);\n\n        data.filterSelf(function (idx) {\n            var model = data.getItemModel(idx);\n            var category = model.getShallow('category');\n            if (category != null) {\n                if (typeof category === 'number') {\n                    category = categoryNames[category];\n                }\n                // If in any legend component the status is not selected.\n                for (var i = 0; i < legendModels.length; i++) {\n                    if (!legendModels[i].isSelected(category)) {\n                        return false;\n                    }\n                }\n            }\n            return true;\n        });\n    }, this);\n};\n\nvar categoryVisual = function (ecModel) {\n\n    var paletteScope = {};\n    ecModel.eachSeriesByType('graph', function (seriesModel) {\n        var categoriesData = seriesModel.getCategoriesData();\n        var data = seriesModel.getData();\n\n        var categoryNameIdxMap = {};\n\n        categoriesData.each(function (idx) {\n            var name = categoriesData.getName(idx);\n            // Add prefix to avoid conflict with Object.prototype.\n            categoryNameIdxMap['ec-' + name] = idx;\n\n            var itemModel = categoriesData.getItemModel(idx);\n            var color = itemModel.get('itemStyle.color')\n                || seriesModel.getColorFromPalette(name, paletteScope);\n            categoriesData.setItemVisual(idx, 'color', color);\n        });\n\n        // Assign category color to visual\n        if (categoriesData.count()) {\n            data.each(function (idx) {\n                var model = data.getItemModel(idx);\n                var category = model.getShallow('category');\n                if (category != null) {\n                    if (typeof category === 'string') {\n                        category = categoryNameIdxMap['ec-' + category];\n                    }\n                    if (!data.getItemVisual(idx, 'color', true)) {\n                        data.setItemVisual(\n                            idx, 'color',\n                            categoriesData.getItemVisual(category, 'color')\n                        );\n                    }\n                }\n            });\n        }\n    });\n};\n\nfunction normalize$1(a) {\n    if (!(a instanceof Array)) {\n        a = [a, a];\n    }\n    return a;\n}\n\nvar edgeVisual = function (ecModel) {\n    ecModel.eachSeriesByType('graph', function (seriesModel) {\n        var graph = seriesModel.getGraph();\n        var edgeData = seriesModel.getEdgeData();\n        var symbolType = normalize$1(seriesModel.get('edgeSymbol'));\n        var symbolSize = normalize$1(seriesModel.get('edgeSymbolSize'));\n\n        var colorQuery = 'lineStyle.color'.split('.');\n        var opacityQuery = 'lineStyle.opacity'.split('.');\n\n        edgeData.setVisual('fromSymbol', symbolType && symbolType[0]);\n        edgeData.setVisual('toSymbol', symbolType && symbolType[1]);\n        edgeData.setVisual('fromSymbolSize', symbolSize && symbolSize[0]);\n        edgeData.setVisual('toSymbolSize', symbolSize && symbolSize[1]);\n        edgeData.setVisual('color', seriesModel.get(colorQuery));\n        edgeData.setVisual('opacity', seriesModel.get(opacityQuery));\n\n        edgeData.each(function (idx) {\n            var itemModel = edgeData.getItemModel(idx);\n            var edge = graph.getEdgeByIndex(idx);\n            var symbolType = normalize$1(itemModel.getShallow('symbol', true));\n            var symbolSize = normalize$1(itemModel.getShallow('symbolSize', true));\n            // Edge visual must after node visual\n            var color = itemModel.get(colorQuery);\n            var opacity = itemModel.get(opacityQuery);\n            switch (color) {\n                case 'source':\n                    color = edge.node1.getVisual('color');\n                    break;\n                case 'target':\n                    color = edge.node2.getVisual('color');\n                    break;\n            }\n\n            symbolType[0] && edge.setVisual('fromSymbol', symbolType[0]);\n            symbolType[1] && edge.setVisual('toSymbol', symbolType[1]);\n            symbolSize[0] && edge.setVisual('fromSymbolSize', symbolSize[0]);\n            symbolSize[1] && edge.setVisual('toSymbolSize', symbolSize[1]);\n\n            edge.setVisual('color', color);\n            edge.setVisual('opacity', opacity);\n        });\n    });\n};\n\nfunction simpleLayout$1(seriesModel) {\n    var coordSys = seriesModel.coordinateSystem;\n    if (coordSys && coordSys.type !== 'view') {\n        return;\n    }\n    var graph = seriesModel.getGraph();\n\n    graph.eachNode(function (node) {\n        var model = node.getModel();\n        node.setLayout([+model.get('x'), +model.get('y')]);\n    });\n\n    simpleLayoutEdge(graph);\n}\n\nfunction simpleLayoutEdge(graph) {\n    graph.eachEdge(function (edge) {\n        var curveness = edge.getModel().get('lineStyle.curveness') || 0;\n        var p1 = clone$1(edge.node1.getLayout());\n        var p2 = clone$1(edge.node2.getLayout());\n        var points = [p1, p2];\n        if (+curveness) {\n            points.push([\n                (p1[0] + p2[0]) / 2 - (p1[1] - p2[1]) * curveness,\n                (p1[1] + p2[1]) / 2 - (p2[0] - p1[0]) * curveness\n            ]);\n        }\n        edge.setLayout(points);\n    });\n}\n\nvar simpleLayout = function (ecModel, api) {\n    ecModel.eachSeriesByType('graph', function (seriesModel) {\n        var layout = seriesModel.get('layout');\n        var coordSys = seriesModel.coordinateSystem;\n        if (coordSys && coordSys.type !== 'view') {\n            var data = seriesModel.getData();\n\n            var dimensions = [];\n            each$1(coordSys.dimensions, function (coordDim) {\n                dimensions = dimensions.concat(data.mapDimension(coordDim, true));\n            });\n\n            for (var dataIndex = 0; dataIndex < data.count(); dataIndex++) {\n                var value = [];\n                var hasValue = false;\n                for (var i = 0; i < dimensions.length; i++) {\n                    var val = data.get(dimensions[i], dataIndex);\n                    if (!isNaN(val)) {\n                        hasValue = true;\n                    }\n                    value.push(val);\n                }\n                if (hasValue) {\n                    data.setItemLayout(dataIndex, coordSys.dataToPoint(value));\n                }\n                else {\n                    // Also {Array.<number>}, not undefined to avoid if...else... statement\n                    data.setItemLayout(dataIndex, [NaN, NaN]);\n                }\n            }\n\n            simpleLayoutEdge(data.graph);\n        }\n        else if (!layout || layout === 'none') {\n            simpleLayout$1(seriesModel);\n        }\n    });\n};\n\nfunction circularLayout$1(seriesModel) {\n    var coordSys = seriesModel.coordinateSystem;\n    if (coordSys && coordSys.type !== 'view') {\n        return;\n    }\n\n    var rect = coordSys.getBoundingRect();\n\n    var nodeData = seriesModel.getData();\n    var graph = nodeData.graph;\n\n    var angle = 0;\n    var sum = nodeData.getSum('value');\n    var unitAngle = Math.PI * 2 / (sum || nodeData.count());\n\n    var cx = rect.width / 2 + rect.x;\n    var cy = rect.height / 2 + rect.y;\n\n    var r = Math.min(rect.width, rect.height) / 2;\n\n    graph.eachNode(function (node) {\n        var value = node.getValue('value');\n\n        angle += unitAngle * (sum ? value : 1) / 2;\n\n        node.setLayout([\n            r * Math.cos(angle) + cx,\n            r * Math.sin(angle) + cy\n        ]);\n\n        angle += unitAngle * (sum ? value : 1) / 2;\n    });\n\n    nodeData.setLayout({\n        cx: cx,\n        cy: cy\n    });\n\n    graph.eachEdge(function (edge) {\n        var curveness = edge.getModel().get('lineStyle.curveness') || 0;\n        var p1 = clone$1(edge.node1.getLayout());\n        var p2 = clone$1(edge.node2.getLayout());\n        var cp1;\n        var x12 = (p1[0] + p2[0]) / 2;\n        var y12 = (p1[1] + p2[1]) / 2;\n        if (+curveness) {\n            curveness *= 3;\n            cp1 = [\n                cx * curveness + x12 * (1 - curveness),\n                cy * curveness + y12 * (1 - curveness)\n            ];\n        }\n        edge.setLayout([p1, p2, cp1]);\n    });\n}\n\nvar circularLayout = function (ecModel) {\n    ecModel.eachSeriesByType('graph', function (seriesModel) {\n        if (seriesModel.get('layout') === 'circular') {\n            circularLayout$1(seriesModel);\n        }\n    });\n};\n\nvar scaleAndAdd$2 = scaleAndAdd;\n\n// function adjacentNode(n, e) {\n//     return e.n1 === n ? e.n2 : e.n1;\n// }\n\nfunction forceLayout$1(nodes, edges, opts) {\n    var rect = opts.rect;\n    var width = rect.width;\n    var height = rect.height;\n    var center = [rect.x + width / 2, rect.y + height / 2];\n    // var scale = opts.scale || 1;\n    var gravity = opts.gravity == null ? 0.1 : opts.gravity;\n\n    // for (var i = 0; i < edges.length; i++) {\n    //     var e = edges[i];\n    //     var n1 = e.n1;\n    //     var n2 = e.n2;\n    //     n1.edges = n1.edges || [];\n    //     n2.edges = n2.edges || [];\n    //     n1.edges.push(e);\n    //     n2.edges.push(e);\n    // }\n    // Init position\n    for (var i = 0; i < nodes.length; i++) {\n        var n = nodes[i];\n        if (!n.p) {\n            // Use the position from first adjecent node with defined position\n            // Or use a random position\n            // From d3\n            // if (n.edges) {\n            //     var j = -1;\n            //     while (++j < n.edges.length) {\n            //         var e = n.edges[j];\n            //         var other = adjacentNode(n, e);\n            //         if (other.p) {\n            //             n.p = vec2.clone(other.p);\n            //             break;\n            //         }\n            //     }\n            // }\n            // if (!n.p) {\n                n.p = create(\n                    width * (Math.random() - 0.5) + center[0],\n                    height * (Math.random() - 0.5) + center[1]\n                );\n            // }\n        }\n        n.pp = clone$1(n.p);\n        n.edges = null;\n    }\n\n    // Formula in 'Graph Drawing by Force-directed Placement'\n    // var k = scale * Math.sqrt(width * height / nodes.length);\n    // var k2 = k * k;\n\n    var friction = 0.6;\n\n    return {\n        warmUp: function () {\n            friction = 0.5;\n        },\n\n        setFixed: function (idx) {\n            nodes[idx].fixed = true;\n        },\n\n        setUnfixed: function (idx) {\n            nodes[idx].fixed = false;\n        },\n\n        step: function (cb) {\n            var v12 = [];\n            var nLen = nodes.length;\n            for (var i = 0; i < edges.length; i++) {\n                var e = edges[i];\n                var n1 = e.n1;\n                var n2 = e.n2;\n\n                sub(v12, n2.p, n1.p);\n                var d = len(v12) - e.d;\n                var w = n2.w / (n1.w + n2.w);\n\n                if (isNaN(w)) {\n                    w = 0;\n                }\n\n                normalize(v12, v12);\n\n                !n1.fixed && scaleAndAdd$2(n1.p, n1.p, v12, w * d * friction);\n                !n2.fixed && scaleAndAdd$2(n2.p, n2.p, v12, -(1 - w) * d * friction);\n            }\n            // Gravity\n            for (var i = 0; i < nLen; i++) {\n                var n = nodes[i];\n                if (!n.fixed) {\n                    sub(v12, center, n.p);\n                    // var d = vec2.len(v12);\n                    // vec2.scale(v12, v12, 1 / d);\n                    // var gravityFactor = gravity;\n                    scaleAndAdd$2(n.p, n.p, v12, gravity * friction);\n                }\n            }\n\n            // Repulsive\n            // PENDING\n            for (var i = 0; i < nLen; i++) {\n                var n1 = nodes[i];\n                for (var j = i + 1; j < nLen; j++) {\n                    var n2 = nodes[j];\n                    sub(v12, n2.p, n1.p);\n                    var d = len(v12);\n                    if (d === 0) {\n                        // Random repulse\n                        set(v12, Math.random() - 0.5, Math.random() - 0.5);\n                        d = 1;\n                    }\n                    var repFact = (n1.rep + n2.rep) / d / d;\n                    !n1.fixed && scaleAndAdd$2(n1.pp, n1.pp, v12, repFact);\n                    !n2.fixed && scaleAndAdd$2(n2.pp, n2.pp, v12, -repFact);\n                }\n            }\n            var v = [];\n            for (var i = 0; i < nLen; i++) {\n                var n = nodes[i];\n                if (!n.fixed) {\n                    sub(v, n.p, n.pp);\n                    scaleAndAdd$2(n.p, n.p, v, friction);\n                    copy(n.pp, n.p);\n                }\n            }\n\n            friction = friction * 0.992;\n\n            cb && cb(nodes, edges, friction < 0.01);\n        }\n    };\n}\n\nvar forceLayout = function (ecModel) {\n    ecModel.eachSeriesByType('graph', function (graphSeries) {\n        var coordSys = graphSeries.coordinateSystem;\n        if (coordSys && coordSys.type !== 'view') {\n            return;\n        }\n        if (graphSeries.get('layout') === 'force') {\n            var preservedPoints = graphSeries.preservedPoints || {};\n            var graph = graphSeries.getGraph();\n            var nodeData = graph.data;\n            var edgeData = graph.edgeData;\n            var forceModel = graphSeries.getModel('force');\n            var initLayout = forceModel.get('initLayout');\n            if (graphSeries.preservedPoints) {\n                nodeData.each(function (idx) {\n                    var id = nodeData.getId(idx);\n                    nodeData.setItemLayout(idx, preservedPoints[id] || [NaN, NaN]);\n                });\n            }\n            else if (!initLayout || initLayout === 'none') {\n                simpleLayout$1(graphSeries);\n            }\n            else if (initLayout === 'circular') {\n                circularLayout$1(graphSeries);\n            }\n\n            var nodeDataExtent = nodeData.getDataExtent('value');\n            var edgeDataExtent = edgeData.getDataExtent('value');\n            // var edgeDataExtent = edgeData.getDataExtent('value');\n            var repulsion = forceModel.get('repulsion');\n            var edgeLength = forceModel.get('edgeLength');\n            if (!isArray(repulsion)) {\n                repulsion = [repulsion, repulsion];\n            }\n            if (!isArray(edgeLength)) {\n                edgeLength = [edgeLength, edgeLength];\n            }\n            // Larger value has smaller length\n            edgeLength = [edgeLength[1], edgeLength[0]];\n\n            var nodes = nodeData.mapArray('value', function (value, idx) {\n                var point = nodeData.getItemLayout(idx);\n                var rep = linearMap(value, nodeDataExtent, repulsion);\n                if (isNaN(rep)) {\n                    rep = (repulsion[0] + repulsion[1]) / 2;\n                }\n                return {\n                    w: rep,\n                    rep: rep,\n                    fixed: nodeData.getItemModel(idx).get('fixed'),\n                    p: (!point || isNaN(point[0]) || isNaN(point[1])) ? null : point\n                };\n            });\n            var edges = edgeData.mapArray('value', function (value, idx) {\n                var edge = graph.getEdgeByIndex(idx);\n                var d = linearMap(value, edgeDataExtent, edgeLength);\n                if (isNaN(d)) {\n                    d = (edgeLength[0] + edgeLength[1]) / 2;\n                }\n                return {\n                    n1: nodes[edge.node1.dataIndex],\n                    n2: nodes[edge.node2.dataIndex],\n                    d: d,\n                    curveness: edge.getModel().get('lineStyle.curveness') || 0\n                };\n            });\n\n            var coordSys = graphSeries.coordinateSystem;\n            var rect = coordSys.getBoundingRect();\n            var forceInstance = forceLayout$1(nodes, edges, {\n                rect: rect,\n                gravity: forceModel.get('gravity')\n            });\n            var oldStep = forceInstance.step;\n            forceInstance.step = function (cb) {\n                for (var i = 0, l = nodes.length; i < l; i++) {\n                    if (nodes[i].fixed) {\n                        // Write back to layout instance\n                        copy(nodes[i].p, graph.getNodeByIndex(i).getLayout());\n                    }\n                }\n                oldStep(function (nodes, edges, stopped) {\n                    for (var i = 0, l = nodes.length; i < l; i++) {\n                        if (!nodes[i].fixed) {\n                            graph.getNodeByIndex(i).setLayout(nodes[i].p);\n                        }\n                        preservedPoints[nodeData.getId(i)] = nodes[i].p;\n                    }\n                    for (var i = 0, l = edges.length; i < l; i++) {\n                        var e = edges[i];\n                        var edge = graph.getEdgeByIndex(i);\n                        var p1 = e.n1.p;\n                        var p2 = e.n2.p;\n                        var points = edge.getLayout();\n                        points = points ? points.slice() : [];\n                        points[0] = points[0] || [];\n                        points[1] = points[1] || [];\n                        copy(points[0], p1);\n                        copy(points[1], p2);\n                        if (+e.curveness) {\n                            points[2] = [\n                                (p1[0] + p2[0]) / 2 - (p1[1] - p2[1]) * e.curveness,\n                                (p1[1] + p2[1]) / 2 - (p2[0] - p1[0]) * e.curveness\n                            ];\n                        }\n                        edge.setLayout(points);\n                    }\n                    // Update layout\n\n                    cb && cb(stopped);\n                });\n            };\n            graphSeries.forceLayout = forceInstance;\n            graphSeries.preservedPoints = preservedPoints;\n\n            // Step to get the layout\n            forceInstance.step();\n        }\n        else {\n            // Remove prev injected forceLayout instance\n            graphSeries.forceLayout = null;\n        }\n    });\n};\n\n// FIXME Where to create the simple view coordinate system\nfunction getViewRect$1(seriesModel, api, aspect) {\n    var option = seriesModel.getBoxLayoutParams();\n    option.aspect = aspect;\n    return getLayoutRect(option, {\n        width: api.getWidth(),\n        height: api.getHeight()\n    });\n}\n\nvar createView = function (ecModel, api) {\n    var viewList = [];\n    ecModel.eachSeriesByType('graph', function (seriesModel) {\n        var coordSysType = seriesModel.get('coordinateSystem');\n        if (!coordSysType || coordSysType === 'view') {\n\n            var data = seriesModel.getData();\n            var positions = data.mapArray(function (idx) {\n                var itemModel = data.getItemModel(idx);\n                return [+itemModel.get('x'), +itemModel.get('y')];\n            });\n\n            var min = [];\n            var max = [];\n\n            fromPoints(positions, min, max);\n\n            // If width or height is 0\n            if (max[0] - min[0] === 0) {\n                max[0] += 1;\n                min[0] -= 1;\n            }\n            if (max[1] - min[1] === 0) {\n                max[1] += 1;\n                min[1] -= 1;\n            }\n            var aspect = (max[0] - min[0]) / (max[1] - min[1]);\n            // FIXME If get view rect after data processed?\n            var viewRect = getViewRect$1(seriesModel, api, aspect);\n            // Position may be NaN, use view rect instead\n            if (isNaN(aspect)) {\n                min = [viewRect.x, viewRect.y];\n                max = [viewRect.x + viewRect.width, viewRect.y + viewRect.height];\n            }\n\n            var bbWidth = max[0] - min[0];\n            var bbHeight = max[1] - min[1];\n\n            var viewWidth = viewRect.width;\n            var viewHeight = viewRect.height;\n\n            var viewCoordSys = seriesModel.coordinateSystem = new View();\n            viewCoordSys.zoomLimit = seriesModel.get('scaleLimit');\n\n            viewCoordSys.setBoundingRect(\n                min[0], min[1], bbWidth, bbHeight\n            );\n            viewCoordSys.setViewRect(\n                viewRect.x, viewRect.y, viewWidth, viewHeight\n            );\n\n            // Update roam info\n            viewCoordSys.setCenter(seriesModel.get('center'));\n            viewCoordSys.setZoom(seriesModel.get('zoom'));\n\n            viewList.push(viewCoordSys);\n        }\n    });\n\n    return viewList;\n};\n\nregisterProcessor(categoryFilter);\n\nregisterVisual(visualSymbol('graph', 'circle', null));\nregisterVisual(categoryVisual);\nregisterVisual(edgeVisual);\n\nregisterLayout(simpleLayout);\nregisterLayout(circularLayout);\nregisterLayout(forceLayout);\n\n// Graph view coordinate system\nregisterCoordinateSystem('graphView', {\n    create: createView\n});\n\nvar GaugeSeries = SeriesModel.extend({\n\n    type: 'series.gauge',\n\n    getInitialData: function (option, ecModel) {\n        var dataOpt = option.data || [];\n        if (!isArray(dataOpt)) {\n            dataOpt = [dataOpt];\n        }\n        option.data = dataOpt;\n        return createListSimply(this, ['value']);\n    },\n\n    defaultOption: {\n        zlevel: 0,\n        z: 2,\n        // \n        center: ['50%', '50%'],\n        legendHoverLink: true,\n        radius: '75%',\n        startAngle: 225,\n        endAngle: -45,\n        clockwise: true,\n        // \n        min: 0,\n        // \n        max: 100,\n        // 10\n        splitNumber: 10,\n        // \n        axisLine: {\n            // show\n            show: true,\n            lineStyle: {       // lineStyle\n                color: [[0.2, '#91c7ae'], [0.8, '#63869e'], [1, '#c23531']],\n                width: 30\n            }\n        },\n        // \n        splitLine: {\n            // show\n            show: true,\n            // length\n            length: 30,\n            // lineStylelineStyle\n            lineStyle: {\n                color: '#eee',\n                width: 2,\n                type: 'solid'\n            }\n        },\n        // \n        axisTick: {\n            // show\n            show: true,\n            // split\n            splitNumber: 5,\n            // length\n            length: 8,\n            // lineStyle\n            lineStyle: {\n                color: '#eee',\n                width: 1,\n                type: 'solid'\n            }\n        },\n        axisLabel: {\n            show: true,\n            distance: 5,\n            // formatter: null,\n            color: 'auto'\n        },\n        pointer: {\n            show: true,\n            length: '80%',\n            width: 8\n        },\n        itemStyle: {\n            color: 'auto'\n        },\n        title: {\n            show: true,\n            // x, ypx\n            offsetCenter: [0, '-40%'],\n            // TEXTSTYLE\n            color: '#333',\n            fontSize: 15\n        },\n        detail: {\n            show: true,\n            backgroundColor: 'rgba(0,0,0,0)',\n            borderWidth: 0,\n            borderColor: '#ccc',\n            width: 100,\n            height: null, // self-adaption\n            padding: [5, 10],\n            // x, ypx\n            offsetCenter: [0, '40%'],\n            // formatter: null,\n            // TEXTSTYLE\n            color: 'auto',\n            fontSize: 30\n        }\n    }\n});\n\nvar PointerPath = Path.extend({\n\n    type: 'echartsGaugePointer',\n\n    shape: {\n        angle: 0,\n\n        width: 10,\n\n        r: 10,\n\n        x: 0,\n\n        y: 0\n    },\n\n    buildPath: function (ctx, shape) {\n        var mathCos = Math.cos;\n        var mathSin = Math.sin;\n\n        var r = shape.r;\n        var width = shape.width;\n        var angle = shape.angle;\n        var x = shape.x - mathCos(angle) * width * (width >= r / 3 ? 1 : 2);\n        var y = shape.y - mathSin(angle) * width * (width >= r / 3 ? 1 : 2);\n\n        angle = shape.angle - Math.PI / 2;\n        ctx.moveTo(x, y);\n        ctx.lineTo(\n            shape.x + mathCos(angle) * width,\n            shape.y + mathSin(angle) * width\n        );\n        ctx.lineTo(\n            shape.x + mathCos(shape.angle) * r,\n            shape.y + mathSin(shape.angle) * r\n        );\n        ctx.lineTo(\n            shape.x - mathCos(angle) * width,\n            shape.y - mathSin(angle) * width\n        );\n        ctx.lineTo(x, y);\n        return;\n    }\n});\n\nfunction parsePosition(seriesModel, api) {\n    var center = seriesModel.get('center');\n    var width = api.getWidth();\n    var height = api.getHeight();\n    var size = Math.min(width, height);\n    var cx = parsePercent$1(center[0], api.getWidth());\n    var cy = parsePercent$1(center[1], api.getHeight());\n    var r = parsePercent$1(seriesModel.get('radius'), size / 2);\n\n    return {\n        cx: cx,\n        cy: cy,\n        r: r\n    };\n}\n\nfunction formatLabel(label, labelFormatter) {\n    if (labelFormatter) {\n        if (typeof labelFormatter === 'string') {\n            label = labelFormatter.replace('{value}', label != null ? label : '');\n        }\n        else if (typeof labelFormatter === 'function') {\n            label = labelFormatter(label);\n        }\n    }\n\n    return label;\n}\n\nvar PI2$5 = Math.PI * 2;\n\nvar GaugeView = Chart.extend({\n\n    type: 'gauge',\n\n    render: function (seriesModel, ecModel, api) {\n\n        this.group.removeAll();\n\n        var colorList = seriesModel.get('axisLine.lineStyle.color');\n        var posInfo = parsePosition(seriesModel, api);\n\n        this._renderMain(\n            seriesModel, ecModel, api, colorList, posInfo\n        );\n    },\n\n    dispose: function () {},\n\n    _renderMain: function (seriesModel, ecModel, api, colorList, posInfo) {\n        var group = this.group;\n\n        var axisLineModel = seriesModel.getModel('axisLine');\n        var lineStyleModel = axisLineModel.getModel('lineStyle');\n\n        var clockwise = seriesModel.get('clockwise');\n        var startAngle = -seriesModel.get('startAngle') / 180 * Math.PI;\n        var endAngle = -seriesModel.get('endAngle') / 180 * Math.PI;\n\n        var angleRangeSpan = (endAngle - startAngle) % PI2$5;\n\n        var prevEndAngle = startAngle;\n        var axisLineWidth = lineStyleModel.get('width');\n\n        for (var i = 0; i < colorList.length; i++) {\n            // Clamp\n            var percent = Math.min(Math.max(colorList[i][0], 0), 1);\n            var endAngle = startAngle + angleRangeSpan * percent;\n            var sector = new Sector({\n                shape: {\n                    startAngle: prevEndAngle,\n                    endAngle: endAngle,\n                    cx: posInfo.cx,\n                    cy: posInfo.cy,\n                    clockwise: clockwise,\n                    r0: posInfo.r - axisLineWidth,\n                    r: posInfo.r\n                },\n                silent: true\n            });\n\n            sector.setStyle({\n                fill: colorList[i][1]\n            });\n\n            sector.setStyle(lineStyleModel.getLineStyle(\n                // Because we use sector to simulate arc\n                // so the properties for stroking are useless\n                ['color', 'borderWidth', 'borderColor']\n            ));\n\n            group.add(sector);\n\n            prevEndAngle = endAngle;\n        }\n\n        var getColor = function (percent) {\n            // Less than 0\n            if (percent <= 0) {\n                return colorList[0][1];\n            }\n            for (var i = 0; i < colorList.length; i++) {\n                if (colorList[i][0] >= percent\n                    && (i === 0 ? 0 : colorList[i - 1][0]) < percent\n                ) {\n                    return colorList[i][1];\n                }\n            }\n            // More than 1\n            return colorList[i - 1][1];\n        };\n\n        if (!clockwise) {\n            var tmp = startAngle;\n            startAngle = endAngle;\n            endAngle = tmp;\n        }\n\n        this._renderTicks(\n            seriesModel, ecModel, api, getColor, posInfo,\n            startAngle, endAngle, clockwise\n        );\n\n        this._renderPointer(\n            seriesModel, ecModel, api, getColor, posInfo,\n            startAngle, endAngle, clockwise\n        );\n\n        this._renderTitle(\n            seriesModel, ecModel, api, getColor, posInfo\n        );\n        this._renderDetail(\n            seriesModel, ecModel, api, getColor, posInfo\n        );\n    },\n\n    _renderTicks: function (\n        seriesModel, ecModel, api, getColor, posInfo,\n        startAngle, endAngle, clockwise\n    ) {\n        var group = this.group;\n        var cx = posInfo.cx;\n        var cy = posInfo.cy;\n        var r = posInfo.r;\n\n        var minVal = +seriesModel.get('min');\n        var maxVal = +seriesModel.get('max');\n\n        var splitLineModel = seriesModel.getModel('splitLine');\n        var tickModel = seriesModel.getModel('axisTick');\n        var labelModel = seriesModel.getModel('axisLabel');\n\n        var splitNumber = seriesModel.get('splitNumber');\n        var subSplitNumber = tickModel.get('splitNumber');\n\n        var splitLineLen = parsePercent$1(\n            splitLineModel.get('length'), r\n        );\n        var tickLen = parsePercent$1(\n            tickModel.get('length'), r\n        );\n\n        var angle = startAngle;\n        var step = (endAngle - startAngle) / splitNumber;\n        var subStep = step / subSplitNumber;\n\n        var splitLineStyle = splitLineModel.getModel('lineStyle').getLineStyle();\n        var tickLineStyle = tickModel.getModel('lineStyle').getLineStyle();\n\n        for (var i = 0; i <= splitNumber; i++) {\n            var unitX = Math.cos(angle);\n            var unitY = Math.sin(angle);\n            // Split line\n            if (splitLineModel.get('show')) {\n                var splitLine = new Line({\n                    shape: {\n                        x1: unitX * r + cx,\n                        y1: unitY * r + cy,\n                        x2: unitX * (r - splitLineLen) + cx,\n                        y2: unitY * (r - splitLineLen) + cy\n                    },\n                    style: splitLineStyle,\n                    silent: true\n                });\n                if (splitLineStyle.stroke === 'auto') {\n                    splitLine.setStyle({\n                        stroke: getColor(i / splitNumber)\n                    });\n                }\n\n                group.add(splitLine);\n            }\n\n            // Label\n            if (labelModel.get('show')) {\n                var label = formatLabel(\n                    round$1(i / splitNumber * (maxVal - minVal) + minVal),\n                    labelModel.get('formatter')\n                );\n                var distance = labelModel.get('distance');\n                var autoColor = getColor(i / splitNumber);\n\n                group.add(new Text({\n                    style: setTextStyle({}, labelModel, {\n                        text: label,\n                        x: unitX * (r - splitLineLen - distance) + cx,\n                        y: unitY * (r - splitLineLen - distance) + cy,\n                        textVerticalAlign: unitY < -0.4 ? 'top' : (unitY > 0.4 ? 'bottom' : 'middle'),\n                        textAlign: unitX < -0.4 ? 'left' : (unitX > 0.4 ? 'right' : 'center')\n                    }, {autoColor: autoColor}),\n                    silent: true\n                }));\n            }\n\n            // Axis tick\n            if (tickModel.get('show') && i !== splitNumber) {\n                for (var j = 0; j <= subSplitNumber; j++) {\n                    var unitX = Math.cos(angle);\n                    var unitY = Math.sin(angle);\n                    var tickLine = new Line({\n                        shape: {\n                            x1: unitX * r + cx,\n                            y1: unitY * r + cy,\n                            x2: unitX * (r - tickLen) + cx,\n                            y2: unitY * (r - tickLen) + cy\n                        },\n                        silent: true,\n                        style: tickLineStyle\n                    });\n\n                    if (tickLineStyle.stroke === 'auto') {\n                        tickLine.setStyle({\n                            stroke: getColor((i + j / subSplitNumber) / splitNumber)\n                        });\n                    }\n\n                    group.add(tickLine);\n                    angle += subStep;\n                }\n                angle -= subStep;\n            }\n            else {\n                angle += step;\n            }\n        }\n    },\n\n    _renderPointer: function (\n        seriesModel, ecModel, api, getColor, posInfo,\n        startAngle, endAngle, clockwise\n    ) {\n\n        var group = this.group;\n        var oldData = this._data;\n\n        if (!seriesModel.get('pointer.show')) {\n            // Remove old element\n            oldData && oldData.eachItemGraphicEl(function (el) {\n                group.remove(el);\n            });\n            return;\n        }\n\n        var valueExtent = [+seriesModel.get('min'), +seriesModel.get('max')];\n        var angleExtent = [startAngle, endAngle];\n\n        var data = seriesModel.getData();\n        var valueDim = data.mapDimension('value');\n\n        data.diff(oldData)\n            .add(function (idx) {\n                var pointer = new PointerPath({\n                    shape: {\n                        angle: startAngle\n                    }\n                });\n\n                initProps(pointer, {\n                    shape: {\n                        angle: linearMap(data.get(valueDim, idx), valueExtent, angleExtent, true)\n                    }\n                }, seriesModel);\n\n                group.add(pointer);\n                data.setItemGraphicEl(idx, pointer);\n            })\n            .update(function (newIdx, oldIdx) {\n                var pointer = oldData.getItemGraphicEl(oldIdx);\n\n                updateProps(pointer, {\n                    shape: {\n                        angle: linearMap(data.get(valueDim, newIdx), valueExtent, angleExtent, true)\n                    }\n                }, seriesModel);\n\n                group.add(pointer);\n                data.setItemGraphicEl(newIdx, pointer);\n            })\n            .remove(function (idx) {\n                var pointer = oldData.getItemGraphicEl(idx);\n                group.remove(pointer);\n            })\n            .execute();\n\n        data.eachItemGraphicEl(function (pointer, idx) {\n            var itemModel = data.getItemModel(idx);\n            var pointerModel = itemModel.getModel('pointer');\n\n            pointer.setShape({\n                x: posInfo.cx,\n                y: posInfo.cy,\n                width: parsePercent$1(\n                    pointerModel.get('width'), posInfo.r\n                ),\n                r: parsePercent$1(pointerModel.get('length'), posInfo.r)\n            });\n\n            pointer.useStyle(itemModel.getModel('itemStyle').getItemStyle());\n\n            if (pointer.style.fill === 'auto') {\n                pointer.setStyle('fill', getColor(\n                    linearMap(data.get(valueDim, idx), valueExtent, [0, 1], true)\n                ));\n            }\n\n            setHoverStyle(\n                pointer, itemModel.getModel('emphasis.itemStyle').getItemStyle()\n            );\n        });\n\n        this._data = data;\n    },\n\n    _renderTitle: function (\n        seriesModel, ecModel, api, getColor, posInfo\n    ) {\n        var data = seriesModel.getData();\n        var valueDim = data.mapDimension('value');\n        var titleModel = seriesModel.getModel('title');\n        if (titleModel.get('show')) {\n            var offsetCenter = titleModel.get('offsetCenter');\n            var x = posInfo.cx + parsePercent$1(offsetCenter[0], posInfo.r);\n            var y = posInfo.cy + parsePercent$1(offsetCenter[1], posInfo.r);\n\n            var minVal = +seriesModel.get('min');\n            var maxVal = +seriesModel.get('max');\n            var value = seriesModel.getData().get(valueDim, 0);\n            var autoColor = getColor(\n                linearMap(value, [minVal, maxVal], [0, 1], true)\n            );\n\n            this.group.add(new Text({\n                silent: true,\n                style: setTextStyle({}, titleModel, {\n                    x: x,\n                    y: y,\n                    // FIXME First data name ?\n                    text: data.getName(0),\n                    textAlign: 'center',\n                    textVerticalAlign: 'middle'\n                }, {autoColor: autoColor, forceRich: true})\n            }));\n        }\n    },\n\n    _renderDetail: function (\n        seriesModel, ecModel, api, getColor, posInfo\n    ) {\n        var detailModel = seriesModel.getModel('detail');\n        var minVal = +seriesModel.get('min');\n        var maxVal = +seriesModel.get('max');\n        if (detailModel.get('show')) {\n            var offsetCenter = detailModel.get('offsetCenter');\n            var x = posInfo.cx + parsePercent$1(offsetCenter[0], posInfo.r);\n            var y = posInfo.cy + parsePercent$1(offsetCenter[1], posInfo.r);\n            var width = parsePercent$1(detailModel.get('width'), posInfo.r);\n            var height = parsePercent$1(detailModel.get('height'), posInfo.r);\n            var data = seriesModel.getData();\n            var value = data.get(data.mapDimension('value'), 0);\n            var autoColor = getColor(\n                linearMap(value, [minVal, maxVal], [0, 1], true)\n            );\n\n            this.group.add(new Text({\n                silent: true,\n                style: setTextStyle({}, detailModel, {\n                    x: x,\n                    y: y,\n                    text: formatLabel(\n                        // FIXME First data name ?\n                        value, detailModel.get('formatter')\n                    ),\n                    textWidth: isNaN(width) ? null : width,\n                    textHeight: isNaN(height) ? null : height,\n                    textAlign: 'center',\n                    textVerticalAlign: 'middle'\n                }, {autoColor: autoColor, forceRich: true})\n            }));\n        }\n    }\n});\n\nvar FunnelSeries = extendSeriesModel({\n\n    type: 'series.funnel',\n\n    init: function (option) {\n        FunnelSeries.superApply(this, 'init', arguments);\n\n        // Enable legend selection for each data item\n        // Use a function instead of direct access because data reference may changed\n        this.legendDataProvider = function () {\n            return this.getRawData();\n        };\n        // Extend labelLine emphasis\n        this._defaultLabelLine(option);\n    },\n\n    getInitialData: function (option, ecModel) {\n        return createListSimply(this, ['value']);\n    },\n\n    _defaultLabelLine: function (option) {\n        // Extend labelLine emphasis\n        defaultEmphasis(option, 'labelLine', ['show']);\n\n        var labelLineNormalOpt = option.labelLine;\n        var labelLineEmphasisOpt = option.emphasis.labelLine;\n        // Not show label line if `label.normal.show = false`\n        labelLineNormalOpt.show = labelLineNormalOpt.show\n            && option.label.show;\n        labelLineEmphasisOpt.show = labelLineEmphasisOpt.show\n            && option.emphasis.label.show;\n    },\n\n    // Overwrite\n    getDataParams: function (dataIndex) {\n        var data = this.getData();\n        var params = FunnelSeries.superCall(this, 'getDataParams', dataIndex);\n        var valueDim = data.mapDimension('value');\n        var sum = data.getSum(valueDim);\n        // Percent is 0 if sum is 0\n        params.percent = !sum ? 0 : +(data.get(valueDim, dataIndex) / sum * 100).toFixed(2);\n\n        params.$vars.push('percent');\n        return params;\n    },\n\n    defaultOption: {\n        zlevel: 0,                  // \n        z: 2,                       // \n        legendHoverLink: true,\n        left: 80,\n        top: 60,\n        right: 80,\n        bottom: 60,\n        // width: {totalWidth} - left - right,\n        // height: {totalHeight} - top - bottom,\n\n        // \n        // min: 0,\n        // max: 100,\n        minSize: '0%',\n        maxSize: '100%',\n        sort: 'descending', // 'ascending', 'descending'\n        gap: 0,\n        funnelAlign: 'center',\n        label: {\n            show: true,\n            position: 'outer'\n            // formatter: Tooltip.formatter\n        },\n        labelLine: {\n            show: true,\n            length: 20,\n            lineStyle: {\n                // color: ,\n                width: 1,\n                type: 'solid'\n            }\n        },\n        itemStyle: {\n            // color: ,\n            borderColor: '#fff',\n            borderWidth: 1\n        },\n        emphasis: {\n            label: {\n                show: true\n            }\n        }\n    }\n});\n\n/**\n * Piece of pie including Sector, Label, LabelLine\n * @constructor\n * @extends {module:zrender/graphic/Group}\n */\nfunction FunnelPiece(data, idx) {\n\n    Group.call(this);\n\n    var polygon = new Polygon();\n    var labelLine = new Polyline();\n    var text = new Text();\n    this.add(polygon);\n    this.add(labelLine);\n    this.add(text);\n\n    this.updateData(data, idx, true);\n\n    // Hover to change label and labelLine\n    function onEmphasis() {\n        labelLine.ignore = labelLine.hoverIgnore;\n        text.ignore = text.hoverIgnore;\n    }\n    function onNormal() {\n        labelLine.ignore = labelLine.normalIgnore;\n        text.ignore = text.normalIgnore;\n    }\n    this.on('emphasis', onEmphasis)\n        .on('normal', onNormal)\n        .on('mouseover', onEmphasis)\n        .on('mouseout', onNormal);\n}\n\nvar funnelPieceProto = FunnelPiece.prototype;\n\nvar opacityAccessPath = ['itemStyle', 'opacity'];\nfunnelPieceProto.updateData = function (data, idx, firstCreate) {\n\n    var polygon = this.childAt(0);\n\n    var seriesModel = data.hostModel;\n    var itemModel = data.getItemModel(idx);\n    var layout = data.getItemLayout(idx);\n    var opacity = data.getItemModel(idx).get(opacityAccessPath);\n    opacity = opacity == null ? 1 : opacity;\n\n    // Reset style\n    polygon.useStyle({});\n\n    if (firstCreate) {\n        polygon.setShape({\n            points: layout.points\n        });\n        polygon.setStyle({ opacity : 0 });\n        initProps(polygon, {\n            style: {\n                opacity: opacity\n            }\n        }, seriesModel, idx);\n    }\n    else {\n        updateProps(polygon, {\n            style: {\n                opacity: opacity\n            },\n            shape: {\n                points: layout.points\n            }\n        }, seriesModel, idx);\n    }\n\n    // Update common style\n    var itemStyleModel = itemModel.getModel('itemStyle');\n    var visualColor = data.getItemVisual(idx, 'color');\n\n    polygon.setStyle(\n        defaults(\n            {\n                lineJoin: 'round',\n                fill: visualColor\n            },\n            itemStyleModel.getItemStyle(['opacity'])\n        )\n    );\n    polygon.hoverStyle = itemStyleModel.getModel('emphasis').getItemStyle();\n\n    this._updateLabel(data, idx);\n\n    setHoverStyle(this);\n};\n\nfunnelPieceProto._updateLabel = function (data, idx) {\n\n    var labelLine = this.childAt(1);\n    var labelText = this.childAt(2);\n\n    var seriesModel = data.hostModel;\n    var itemModel = data.getItemModel(idx);\n    var layout = data.getItemLayout(idx);\n    var labelLayout = layout.label;\n    var visualColor = data.getItemVisual(idx, 'color');\n\n    updateProps(labelLine, {\n        shape: {\n            points: labelLayout.linePoints || labelLayout.linePoints\n        }\n    }, seriesModel, idx);\n\n    updateProps(labelText, {\n        style: {\n            x: labelLayout.x,\n            y: labelLayout.y\n        }\n    }, seriesModel, idx);\n    labelText.attr({\n        rotation: labelLayout.rotation,\n        origin: [labelLayout.x, labelLayout.y],\n        z2: 10\n    });\n\n    var labelModel = itemModel.getModel('label');\n    var labelHoverModel = itemModel.getModel('emphasis.label');\n    var labelLineModel = itemModel.getModel('labelLine');\n    var labelLineHoverModel = itemModel.getModel('emphasis.labelLine');\n    var visualColor = data.getItemVisual(idx, 'color');\n\n    setLabelStyle(\n        labelText.style, labelText.hoverStyle = {}, labelModel, labelHoverModel,\n        {\n            labelFetcher: data.hostModel,\n            labelDataIndex: idx,\n            defaultText: data.getName(idx),\n            autoColor: visualColor,\n            useInsideStyle: !!labelLayout.inside\n        },\n        {\n            textAlign: labelLayout.textAlign,\n            textVerticalAlign: labelLayout.verticalAlign\n        }\n    );\n\n    labelText.ignore = labelText.normalIgnore = !labelModel.get('show');\n    labelText.hoverIgnore = !labelHoverModel.get('show');\n\n    labelLine.ignore = labelLine.normalIgnore = !labelLineModel.get('show');\n    labelLine.hoverIgnore = !labelLineHoverModel.get('show');\n\n    // Default use item visual color\n    labelLine.setStyle({\n        stroke: visualColor\n    });\n    labelLine.setStyle(labelLineModel.getModel('lineStyle').getLineStyle());\n\n    labelLine.hoverStyle = labelLineHoverModel.getModel('lineStyle').getLineStyle();\n};\n\ninherits(FunnelPiece, Group);\n\n\nvar FunnelView = Chart.extend({\n\n    type: 'funnel',\n\n    render: function (seriesModel, ecModel, api) {\n        var data = seriesModel.getData();\n        var oldData = this._data;\n\n        var group = this.group;\n\n        data.diff(oldData)\n            .add(function (idx) {\n                var funnelPiece = new FunnelPiece(data, idx);\n\n                data.setItemGraphicEl(idx, funnelPiece);\n\n                group.add(funnelPiece);\n            })\n            .update(function (newIdx, oldIdx) {\n                var piePiece = oldData.getItemGraphicEl(oldIdx);\n\n                piePiece.updateData(data, newIdx);\n\n                group.add(piePiece);\n                data.setItemGraphicEl(newIdx, piePiece);\n            })\n            .remove(function (idx) {\n                var piePiece = oldData.getItemGraphicEl(idx);\n                group.remove(piePiece);\n            })\n            .execute();\n\n        this._data = data;\n    },\n\n    remove: function () {\n        this.group.removeAll();\n        this._data = null;\n    },\n\n    dispose: function () {}\n});\n\nfunction getViewRect$2(seriesModel, api) {\n    return getLayoutRect(\n        seriesModel.getBoxLayoutParams(), {\n            width: api.getWidth(),\n            height: api.getHeight()\n        }\n    );\n}\n\nfunction getSortedIndices(data, sort) {\n    var valueDim = data.mapDimension('value');\n    var valueArr = data.mapArray(valueDim, function (val) {\n        return val;\n    });\n    var indices = [];\n    var isAscending = sort === 'ascending';\n    for (var i = 0, len = data.count(); i < len; i++) {\n        indices[i] = i;\n    }\n\n    // Add custom sortable function & none sortable opetion by \"options.sort\"\n    if (typeof sort === 'function') {\n        indices.sort(sort);\n    } else if (sort !== 'none') {\n        indices.sort(function (a, b) {\n            return isAscending ? valueArr[a] - valueArr[b] : valueArr[b] - valueArr[a];\n        });\n    }\n    return indices;\n}\n\nfunction labelLayout$1(data) {\n    data.each(function (idx) {\n        var itemModel = data.getItemModel(idx);\n        var labelModel = itemModel.getModel('label');\n        var labelPosition = labelModel.get('position');\n\n        var labelLineModel = itemModel.getModel('labelLine');\n\n        var layout = data.getItemLayout(idx);\n        var points = layout.points;\n\n        var isLabelInside = labelPosition === 'inner'\n            || labelPosition === 'inside' || labelPosition === 'center';\n\n        var textAlign;\n        var textX;\n        var textY;\n        var linePoints;\n\n        if (isLabelInside) {\n            textX = (points[0][0] + points[1][0] + points[2][0] + points[3][0]) / 4;\n            textY = (points[0][1] + points[1][1] + points[2][1] + points[3][1]) / 4;\n            textAlign = 'center';\n            linePoints = [\n                [textX, textY], [textX, textY]\n            ];\n        }\n        else {\n            var x1;\n            var y1;\n            var x2;\n            var labelLineLen = labelLineModel.get('length');\n            if (labelPosition === 'left') {\n                // Left side\n                x1 = (points[3][0] + points[0][0]) / 2;\n                y1 = (points[3][1] + points[0][1]) / 2;\n                x2 = x1 - labelLineLen;\n                textX = x2 - 5;\n                textAlign = 'right';\n            }\n            else {\n                // Right side\n                x1 = (points[1][0] + points[2][0]) / 2;\n                y1 = (points[1][1] + points[2][1]) / 2;\n                x2 = x1 + labelLineLen;\n                textX = x2 + 5;\n                textAlign = 'left';\n            }\n            var y2 = y1;\n\n            linePoints = [[x1, y1], [x2, y2]];\n            textY = y2;\n        }\n\n        layout.label = {\n            linePoints: linePoints,\n            x: textX,\n            y: textY,\n            verticalAlign: 'middle',\n            textAlign: textAlign,\n            inside: isLabelInside\n        };\n    });\n}\n\nvar funnelLayout = function (ecModel, api, payload) {\n    ecModel.eachSeriesByType('funnel', function (seriesModel) {\n        var data = seriesModel.getData();\n        var valueDim = data.mapDimension('value');\n        var sort = seriesModel.get('sort');\n        var viewRect = getViewRect$2(seriesModel, api);\n        var indices = getSortedIndices(data, sort);\n\n        var sizeExtent = [\n            parsePercent$1(seriesModel.get('minSize'), viewRect.width),\n            parsePercent$1(seriesModel.get('maxSize'), viewRect.width)\n        ];\n        var dataExtent = data.getDataExtent(valueDim);\n        var min = seriesModel.get('min');\n        var max = seriesModel.get('max');\n        if (min == null) {\n            min = Math.min(dataExtent[0], 0);\n        }\n        if (max == null) {\n            max = dataExtent[1];\n        }\n\n        var funnelAlign = seriesModel.get('funnelAlign');\n        var gap = seriesModel.get('gap');\n        var itemHeight = (viewRect.height - gap * (data.count() - 1)) / data.count();\n\n        var y = viewRect.y;\n\n        var getLinePoints = function (idx, offY) {\n            // End point index is data.count() and we assign it 0\n            var val = data.get(valueDim, idx) || 0;\n            var itemWidth = linearMap(val, [min, max], sizeExtent, true);\n            var x0;\n            switch (funnelAlign) {\n                case 'left':\n                    x0 = viewRect.x;\n                    break;\n                case 'center':\n                    x0 = viewRect.x + (viewRect.width - itemWidth) / 2;\n                    break;\n                case 'right':\n                    x0 = viewRect.x + viewRect.width - itemWidth;\n                    break;\n            }\n            return [\n                [x0, offY],\n                [x0 + itemWidth, offY]\n            ];\n        };\n\n        if (sort === 'ascending') {\n            // From bottom to top\n            itemHeight = -itemHeight;\n            gap = -gap;\n            y += viewRect.height;\n            indices = indices.reverse();\n        }\n\n        for (var i = 0; i < indices.length; i++) {\n            var idx = indices[i];\n            var nextIdx = indices[i + 1];\n\n            var itemModel = data.getItemModel(idx);\n            var height = itemModel.get('itemStyle.height');\n            if (height == null) {\n                height = itemHeight;\n            }\n            else {\n                height = parsePercent$1(height, viewRect.height);\n                if (sort === 'ascending') {\n                    height = -height;\n                }\n            }\n\n            var start = getLinePoints(idx, y);\n            var end = getLinePoints(nextIdx, y + height);\n\n            y += height + gap;\n\n            data.setItemLayout(idx, {\n                points: start.concat(end.slice().reverse())\n            });\n        }\n\n        labelLayout$1(data);\n    });\n};\n\nregisterVisual(dataColor('funnel'));\nregisterLayout(funnelLayout);\nregisterProcessor(dataFilter('funnel'));\n\nvar parallelPreprocessor = function (option) {\n    createParallelIfNeeded(option);\n    mergeAxisOptionFromParallel(option);\n};\n\n/**\n * Create a parallel coordinate if not exists.\n * @inner\n */\nfunction createParallelIfNeeded(option) {\n    if (option.parallel) {\n        return;\n    }\n\n    var hasParallelSeries = false;\n\n    each$1(option.series, function (seriesOpt) {\n        if (seriesOpt && seriesOpt.type === 'parallel') {\n            hasParallelSeries = true;\n        }\n    });\n\n    if (hasParallelSeries) {\n        option.parallel = [{}];\n    }\n}\n\n/**\n * Merge aixs definition from parallel option (if exists) to axis option.\n * @inner\n */\nfunction mergeAxisOptionFromParallel(option) {\n    var axes = normalizeToArray(option.parallelAxis);\n\n    each$1(axes, function (axisOption) {\n        if (!isObject$1(axisOption)) {\n            return;\n        }\n\n        var parallelIndex = axisOption.parallelIndex || 0;\n        var parallelOption = normalizeToArray(option.parallel)[parallelIndex];\n\n        if (parallelOption && parallelOption.parallelAxisDefault) {\n            merge(axisOption, parallelOption.parallelAxisDefault, false);\n        }\n    });\n}\n\n/**\n * @constructor module:echarts/coord/parallel/ParallelAxis\n * @extends {module:echarts/coord/Axis}\n * @param {string} dim\n * @param {*} scale\n * @param {Array.<number>} coordExtent\n * @param {string} axisType\n */\nvar ParallelAxis = function (dim, scale, coordExtent, axisType, axisIndex) {\n\n    Axis.call(this, dim, scale, coordExtent);\n\n    /**\n     * Axis type\n     *  - 'category'\n     *  - 'value'\n     *  - 'time'\n     *  - 'log'\n     * @type {string}\n     */\n    this.type = axisType || 'value';\n\n    /**\n     * @type {number}\n     * @readOnly\n     */\n    this.axisIndex = axisIndex;\n};\n\nParallelAxis.prototype = {\n\n    constructor: ParallelAxis,\n\n    /**\n     * Axis model\n     * @param {module:echarts/coord/parallel/AxisModel}\n     */\n    model: null,\n\n    /**\n     * @override\n     */\n    isHorizontal: function () {\n        return this.coordinateSystem.getModel().get('layout') !== 'horizontal';\n    }\n\n};\n\ninherits(ParallelAxis, Axis);\n\n/**\n * Calculate slider move result.\n * Usage:\n * (1) If both handle0 and handle1 are needed to be moved, set minSpan the same as\n * maxSpan and the same as `Math.abs(handleEnd[1] - handleEnds[0])`.\n * (2) If handle0 is forbidden to cross handle1, set minSpan as `0`.\n *\n * @param {number} delta Move length.\n * @param {Array.<number>} handleEnds handleEnds[0] can be bigger then handleEnds[1].\n *              handleEnds will be modified in this method.\n * @param {Array.<number>} extent handleEnds is restricted by extent.\n *              extent[0] should less or equals than extent[1].\n * @param {number|string} handleIndex Can be 'all', means that both move the two handleEnds,\n *              where the input minSpan and maxSpan will not work.\n * @param {number} [minSpan] The range of dataZoom can not be smaller than that.\n *              If not set, handle0 and cross handle1. If set as a non-negative\n *              number (including `0`), handles will push each other when reaching\n *              the minSpan.\n * @param {number} [maxSpan] The range of dataZoom can not be larger than that.\n * @return {Array.<number>} The input handleEnds.\n */\nvar sliderMove = function (delta, handleEnds, extent, handleIndex, minSpan, maxSpan) {\n    // Normalize firstly.\n    handleEnds[0] = restrict$1(handleEnds[0], extent);\n    handleEnds[1] = restrict$1(handleEnds[1], extent);\n\n    delta = delta || 0;\n\n    var extentSpan = extent[1] - extent[0];\n\n    // Notice maxSpan and minSpan can be null/undefined.\n    if (minSpan != null) {\n        minSpan = restrict$1(minSpan, [0, extentSpan]);\n    }\n    if (maxSpan != null) {\n        maxSpan = Math.max(maxSpan, minSpan != null ? minSpan : 0);\n    }\n    if (handleIndex === 'all') {\n        minSpan = maxSpan = Math.abs(handleEnds[1] - handleEnds[0]);\n        handleIndex = 0;\n    }\n\n    var originalDistSign = getSpanSign(handleEnds, handleIndex);\n\n    handleEnds[handleIndex] += delta;\n\n    // Restrict in extent.\n    var extentMinSpan = minSpan || 0;\n    var realExtent = extent.slice();\n    originalDistSign.sign < 0 ? (realExtent[0] += extentMinSpan) : (realExtent[1] -= extentMinSpan);\n    handleEnds[handleIndex] = restrict$1(handleEnds[handleIndex], realExtent);\n\n    // Expand span.\n    var currDistSign = getSpanSign(handleEnds, handleIndex);\n    if (minSpan != null && (\n        currDistSign.sign !== originalDistSign.sign || currDistSign.span < minSpan\n    )) {\n        // If minSpan exists, 'cross' is forbinden.\n        handleEnds[1 - handleIndex] = handleEnds[handleIndex] + originalDistSign.sign * minSpan;\n    }\n\n    // Shrink span.\n    var currDistSign = getSpanSign(handleEnds, handleIndex);\n    if (maxSpan != null && currDistSign.span > maxSpan) {\n        handleEnds[1 - handleIndex] = handleEnds[handleIndex] + currDistSign.sign * maxSpan;\n    }\n\n    return handleEnds;\n};\n\nfunction getSpanSign(handleEnds, handleIndex) {\n    var dist = handleEnds[handleIndex] - handleEnds[1 - handleIndex];\n    // If `handleEnds[0] === handleEnds[1]`, always believe that handleEnd[0]\n    // is at left of handleEnds[1] for non-cross case.\n    return {span: Math.abs(dist), sign: dist > 0 ? -1 : dist < 0 ? 1 : handleIndex ? -1 : 1};\n}\n\nfunction restrict$1(value, extend) {\n    return Math.min(extend[1], Math.max(extend[0], value));\n}\n\n/**\n * Parallel Coordinates\n * <https://en.wikipedia.org/wiki/Parallel_coordinates>\n */\n\nvar each$12 = each$1;\nvar mathMin$5 = Math.min;\nvar mathMax$5 = Math.max;\nvar mathFloor$2 = Math.floor;\nvar mathCeil$2 = Math.ceil;\nvar round$2 = round$1;\n\nvar PI$3 = Math.PI;\n\nfunction Parallel(parallelModel, ecModel, api) {\n\n    /**\n     * key: dimension\n     * @type {Object.<string, module:echarts/coord/parallel/Axis>}\n     * @private\n     */\n    this._axesMap = createHashMap();\n\n    /**\n     * key: dimension\n     * value: {position: [], rotation, }\n     * @type {Object.<string, Object>}\n     * @private\n     */\n    this._axesLayout = {};\n\n    /**\n     * Always follow axis order.\n     * @type {Array.<string>}\n     * @readOnly\n     */\n    this.dimensions = parallelModel.dimensions;\n\n    /**\n     * @type {module:zrender/core/BoundingRect}\n     */\n    this._rect;\n\n    /**\n     * @type {module:echarts/coord/parallel/ParallelModel}\n     */\n    this._model = parallelModel;\n\n    this._init(parallelModel, ecModel, api);\n}\n\nParallel.prototype = {\n\n    type: 'parallel',\n\n    constructor: Parallel,\n\n    /**\n     * Initialize cartesian coordinate systems\n     * @private\n     */\n    _init: function (parallelModel, ecModel, api) {\n\n        var dimensions = parallelModel.dimensions;\n        var parallelAxisIndex = parallelModel.parallelAxisIndex;\n\n        each$12(dimensions, function (dim, idx) {\n\n            var axisIndex = parallelAxisIndex[idx];\n            var axisModel = ecModel.getComponent('parallelAxis', axisIndex);\n\n            var axis = this._axesMap.set(dim, new ParallelAxis(\n                dim,\n                createScaleByModel(axisModel),\n                [0, 0],\n                axisModel.get('type'),\n                axisIndex\n            ));\n\n            var isCategory = axis.type === 'category';\n            axis.onBand = isCategory && axisModel.get('boundaryGap');\n            axis.inverse = axisModel.get('inverse');\n\n            // Injection\n            axisModel.axis = axis;\n            axis.model = axisModel;\n            axis.coordinateSystem = axisModel.coordinateSystem = this;\n\n        }, this);\n    },\n\n    /**\n     * Update axis scale after data processed\n     * @param  {module:echarts/model/Global} ecModel\n     * @param  {module:echarts/ExtensionAPI} api\n     */\n    update: function (ecModel, api) {\n        this._updateAxesFromSeries(this._model, ecModel);\n    },\n\n    /**\n     * @override\n     */\n    containPoint: function (point) {\n        var layoutInfo = this._makeLayoutInfo();\n        var axisBase = layoutInfo.axisBase;\n        var layoutBase = layoutInfo.layoutBase;\n        var pixelDimIndex = layoutInfo.pixelDimIndex;\n        var pAxis = point[1 - pixelDimIndex];\n        var pLayout = point[pixelDimIndex];\n\n        return pAxis >= axisBase\n            && pAxis <= axisBase + layoutInfo.axisLength\n            && pLayout >= layoutBase\n            && pLayout <= layoutBase + layoutInfo.layoutLength;\n    },\n\n    getModel: function () {\n        return this._model;\n    },\n\n    /**\n     * Update properties from series\n     * @private\n     */\n    _updateAxesFromSeries: function (parallelModel, ecModel) {\n        ecModel.eachSeries(function (seriesModel) {\n\n            if (!parallelModel.contains(seriesModel, ecModel)) {\n                return;\n            }\n\n            var data = seriesModel.getData();\n\n            each$12(this.dimensions, function (dim) {\n                var axis = this._axesMap.get(dim);\n                axis.scale.unionExtentFromData(data, data.mapDimension(dim));\n                niceScaleExtent(axis.scale, axis.model);\n            }, this);\n        }, this);\n    },\n\n    /**\n     * Resize the parallel coordinate system.\n     * @param {module:echarts/coord/parallel/ParallelModel} parallelModel\n     * @param {module:echarts/ExtensionAPI} api\n     */\n    resize: function (parallelModel, api) {\n        this._rect = getLayoutRect(\n            parallelModel.getBoxLayoutParams(),\n            {\n                width: api.getWidth(),\n                height: api.getHeight()\n            }\n        );\n\n        this._layoutAxes();\n    },\n\n    /**\n     * @return {module:zrender/core/BoundingRect}\n     */\n    getRect: function () {\n        return this._rect;\n    },\n\n    /**\n     * @private\n     */\n    _makeLayoutInfo: function () {\n        var parallelModel = this._model;\n        var rect = this._rect;\n        var xy = ['x', 'y'];\n        var wh = ['width', 'height'];\n        var layout = parallelModel.get('layout');\n        var pixelDimIndex = layout === 'horizontal' ? 0 : 1;\n        var layoutLength = rect[wh[pixelDimIndex]];\n        var layoutExtent = [0, layoutLength];\n        var axisCount = this.dimensions.length;\n\n        var axisExpandWidth = restrict(parallelModel.get('axisExpandWidth'), layoutExtent);\n        var axisExpandCount = restrict(parallelModel.get('axisExpandCount') || 0, [0, axisCount]);\n        var axisExpandable = parallelModel.get('axisExpandable')\n            && axisCount > 3\n            && axisCount > axisExpandCount\n            && axisExpandCount > 1\n            && axisExpandWidth > 0\n            && layoutLength > 0;\n\n        // `axisExpandWindow` is According to the coordinates of [0, axisExpandLength],\n        // for sake of consider the case that axisCollapseWidth is 0 (when screen is narrow),\n        // where collapsed axes should be overlapped.\n        var axisExpandWindow = parallelModel.get('axisExpandWindow');\n        var winSize;\n        if (!axisExpandWindow) {\n            winSize = restrict(axisExpandWidth * (axisExpandCount - 1), layoutExtent);\n            var axisExpandCenter = parallelModel.get('axisExpandCenter') || mathFloor$2(axisCount / 2);\n            axisExpandWindow = [axisExpandWidth * axisExpandCenter - winSize / 2];\n            axisExpandWindow[1] = axisExpandWindow[0] + winSize;\n        }\n        else {\n                winSize = restrict(axisExpandWindow[1] - axisExpandWindow[0], layoutExtent);\n                axisExpandWindow[1] = axisExpandWindow[0] + winSize;\n        }\n\n        var axisCollapseWidth = (layoutLength - winSize) / (axisCount - axisExpandCount);\n        // Avoid axisCollapseWidth is too small.\n        axisCollapseWidth < 3 && (axisCollapseWidth = 0);\n\n        // Find the first and last indices > ewin[0] and < ewin[1].\n        var winInnerIndices = [\n            mathFloor$2(round$2(axisExpandWindow[0] / axisExpandWidth, 1)) + 1,\n            mathCeil$2(round$2(axisExpandWindow[1] / axisExpandWidth, 1)) - 1\n        ];\n\n        // Pos in ec coordinates.\n        var axisExpandWindow0Pos = axisCollapseWidth / axisExpandWidth * axisExpandWindow[0];\n\n        return {\n            layout: layout,\n            pixelDimIndex: pixelDimIndex,\n            layoutBase: rect[xy[pixelDimIndex]],\n            layoutLength: layoutLength,\n            axisBase: rect[xy[1 - pixelDimIndex]],\n            axisLength: rect[wh[1 - pixelDimIndex]],\n            axisExpandable: axisExpandable,\n            axisExpandWidth: axisExpandWidth,\n            axisCollapseWidth: axisCollapseWidth,\n            axisExpandWindow: axisExpandWindow,\n            axisCount: axisCount,\n            winInnerIndices: winInnerIndices,\n            axisExpandWindow0Pos: axisExpandWindow0Pos\n        };\n    },\n\n    /**\n     * @private\n     */\n    _layoutAxes: function () {\n        var rect = this._rect;\n        var axes = this._axesMap;\n        var dimensions = this.dimensions;\n        var layoutInfo = this._makeLayoutInfo();\n        var layout = layoutInfo.layout;\n\n        axes.each(function (axis) {\n            var axisExtent = [0, layoutInfo.axisLength];\n            var idx = axis.inverse ? 1 : 0;\n            axis.setExtent(axisExtent[idx], axisExtent[1 - idx]);\n        });\n\n        each$12(dimensions, function (dim, idx) {\n            var posInfo = (layoutInfo.axisExpandable\n                ? layoutAxisWithExpand : layoutAxisWithoutExpand\n            )(idx, layoutInfo);\n\n            var positionTable = {\n                horizontal: {\n                    x: posInfo.position,\n                    y: layoutInfo.axisLength\n                },\n                vertical: {\n                    x: 0,\n                    y: posInfo.position\n                }\n            };\n            var rotationTable = {\n                horizontal: PI$3 / 2,\n                vertical: 0\n            };\n\n            var position = [\n                positionTable[layout].x + rect.x,\n                positionTable[layout].y + rect.y\n            ];\n\n            var rotation = rotationTable[layout];\n            var transform = create$1();\n            rotate(transform, transform, rotation);\n            translate(transform, transform, position);\n\n            // TODO\n            // tick\n\n            // TODO\n            // axis order  dimensions\n\n            this._axesLayout[dim] = {\n                position: position,\n                rotation: rotation,\n                transform: transform,\n                axisNameAvailableWidth: posInfo.axisNameAvailableWidth,\n                axisLabelShow: posInfo.axisLabelShow,\n                nameTruncateMaxWidth: posInfo.nameTruncateMaxWidth,\n                tickDirection: 1,\n                labelDirection: 1,\n                labelInterval: axes.get(dim).getLabelInterval()\n            };\n        }, this);\n    },\n\n    /**\n     * Get axis by dim.\n     * @param {string} dim\n     * @return {module:echarts/coord/parallel/ParallelAxis} [description]\n     */\n    getAxis: function (dim) {\n        return this._axesMap.get(dim);\n    },\n\n    /**\n     * Convert a dim value of a single item of series data to Point.\n     * @param {*} value\n     * @param {string} dim\n     * @return {Array}\n     */\n    dataToPoint: function (value, dim) {\n        return this.axisCoordToPoint(\n            this._axesMap.get(dim).dataToCoord(value),\n            dim\n        );\n    },\n\n    /**\n     * Travel data for one time, get activeState of each data item.\n     * @param {module:echarts/data/List} data\n     * @param {Functio} cb param: {string} activeState 'active' or 'inactive' or 'normal'\n     *                            {number} dataIndex\n     * @param {Object} context\n     */\n    eachActiveState: function (data, callback, context) {\n        var dimensions = this.dimensions;\n        var dataDimensions = map(dimensions, function (axisDim) {\n            return data.mapDimension(axisDim);\n        });\n        var axesMap = this._axesMap;\n        var hasActiveSet = this.hasAxisBrushed();\n\n        for (var i = 0, len = data.count(); i < len; i++) {\n            var values = data.getValues(dataDimensions, i);\n            var activeState;\n\n            if (!hasActiveSet) {\n                activeState = 'normal';\n            }\n            else {\n                activeState = 'active';\n                for (var j = 0, lenj = dimensions.length; j < lenj; j++) {\n                    var dimName = dimensions[j];\n                    var state = axesMap.get(dimName).model.getActiveState(values[j], j);\n\n                    if (state === 'inactive') {\n                        activeState = 'inactive';\n                        break;\n                    }\n                }\n            }\n\n            callback.call(context, activeState, i);\n        }\n    },\n\n    /**\n     * Whether has any activeSet.\n     * @return {boolean}\n     */\n    hasAxisBrushed: function () {\n        var dimensions = this.dimensions;\n        var axesMap = this._axesMap;\n        var hasActiveSet = false;\n\n        for (var j = 0, lenj = dimensions.length; j < lenj; j++) {\n            if (axesMap.get(dimensions[j]).model.getActiveState() !== 'normal') {\n                hasActiveSet = true;\n            }\n        }\n\n        return hasActiveSet;\n    },\n\n    /**\n     * Convert coords of each axis to Point.\n     *  Return point. For example: [10, 20]\n     * @param {Array.<number>} coords\n     * @param {string} dim\n     * @return {Array.<number>}\n     */\n    axisCoordToPoint: function (coord, dim) {\n        var axisLayout = this._axesLayout[dim];\n        return applyTransform$1([coord, 0], axisLayout.transform);\n    },\n\n    /**\n     * Get axis layout.\n     */\n    getAxisLayout: function (dim) {\n        return clone(this._axesLayout[dim]);\n    },\n\n    /**\n     * @param {Array.<number>} point\n     * @return {Object} {axisExpandWindow, delta, behavior: 'jump' | 'slide' | 'none'}.\n     */\n    getSlidedAxisExpandWindow: function (point) {\n        var layoutInfo = this._makeLayoutInfo();\n        var pixelDimIndex = layoutInfo.pixelDimIndex;\n        var axisExpandWindow = layoutInfo.axisExpandWindow.slice();\n        var winSize = axisExpandWindow[1] - axisExpandWindow[0];\n        var extent = [0, layoutInfo.axisExpandWidth * (layoutInfo.axisCount - 1)];\n\n        // Out of the area of coordinate system.\n        if (!this.containPoint(point)) {\n            return {behavior: 'none', axisExpandWindow: axisExpandWindow};\n        }\n\n        // Conver the point from global to expand coordinates.\n        var pointCoord = point[pixelDimIndex] - layoutInfo.layoutBase - layoutInfo.axisExpandWindow0Pos;\n\n        // For dragging operation convenience, the window should not be\n        // slided when mouse is the center area of the window.\n        var delta;\n        var behavior = 'slide';\n        var axisCollapseWidth = layoutInfo.axisCollapseWidth;\n        var triggerArea = this._model.get('axisExpandSlideTriggerArea');\n        // But consider touch device, jump is necessary.\n        var useJump = triggerArea[0] != null;\n\n        if (axisCollapseWidth) {\n            if (useJump && axisCollapseWidth && pointCoord < winSize * triggerArea[0]) {\n                behavior = 'jump';\n                delta = pointCoord - winSize * triggerArea[2];\n            }\n            else if (useJump && axisCollapseWidth && pointCoord > winSize * (1 - triggerArea[0])) {\n                behavior = 'jump';\n                delta = pointCoord - winSize * (1 - triggerArea[2]);\n            }\n            else {\n                (delta = pointCoord - winSize * triggerArea[1]) >= 0\n                    && (delta = pointCoord - winSize * (1 - triggerArea[1])) <= 0\n                    && (delta = 0);\n            }\n            delta *= layoutInfo.axisExpandWidth / axisCollapseWidth;\n            delta\n                ? sliderMove(delta, axisExpandWindow, extent, 'all')\n                // Avoid nonsense triger on mousemove.\n                : (behavior = 'none');\n        }\n        // When screen is too narrow, make it visible and slidable, although it is hard to interact.\n        else {\n            var winSize = axisExpandWindow[1] - axisExpandWindow[0];\n            var pos = extent[1] * pointCoord / winSize;\n            axisExpandWindow = [mathMax$5(0, pos - winSize / 2)];\n            axisExpandWindow[1] = mathMin$5(extent[1], axisExpandWindow[0] + winSize);\n            axisExpandWindow[0] = axisExpandWindow[1] - winSize;\n        }\n\n        return {\n            axisExpandWindow: axisExpandWindow,\n            behavior: behavior\n        };\n    }\n};\n\nfunction restrict(len, extent) {\n    return mathMin$5(mathMax$5(len, extent[0]), extent[1]);\n}\n\nfunction layoutAxisWithoutExpand(axisIndex, layoutInfo) {\n    var step = layoutInfo.layoutLength / (layoutInfo.axisCount - 1);\n    return {\n        position: step * axisIndex,\n        axisNameAvailableWidth: step,\n        axisLabelShow: true\n    };\n}\n\nfunction layoutAxisWithExpand(axisIndex, layoutInfo) {\n    var layoutLength = layoutInfo.layoutLength;\n    var axisExpandWidth = layoutInfo.axisExpandWidth;\n    var axisCount = layoutInfo.axisCount;\n    var axisCollapseWidth = layoutInfo.axisCollapseWidth;\n    var winInnerIndices = layoutInfo.winInnerIndices;\n\n    var position;\n    var axisNameAvailableWidth = axisCollapseWidth;\n    var axisLabelShow = false;\n    var nameTruncateMaxWidth;\n\n    if (axisIndex < winInnerIndices[0]) {\n        position = axisIndex * axisCollapseWidth;\n        nameTruncateMaxWidth = axisCollapseWidth;\n    }\n    else if (axisIndex <= winInnerIndices[1]) {\n        position = layoutInfo.axisExpandWindow0Pos\n            + axisIndex * axisExpandWidth - layoutInfo.axisExpandWindow[0];\n        axisNameAvailableWidth = axisExpandWidth;\n        axisLabelShow = true;\n    }\n    else {\n        position = layoutLength - (axisCount - 1 - axisIndex) * axisCollapseWidth;\n        nameTruncateMaxWidth = axisCollapseWidth;\n    }\n\n    return {\n        position: position,\n        axisNameAvailableWidth: axisNameAvailableWidth,\n        axisLabelShow: axisLabelShow,\n        nameTruncateMaxWidth: nameTruncateMaxWidth\n    };\n}\n\n/**\n * Parallel coordinate system creater.\n */\n\nfunction create$2(ecModel, api) {\n    var coordSysList = [];\n\n    ecModel.eachComponent('parallel', function (parallelModel, idx) {\n        var coordSys = new Parallel(parallelModel, ecModel, api);\n\n        coordSys.name = 'parallel_' + idx;\n        coordSys.resize(parallelModel, api);\n\n        parallelModel.coordinateSystem = coordSys;\n        coordSys.model = parallelModel;\n\n        coordSysList.push(coordSys);\n    });\n\n    // Inject the coordinateSystems into seriesModel\n    ecModel.eachSeries(function (seriesModel) {\n        if (seriesModel.get('coordinateSystem') === 'parallel') {\n            var parallelModel = ecModel.queryComponents({\n                mainType: 'parallel',\n                index: seriesModel.get('parallelIndex'),\n                id: seriesModel.get('parallelId')\n            })[0];\n            seriesModel.coordinateSystem = parallelModel.coordinateSystem;\n        }\n    });\n\n    return coordSysList;\n}\n\nCoordinateSystemManager.register('parallel', {create: create$2});\n\nvar AxisModel$2 = ComponentModel.extend({\n\n    type: 'baseParallelAxis',\n\n    /**\n     * @type {module:echarts/coord/parallel/Axis}\n     */\n    axis: null,\n\n    /**\n     * @type {Array.<Array.<number>}\n     * @readOnly\n     */\n    activeIntervals: [],\n\n    /**\n     * @return {Object}\n     */\n    getAreaSelectStyle: function () {\n        return makeStyleMapper(\n            [\n                ['fill', 'color'],\n                ['lineWidth', 'borderWidth'],\n                ['stroke', 'borderColor'],\n                ['width', 'width'],\n                ['opacity', 'opacity']\n            ]\n        )(this.getModel('areaSelectStyle'));\n    },\n\n    /**\n     * The code of this feature is put on AxisModel but not ParallelAxis,\n     * because axisModel can be alive after echarts updating but instance of\n     * ParallelAxis having been disposed. this._activeInterval should be kept\n     * when action dispatched (i.e. legend click).\n     *\n     * @param {Array.<Array<number>>} intervals interval.length === 0\n     *                                          means set all active.\n     * @public\n     */\n    setActiveIntervals: function (intervals) {\n        var activeIntervals = this.activeIntervals = clone(intervals);\n\n        // Normalize\n        if (activeIntervals) {\n            for (var i = activeIntervals.length - 1; i >= 0; i--) {\n                asc(activeIntervals[i]);\n            }\n        }\n    },\n\n    /**\n     * @param {number|string} [value] When attempting to detect 'no activeIntervals set',\n     *                         value can not be input.\n     * @return {string} 'normal': no activeIntervals set,\n     *                  'active',\n     *                  'inactive'.\n     * @public\n     */\n    getActiveState: function (value) {\n        var activeIntervals = this.activeIntervals;\n\n        if (!activeIntervals.length) {\n            return 'normal';\n        }\n\n        if (value == null) {\n            return 'inactive';\n        }\n\n        for (var i = 0, len = activeIntervals.length; i < len; i++) {\n            if (activeIntervals[i][0] <= value && value <= activeIntervals[i][1]) {\n                return 'active';\n            }\n        }\n        return 'inactive';\n    }\n\n});\n\nvar defaultOption$1 = {\n\n    type: 'value',\n\n    /**\n     * @type {Array.<number>}\n     */\n    dim: null, // 0, 1, 2, ...\n\n    // parallelIndex: null,\n\n    areaSelectStyle: {\n        width: 20,\n        borderWidth: 1,\n        borderColor: 'rgba(160,197,232)',\n        color: 'rgba(160,197,232)',\n        opacity: 0.3\n    },\n\n    realtime: true, // Whether realtime update view when select.\n\n    z: 10\n};\n\nmerge(AxisModel$2.prototype, axisModelCommonMixin);\n\nfunction getAxisType$1(axisName, option) {\n    return option.type || (option.data ? 'category' : 'value');\n}\n\naxisModelCreator('parallel', AxisModel$2, getAxisType$1, defaultOption$1);\n\nComponentModel.extend({\n\n    type: 'parallel',\n\n    dependencies: ['parallelAxis'],\n\n    /**\n     * @type {module:echarts/coord/parallel/Parallel}\n     */\n    coordinateSystem: null,\n\n    /**\n     * Each item like: 'dim0', 'dim1', 'dim2', ...\n     * @type {Array.<string>}\n     * @readOnly\n     */\n    dimensions: null,\n\n    /**\n     * Coresponding to dimensions.\n     * @type {Array.<number>}\n     * @readOnly\n     */\n    parallelAxisIndex: null,\n\n    layoutMode: 'box',\n\n    defaultOption: {\n        zlevel: 0,\n        z: 0,\n        left: 80,\n        top: 60,\n        right: 80,\n        bottom: 60,\n        // width: {totalWidth} - left - right,\n        // height: {totalHeight} - top - bottom,\n\n        layout: 'horizontal',      // 'horizontal' or 'vertical'\n\n        // FIXME\n        // naming?\n        axisExpandable: false,\n        axisExpandCenter: null,\n        axisExpandCount: 0,\n        axisExpandWidth: 50,      // FIXME '10%' ?\n        axisExpandRate: 17,\n        axisExpandDebounce: 50,\n        // [out, in, jumpTarget]. In percentage. If use [null, 0.05], null means full.\n        // Do not doc to user until necessary.\n        axisExpandSlideTriggerArea: [-0.15, 0.05, 0.4],\n        axisExpandTriggerOn: 'click', // 'mousemove' or 'click'\n\n        parallelAxisDefault: null\n    },\n\n    /**\n     * @override\n     */\n    init: function () {\n        ComponentModel.prototype.init.apply(this, arguments);\n\n        this.mergeOption({});\n    },\n\n    /**\n     * @override\n     */\n    mergeOption: function (newOption) {\n        var thisOption = this.option;\n\n        newOption && merge(thisOption, newOption, true);\n\n        this._initDimensions();\n    },\n\n    /**\n     * Whether series or axis is in this coordinate system.\n     * @param {module:echarts/model/Series|module:echarts/coord/parallel/AxisModel} model\n     * @param {module:echarts/model/Global} ecModel\n     */\n    contains: function (model, ecModel) {\n        var parallelIndex = model.get('parallelIndex');\n        return parallelIndex != null\n            && ecModel.getComponent('parallel', parallelIndex) === this;\n    },\n\n    setAxisExpand: function (opt) {\n        each$1(\n            ['axisExpandable', 'axisExpandCenter', 'axisExpandCount', 'axisExpandWidth', 'axisExpandWindow'],\n            function (name) {\n                if (opt.hasOwnProperty(name)) {\n                    this.option[name] = opt[name];\n                }\n            },\n            this\n        );\n    },\n\n    /**\n     * @private\n     */\n    _initDimensions: function () {\n        var dimensions = this.dimensions = [];\n        var parallelAxisIndex = this.parallelAxisIndex = [];\n\n        var axisModels = filter(this.dependentModels.parallelAxis, function (axisModel) {\n            // Can not use this.contains here, because\n            // initialization has not been completed yet.\n            return (axisModel.get('parallelIndex') || 0) === this.componentIndex;\n        }, this);\n\n        each$1(axisModels, function (axisModel) {\n            dimensions.push('dim' + axisModel.get('dim'));\n            parallelAxisIndex.push(axisModel.componentIndex);\n        });\n    }\n\n});\n\n/**\n * @payload\n * @property {string} parallelAxisId\n * @property {Array.<Array.<number>>} intervals\n */\nvar actionInfo$1 = {\n    type: 'axisAreaSelect',\n    event: 'axisAreaSelected'\n    // update: 'updateVisual'\n};\n\nregisterAction(actionInfo$1, function (payload, ecModel) {\n    ecModel.eachComponent(\n        {mainType: 'parallelAxis', query: payload},\n        function (parallelAxisModel) {\n            parallelAxisModel.axis.model.setActiveIntervals(payload.intervals);\n        }\n    );\n});\n\n/**\n * @payload\n */\nregisterAction('parallelAxisExpand', function (payload, ecModel) {\n    ecModel.eachComponent(\n        {mainType: 'parallel', query: payload},\n        function (parallelModel) {\n            parallelModel.setAxisExpand(payload);\n        }\n    );\n\n});\n\nvar curry$2 = curry;\nvar each$13 = each$1;\nvar map$2 = map;\nvar mathMin$6 = Math.min;\nvar mathMax$6 = Math.max;\nvar mathPow$2 = Math.pow;\n\nvar COVER_Z = 10000;\nvar UNSELECT_THRESHOLD = 6;\nvar MIN_RESIZE_LINE_WIDTH = 6;\nvar MUTEX_RESOURCE_KEY = 'globalPan';\n\nvar DIRECTION_MAP = {\n    w: [0, 0],\n    e: [0, 1],\n    n: [1, 0],\n    s: [1, 1]\n};\nvar CURSOR_MAP = {\n    w: 'ew',\n    e: 'ew',\n    n: 'ns',\n    s: 'ns',\n    ne: 'nesw',\n    sw: 'nesw',\n    nw: 'nwse',\n    se: 'nwse'\n};\nvar DEFAULT_BRUSH_OPT = {\n    brushStyle: {\n        lineWidth: 2,\n        stroke: 'rgba(0,0,0,0.3)',\n        fill: 'rgba(0,0,0,0.1)'\n    },\n    transformable: true,\n    brushMode: 'single',\n    removeOnClick: false\n};\n\nvar baseUID = 0;\n\n/**\n * @alias module:echarts/component/helper/BrushController\n * @constructor\n * @mixin {module:zrender/mixin/Eventful}\n * @event module:echarts/component/helper/BrushController#brush\n *        params:\n *            areas: Array.<Array>, coord relates to container group,\n *                                    If no container specified, to global.\n *            opt {\n *                isEnd: boolean,\n *                removeOnClick: boolean\n *            }\n *\n * @param {module:zrender/zrender~ZRender} zr\n */\nfunction BrushController(zr) {\n\n    if (__DEV__) {\n        assert$1(zr);\n    }\n\n    Eventful.call(this);\n\n    /**\n     * @type {module:zrender/zrender~ZRender}\n     * @private\n     */\n    this._zr = zr;\n\n    /**\n     * @type {module:zrender/container/Group}\n     * @readOnly\n     */\n    this.group = new Group();\n\n    /**\n     * Only for drawing (after enabledBrush).\n     *     'line', 'rect', 'polygon' or false\n     *     If passing false/null/undefined, disable brush.\n     *     If passing 'auto', determined by panel.defaultBrushType\n     * @private\n     * @type {string}\n     */\n    this._brushType;\n\n    /**\n     * Only for drawing (after enabledBrush).\n     *\n     * @private\n     * @type {Object}\n     */\n    this._brushOption;\n\n    /**\n     * @private\n     * @type {Object}\n     */\n    this._panels;\n\n    /**\n     * @private\n     * @type {Array.<nubmer>}\n     */\n    this._track = [];\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this._dragging;\n\n    /**\n     * @private\n     * @type {Array}\n     */\n    this._covers = [];\n\n    /**\n     * @private\n     * @type {moudule:zrender/container/Group}\n     */\n    this._creatingCover;\n\n    /**\n     * `true` means global panel\n     * @private\n     * @type {module:zrender/container/Group|boolean}\n     */\n    this._creatingPanel;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this._enableGlobalPan;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    if (__DEV__) {\n        this._mounted;\n    }\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this._uid = 'brushController_' + baseUID++;\n\n    /**\n     * @private\n     * @type {Object}\n     */\n    this._handlers = {};\n    each$13(mouseHandlers, function (handler, eventName) {\n        this._handlers[eventName] = bind(handler, this);\n    }, this);\n}\n\nBrushController.prototype = {\n\n    constructor: BrushController,\n\n    /**\n     * If set to null/undefined/false, select disabled.\n     * @param {Object} brushOption\n     * @param {string|boolean} brushOption.brushType 'line', 'rect', 'polygon' or false\n     *                          If passing false/null/undefined, disable brush.\n     *                          If passing 'auto', determined by panel.defaultBrushType.\n     *                              ('auto' can not be used in global panel)\n     * @param {number} [brushOption.brushMode='single'] 'single' or 'multiple'\n     * @param {boolean} [brushOption.transformable=true]\n     * @param {boolean} [brushOption.removeOnClick=false]\n     * @param {Object} [brushOption.brushStyle]\n     * @param {number} [brushOption.brushStyle.width]\n     * @param {number} [brushOption.brushStyle.lineWidth]\n     * @param {string} [brushOption.brushStyle.stroke]\n     * @param {string} [brushOption.brushStyle.fill]\n     * @param {number} [brushOption.z]\n     */\n    enableBrush: function (brushOption) {\n        if (__DEV__) {\n            assert$1(this._mounted);\n        }\n\n        this._brushType && doDisableBrush(this);\n        brushOption.brushType && doEnableBrush(this, brushOption);\n\n        return this;\n    },\n\n    /**\n     * @param {Array.<Object>} panelOpts If not pass, it is global brush.\n     *        Each items: {\n     *            panelId, // mandatory.\n     *            clipPath, // mandatory. function.\n     *            isTargetByCursor, // mandatory. function.\n     *            defaultBrushType, // optional, only used when brushType is 'auto'.\n     *            getLinearBrushOtherExtent, // optional. function.\n     *        }\n     */\n    setPanels: function (panelOpts) {\n        if (panelOpts && panelOpts.length) {\n            var panels = this._panels = {};\n            each$1(panelOpts, function (panelOpts) {\n                panels[panelOpts.panelId] = clone(panelOpts);\n            });\n        }\n        else {\n            this._panels = null;\n        }\n        return this;\n    },\n\n    /**\n     * @param {Object} [opt]\n     * @return {boolean} [opt.enableGlobalPan=false]\n     */\n    mount: function (opt) {\n        opt = opt || {};\n\n        if (__DEV__) {\n            this._mounted = true; // should be at first.\n        }\n\n        this._enableGlobalPan = opt.enableGlobalPan;\n\n        var thisGroup = this.group;\n        this._zr.add(thisGroup);\n\n        thisGroup.attr({\n            position: opt.position || [0, 0],\n            rotation: opt.rotation || 0,\n            scale: opt.scale || [1, 1]\n        });\n        this._transform = thisGroup.getLocalTransform();\n\n        return this;\n    },\n\n    eachCover: function (cb, context) {\n        each$13(this._covers, cb, context);\n    },\n\n    /**\n     * Update covers.\n     * @param {Array.<Object>} brushOptionList Like:\n     *        [\n     *            {id: 'xx', brushType: 'line', range: [23, 44], brushStyle, transformable},\n     *            {id: 'yy', brushType: 'rect', range: [[23, 44], [23, 54]]},\n     *            ...\n     *        ]\n     *        `brushType` is required in each cover info. (can not be 'auto')\n     *        `id` is not mandatory.\n     *        `brushStyle`, `transformable` is not mandatory, use DEFAULT_BRUSH_OPT by default.\n     *        If brushOptionList is null/undefined, all covers removed.\n     */\n    updateCovers: function (brushOptionList) {\n        if (__DEV__) {\n            assert$1(this._mounted);\n        }\n\n        brushOptionList = map(brushOptionList, function (brushOption) {\n            return merge(clone(DEFAULT_BRUSH_OPT), brushOption, true);\n        });\n\n        var tmpIdPrefix = '\\0-brush-index-';\n        var oldCovers = this._covers;\n        var newCovers = this._covers = [];\n        var controller = this;\n        var creatingCover = this._creatingCover;\n\n        (new DataDiffer(oldCovers, brushOptionList, oldGetKey, getKey))\n            .add(addOrUpdate)\n            .update(addOrUpdate)\n            .remove(remove)\n            .execute();\n\n        return this;\n\n        function getKey(brushOption, index) {\n            return (brushOption.id != null ? brushOption.id : tmpIdPrefix + index)\n                + '-' + brushOption.brushType;\n        }\n\n        function oldGetKey(cover, index) {\n            return getKey(cover.__brushOption, index);\n        }\n\n        function addOrUpdate(newIndex, oldIndex) {\n            var newBrushOption = brushOptionList[newIndex];\n            // Consider setOption in event listener of brushSelect,\n            // where updating cover when creating should be forbiden.\n            if (oldIndex != null && oldCovers[oldIndex] === creatingCover) {\n                newCovers[newIndex] = oldCovers[oldIndex];\n            }\n            else {\n                var cover = newCovers[newIndex] = oldIndex != null\n                    ? (\n                        oldCovers[oldIndex].__brushOption = newBrushOption,\n                        oldCovers[oldIndex]\n                    )\n                    : endCreating(controller, createCover(controller, newBrushOption));\n                updateCoverAfterCreation(controller, cover);\n            }\n        }\n\n        function remove(oldIndex) {\n            if (oldCovers[oldIndex] !== creatingCover) {\n                controller.group.remove(oldCovers[oldIndex]);\n            }\n        }\n    },\n\n    unmount: function () {\n        if (__DEV__) {\n            if (!this._mounted) {\n                return;\n            }\n        }\n\n        this.enableBrush(false);\n\n        // container may 'removeAll' outside.\n        clearCovers(this);\n        this._zr.remove(this.group);\n\n        if (__DEV__) {\n            this._mounted = false; // should be at last.\n        }\n\n        return this;\n    },\n\n    dispose: function () {\n        this.unmount();\n        this.off();\n    }\n};\n\nmixin(BrushController, Eventful);\n\nfunction doEnableBrush(controller, brushOption) {\n    var zr = controller._zr;\n\n    // Consider roam, which takes globalPan too.\n    if (!controller._enableGlobalPan) {\n        take(zr, MUTEX_RESOURCE_KEY, controller._uid);\n    }\n\n    each$13(controller._handlers, function (handler, eventName) {\n        zr.on(eventName, handler);\n    });\n\n    controller._brushType = brushOption.brushType;\n    controller._brushOption = merge(clone(DEFAULT_BRUSH_OPT), brushOption, true);\n}\n\nfunction doDisableBrush(controller) {\n    var zr = controller._zr;\n\n    release(zr, MUTEX_RESOURCE_KEY, controller._uid);\n\n    each$13(controller._handlers, function (handler, eventName) {\n        zr.off(eventName, handler);\n    });\n\n    controller._brushType = controller._brushOption = null;\n}\n\nfunction createCover(controller, brushOption) {\n    var cover = coverRenderers[brushOption.brushType].createCover(controller, brushOption);\n    cover.__brushOption = brushOption;\n    updateZ$1(cover, brushOption);\n    controller.group.add(cover);\n    return cover;\n}\n\nfunction endCreating(controller, creatingCover) {\n    var coverRenderer = getCoverRenderer(creatingCover);\n    if (coverRenderer.endCreating) {\n        coverRenderer.endCreating(controller, creatingCover);\n        updateZ$1(creatingCover, creatingCover.__brushOption);\n    }\n    return creatingCover;\n}\n\nfunction updateCoverShape(controller, cover) {\n    var brushOption = cover.__brushOption;\n    getCoverRenderer(cover).updateCoverShape(\n        controller, cover, brushOption.range, brushOption\n    );\n}\n\nfunction updateZ$1(cover, brushOption) {\n    var z = brushOption.z;\n    z == null && (z = COVER_Z);\n    cover.traverse(function (el) {\n        el.z = z;\n        el.z2 = z; // Consider in given container.\n    });\n}\n\nfunction updateCoverAfterCreation(controller, cover) {\n    getCoverRenderer(cover).updateCommon(controller, cover);\n    updateCoverShape(controller, cover);\n}\n\nfunction getCoverRenderer(cover) {\n    return coverRenderers[cover.__brushOption.brushType];\n}\n\n// return target panel or `true` (means global panel)\nfunction getPanelByPoint(controller, e, localCursorPoint) {\n    var panels = controller._panels;\n    if (!panels) {\n        return true; // Global panel\n    }\n    var panel;\n    var transform = controller._transform;\n    each$13(panels, function (pn) {\n        pn.isTargetByCursor(e, localCursorPoint, transform) && (panel = pn);\n    });\n    return panel;\n}\n\n// Return a panel or true\nfunction getPanelByCover(controller, cover) {\n    var panels = controller._panels;\n    if (!panels) {\n        return true; // Global panel\n    }\n    var panelId = cover.__brushOption.panelId;\n    // User may give cover without coord sys info,\n    // which is then treated as global panel.\n    return panelId != null ? panels[panelId] : true;\n}\n\nfunction clearCovers(controller) {\n    var covers = controller._covers;\n    var originalLength = covers.length;\n    each$13(covers, function (cover) {\n        controller.group.remove(cover);\n    }, controller);\n    covers.length = 0;\n\n    return !!originalLength;\n}\n\nfunction trigger(controller, opt) {\n    var areas = map$2(controller._covers, function (cover) {\n        var brushOption = cover.__brushOption;\n        var range = clone(brushOption.range);\n        return {\n            brushType: brushOption.brushType,\n            panelId: brushOption.panelId,\n            range: range\n        };\n    });\n\n    controller.trigger('brush', areas, {\n        isEnd: !!opt.isEnd,\n        removeOnClick: !!opt.removeOnClick\n    });\n}\n\nfunction shouldShowCover(controller) {\n    var track = controller._track;\n\n    if (!track.length) {\n        return false;\n    }\n\n    var p2 = track[track.length - 1];\n    var p1 = track[0];\n    var dx = p2[0] - p1[0];\n    var dy = p2[1] - p1[1];\n    var dist = mathPow$2(dx * dx + dy * dy, 0.5);\n\n    return dist > UNSELECT_THRESHOLD;\n}\n\nfunction getTrackEnds(track) {\n    var tail = track.length - 1;\n    tail < 0 && (tail = 0);\n    return [track[0], track[tail]];\n}\n\nfunction createBaseRectCover(doDrift, controller, brushOption, edgeNames) {\n    var cover = new Group();\n\n    cover.add(new Rect({\n        name: 'main',\n        style: makeStyle(brushOption),\n        silent: true,\n        draggable: true,\n        cursor: 'move',\n        drift: curry$2(doDrift, controller, cover, 'nswe'),\n        ondragend: curry$2(trigger, controller, {isEnd: true})\n    }));\n\n    each$13(\n        edgeNames,\n        function (name) {\n            cover.add(new Rect({\n                name: name,\n                style: {opacity: 0},\n                draggable: true,\n                silent: true,\n                invisible: true,\n                drift: curry$2(doDrift, controller, cover, name),\n                ondragend: curry$2(trigger, controller, {isEnd: true})\n            }));\n        }\n    );\n\n    return cover;\n}\n\nfunction updateBaseRect(controller, cover, localRange, brushOption) {\n    var lineWidth = brushOption.brushStyle.lineWidth || 0;\n    var handleSize = mathMax$6(lineWidth, MIN_RESIZE_LINE_WIDTH);\n    var x = localRange[0][0];\n    var y = localRange[1][0];\n    var xa = x - lineWidth / 2;\n    var ya = y - lineWidth / 2;\n    var x2 = localRange[0][1];\n    var y2 = localRange[1][1];\n    var x2a = x2 - handleSize + lineWidth / 2;\n    var y2a = y2 - handleSize + lineWidth / 2;\n    var width = x2 - x;\n    var height = y2 - y;\n    var widtha = width + lineWidth;\n    var heighta = height + lineWidth;\n\n    updateRectShape(controller, cover, 'main', x, y, width, height);\n\n    if (brushOption.transformable) {\n        updateRectShape(controller, cover, 'w', xa, ya, handleSize, heighta);\n        updateRectShape(controller, cover, 'e', x2a, ya, handleSize, heighta);\n        updateRectShape(controller, cover, 'n', xa, ya, widtha, handleSize);\n        updateRectShape(controller, cover, 's', xa, y2a, widtha, handleSize);\n\n        updateRectShape(controller, cover, 'nw', xa, ya, handleSize, handleSize);\n        updateRectShape(controller, cover, 'ne', x2a, ya, handleSize, handleSize);\n        updateRectShape(controller, cover, 'sw', xa, y2a, handleSize, handleSize);\n        updateRectShape(controller, cover, 'se', x2a, y2a, handleSize, handleSize);\n    }\n}\n\nfunction updateCommon(controller, cover) {\n    var brushOption = cover.__brushOption;\n    var transformable = brushOption.transformable;\n\n    var mainEl = cover.childAt(0);\n    mainEl.useStyle(makeStyle(brushOption));\n    mainEl.attr({\n        silent: !transformable,\n        cursor: transformable ? 'move' : 'default'\n    });\n\n    each$13(\n        ['w', 'e', 'n', 's', 'se', 'sw', 'ne', 'nw'],\n        function (name) {\n            var el = cover.childOfName(name);\n            var globalDir = getGlobalDirection(controller, name);\n\n            el && el.attr({\n                silent: !transformable,\n                invisible: !transformable,\n                cursor: transformable ? CURSOR_MAP[globalDir] + '-resize' : null\n            });\n        }\n    );\n}\n\nfunction updateRectShape(controller, cover, name, x, y, w, h) {\n    var el = cover.childOfName(name);\n    el && el.setShape(pointsToRect(\n        clipByPanel(controller, cover, [[x, y], [x + w, y + h]])\n    ));\n}\n\nfunction makeStyle(brushOption) {\n    return defaults({strokeNoScale: true}, brushOption.brushStyle);\n}\n\nfunction formatRectRange(x, y, x2, y2) {\n    var min = [mathMin$6(x, x2), mathMin$6(y, y2)];\n    var max = [mathMax$6(x, x2), mathMax$6(y, y2)];\n\n    return [\n        [min[0], max[0]], // x range\n        [min[1], max[1]] // y range\n    ];\n}\n\nfunction getTransform$1(controller) {\n    return getTransform(controller.group);\n}\n\nfunction getGlobalDirection(controller, localDirection) {\n    if (localDirection.length > 1) {\n        localDirection = localDirection.split('');\n        var globalDir = [\n            getGlobalDirection(controller, localDirection[0]),\n            getGlobalDirection(controller, localDirection[1])\n        ];\n        (globalDir[0] === 'e' || globalDir[0] === 'w') && globalDir.reverse();\n        return globalDir.join('');\n    }\n    else {\n        var map$$1 = {w: 'left', e: 'right', n: 'top', s: 'bottom'};\n        var inverseMap = {left: 'w', right: 'e', top: 'n', bottom: 's'};\n        var globalDir = transformDirection(\n            map$$1[localDirection], getTransform$1(controller)\n        );\n        return inverseMap[globalDir];\n    }\n}\n\nfunction driftRect(toRectRange, fromRectRange, controller, cover, name, dx, dy, e) {\n    var brushOption = cover.__brushOption;\n    var rectRange = toRectRange(brushOption.range);\n    var localDelta = toLocalDelta(controller, dx, dy);\n\n    each$13(name.split(''), function (namePart) {\n        var ind = DIRECTION_MAP[namePart];\n        rectRange[ind[0]][ind[1]] += localDelta[ind[0]];\n    });\n\n    brushOption.range = fromRectRange(formatRectRange(\n        rectRange[0][0], rectRange[1][0], rectRange[0][1], rectRange[1][1]\n    ));\n\n    updateCoverAfterCreation(controller, cover);\n    trigger(controller, {isEnd: false});\n}\n\nfunction driftPolygon(controller, cover, dx, dy, e) {\n    var range = cover.__brushOption.range;\n    var localDelta = toLocalDelta(controller, dx, dy);\n\n    each$13(range, function (point) {\n        point[0] += localDelta[0];\n        point[1] += localDelta[1];\n    });\n\n    updateCoverAfterCreation(controller, cover);\n    trigger(controller, {isEnd: false});\n}\n\nfunction toLocalDelta(controller, dx, dy) {\n    var thisGroup = controller.group;\n    var localD = thisGroup.transformCoordToLocal(dx, dy);\n    var localZero = thisGroup.transformCoordToLocal(0, 0);\n\n    return [localD[0] - localZero[0], localD[1] - localZero[1]];\n}\n\nfunction clipByPanel(controller, cover, data) {\n    var panel = getPanelByCover(controller, cover);\n\n    return (panel && panel !== true)\n        ? panel.clipPath(data, controller._transform)\n        : clone(data);\n}\n\nfunction pointsToRect(points) {\n    var xmin = mathMin$6(points[0][0], points[1][0]);\n    var ymin = mathMin$6(points[0][1], points[1][1]);\n    var xmax = mathMax$6(points[0][0], points[1][0]);\n    var ymax = mathMax$6(points[0][1], points[1][1]);\n\n    return {\n        x: xmin,\n        y: ymin,\n        width: xmax - xmin,\n        height: ymax - ymin\n    };\n}\n\nfunction resetCursor(controller, e, localCursorPoint) {\n    // Check active\n    if (!controller._brushType) {\n        return;\n    }\n\n    var zr = controller._zr;\n    var covers = controller._covers;\n    var currPanel = getPanelByPoint(controller, e, localCursorPoint);\n\n    // Check whether in covers.\n    if (!controller._dragging) {\n        for (var i = 0; i < covers.length; i++) {\n            var brushOption = covers[i].__brushOption;\n            if (currPanel\n                && (currPanel === true || brushOption.panelId === currPanel.panelId)\n                && coverRenderers[brushOption.brushType].contain(\n                    covers[i], localCursorPoint[0], localCursorPoint[1]\n                )\n            ) {\n                // Use cursor style set on cover.\n                return;\n            }\n        }\n    }\n\n    currPanel && zr.setCursorStyle('crosshair');\n}\n\nfunction preventDefault(e) {\n    var rawE = e.event;\n    rawE.preventDefault && rawE.preventDefault();\n}\n\nfunction mainShapeContain(cover, x, y) {\n    return cover.childOfName('main').contain(x, y);\n}\n\nfunction updateCoverByMouse(controller, e, localCursorPoint, isEnd) {\n    var creatingCover = controller._creatingCover;\n    var panel = controller._creatingPanel;\n    var thisBrushOption = controller._brushOption;\n    var eventParams;\n\n    controller._track.push(localCursorPoint.slice());\n\n    if (shouldShowCover(controller) || creatingCover) {\n\n        if (panel && !creatingCover) {\n            thisBrushOption.brushMode === 'single' && clearCovers(controller);\n            var brushOption = clone(thisBrushOption);\n            brushOption.brushType = determineBrushType(brushOption.brushType, panel);\n            brushOption.panelId = panel === true ? null : panel.panelId;\n            creatingCover = controller._creatingCover = createCover(controller, brushOption);\n            controller._covers.push(creatingCover);\n        }\n\n        if (creatingCover) {\n            var coverRenderer = coverRenderers[determineBrushType(controller._brushType, panel)];\n            var coverBrushOption = creatingCover.__brushOption;\n\n            coverBrushOption.range = coverRenderer.getCreatingRange(\n                clipByPanel(controller, creatingCover, controller._track)\n            );\n\n            if (isEnd) {\n                endCreating(controller, creatingCover);\n                coverRenderer.updateCommon(controller, creatingCover);\n            }\n\n            updateCoverShape(controller, creatingCover);\n\n            eventParams = {isEnd: isEnd};\n        }\n    }\n    else if (\n        isEnd\n        && thisBrushOption.brushMode === 'single'\n        && thisBrushOption.removeOnClick\n    ) {\n        // Help user to remove covers easily, only by a tiny drag, in 'single' mode.\n        // But a single click do not clear covers, because user may have casual\n        // clicks (for example, click on other component and do not expect covers\n        // disappear).\n        // Only some cover removed, trigger action, but not every click trigger action.\n        if (getPanelByPoint(controller, e, localCursorPoint) && clearCovers(controller)) {\n            eventParams = {isEnd: isEnd, removeOnClick: true};\n        }\n    }\n\n    return eventParams;\n}\n\nfunction determineBrushType(brushType, panel) {\n    if (brushType === 'auto') {\n        if (__DEV__) {\n            assert$1(\n                panel && panel.defaultBrushType,\n                'MUST have defaultBrushType when brushType is \"atuo\"'\n            );\n        }\n        return panel.defaultBrushType;\n    }\n    return brushType;\n}\n\nvar mouseHandlers = {\n\n    mousedown: function (e) {\n        if (this._dragging) {\n            // In case some browser do not support globalOut,\n            // and release mose out side the browser.\n            handleDragEnd.call(this, e);\n        }\n        else if (!e.target || !e.target.draggable) {\n\n            preventDefault(e);\n\n            var localCursorPoint = this.group.transformCoordToLocal(e.offsetX, e.offsetY);\n\n            this._creatingCover = null;\n            var panel = this._creatingPanel = getPanelByPoint(this, e, localCursorPoint);\n\n            if (panel) {\n                this._dragging = true;\n                this._track = [localCursorPoint.slice()];\n            }\n        }\n    },\n\n    mousemove: function (e) {\n        var localCursorPoint = this.group.transformCoordToLocal(e.offsetX, e.offsetY);\n\n        resetCursor(this, e, localCursorPoint);\n\n        if (this._dragging) {\n\n            preventDefault(e);\n\n            var eventParams = updateCoverByMouse(this, e, localCursorPoint, false);\n\n            eventParams && trigger(this, eventParams);\n        }\n    },\n\n    mouseup: handleDragEnd //,\n\n    // FIXME\n    // in tooltip, globalout should not be triggered.\n    // globalout: handleDragEnd\n};\n\nfunction handleDragEnd(e) {\n    if (this._dragging) {\n\n        preventDefault(e);\n\n        var localCursorPoint = this.group.transformCoordToLocal(e.offsetX, e.offsetY);\n        var eventParams = updateCoverByMouse(this, e, localCursorPoint, true);\n\n        this._dragging = false;\n        this._track = [];\n        this._creatingCover = null;\n\n        // trigger event shoule be at final, after procedure will be nested.\n        eventParams && trigger(this, eventParams);\n    }\n}\n\n/**\n * key: brushType\n * @type {Object}\n */\nvar coverRenderers = {\n\n    lineX: getLineRenderer(0),\n\n    lineY: getLineRenderer(1),\n\n    rect: {\n        createCover: function (controller, brushOption) {\n            return createBaseRectCover(\n                curry$2(\n                    driftRect,\n                    function (range) {\n                        return range;\n                    },\n                    function (range) {\n                        return range;\n                    }\n                ),\n                controller,\n                brushOption,\n                ['w', 'e', 'n', 's', 'se', 'sw', 'ne', 'nw']\n            );\n        },\n        getCreatingRange: function (localTrack) {\n            var ends = getTrackEnds(localTrack);\n            return formatRectRange(ends[1][0], ends[1][1], ends[0][0], ends[0][1]);\n        },\n        updateCoverShape: function (controller, cover, localRange, brushOption) {\n            updateBaseRect(controller, cover, localRange, brushOption);\n        },\n        updateCommon: updateCommon,\n        contain: mainShapeContain\n    },\n\n    polygon: {\n        createCover: function (controller, brushOption) {\n            var cover = new Group();\n\n            // Do not use graphic.Polygon because graphic.Polyline do not close the\n            // border of the shape when drawing, which is a better experience for user.\n            cover.add(new Polyline({\n                name: 'main',\n                style: makeStyle(brushOption),\n                silent: true\n            }));\n\n            return cover;\n        },\n        getCreatingRange: function (localTrack) {\n            return localTrack;\n        },\n        endCreating: function (controller, cover) {\n            cover.remove(cover.childAt(0));\n            // Use graphic.Polygon close the shape.\n            cover.add(new Polygon({\n                name: 'main',\n                draggable: true,\n                drift: curry$2(driftPolygon, controller, cover),\n                ondragend: curry$2(trigger, controller, {isEnd: true})\n            }));\n        },\n        updateCoverShape: function (controller, cover, localRange, brushOption) {\n            cover.childAt(0).setShape({\n                points: clipByPanel(controller, cover, localRange)\n            });\n        },\n        updateCommon: updateCommon,\n        contain: mainShapeContain\n    }\n};\n\nfunction getLineRenderer(xyIndex) {\n    return {\n        createCover: function (controller, brushOption) {\n            return createBaseRectCover(\n                curry$2(\n                    driftRect,\n                    function (range) {\n                        var rectRange = [range, [0, 100]];\n                        xyIndex && rectRange.reverse();\n                        return rectRange;\n                    },\n                    function (rectRange) {\n                        return rectRange[xyIndex];\n                    }\n                ),\n                controller,\n                brushOption,\n                [['w', 'e'], ['n', 's']][xyIndex]\n            );\n        },\n        getCreatingRange: function (localTrack) {\n            var ends = getTrackEnds(localTrack);\n            var min = mathMin$6(ends[0][xyIndex], ends[1][xyIndex]);\n            var max = mathMax$6(ends[0][xyIndex], ends[1][xyIndex]);\n\n            return [min, max];\n        },\n        updateCoverShape: function (controller, cover, localRange, brushOption) {\n            var otherExtent;\n            // If brushWidth not specified, fit the panel.\n            var panel = getPanelByCover(controller, cover);\n            if (panel !== true && panel.getLinearBrushOtherExtent) {\n                otherExtent = panel.getLinearBrushOtherExtent(\n                    xyIndex, controller._transform\n                );\n            }\n            else {\n                var zr = controller._zr;\n                otherExtent = [0, [zr.getWidth(), zr.getHeight()][1 - xyIndex]];\n            }\n            var rectRange = [localRange, otherExtent];\n            xyIndex && rectRange.reverse();\n\n            updateBaseRect(controller, cover, rectRange, brushOption);\n        },\n        updateCommon: updateCommon,\n        contain: mainShapeContain\n    };\n}\n\nfunction makeRectPanelClipPath(rect) {\n    rect = normalizeRect(rect);\n    return function (localPoints, transform) {\n        return clipPointsByRect(localPoints, rect);\n    };\n}\n\nfunction makeLinearBrushOtherExtent(rect, specifiedXYIndex) {\n    rect = normalizeRect(rect);\n    return function (xyIndex) {\n        var idx = specifiedXYIndex != null ? specifiedXYIndex : xyIndex;\n        var brushWidth = idx ? rect.width : rect.height;\n        var base = idx ? rect.x : rect.y;\n        return [base, base + (brushWidth || 0)];\n    };\n}\n\nfunction makeRectIsTargetByCursor(rect, api, targetModel) {\n    rect = normalizeRect(rect);\n    return function (e, localCursorPoint, transform) {\n        return rect.contain(localCursorPoint[0], localCursorPoint[1])\n            && !onIrrelevantElement(e, api, targetModel);\n    };\n}\n\n// Consider width/height is negative.\nfunction normalizeRect(rect) {\n    return BoundingRect.create(rect);\n}\n\nvar elementList = ['axisLine', 'axisTickLabel', 'axisName'];\n\nvar AxisView$2 = extendComponentView({\n\n    type: 'parallelAxis',\n\n    /**\n     * @override\n     */\n    init: function (ecModel, api) {\n        AxisView$2.superApply(this, 'init', arguments);\n\n        /**\n         * @type {module:echarts/component/helper/BrushController}\n         */\n        (this._brushController = new BrushController(api.getZr()))\n            .on('brush', bind(this._onBrush, this));\n    },\n\n    /**\n     * @override\n     */\n    render: function (axisModel, ecModel, api, payload) {\n        if (fromAxisAreaSelect(axisModel, ecModel, payload)) {\n            return;\n        }\n\n        this.axisModel = axisModel;\n        this.api = api;\n\n        this.group.removeAll();\n\n        var oldAxisGroup = this._axisGroup;\n        this._axisGroup = new Group();\n        this.group.add(this._axisGroup);\n\n        if (!axisModel.get('show')) {\n            return;\n        }\n\n        var coordSysModel = getCoordSysModel(axisModel, ecModel);\n        var coordSys = coordSysModel.coordinateSystem;\n\n        var areaSelectStyle = axisModel.getAreaSelectStyle();\n        var areaWidth = areaSelectStyle.width;\n\n        var dim = axisModel.axis.dim;\n        var axisLayout = coordSys.getAxisLayout(dim);\n\n        var builderOpt = extend(\n            {strokeContainThreshold: areaWidth},\n            axisLayout\n        );\n\n        var axisBuilder = new AxisBuilder(axisModel, builderOpt);\n\n        each$1(elementList, axisBuilder.add, axisBuilder);\n\n        this._axisGroup.add(axisBuilder.getGroup());\n\n        this._refreshBrushController(\n            builderOpt, areaSelectStyle, axisModel, coordSysModel, areaWidth, api\n        );\n\n        var animationModel = (payload && payload.animation === false) ? null : axisModel;\n        groupTransition(oldAxisGroup, this._axisGroup, animationModel);\n    },\n\n    // /**\n    //  * @override\n    //  */\n    // updateVisual: function (axisModel, ecModel, api, payload) {\n    //     this._brushController && this._brushController\n    //         .updateCovers(getCoverInfoList(axisModel));\n    // },\n\n    _refreshBrushController: function (\n        builderOpt, areaSelectStyle, axisModel, coordSysModel, areaWidth, api\n    ) {\n        // After filtering, axis may change, select area needs to be update.\n        var extent = axisModel.axis.getExtent();\n        var extentLen = extent[1] - extent[0];\n        var extra = Math.min(30, Math.abs(extentLen) * 0.1); // Arbitrary value.\n\n        // width/height might be negative, which will be\n        // normalized in BoundingRect.\n        var rect = BoundingRect.create({\n            x: extent[0],\n            y: -areaWidth / 2,\n            width: extentLen,\n            height: areaWidth\n        });\n        rect.x -= extra;\n        rect.width += 2 * extra;\n\n        this._brushController\n            .mount({\n                enableGlobalPan: true,\n                rotation: builderOpt.rotation,\n                position: builderOpt.position\n            })\n            .setPanels([{\n                panelId: 'pl',\n                clipPath: makeRectPanelClipPath(rect),\n                isTargetByCursor: makeRectIsTargetByCursor(rect, api, coordSysModel),\n                getLinearBrushOtherExtent: makeLinearBrushOtherExtent(rect, 0)\n            }])\n            .enableBrush({\n                brushType: 'lineX',\n                brushStyle: areaSelectStyle,\n                removeOnClick: true\n            })\n            .updateCovers(getCoverInfoList(axisModel));\n    },\n\n    _onBrush: function (coverInfoList, opt) {\n        // Do not cache these object, because the mey be changed.\n        var axisModel = this.axisModel;\n        var axis = axisModel.axis;\n        var intervals = map(coverInfoList, function (coverInfo) {\n            return [\n                axis.coordToData(coverInfo.range[0], true),\n                axis.coordToData(coverInfo.range[1], true)\n            ];\n        });\n\n        // If realtime is true, action is not dispatched on drag end, because\n        // the drag end emits the same params with the last drag move event,\n        // and may have some delay when using touch pad.\n        if (!axisModel.option.realtime === opt.isEnd || opt.removeOnClick) { // jshint ignore:line\n            this.api.dispatchAction({\n                type: 'axisAreaSelect',\n                parallelAxisId: axisModel.id,\n                intervals: intervals\n            });\n        }\n    },\n\n    /**\n     * @override\n     */\n    dispose: function () {\n        this._brushController.dispose();\n    }\n});\n\nfunction fromAxisAreaSelect(axisModel, ecModel, payload) {\n    return payload\n        && payload.type === 'axisAreaSelect'\n        && ecModel.findComponents(\n            {mainType: 'parallelAxis', query: payload}\n        )[0] === axisModel;\n}\n\nfunction getCoverInfoList(axisModel) {\n    var axis = axisModel.axis;\n    return map(axisModel.activeIntervals, function (interval) {\n        return {\n            brushType: 'lineX',\n            panelId: 'pl',\n            range: [\n                axis.dataToCoord(interval[0], true),\n                axis.dataToCoord(interval[1], true)\n            ]\n        };\n    });\n}\n\nfunction getCoordSysModel(axisModel, ecModel) {\n    return ecModel.getComponent(\n        'parallel', axisModel.get('parallelIndex')\n    );\n}\n\nvar CLICK_THRESHOLD = 5; // > 4\n\n// Parallel view\nextendComponentView({\n    type: 'parallel',\n\n    render: function (parallelModel, ecModel, api) {\n        this._model = parallelModel;\n        this._api = api;\n\n        if (!this._handlers) {\n            this._handlers = {};\n            each$1(handlers, function (handler, eventName) {\n                api.getZr().on(eventName, this._handlers[eventName] = bind(handler, this));\n            }, this);\n        }\n\n        createOrUpdate(\n            this,\n            '_throttledDispatchExpand',\n            parallelModel.get('axisExpandRate'),\n            'fixRate'\n        );\n    },\n\n    dispose: function (ecModel, api) {\n        each$1(this._handlers, function (handler, eventName) {\n            api.getZr().off(eventName, handler);\n        });\n        this._handlers = null;\n    },\n\n    /**\n     * @param {Object} [opt] If null, cancle the last action triggering for debounce.\n     */\n    _throttledDispatchExpand: function (opt) {\n        this._dispatchExpand(opt);\n    },\n\n    _dispatchExpand: function (opt) {\n        opt && this._api.dispatchAction(\n            extend({type: 'parallelAxisExpand'}, opt)\n        );\n    }\n\n});\n\nvar handlers = {\n\n    mousedown: function (e) {\n        if (checkTrigger(this, 'click')) {\n            this._mouseDownPoint = [e.offsetX, e.offsetY];\n        }\n    },\n\n    mouseup: function (e) {\n        var mouseDownPoint = this._mouseDownPoint;\n\n        if (checkTrigger(this, 'click') && mouseDownPoint) {\n            var point = [e.offsetX, e.offsetY];\n            var dist = Math.pow(mouseDownPoint[0] - point[0], 2)\n                + Math.pow(mouseDownPoint[1] - point[1], 2);\n\n            if (dist > CLICK_THRESHOLD) {\n                return;\n            }\n\n            var result = this._model.coordinateSystem.getSlidedAxisExpandWindow(\n                [e.offsetX, e.offsetY]\n            );\n\n            result.behavior !== 'none' && this._dispatchExpand({\n                axisExpandWindow: result.axisExpandWindow\n            });\n        }\n\n        this._mouseDownPoint = null;\n    },\n\n    mousemove: function (e) {\n        // Should do nothing when brushing.\n        if (this._mouseDownPoint || !checkTrigger(this, 'mousemove')) {\n            return;\n        }\n        var model = this._model;\n        var result = model.coordinateSystem.getSlidedAxisExpandWindow(\n            [e.offsetX, e.offsetY]\n        );\n\n        var behavior = result.behavior;\n        behavior === 'jump' && this._throttledDispatchExpand.debounceNextCall(model.get('axisExpandDebounce'));\n        this._throttledDispatchExpand(\n            behavior === 'none'\n                ? null // Cancle the last trigger, in case that mouse slide out of the area quickly.\n                : {\n                    axisExpandWindow: result.axisExpandWindow,\n                    // Jumping uses animation, and sliding suppresses animation.\n                    animation: behavior === 'jump'  ? null : false\n                }\n        );\n    }\n};\n\nfunction checkTrigger(view, triggerOn) {\n    var model = view._model;\n    return model.get('axisExpandable') && model.get('axisExpandTriggerOn') === triggerOn;\n}\n\nregisterPreprocessor(parallelPreprocessor);\n\nSeriesModel.extend({\n\n    type: 'series.parallel',\n\n    dependencies: ['parallel'],\n\n    visualColorAccessPath: 'lineStyle.color',\n\n    getInitialData: function (option, ecModel) {\n        // Anication is forbiden in progressive data mode.\n        if (this.option.progressive) {\n            this.option.animation = false;\n        }\n\n        var source = this.getSource();\n\n        setEncodeAndDimensions(source, this);\n\n        return createListFromArray(source, this);\n    },\n\n    /**\n     * User can get data raw indices on 'axisAreaSelected' event received.\n     *\n     * @public\n     * @param {string} activeState 'active' or 'inactive' or 'normal'\n     * @return {Array.<number>} Raw indices\n     */\n    getRawIndicesByActiveState: function (activeState) {\n        var coordSys = this.coordinateSystem;\n        var data = this.getData();\n        var indices = [];\n\n        coordSys.eachActiveState(data, function (theActiveState, dataIndex) {\n            if (activeState === theActiveState) {\n                indices.push(data.getRawIndex(dataIndex));\n            }\n        });\n\n        return indices;\n    },\n\n    defaultOption: {\n        zlevel: 0,                  // \n        z: 2,                       // \n\n        coordinateSystem: 'parallel',\n        parallelIndex: 0,\n\n        label: {\n            show: false\n        },\n\n        inactiveOpacity: 0.05,\n        activeOpacity: 1,\n\n        lineStyle: {\n            width: 1,\n            opacity: 0.45,\n            type: 'solid'\n        },\n        emphasis: {\n            label: {\n                show: false\n            }\n        },\n\n        progressive: false, // 100\n        smooth: false,\n\n        animationEasing: 'linear'\n    }\n});\n\nfunction setEncodeAndDimensions(source, seriesModel) {\n    // The mapping of parallelAxis dimension to data dimension can\n    // be specified in parallelAxis.option.dim. For example, if\n    // parallelAxis.option.dim is 'dim3', it mapping to the third\n    // dimension of data. But `data.encode` has higher priority.\n    // Moreover, parallelModel.dimension should not be regarded as data\n    // dimensions. Consider dimensions = ['dim4', 'dim2', 'dim6'];\n\n    if (source.encodeDefine) {\n        return;\n    }\n\n    var parallelModel = seriesModel.ecModel.getComponent(\n        'parallel', seriesModel.get('parallelIndex')\n    );\n    if (!parallelModel) {\n        return;\n    }\n\n    var encodeDefine = source.encodeDefine = createHashMap();\n    each$1(parallelModel.dimensions, function (axisDim) {\n        var dataDimIndex = convertDimNameToNumber(axisDim);\n        encodeDefine.set(axisDim, dataDimIndex);\n    });\n}\n\nfunction convertDimNameToNumber(dimName) {\n    return +dimName.replace('dim', '');\n}\n\nvar SMOOTH = 0.3;\n\nvar ParallelView = Chart.extend({\n\n    type: 'parallel',\n\n    init: function () {\n\n        /**\n         * @type {module:zrender/container/Group}\n         * @private\n         */\n        this._dataGroup = new Group();\n\n        this.group.add(this._dataGroup);\n\n        /**\n         * @type {module:echarts/data/List}\n         */\n        this._data;\n    },\n\n    /**\n     * @override\n     */\n    render: function (seriesModel, ecModel, api, payload) {\n        this._renderForNormal(seriesModel, payload);\n        // this[\n        //     seriesModel.option.progressive\n        //         ? '_renderForProgressive'\n        //         : '_renderForNormal'\n        // ](seriesModel);\n    },\n\n    dispose: function () {},\n\n    /**\n     * @private\n     */\n    _renderForNormal: function (seriesModel, payload) {\n        var dataGroup = this._dataGroup;\n        var data = seriesModel.getData();\n        var oldData = this._data;\n        var coordSys = seriesModel.coordinateSystem;\n        var dimensions = coordSys.dimensions;\n        var option = seriesModel.option;\n        var smooth = option.smooth ? SMOOTH : null;\n\n        // Consider switch between progressive and not.\n        // oldData && oldData.__plProgressive && dataGroup.removeAll();\n\n        data.diff(oldData)\n            .add(add)\n            .update(update)\n            .remove(remove)\n            .execute();\n\n        // Update style\n        updateElCommon(data, smooth);\n\n        // First create\n        if (!this._data) {\n            var clipPath = createGridClipShape$1(\n                coordSys, seriesModel, function () {\n                    // Callback will be invoked immediately if there is no animation\n                    setTimeout(function () {\n                        dataGroup.removeClipPath();\n                    });\n                }\n            );\n            dataGroup.setClipPath(clipPath);\n        }\n\n        this._data = data;\n\n        function add(newDataIndex) {\n            addEl(data, dataGroup, newDataIndex, dimensions, coordSys, null, smooth);\n        }\n\n        function update(newDataIndex, oldDataIndex) {\n            var line = oldData.getItemGraphicEl(oldDataIndex);\n            var points = createLinePoints(data, newDataIndex, dimensions, coordSys);\n            data.setItemGraphicEl(newDataIndex, line);\n            var animationModel = (payload && payload.animation === false) ? null : seriesModel;\n            updateProps(line, {shape: {points: points}}, animationModel, newDataIndex);\n        }\n\n        function remove(oldDataIndex) {\n            var line = oldData.getItemGraphicEl(oldDataIndex);\n            dataGroup.remove(line);\n        }\n\n    },\n\n    /**\n     * @private\n     */\n    // _renderForProgressive: function (seriesModel) {\n    //     var dataGroup = this._dataGroup;\n    //     var data = seriesModel.getData();\n    //     var oldData = this._data;\n    //     var coordSys = seriesModel.coordinateSystem;\n    //     var dimensions = coordSys.dimensions;\n    //     var option = seriesModel.option;\n    //     var progressive = option.progressive;\n    //     var smooth = option.smooth ? SMOOTH : null;\n\n    //     // In progressive animation is disabled, so use simple data diff,\n    //     // which effects performance less.\n    //     // (Typically performance for data with length 7000+ like:\n    //     // simpleDiff: 60ms, addEl: 184ms,\n    //     // in RMBP 2.4GHz intel i7, OSX 10.9 chrome 50.0.2661.102 (64-bit))\n    //     if (simpleDiff(oldData, data, dimensions)) {\n    //         dataGroup.removeAll();\n    //         data.each(function (dataIndex) {\n    //             addEl(data, dataGroup, dataIndex, dimensions, coordSys);\n    //         });\n    //     }\n\n    //     updateElCommon(data, progressive, smooth);\n\n    //     // Consider switch between progressive and not.\n    //     data.__plProgressive = true;\n    //     this._data = data;\n    // },\n\n    /**\n     * @override\n     */\n    remove: function () {\n        this._dataGroup && this._dataGroup.removeAll();\n        this._data = null;\n    }\n});\n\nfunction createGridClipShape$1(coordSys, seriesModel, cb) {\n    var parallelModel = coordSys.model;\n    var rect = coordSys.getRect();\n    var rectEl = new Rect({\n        shape: {\n            x: rect.x,\n            y: rect.y,\n            width: rect.width,\n            height: rect.height\n        }\n    });\n\n    var dim = parallelModel.get('layout') === 'horizontal' ? 'width' : 'height';\n    rectEl.setShape(dim, 0);\n    initProps(rectEl, {\n        shape: {\n            width: rect.width,\n            height: rect.height\n        }\n    }, seriesModel, cb);\n    return rectEl;\n}\n\nfunction createLinePoints(data, dataIndex, dimensions, coordSys) {\n    var points = [];\n    for (var i = 0; i < dimensions.length; i++) {\n        var dimName = dimensions[i];\n        var value = data.get(data.mapDimension(dimName), dataIndex);\n        if (!isEmptyValue(value, coordSys.getAxis(dimName).type)) {\n            points.push(coordSys.dataToPoint(value, dimName));\n        }\n    }\n    return points;\n}\n\nfunction addEl(data, dataGroup, dataIndex, dimensions, coordSys) {\n    var points = createLinePoints(data, dataIndex, dimensions, coordSys);\n    var line = new Polyline({\n        shape: {points: points},\n        silent: true,\n        z2: 10\n    });\n    dataGroup.add(line);\n    data.setItemGraphicEl(dataIndex, line);\n}\n\nfunction updateElCommon(data, smooth) {\n    var seriesStyleModel = data.hostModel.getModel('lineStyle');\n    var lineStyle = seriesStyleModel.getLineStyle();\n    data.eachItemGraphicEl(function (line, dataIndex) {\n        if (data.hasItemOption) {\n            var itemModel = data.getItemModel(dataIndex);\n            var lineStyleModel = itemModel.getModel('lineStyle', seriesStyleModel);\n            lineStyle = lineStyleModel.getLineStyle(['color', 'stroke']);\n        }\n\n        line.useStyle(extend(lineStyle, {\n            fill: null,\n            // lineStyle.color have been set to itemVisual in module:echarts/visual/seriesColor.\n            stroke: data.getItemVisual(dataIndex, 'color'),\n            // lineStyle.opacity have been set to itemVisual in parallelVisual.\n            opacity: data.getItemVisual(dataIndex, 'opacity')\n        }));\n\n        line.shape.smooth = smooth;\n    });\n}\n\n// function simpleDiff(oldData, newData, dimensions) {\n//     var oldLen;\n//     if (!oldData\n//         || !oldData.__plProgressive\n//         || (oldLen = oldData.count()) !== newData.count()\n//     ) {\n//         return true;\n//     }\n\n//     var dimLen = dimensions.length;\n//     for (var i = 0; i < oldLen; i++) {\n//         for (var j = 0; j < dimLen; j++) {\n//             if (oldData.get(dimensions[j], i) !== newData.get(dimensions[j], i)) {\n//                 return true;\n//             }\n//         }\n//     }\n\n//     return false;\n// }\n\n// FIXME\n// ?\nfunction isEmptyValue(val, axisType) {\n    return axisType === 'category'\n        ? val == null\n        : (val == null || isNaN(val)); // axisType === 'value'\n}\n\nvar opacityAccessPath$1 = ['lineStyle', 'normal', 'opacity'];\n\nvar parallelVisual = function (ecModel) {\n\n    ecModel.eachSeriesByType('parallel', function (seriesModel) {\n\n        var itemStyleModel = seriesModel.getModel('itemStyle');\n        var lineStyleModel = seriesModel.getModel('lineStyle');\n        var globalColors = ecModel.get('color');\n\n        var color = lineStyleModel.get('color')\n            || itemStyleModel.get('color')\n            || globalColors[seriesModel.seriesIndex % globalColors.length];\n        var inactiveOpacity = seriesModel.get('inactiveOpacity');\n        var activeOpacity = seriesModel.get('activeOpacity');\n        var lineStyle = seriesModel.getModel('lineStyle').getLineStyle();\n\n        var coordSys = seriesModel.coordinateSystem;\n        var data = seriesModel.getData();\n\n        var opacityMap = {\n            normal: lineStyle.opacity,\n            active: activeOpacity,\n            inactive: inactiveOpacity\n        };\n\n        coordSys.eachActiveState(data, function (activeState, dataIndex) {\n            var itemModel = data.getItemModel(dataIndex);\n            var opacity = opacityMap[activeState];\n            if (activeState === 'normal') {\n                var itemOpacity = itemModel.get(opacityAccessPath$1, true);\n                itemOpacity != null && (opacity = itemOpacity);\n            }\n            data.setItemVisual(dataIndex, 'opacity', opacity);\n        });\n\n        data.setVisual('color', color);\n    });\n};\n\nregisterVisual(parallelVisual);\n\n/**\n * @file Get initial data and define sankey view's series model\n * @author Deqing Li(annong035@gmail.com)\n */\n\nvar SankeySeries = SeriesModel.extend({\n\n    type: 'series.sankey',\n\n    layoutInfo: null,\n\n    /**\n     * Init a graph data structure from data in option series\n     *\n     * @param  {Object} option  the object used to config echarts view\n     * @return {module:echarts/data/List} storage initial data\n     */\n    getInitialData: function (option) {\n        var links = option.edges || option.links;\n        var nodes = option.data || option.nodes;\n        if (nodes && links) {\n            var graph = createGraphFromNodeEdge(nodes, links, this, true);\n            return graph.data;\n        }\n    },\n\n    /**\n     * Return the graphic data structure\n     *\n     * @return {module:echarts/data/Graph} graphic data structure\n     */\n    getGraph: function () {\n        return this.getData().graph;\n    },\n\n    /**\n     * Get edge data of graphic data structure\n     *\n     * @return {module:echarts/data/List} data structure of list\n     */\n    getEdgeData: function () {\n        return this.getGraph().edgeData;\n    },\n\n    /**\n     * @override\n     */\n    formatTooltip: function (dataIndex, multipleSeries, dataType) {\n        // dataType === 'node' or empty do not show tooltip by default\n        if (dataType === 'edge') {\n            var params = this.getDataParams(dataIndex, dataType);\n            var rawDataOpt = params.data;\n            var html = rawDataOpt.source + ' -- ' + rawDataOpt.target;\n            if (params.value) {\n                html += ' : ' + params.value;\n            }\n            return encodeHTML(html);\n        }\n\n        return SankeySeries.superCall(this, 'formatTooltip', dataIndex, multipleSeries);\n    },\n\n    defaultOption: {\n        zlevel: 0,\n        z: 2,\n\n        coordinateSystem: 'view',\n\n        layout: null,\n\n        // the position of the whole view\n        left: '5%',\n        top: '5%',\n        right: '20%',\n        bottom: '5%',\n\n        // the dx of the node\n        nodeWidth: 20,\n\n        // the vertical distance between two nodes\n        nodeGap: 8,\n\n        // the number of iterations to change the position of the node\n        layoutIterations: 32,\n\n        label: {\n            show: true,\n            position: 'right',\n            color: '#000',\n            fontSize: 12\n        },\n\n        itemStyle: {\n            borderWidth: 1,\n            borderColor: '#333'\n        },\n\n        lineStyle: {\n            color: '#314656',\n            opacity: 0.2,\n            curveness: 0.5\n        },\n\n        emphasis: {\n            label: {\n                show: true\n            },\n            lineStyle: {\n                opacity: 0.6\n            }\n        },\n\n        animationEasing: 'linear',\n\n        animationDuration: 1000\n    }\n\n});\n\n/**\n * @file  The file used to draw sankey view\n * @author  Deqing Li(annong035@gmail.com)\n */\n\nvar SankeyShape = extendShape({\n    shape: {\n        x1: 0, y1: 0,\n        x2: 0, y2: 0,\n        cpx1: 0, cpy1: 0,\n        cpx2: 0, cpy2: 0,\n\n        extent: 0\n    },\n\n    buildPath: function (ctx, shape) {\n        var halfExtent = shape.extent / 2;\n        ctx.moveTo(shape.x1, shape.y1 - halfExtent);\n        ctx.bezierCurveTo(\n            shape.cpx1, shape.cpy1 - halfExtent,\n            shape.cpx2, shape.cpy2 - halfExtent,\n            shape.x2, shape.y2 - halfExtent\n        );\n        ctx.lineTo(shape.x2, shape.y2 + halfExtent);\n        ctx.bezierCurveTo(\n            shape.cpx2, shape.cpy2 + halfExtent,\n            shape.cpx1, shape.cpy1 + halfExtent,\n            shape.x1, shape.y1 + halfExtent\n        );\n        ctx.closePath();\n    }\n});\n\nextendChartView({\n\n    type: 'sankey',\n\n    /**\n     * @private\n     * @type {module:echarts/chart/sankey/SankeySeries}\n     */\n    _model: null,\n\n    render: function (seriesModel, ecModel, api) {\n        var graph = seriesModel.getGraph();\n        var group = this.group;\n        var layoutInfo = seriesModel.layoutInfo;\n        var nodeData = seriesModel.getData();\n        var edgeData = seriesModel.getData('edge');\n\n        this._model = seriesModel;\n\n        group.removeAll();\n\n        group.attr('position', [layoutInfo.x, layoutInfo.y]);\n\n        // generate a bezire Curve for each edge\n        graph.eachEdge(function (edge) {\n            var curve = new SankeyShape();\n\n            curve.dataIndex = edge.dataIndex;\n            curve.seriesIndex = seriesModel.seriesIndex;\n            curve.dataType = 'edge';\n\n            var lineStyleModel = edge.getModel('lineStyle');\n            var curvature = lineStyleModel.get('curveness');\n            var n1Layout = edge.node1.getLayout();\n            var n2Layout = edge.node2.getLayout();\n            var edgeLayout = edge.getLayout();\n\n            curve.shape.extent = Math.max(1, edgeLayout.dy);\n\n            var x1 = n1Layout.x + n1Layout.dx;\n            var y1 = n1Layout.y + edgeLayout.sy + edgeLayout.dy / 2;\n            var x2 = n2Layout.x;\n            var y2 = n2Layout.y + edgeLayout.ty + edgeLayout.dy / 2;\n            var cpx1 = x1 * (1 - curvature) + x2 * curvature;\n            var cpy1 = y1;\n            var cpx2 = x1 * curvature + x2 * (1 - curvature);\n            var cpy2 = y2;\n\n            curve.setShape({\n                x1: x1,\n                y1: y1,\n                x2: x2,\n                y2: y2,\n                cpx1: cpx1,\n                cpy1: cpy1,\n                cpx2: cpx2,\n                cpy2: cpy2\n            });\n\n            curve.setStyle(lineStyleModel.getItemStyle());\n            // Special color, use source node color or target node color\n            switch (curve.style.fill) {\n                case 'source':\n                    curve.style.fill = edge.node1.getVisual('color');\n                    break;\n                case 'target':\n                    curve.style.fill = edge.node2.getVisual('color');\n                    break;\n            }\n\n            setHoverStyle(curve, edge.getModel('emphasis.lineStyle').getItemStyle());\n\n            group.add(curve);\n\n            edgeData.setItemGraphicEl(edge.dataIndex, curve);\n        });\n\n        // generate a rect  for each node\n        graph.eachNode(function (node) {\n            var layout = node.getLayout();\n            var itemModel = node.getModel();\n            var labelModel = itemModel.getModel('label');\n            var labelHoverModel = itemModel.getModel('emphasis.label');\n\n            var rect = new Rect({\n                shape: {\n                    x: layout.x,\n                    y: layout.y,\n                    width: node.getLayout().dx,\n                    height: node.getLayout().dy\n                },\n                style: itemModel.getModel('itemStyle').getItemStyle()\n            });\n\n            var hoverStyle = node.getModel('emphasis.itemStyle').getItemStyle();\n\n            setLabelStyle(\n                rect.style, hoverStyle, labelModel, labelHoverModel,\n                {\n                    labelFetcher: seriesModel,\n                    labelDataIndex: node.dataIndex,\n                    defaultText: node.id,\n                    isRectText: true\n                }\n            );\n\n            rect.setStyle('fill', node.getVisual('color'));\n\n            setHoverStyle(rect, hoverStyle);\n\n            group.add(rect);\n\n            nodeData.setItemGraphicEl(node.dataIndex, rect);\n\n            rect.dataType = 'node';\n        });\n\n        if (!this._data && seriesModel.get('animation')) {\n            group.setClipPath(createGridClipShape$2(group.getBoundingRect(), seriesModel, function () {\n                group.removeClipPath();\n            }));\n        }\n\n        this._data = seriesModel.getData();\n    },\n\n    dispose: function () {}\n});\n\n// add animation to the view\nfunction createGridClipShape$2(rect, seriesModel, cb) {\n    var rectEl = new Rect({\n        shape: {\n            x: rect.x - 10,\n            y: rect.y - 10,\n            width: 0,\n            height: rect.height + 20\n        }\n    });\n    initProps(rectEl, {\n        shape: {\n            width: rect.width + 20,\n            height: rect.height + 20\n        }\n    }, seriesModel, cb);\n\n    return rectEl;\n}\n\n/**\n * nest helper used to group by the array.\n * can specified the keys and sort the keys.\n */\nfunction nest() {\n\n    var keysFunction = [];\n    var sortKeysFunction = [];\n\n    /**\n     * map an Array into the mapObject.\n     * @param {Array} array\n     * @param {number} depth\n     */\n    function map$$1(array, depth) {\n        if (depth >= keysFunction.length) {\n            return array;\n        }\n        var i = -1;\n        var n = array.length;\n        var keyFunction = keysFunction[depth++];\n        var mapObject = {};\n        var valuesByKey = {};\n\n        while (++i < n) {\n            var keyValue = keyFunction(array[i]);\n            var values = valuesByKey[keyValue];\n\n            if (values) {\n                values.push(array[i]);\n            }\n            else {\n                valuesByKey[keyValue] = [array[i]];\n            }\n        }\n\n        each$1(valuesByKey, function (value, key) {\n            mapObject[key] = map$$1(value, depth);\n        });\n\n        return mapObject;\n    }\n\n    /**\n     * transform the Map Object to multidimensional Array\n     * @param {Object} map\n     * @param {number} depth\n     */\n    function entriesMap(mapObject, depth) {\n        if (depth >= keysFunction.length) {\n            return mapObject;\n        }\n        var array = [];\n        var sortKeyFunction = sortKeysFunction[depth++];\n\n        each$1(mapObject, function (value, key) {\n            array.push({\n                key: key, values: entriesMap(value, depth)\n            });\n        });\n\n        if (sortKeyFunction) {\n            return array.sort(function (a, b) {\n                return sortKeyFunction(a.key, b.key);\n            });\n        }\n        else {\n            return array;\n        }\n    }\n\n    return {\n        /**\n         * specified the key to groupby the arrays.\n         * users can specified one more keys.\n         * @param {Function} d\n         */\n        key: function (d) {\n            keysFunction.push(d);\n            return this;\n        },\n\n        /**\n         * specified the comparator to sort the keys\n         * @param {Function} order\n         */\n        sortKeys: function (order) {\n            sortKeysFunction[keysFunction.length - 1] = order;\n            return this;\n        },\n\n        /**\n         * the array to be grouped by.\n         * @param {Array} array\n         */\n        entries: function (array) {\n            return entriesMap(map$$1(array, 0), 0);\n        }\n    };\n}\n\n/**\n * @file The layout algorithm of sankey view\n * @author  Deqing Li(annong035@gmail.com)\n */\n\nvar sankeyLayout = function (ecModel, api, payload) {\n\n    ecModel.eachSeriesByType('sankey', function (seriesModel) {\n\n        var nodeWidth = seriesModel.get('nodeWidth');\n        var nodeGap = seriesModel.get('nodeGap');\n\n        var layoutInfo = getViewRect$3(seriesModel, api);\n\n        seriesModel.layoutInfo = layoutInfo;\n\n        var width = layoutInfo.width;\n        var height = layoutInfo.height;\n\n        var graph = seriesModel.getGraph();\n\n        var nodes = graph.nodes;\n        var edges = graph.edges;\n\n        computeNodeValues(nodes);\n\n        var filteredNodes = filter(nodes, function (node) {\n            return node.getLayout().value === 0;\n        });\n\n        var iterations = filteredNodes.length !== 0\n            ? 0 : seriesModel.get('layoutIterations');\n\n        layoutSankey(nodes, edges, nodeWidth, nodeGap, width, height, iterations);\n    });\n};\n\n/**\n * Get the layout position of the whole view\n *\n * @param {module:echarts/model/Series} seriesModel  the model object of sankey series\n * @param {module:echarts/ExtensionAPI} api  provide the API list that the developer can call\n * @return {module:zrender/core/BoundingRect}  size of rect to draw the sankey view\n */\nfunction getViewRect$3(seriesModel, api) {\n    return getLayoutRect(\n        seriesModel.getBoxLayoutParams(), {\n            width: api.getWidth(),\n            height: api.getHeight()\n        }\n    );\n}\n\nfunction layoutSankey(nodes, edges, nodeWidth, nodeGap, width, height, iterations) {\n    computeNodeBreadths(nodes, nodeWidth, width);\n    computeNodeDepths(nodes, edges, height, nodeGap, iterations);\n    computeEdgeDepths(nodes);\n}\n\n/**\n * Compute the value of each node by summing the associated edge's value\n *\n * @param {module:echarts/data/Graph~Node} nodes  node of sankey view\n */\nfunction computeNodeValues(nodes) {\n    each$1(nodes, function (node) {\n        var value1 = sum(node.outEdges, getEdgeValue);\n        var value2 = sum(node.inEdges, getEdgeValue);\n        var value = Math.max(value1, value2);\n        node.setLayout({value: value}, true);\n    });\n}\n\n/**\n * Compute the x-position for each node\n *\n * @param {module:echarts/data/Graph~Node} nodes  node of sankey view\n * @param  {number} nodeWidth  the dx of the node\n * @param  {number} width  the whole width of the area to draw the view\n */\nfunction computeNodeBreadths(nodes, nodeWidth, width) {\n    var remainNodes = nodes;\n    var nextNode = null;\n    var x = 0;\n    var kx = 0;\n\n    while (remainNodes.length) {\n        nextNode = [];\n        for (var i = 0, len = remainNodes.length; i < len; i++) {\n            var node = remainNodes[i];\n            node.setLayout({x: x}, true);\n            node.setLayout({dx: nodeWidth}, true);\n            for (var j = 0, lenj = node.outEdges.length; j < lenj; j++) {\n                nextNode.push(node.outEdges[j].node2);\n            }\n        }\n        remainNodes = nextNode;\n        ++x;\n    }\n\n    moveSinksRight(nodes, x);\n    kx = (width - nodeWidth) / (x - 1);\n\n    scaleNodeBreadths(nodes, kx);\n}\n\n/**\n * All the node without outEgdes are assigned maximum x-position and\n *     be aligned in the last column.\n *\n * @param {module:echarts/data/Graph~Node} nodes  node of sankey view\n * @param {number} x  value (x-1) use to assign to node without outEdges\n *     as x-position\n */\nfunction moveSinksRight(nodes, x) {\n    each$1(nodes, function (node) {\n        if (!node.outEdges.length) {\n            node.setLayout({x: x - 1}, true);\n        }\n    });\n}\n\n/**\n * Scale node x-position to the width\n *\n * @param {module:echarts/data/Graph~Node} nodes  node of sankey view\n * @param {number} kx   multiple used to scale nodes\n */\nfunction scaleNodeBreadths(nodes, kx) {\n    each$1(nodes, function (node) {\n        var nodeX = node.getLayout().x * kx;\n        node.setLayout({x: nodeX}, true);\n    });\n}\n\n/**\n * Using Gauss-Seidel iterations method to compute the node depth(y-position)\n *\n * @param {module:echarts/data/Graph~Node} nodes  node of sankey view\n * @param {module:echarts/data/Graph~Edge} edges  edge of sankey view\n * @param {number} height  the whole height of the area to draw the view\n * @param {number} nodeGap  the vertical distance between two nodes\n *     in the same column.\n * @param {number} iterations  the number of iterations for the algorithm\n */\nfunction computeNodeDepths(nodes, edges, height, nodeGap, iterations) {\n    var nodesByBreadth = nest()\n        .key(function (d) {\n            return d.getLayout().x;\n        })\n        .sortKeys(ascending)\n        .entries(nodes)\n        .map(function (d) {\n            return d.values;\n        });\n\n    initializeNodeDepth(nodes, nodesByBreadth, edges, height, nodeGap);\n    resolveCollisions(nodesByBreadth, nodeGap, height);\n\n    for (var alpha = 1; iterations > 0; iterations--) {\n        // 0.99 is a experience parameter, ensure that each iterations of\n        // changes as small as possible.\n        alpha *= 0.99;\n        relaxRightToLeft(nodesByBreadth, alpha);\n        resolveCollisions(nodesByBreadth, nodeGap, height);\n        relaxLeftToRight(nodesByBreadth, alpha);\n        resolveCollisions(nodesByBreadth, nodeGap, height);\n    }\n}\n\n/**\n * Compute the original y-position for each node\n *\n * @param {module:echarts/data/Graph~Node} nodes  node of sankey view\n * @param {Array.<Array.<module:echarts/data/Graph~Node>>} nodesByBreadth\n *     group by the array of all sankey nodes based on the nodes x-position.\n * @param {module:echarts/data/Graph~Edge} edges  edge of sankey view\n * @param {number} height  the whole height of the area to draw the view\n * @param {number} nodeGap  the vertical distance between two nodes\n */\nfunction initializeNodeDepth(nodes, nodesByBreadth, edges, height, nodeGap) {\n    var kyArray = [];\n    each$1(nodesByBreadth, function (nodes) {\n        var n = nodes.length;\n        var sum = 0;\n        each$1(nodes, function (node) {\n            sum += node.getLayout().value;\n        });\n        var ky = (height - (n - 1) * nodeGap) / sum;\n        kyArray.push(ky);\n    });\n\n    kyArray.sort(function (a, b) {\n        return a - b;\n    });\n    var ky0 = kyArray[0];\n\n    each$1(nodesByBreadth, function (nodes) {\n        each$1(nodes, function (node, i) {\n            node.setLayout({y: i}, true);\n            var nodeDy = node.getLayout().value * ky0;\n            node.setLayout({dy: nodeDy}, true);\n        });\n    });\n\n    each$1(edges, function (edge) {\n        var edgeDy = +edge.getValue() * ky0;\n        edge.setLayout({dy: edgeDy}, true);\n    });\n}\n\n/**\n * Resolve the collision of initialized depth (y-position)\n *\n * @param {Array.<Array.<module:echarts/data/Graph~Node>>} nodesByBreadth\n *     group by the array of all sankey nodes based on the nodes x-position.\n * @param {number} nodeGap  the vertical distance between two nodes\n * @param {number} height  the whole height of the area to draw the view\n */\nfunction resolveCollisions(nodesByBreadth, nodeGap, height) {\n    each$1(nodesByBreadth, function (nodes) {\n        var node;\n        var dy;\n        var y0 = 0;\n        var n = nodes.length;\n        var i;\n\n        nodes.sort(ascendingDepth);\n\n        for (i = 0; i < n; i++) {\n            node = nodes[i];\n            dy = y0 - node.getLayout().y;\n            if (dy > 0) {\n                var nodeY = node.getLayout().y + dy;\n                node.setLayout({y: nodeY}, true);\n            }\n            y0 = node.getLayout().y + node.getLayout().dy + nodeGap;\n        }\n\n        // if the bottommost node goes outside the bounds, push it back up\n        dy = y0 - nodeGap - height;\n        if (dy > 0) {\n            var nodeY = node.getLayout().y - dy;\n            node.setLayout({y: nodeY}, true);\n            y0 = node.getLayout().y;\n            for (i = n - 2; i >= 0; --i) {\n                node = nodes[i];\n                dy = node.getLayout().y + node.getLayout().dy + nodeGap - y0;\n                if (dy > 0) {\n                    nodeY = node.getLayout().y - dy;\n                    node.setLayout({y: nodeY}, true);\n                }\n                y0 = node.getLayout().y;\n            }\n        }\n    });\n}\n\n/**\n * Change the y-position of the nodes, except most the right side nodes\n *\n * @param {Array.<Array.<module:echarts/data/Graph~Node>>} nodesByBreadth\n *     group by the array of all sankey nodes based on the node x-position.\n * @param {number} alpha  parameter used to adjust the nodes y-position\n */\nfunction relaxRightToLeft(nodesByBreadth, alpha) {\n    each$1(nodesByBreadth.slice().reverse(), function (nodes) {\n        each$1(nodes, function (node) {\n            if (node.outEdges.length) {\n                var y = sum(node.outEdges, weightedTarget) / sum(node.outEdges, getEdgeValue);\n                var nodeY = node.getLayout().y + (y - center$1(node)) * alpha;\n                node.setLayout({y: nodeY}, true);\n            }\n        });\n    });\n}\n\nfunction weightedTarget(edge) {\n    return center$1(edge.node2) * edge.getValue();\n}\n\n/**\n * Change the y-position of the nodes, except most the left side nodes\n *\n * @param {Array.<Array.<module:echarts/data/Graph~Node>>} nodesByBreadth\n *     group by the array of all sankey nodes based on the node x-position.\n * @param {number} alpha  parameter used to adjust the nodes y-position\n */\nfunction relaxLeftToRight(nodesByBreadth, alpha) {\n    each$1(nodesByBreadth, function (nodes) {\n        each$1(nodes, function (node) {\n            if (node.inEdges.length) {\n                var y = sum(node.inEdges, weightedSource) / sum(node.inEdges, getEdgeValue);\n                var nodeY = node.getLayout().y + (y - center$1(node)) * alpha;\n                node.setLayout({y: nodeY}, true);\n            }\n        });\n    });\n}\n\nfunction weightedSource(edge) {\n    return center$1(edge.node1) * edge.getValue();\n}\n\n/**\n * Compute the depth(y-position) of each edge\n *\n * @param {module:echarts/data/Graph~Node} nodes  node of sankey view\n */\nfunction computeEdgeDepths(nodes) {\n    each$1(nodes, function (node) {\n        node.outEdges.sort(ascendingTargetDepth);\n        node.inEdges.sort(ascendingSourceDepth);\n    });\n    each$1(nodes, function (node) {\n        var sy = 0;\n        var ty = 0;\n        each$1(node.outEdges, function (edge) {\n            edge.setLayout({sy: sy}, true);\n            sy += edge.getLayout().dy;\n        });\n        each$1(node.inEdges, function (edge) {\n            edge.setLayout({ty: ty}, true);\n            ty += edge.getLayout().dy;\n        });\n    });\n}\n\nfunction ascendingTargetDepth(a, b) {\n    return a.node2.getLayout().y - b.node2.getLayout().y;\n}\n\nfunction ascendingSourceDepth(a, b) {\n    return a.node1.getLayout().y - b.node1.getLayout().y;\n}\n\nfunction sum(array, f) {\n    var sum = 0;\n    var len = array.length;\n    var i = -1;\n    while (++i < len) {\n        var value = +f.call(array, array[i], i);\n        if (!isNaN(value)) {\n            sum += value;\n        }\n    }\n    return sum;\n}\n\nfunction center$1(node) {\n    return node.getLayout().y + node.getLayout().dy / 2;\n}\n\nfunction ascendingDepth(a, b) {\n    return a.getLayout().y - b.getLayout().y;\n}\n\nfunction ascending(a, b) {\n    return a < b ? -1 : a > b ? 1 : a === b ? 0 : NaN;\n}\n\nfunction getEdgeValue(edge) {\n    return edge.getValue();\n}\n\n/**\n * @file Visual encoding for sankey view\n * @author  Deqing Li(annong035@gmail.com)\n */\n\nvar sankeyVisual = function (ecModel, payload) {\n    ecModel.eachSeriesByType('sankey', function (seriesModel) {\n        var graph = seriesModel.getGraph();\n        var nodes = graph.nodes;\n\n        nodes.sort(function (a, b) {\n            return a.getLayout().value - b.getLayout().value;\n        });\n\n        var minValue = nodes[0].getLayout().value;\n        var maxValue = nodes[nodes.length - 1].getLayout().value;\n\n        each$1(nodes, function (node) {\n            var mapping = new VisualMapping({\n                type: 'color',\n                mappingMethod: 'linear',\n                dataExtent: [minValue, maxValue],\n                visual: seriesModel.get('color')\n            });\n\n            var mapValueToColor = mapping.mapValueToVisual(node.getLayout().value);\n            node.setVisual('color', mapValueToColor);\n            // If set itemStyle.normal.color\n            var itemModel = node.getModel();\n            var customColor = itemModel.get('itemStyle.color');\n            if (customColor != null) {\n                node.setVisual('color', customColor);\n            }\n        });\n\n    });\n};\n\nregisterLayout(sankeyLayout);\nregisterVisual(sankeyVisual);\n\n/**\n * @module echarts/chart/helper/Symbol\n */\n\nvar WhiskerPath = Path.extend({\n\n    type: 'whiskerInBox',\n\n    shape: {},\n\n    buildPath: function (ctx, shape) {\n        for (var i in shape) {\n            if (shape.hasOwnProperty(i) && i.indexOf('ends') === 0) {\n                var pts = shape[i];\n                ctx.moveTo(pts[0][0], pts[0][1]);\n                ctx.lineTo(pts[1][0], pts[1][1]);\n            }\n        }\n    }\n});\n\n/**\n * @constructor\n * @alias {module:echarts/chart/helper/WhiskerBox}\n * @param {module:echarts/data/List} data\n * @param {number} idx\n * @param {Function} styleUpdater\n * @param {boolean} isInit\n * @extends {module:zrender/graphic/Group}\n */\nfunction WhiskerBox(data, idx, styleUpdater, isInit) {\n    Group.call(this);\n\n    /**\n     * @type {number}\n     * @readOnly\n     */\n    this.bodyIndex;\n\n    /**\n     * @type {number}\n     * @readOnly\n     */\n    this.whiskerIndex;\n\n    /**\n     * @type {Function}\n     */\n    this.styleUpdater = styleUpdater;\n\n    this._createContent(data, idx, isInit);\n\n    this.updateData(data, idx, isInit);\n\n    /**\n     * Last series model.\n     * @type {module:echarts/model/Series}\n     */\n    this._seriesModel;\n}\n\nvar whiskerBoxProto = WhiskerBox.prototype;\n\nwhiskerBoxProto._createContent = function (data, idx, isInit) {\n    var itemLayout = data.getItemLayout(idx);\n    var constDim = itemLayout.chartLayout === 'horizontal' ? 1 : 0;\n    var count = 0;\n\n    // Whisker element.\n    this.add(new Polygon({\n        shape: {\n            points: isInit\n                ? transInit(itemLayout.bodyEnds, constDim, itemLayout)\n                : itemLayout.bodyEnds\n        },\n        style: {strokeNoScale: true},\n        z2: 100\n    }));\n    this.bodyIndex = count++;\n\n    // Box element.\n    var whiskerEnds = map(itemLayout.whiskerEnds, function (ends) {\n        return isInit ? transInit(ends, constDim, itemLayout) : ends;\n    });\n    this.add(new WhiskerPath({\n        shape: makeWhiskerEndsShape(whiskerEnds),\n        style: {strokeNoScale: true},\n        z2: 100\n    }));\n    this.whiskerIndex = count++;\n};\n\nfunction transInit(points, dim, itemLayout) {\n    return map(points, function (point) {\n        point = point.slice();\n        point[dim] = itemLayout.initBaseline;\n        return point;\n    });\n}\n\nfunction makeWhiskerEndsShape(whiskerEnds) {\n    // zr animation only support 2-dim array.\n    var shape = {};\n    each$1(whiskerEnds, function (ends, i) {\n        shape['ends' + i] = ends;\n    });\n    return shape;\n}\n\n/**\n * Update symbol properties\n * @param  {module:echarts/data/List} data\n * @param  {number} idx\n */\nwhiskerBoxProto.updateData = function (data, idx, isInit) {\n    var seriesModel = this._seriesModel = data.hostModel;\n    var itemLayout = data.getItemLayout(idx);\n    var updateMethod = graphic[isInit ? 'initProps' : 'updateProps'];\n    // this.childAt(this.bodyIndex).stopAnimation(true);\n    // this.childAt(this.whiskerIndex).stopAnimation(true);\n    updateMethod(\n        this.childAt(this.bodyIndex),\n        {shape: {points: itemLayout.bodyEnds}},\n        seriesModel, idx\n    );\n    updateMethod(\n        this.childAt(this.whiskerIndex),\n        {shape: makeWhiskerEndsShape(itemLayout.whiskerEnds)},\n        seriesModel, idx\n    );\n\n    this.styleUpdater.call(null, this, data, idx);\n};\n\ninherits(WhiskerBox, Group);\n\n\n/**\n * @constructor\n * @alias module:echarts/chart/helper/WhiskerBoxDraw\n */\nfunction WhiskerBoxDraw(styleUpdater) {\n    this.group = new Group();\n    this.styleUpdater = styleUpdater;\n}\n\nvar whiskerBoxDrawProto = WhiskerBoxDraw.prototype;\n\n/**\n * Update symbols draw by new data\n * @param {module:echarts/data/List} data\n */\nwhiskerBoxDrawProto.updateData = function (data) {\n    var group = this.group;\n    var oldData = this._data;\n    var styleUpdater = this.styleUpdater;\n\n    // There is no old data only when first rendering or switching from\n    // stream mode to normal mode, where previous elements should be removed.\n    if (!this._data) {\n        group.removeAll();\n    }\n\n    data.diff(oldData)\n        .add(function (newIdx) {\n            if (data.hasValue(newIdx)) {\n                var symbolEl = new WhiskerBox(data, newIdx, styleUpdater, true);\n                data.setItemGraphicEl(newIdx, symbolEl);\n                group.add(symbolEl);\n            }\n        })\n        .update(function (newIdx, oldIdx) {\n            var symbolEl = oldData.getItemGraphicEl(oldIdx);\n\n            // Empty data\n            if (!data.hasValue(newIdx)) {\n                group.remove(symbolEl);\n                return;\n            }\n\n            if (!symbolEl) {\n                symbolEl = new WhiskerBox(data, newIdx, styleUpdater);\n            }\n            else {\n                symbolEl.updateData(data, newIdx);\n            }\n\n            // Add back\n            group.add(symbolEl);\n\n            data.setItemGraphicEl(newIdx, symbolEl);\n        })\n        .remove(function (oldIdx) {\n            var el = oldData.getItemGraphicEl(oldIdx);\n            el && group.remove(el);\n        })\n        .execute();\n\n    this._data = data;\n};\n\nwhiskerBoxDrawProto.incrementalPrepareUpdate = function (seriesModel, ecModel, api) {\n    this.group.removeAll();\n    this._data = null;\n};\n\nwhiskerBoxDrawProto.incrementalUpdate = function (params, seriesModel, ecModel, api) {\n    var data = seriesModel.getData();\n    for (var idx = params.start; idx < params.end; idx++) {\n        var symbolEl = new WhiskerBox(data, idx, this.styleUpdater, true);\n        symbolEl.incremental = true;\n        this.group.add(symbolEl);\n    }\n};\n\n/**\n * Remove symbols.\n * @param {module:echarts/data/List} data\n */\nwhiskerBoxDrawProto.remove = function () {\n    var group = this.group;\n    var data = this._data;\n    this._data = null;\n    data && data.eachItemGraphicEl(function (el) {\n        el && group.remove(el);\n    });\n};\n\nvar seriesModelMixin = {\n\n    /**\n     * @private\n     * @type {string}\n     */\n    _baseAxisDim: null,\n\n    /**\n     * @override\n     */\n    getInitialData: function (option, ecModel) {\n        // When both types of xAxis and yAxis are 'value', layout is\n        // needed to be specified by user. Otherwise, layout can be\n        // judged by which axis is category.\n\n        var ordinalMeta;\n\n        var xAxisModel = ecModel.getComponent('xAxis', this.get('xAxisIndex'));\n        var yAxisModel = ecModel.getComponent('yAxis', this.get('yAxisIndex'));\n        var xAxisType = xAxisModel.get('type');\n        var yAxisType = yAxisModel.get('type');\n        var addOrdinal;\n\n        // FIXME\n        // \n\n        if (xAxisType === 'category') {\n            option.layout = 'horizontal';\n            ordinalMeta = xAxisModel.getOrdinalMeta();\n            addOrdinal = true;\n        }\n        else if (yAxisType  === 'category') {\n            option.layout = 'vertical';\n            ordinalMeta = yAxisModel.getOrdinalMeta();\n            addOrdinal = true;\n        }\n        else {\n            option.layout = option.layout || 'horizontal';\n        }\n\n        var coordDims = ['x', 'y'];\n        var baseAxisDimIndex = option.layout === 'horizontal' ? 0 : 1;\n        var baseAxisDim = this._baseAxisDim = coordDims[baseAxisDimIndex];\n        var otherAxisDim = coordDims[1 - baseAxisDimIndex];\n        var axisModels = [xAxisModel, yAxisModel];\n        var baseAxisType = axisModels[baseAxisDimIndex].get('type');\n        var otherAxisType = axisModels[1 - baseAxisDimIndex].get('type');\n        var data = option.data;\n\n        // ??? FIXME make a stage to perform data transfrom.\n        // MUST create a new data, consider setOption({}) again.\n        if (data && addOrdinal) {\n            var newOptionData = [];\n            each$1(data, function (item, index) {\n                var newItem;\n                if (item.value && isArray(item.value)) {\n                    newItem = item.value.slice();\n                    item.value.unshift(index);\n                }\n                else if (isArray(item)) {\n                    newItem = item.slice();\n                    item.unshift(index);\n                }\n                else {\n                    newItem = item;\n                }\n                newOptionData.push(newItem);\n            });\n            option.data = newOptionData;\n        }\n\n        var defaultValueDimensions = this.defaultValueDimensions;\n\n        return createListSimply(\n            this,\n            {\n                coordDimensions: [{\n                    name: baseAxisDim,\n                    type: getDimensionTypeByAxis(baseAxisType),\n                    ordinalMeta: ordinalMeta,\n                    otherDims: {\n                        tooltip: false,\n                        itemName: 0\n                    },\n                    dimsDef: ['base']\n                }, {\n                    name: otherAxisDim,\n                    type: getDimensionTypeByAxis(otherAxisType),\n                    dimsDef: defaultValueDimensions.slice()\n                }],\n                dimensionsCount: defaultValueDimensions.length + 1\n            }\n        );\n    },\n\n    /**\n     * If horizontal, base axis is x, otherwise y.\n     * @override\n     */\n    getBaseAxis: function () {\n        var dim = this._baseAxisDim;\n        return this.ecModel.getComponent(dim + 'Axis', this.get(dim + 'AxisIndex')).axis;\n    }\n\n};\n\nvar viewMixin = {\n\n    init: function () {\n        /**\n         * Old data.\n         * @private\n         * @type {module:echarts/chart/helper/WhiskerBoxDraw}\n         */\n        var whiskerBoxDraw = this._whiskerBoxDraw = new WhiskerBoxDraw(\n            this.getStyleUpdater()\n        );\n        this.group.add(whiskerBoxDraw.group);\n    },\n\n    render: function (seriesModel, ecModel, api) {\n        this._whiskerBoxDraw.updateData(seriesModel.getData());\n    },\n\n    incrementalPrepareRender: function (seriesModel, ecModel, api) {\n        this._whiskerBoxDraw.incrementalPrepareUpdate(seriesModel, ecModel, api);\n    },\n\n    incrementalRender: function (params, seriesModel, ecModel, api) {\n        this._whiskerBoxDraw.incrementalUpdate(params, seriesModel, ecModel, api);\n    },\n\n    remove: function (ecModel) {\n        this._whiskerBoxDraw.remove();\n    }\n};\n\nvar BoxplotSeries = SeriesModel.extend({\n\n    type: 'series.boxplot',\n\n    dependencies: ['xAxis', 'yAxis', 'grid'],\n\n    // TODO\n    // box width represents group size, so dimension should have 'size'.\n\n    /**\n     * @see <https://en.wikipedia.org/wiki/Box_plot>\n     * The meanings of 'min' and 'max' depend on user,\n     * and echarts do not need to know it.\n     * @readOnly\n     */\n    defaultValueDimensions: ['min', 'Q1', 'median', 'Q3', 'max'],\n\n    /**\n     * @type {Array.<string>}\n     * @readOnly\n     */\n    dimensions: null,\n\n    /**\n     * @override\n     */\n    defaultOption: {\n        zlevel: 0,                  // \n        z: 2,                       // \n        coordinateSystem: 'cartesian2d',\n        legendHoverLink: true,\n\n        hoverAnimation: true,\n\n        // xAxisIndex: 0,\n        // yAxisIndex: 0,\n\n        layout: null,               // 'horizontal' or 'vertical'\n        boxWidth: [7, 50],       // [min, max] can be percent of band width.\n\n        itemStyle: {\n            color: '#fff',\n            borderWidth: 1\n        },\n\n        emphasis: {\n            itemStyle: {\n                borderWidth: 2,\n                shadowBlur: 5,\n                shadowOffsetX: 2,\n                shadowOffsetY: 2,\n                shadowColor: 'rgba(0,0,0,0.4)'\n            }\n        },\n\n        animationEasing: 'elasticOut',\n        animationDuration: 800\n    }\n});\n\nmixin(BoxplotSeries, seriesModelMixin, true);\n\nvar BoxplotView = Chart.extend({\n\n    type: 'boxplot',\n\n    getStyleUpdater: function () {\n        return updateStyle$1;\n    },\n\n    dispose: noop\n});\n\nmixin(BoxplotView, viewMixin, true);\n\n// Update common properties\nvar normalStyleAccessPath$1 = ['itemStyle'];\nvar emphasisStyleAccessPath$1 = ['emphasis', 'itemStyle'];\n\nfunction updateStyle$1(itemGroup, data, idx) {\n    var itemModel = data.getItemModel(idx);\n    var normalItemStyleModel = itemModel.getModel(normalStyleAccessPath$1);\n    var borderColor = data.getItemVisual(idx, 'color');\n\n    // Exclude borderColor.\n    var itemStyle = normalItemStyleModel.getItemStyle(['borderColor']);\n\n    var whiskerEl = itemGroup.childAt(itemGroup.whiskerIndex);\n    whiskerEl.style.set(itemStyle);\n    whiskerEl.style.stroke = borderColor;\n    whiskerEl.dirty();\n\n    var bodyEl = itemGroup.childAt(itemGroup.bodyIndex);\n    bodyEl.style.set(itemStyle);\n    bodyEl.style.stroke = borderColor;\n    bodyEl.dirty();\n\n    var hoverStyle = itemModel.getModel(emphasisStyleAccessPath$1).getItemStyle();\n    setHoverStyle(itemGroup, hoverStyle);\n}\n\nvar borderColorQuery = ['itemStyle', 'borderColor'];\n\nvar boxplotVisual = function (ecModel, api) {\n\n    var globalColors = ecModel.get('color');\n\n    ecModel.eachRawSeriesByType('boxplot', function (seriesModel) {\n\n        var defaulColor = globalColors[seriesModel.seriesIndex % globalColors.length];\n        var data = seriesModel.getData();\n\n        data.setVisual({\n            legendSymbol: 'roundRect',\n            // Use name 'color' but not 'borderColor' for legend usage and\n            // visual coding from other component like dataRange.\n            color: seriesModel.get(borderColorQuery) || defaulColor\n        });\n\n        // Only visible series has each data be visual encoded\n        if (!ecModel.isSeriesFiltered(seriesModel)) {\n            data.each(function (idx) {\n                var itemModel = data.getItemModel(idx);\n                data.setItemVisual(\n                    idx,\n                    {color: itemModel.get(borderColorQuery, true)}\n                );\n            });\n        }\n    });\n\n};\n\nvar each$14 = each$1;\n\nvar boxplotLayout = function (ecModel) {\n\n    var groupResult = groupSeriesByAxis(ecModel);\n\n    each$14(groupResult, function (groupItem) {\n        var seriesModels = groupItem.seriesModels;\n\n        if (!seriesModels.length) {\n            return;\n        }\n\n        calculateBase(groupItem);\n\n        each$14(seriesModels, function (seriesModel, idx) {\n            layoutSingleSeries(\n                seriesModel,\n                groupItem.boxOffsetList[idx],\n                groupItem.boxWidthList[idx]\n            );\n        });\n    });\n};\n\n/**\n * Group series by axis.\n */\nfunction groupSeriesByAxis(ecModel) {\n    var result = [];\n    var axisList = [];\n\n    ecModel.eachSeriesByType('boxplot', function (seriesModel) {\n        var baseAxis = seriesModel.getBaseAxis();\n        var idx = indexOf(axisList, baseAxis);\n\n        if (idx < 0) {\n            idx = axisList.length;\n            axisList[idx] = baseAxis;\n            result[idx] = {axis: baseAxis, seriesModels: []};\n        }\n\n        result[idx].seriesModels.push(seriesModel);\n    });\n\n    return result;\n}\n\n/**\n * Calculate offset and box width for each series.\n */\nfunction calculateBase(groupItem) {\n    var extent;\n    var baseAxis = groupItem.axis;\n    var seriesModels = groupItem.seriesModels;\n    var seriesCount = seriesModels.length;\n\n    var boxWidthList = groupItem.boxWidthList = [];\n    var boxOffsetList = groupItem.boxOffsetList = [];\n    var boundList = [];\n\n    var bandWidth;\n    if (baseAxis.type === 'category') {\n        bandWidth = baseAxis.getBandWidth();\n    }\n    else {\n        var maxDataCount = 0;\n        each$14(seriesModels, function (seriesModel) {\n            maxDataCount = Math.max(maxDataCount, seriesModel.getData().count());\n        });\n        extent = baseAxis.getExtent(),\n        Math.abs(extent[1] - extent[0]) / maxDataCount;\n    }\n\n    each$14(seriesModels, function (seriesModel) {\n        var boxWidthBound = seriesModel.get('boxWidth');\n        if (!isArray(boxWidthBound)) {\n            boxWidthBound = [boxWidthBound, boxWidthBound];\n        }\n        boundList.push([\n            parsePercent$1(boxWidthBound[0], bandWidth) || 0,\n            parsePercent$1(boxWidthBound[1], bandWidth) || 0\n        ]);\n    });\n\n    var availableWidth = bandWidth * 0.8 - 2;\n    var boxGap = availableWidth / seriesCount * 0.3;\n    var boxWidth = (availableWidth - boxGap * (seriesCount - 1)) / seriesCount;\n    var base = boxWidth / 2 - availableWidth / 2;\n\n    each$14(seriesModels, function (seriesModel, idx) {\n        boxOffsetList.push(base);\n        base += boxGap + boxWidth;\n\n        boxWidthList.push(\n            Math.min(Math.max(boxWidth, boundList[idx][0]), boundList[idx][1])\n        );\n    });\n}\n\n/**\n * Calculate points location for each series.\n */\nfunction layoutSingleSeries(seriesModel, offset, boxWidth) {\n    var coordSys = seriesModel.coordinateSystem;\n    var data = seriesModel.getData();\n    var halfWidth = boxWidth / 2;\n    var chartLayout = seriesModel.get('layout');\n    var variableDim = chartLayout === 'horizontal' ? 0 : 1;\n    var constDim = 1 - variableDim;\n    var coordDims = ['x', 'y'];\n    var vDims = [];\n    var cDim;\n\n    each$1(data.dimensions, function (dimName) {\n        var dimInfo = data.getDimensionInfo(dimName);\n        var coordDim = dimInfo.coordDim;\n        if (coordDim === coordDims[constDim]) {\n            vDims.push(dimName);\n        }\n        else if (coordDim === coordDims[variableDim]) {\n            cDim = dimName;\n        }\n    });\n\n    if (cDim == null || vDims.length < 5) {\n        return;\n    }\n\n    data.each([cDim].concat(vDims), function () {\n        var args = arguments;\n        var axisDimVal = args[0];\n        var idx = args[vDims.length + 1];\n\n        var median = getPoint(args[3]);\n        var end1 = getPoint(args[1]);\n        var end5 = getPoint(args[5]);\n        var whiskerEnds = [\n            [end1, getPoint(args[2])],\n            [end5, getPoint(args[4])]\n        ];\n        layEndLine(end1);\n        layEndLine(end5);\n        layEndLine(median);\n\n        var bodyEnds = [];\n        addBodyEnd(whiskerEnds[0][1], 0);\n        addBodyEnd(whiskerEnds[1][1], 1);\n\n        data.setItemLayout(idx, {\n            chartLayout: chartLayout,\n            initBaseline: median[constDim],\n            median: median,\n            bodyEnds: bodyEnds,\n            whiskerEnds: whiskerEnds\n        });\n\n        function getPoint(val) {\n            var p = [];\n            p[variableDim] = axisDimVal;\n            p[constDim] = val;\n            var point;\n            if (isNaN(axisDimVal) || isNaN(val)) {\n                point = [NaN, NaN];\n            }\n            else {\n                point = coordSys.dataToPoint(p);\n                point[variableDim] += offset;\n            }\n            return point;\n        }\n\n        function addBodyEnd(point, start) {\n            var point1 = point.slice();\n            var point2 = point.slice();\n            point1[variableDim] += halfWidth;\n            point2[variableDim] -= halfWidth;\n            start\n                ? bodyEnds.push(point1, point2)\n                : bodyEnds.push(point2, point1);\n        }\n\n        function layEndLine(endCenter) {\n            var line = [endCenter.slice(), endCenter.slice()];\n            line[0][variableDim] -= halfWidth;\n            line[1][variableDim] += halfWidth;\n            whiskerEnds.push(line);\n        }\n    });\n}\n\nregisterVisual(boxplotVisual);\nregisterLayout(boxplotLayout);\n\nvar CandlestickSeries = SeriesModel.extend({\n\n    type: 'series.candlestick',\n\n    dependencies: ['xAxis', 'yAxis', 'grid'],\n\n    /**\n     * @readOnly\n     */\n    defaultValueDimensions: ['open', 'close', 'lowest', 'highest'],\n\n    /**\n     * @type {Array.<string>}\n     * @readOnly\n     */\n    dimensions: null,\n\n    /**\n     * @override\n     */\n    defaultOption: {\n        zlevel: 0,                  // \n        z: 2,                       // \n        coordinateSystem: 'cartesian2d',\n        legendHoverLink: true,\n\n        hoverAnimation: true,\n\n        // xAxisIndex: 0,\n        // yAxisIndex: 0,\n\n        layout: null, // 'horizontal' or 'vertical'\n\n        itemStyle: {\n            color: '#c23531', //  positive\n            color0: '#314656', //  negative     '#c23531', '#314656'\n            borderWidth: 1,\n            // FIXME\n            // ec2lineStyle.color  lineStyle.color0\n            borderColor: '#c23531',\n            borderColor0: '#314656'\n        },\n\n        emphasis: {\n            itemStyle: {\n                borderWidth: 2\n            }\n        },\n\n        barMaxWidth: null,\n        barMinWidth: null,\n        barWidth: null,\n\n        animationUpdate: false,\n        animationEasing: 'linear',\n        animationDuration: 300\n    },\n\n    /**\n     * Get dimension for shadow in dataZoom\n     * @return {string} dimension name\n     */\n    getShadowDim: function () {\n        return 'open';\n    },\n\n    brushSelector: function (dataIndex, data, selectors) {\n        var itemLayout = data.getItemLayout(dataIndex);\n        return selectors.rect(itemLayout.brushRect);\n    }\n\n});\n\nmixin(CandlestickSeries, seriesModelMixin, true);\n\nvar CandlestickView = Chart.extend({\n\n    type: 'candlestick',\n\n    getStyleUpdater: function () {\n        return updateStyle$2;\n    },\n\n    dispose: noop\n});\n\nmixin(CandlestickView, viewMixin, true);\n\n// Update common properties\nvar normalStyleAccessPath$2 = ['itemStyle'];\nvar emphasisStyleAccessPath$2 = ['emphasis', 'itemStyle'];\n\nfunction updateStyle$2(itemGroup, data, idx) {\n    var itemModel = data.getItemModel(idx);\n    var normalItemStyleModel = itemModel.getModel(normalStyleAccessPath$2);\n    var color = data.getItemVisual(idx, 'color');\n    var borderColor = data.getItemVisual(idx, 'borderColor') || color;\n\n    // Color must be excluded.\n    // Because symbol provide setColor individually to set fill and stroke\n    var itemStyle = normalItemStyleModel.getItemStyle(\n        ['color', 'color0', 'borderColor', 'borderColor0']\n    );\n\n    var whiskerEl = itemGroup.childAt(itemGroup.whiskerIndex);\n    whiskerEl.useStyle(itemStyle);\n    whiskerEl.style.stroke = borderColor;\n\n    var bodyEl = itemGroup.childAt(itemGroup.bodyIndex);\n    bodyEl.useStyle(itemStyle);\n    bodyEl.style.fill = color;\n    bodyEl.style.stroke = borderColor;\n\n    var hoverStyle = itemModel.getModel(emphasisStyleAccessPath$2).getItemStyle();\n    setHoverStyle(itemGroup, hoverStyle);\n}\n\nvar preprocessor = function (option) {\n    if (!option || !isArray(option.series)) {\n        return;\n    }\n\n    // Translate 'k' to 'candlestick'.\n    each$1(option.series, function (seriesItem) {\n        if (isObject$1(seriesItem) && seriesItem.type === 'k') {\n            seriesItem.type = 'candlestick';\n        }\n    });\n};\n\nvar positiveBorderColorQuery = ['itemStyle', 'borderColor'];\nvar negativeBorderColorQuery = ['itemStyle', 'borderColor0'];\nvar positiveColorQuery = ['itemStyle', 'color'];\nvar negativeColorQuery = ['itemStyle', 'color0'];\n\nvar candlestickVisual = function (ecModel, api) {\n\n    ecModel.eachRawSeriesByType('candlestick', function (seriesModel) {\n\n        var data = seriesModel.getData();\n\n        data.setVisual({\n            legendSymbol: 'roundRect'\n        });\n\n        // Only visible series has each data be visual encoded\n        if (!ecModel.isSeriesFiltered(seriesModel)) {\n            data.each(function (idx) {\n                var itemModel = data.getItemModel(idx);\n                var sign = data.getItemLayout(idx).sign;\n\n                data.setItemVisual(\n                    idx,\n                    {\n                        color: itemModel.get(\n                            sign > 0 ? positiveColorQuery : negativeColorQuery\n                        ),\n                        borderColor: itemModel.get(\n                            sign > 0 ? positiveBorderColorQuery : negativeBorderColorQuery\n                        )\n                    }\n                );\n            });\n        }\n    });\n\n};\n\nvar retrieve2$1 = retrieve2;\n\nvar candlestickLayout = function (ecModel) {\n\n    ecModel.eachSeriesByType('candlestick', function (seriesModel) {\n\n        var coordSys = seriesModel.coordinateSystem;\n        var data = seriesModel.getData();\n        var candleWidth = calculateCandleWidth(seriesModel, data);\n        var chartLayout = seriesModel.get('layout');\n        var variableDim = chartLayout === 'horizontal' ? 0 : 1;\n        var constDim = 1 - variableDim;\n        var coordDims = ['x', 'y'];\n        var vDims = [];\n        var cDim;\n\n        each$1(data.dimensions, function (dimName) {\n            var dimInfo = data.getDimensionInfo(dimName);\n            var coordDim = dimInfo.coordDim;\n            if (coordDim === coordDims[constDim]) {\n                vDims.push(dimName);\n            }\n            else if (coordDim === coordDims[variableDim]) {\n                cDim = dimName;\n            }\n        });\n\n        if (cDim == null || vDims.length < 4) {\n            return;\n        }\n\n        var dataIndex = 0;\n\n        data.each([cDim].concat(vDims), function () {\n            var args = arguments;\n            var axisDimVal = args[0];\n            var idx = args[vDims.length + 1];\n\n            var openVal = args[1];\n            var closeVal = args[2];\n            var lowestVal = args[3];\n            var highestVal = args[4];\n\n            var ocLow = Math.min(openVal, closeVal);\n            var ocHigh = Math.max(openVal, closeVal);\n\n            var ocLowPoint = getPoint(ocLow);\n            var ocHighPoint = getPoint(ocHigh);\n            var lowestPoint = getPoint(lowestVal);\n            var highestPoint = getPoint(highestVal);\n\n            var whiskerEnds = [\n                [\n                    subPixelOptimizePoint(highestPoint),\n                    subPixelOptimizePoint(ocHighPoint)\n                ],\n                [\n                    subPixelOptimizePoint(lowestPoint),\n                    subPixelOptimizePoint(ocLowPoint)\n                ]\n            ];\n\n            var bodyEnds = [];\n            addBodyEnd(ocHighPoint, 0);\n            addBodyEnd(ocLowPoint, 1);\n\n            var sign;\n            if (openVal > closeVal) {\n                sign = -1;\n            }\n            else if (openVal < closeVal) {\n                sign = 1;\n            }\n            else {\n                // If close === open, compare with close of last record\n                if (dataIndex > 0) {\n                    sign = data.getItemModel(dataIndex - 1).get()[2]\n                        <= closeVal\n                            ? 1\n                            : -1;\n                }\n                else {\n                    // No record of previous, set to be positive\n                    sign = 1;\n                }\n            }\n\n            data.setItemLayout(idx, {\n                chartLayout: chartLayout,\n                sign: sign,\n                initBaseline: openVal > closeVal\n                    ? ocHighPoint[constDim] : ocLowPoint[constDim], // open point.\n                bodyEnds: bodyEnds,\n                whiskerEnds: whiskerEnds,\n                brushRect: makeBrushRect()\n            });\n\n            ++dataIndex;\n\n            function getPoint(val) {\n                var p = [];\n                p[variableDim] = axisDimVal;\n                p[constDim] = val;\n                return (isNaN(axisDimVal) || isNaN(val))\n                    ? [NaN, NaN]\n                    : coordSys.dataToPoint(p);\n            }\n\n            function addBodyEnd(point, start) {\n                var point1 = point.slice();\n                var point2 = point.slice();\n\n                point1[variableDim] = subPixelOptimize(\n                    point1[variableDim] + candleWidth / 2, 1, false\n                );\n                point2[variableDim] = subPixelOptimize(\n                    point2[variableDim] - candleWidth / 2, 1, true\n                );\n\n                start\n                    ? bodyEnds.push(point1, point2)\n                    : bodyEnds.push(point2, point1);\n            }\n\n            function makeBrushRect() {\n                var pmin = getPoint(Math.min(openVal, closeVal, lowestVal, highestVal));\n                var pmax = getPoint(Math.max(openVal, closeVal, lowestVal, highestVal));\n\n                pmin[variableDim] -= candleWidth / 2;\n                pmax[variableDim] -= candleWidth / 2;\n\n                return {\n                    x: pmin[0],\n                    y: pmin[1],\n                    width: constDim ? candleWidth : pmax[0] - pmin[0],\n                    height: constDim ? pmax[1] - pmin[1] : candleWidth\n                };\n            }\n\n            function subPixelOptimizePoint(point) {\n                point[variableDim] = subPixelOptimize(point[variableDim], 1);\n                return point;\n            }\n\n        });\n    });\n};\n\nfunction calculateCandleWidth(seriesModel, data) {\n    var baseAxis = seriesModel.getBaseAxis();\n    var extent;\n\n    var bandWidth = baseAxis.type === 'category'\n        ? baseAxis.getBandWidth()\n        : (\n            extent = baseAxis.getExtent(),\n            Math.abs(extent[1] - extent[0]) / data.count()\n        );\n\n    var barMaxWidth = parsePercent$1(\n        retrieve2$1(seriesModel.get('barMaxWidth'), bandWidth),\n        bandWidth\n    );\n    var barMinWidth = parsePercent$1(\n        retrieve2$1(seriesModel.get('barMinWidth'), 1),\n        bandWidth\n    );\n    var barWidth = seriesModel.get('barWidth');\n    return barWidth != null\n        ? parsePercent$1(barWidth, bandWidth)\n        // Put max outer to ensure bar visible in spite of overlap.\n        : Math.max(Math.min(bandWidth / 2, barMaxWidth), barMinWidth);\n}\n\nregisterPreprocessor(preprocessor);\nregisterVisual(candlestickVisual);\nregisterLayout(candlestickLayout);\n\nSeriesModel.extend({\n\n    type: 'series.effectScatter',\n\n    dependencies: ['grid', 'polar'],\n\n    getInitialData: function (option, ecModel) {\n        return createListFromArray(this.getSource(), this);\n    },\n\n    brushSelector: 'point',\n\n    defaultOption: {\n        coordinateSystem: 'cartesian2d',\n        zlevel: 0,\n        z: 2,\n        legendHoverLink: true,\n\n        effectType: 'ripple',\n\n        progressive: 0,\n\n        // When to show the effect, option: 'render'|'emphasis'\n        showEffectOn: 'render',\n\n        // Ripple effect config\n        rippleEffect: {\n            period: 4,\n            // Scale of ripple\n            scale: 2.5,\n            // Brush type can be fill or stroke\n            brushType: 'fill'\n        },\n\n        // Cartesian coordinate system\n        // xAxisIndex: 0,\n        // yAxisIndex: 0,\n\n        // Polar coordinate system\n        // polarIndex: 0,\n\n        // Geo coordinate system\n        // geoIndex: 0,\n\n        // symbol: null,        // \n        symbolSize: 10          // symbolSize * 2\n        // symbolRotate: null,  // \n\n        // large: false,\n        // Available when large is true\n        // largeThreshold: 2000,\n\n        // itemStyle: {\n        //     opacity: 1\n        // }\n    }\n\n});\n\n/**\n * Symbol with ripple effect\n * @module echarts/chart/helper/EffectSymbol\n */\n\nvar EFFECT_RIPPLE_NUMBER = 3;\n\nfunction normalizeSymbolSize$1(symbolSize) {\n    if (!isArray(symbolSize)) {\n        symbolSize = [+symbolSize, +symbolSize];\n    }\n    return symbolSize;\n}\n\nfunction updateRipplePath(rippleGroup, effectCfg) {\n    rippleGroup.eachChild(function (ripplePath) {\n        ripplePath.attr({\n            z: effectCfg.z,\n            zlevel: effectCfg.zlevel,\n            style: {\n                stroke: effectCfg.brushType === 'stroke' ? effectCfg.color : null,\n                fill: effectCfg.brushType === 'fill' ? effectCfg.color : null\n            }\n        });\n    });\n}\n/**\n * @constructor\n * @param {module:echarts/data/List} data\n * @param {number} idx\n * @extends {module:zrender/graphic/Group}\n */\nfunction EffectSymbol(data, idx) {\n    Group.call(this);\n\n    var symbol = new SymbolClz$1(data, idx);\n    var rippleGroup = new Group();\n    this.add(symbol);\n    this.add(rippleGroup);\n\n    rippleGroup.beforeUpdate = function () {\n        this.attr(symbol.getScale());\n    };\n    this.updateData(data, idx);\n}\n\nvar effectSymbolProto = EffectSymbol.prototype;\n\neffectSymbolProto.stopEffectAnimation = function () {\n    this.childAt(1).removeAll();\n};\n\neffectSymbolProto.startEffectAnimation = function (effectCfg) {\n    var symbolType = effectCfg.symbolType;\n    var color = effectCfg.color;\n    var rippleGroup = this.childAt(1);\n\n    for (var i = 0; i < EFFECT_RIPPLE_NUMBER; i++) {\n        // var ripplePath = createSymbol(\n        //     symbolType, -0.5, -0.5, 1, 1, color\n        // );\n        // If width/height are set too small (e.g., set to 1) on ios10\n        // and macOS Sierra, a circle stroke become a rect, no matter what\n        // the scale is set. So we set width/height as 2. See #4136.\n        var ripplePath = createSymbol(\n            symbolType, -1, -1, 2, 2, color\n        );\n        ripplePath.attr({\n            style: {\n                strokeNoScale: true\n            },\n            z2: 99,\n            silent: true,\n            scale: [0.5, 0.5]\n        });\n\n        var delay = -i / EFFECT_RIPPLE_NUMBER * effectCfg.period + effectCfg.effectOffset;\n        // TODO Configurable effectCfg.period\n        ripplePath.animate('', true)\n            .when(effectCfg.period, {\n                scale: [effectCfg.rippleScale / 2, effectCfg.rippleScale / 2]\n            })\n            .delay(delay)\n            .start();\n        ripplePath.animateStyle(true)\n            .when(effectCfg.period, {\n                opacity: 0\n            })\n            .delay(delay)\n            .start();\n\n        rippleGroup.add(ripplePath);\n    }\n\n    updateRipplePath(rippleGroup, effectCfg);\n};\n\n/**\n * Update effect symbol\n */\neffectSymbolProto.updateEffectAnimation = function (effectCfg) {\n    var oldEffectCfg = this._effectCfg;\n    var rippleGroup = this.childAt(1);\n\n    // Must reinitialize effect if following configuration changed\n    var DIFFICULT_PROPS = ['symbolType', 'period', 'rippleScale'];\n    for (var i = 0; i < DIFFICULT_PROPS.length; i++) {\n        var propName = DIFFICULT_PROPS[i];\n        if (oldEffectCfg[propName] !== effectCfg[propName]) {\n            this.stopEffectAnimation();\n            this.startEffectAnimation(effectCfg);\n            return;\n        }\n    }\n\n    updateRipplePath(rippleGroup, effectCfg);\n};\n\n/**\n * Highlight symbol\n */\neffectSymbolProto.highlight = function () {\n    this.trigger('emphasis');\n};\n\n/**\n * Downplay symbol\n */\neffectSymbolProto.downplay = function () {\n    this.trigger('normal');\n};\n\n/**\n * Update symbol properties\n * @param  {module:echarts/data/List} data\n * @param  {number} idx\n */\neffectSymbolProto.updateData = function (data, idx) {\n    var seriesModel = data.hostModel;\n\n    this.childAt(0).updateData(data, idx);\n\n    var rippleGroup = this.childAt(1);\n    var itemModel = data.getItemModel(idx);\n    var symbolType = data.getItemVisual(idx, 'symbol');\n    var symbolSize = normalizeSymbolSize$1(data.getItemVisual(idx, 'symbolSize'));\n    var color = data.getItemVisual(idx, 'color');\n\n    rippleGroup.attr('scale', symbolSize);\n\n    rippleGroup.traverse(function (ripplePath) {\n        ripplePath.attr({\n            fill: color\n        });\n    });\n\n    var symbolOffset = itemModel.getShallow('symbolOffset');\n    if (symbolOffset) {\n        var pos = rippleGroup.position;\n        pos[0] = parsePercent$1(symbolOffset[0], symbolSize[0]);\n        pos[1] = parsePercent$1(symbolOffset[1], symbolSize[1]);\n    }\n    rippleGroup.rotation = (itemModel.getShallow('symbolRotate') || 0) * Math.PI / 180 || 0;\n\n    var effectCfg = {};\n\n    effectCfg.showEffectOn = seriesModel.get('showEffectOn');\n    effectCfg.rippleScale = itemModel.get('rippleEffect.scale');\n    effectCfg.brushType = itemModel.get('rippleEffect.brushType');\n    effectCfg.period = itemModel.get('rippleEffect.period') * 1000;\n    effectCfg.effectOffset = idx / data.count();\n    effectCfg.z = itemModel.getShallow('z') || 0;\n    effectCfg.zlevel = itemModel.getShallow('zlevel') || 0;\n    effectCfg.symbolType = symbolType;\n    effectCfg.color = color;\n\n    this.off('mouseover').off('mouseout').off('emphasis').off('normal');\n\n    if (effectCfg.showEffectOn === 'render') {\n        this._effectCfg\n            ? this.updateEffectAnimation(effectCfg)\n            : this.startEffectAnimation(effectCfg);\n\n        this._effectCfg = effectCfg;\n    }\n    else {\n        // Not keep old effect config\n        this._effectCfg = null;\n\n        this.stopEffectAnimation();\n        var symbol = this.childAt(0);\n        var onEmphasis = function () {\n            symbol.highlight();\n            if (effectCfg.showEffectOn !== 'render') {\n                this.startEffectAnimation(effectCfg);\n            }\n        };\n        var onNormal = function () {\n            symbol.downplay();\n            if (effectCfg.showEffectOn !== 'render') {\n                this.stopEffectAnimation();\n            }\n        };\n        this.on('mouseover', onEmphasis, this)\n            .on('mouseout', onNormal, this)\n            .on('emphasis', onEmphasis, this)\n            .on('normal', onNormal, this);\n    }\n\n    this._effectCfg = effectCfg;\n};\n\neffectSymbolProto.fadeOut = function (cb) {\n    this.off('mouseover').off('mouseout').off('emphasis').off('normal');\n    cb && cb();\n};\n\ninherits(EffectSymbol, Group);\n\nextendChartView({\n\n    type: 'effectScatter',\n\n    init: function () {\n        this._symbolDraw = new SymbolDraw(EffectSymbol);\n    },\n\n    render: function (seriesModel, ecModel, api) {\n        var data = seriesModel.getData();\n        var effectSymbolDraw = this._symbolDraw;\n        effectSymbolDraw.updateData(data);\n        this.group.add(effectSymbolDraw.group);\n    },\n\n    updateTransform: function (seriesModel, ecModel, api) {\n        var data = seriesModel.getData();\n\n        this.group.dirty();\n\n        var res = pointsLayout().reset(seriesModel);\n        if (res.progress) {\n            res.progress({ start: 0, end: data.count() }, data);\n        }\n\n        this._symbolDraw.updateLayout(data);\n    },\n\n    _updateGroupTransform: function (seriesModel) {\n        var coordSys = seriesModel.coordinateSystem;\n        if (coordSys && coordSys.getRoamTransform) {\n            this.group.transform = clone$2(coordSys.getRoamTransform());\n            this.group.decomposeTransform();\n        }\n    },\n\n    remove: function (ecModel, api) {\n        this._symbolDraw && this._symbolDraw.remove(api);\n    },\n\n    dispose: function () {}\n});\n\nregisterVisual(visualSymbol('effectScatter', 'circle'));\nregisterLayout(pointsLayout('effectScatter'));\n\nvar globalObj$1 = typeof window === 'undefined' ? global : window;\n\nvar Uint32Arr = globalObj$1.Uint32Array || Array;\nvar Float64Arr = globalObj$1.Float64Array || Array;\n\nfunction compatEc2(seriesOpt) {\n    var data = seriesOpt.data;\n    if (data && data[0] && data[0][0] && data[0][0].coord) {\n        if (__DEV__) {\n            console.warn('Lines data configuration has been changed to'\n                + ' { coords:[[1,2],[2,3]] }');\n        }\n        seriesOpt.data = map(data, function (itemOpt) {\n            var coords = [\n                itemOpt[0].coord, itemOpt[1].coord\n            ];\n            var target = {\n                coords: coords\n            };\n            if (itemOpt[0].name) {\n                target.fromName = itemOpt[0].name;\n            }\n            if (itemOpt[1].name) {\n                target.toName = itemOpt[1].name;\n            }\n            return mergeAll([target, itemOpt[0], itemOpt[1]]);\n        });\n    }\n}\n\nvar LinesSeries = SeriesModel.extend({\n\n    type: 'series.lines',\n\n    dependencies: ['grid', 'polar'],\n\n    visualColorAccessPath: 'lineStyle.color',\n\n    init: function (option) {\n        // Not using preprocessor because mergeOption may not have series.type\n        compatEc2(option);\n\n        var result = this._processFlatCoordsArray(option.data);\n        this._flatCoords = result.flatCoords;\n        this._flatCoordsOffset = result.flatCoordsOffset;\n        if (result.flatCoords) {\n            option.data = new Float32Array(result.count);\n        }\n\n        LinesSeries.superApply(this, 'init', arguments);\n    },\n\n    mergeOption: function (option) {\n        compatEc2(option);\n\n        if (option.data) {\n            // Only update when have option data to merge.\n            var result = this._processFlatCoordsArray(option.data);\n            this._flatCoords = result.flatCoords;\n            this._flatCoordsOffset = result.flatCoordsOffset;\n            if (result.flatCoords) {\n                option.data = new Float32Array(result.count);\n            }\n        }\n\n        LinesSeries.superApply(this, 'mergeOption', arguments);\n    },\n\n    appendData: function (params) {\n        var result = this._processFlatCoordsArray(params.data);\n        if (result.flatCoords) {\n            if (!this._flatCoords) {\n                this._flatCoords = result.flatCoords;\n                this._flatCoordsOffset = result.flatCoordsOffset;\n            }\n            else {\n                this._flatCoords = concatArray(this._flatCoords, result.flatCoords);\n                this._flatCoordsOffset = concatArray(this._flatCoordsOffset, result.flatCoordsOffset);\n            }\n            params.data = new Float32Array(result.count);\n        }\n\n        this.getRawData().appendData(params.data);\n    },\n\n    _getCoordsFromItemModel: function (idx) {\n        var itemModel = this.getData().getItemModel(idx);\n        var coords = (itemModel.option instanceof Array)\n            ? itemModel.option : itemModel.getShallow('coords');\n\n        if (__DEV__) {\n            if (!(coords instanceof Array && coords.length > 0 && coords[0] instanceof Array)) {\n                throw new Error('Invalid coords ' + JSON.stringify(coords) + '. Lines must have 2d coords array in data item.');\n            }\n        }\n        return coords;\n    },\n\n    getLineCoordsCount: function (idx) {\n        if (this._flatCoordsOffset) {\n            return this._flatCoordsOffset[idx * 2 + 1];\n        }\n        else {\n            return this._getCoordsFromItemModel(idx).length;\n        }\n    },\n\n    getLineCoords: function (idx, out) {\n        if (this._flatCoordsOffset) {\n            var offset = this._flatCoordsOffset[idx * 2];\n            var len = this._flatCoordsOffset[idx * 2 + 1];\n            for (var i = 0; i < len; i++) {\n                out[i] = out[i] || [];\n                out[i][0] = this._flatCoords[offset + i * 2];\n                out[i][1] = this._flatCoords[offset + i * 2 + 1];\n            }\n            return len;\n        }\n        else {\n            var coords = this._getCoordsFromItemModel(idx);\n            for (var i = 0; i < coords.length; i++) {\n                out[i] = out[i] || [];\n                out[i][0] = coords[i][0];\n                out[i][1] = coords[i][1];\n            }\n            return coords.length;\n        }\n    },\n\n    _processFlatCoordsArray: function (data) {\n        var startOffset = 0;\n        if (this._flatCoords) {\n            startOffset = this._flatCoords.length;\n        }\n        // Stored as a typed array. In format\n        // Points Count(2) | x | y | x | y | Points Count(3) | x |  y | x | y | x | y |\n        if (typeof data[0] === 'number') {\n            var len = data.length;\n            // Store offset and len of each segment\n            var coordsOffsetAndLenStorage = new Uint32Arr(len);\n            var coordsStorage = new Float64Arr(len);\n            var coordsCursor = 0;\n            var offsetCursor = 0;\n            var dataCount = 0;\n            for (var i = 0; i < len;) {\n                dataCount++;\n                var count = data[i++];\n                // Offset\n                coordsOffsetAndLenStorage[offsetCursor++] = coordsCursor + startOffset;\n                // Len\n                coordsOffsetAndLenStorage[offsetCursor++] = count;\n                for (var k = 0; k < count; k++) {\n                    var x = data[i++];\n                    var y = data[i++];\n                    coordsStorage[coordsCursor++] = x;\n                    coordsStorage[coordsCursor++] = y;\n\n                    if (i > len) {\n                        if (__DEV__) {\n                            throw new Error('Invalid data format.');\n                        }\n                    }\n                }\n            }\n\n            return {\n                flatCoordsOffset: new Uint32Array(coordsOffsetAndLenStorage.buffer, 0, offsetCursor),\n                flatCoords: coordsStorage,\n                count: dataCount\n            };\n        }\n\n        return {\n            flatCoordsOffset: null,\n            flatCoords: null,\n            count: data.length\n        };\n    },\n\n    getInitialData: function (option, ecModel) {\n        if (__DEV__) {\n            var CoordSys = CoordinateSystemManager.get(option.coordinateSystem);\n            if (!CoordSys) {\n                throw new Error('Unkown coordinate system ' + option.coordinateSystem);\n            }\n        }\n\n        var lineData = new List(['value'], this);\n        lineData.hasItemOption = false;\n\n        lineData.initData(option.data, [], function (dataItem, dimName, dataIndex, dimIndex) {\n            // dataItem is simply coords\n            if (dataItem instanceof Array) {\n                return NaN;\n            }\n            else {\n                lineData.hasItemOption = true;\n                var value = dataItem.value;\n                if (value != null) {\n                    return value instanceof Array ? value[dimIndex] : value;\n                }\n            }\n        });\n\n        return lineData;\n    },\n\n    formatTooltip: function (dataIndex) {\n        var data = this.getData();\n        var itemModel = data.getItemModel(dataIndex);\n        var name = itemModel.get('name');\n        if (name) {\n            return name;\n        }\n        var fromName = itemModel.get('fromName');\n        var toName = itemModel.get('toName');\n        var html = [];\n        fromName != null && html.push(fromName);\n        toName != null && html.push(toName);\n\n        return encodeHTML(html.join(' > '));\n    },\n\n    preventIncremental: function () {\n        return !!this.get('effect.show');\n    },\n\n    getProgressive: function () {\n        var progressive = this.option.progressive;\n        if (progressive == null) {\n            return this.option.large ? 1e4 : this.get('progressive');\n        }\n        return progressive;\n    },\n\n    getProgressiveThreshold: function () {\n        var progressiveThreshold = this.option.progressiveThreshold;\n        if (progressiveThreshold == null) {\n            return this.option.large ? 2e4 : this.get('progressiveThreshold');\n        }\n        return progressiveThreshold;\n    },\n\n    defaultOption: {\n        coordinateSystem: 'geo',\n        zlevel: 0,\n        z: 2,\n        legendHoverLink: true,\n\n        hoverAnimation: true,\n        // Cartesian coordinate system\n        xAxisIndex: 0,\n        yAxisIndex: 0,\n\n        symbol: ['none', 'none'],\n        symbolSize: [10, 10],\n        // Geo coordinate system\n        geoIndex: 0,\n\n        effect: {\n            show: false,\n            period: 4,\n            // Animation delay. support callback\n            // delay: 0,\n            // If move with constant speed px/sec\n            // period will be ignored if this property is > 0,\n            constantSpeed: 0,\n            symbol: 'circle',\n            symbolSize: 3,\n            loop: true,\n            // Length of trail, 0 - 1\n            trailLength: 0.2\n            // Same with lineStyle.color\n            // color\n        },\n\n        large: false,\n        // Available when large is true\n        largeThreshold: 2000,\n\n        // If lines are polyline\n        // polyline not support curveness, label, animation\n        polyline: false,\n\n        label: {\n            show: false,\n            position: 'end'\n            // distance: 5,\n            // formatter: Tooltip.formatter\n        },\n\n        lineStyle: {\n            opacity: 0.5\n        }\n    }\n});\n\n/**\n * Provide effect for line\n * @module echarts/chart/helper/EffectLine\n */\n\n/**\n * @constructor\n * @extends {module:zrender/graphic/Group}\n * @alias {module:echarts/chart/helper/Line}\n */\nfunction EffectLine(lineData, idx, seriesScope) {\n    Group.call(this);\n\n    this.add(this.createLine(lineData, idx, seriesScope));\n\n    this._updateEffectSymbol(lineData, idx);\n}\n\nvar effectLineProto = EffectLine.prototype;\n\neffectLineProto.createLine = function (lineData, idx, seriesScope) {\n    return new Line$1(lineData, idx, seriesScope);\n};\n\neffectLineProto._updateEffectSymbol = function (lineData, idx) {\n    var itemModel = lineData.getItemModel(idx);\n    var effectModel = itemModel.getModel('effect');\n    var size = effectModel.get('symbolSize');\n    var symbolType = effectModel.get('symbol');\n    if (!isArray(size)) {\n        size = [size, size];\n    }\n    var color = effectModel.get('color') || lineData.getItemVisual(idx, 'color');\n    var symbol = this.childAt(1);\n\n    if (this._symbolType !== symbolType) {\n        // Remove previous\n        this.remove(symbol);\n\n        symbol = createSymbol(\n            symbolType, -0.5, -0.5, 1, 1, color\n        );\n        symbol.z2 = 100;\n        symbol.culling = true;\n\n        this.add(symbol);\n    }\n\n    // Symbol may be removed if loop is false\n    if (!symbol) {\n        return;\n    }\n\n    // Shadow color is same with color in default\n    symbol.setStyle('shadowColor', color);\n    symbol.setStyle(effectModel.getItemStyle(['color']));\n\n    symbol.attr('scale', size);\n\n    symbol.setColor(color);\n    symbol.attr('scale', size);\n\n    this._symbolType = symbolType;\n\n    this._updateEffectAnimation(lineData, effectModel, idx);\n};\n\neffectLineProto._updateEffectAnimation = function (lineData, effectModel, idx) {\n\n    var symbol = this.childAt(1);\n    if (!symbol) {\n        return;\n    }\n\n    var self = this;\n\n    var points = lineData.getItemLayout(idx);\n\n    var period = effectModel.get('period') * 1000;\n    var loop = effectModel.get('loop');\n    var constantSpeed = effectModel.get('constantSpeed');\n    var delayExpr = retrieve(effectModel.get('delay'), function (idx) {\n        return idx / lineData.count() * period / 3;\n    });\n    var isDelayFunc = typeof delayExpr === 'function';\n\n    // Ignore when updating\n    symbol.ignore = true;\n\n    this.updateAnimationPoints(symbol, points);\n\n    if (constantSpeed > 0) {\n        period = this.getLineLength(symbol) / constantSpeed * 1000;\n    }\n\n    if (period !== this._period || loop !== this._loop) {\n\n        symbol.stopAnimation();\n\n        var delay = delayExpr;\n        if (isDelayFunc) {\n            delay = delayExpr(idx);\n        }\n        if (symbol.__t > 0) {\n            delay = -period * symbol.__t;\n        }\n        symbol.__t = 0;\n        var animator = symbol.animate('', loop)\n            .when(period, {\n                __t: 1\n            })\n            .delay(delay)\n            .during(function () {\n                self.updateSymbolPosition(symbol);\n            });\n        if (!loop) {\n            animator.done(function () {\n                self.remove(symbol);\n            });\n        }\n        animator.start();\n    }\n\n    this._period = period;\n    this._loop = loop;\n};\n\neffectLineProto.getLineLength = function (symbol) {\n    // Not so accurate\n    return (dist(symbol.__p1, symbol.__cp1)\n        + dist(symbol.__cp1, symbol.__p2));\n};\n\neffectLineProto.updateAnimationPoints = function (symbol, points) {\n    symbol.__p1 = points[0];\n    symbol.__p2 = points[1];\n    symbol.__cp1 = points[2] || [\n        (points[0][0] + points[1][0]) / 2,\n        (points[0][1] + points[1][1]) / 2\n    ];\n};\n\neffectLineProto.updateData = function (lineData, idx, seriesScope) {\n    this.childAt(0).updateData(lineData, idx, seriesScope);\n    this._updateEffectSymbol(lineData, idx);\n};\n\neffectLineProto.updateSymbolPosition = function (symbol) {\n    var p1 = symbol.__p1;\n    var p2 = symbol.__p2;\n    var cp1 = symbol.__cp1;\n    var t = symbol.__t;\n    var pos = symbol.position;\n    var quadraticAt$$1 = quadraticAt;\n    var quadraticDerivativeAt$$1 = quadraticDerivativeAt;\n    pos[0] = quadraticAt$$1(p1[0], cp1[0], p2[0], t);\n    pos[1] = quadraticAt$$1(p1[1], cp1[1], p2[1], t);\n\n    // Tangent\n    var tx = quadraticDerivativeAt$$1(p1[0], cp1[0], p2[0], t);\n    var ty = quadraticDerivativeAt$$1(p1[1], cp1[1], p2[1], t);\n\n    symbol.rotation = -Math.atan2(ty, tx) - Math.PI / 2;\n\n    symbol.ignore = false;\n};\n\n\neffectLineProto.updateLayout = function (lineData, idx) {\n    this.childAt(0).updateLayout(lineData, idx);\n\n    var effectModel = lineData.getItemModel(idx).getModel('effect');\n    this._updateEffectAnimation(lineData, effectModel, idx);\n};\n\ninherits(EffectLine, Group);\n\n/**\n * @module echarts/chart/helper/Line\n */\n\n/**\n * @constructor\n * @extends {module:zrender/graphic/Group}\n * @alias {module:echarts/chart/helper/Polyline}\n */\nfunction Polyline$2(lineData, idx, seriesScope) {\n    Group.call(this);\n\n    this._createPolyline(lineData, idx, seriesScope);\n}\n\nvar polylineProto = Polyline$2.prototype;\n\npolylineProto._createPolyline = function (lineData, idx, seriesScope) {\n    // var seriesModel = lineData.hostModel;\n    var points = lineData.getItemLayout(idx);\n\n    var line = new Polyline({\n        shape: {\n            points: points\n        }\n    });\n\n    this.add(line);\n\n    this._updateCommonStl(lineData, idx, seriesScope);\n};\n\npolylineProto.updateData = function (lineData, idx, seriesScope) {\n    var seriesModel = lineData.hostModel;\n\n    var line = this.childAt(0);\n    var target = {\n        shape: {\n            points: lineData.getItemLayout(idx)\n        }\n    };\n    updateProps(line, target, seriesModel, idx);\n\n    this._updateCommonStl(lineData, idx, seriesScope);\n};\n\npolylineProto._updateCommonStl = function (lineData, idx, seriesScope) {\n    var line = this.childAt(0);\n    var itemModel = lineData.getItemModel(idx);\n\n    var visualColor = lineData.getItemVisual(idx, 'color');\n\n    var lineStyle = seriesScope && seriesScope.lineStyle;\n    var hoverLineStyle = seriesScope && seriesScope.hoverLineStyle;\n\n    if (!seriesScope || lineData.hasItemOption) {\n        lineStyle = itemModel.getModel('lineStyle').getLineStyle();\n        hoverLineStyle = itemModel.getModel('emphasis.lineStyle').getLineStyle();\n    }\n    line.useStyle(defaults(\n        {\n            strokeNoScale: true,\n            fill: 'none',\n            stroke: visualColor\n        },\n        lineStyle\n    ));\n    line.hoverStyle = hoverLineStyle;\n\n    setHoverStyle(this);\n};\n\npolylineProto.updateLayout = function (lineData, idx) {\n    var polyline = this.childAt(0);\n    polyline.setShape('points', lineData.getItemLayout(idx));\n};\n\ninherits(Polyline$2, Group);\n\n/**\n * Provide effect for line\n * @module echarts/chart/helper/EffectLine\n */\n\n/**\n * @constructor\n * @extends {module:echarts/chart/helper/EffectLine}\n * @alias {module:echarts/chart/helper/Polyline}\n */\nfunction EffectPolyline(lineData, idx, seriesScope) {\n    EffectLine.call(this, lineData, idx, seriesScope);\n    this._lastFrame = 0;\n    this._lastFramePercent = 0;\n}\n\nvar effectPolylineProto = EffectPolyline.prototype;\n\n// Overwrite\neffectPolylineProto.createLine = function (lineData, idx, seriesScope) {\n    return new Polyline$2(lineData, idx, seriesScope);\n};\n\n// Overwrite\neffectPolylineProto.updateAnimationPoints = function (symbol, points) {\n    this._points = points;\n    var accLenArr = [0];\n    var len$$1 = 0;\n    for (var i = 1; i < points.length; i++) {\n        var p1 = points[i - 1];\n        var p2 = points[i];\n        len$$1 += dist(p1, p2);\n        accLenArr.push(len$$1);\n    }\n    if (len$$1 === 0) {\n        return;\n    }\n\n    for (var i = 0; i < accLenArr.length; i++) {\n        accLenArr[i] /= len$$1;\n    }\n    this._offsets = accLenArr;\n    this._length = len$$1;\n};\n\n// Overwrite\neffectPolylineProto.getLineLength = function (symbol) {\n    return this._length;\n};\n\n// Overwrite\neffectPolylineProto.updateSymbolPosition = function (symbol) {\n    var t = symbol.__t;\n    var points = this._points;\n    var offsets = this._offsets;\n    var len$$1 = points.length;\n\n    if (!offsets) {\n        // Has length 0\n        return;\n    }\n\n    var lastFrame = this._lastFrame;\n    var frame;\n\n    if (t < this._lastFramePercent) {\n        // Start from the next frame\n        // PENDING start from lastFrame ?\n        var start = Math.min(lastFrame + 1, len$$1 - 1);\n        for (frame = start; frame >= 0; frame--) {\n            if (offsets[frame] <= t) {\n                break;\n            }\n        }\n        // PENDING really need to do this ?\n        frame = Math.min(frame, len$$1 - 2);\n    }\n    else {\n        for (var frame = lastFrame; frame < len$$1; frame++) {\n            if (offsets[frame] > t) {\n                break;\n            }\n        }\n        frame = Math.min(frame - 1, len$$1 - 2);\n    }\n\n    lerp(\n        symbol.position, points[frame], points[frame + 1],\n        (t - offsets[frame]) / (offsets[frame + 1] - offsets[frame])\n    );\n\n    var tx = points[frame + 1][0] - points[frame][0];\n    var ty = points[frame + 1][1] - points[frame][1];\n    symbol.rotation = -Math.atan2(ty, tx) - Math.PI / 2;\n\n    this._lastFrame = frame;\n    this._lastFramePercent = t;\n\n    symbol.ignore = false;\n};\n\ninherits(EffectPolyline, EffectLine);\n\n// TODO Batch by color\n\nvar LargeLineShape = extendShape({\n\n    shape: {\n        polyline: false,\n        curveness: 0,\n        segs: []\n    },\n\n    buildPath: function (path, shape) {\n        var segs = shape.segs;\n        var curveness = shape.curveness;\n\n        if (shape.polyline) {\n            for (var i = 0; i < segs.length;) {\n                var count = segs[i++];\n                if (count > 0) {\n                    path.moveTo(segs[i++], segs[i++]);\n                    for (var k = 1; k < count; k++) {\n                        path.lineTo(segs[i++], segs[i++]);\n                    }\n                }\n            }\n        }\n        else {\n            for (var i = 0; i < segs.length;) {\n                var x0 = segs[i++];\n                var y0 = segs[i++];\n                var x1 = segs[i++];\n                var y1 = segs[i++];\n                path.moveTo(x0, y0);\n                if (curveness > 0) {\n                    var x2 = (x0 + x1) / 2 - (y0 - y1) * curveness;\n                    var y2 = (y0 + y1) / 2 - (x1 - x0) * curveness;\n                    path.quadraticCurveTo(x2, y2, x1, y1);\n                }\n                else {\n                    path.lineTo(x1, y1);\n                }\n            }\n        }\n    },\n\n    findDataIndex: function (x, y) {\n\n        var shape = this.shape;\n        var segs = shape.segs;\n        var curveness = shape.curveness;\n\n        if (shape.polyline) {\n            var dataIndex = 0;\n            for (var i = 0; i < segs.length;) {\n                var count = segs[i++];\n                if (count > 0) {\n                    var x0 = segs[i++];\n                    var y0 = segs[i++];\n                    for (var k = 1; k < count; k++) {\n                        var x1 = segs[i++];\n                        var y1 = segs[i++];\n                        if (containStroke$1(x0, y0, x1, y1)) {\n                            return dataIndex;\n                        }\n                    }\n                }\n\n                dataIndex++;\n            }\n        }\n        else {\n            var dataIndex = 0;\n            for (var i = 0; i < segs.length;) {\n                var x0 = segs[i++];\n                var y0 = segs[i++];\n                var x1 = segs[i++];\n                var y1 = segs[i++];\n                if (curveness > 0) {\n                    var x2 = (x0 + x1) / 2 - (y0 - y1) * curveness;\n                    var y2 = (y0 + y1) / 2 - (x1 - x0) * curveness;\n\n                    if (containStroke$3(x0, y0, x2, y2, x1, y1)) {\n                        return dataIndex;\n                    }\n                }\n                else {\n                    if (containStroke$1(x0, y0, x1, y1)) {\n                        return dataIndex;\n                    }\n                }\n\n                dataIndex++;\n            }\n        }\n\n        return -1;\n    }\n});\n\nfunction LargeLineDraw() {\n    this.group = new Group();\n}\n\nvar largeLineProto = LargeLineDraw.prototype;\n\nlargeLineProto.isPersistent = function () {\n    return !this._incremental;\n};\n\n/**\n * Update symbols draw by new data\n * @param {module:echarts/data/List} data\n */\nlargeLineProto.updateData = function (data) {\n    this.group.removeAll();\n\n    var lineEl = new LargeLineShape({\n        rectHover: true,\n        cursor: 'default'\n    });\n    lineEl.setShape({\n        segs: data.getLayout('linesPoints')\n    });\n\n    this._setCommon(lineEl, data);\n\n    // Add back\n    this.group.add(lineEl);\n\n    this._incremental = null;\n};\n\n/**\n * @override\n */\nlargeLineProto.incrementalPrepareUpdate = function (data) {\n    this.group.removeAll();\n\n    this._clearIncremental();\n\n    if (data.count() > 5e5) {\n        if (!this._incremental) {\n            this._incremental = new IncrementalDisplayble({\n                silent: true\n            });\n        }\n        this.group.add(this._incremental);\n    }\n    else {\n        this._incremental = null;\n    }\n};\n\n/**\n * @override\n */\nlargeLineProto.incrementalUpdate = function (taskParams, data) {\n    var lineEl = new LargeLineShape();\n    lineEl.setShape({\n        segs: data.getLayout('linesPoints')\n    });\n    this._setCommon(lineEl, data, !!this._incremental);\n\n    if (!this._incremental) {\n        lineEl.rectHover = true;\n        lineEl.cursor = 'default';\n        lineEl.__startIndex = taskParams.start;\n        this.group.add(lineEl);\n    }\n    else {\n        this._incremental.addDisplayable(lineEl, true);\n    }\n};\n\n/**\n * @override\n */\nlargeLineProto.remove = function () {\n    this._clearIncremental();\n    this._incremental = null;\n    this.group.removeAll();\n};\n\nlargeLineProto._setCommon = function (lineEl, data, isIncremental) {\n    var hostModel = data.hostModel;\n\n    lineEl.setShape({\n        polyline: hostModel.get('polyline'),\n        curveness: hostModel.get('lineStyle.curveness')\n    });\n\n    lineEl.useStyle(\n        hostModel.getModel('lineStyle').getLineStyle()\n    );\n    lineEl.style.strokeNoScale = true;\n\n    var visualColor = data.getVisual('color');\n    if (visualColor) {\n        lineEl.setStyle('stroke', visualColor);\n    }\n    lineEl.setStyle('fill');\n\n    if (!isIncremental) {\n        // Enable tooltip\n        // PENDING May have performance issue when path is extremely large\n        lineEl.seriesIndex = hostModel.seriesIndex;\n        lineEl.on('mousemove', function (e) {\n            lineEl.dataIndex = null;\n            var dataIndex = lineEl.findDataIndex(e.offsetX, e.offsetY);\n            if (dataIndex > 0) {\n                // Provide dataIndex for tooltip\n                lineEl.dataIndex = dataIndex + lineEl.__startIndex;\n            }\n        });\n    }\n};\n\nlargeLineProto._clearIncremental = function () {\n    var incremental = this._incremental;\n    if (incremental) {\n        incremental.clearDisplaybles();\n    }\n};\n\nvar linesLayout = {\n    seriesType: 'lines',\n\n    plan: createRenderPlanner(),\n\n    reset: function (seriesModel) {\n        var coordSys = seriesModel.coordinateSystem;\n        var isPolyline = seriesModel.get('polyline');\n        var isLarge = seriesModel.pipelineContext.large;\n\n        function progress(params, lineData) {\n            var lineCoords = [];\n            if (isLarge) {\n                var points;\n                var segCount = params.end - params.start;\n                if (isPolyline) {\n                    var totalCoordsCount = 0;\n                    for (var i = params.start; i < params.end; i++) {\n                        totalCoordsCount += seriesModel.getLineCoordsCount(i);\n                    }\n                    points = new Float32Array(segCount + totalCoordsCount * 2);\n                }\n                else {\n                    points = new Float32Array(segCount * 2);\n                }\n\n                var offset = 0;\n                var pt = [];\n                for (var i = params.start; i < params.end; i++) {\n                    var len = seriesModel.getLineCoords(i, lineCoords);\n                    if (isPolyline) {\n                        points[offset++] = len;\n                    }\n                    for (var k = 0; k < len; k++) {\n                        pt = coordSys.dataToPoint(lineCoords[k], false, pt);\n                        points[offset++] = pt[0];\n                        points[offset++] = pt[1];\n                    }\n                }\n\n                lineData.setLayout('linesPoints', points);\n            }\n            else {\n                for (var i = params.start; i < params.end; i++) {\n                    var itemModel = lineData.getItemModel(i);\n                    var len = seriesModel.getLineCoords(i, lineCoords);\n\n                    var pts = [];\n                    if (isPolyline) {\n                        for (var j = 0; j < len; j++) {\n                            pts.push(coordSys.dataToPoint(lineCoords[j]));\n                        }\n                    }\n                    else {\n                        pts[0] = coordSys.dataToPoint(lineCoords[0]);\n                        pts[1] = coordSys.dataToPoint(lineCoords[1]);\n\n                        var curveness = itemModel.get('lineStyle.curveness');\n                        if (+curveness) {\n                            pts[2] = [\n                                (pts[0][0] + pts[1][0]) / 2 - (pts[0][1] - pts[1][1]) * curveness,\n                                (pts[0][1] + pts[1][1]) / 2 - (pts[1][0] - pts[0][0]) * curveness\n                            ];\n                        }\n                    }\n                    lineData.setItemLayout(i, pts);\n                }\n            }\n        }\n\n        return { progress: progress };\n    }\n};\n\nextendChartView({\n\n    type: 'lines',\n\n    init: function () {},\n\n    render: function (seriesModel, ecModel, api) {\n        var data = seriesModel.getData();\n\n        var lineDraw = this._updateLineDraw(data, seriesModel);\n\n        var zlevel = seriesModel.get('zlevel');\n        var trailLength = seriesModel.get('effect.trailLength');\n\n        var zr = api.getZr();\n        // Avoid the drag cause ghost shadow\n        // FIXME Better way ?\n        // SVG doesn't support\n        var isSvg = zr.painter.getType() === 'svg';\n        if (!isSvg) {\n            zr.painter.getLayer(zlevel).clear(true);\n        }\n        // Config layer with motion blur\n        if (this._lastZlevel != null && !isSvg) {\n            zr.configLayer(this._lastZlevel, {\n                motionBlur: false\n            });\n        }\n        if (this._showEffect(seriesModel) && trailLength) {\n            if (__DEV__) {\n                var notInIndividual = false;\n                ecModel.eachSeries(function (otherSeriesModel) {\n                    if (otherSeriesModel !== seriesModel && otherSeriesModel.get('zlevel') === zlevel) {\n                        notInIndividual = true;\n                    }\n                });\n                notInIndividual && console.warn('Lines with trail effect should have an individual zlevel');\n            }\n\n            if (!isSvg) {\n                zr.configLayer(zlevel, {\n                    motionBlur: true,\n                    lastFrameAlpha: Math.max(Math.min(trailLength / 10 + 0.9, 1), 0)\n                });\n            }\n        }\n\n        lineDraw.updateData(data);\n\n        this._lastZlevel = zlevel;\n\n        this._finished = true;\n    },\n\n    incrementalPrepareRender: function (seriesModel, ecModel, api) {\n        var data = seriesModel.getData();\n\n        var lineDraw = this._updateLineDraw(data, seriesModel);\n\n        lineDraw.incrementalPrepareUpdate(data);\n\n        this._clearLayer(api);\n\n        this._finished = false;\n    },\n\n    incrementalRender: function (taskParams, seriesModel, ecModel) {\n        this._lineDraw.incrementalUpdate(taskParams, seriesModel.getData());\n\n        this._finished = taskParams.end === seriesModel.getData().count();\n    },\n\n    updateTransform: function (seriesModel, ecModel, api) {\n        var data = seriesModel.getData();\n\n        if (!this._finished || seriesModel.pipelineContext.large) {\n            // TODO Don't have to do update in large mode. Only do it when there are millions of data.\n            return {\n                update: true\n            };\n        }\n        else {\n            // TODO Use same logic with ScatterView.\n            // Manually update layout\n            var res = linesLayout.reset(seriesModel);\n            if (res.progress) {\n                res.progress({ start: 0, end: data.count() }, data);\n            }\n            this._lineDraw.updateLayout();\n            this._clearLayer(api);\n        }\n    },\n\n    _updateLineDraw: function (data, seriesModel) {\n        var lineDraw = this._lineDraw;\n        var hasEffect = this._showEffect(seriesModel);\n        var isPolyline = !!seriesModel.get('polyline');\n        var pipelineContext = seriesModel.pipelineContext;\n        var isLargeDraw = pipelineContext.large;\n\n        if (__DEV__) {\n            if (hasEffect && isLargeDraw) {\n                console.warn('Large lines not support effect');\n            }\n        }\n        if (!lineDraw\n            || hasEffect !== this._hasEffet\n            || isPolyline !== this._isPolyline\n            || isLargeDraw !== this._isLargeDraw\n        ) {\n            if (lineDraw) {\n                lineDraw.remove();\n            }\n            lineDraw = this._lineDraw = isLargeDraw\n                ? new LargeLineDraw()\n                : new LineDraw(\n                    isPolyline\n                        ? (hasEffect ? EffectPolyline : Polyline$2)\n                        : (hasEffect ? EffectLine : Line$1)\n                );\n            this._hasEffet = hasEffect;\n            this._isPolyline = isPolyline;\n            this._isLargeDraw = isLargeDraw;\n            this.group.removeAll();\n        }\n\n        this.group.add(lineDraw.group);\n\n        return lineDraw;\n    },\n\n    _showEffect: function (seriesModel) {\n        return !!seriesModel.get('effect.show');\n    },\n\n    _clearLayer: function (api) {\n        // Not use motion when dragging or zooming\n        var zr = api.getZr();\n        var isSvg = zr.painter.getType() === 'svg';\n        if (!isSvg && this._lastZlevel != null) {\n            zr.painter.getLayer(this._lastZlevel).clear(true);\n        }\n    },\n\n    remove: function (ecModel, api) {\n        this._lineDraw && this._lineDraw.remove();\n        this._lineDraw = null;\n        // Clear motion when lineDraw is removed\n        this._clearLayer(api);\n    },\n\n    dispose: function () {}\n});\n\nfunction normalize$2(a) {\n    if (!(a instanceof Array)) {\n        a = [a, a];\n    }\n    return a;\n}\n\nvar opacityQuery = 'lineStyle.opacity'.split('.');\n\nvar linesVisual = {\n    seriesType: 'lines',\n    reset: function (seriesModel, ecModel, api) {\n        var symbolType = normalize$2(seriesModel.get('symbol'));\n        var symbolSize = normalize$2(seriesModel.get('symbolSize'));\n        var data = seriesModel.getData();\n\n        data.setVisual('fromSymbol', symbolType && symbolType[0]);\n        data.setVisual('toSymbol', symbolType && symbolType[1]);\n        data.setVisual('fromSymbolSize', symbolSize && symbolSize[0]);\n        data.setVisual('toSymbolSize', symbolSize && symbolSize[1]);\n        data.setVisual('opacity', seriesModel.get(opacityQuery));\n\n        function dataEach(data, idx) {\n            var itemModel = data.getItemModel(idx);\n            var symbolType = normalize$2(itemModel.getShallow('symbol', true));\n            var symbolSize = normalize$2(itemModel.getShallow('symbolSize', true));\n            var opacity = itemModel.get(opacityQuery);\n\n            symbolType[0] && data.setItemVisual(idx, 'fromSymbol', symbolType[0]);\n            symbolType[1] && data.setItemVisual(idx, 'toSymbol', symbolType[1]);\n            symbolSize[0] && data.setItemVisual(idx, 'fromSymbolSize', symbolSize[0]);\n            symbolSize[1] && data.setItemVisual(idx, 'toSymbolSize', symbolSize[1]);\n\n            data.setItemVisual(idx, 'opacity', opacity);\n        }\n\n        return {dataEach: data.hasItemOption ? dataEach : null};\n    }\n};\n\nregisterLayout(linesLayout);\nregisterVisual(linesVisual);\n\nSeriesModel.extend({\n    type: 'series.heatmap',\n\n    getInitialData: function (option, ecModel) {\n        return createListFromArray(this.getSource(), this, {\n            generateCoord: 'value'\n        });\n    },\n\n    preventIncremental: function () {\n        var coordSysCreator = CoordinateSystemManager.get(this.get('coordinateSystem'));\n        if (coordSysCreator && coordSysCreator.dimensions) {\n            return coordSysCreator.dimensions[0] === 'lng' && coordSysCreator.dimensions[1] === 'lat';\n        }\n    },\n\n    defaultOption: {\n\n        // Cartesian2D or geo\n        coordinateSystem: 'cartesian2d',\n\n        zlevel: 0,\n\n        z: 2,\n\n        // Cartesian coordinate system\n        // xAxisIndex: 0,\n        // yAxisIndex: 0,\n\n        // Geo coordinate system\n        geoIndex: 0,\n\n        blurSize: 30,\n\n        pointSize: 20,\n\n        maxOpacity: 1,\n\n        minOpacity: 0\n    }\n});\n\n/**\n * @file defines echarts Heatmap Chart\n * @author Ovilia (me@zhangwenli.com)\n * Inspired by https://github.com/mourner/simpleheat\n *\n * @module\n */\n\nvar GRADIENT_LEVELS = 256;\n\n/**\n * Heatmap Chart\n *\n * @class\n */\nfunction Heatmap() {\n    var canvas = createCanvas();\n    this.canvas = canvas;\n\n    this.blurSize = 30;\n    this.pointSize = 20;\n\n    this.maxOpacity = 1;\n    this.minOpacity = 0;\n\n    this._gradientPixels = {};\n}\n\nHeatmap.prototype = {\n    /**\n     * Renders Heatmap and returns the rendered canvas\n     * @param {Array} data array of data, each has x, y, value\n     * @param {number} width canvas width\n     * @param {number} height canvas height\n     */\n    update: function(data, width, height, normalize, colorFunc, isInRange) {\n        var brush = this._getBrush();\n        var gradientInRange = this._getGradient(data, colorFunc, 'inRange');\n        var gradientOutOfRange = this._getGradient(data, colorFunc, 'outOfRange');\n        var r = this.pointSize + this.blurSize;\n\n        var canvas = this.canvas;\n        var ctx = canvas.getContext('2d');\n        var len = data.length;\n        canvas.width = width;\n        canvas.height = height;\n        for (var i = 0; i < len; ++i) {\n            var p = data[i];\n            var x = p[0];\n            var y = p[1];\n            var value = p[2];\n\n            // calculate alpha using value\n            var alpha = normalize(value);\n\n            // draw with the circle brush with alpha\n            ctx.globalAlpha = alpha;\n            ctx.drawImage(brush, x - r, y - r);\n        }\n\n        if (!canvas.width || !canvas.height) {\n            // Avoid \"Uncaught DOMException: Failed to execute 'getImageData' on\n            // 'CanvasRenderingContext2D': The source height is 0.\"\n            return canvas;\n        }\n\n        // colorize the canvas using alpha value and set with gradient\n        var imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\n\n        var pixels = imageData.data;\n        var offset = 0;\n        var pixelLen = pixels.length;\n        var minOpacity = this.minOpacity;\n        var maxOpacity = this.maxOpacity;\n        var diffOpacity = maxOpacity - minOpacity;\n\n        while(offset < pixelLen) {\n            var alpha = pixels[offset + 3] / 256;\n            var gradientOffset = Math.floor(alpha * (GRADIENT_LEVELS - 1)) * 4;\n            // Simple optimize to ignore the empty data\n            if (alpha > 0) {\n                var gradient = isInRange(alpha) ? gradientInRange : gradientOutOfRange;\n                // Any alpha > 0 will be mapped to [minOpacity, maxOpacity]\n                alpha > 0 && (alpha = alpha * diffOpacity + minOpacity);\n                pixels[offset++] = gradient[gradientOffset];\n                pixels[offset++] = gradient[gradientOffset + 1];\n                pixels[offset++] = gradient[gradientOffset + 2];\n                pixels[offset++] = gradient[gradientOffset + 3] * alpha * 256;\n            }\n            else {\n                offset += 4;\n            }\n        }\n        ctx.putImageData(imageData, 0, 0);\n\n        return canvas;\n    },\n\n    /**\n     * get canvas of a black circle brush used for canvas to draw later\n     * @private\n     * @returns {Object} circle brush canvas\n     */\n    _getBrush: function() {\n        var brushCanvas = this._brushCanvas || (this._brushCanvas = createCanvas());\n        // set brush size\n        var r = this.pointSize + this.blurSize;\n        var d = r * 2;\n        brushCanvas.width = d;\n        brushCanvas.height = d;\n\n        var ctx = brushCanvas.getContext('2d');\n        ctx.clearRect(0, 0, d, d);\n\n        // in order to render shadow without the distinct circle,\n        // draw the distinct circle in an invisible place,\n        // and use shadowOffset to draw shadow in the center of the canvas\n        ctx.shadowOffsetX = d;\n        ctx.shadowBlur = this.blurSize;\n        // draw the shadow in black, and use alpha and shadow blur to generate\n        // color in color map\n        ctx.shadowColor = '#000';\n\n        // draw circle in the left to the canvas\n        ctx.beginPath();\n        ctx.arc(-r, r, this.pointSize, 0, Math.PI * 2, true);\n        ctx.closePath();\n        ctx.fill();\n        return brushCanvas;\n    },\n\n    /**\n     * get gradient color map\n     * @private\n     */\n    _getGradient: function (data, colorFunc, state) {\n        var gradientPixels = this._gradientPixels;\n        var pixelsSingleState = gradientPixels[state] || (gradientPixels[state] = new Uint8ClampedArray(256 * 4));\n        var color = [0, 0, 0, 0];\n        var off = 0;\n        for (var i = 0; i < 256; i++) {\n            colorFunc[state](i / 255, true, color);\n            pixelsSingleState[off++] = color[0];\n            pixelsSingleState[off++] = color[1];\n            pixelsSingleState[off++] = color[2];\n            pixelsSingleState[off++] = color[3];\n        }\n        return pixelsSingleState;\n    }\n};\n\nfunction getIsInPiecewiseRange(dataExtent, pieceList, selected) {\n    var dataSpan = dataExtent[1] - dataExtent[0];\n    pieceList = map(pieceList, function (piece) {\n        return {\n            interval: [\n                (piece.interval[0] - dataExtent[0]) / dataSpan,\n                (piece.interval[1] - dataExtent[0]) / dataSpan\n            ]\n        };\n    });\n    var len = pieceList.length;\n    var lastIndex = 0;\n\n    return function (val) {\n        // Try to find in the location of the last found\n        for (var i = lastIndex; i < len; i++) {\n            var interval = pieceList[i].interval;\n            if (interval[0] <= val && val <= interval[1]) {\n                lastIndex = i;\n                break;\n            }\n        }\n        if (i === len) { // Not found, back interation\n            for (var i = lastIndex - 1; i >= 0; i--) {\n                var interval = pieceList[i].interval;\n                if (interval[0] <= val && val <= interval[1]) {\n                    lastIndex = i;\n                    break;\n                }\n            }\n        }\n        return i >= 0 && i < len && selected[i];\n    };\n}\n\nfunction getIsInContinuousRange(dataExtent, range) {\n    var dataSpan = dataExtent[1] - dataExtent[0];\n    range = [\n        (range[0] - dataExtent[0]) / dataSpan,\n        (range[1] - dataExtent[0]) / dataSpan\n    ];\n    return function (val) {\n        return val >= range[0] && val <= range[1];\n    };\n}\n\nfunction isGeoCoordSys(coordSys) {\n    var dimensions = coordSys.dimensions;\n    // Not use coorSys.type === 'geo' because coordSys maybe extended\n    return dimensions[0] === 'lng' && dimensions[1] === 'lat';\n}\n\nextendChartView({\n\n    type: 'heatmap',\n\n    render: function (seriesModel, ecModel, api) {\n        var visualMapOfThisSeries;\n        ecModel.eachComponent('visualMap', function (visualMap) {\n            visualMap.eachTargetSeries(function (targetSeries) {\n                if (targetSeries === seriesModel) {\n                    visualMapOfThisSeries = visualMap;\n                }\n            });\n        });\n\n        if (__DEV__) {\n            if (!visualMapOfThisSeries) {\n                throw new Error('Heatmap must use with visualMap');\n            }\n        }\n\n        this.group.removeAll();\n\n        this._incrementalDisplayable = null;\n\n        var coordSys = seriesModel.coordinateSystem;\n        if (coordSys.type === 'cartesian2d' || coordSys.type === 'calendar') {\n            this._renderOnCartesianAndCalendar(seriesModel, api, 0, seriesModel.getData().count());\n        }\n        else if (isGeoCoordSys(coordSys)) {\n            this._renderOnGeo(\n                coordSys, seriesModel, visualMapOfThisSeries, api\n            );\n        }\n    },\n\n    incrementalPrepareRender: function (seriesModel, ecModel, api) {\n        this.group.removeAll();\n    },\n\n    incrementalRender: function (params, seriesModel, ecModel, api) {\n        var coordSys = seriesModel.coordinateSystem;\n        if (coordSys) {\n            this._renderOnCartesianAndCalendar(seriesModel, api, params.start, params.end, true);\n        }\n    },\n\n    _renderOnCartesianAndCalendar: function (seriesModel, api, start, end, incremental) {\n\n        var coordSys = seriesModel.coordinateSystem;\n        var width;\n        var height;\n\n        if (coordSys.type === 'cartesian2d') {\n            var xAxis = coordSys.getAxis('x');\n            var yAxis = coordSys.getAxis('y');\n\n            if (__DEV__) {\n                if (!(xAxis.type === 'category' && yAxis.type === 'category')) {\n                    throw new Error('Heatmap on cartesian must have two category axes');\n                }\n                if (!(xAxis.onBand && yAxis.onBand)) {\n                    throw new Error('Heatmap on cartesian must have two axes with boundaryGap true');\n                }\n            }\n\n            width = xAxis.getBandWidth();\n            height = yAxis.getBandWidth();\n        }\n\n        var group = this.group;\n        var data = seriesModel.getData();\n\n        var itemStyleQuery = 'itemStyle';\n        var hoverItemStyleQuery = 'emphasis.itemStyle';\n        var labelQuery = 'label';\n        var hoverLabelQuery = 'emphasis.label';\n        var style = seriesModel.getModel(itemStyleQuery).getItemStyle(['color']);\n        var hoverStl = seriesModel.getModel(hoverItemStyleQuery).getItemStyle();\n        var labelModel = seriesModel.getModel(labelQuery);\n        var hoverLabelModel = seriesModel.getModel(hoverLabelQuery);\n        var coordSysType = coordSys.type;\n\n\n        var dataDims = coordSysType === 'cartesian2d'\n            ? [\n                data.mapDimension('x'),\n                data.mapDimension('y'),\n                data.mapDimension('value')\n            ]\n            : [\n                data.mapDimension('time'),\n                data.mapDimension('value')\n            ];\n\n        for (var idx = start; idx < end; idx++) {\n            var rect;\n\n            if (coordSysType === 'cartesian2d') {\n                // Ignore empty data\n                if (isNaN(data.get(dataDims[2], idx))) {\n                    continue;\n                }\n\n                var point = coordSys.dataToPoint([\n                    data.get(dataDims[0], idx),\n                    data.get(dataDims[1], idx)\n                ]);\n\n                rect = new Rect({\n                    shape: {\n                        x: point[0] - width / 2,\n                        y: point[1] - height / 2,\n                        width: width,\n                        height: height\n                    },\n                    style: {\n                        fill: data.getItemVisual(idx, 'color'),\n                        opacity: data.getItemVisual(idx, 'opacity')\n                    }\n                });\n            }\n            else {\n                // Ignore empty data\n                if (isNaN(data.get(dataDims[1], idx))) {\n                    continue;\n                }\n\n                rect = new Rect({\n                    z2: 1,\n                    shape: coordSys.dataToRect([data.get(dataDims[0], idx)]).contentShape,\n                    style: {\n                        fill: data.getItemVisual(idx, 'color'),\n                        opacity: data.getItemVisual(idx, 'opacity')\n                    }\n                });\n            }\n\n            var itemModel = data.getItemModel(idx);\n\n            // Optimization for large datset\n            if (data.hasItemOption) {\n                style = itemModel.getModel(itemStyleQuery).getItemStyle(['color']);\n                hoverStl = itemModel.getModel(hoverItemStyleQuery).getItemStyle();\n                labelModel = itemModel.getModel(labelQuery);\n                hoverLabelModel = itemModel.getModel(hoverLabelQuery);\n            }\n\n            var rawValue = seriesModel.getRawValue(idx);\n            var defaultText = '-';\n            if (rawValue && rawValue[2] != null) {\n                defaultText = rawValue[2];\n            }\n\n            setLabelStyle(\n                style, hoverStl, labelModel, hoverLabelModel,\n                {\n                    labelFetcher: seriesModel,\n                    labelDataIndex: idx,\n                    defaultText: defaultText,\n                    isRectText: true\n                }\n            );\n\n            rect.setStyle(style);\n            setHoverStyle(rect, data.hasItemOption ? hoverStl : extend({}, hoverStl));\n\n            rect.incremental = incremental;\n            // PENDING\n            if (incremental) {\n                // Rect must use hover layer if it's incremental.\n                rect.useHoverLayer = true;\n            }\n\n            group.add(rect);\n            data.setItemGraphicEl(idx, rect);\n        }\n    },\n\n    _renderOnGeo: function (geo, seriesModel, visualMapModel, api) {\n        var inRangeVisuals = visualMapModel.targetVisuals.inRange;\n        var outOfRangeVisuals = visualMapModel.targetVisuals.outOfRange;\n        // if (!visualMapping) {\n        //     throw new Error('Data range must have color visuals');\n        // }\n\n        var data = seriesModel.getData();\n        var hmLayer = this._hmLayer || (this._hmLayer || new Heatmap());\n        hmLayer.blurSize = seriesModel.get('blurSize');\n        hmLayer.pointSize = seriesModel.get('pointSize');\n        hmLayer.minOpacity = seriesModel.get('minOpacity');\n        hmLayer.maxOpacity = seriesModel.get('maxOpacity');\n\n        var rect = geo.getViewRect().clone();\n        var roamTransform = geo.getRoamTransform();\n        rect.applyTransform(roamTransform);\n\n        // Clamp on viewport\n        var x = Math.max(rect.x, 0);\n        var y = Math.max(rect.y, 0);\n        var x2 = Math.min(rect.width + rect.x, api.getWidth());\n        var y2 = Math.min(rect.height + rect.y, api.getHeight());\n        var width = x2 - x;\n        var height = y2 - y;\n\n        var dims = [\n            data.mapDimension('lng'),\n            data.mapDimension('lat'),\n            data.mapDimension('value')\n        ];\n\n        var points = data.mapArray(dims, function (lng, lat, value) {\n            var pt = geo.dataToPoint([lng, lat]);\n            pt[0] -= x;\n            pt[1] -= y;\n            pt.push(value);\n            return pt;\n        });\n\n        var dataExtent = visualMapModel.getExtent();\n        var isInRange = visualMapModel.type === 'visualMap.continuous'\n            ? getIsInContinuousRange(dataExtent, visualMapModel.option.range)\n            : getIsInPiecewiseRange(\n                dataExtent, visualMapModel.getPieceList(), visualMapModel.option.selected\n            );\n\n        hmLayer.update(\n            points, width, height,\n            inRangeVisuals.color.getNormalizer(),\n            {\n                inRange: inRangeVisuals.color.getColorMapper(),\n                outOfRange: outOfRangeVisuals.color.getColorMapper()\n            },\n            isInRange\n        );\n        var img = new ZImage({\n            style: {\n                width: width,\n                height: height,\n                x: x,\n                y: y,\n                image: hmLayer.canvas\n            },\n            silent: true\n        });\n        this.group.add(img);\n    },\n\n    dispose: function () {}\n});\n\nvar PictorialBarSeries = BaseBarSeries.extend({\n\n    type: 'series.pictorialBar',\n\n    dependencies: ['grid'],\n\n    defaultOption: {\n        symbol: 'circle',     // Customized bar shape\n        symbolSize: null,     // Can be ['100%', '100%'], null means auto.\n        symbolRotate: null,\n\n        symbolPosition: null, // 'start' or 'end' or 'center', null means auto.\n        symbolOffset: null,\n        symbolMargin: null,   // start margin and end margin. Can be a number or a percent string.\n                                // Auto margin by defualt.\n        symbolRepeat: false,  // false/null/undefined, means no repeat.\n                                // Can be true, means auto calculate repeat times and cut by data.\n                                // Can be a number, specifies repeat times, and do not cut by data.\n                                // Can be 'fixed', means auto calculate repeat times but do not cut by data.\n        symbolRepeatDirection: 'end', // 'end' means from 'start' to 'end'.\n\n        symbolClip: false,\n        symbolBoundingData: null, // Can be 60 or -40 or [-40, 60]\n        symbolPatternSize: 400, // 400 * 400 px\n\n        barGap: '-100%',      // In most case, overlap is needed.\n\n        // z can be set in data item, which is z2 actually.\n\n        // Disable progressive\n        progressive: 0,\n        hoverAnimation: false // Open only when needed.\n    },\n\n    getInitialData: function (option) {\n        // Disable stack.\n        option.stack = null;\n        return PictorialBarSeries.superApply(this, 'getInitialData', arguments);\n    }\n});\n\nvar BAR_BORDER_WIDTH_QUERY$1 = ['itemStyle', 'borderWidth'];\n\n// index: +isHorizontal\nvar LAYOUT_ATTRS = [\n    {xy: 'x', wh: 'width', index: 0, posDesc: ['left', 'right']},\n    {xy: 'y', wh: 'height', index: 1, posDesc: ['top', 'bottom']}\n];\n\nvar pathForLineWidth = new Circle();\n\nvar BarView$1 = extendChartView({\n\n    type: 'pictorialBar',\n\n    render: function (seriesModel, ecModel, api) {\n        var group = this.group;\n        var data = seriesModel.getData();\n        var oldData = this._data;\n\n        var cartesian = seriesModel.coordinateSystem;\n        var baseAxis = cartesian.getBaseAxis();\n        var isHorizontal = !!baseAxis.isHorizontal();\n        var coordSysRect = cartesian.grid.getRect();\n\n        var opt = {\n            ecSize: {width: api.getWidth(), height: api.getHeight()},\n            seriesModel: seriesModel,\n            coordSys: cartesian,\n            coordSysExtent: [\n                [coordSysRect.x, coordSysRect.x + coordSysRect.width],\n                [coordSysRect.y, coordSysRect.y + coordSysRect.height]\n            ],\n            isHorizontal: isHorizontal,\n            valueDim: LAYOUT_ATTRS[+isHorizontal],\n            categoryDim: LAYOUT_ATTRS[1 - isHorizontal]\n        };\n\n        data.diff(oldData)\n            .add(function (dataIndex) {\n                if (!data.hasValue(dataIndex)) {\n                    return;\n                }\n\n                var itemModel = getItemModel(data, dataIndex);\n                var symbolMeta = getSymbolMeta(data, dataIndex, itemModel, opt);\n\n                var bar = createBar(data, opt, symbolMeta);\n\n                data.setItemGraphicEl(dataIndex, bar);\n                group.add(bar);\n\n                updateCommon$1(bar, opt, symbolMeta);\n            })\n            .update(function (newIndex, oldIndex) {\n                var bar = oldData.getItemGraphicEl(oldIndex);\n\n                if (!data.hasValue(newIndex)) {\n                    group.remove(bar);\n                    return;\n                }\n\n                var itemModel = getItemModel(data, newIndex);\n                var symbolMeta = getSymbolMeta(data, newIndex, itemModel, opt);\n\n                var pictorialShapeStr = getShapeStr(data, symbolMeta);\n                if (bar && pictorialShapeStr !== bar.__pictorialShapeStr) {\n                    group.remove(bar);\n                    data.setItemGraphicEl(newIndex, null);\n                    bar = null;\n                }\n\n                if (bar) {\n                    updateBar(bar, opt, symbolMeta);\n                }\n                else {\n                    bar = createBar(data, opt, symbolMeta, true);\n                }\n\n                data.setItemGraphicEl(newIndex, bar);\n                bar.__pictorialSymbolMeta = symbolMeta;\n                // Add back\n                group.add(bar);\n\n                updateCommon$1(bar, opt, symbolMeta);\n            })\n            .remove(function (dataIndex) {\n                var bar = oldData.getItemGraphicEl(dataIndex);\n                bar && removeBar(oldData, dataIndex, bar.__pictorialSymbolMeta.animationModel, bar);\n            })\n            .execute();\n\n        this._data = data;\n\n        return this.group;\n    },\n\n    dispose: noop,\n\n    remove: function (ecModel, api) {\n        var group = this.group;\n        var data = this._data;\n        if (ecModel.get('animation')) {\n            if (data) {\n                data.eachItemGraphicEl(function (bar) {\n                    removeBar(data, bar.dataIndex, ecModel, bar);\n                });\n            }\n        }\n        else {\n            group.removeAll();\n        }\n    }\n});\n\n\n// Set or calculate default value about symbol, and calculate layout info.\nfunction getSymbolMeta(data, dataIndex, itemModel, opt) {\n    var layout = data.getItemLayout(dataIndex);\n    var symbolRepeat = itemModel.get('symbolRepeat');\n    var symbolClip = itemModel.get('symbolClip');\n    var symbolPosition = itemModel.get('symbolPosition') || 'start';\n    var symbolRotate = itemModel.get('symbolRotate');\n    var rotation = (symbolRotate || 0) * Math.PI / 180 || 0;\n    var symbolPatternSize = itemModel.get('symbolPatternSize') || 2;\n    var isAnimationEnabled = itemModel.isAnimationEnabled();\n\n    var symbolMeta = {\n        dataIndex: dataIndex,\n        layout: layout,\n        itemModel: itemModel,\n        symbolType: data.getItemVisual(dataIndex, 'symbol') || 'circle',\n        color: data.getItemVisual(dataIndex, 'color'),\n        symbolClip: symbolClip,\n        symbolRepeat: symbolRepeat,\n        symbolRepeatDirection: itemModel.get('symbolRepeatDirection'),\n        symbolPatternSize: symbolPatternSize,\n        rotation: rotation,\n        animationModel: isAnimationEnabled ? itemModel : null,\n        hoverAnimation: isAnimationEnabled && itemModel.get('hoverAnimation'),\n        z2: itemModel.getShallow('z', true) || 0\n    };\n\n    prepareBarLength(itemModel, symbolRepeat, layout, opt, symbolMeta);\n\n    prepareSymbolSize(\n        data, dataIndex, layout, symbolRepeat, symbolClip, symbolMeta.boundingLength,\n        symbolMeta.pxSign, symbolPatternSize, opt, symbolMeta\n    );\n\n    prepareLineWidth(itemModel, symbolMeta.symbolScale, rotation, opt, symbolMeta);\n\n    var symbolSize = symbolMeta.symbolSize;\n    var symbolOffset = itemModel.get('symbolOffset');\n    if (isArray(symbolOffset)) {\n        symbolOffset = [\n            parsePercent$1(symbolOffset[0], symbolSize[0]),\n            parsePercent$1(symbolOffset[1], symbolSize[1])\n        ];\n    }\n\n    prepareLayoutInfo(\n        itemModel, symbolSize, layout, symbolRepeat, symbolClip, symbolOffset,\n        symbolPosition, symbolMeta.valueLineWidth, symbolMeta.boundingLength, symbolMeta.repeatCutLength,\n        opt, symbolMeta\n    );\n\n    return symbolMeta;\n}\n\n// bar length can be negative.\nfunction prepareBarLength(itemModel, symbolRepeat, layout, opt, output) {\n    var valueDim = opt.valueDim;\n    var symbolBoundingData = itemModel.get('symbolBoundingData');\n    var valueAxis = opt.coordSys.getOtherAxis(opt.coordSys.getBaseAxis());\n    var zeroPx = valueAxis.toGlobalCoord(valueAxis.dataToCoord(0));\n    var pxSignIdx = 1 - +(layout[valueDim.wh] <= 0);\n    var boundingLength;\n\n    if (isArray(symbolBoundingData)) {\n        var symbolBoundingExtent = [\n            convertToCoordOnAxis(valueAxis, symbolBoundingData[0]) - zeroPx,\n            convertToCoordOnAxis(valueAxis, symbolBoundingData[1]) - zeroPx\n        ];\n        symbolBoundingExtent[1] < symbolBoundingExtent[0] && (symbolBoundingExtent.reverse());\n        boundingLength = symbolBoundingExtent[pxSignIdx];\n    }\n    else if (symbolBoundingData != null) {\n        boundingLength = convertToCoordOnAxis(valueAxis, symbolBoundingData) - zeroPx;\n    }\n    else if (symbolRepeat) {\n        boundingLength = opt.coordSysExtent[valueDim.index][pxSignIdx] - zeroPx;\n    }\n    else {\n        boundingLength = layout[valueDim.wh];\n    }\n\n    output.boundingLength = boundingLength;\n\n    if (symbolRepeat) {\n        output.repeatCutLength = layout[valueDim.wh];\n    }\n\n    output.pxSign = boundingLength > 0 ? 1 : boundingLength < 0 ? -1 : 0;\n}\n\nfunction convertToCoordOnAxis(axis, value) {\n    return axis.toGlobalCoord(axis.dataToCoord(axis.scale.parse(value)));\n}\n\n// Support ['100%', '100%']\nfunction prepareSymbolSize(\n    data, dataIndex, layout, symbolRepeat, symbolClip, boundingLength,\n    pxSign, symbolPatternSize, opt, output\n) {\n    var valueDim = opt.valueDim;\n    var categoryDim = opt.categoryDim;\n    var categorySize = Math.abs(layout[categoryDim.wh]);\n\n    var symbolSize = data.getItemVisual(dataIndex, 'symbolSize');\n    if (isArray(symbolSize)) {\n        symbolSize = symbolSize.slice();\n    }\n    else {\n        if (symbolSize == null) {\n            symbolSize = '100%';\n        }\n        symbolSize = [symbolSize, symbolSize];\n    }\n\n    // Note: percentage symbolSize (like '100%') do not consider lineWidth, because it is\n    // to complicated to calculate real percent value if considering scaled lineWidth.\n    // So the actual size will bigger than layout size if lineWidth is bigger than zero,\n    // which can be tolerated in pictorial chart.\n\n    symbolSize[categoryDim.index] = parsePercent$1(\n        symbolSize[categoryDim.index],\n        categorySize\n    );\n    symbolSize[valueDim.index] = parsePercent$1(\n        symbolSize[valueDim.index],\n        symbolRepeat ? categorySize : Math.abs(boundingLength)\n    );\n\n    output.symbolSize = symbolSize;\n\n    // If x or y is less than zero, show reversed shape.\n    var symbolScale = output.symbolScale = [\n        symbolSize[0] / symbolPatternSize,\n        symbolSize[1] / symbolPatternSize\n    ];\n    // Follow convention, 'right' and 'top' is the normal scale.\n    symbolScale[valueDim.index] *= (opt.isHorizontal ? -1 : 1) * pxSign;\n}\n\nfunction prepareLineWidth(itemModel, symbolScale, rotation, opt, output) {\n    // In symbols are drawn with scale, so do not need to care about the case that width\n    // or height are too small. But symbol use strokeNoScale, where acture lineWidth should\n    // be calculated.\n    var valueLineWidth = itemModel.get(BAR_BORDER_WIDTH_QUERY$1) || 0;\n\n    if (valueLineWidth) {\n        pathForLineWidth.attr({\n            scale: symbolScale.slice(),\n            rotation: rotation\n        });\n        pathForLineWidth.updateTransform();\n        valueLineWidth /= pathForLineWidth.getLineScale();\n        valueLineWidth *= symbolScale[opt.valueDim.index];\n    }\n\n    output.valueLineWidth = valueLineWidth;\n}\n\nfunction prepareLayoutInfo(\n    itemModel, symbolSize, layout, symbolRepeat, symbolClip, symbolOffset,\n    symbolPosition, valueLineWidth, boundingLength, repeatCutLength, opt, output\n) {\n    var categoryDim = opt.categoryDim;\n    var valueDim = opt.valueDim;\n    var pxSign = output.pxSign;\n\n    var unitLength = Math.max(symbolSize[valueDim.index] + valueLineWidth, 0);\n    var pathLen = unitLength;\n\n    // Note: rotation will not effect the layout of symbols, because user may\n    // want symbols to rotate on its center, which should not be translated\n    // when rotating.\n\n    if (symbolRepeat) {\n        var absBoundingLength = Math.abs(boundingLength);\n\n        var symbolMargin = retrieve(itemModel.get('symbolMargin'), '15%') + '';\n        var hasEndGap = false;\n        if (symbolMargin.lastIndexOf('!') === symbolMargin.length - 1) {\n            hasEndGap = true;\n            symbolMargin = symbolMargin.slice(0, symbolMargin.length - 1);\n        }\n        symbolMargin = parsePercent$1(symbolMargin, symbolSize[valueDim.index]);\n\n        var uLenWithMargin = Math.max(unitLength + symbolMargin * 2, 0);\n\n        // When symbol margin is less than 0, margin at both ends will be subtracted\n        // to ensure that all of the symbols will not be overflow the given area.\n        var endFix = hasEndGap ? 0 : symbolMargin * 2;\n\n        // Both final repeatTimes and final symbolMargin area calculated based on\n        // boundingLength.\n        var repeatSpecified = isNumeric(symbolRepeat);\n        var repeatTimes = repeatSpecified\n            ? symbolRepeat\n            : toIntTimes((absBoundingLength + endFix) / uLenWithMargin);\n\n        // Adjust calculate margin, to ensure each symbol is displayed\n        // entirely in the given layout area.\n        var mDiff = absBoundingLength - repeatTimes * unitLength;\n        symbolMargin = mDiff / 2 / (hasEndGap ? repeatTimes : repeatTimes - 1);\n        uLenWithMargin = unitLength + symbolMargin * 2;\n        endFix = hasEndGap ? 0 : symbolMargin * 2;\n\n        // Update repeatTimes when not all symbol will be shown.\n        if (!repeatSpecified && symbolRepeat !== 'fixed') {\n            repeatTimes = repeatCutLength\n                ? toIntTimes((Math.abs(repeatCutLength) + endFix) / uLenWithMargin)\n                : 0;\n        }\n\n        pathLen = repeatTimes * uLenWithMargin - endFix;\n        output.repeatTimes = repeatTimes;\n        output.symbolMargin = symbolMargin;\n    }\n\n    var sizeFix = pxSign * (pathLen / 2);\n    var pathPosition = output.pathPosition = [];\n    pathPosition[categoryDim.index] = layout[categoryDim.wh] / 2;\n    pathPosition[valueDim.index] = symbolPosition === 'start'\n        ? sizeFix\n        : symbolPosition === 'end'\n        ? boundingLength - sizeFix\n        : boundingLength / 2; // 'center'\n    if (symbolOffset) {\n        pathPosition[0] += symbolOffset[0];\n        pathPosition[1] += symbolOffset[1];\n    }\n\n    var bundlePosition = output.bundlePosition = [];\n    bundlePosition[categoryDim.index] = layout[categoryDim.xy];\n    bundlePosition[valueDim.index] = layout[valueDim.xy];\n\n    var barRectShape = output.barRectShape = extend({}, layout);\n    barRectShape[valueDim.wh] = pxSign * Math.max(\n        Math.abs(layout[valueDim.wh]), Math.abs(pathPosition[valueDim.index] + sizeFix)\n    );\n    barRectShape[categoryDim.wh] = layout[categoryDim.wh];\n\n    var clipShape = output.clipShape = {};\n    // Consider that symbol may be overflow layout rect.\n    clipShape[categoryDim.xy] = -layout[categoryDim.xy];\n    clipShape[categoryDim.wh] = opt.ecSize[categoryDim.wh];\n    clipShape[valueDim.xy] = 0;\n    clipShape[valueDim.wh] = layout[valueDim.wh];\n}\n\nfunction createPath(symbolMeta) {\n    var symbolPatternSize = symbolMeta.symbolPatternSize;\n    var path = createSymbol(\n        // Consider texture img, make a big size.\n        symbolMeta.symbolType,\n        -symbolPatternSize / 2,\n        -symbolPatternSize / 2,\n        symbolPatternSize,\n        symbolPatternSize,\n        symbolMeta.color\n    );\n    path.attr({\n        culling: true\n    });\n    path.type !== 'image' && path.setStyle({\n        strokeNoScale: true\n    });\n\n    return path;\n}\n\nfunction createOrUpdateRepeatSymbols(bar, opt, symbolMeta, isUpdate) {\n    var bundle = bar.__pictorialBundle;\n    var symbolSize = symbolMeta.symbolSize;\n    var valueLineWidth = symbolMeta.valueLineWidth;\n    var pathPosition = symbolMeta.pathPosition;\n    var valueDim = opt.valueDim;\n    var repeatTimes = symbolMeta.repeatTimes || 0;\n\n    var index = 0;\n    var unit = symbolSize[opt.valueDim.index] + valueLineWidth + symbolMeta.symbolMargin * 2;\n\n    eachPath(bar, function (path) {\n        path.__pictorialAnimationIndex = index;\n        path.__pictorialRepeatTimes = repeatTimes;\n        if (index < repeatTimes) {\n            updateAttr(path, null, makeTarget(index), symbolMeta, isUpdate);\n        }\n        else {\n            updateAttr(path, null, {scale: [0, 0]}, symbolMeta, isUpdate, function () {\n                bundle.remove(path);\n            });\n        }\n\n        updateHoverAnimation(path, symbolMeta);\n\n        index++;\n    });\n\n    for (; index < repeatTimes; index++) {\n        var path = createPath(symbolMeta);\n        path.__pictorialAnimationIndex = index;\n        path.__pictorialRepeatTimes = repeatTimes;\n        bundle.add(path);\n\n        var target = makeTarget(index);\n\n        updateAttr(\n            path,\n            {\n                position: target.position,\n                scale: [0, 0]\n            },\n            {\n                scale: target.scale,\n                rotation: target.rotation\n            },\n            symbolMeta,\n            isUpdate\n        );\n\n        // FIXME\n        // If all emphasis/normal through action.\n        path\n            .on('mouseover', onMouseOver)\n            .on('mouseout', onMouseOut);\n\n        updateHoverAnimation(path, symbolMeta);\n    }\n\n    function makeTarget(index) {\n        var position = pathPosition.slice();\n        // (start && pxSign > 0) || (end && pxSign < 0): i = repeatTimes - index\n        // Otherwise: i = index;\n        var pxSign = symbolMeta.pxSign;\n        var i = index;\n        if (symbolMeta.symbolRepeatDirection === 'start' ? pxSign > 0 : pxSign < 0) {\n            i = repeatTimes - 1 - index;\n        }\n        position[valueDim.index] = unit * (i - repeatTimes / 2 + 0.5) + pathPosition[valueDim.index];\n\n        return {\n            position: position,\n            scale: symbolMeta.symbolScale.slice(),\n            rotation: symbolMeta.rotation\n        };\n    }\n\n    function onMouseOver() {\n        eachPath(bar, function (path) {\n            path.trigger('emphasis');\n        });\n    }\n\n    function onMouseOut() {\n        eachPath(bar, function (path) {\n            path.trigger('normal');\n        });\n    }\n}\n\nfunction createOrUpdateSingleSymbol(bar, opt, symbolMeta, isUpdate) {\n    var bundle = bar.__pictorialBundle;\n    var mainPath = bar.__pictorialMainPath;\n\n    if (!mainPath) {\n        mainPath = bar.__pictorialMainPath = createPath(symbolMeta);\n        bundle.add(mainPath);\n\n        updateAttr(\n            mainPath,\n            {\n                position: symbolMeta.pathPosition.slice(),\n                scale: [0, 0],\n                rotation: symbolMeta.rotation\n            },\n            {\n                scale: symbolMeta.symbolScale.slice()\n            },\n            symbolMeta,\n            isUpdate\n        );\n\n        mainPath\n            .on('mouseover', onMouseOver)\n            .on('mouseout', onMouseOut);\n    }\n    else {\n        updateAttr(\n            mainPath,\n            null,\n            {\n                position: symbolMeta.pathPosition.slice(),\n                scale: symbolMeta.symbolScale.slice(),\n                rotation: symbolMeta.rotation\n            },\n            symbolMeta,\n            isUpdate\n        );\n    }\n\n    updateHoverAnimation(mainPath, symbolMeta);\n\n    function onMouseOver() {\n        this.trigger('emphasis');\n    }\n\n    function onMouseOut() {\n        this.trigger('normal');\n    }\n}\n\n// bar rect is used for label.\nfunction createOrUpdateBarRect(bar, symbolMeta, isUpdate) {\n    var rectShape = extend({}, symbolMeta.barRectShape);\n\n    var barRect = bar.__pictorialBarRect;\n    if (!barRect) {\n        barRect = bar.__pictorialBarRect = new Rect({\n            z2: 2,\n            shape: rectShape,\n            silent: true,\n            style: {\n                stroke: 'transparent',\n                fill: 'transparent',\n                lineWidth: 0\n            }\n        });\n\n        bar.add(barRect);\n    }\n    else {\n        updateAttr(barRect, null, {shape: rectShape}, symbolMeta, isUpdate);\n    }\n}\n\nfunction createOrUpdateClip(bar, opt, symbolMeta, isUpdate) {\n    // If not clip, symbol will be remove and rebuilt.\n    if (symbolMeta.symbolClip) {\n        var clipPath = bar.__pictorialClipPath;\n        var clipShape = extend({}, symbolMeta.clipShape);\n        var valueDim = opt.valueDim;\n        var animationModel = symbolMeta.animationModel;\n        var dataIndex = symbolMeta.dataIndex;\n\n        if (clipPath) {\n            updateProps(\n                clipPath, {shape: clipShape}, animationModel, dataIndex\n            );\n        }\n        else {\n            clipShape[valueDim.wh] = 0;\n            clipPath = new Rect({shape: clipShape});\n            bar.__pictorialBundle.setClipPath(clipPath);\n            bar.__pictorialClipPath = clipPath;\n\n            var target = {};\n            target[valueDim.wh] = symbolMeta.clipShape[valueDim.wh];\n\n            graphic[isUpdate ? 'updateProps' : 'initProps'](\n                clipPath, {shape: target}, animationModel, dataIndex\n            );\n        }\n    }\n}\n\nfunction getItemModel(data, dataIndex) {\n    var itemModel = data.getItemModel(dataIndex);\n    itemModel.getAnimationDelayParams = getAnimationDelayParams;\n    itemModel.isAnimationEnabled = isAnimationEnabled;\n    return itemModel;\n}\n\nfunction getAnimationDelayParams(path) {\n    // The order is the same as the z-order, see `symbolRepeatDiretion`.\n    return {\n        index: path.__pictorialAnimationIndex,\n        count: path.__pictorialRepeatTimes\n    };\n}\n\nfunction isAnimationEnabled() {\n    // `animation` prop can be set on itemModel in pictorial bar chart.\n    return this.parentModel.isAnimationEnabled() && !!this.getShallow('animation');\n}\n\nfunction updateHoverAnimation(path, symbolMeta) {\n    path.off('emphasis').off('normal');\n\n    var scale = symbolMeta.symbolScale.slice();\n\n    symbolMeta.hoverAnimation && path\n        .on('emphasis', function() {\n            this.animateTo({\n                scale: [scale[0] * 1.1, scale[1] * 1.1]\n            }, 400, 'elasticOut');\n        })\n        .on('normal', function() {\n            this.animateTo({\n                scale: scale.slice()\n            }, 400, 'elasticOut');\n        });\n}\n\nfunction createBar(data, opt, symbolMeta, isUpdate) {\n    // bar is the main element for each data.\n    var bar = new Group();\n    // bundle is used for location and clip.\n    var bundle = new Group();\n    bar.add(bundle);\n    bar.__pictorialBundle = bundle;\n    bundle.attr('position', symbolMeta.bundlePosition.slice());\n\n    if (symbolMeta.symbolRepeat) {\n        createOrUpdateRepeatSymbols(bar, opt, symbolMeta);\n    }\n    else {\n        createOrUpdateSingleSymbol(bar, opt, symbolMeta);\n    }\n\n    createOrUpdateBarRect(bar, symbolMeta, isUpdate);\n\n    createOrUpdateClip(bar, opt, symbolMeta, isUpdate);\n\n    bar.__pictorialShapeStr = getShapeStr(data, symbolMeta);\n    bar.__pictorialSymbolMeta = symbolMeta;\n\n    return bar;\n}\n\nfunction updateBar(bar, opt, symbolMeta) {\n    var animationModel = symbolMeta.animationModel;\n    var dataIndex = symbolMeta.dataIndex;\n    var bundle = bar.__pictorialBundle;\n\n    updateProps(\n        bundle, {position: symbolMeta.bundlePosition.slice()}, animationModel, dataIndex\n    );\n\n    if (symbolMeta.symbolRepeat) {\n        createOrUpdateRepeatSymbols(bar, opt, symbolMeta, true);\n    }\n    else {\n        createOrUpdateSingleSymbol(bar, opt, symbolMeta, true);\n    }\n\n    createOrUpdateBarRect(bar, symbolMeta, true);\n\n    createOrUpdateClip(bar, opt, symbolMeta, true);\n}\n\nfunction removeBar(data, dataIndex, animationModel, bar) {\n    // Not show text when animating\n    var labelRect = bar.__pictorialBarRect;\n    labelRect && (labelRect.style.text = null);\n\n    var pathes = [];\n    eachPath(bar, function (path) {\n        pathes.push(path);\n    });\n    bar.__pictorialMainPath && pathes.push(bar.__pictorialMainPath);\n\n    // I do not find proper remove animation for clip yet.\n    bar.__pictorialClipPath && (animationModel = null);\n\n    each$1(pathes, function (path) {\n        updateProps(\n            path, {scale: [0, 0]}, animationModel, dataIndex,\n            function () {\n                bar.parent && bar.parent.remove(bar);\n            }\n        );\n    });\n\n    data.setItemGraphicEl(dataIndex, null);\n}\n\nfunction getShapeStr(data, symbolMeta) {\n    return [\n        data.getItemVisual(symbolMeta.dataIndex, 'symbol') || 'none',\n        !!symbolMeta.symbolRepeat,\n        !!symbolMeta.symbolClip\n    ].join(':');\n}\n\nfunction eachPath(bar, cb, context) {\n    // Do not use Group#eachChild, because it do not support remove.\n    each$1(bar.__pictorialBundle.children(), function (el) {\n        el !== bar.__pictorialBarRect && cb.call(context, el);\n    });\n}\n\nfunction updateAttr(el, immediateAttrs, animationAttrs, symbolMeta, isUpdate, cb) {\n    immediateAttrs && el.attr(immediateAttrs);\n    // when symbolCip used, only clip path has init animation, otherwise it would be weird effect.\n    if (symbolMeta.symbolClip && !isUpdate) {\n        animationAttrs && el.attr(animationAttrs);\n    }\n    else {\n        animationAttrs && graphic[isUpdate ? 'updateProps' : 'initProps'](\n            el, animationAttrs, symbolMeta.animationModel, symbolMeta.dataIndex, cb\n        );\n    }\n}\n\nfunction updateCommon$1(bar, opt, symbolMeta) {\n    var color = symbolMeta.color;\n    var dataIndex = symbolMeta.dataIndex;\n    var itemModel = symbolMeta.itemModel;\n    // Color must be excluded.\n    // Because symbol provide setColor individually to set fill and stroke\n    var normalStyle = itemModel.getModel('itemStyle').getItemStyle(['color']);\n    var hoverStyle = itemModel.getModel('emphasis.itemStyle').getItemStyle();\n    var cursorStyle = itemModel.getShallow('cursor');\n\n    eachPath(bar, function (path) {\n        // PENDING setColor should be before setStyle!!!\n        path.setColor(color);\n        path.setStyle(defaults(\n            {\n                fill: color,\n                opacity: symbolMeta.opacity\n            },\n            normalStyle\n        ));\n        setHoverStyle(path, hoverStyle);\n\n        cursorStyle && (path.cursor = cursorStyle);\n        path.z2 = symbolMeta.z2;\n    });\n\n    var barRectHoverStyle = {};\n    var barPositionOutside = opt.valueDim.posDesc[+(symbolMeta.boundingLength > 0)];\n    var barRect = bar.__pictorialBarRect;\n\n    setLabel(\n        barRect.style, barRectHoverStyle, itemModel,\n        color, opt.seriesModel, dataIndex, barPositionOutside\n    );\n\n    setHoverStyle(barRect, barRectHoverStyle);\n}\n\nfunction toIntTimes(times) {\n    var roundedTimes = Math.round(times);\n    // Escapse accurate error\n    return Math.abs(times - roundedTimes) < 1e-4\n        ? roundedTimes\n        : Math.ceil(times);\n}\n\n// In case developer forget to include grid component\nregisterLayout(curry(\n    layout, 'pictorialBar'\n));\nregisterVisual(visualSymbol('pictorialBar', 'roundRect'));\n\n/**\n * @constructor  module:echarts/coord/single/SingleAxis\n * @extends {module:echarts/coord/Axis}\n * @param {string} dim\n * @param {*} scale\n * @param {Array.<number>} coordExtent\n * @param {string} axisType\n * @param {string} position\n */\nvar SingleAxis = function (dim, scale, coordExtent, axisType, position) {\n\n    Axis.call(this, dim, scale, coordExtent);\n\n    /**\n     * Axis type\n     * - 'category'\n     * - 'value'\n     * - 'time'\n     * - 'log'\n     * @type {string}\n     */\n    this.type = axisType || 'value';\n\n    /**\n     * Axis position\n     *  - 'top'\n     *  - 'bottom'\n     *  - 'left'\n     *  - 'right'\n     *  @type {string}\n     */\n    this.position = position || 'bottom';\n\n    /**\n     * Axis orient\n     *  - 'horizontal'\n     *  - 'vertical'\n     * @type {[type]}\n     */\n    this.orient = null;\n\n    /**\n     * @type {number}\n     */\n    this._labelInterval = null;\n\n};\n\nSingleAxis.prototype = {\n\n    constructor: SingleAxis,\n\n    /**\n     * Axis model\n     * @type {module:echarts/coord/single/AxisModel}\n     */\n    model: null,\n\n    /**\n     * Judge the orient of the axis.\n     * @return {boolean}\n     */\n    isHorizontal: function () {\n        var position = this.position;\n        return position === 'top' || position === 'bottom';\n\n    },\n\n    /**\n     * @override\n     */\n    pointToData: function (point, clamp) {\n        return this.coordinateSystem.pointToData(point, clamp)[0];\n    },\n\n    /**\n     * Convert the local coord(processed by dataToCoord())\n     * to global coord(concrete pixel coord).\n     * designated by module:echarts/coord/single/Single.\n     * @type {Function}\n     */\n    toGlobalCoord: null,\n\n    /**\n     * Convert the global coord to local coord.\n     * designated by module:echarts/coord/single/Single.\n     * @type {Function}\n     */\n    toLocalCoord: null\n\n};\n\ninherits(SingleAxis, Axis);\n\n/**\n * Single coordinates system.\n */\n\n/**\n * Create a single coordinates system.\n *\n * @param {module:echarts/coord/single/AxisModel} axisModel\n * @param {module:echarts/model/Global} ecModel\n * @param {module:echarts/ExtensionAPI} api\n */\nfunction Single(axisModel, ecModel, api) {\n\n    /**\n     * @type {string}\n     * @readOnly\n     */\n    this.dimension = 'single';\n\n    /**\n     * Add it just for draw tooltip.\n     *\n     * @type {Array.<string>}\n     * @readOnly\n     */\n    this.dimensions = ['single'];\n\n    /**\n     * @private\n     * @type {module:echarts/coord/single/SingleAxis}.\n     */\n    this._axis = null;\n\n    /**\n     * @private\n     * @type {module:zrender/core/BoundingRect}\n     */\n    this._rect;\n\n    this._init(axisModel, ecModel, api);\n\n    /**\n     * @type {module:echarts/coord/single/AxisModel}\n     */\n    this.model = axisModel;\n}\n\nSingle.prototype = {\n\n    type: 'singleAxis',\n\n    axisPointerEnabled: true,\n\n    constructor: Single,\n\n    /**\n     * Initialize single coordinate system.\n     *\n     * @param  {module:echarts/coord/single/AxisModel} axisModel\n     * @param  {module:echarts/model/Global} ecModel\n     * @param  {module:echarts/ExtensionAPI} api\n     * @private\n     */\n    _init: function (axisModel, ecModel, api) {\n\n        var dim = this.dimension;\n\n        var axis = new SingleAxis(\n            dim,\n            createScaleByModel(axisModel),\n            [0, 0],\n            axisModel.get('type'),\n            axisModel.get('position')\n        );\n\n        var isCategory = axis.type === 'category';\n        axis.onBand = isCategory && axisModel.get('boundaryGap');\n        axis.inverse = axisModel.get('inverse');\n        axis.orient = axisModel.get('orient');\n\n        axisModel.axis = axis;\n        axis.model = axisModel;\n        axis.coordinateSystem = this;\n        this._axis = axis;\n    },\n\n    /**\n     * Update axis scale after data processed\n     * @param  {module:echarts/model/Global} ecModel\n     * @param  {module:echarts/ExtensionAPI} api\n     */\n    update: function (ecModel, api) {\n        ecModel.eachSeries(function (seriesModel) {\n            if (seriesModel.coordinateSystem === this) {\n                var data = seriesModel.getData();\n                each$1(data.mapDimension(this.dimension, true), function (dim) {\n                    this._axis.scale.unionExtentFromData(data, dim);\n                }, this);\n                niceScaleExtent(this._axis.scale, this._axis.model);\n            }\n        }, this);\n    },\n\n    /**\n     * Resize the single coordinate system.\n     *\n     * @param  {module:echarts/coord/single/AxisModel} axisModel\n     * @param  {module:echarts/ExtensionAPI} api\n     */\n    resize: function (axisModel, api) {\n        this._rect = getLayoutRect(\n            {\n                left: axisModel.get('left'),\n                top: axisModel.get('top'),\n                right: axisModel.get('right'),\n                bottom: axisModel.get('bottom'),\n                width: axisModel.get('width'),\n                height: axisModel.get('height')\n            },\n            {\n                width: api.getWidth(),\n                height: api.getHeight()\n            }\n        );\n\n        this._adjustAxis();\n    },\n\n    /**\n     * @return {module:zrender/core/BoundingRect}\n     */\n    getRect: function () {\n        return this._rect;\n    },\n\n    /**\n     * @private\n     */\n    _adjustAxis: function () {\n\n        var rect = this._rect;\n        var axis = this._axis;\n\n        var isHorizontal = axis.isHorizontal();\n        var extent = isHorizontal ? [0, rect.width] : [0, rect.height];\n        var idx =  axis.reverse ? 1 : 0;\n\n        axis.setExtent(extent[idx], extent[1 - idx]);\n\n        this._updateAxisTransform(axis, isHorizontal ? rect.x : rect.y);\n\n    },\n\n    /**\n     * @param  {module:echarts/coord/single/SingleAxis} axis\n     * @param  {number} coordBase\n     */\n    _updateAxisTransform: function (axis, coordBase) {\n\n        var axisExtent = axis.getExtent();\n        var extentSum = axisExtent[0] + axisExtent[1];\n        var isHorizontal = axis.isHorizontal();\n\n        axis.toGlobalCoord = isHorizontal\n            ? function (coord) {\n                return coord + coordBase;\n            }\n            : function (coord) {\n                return extentSum - coord + coordBase;\n            };\n\n        axis.toLocalCoord = isHorizontal\n            ? function (coord) {\n                return coord - coordBase;\n            }\n            : function (coord) {\n                return extentSum - coord + coordBase;\n            };\n    },\n\n    /**\n     * Get axis.\n     *\n     * @return {module:echarts/coord/single/SingleAxis}\n     */\n    getAxis: function () {\n        return this._axis;\n    },\n\n    /**\n     * Get axis, add it just for draw tooltip.\n     *\n     * @return {[type]} [description]\n     */\n    getBaseAxis: function () {\n        return this._axis;\n    },\n\n    /**\n     * @return {Array.<module:echarts/coord/Axis>}\n     */\n    getAxes: function () {\n        return [this._axis];\n    },\n\n    /**\n     * @return {Object} {baseAxes: [], otherAxes: []}\n     */\n    getTooltipAxes: function () {\n        return {baseAxes: [this.getAxis()]};\n    },\n\n    /**\n     * If contain point.\n     *\n     * @param  {Array.<number>} point\n     * @return {boolean}\n     */\n    containPoint: function (point) {\n        var rect = this.getRect();\n        var axis = this.getAxis();\n        var orient = axis.orient;\n        if (orient === 'horizontal') {\n            return axis.contain(axis.toLocalCoord(point[0]))\n            && (point[1] >= rect.y && point[1] <= (rect.y + rect.height));\n        }\n        else {\n            return axis.contain(axis.toLocalCoord(point[1]))\n            && (point[0] >= rect.y && point[0] <= (rect.y + rect.height));\n        }\n    },\n\n    /**\n     * @param {Array.<number>} point\n     * @return {Array.<number>}\n     */\n    pointToData: function (point) {\n        var axis = this.getAxis();\n        return [axis.coordToData(axis.toLocalCoord(\n            point[axis.orient === 'horizontal' ? 0 : 1]\n        ))];\n    },\n\n    /**\n     * Convert the series data to concrete point.\n     *\n     * @param  {number|Array.<number>} val\n     * @return {Array.<number>}\n     */\n    dataToPoint: function (val) {\n        var axis = this.getAxis();\n        var rect = this.getRect();\n        var pt = [];\n        var idx = axis.orient === 'horizontal' ? 0 : 1;\n\n        if (val instanceof Array) {\n            val = val[0];\n        }\n\n        pt[idx] = axis.toGlobalCoord(axis.dataToCoord(+val));\n        pt[1 - idx] = idx === 0 ? (rect.y + rect.height / 2) : (rect.x + rect.width / 2);\n        return pt;\n    }\n\n};\n\n/**\n * Single coordinate system creator.\n */\n\n/**\n * Create single coordinate system and inject it into seriesModel.\n *\n * @param {module:echarts/model/Global} ecModel\n * @param {module:echarts/ExtensionAPI} api\n * @return {Array.<module:echarts/coord/single/Single>}\n */\nfunction create$3(ecModel, api) {\n    var singles = [];\n\n    ecModel.eachComponent('singleAxis', function(axisModel, idx) {\n\n        var single = new Single(axisModel, ecModel, api);\n        single.name = 'single_' + idx;\n        single.resize(axisModel, api);\n        axisModel.coordinateSystem = single;\n        singles.push(single);\n\n    });\n\n    ecModel.eachSeries(function (seriesModel) {\n        if (seriesModel.get('coordinateSystem') === 'singleAxis') {\n            var singleAxisModel = ecModel.queryComponents({\n                mainType: 'singleAxis',\n                index: seriesModel.get('singleAxisIndex'),\n                id: seriesModel.get('singleAxisId')\n            })[0];\n            seriesModel.coordinateSystem = singleAxisModel && singleAxisModel.coordinateSystem;\n        }\n    });\n\n    return singles;\n}\n\nCoordinateSystemManager.register('single', {\n    create: create$3,\n    dimensions: Single.prototype.dimensions\n});\n\n/**\n * @param {Object} opt {labelInside}\n * @return {Object} {\n *  position, rotation, labelDirection, labelOffset,\n *  tickDirection, labelRotate, labelInterval, z2\n * }\n */\nfunction layout$2 (axisModel, opt) {\n    opt = opt || {};\n    var single = axisModel.coordinateSystem;\n    var axis = axisModel.axis;\n    var layout = {};\n\n    var axisPosition = axis.position;\n    var orient = axis.orient;\n\n    var rect = single.getRect();\n    var rectBound = [rect.x, rect.x + rect.width, rect.y, rect.y + rect.height];\n\n    var positionMap = {\n        horizontal: {top: rectBound[2], bottom: rectBound[3]},\n        vertical: {left: rectBound[0], right: rectBound[1]}\n    };\n\n    layout.position = [\n        orient === 'vertical'\n            ? positionMap.vertical[axisPosition]\n            : rectBound[0],\n        orient === 'horizontal'\n            ? positionMap.horizontal[axisPosition]\n            : rectBound[3]\n    ];\n\n    var r = {horizontal: 0, vertical: 1};\n    layout.rotation = Math.PI / 2 * r[orient];\n\n    var directionMap = {top: -1, bottom: 1, right: 1, left: -1};\n\n    layout.labelDirection = layout.tickDirection\n        = layout.nameDirection\n        = directionMap[axisPosition];\n\n    if (axisModel.get('axisTick.inside')) {\n        layout.tickDirection = -layout.tickDirection;\n    }\n\n    if (retrieve(opt.labelInside, axisModel.get('axisLabel.inside'))) {\n        layout.labelDirection = -layout.labelDirection;\n    }\n\n    var labelRotation = opt.rotate;\n    labelRotation == null && (labelRotation = axisModel.get('axisLabel.rotate'));\n    layout.labelRotation = axisPosition === 'top' ? -labelRotation : labelRotation;\n\n    layout.labelInterval = axis.getLabelInterval();\n\n    layout.z2 = 1;\n\n    return layout;\n}\n\nvar getInterval$2 = AxisBuilder.getInterval;\nvar ifIgnoreOnTick$2 = AxisBuilder.ifIgnoreOnTick;\n\nvar axisBuilderAttrs$2 = [\n    'axisLine', 'axisTickLabel', 'axisName'\n];\n\nvar selfBuilderAttr = 'splitLine';\n\nvar SingleAxisView = AxisView.extend({\n\n    type: 'singleAxis',\n\n    axisPointerClass: 'SingleAxisPointer',\n\n    render: function (axisModel, ecModel, api, payload) {\n\n        var group = this.group;\n\n        group.removeAll();\n\n        var layout =  layout$2(axisModel);\n\n        var axisBuilder = new AxisBuilder(axisModel, layout);\n\n        each$1(axisBuilderAttrs$2, axisBuilder.add, axisBuilder);\n\n        group.add(axisBuilder.getGroup());\n\n        if (axisModel.get(selfBuilderAttr + '.show')) {\n            this['_' + selfBuilderAttr](axisModel, layout.labelInterval);\n        }\n\n        SingleAxisView.superCall(this, 'render', axisModel, ecModel, api, payload);\n    },\n\n    _splitLine: function(axisModel, labelInterval) {\n        var axis = axisModel.axis;\n\n        if (axis.scale.isBlank()) {\n            return;\n        }\n\n        var splitLineModel = axisModel.getModel('splitLine');\n        var lineStyleModel = splitLineModel.getModel('lineStyle');\n        var lineWidth = lineStyleModel.get('width');\n        var lineColors = lineStyleModel.get('color');\n        var lineInterval = getInterval$2(splitLineModel, labelInterval);\n\n        lineColors = lineColors instanceof Array ? lineColors : [lineColors];\n\n        var gridRect = axisModel.coordinateSystem.getRect();\n        var isHorizontal = axis.isHorizontal();\n\n        var splitLines = [];\n        var lineCount = 0;\n\n        var ticksCoords = axis.getTicksCoords();\n\n        var p1 = [];\n        var p2 = [];\n\n        var showMinLabel = axisModel.get('axisLabel.showMinLabel');\n        var showMaxLabel = axisModel.get('axisLabel.showMaxLabel');\n\n        for (var i = 0; i < ticksCoords.length; ++i) {\n            if (ifIgnoreOnTick$2(\n                axis, i, lineInterval, ticksCoords.length,\n                showMinLabel, showMaxLabel\n            )) {\n                continue;\n            }\n            var tickCoord = axis.toGlobalCoord(ticksCoords[i]);\n            if (isHorizontal) {\n                p1[0] = tickCoord;\n                p1[1] = gridRect.y;\n                p2[0] = tickCoord;\n                p2[1] = gridRect.y + gridRect.height;\n            }\n            else {\n                p1[0] = gridRect.x;\n                p1[1] = tickCoord;\n                p2[0] = gridRect.x + gridRect.width;\n                p2[1] = tickCoord;\n            }\n            var colorIndex = (lineCount++) % lineColors.length;\n            splitLines[colorIndex] = splitLines[colorIndex] || [];\n            splitLines[colorIndex].push(new Line(\n                subPixelOptimizeLine({\n                    shape: {\n                        x1: p1[0],\n                        y1: p1[1],\n                        x2: p2[0],\n                        y2: p2[1]\n                    },\n                    style: {\n                        lineWidth: lineWidth\n                    },\n                    silent: true\n                })));\n        }\n\n        for (var i = 0; i < splitLines.length; ++i) {\n            this.group.add(mergePath(splitLines[i], {\n                style: {\n                    stroke: lineColors[i % lineColors.length],\n                    lineDash: lineStyleModel.getLineDash(lineWidth),\n                    lineWidth: lineWidth\n                },\n                silent: true\n            }));\n        }\n    }\n});\n\nvar AxisModel$4 = ComponentModel.extend({\n\n    type: 'singleAxis',\n\n    layoutMode: 'box',\n\n    /**\n     * @type {module:echarts/coord/single/SingleAxis}\n     */\n    axis: null,\n\n    /**\n     * @type {module:echarts/coord/single/Single}\n     */\n    coordinateSystem: null,\n\n    /**\n     * @override\n     */\n    getCoordSysModel: function () {\n        return this;\n    }\n\n});\n\nvar defaultOption$2 = {\n\n    left: '5%',\n    top: '5%',\n    right: '5%',\n    bottom: '5%',\n\n    type: 'value',\n\n    position: 'bottom',\n\n    orient: 'horizontal',\n\n    axisLine: {\n        show: true,\n        lineStyle: {\n            width: 2,\n            type: 'solid'\n        }\n    },\n\n    // Single coordinate system and single axis is the,\n    // which is used as the parent tooltip model.\n    // same model, so we set default tooltip show as true.\n    tooltip: {\n        show: true\n    },\n\n    axisTick: {\n        show: true,\n        length: 6,\n        lineStyle: {\n            width: 2\n        }\n    },\n\n    axisLabel: {\n        show: true,\n        interval: 'auto'\n    },\n\n    splitLine: {\n        show: true,\n        lineStyle: {\n            type: 'dashed',\n            opacity: 0.2\n        }\n    }\n};\n\nfunction getAxisType$2(axisName, option) {\n    return option.type || (option.data ? 'category' : 'value');\n}\n\nmerge(AxisModel$4.prototype, axisModelCommonMixin);\n\naxisModelCreator('single', AxisModel$4, getAxisType$2, defaultOption$2);\n\n/**\n * @param {Object} finder contains {seriesIndex, dataIndex, dataIndexInside}\n * @param {module:echarts/model/Global} ecModel\n * @return {Object} {point: [x, y], el: ...} point Will not be null.\n */\nvar findPointFromSeries = function (finder, ecModel) {\n    var point = [];\n    var seriesIndex = finder.seriesIndex;\n    var seriesModel;\n    if (seriesIndex == null || !(\n        seriesModel = ecModel.getSeriesByIndex(seriesIndex)\n    )) {\n        return {point: []};\n    }\n\n    var data = seriesModel.getData();\n    var dataIndex = queryDataIndex(data, finder);\n    if (dataIndex == null || dataIndex < 0 || isArray(dataIndex)) {\n        return {point: []};\n    }\n\n    var el = data.getItemGraphicEl(dataIndex);\n    var coordSys = seriesModel.coordinateSystem;\n\n    if (seriesModel.getTooltipPosition) {\n        point = seriesModel.getTooltipPosition(dataIndex) || [];\n    }\n    else if (coordSys && coordSys.dataToPoint) {\n        point = coordSys.dataToPoint(\n            data.getValues(\n                map(coordSys.dimensions, function (dim) {\n                    return data.mapDimension(dim);\n                }), dataIndex, true\n            )\n        ) || [];\n    }\n    else if (el) {\n        // Use graphic bounding rect\n        var rect = el.getBoundingRect().clone();\n        rect.applyTransform(el.transform);\n        point = [\n            rect.x + rect.width / 2,\n            rect.y + rect.height / 2\n        ];\n    }\n\n    return {point: point, el: el};\n};\n\nvar each$15 = each$1;\nvar curry$3 = curry;\nvar inner$6 = makeInner();\n\n/**\n * Basic logic: check all axis, if they do not demand show/highlight,\n * then hide/downplay them.\n *\n * @param {Object} coordSysAxesInfo\n * @param {Object} payload\n * @param {string} [payload.currTrigger] 'click' | 'mousemove' | 'leave'\n * @param {Array.<number>} [payload.x] x and y, which are mandatory, specify a point to\n *              trigger axisPointer and tooltip.\n * @param {Array.<number>} [payload.y] x and y, which are mandatory, specify a point to\n *              trigger axisPointer and tooltip.\n * @param {Object} [payload.seriesIndex] finder, optional, restrict target axes.\n * @param {Object} [payload.dataIndex] finder, restrict target axes.\n * @param {Object} [payload.axesInfo] finder, restrict target axes.\n *        [{\n *          axisDim: 'x'|'y'|'angle'|...,\n *          axisIndex: ...,\n *          value: ...\n *        }, ...]\n * @param {Function} [payload.dispatchAction]\n * @param {Object} [payload.tooltipOption]\n * @param {Object|Array.<number>|Function} [payload.position] Tooltip position,\n *        which can be specified in dispatchAction\n * @param {module:echarts/model/Global} ecModel\n * @param {module:echarts/ExtensionAPI} api\n * @return {Object} content of event obj for echarts.connect.\n */\nvar axisTrigger = function (payload, ecModel, api) {\n    var currTrigger = payload.currTrigger;\n    var point = [payload.x, payload.y];\n    var finder = payload;\n    var dispatchAction = payload.dispatchAction || bind(api.dispatchAction, api);\n    var coordSysAxesInfo = ecModel.getComponent('axisPointer').coordSysAxesInfo;\n\n    // Pending\n    // See #6121. But we are not able to reproduce it yet.\n    if (!coordSysAxesInfo) {\n        return;\n    }\n\n    if (illegalPoint(point)) {\n        // Used in the default behavior of `connection`: use the sample seriesIndex\n        // and dataIndex. And also used in the tooltipView trigger.\n        point = findPointFromSeries({\n            seriesIndex: finder.seriesIndex,\n            // Do not use dataIndexInside from other ec instance.\n            // FIXME: auto detect it?\n            dataIndex: finder.dataIndex\n        }, ecModel).point;\n    }\n    var isIllegalPoint = illegalPoint(point);\n\n    // Axis and value can be specified when calling dispatchAction({type: 'updateAxisPointer'}).\n    // Notice: In this case, it is difficult to get the `point` (which is necessary to show\n    // tooltip, so if point is not given, we just use the point found by sample seriesIndex\n    // and dataIndex.\n    var inputAxesInfo = finder.axesInfo;\n\n    var axesInfo = coordSysAxesInfo.axesInfo;\n    var shouldHide = currTrigger === 'leave' || illegalPoint(point);\n    var outputFinder = {};\n\n    var showValueMap = {};\n    var dataByCoordSys = {list: [], map: {}};\n    var updaters = {\n        showPointer: curry$3(showPointer, showValueMap),\n        showTooltip: curry$3(showTooltip, dataByCoordSys)\n    };\n\n    // Process for triggered axes.\n    each$15(coordSysAxesInfo.coordSysMap, function (coordSys, coordSysKey) {\n        // If a point given, it must be contained by the coordinate system.\n        var coordSysContainsPoint = isIllegalPoint || coordSys.containPoint(point);\n\n        each$15(coordSysAxesInfo.coordSysAxesInfo[coordSysKey], function (axisInfo, key) {\n            var axis = axisInfo.axis;\n            var inputAxisInfo = findInputAxisInfo(inputAxesInfo, axisInfo);\n            // If no inputAxesInfo, no axis is restricted.\n            if (!shouldHide && coordSysContainsPoint && (!inputAxesInfo || inputAxisInfo)) {\n                var val = inputAxisInfo && inputAxisInfo.value;\n                if (val == null && !isIllegalPoint) {\n                    val = axis.pointToData(point);\n                }\n                val != null && processOnAxis(axisInfo, val, updaters, false, outputFinder);\n            }\n        });\n    });\n\n    // Process for linked axes.\n    var linkTriggers = {};\n    each$15(axesInfo, function (tarAxisInfo, tarKey) {\n        var linkGroup = tarAxisInfo.linkGroup;\n\n        // If axis has been triggered in the previous stage, it should not be triggered by link.\n        if (linkGroup && !showValueMap[tarKey]) {\n            each$15(linkGroup.axesInfo, function (srcAxisInfo, srcKey) {\n                var srcValItem = showValueMap[srcKey];\n                // If srcValItem exist, source axis is triggered, so link to target axis.\n                if (srcAxisInfo !== tarAxisInfo && srcValItem) {\n                    var val = srcValItem.value;\n                    linkGroup.mapper && (val = tarAxisInfo.axis.scale.parse(linkGroup.mapper(\n                        val, makeMapperParam(srcAxisInfo), makeMapperParam(tarAxisInfo)\n                    )));\n                    linkTriggers[tarAxisInfo.key] = val;\n                }\n            });\n        }\n    });\n    each$15(linkTriggers, function (val, tarKey) {\n        processOnAxis(axesInfo[tarKey], val, updaters, true, outputFinder);\n    });\n\n    updateModelActually(showValueMap, axesInfo, outputFinder);\n    dispatchTooltipActually(dataByCoordSys, point, payload, dispatchAction);\n    dispatchHighDownActually(axesInfo, dispatchAction, api);\n\n    return outputFinder;\n};\n\nfunction processOnAxis(axisInfo, newValue, updaters, dontSnap, outputFinder) {\n    var axis = axisInfo.axis;\n\n    if (axis.scale.isBlank() || !axis.containData(newValue)) {\n        return;\n    }\n\n    if (!axisInfo.involveSeries) {\n        updaters.showPointer(axisInfo, newValue);\n        return;\n    }\n\n    // Heavy calculation. So put it after axis.containData checking.\n    var payloadInfo = buildPayloadsBySeries(newValue, axisInfo);\n    var payloadBatch = payloadInfo.payloadBatch;\n    var snapToValue = payloadInfo.snapToValue;\n\n    // Fill content of event obj for echarts.connect.\n    // By defualt use the first involved series data as a sample to connect.\n    if (payloadBatch[0] && outputFinder.seriesIndex == null) {\n        extend(outputFinder, payloadBatch[0]);\n    }\n\n    // If no linkSource input, this process is for collecting link\n    // target, where snap should not be accepted.\n    if (!dontSnap && axisInfo.snap) {\n        if (axis.containData(snapToValue) && snapToValue != null) {\n            newValue = snapToValue;\n        }\n    }\n\n    updaters.showPointer(axisInfo, newValue, payloadBatch, outputFinder);\n    // Tooltip should always be snapToValue, otherwise there will be\n    // incorrect \"axis value ~ series value\" mapping displayed in tooltip.\n    updaters.showTooltip(axisInfo, payloadInfo, snapToValue);\n}\n\nfunction buildPayloadsBySeries(value, axisInfo) {\n    var axis = axisInfo.axis;\n    var dim = axis.dim;\n    var snapToValue = value;\n    var payloadBatch = [];\n    var minDist = Number.MAX_VALUE;\n    var minDiff = -1;\n\n    each$15(axisInfo.seriesModels, function (series, idx) {\n        var dataDim = series.getData().mapDimension(dim, true);\n        var seriesNestestValue;\n        var dataIndices;\n\n        if (series.getAxisTooltipData) {\n            var result = series.getAxisTooltipData(dataDim, value, axis);\n            dataIndices = result.dataIndices;\n            seriesNestestValue = result.nestestValue;\n        }\n        else {\n            dataIndices = series.getData().indicesOfNearest(\n                dataDim[0],\n                value,\n                // Add a threshold to avoid find the wrong dataIndex\n                // when data length is not same.\n                // false,\n                axis.type === 'category' ? 0.5 : null\n            );\n            if (!dataIndices.length) {\n                return;\n            }\n            seriesNestestValue = series.getData().get(dataDim[0], dataIndices[0]);\n        }\n\n        if (seriesNestestValue == null || !isFinite(seriesNestestValue)) {\n            return;\n        }\n\n        var diff = value - seriesNestestValue;\n        var dist = Math.abs(diff);\n        // Consider category case\n        if (dist <= minDist) {\n            if (dist < minDist || (diff >= 0 && minDiff < 0)) {\n                minDist = dist;\n                minDiff = diff;\n                snapToValue = seriesNestestValue;\n                payloadBatch.length = 0;\n            }\n            each$15(dataIndices, function (dataIndex) {\n                payloadBatch.push({\n                    seriesIndex: series.seriesIndex,\n                    dataIndexInside: dataIndex,\n                    dataIndex: series.getData().getRawIndex(dataIndex)\n                });\n            });\n        }\n    });\n\n    return {\n        payloadBatch: payloadBatch,\n        snapToValue: snapToValue\n    };\n}\n\nfunction showPointer(showValueMap, axisInfo, value, payloadBatch) {\n    showValueMap[axisInfo.key] = {value: value, payloadBatch: payloadBatch};\n}\n\nfunction showTooltip(dataByCoordSys, axisInfo, payloadInfo, value) {\n    var payloadBatch = payloadInfo.payloadBatch;\n    var axis = axisInfo.axis;\n    var axisModel = axis.model;\n    var axisPointerModel = axisInfo.axisPointerModel;\n\n    // If no data, do not create anything in dataByCoordSys,\n    // whose length will be used to judge whether dispatch action.\n    if (!axisInfo.triggerTooltip || !payloadBatch.length) {\n        return;\n    }\n\n    var coordSysModel = axisInfo.coordSys.model;\n    var coordSysKey = makeKey(coordSysModel);\n    var coordSysItem = dataByCoordSys.map[coordSysKey];\n    if (!coordSysItem) {\n        coordSysItem = dataByCoordSys.map[coordSysKey] = {\n            coordSysId: coordSysModel.id,\n            coordSysIndex: coordSysModel.componentIndex,\n            coordSysType: coordSysModel.type,\n            coordSysMainType: coordSysModel.mainType,\n            dataByAxis: []\n        };\n        dataByCoordSys.list.push(coordSysItem);\n    }\n\n    coordSysItem.dataByAxis.push({\n        axisDim: axis.dim,\n        axisIndex: axisModel.componentIndex,\n        axisType: axisModel.type,\n        axisId: axisModel.id,\n        value: value,\n        // Caustion: viewHelper.getValueLabel is actually on \"view stage\", which\n        // depends that all models have been updated. So it should not be performed\n        // here. Considering axisPointerModel used here is volatile, which is hard\n        // to be retrieve in TooltipView, we prepare parameters here.\n        valueLabelOpt: {\n            precision: axisPointerModel.get('label.precision'),\n            formatter: axisPointerModel.get('label.formatter')\n        },\n        seriesDataIndices: payloadBatch.slice()\n    });\n}\n\nfunction updateModelActually(showValueMap, axesInfo, outputFinder) {\n    var outputAxesInfo = outputFinder.axesInfo = [];\n    // Basic logic: If no 'show' required, 'hide' this axisPointer.\n    each$15(axesInfo, function (axisInfo, key) {\n        var option = axisInfo.axisPointerModel.option;\n        var valItem = showValueMap[key];\n\n        if (valItem) {\n            !axisInfo.useHandle && (option.status = 'show');\n            option.value = valItem.value;\n            // For label formatter param and highlight.\n            option.seriesDataIndices = (valItem.payloadBatch || []).slice();\n        }\n        // When always show (e.g., handle used), remain\n        // original value and status.\n        else {\n            // If hide, value still need to be set, consider\n            // click legend to toggle axis blank.\n            !axisInfo.useHandle && (option.status = 'hide');\n        }\n\n        // If status is 'hide', should be no info in payload.\n        option.status === 'show' && outputAxesInfo.push({\n            axisDim: axisInfo.axis.dim,\n            axisIndex: axisInfo.axis.model.componentIndex,\n            value: option.value\n        });\n    });\n}\n\nfunction dispatchTooltipActually(dataByCoordSys, point, payload, dispatchAction) {\n    // Basic logic: If no showTip required, hideTip will be dispatched.\n    if (illegalPoint(point) || !dataByCoordSys.list.length) {\n        dispatchAction({type: 'hideTip'});\n        return;\n    }\n\n    // In most case only one axis (or event one series is used). It is\n    // convinient to fetch payload.seriesIndex and payload.dataIndex\n    // dirtectly. So put the first seriesIndex and dataIndex of the first\n    // axis on the payload.\n    var sampleItem = ((dataByCoordSys.list[0].dataByAxis[0] || {}).seriesDataIndices || [])[0] || {};\n\n    dispatchAction({\n        type: 'showTip',\n        escapeConnect: true,\n        x: point[0],\n        y: point[1],\n        tooltipOption: payload.tooltipOption,\n        position: payload.position,\n        dataIndexInside: sampleItem.dataIndexInside,\n        dataIndex: sampleItem.dataIndex,\n        seriesIndex: sampleItem.seriesIndex,\n        dataByCoordSys: dataByCoordSys.list\n    });\n}\n\nfunction dispatchHighDownActually(axesInfo, dispatchAction, api) {\n    // FIXME\n    // highlight status modification shoule be a stage of main process?\n    // (Consider confilct (e.g., legend and axisPointer) and setOption)\n\n    var zr = api.getZr();\n    var highDownKey = 'axisPointerLastHighlights';\n    var lastHighlights = inner$6(zr)[highDownKey] || {};\n    var newHighlights = inner$6(zr)[highDownKey] = {};\n\n    // Update highlight/downplay status according to axisPointer model.\n    // Build hash map and remove duplicate incidentally.\n    each$15(axesInfo, function (axisInfo, key) {\n        var option = axisInfo.axisPointerModel.option;\n        option.status === 'show' && each$15(option.seriesDataIndices, function (batchItem) {\n            var key = batchItem.seriesIndex + ' | ' + batchItem.dataIndex;\n            newHighlights[key] = batchItem;\n        });\n    });\n\n    // Diff.\n    var toHighlight = [];\n    var toDownplay = [];\n    each$1(lastHighlights, function (batchItem, key) {\n        !newHighlights[key] && toDownplay.push(batchItem);\n    });\n    each$1(newHighlights, function (batchItem, key) {\n        !lastHighlights[key] && toHighlight.push(batchItem);\n    });\n\n    toDownplay.length && api.dispatchAction({\n        type: 'downplay', escapeConnect: true, batch: toDownplay\n    });\n    toHighlight.length && api.dispatchAction({\n        type: 'highlight', escapeConnect: true, batch: toHighlight\n    });\n}\n\nfunction findInputAxisInfo(inputAxesInfo, axisInfo) {\n    for (var i = 0; i < (inputAxesInfo || []).length; i++) {\n        var inputAxisInfo = inputAxesInfo[i];\n        if (axisInfo.axis.dim === inputAxisInfo.axisDim\n            && axisInfo.axis.model.componentIndex === inputAxisInfo.axisIndex\n        ) {\n            return inputAxisInfo;\n        }\n    }\n}\n\nfunction makeMapperParam(axisInfo) {\n    var axisModel = axisInfo.axis.model;\n    var item = {};\n    var dim = item.axisDim = axisInfo.axis.dim;\n    item.axisIndex = item[dim + 'AxisIndex'] = axisModel.componentIndex;\n    item.axisName = item[dim + 'AxisName'] = axisModel.name;\n    item.axisId = item[dim + 'AxisId'] = axisModel.id;\n    return item;\n}\n\nfunction illegalPoint(point) {\n    return !point || point[0] == null || isNaN(point[0]) || point[1] == null || isNaN(point[1]);\n}\n\nvar AxisPointerModel = extendComponentModel({\n\n    type: 'axisPointer',\n\n    coordSysAxesInfo: null,\n\n    defaultOption: {\n        // 'auto' means that show when triggered by tooltip or handle.\n        show: 'auto',\n        // 'click' | 'mousemove' | 'none'\n        triggerOn: null, // set default in AxisPonterView.js\n\n        zlevel: 0,\n        z: 50,\n\n        type: 'line',\n        // axispointer triggered by tootip determine snap automatically,\n        // see `modelHelper`.\n        snap: false,\n        triggerTooltip: true,\n\n        value: null,\n        status: null, // Init value depends on whether handle is used.\n\n        // [group0, group1, ...]\n        // Each group can be: {\n        //      mapper: function () {},\n        //      singleTooltip: 'multiple',  // 'multiple' or 'single'\n        //      xAxisId: ...,\n        //      yAxisName: ...,\n        //      angleAxisIndex: ...\n        // }\n        // mapper: can be ignored.\n        //      input: {axisInfo, value}\n        //      output: {axisInfo, value}\n        link: [],\n\n        // Do not set 'auto' here, otherwise global animation: false\n        // will not effect at this axispointer.\n        animation: null,\n        animationDurationUpdate: 200,\n\n        lineStyle: {\n            color: '#aaa',\n            width: 1,\n            type: 'solid'\n        },\n\n        shadowStyle: {\n            color: 'rgba(150,150,150,0.3)'\n        },\n\n        label: {\n            show: true,\n            formatter: null, // string | Function\n            precision: 'auto', // Or a number like 0, 1, 2 ...\n            margin: 3,\n            color: '#fff',\n            padding: [5, 7, 5, 7],\n            backgroundColor: 'auto', // default: axis line color\n            borderColor: null,\n            borderWidth: 0,\n            shadowBlur: 3,\n            shadowColor: '#aaa'\n            // Considering applicability, common style should\n            // better not have shadowOffset.\n            // shadowOffsetX: 0,\n            // shadowOffsetY: 2\n        },\n\n        handle: {\n            show: false,\n            icon: 'M10.7,11.9v-1.3H9.3v1.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4h1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7v-1.2h6.6z M13.3,22H6.7v-1.2h6.6z M13.3,19.6H6.7v-1.2h6.6z', // jshint ignore:line\n            size: 45,\n            // handle margin is from symbol center to axis, which is stable when circular move.\n            margin: 50,\n            // color: '#1b8bbd'\n            // color: '#2f4554'\n            color: '#333',\n            shadowBlur: 3,\n            shadowColor: '#aaa',\n            shadowOffsetX: 0,\n            shadowOffsetY: 2,\n\n            // For mobile performance\n            throttle: 40\n        }\n    }\n\n});\n\nvar inner$7 = makeInner();\nvar each$16 = each$1;\n\n/**\n * @param {string} key\n * @param {module:echarts/ExtensionAPI} api\n * @param {Function} handler\n *      param: {string} currTrigger\n *      param: {Array.<number>} point\n */\nfunction register(key, api, handler) {\n    if (env$1.node) {\n        return;\n    }\n\n    var zr = api.getZr();\n    inner$7(zr).records || (inner$7(zr).records = {});\n\n    initGlobalListeners(zr, api);\n\n    var record = inner$7(zr).records[key] || (inner$7(zr).records[key] = {});\n    record.handler = handler;\n}\n\nfunction initGlobalListeners(zr, api) {\n    if (inner$7(zr).initialized) {\n        return;\n    }\n\n    inner$7(zr).initialized = true;\n\n    useHandler('click', curry(doEnter, 'click'));\n    useHandler('mousemove', curry(doEnter, 'mousemove'));\n    // useHandler('mouseout', onLeave);\n    useHandler('globalout', onLeave);\n\n    function useHandler(eventType, cb) {\n        zr.on(eventType, function (e) {\n            var dis = makeDispatchAction(api);\n\n            each$16(inner$7(zr).records, function (record) {\n                record && cb(record, e, dis.dispatchAction);\n            });\n\n            dispatchTooltipFinally(dis.pendings, api);\n        });\n    }\n}\n\nfunction dispatchTooltipFinally(pendings, api) {\n    var showLen = pendings.showTip.length;\n    var hideLen = pendings.hideTip.length;\n\n    var actuallyPayload;\n    if (showLen) {\n        actuallyPayload = pendings.showTip[showLen - 1];\n    }\n    else if (hideLen) {\n        actuallyPayload = pendings.hideTip[hideLen - 1];\n    }\n    if (actuallyPayload) {\n        actuallyPayload.dispatchAction = null;\n        api.dispatchAction(actuallyPayload);\n    }\n}\n\nfunction onLeave(record, e, dispatchAction) {\n    record.handler('leave', null, dispatchAction);\n}\n\nfunction doEnter(currTrigger, record, e, dispatchAction) {\n    record.handler(currTrigger, e, dispatchAction);\n}\n\nfunction makeDispatchAction(api) {\n    var pendings = {\n        showTip: [],\n        hideTip: []\n    };\n    // FIXME\n    // better approach?\n    // 'showTip' and 'hideTip' can be triggered by axisPointer and tooltip,\n    // which may be conflict, (axisPointer call showTip but tooltip call hideTip);\n    // So we have to add \"final stage\" to merge those dispatched actions.\n    var dispatchAction = function (payload) {\n        var pendingList = pendings[payload.type];\n        if (pendingList) {\n            pendingList.push(payload);\n        }\n        else {\n            payload.dispatchAction = dispatchAction;\n            api.dispatchAction(payload);\n        }\n    };\n\n    return {\n        dispatchAction: dispatchAction,\n        pendings: pendings\n    };\n}\n\n/**\n * @param {string} key\n * @param {module:echarts/ExtensionAPI} api\n */\nfunction unregister(key, api) {\n    if (env$1.node) {\n        return;\n    }\n    var zr = api.getZr();\n    var record = (inner$7(zr).records || {})[key];\n    if (record) {\n        inner$7(zr).records[key] = null;\n    }\n}\n\nvar AxisPointerView = extendComponentView({\n\n    type: 'axisPointer',\n\n    render: function (globalAxisPointerModel, ecModel, api) {\n        var globalTooltipModel = ecModel.getComponent('tooltip');\n        var triggerOn = globalAxisPointerModel.get('triggerOn')\n            || (globalTooltipModel && globalTooltipModel.get('triggerOn') || 'mousemove|click');\n\n        // Register global listener in AxisPointerView to enable\n        // AxisPointerView to be independent to Tooltip.\n        register(\n            'axisPointer',\n            api,\n            function (currTrigger, e, dispatchAction) {\n                // If 'none', it is not controlled by mouse totally.\n                if (triggerOn !== 'none'\n                    && (currTrigger === 'leave' || triggerOn.indexOf(currTrigger) >= 0)\n                ) {\n                    dispatchAction({\n                        type: 'updateAxisPointer',\n                        currTrigger: currTrigger,\n                        x: e && e.offsetX,\n                        y: e && e.offsetY\n                    });\n                }\n            }\n        );\n    },\n\n    /**\n     * @override\n     */\n    remove: function (ecModel, api) {\n        unregister(api.getZr(), 'axisPointer');\n        AxisPointerView.superApply(this._model, 'remove', arguments);\n    },\n\n    /**\n     * @override\n     */\n    dispose: function (ecModel, api) {\n        unregister('axisPointer', api);\n        AxisPointerView.superApply(this._model, 'dispose', arguments);\n    }\n\n});\n\nvar inner$8 = makeInner();\nvar clone$4 = clone;\nvar bind$2 = bind;\n\n/**\n * Base axis pointer class in 2D.\n * Implemenents {module:echarts/component/axis/IAxisPointer}.\n */\nfunction BaseAxisPointer () {\n}\n\nBaseAxisPointer.prototype = {\n\n    /**\n     * @private\n     */\n    _group: null,\n\n    /**\n     * @private\n     */\n    _lastGraphicKey: null,\n\n    /**\n     * @private\n     */\n    _handle: null,\n\n    /**\n     * @private\n     */\n    _dragging: false,\n\n    /**\n     * @private\n     */\n    _lastValue: null,\n\n    /**\n     * @private\n     */\n    _lastStatus: null,\n\n    /**\n     * @private\n     */\n    _payloadInfo: null,\n\n    /**\n     * In px, arbitrary value. Do not set too small,\n     * no animation is ok for most cases.\n     * @protected\n     */\n    animationThreshold: 15,\n\n    /**\n     * @implement\n     */\n    render: function (axisModel, axisPointerModel, api, forceRender) {\n        var value = axisPointerModel.get('value');\n        var status = axisPointerModel.get('status');\n\n        // Bind them to `this`, not in closure, otherwise they will not\n        // be replaced when user calling setOption in not merge mode.\n        this._axisModel = axisModel;\n        this._axisPointerModel = axisPointerModel;\n        this._api = api;\n\n        // Optimize: `render` will be called repeatly during mouse move.\n        // So it is power consuming if performing `render` each time,\n        // especially on mobile device.\n        if (!forceRender\n            && this._lastValue === value\n            && this._lastStatus === status\n        ) {\n            return;\n        }\n        this._lastValue = value;\n        this._lastStatus = status;\n\n        var group = this._group;\n        var handle = this._handle;\n\n        if (!status || status === 'hide') {\n            // Do not clear here, for animation better.\n            group && group.hide();\n            handle && handle.hide();\n            return;\n        }\n        group && group.show();\n        handle && handle.show();\n\n        // Otherwise status is 'show'\n        var elOption = {};\n        this.makeElOption(elOption, value, axisModel, axisPointerModel, api);\n\n        // Enable change axis pointer type.\n        var graphicKey = elOption.graphicKey;\n        if (graphicKey !== this._lastGraphicKey) {\n            this.clear(api);\n        }\n        this._lastGraphicKey = graphicKey;\n\n        var moveAnimation = this._moveAnimation =\n            this.determineAnimation(axisModel, axisPointerModel);\n\n        if (!group) {\n            group = this._group = new Group();\n            this.createPointerEl(group, elOption, axisModel, axisPointerModel);\n            this.createLabelEl(group, elOption, axisModel, axisPointerModel);\n            api.getZr().add(group);\n        }\n        else {\n            var doUpdateProps = curry(updateProps$1, axisPointerModel, moveAnimation);\n            this.updatePointerEl(group, elOption, doUpdateProps, axisPointerModel);\n            this.updateLabelEl(group, elOption, doUpdateProps, axisPointerModel);\n        }\n\n        updateMandatoryProps(group, axisPointerModel, true);\n\n        this._renderHandle(value);\n    },\n\n    /**\n     * @implement\n     */\n    remove: function (api) {\n        this.clear(api);\n    },\n\n    /**\n     * @implement\n     */\n    dispose: function (api) {\n        this.clear(api);\n    },\n\n    /**\n     * @protected\n     */\n    determineAnimation: function (axisModel, axisPointerModel) {\n        var animation = axisPointerModel.get('animation');\n        var axis = axisModel.axis;\n        var isCategoryAxis = axis.type === 'category';\n        var useSnap = axisPointerModel.get('snap');\n\n        // Value axis without snap always do not snap.\n        if (!useSnap && !isCategoryAxis) {\n            return false;\n        }\n\n        if (animation === 'auto' || animation == null) {\n            var animationThreshold = this.animationThreshold;\n            if (isCategoryAxis && axis.getBandWidth() > animationThreshold) {\n                return true;\n            }\n\n            // It is important to auto animation when snap used. Consider if there is\n            // a dataZoom, animation will be disabled when too many points exist, while\n            // it will be enabled for better visual effect when little points exist.\n            if (useSnap) {\n                var seriesDataCount = getAxisInfo(axisModel).seriesDataCount;\n                var axisExtent = axis.getExtent();\n                // Approximate band width\n                return Math.abs(axisExtent[0] - axisExtent[1]) / seriesDataCount > animationThreshold;\n            }\n\n            return false;\n        }\n\n        return animation === true;\n    },\n\n    /**\n     * add {pointer, label, graphicKey} to elOption\n     * @protected\n     */\n    makeElOption: function (elOption, value, axisModel, axisPointerModel, api) {\n        // Shoule be implemenented by sub-class.\n    },\n\n    /**\n     * @protected\n     */\n    createPointerEl: function (group, elOption, axisModel, axisPointerModel) {\n        var pointerOption = elOption.pointer;\n        if (pointerOption) {\n            var pointerEl = inner$8(group).pointerEl = new graphic[pointerOption.type](\n                clone$4(elOption.pointer)\n            );\n            group.add(pointerEl);\n        }\n    },\n\n    /**\n     * @protected\n     */\n    createLabelEl: function (group, elOption, axisModel, axisPointerModel) {\n        if (elOption.label) {\n            var labelEl = inner$8(group).labelEl = new Rect(\n                clone$4(elOption.label)\n            );\n\n            group.add(labelEl);\n            updateLabelShowHide(labelEl, axisPointerModel);\n        }\n    },\n\n    /**\n     * @protected\n     */\n    updatePointerEl: function (group, elOption, updateProps$$1) {\n        var pointerEl = inner$8(group).pointerEl;\n        if (pointerEl) {\n            pointerEl.setStyle(elOption.pointer.style);\n            updateProps$$1(pointerEl, {shape: elOption.pointer.shape});\n        }\n    },\n\n    /**\n     * @protected\n     */\n    updateLabelEl: function (group, elOption, updateProps$$1, axisPointerModel) {\n        var labelEl = inner$8(group).labelEl;\n        if (labelEl) {\n            labelEl.setStyle(elOption.label.style);\n            updateProps$$1(labelEl, {\n                // Consider text length change in vertical axis, animation should\n                // be used on shape, otherwise the effect will be weird.\n                shape: elOption.label.shape,\n                position: elOption.label.position\n            });\n\n            updateLabelShowHide(labelEl, axisPointerModel);\n        }\n    },\n\n    /**\n     * @private\n     */\n    _renderHandle: function (value) {\n        if (this._dragging || !this.updateHandleTransform) {\n            return;\n        }\n\n        var axisPointerModel = this._axisPointerModel;\n        var zr = this._api.getZr();\n        var handle = this._handle;\n        var handleModel = axisPointerModel.getModel('handle');\n\n        var status = axisPointerModel.get('status');\n        if (!handleModel.get('show') || !status || status === 'hide') {\n            handle && zr.remove(handle);\n            this._handle = null;\n            return;\n        }\n\n        var isInit;\n        if (!this._handle) {\n            isInit = true;\n            handle = this._handle = createIcon(\n                handleModel.get('icon'),\n                {\n                    cursor: 'move',\n                    draggable: true,\n                    onmousemove: function (e) {\n                        // Fot mobile devicem, prevent screen slider on the button.\n                        stop(e.event);\n                    },\n                    onmousedown: bind$2(this._onHandleDragMove, this, 0, 0),\n                    drift: bind$2(this._onHandleDragMove, this),\n                    ondragend: bind$2(this._onHandleDragEnd, this)\n                }\n            );\n            zr.add(handle);\n        }\n\n        updateMandatoryProps(handle, axisPointerModel, false);\n\n        // update style\n        var includeStyles = [\n            'color', 'borderColor', 'borderWidth', 'opacity',\n            'shadowColor', 'shadowBlur', 'shadowOffsetX', 'shadowOffsetY'\n        ];\n        handle.setStyle(handleModel.getItemStyle(null, includeStyles));\n\n        // update position\n        var handleSize = handleModel.get('size');\n        if (!isArray(handleSize)) {\n            handleSize = [handleSize, handleSize];\n        }\n        handle.attr('scale', [handleSize[0] / 2, handleSize[1] / 2]);\n\n        createOrUpdate(\n            this,\n            '_doDispatchAxisPointer',\n            handleModel.get('throttle') || 0,\n            'fixRate'\n        );\n\n        this._moveHandleToValue(value, isInit);\n    },\n\n    /**\n     * @private\n     */\n    _moveHandleToValue: function (value, isInit) {\n        updateProps$1(\n            this._axisPointerModel,\n            !isInit && this._moveAnimation,\n            this._handle,\n            getHandleTransProps(this.getHandleTransform(\n                value, this._axisModel, this._axisPointerModel\n            ))\n        );\n    },\n\n    /**\n     * @private\n     */\n    _onHandleDragMove: function (dx, dy) {\n        var handle = this._handle;\n        if (!handle) {\n            return;\n        }\n\n        this._dragging = true;\n\n        // Persistent for throttle.\n        var trans = this.updateHandleTransform(\n            getHandleTransProps(handle),\n            [dx, dy],\n            this._axisModel,\n            this._axisPointerModel\n        );\n        this._payloadInfo = trans;\n\n        handle.stopAnimation();\n        handle.attr(getHandleTransProps(trans));\n        inner$8(handle).lastProp = null;\n\n        this._doDispatchAxisPointer();\n    },\n\n    /**\n     * Throttled method.\n     * @private\n     */\n    _doDispatchAxisPointer: function () {\n        var handle = this._handle;\n        if (!handle) {\n            return;\n        }\n\n        var payloadInfo = this._payloadInfo;\n        var axisModel = this._axisModel;\n        this._api.dispatchAction({\n            type: 'updateAxisPointer',\n            x: payloadInfo.cursorPoint[0],\n            y: payloadInfo.cursorPoint[1],\n            tooltipOption: payloadInfo.tooltipOption,\n            axesInfo: [{\n                axisDim: axisModel.axis.dim,\n                axisIndex: axisModel.componentIndex\n            }]\n        });\n    },\n\n    /**\n     * @private\n     */\n    _onHandleDragEnd: function (moveAnimation) {\n        this._dragging = false;\n        var handle = this._handle;\n        if (!handle) {\n            return;\n        }\n\n        var value = this._axisPointerModel.get('value');\n        // Consider snap or categroy axis, handle may be not consistent with\n        // axisPointer. So move handle to align the exact value position when\n        // drag ended.\n        this._moveHandleToValue(value);\n\n        // For the effect: tooltip will be shown when finger holding on handle\n        // button, and will be hidden after finger left handle button.\n        this._api.dispatchAction({\n            type: 'hideTip'\n        });\n    },\n\n    /**\n     * Should be implemenented by sub-class if support `handle`.\n     * @protected\n     * @param {number} value\n     * @param {module:echarts/model/Model} axisModel\n     * @param {module:echarts/model/Model} axisPointerModel\n     * @return {Object} {position: [x, y], rotation: 0}\n     */\n    getHandleTransform: null,\n\n    /**\n     * * Should be implemenented by sub-class if support `handle`.\n     * @protected\n     * @param {Object} transform {position, rotation}\n     * @param {Array.<number>} delta [dx, dy]\n     * @param {module:echarts/model/Model} axisModel\n     * @param {module:echarts/model/Model} axisPointerModel\n     * @return {Object} {position: [x, y], rotation: 0, cursorPoint: [x, y]}\n     */\n    updateHandleTransform: null,\n\n    /**\n     * @private\n     */\n    clear: function (api) {\n        this._lastValue = null;\n        this._lastStatus = null;\n\n        var zr = api.getZr();\n        var group = this._group;\n        var handle = this._handle;\n        if (zr && group) {\n            this._lastGraphicKey = null;\n            group && zr.remove(group);\n            handle && zr.remove(handle);\n            this._group = null;\n            this._handle = null;\n            this._payloadInfo = null;\n        }\n    },\n\n    /**\n     * @protected\n     */\n    doClear: function () {\n        // Implemented by sub-class if necessary.\n    },\n\n    /**\n     * @protected\n     * @param {Array.<number>} xy\n     * @param {Array.<number>} wh\n     * @param {number} [xDimIndex=0] or 1\n     */\n    buildLabel: function (xy, wh, xDimIndex) {\n        xDimIndex = xDimIndex || 0;\n        return {\n            x: xy[xDimIndex],\n            y: xy[1 - xDimIndex],\n            width: wh[xDimIndex],\n            height: wh[1 - xDimIndex]\n        };\n    }\n};\n\nBaseAxisPointer.prototype.constructor = BaseAxisPointer;\n\n\nfunction updateProps$1(animationModel, moveAnimation, el, props) {\n    // Animation optimize.\n    if (!propsEqual(inner$8(el).lastProp, props)) {\n        inner$8(el).lastProp = props;\n        moveAnimation\n            ? updateProps(el, props, animationModel)\n            : (el.stopAnimation(), el.attr(props));\n    }\n}\n\nfunction propsEqual(lastProps, newProps) {\n    if (isObject$1(lastProps) && isObject$1(newProps)) {\n        var equals = true;\n        each$1(newProps, function (item, key) {\n            equals = equals && propsEqual(lastProps[key], item);\n        });\n        return !!equals;\n    }\n    else {\n        return lastProps === newProps;\n    }\n}\n\nfunction updateLabelShowHide(labelEl, axisPointerModel) {\n    labelEl[axisPointerModel.get('label.show') ? 'show' : 'hide']();\n}\n\nfunction getHandleTransProps(trans) {\n    return {\n        position: trans.position.slice(),\n        rotation: trans.rotation || 0\n    };\n}\n\nfunction updateMandatoryProps(group, axisPointerModel, silent) {\n    var z = axisPointerModel.get('z');\n    var zlevel = axisPointerModel.get('zlevel');\n\n    group && group.traverse(function (el) {\n        if (el.type !== 'group') {\n            z != null && (el.z = z);\n            zlevel != null && (el.zlevel = zlevel);\n            el.silent = silent;\n        }\n    });\n}\n\nenableClassExtend(BaseAxisPointer);\n\n/**\n * @param {module:echarts/model/Model} axisPointerModel\n */\nfunction buildElStyle(axisPointerModel) {\n    var axisPointerType = axisPointerModel.get('type');\n    var styleModel = axisPointerModel.getModel(axisPointerType + 'Style');\n    var style;\n    if (axisPointerType === 'line') {\n        style = styleModel.getLineStyle();\n        style.fill = null;\n    }\n    else if (axisPointerType === 'shadow') {\n        style = styleModel.getAreaStyle();\n        style.stroke = null;\n    }\n    return style;\n}\n\n/**\n * @param {Function} labelPos {align, verticalAlign, position}\n */\nfunction buildLabelElOption(\n    elOption, axisModel, axisPointerModel, api, labelPos\n) {\n    var value = axisPointerModel.get('value');\n    var text = getValueLabel(\n        value, axisModel.axis, axisModel.ecModel,\n        axisPointerModel.get('seriesDataIndices'),\n        {\n            precision: axisPointerModel.get('label.precision'),\n            formatter: axisPointerModel.get('label.formatter')\n        }\n    );\n    var labelModel = axisPointerModel.getModel('label');\n    var paddings = normalizeCssArray$1(labelModel.get('padding') || 0);\n\n    var font = labelModel.getFont();\n    var textRect = getBoundingRect(text, font);\n\n    var position = labelPos.position;\n    var width = textRect.width + paddings[1] + paddings[3];\n    var height = textRect.height + paddings[0] + paddings[2];\n\n    // Adjust by align.\n    var align = labelPos.align;\n    align === 'right' && (position[0] -= width);\n    align === 'center' && (position[0] -= width / 2);\n    var verticalAlign = labelPos.verticalAlign;\n    verticalAlign === 'bottom' && (position[1] -= height);\n    verticalAlign === 'middle' && (position[1] -= height / 2);\n\n    // Not overflow ec container\n    confineInContainer(position, width, height, api);\n\n    var bgColor = labelModel.get('backgroundColor');\n    if (!bgColor || bgColor === 'auto') {\n        bgColor = axisModel.get('axisLine.lineStyle.color');\n    }\n\n    elOption.label = {\n        shape: {x: 0, y: 0, width: width, height: height, r: labelModel.get('borderRadius')},\n        position: position.slice(),\n        // TODO: rich\n        style: {\n            text: text,\n            textFont: font,\n            textFill: labelModel.getTextColor(),\n            textPosition: 'inside',\n            fill: bgColor,\n            stroke: labelModel.get('borderColor') || 'transparent',\n            lineWidth: labelModel.get('borderWidth') || 0,\n            shadowBlur: labelModel.get('shadowBlur'),\n            shadowColor: labelModel.get('shadowColor'),\n            shadowOffsetX: labelModel.get('shadowOffsetX'),\n            shadowOffsetY: labelModel.get('shadowOffsetY')\n        },\n        // Lable should be over axisPointer.\n        z2: 10\n    };\n}\n\n// Do not overflow ec container\nfunction confineInContainer(position, width, height, api) {\n    var viewWidth = api.getWidth();\n    var viewHeight = api.getHeight();\n    position[0] = Math.min(position[0] + width, viewWidth) - width;\n    position[1] = Math.min(position[1] + height, viewHeight) - height;\n    position[0] = Math.max(position[0], 0);\n    position[1] = Math.max(position[1], 0);\n}\n\n/**\n * @param {number} value\n * @param {module:echarts/coord/Axis} axis\n * @param {module:echarts/model/Global} ecModel\n * @param {Object} opt\n * @param {Array.<Object>} seriesDataIndices\n * @param {number|string} opt.precision 'auto' or a number\n * @param {string|Function} opt.formatter label formatter\n */\nfunction getValueLabel(value, axis, ecModel, seriesDataIndices, opt) {\n    var text = axis.scale.getLabel(\n        // If `precision` is set, width can be fixed (like '12.00500'), which\n        // helps to debounce when when moving label.\n        value, {precision: opt.precision}\n    );\n    var formatter = opt.formatter;\n\n    if (formatter) {\n        var params = {\n            value: getAxisRawValue(axis, value),\n            seriesData: []\n        };\n        each$1(seriesDataIndices, function (idxItem) {\n            var series = ecModel.getSeriesByIndex(idxItem.seriesIndex);\n            var dataIndex = idxItem.dataIndexInside;\n            var dataParams = series && series.getDataParams(dataIndex);\n            dataParams && params.seriesData.push(dataParams);\n        });\n\n        if (isString(formatter)) {\n            text = formatter.replace('{value}', text);\n        }\n        else if (isFunction$1(formatter)) {\n            text = formatter(params);\n        }\n    }\n\n    return text;\n}\n\n/**\n * @param {module:echarts/coord/Axis} axis\n * @param {number} value\n * @param {Object} layoutInfo {\n *  rotation, position, labelOffset, labelDirection, labelMargin\n * }\n */\nfunction getTransformedPosition (axis, value, layoutInfo) {\n    var transform = create$1();\n    rotate(transform, transform, layoutInfo.rotation);\n    translate(transform, transform, layoutInfo.position);\n\n    return applyTransform$1([\n        axis.dataToCoord(value),\n        (layoutInfo.labelOffset || 0)\n            + (layoutInfo.labelDirection || 1) * (layoutInfo.labelMargin || 0)\n    ], transform);\n}\n\nfunction buildCartesianSingleLabelElOption(\n    value, elOption, layoutInfo, axisModel, axisPointerModel, api\n) {\n    var textLayout = AxisBuilder.innerTextLayout(\n        layoutInfo.rotation, 0, layoutInfo.labelDirection\n    );\n    layoutInfo.labelMargin = axisPointerModel.get('label.margin');\n    buildLabelElOption(elOption, axisModel, axisPointerModel, api, {\n        position: getTransformedPosition(axisModel.axis, value, layoutInfo),\n        align: textLayout.textAlign,\n        verticalAlign: textLayout.textVerticalAlign\n    });\n}\n\n/**\n * @param {Array.<number>} p1\n * @param {Array.<number>} p2\n * @param {number} [xDimIndex=0] or 1\n */\nfunction makeLineShape(p1, p2, xDimIndex) {\n    xDimIndex = xDimIndex || 0;\n    return {\n        x1: p1[xDimIndex],\n        y1: p1[1 - xDimIndex],\n        x2: p2[xDimIndex],\n        y2: p2[1 - xDimIndex]\n    };\n}\n\n/**\n * @param {Array.<number>} xy\n * @param {Array.<number>} wh\n * @param {number} [xDimIndex=0] or 1\n */\nfunction makeRectShape(xy, wh, xDimIndex) {\n    xDimIndex = xDimIndex || 0;\n    return {\n        x: xy[xDimIndex],\n        y: xy[1 - xDimIndex],\n        width: wh[xDimIndex],\n        height: wh[1 - xDimIndex]\n    };\n}\n\nfunction makeSectorShape(cx, cy, r0, r, startAngle, endAngle) {\n    return {\n        cx: cx,\n        cy: cy,\n        r0: r0,\n        r: r,\n        startAngle: startAngle,\n        endAngle: endAngle,\n        clockwise: true\n    };\n}\n\nvar CartesianAxisPointer = BaseAxisPointer.extend({\n\n    /**\n     * @override\n     */\n    makeElOption: function (elOption, value, axisModel, axisPointerModel, api) {\n        var axis = axisModel.axis;\n        var grid = axis.grid;\n        var axisPointerType = axisPointerModel.get('type');\n        var otherExtent = getCartesian(grid, axis).getOtherAxis(axis).getGlobalExtent();\n        var pixelValue = axis.toGlobalCoord(axis.dataToCoord(value, true));\n\n        if (axisPointerType && axisPointerType !== 'none') {\n            var elStyle = buildElStyle(axisPointerModel);\n            var pointerOption = pointerShapeBuilder[axisPointerType](\n                axis, pixelValue, otherExtent, elStyle\n            );\n            pointerOption.style = elStyle;\n            elOption.graphicKey = pointerOption.type;\n            elOption.pointer = pointerOption;\n        }\n\n        var layoutInfo = layout$1(grid.model, axisModel);\n        buildCartesianSingleLabelElOption(\n            value, elOption, layoutInfo, axisModel, axisPointerModel, api\n        );\n    },\n\n    /**\n     * @override\n     */\n    getHandleTransform: function (value, axisModel, axisPointerModel) {\n        var layoutInfo = layout$1(axisModel.axis.grid.model, axisModel, {\n            labelInside: false\n        });\n        layoutInfo.labelMargin = axisPointerModel.get('handle.margin');\n        return {\n            position: getTransformedPosition(axisModel.axis, value, layoutInfo),\n            rotation: layoutInfo.rotation + (layoutInfo.labelDirection < 0 ? Math.PI : 0)\n        };\n    },\n\n    /**\n     * @override\n     */\n    updateHandleTransform: function (transform, delta, axisModel, axisPointerModel) {\n        var axis = axisModel.axis;\n        var grid = axis.grid;\n        var axisExtent = axis.getGlobalExtent(true);\n        var otherExtent = getCartesian(grid, axis).getOtherAxis(axis).getGlobalExtent();\n        var dimIndex = axis.dim === 'x' ? 0 : 1;\n\n        var currPosition = transform.position;\n        currPosition[dimIndex] += delta[dimIndex];\n        currPosition[dimIndex] = Math.min(axisExtent[1], currPosition[dimIndex]);\n        currPosition[dimIndex] = Math.max(axisExtent[0], currPosition[dimIndex]);\n\n        var cursorOtherValue = (otherExtent[1] + otherExtent[0]) / 2;\n        var cursorPoint = [cursorOtherValue, cursorOtherValue];\n        cursorPoint[dimIndex] = currPosition[dimIndex];\n\n        // Make tooltip do not overlap axisPointer and in the middle of the grid.\n        var tooltipOptions = [{verticalAlign: 'middle'}, {align: 'center'}];\n\n        return {\n            position: currPosition,\n            rotation: transform.rotation,\n            cursorPoint: cursorPoint,\n            tooltipOption: tooltipOptions[dimIndex]\n        };\n    }\n\n});\n\nfunction getCartesian(grid, axis) {\n    var opt = {};\n    opt[axis.dim + 'AxisIndex'] = axis.index;\n    return grid.getCartesian(opt);\n}\n\nvar pointerShapeBuilder = {\n\n    line: function (axis, pixelValue, otherExtent, elStyle) {\n        var targetShape = makeLineShape(\n            [pixelValue, otherExtent[0]],\n            [pixelValue, otherExtent[1]],\n            getAxisDimIndex(axis)\n        );\n        subPixelOptimizeLine({\n            shape: targetShape,\n            style: elStyle\n        });\n        return {\n            type: 'Line',\n            shape: targetShape\n        };\n    },\n\n    shadow: function (axis, pixelValue, otherExtent, elStyle) {\n        var bandWidth = axis.getBandWidth();\n        var span = otherExtent[1] - otherExtent[0];\n        return {\n            type: 'Rect',\n            shape: makeRectShape(\n                [pixelValue - bandWidth / 2, otherExtent[0]],\n                [bandWidth, span],\n                getAxisDimIndex(axis)\n            )\n        };\n    }\n};\n\nfunction getAxisDimIndex(axis) {\n    return axis.dim === 'x' ? 0 : 1;\n}\n\nAxisView.registerAxisPointerClass('CartesianAxisPointer', CartesianAxisPointer);\n\n// CartesianAxisPointer is not supposed to be required here. But consider\n// echarts.simple.js and online build tooltip, which only require gridSimple,\n// CartesianAxisPointer should be able to required somewhere.\nregisterPreprocessor(function (option) {\n    // Always has a global axisPointerModel for default setting.\n    if (option) {\n        (!option.axisPointer || option.axisPointer.length === 0)\n            && (option.axisPointer = {});\n\n        var link = option.axisPointer.link;\n        // Normalize to array to avoid object mergin. But if link\n        // is not set, remain null/undefined, otherwise it will\n        // override existent link setting.\n        if (link && !isArray(link)) {\n            option.axisPointer.link = [link];\n        }\n    }\n});\n\n// This process should proformed after coordinate systems created\n// and series data processed. So put it on statistic processing stage.\nregisterProcessor(PRIORITY.PROCESSOR.STATISTIC, function (ecModel, api) {\n    // Build axisPointerModel, mergin tooltip.axisPointer model for each axis.\n    // allAxesInfo should be updated when setOption performed.\n    ecModel.getComponent('axisPointer').coordSysAxesInfo\n        = collect(ecModel, api);\n});\n\n// Broadcast to all views.\nregisterAction({\n    type: 'updateAxisPointer',\n    event: 'updateAxisPointer',\n    update: ':updateAxisPointer'\n}, axisTrigger);\n\nvar XY = ['x', 'y'];\nvar WH = ['width', 'height'];\n\nvar SingleAxisPointer = BaseAxisPointer.extend({\n\n    /**\n     * @override\n     */\n    makeElOption: function (elOption, value, axisModel, axisPointerModel, api) {\n        var axis = axisModel.axis;\n        var coordSys = axis.coordinateSystem;\n        var otherExtent = getGlobalExtent(coordSys, 1 - getPointDimIndex(axis));\n        var pixelValue = coordSys.dataToPoint(value)[0];\n\n        var axisPointerType = axisPointerModel.get('type');\n        if (axisPointerType && axisPointerType !== 'none') {\n            var elStyle = buildElStyle(axisPointerModel);\n            var pointerOption = pointerShapeBuilder$1[axisPointerType](\n                axis, pixelValue, otherExtent, elStyle\n            );\n            pointerOption.style = elStyle;\n\n            elOption.graphicKey = pointerOption.type;\n            elOption.pointer = pointerOption;\n        }\n\n        var layoutInfo = layout$2(axisModel);\n        buildCartesianSingleLabelElOption(\n            value, elOption, layoutInfo, axisModel, axisPointerModel, api\n        );\n    },\n\n    /**\n     * @override\n     */\n    getHandleTransform: function (value, axisModel, axisPointerModel) {\n        var layoutInfo = layout$2(axisModel, {labelInside: false});\n        layoutInfo.labelMargin = axisPointerModel.get('handle.margin');\n        return {\n            position: getTransformedPosition(axisModel.axis, value, layoutInfo),\n            rotation: layoutInfo.rotation + (layoutInfo.labelDirection < 0 ? Math.PI : 0)\n        };\n    },\n\n    /**\n     * @override\n     */\n    updateHandleTransform: function (transform, delta, axisModel, axisPointerModel) {\n        var axis = axisModel.axis;\n        var coordSys = axis.coordinateSystem;\n        var dimIndex = getPointDimIndex(axis);\n        var axisExtent = getGlobalExtent(coordSys, dimIndex);\n        var currPosition = transform.position;\n        currPosition[dimIndex] += delta[dimIndex];\n        currPosition[dimIndex] = Math.min(axisExtent[1], currPosition[dimIndex]);\n        currPosition[dimIndex] = Math.max(axisExtent[0], currPosition[dimIndex]);\n        var otherExtent = getGlobalExtent(coordSys, 1 - dimIndex);\n        var cursorOtherValue = (otherExtent[1] + otherExtent[0]) / 2;\n        var cursorPoint = [cursorOtherValue, cursorOtherValue];\n        cursorPoint[dimIndex] = currPosition[dimIndex];\n\n        return {\n            position: currPosition,\n            rotation: transform.rotation,\n            cursorPoint: cursorPoint,\n            tooltipOption: {\n                verticalAlign: 'middle'\n            }\n        };\n    }\n});\n\nvar pointerShapeBuilder$1 = {\n\n    line: function (axis, pixelValue, otherExtent, elStyle) {\n        var targetShape = makeLineShape(\n            [pixelValue, otherExtent[0]],\n            [pixelValue, otherExtent[1]],\n            getPointDimIndex(axis)\n        );\n        subPixelOptimizeLine({\n            shape: targetShape,\n            style: elStyle\n        });\n        return {\n            type: 'Line',\n            shape: targetShape\n        };\n    },\n\n    shadow: function (axis, pixelValue, otherExtent, elStyle) {\n        var bandWidth = axis.getBandWidth();\n        var span = otherExtent[1] - otherExtent[0];\n        return {\n            type: 'Rect',\n            shape: makeRectShape(\n                [pixelValue - bandWidth / 2, otherExtent[0]],\n                [bandWidth, span],\n                getPointDimIndex(axis)\n            )\n        };\n    }\n};\n\nfunction getPointDimIndex(axis) {\n    return axis.isHorizontal() ? 0 : 1;\n}\n\nfunction getGlobalExtent(coordSys, dimIndex) {\n    var rect = coordSys.getRect();\n    return [rect[XY[dimIndex]], rect[XY[dimIndex]] + rect[WH[dimIndex]]];\n}\n\nAxisView.registerAxisPointerClass('SingleAxisPointer', SingleAxisPointer);\n\nextendComponentView({\n    type: 'single'\n});\n\n/**\n * @file  Define the themeRiver view's series model\n * @author Deqing Li(annong035@gmail.com)\n */\n\nvar DATA_NAME_INDEX = 2;\n\nvar ThemeRiverSeries = SeriesModel.extend({\n\n    type: 'series.themeRiver',\n\n    dependencies: ['singleAxis'],\n\n    /**\n     * @readOnly\n     * @type {module:zrender/core/util#HashMap}\n     */\n    nameMap: null,\n\n    /**\n     * @override\n     */\n    init: function (option) {\n        ThemeRiverSeries.superApply(this, 'init', arguments);\n\n        // Put this function here is for the sake of consistency of code style.\n        // Enable legend selection for each data item\n        // Use a function instead of direct access because data reference may changed\n        this.legendDataProvider = function () {\n            return this.getRawData();\n        };\n    },\n\n    /**\n     * If there is no value of a certain point in the time for some event,set it value to 0.\n     *\n     * @param {Array} data  initial data in the option\n     * @return {Array}\n     */\n    fixData: function (data) {\n        var rawDataLength = data.length;\n\n        // grouped data by name\n        var dataByName = nest()\n            .key(function (dataItem) {\n                return dataItem[2];\n            })\n            .entries(data);\n\n        // data group in each layer\n        var layData = map(dataByName, function (d) {\n            return {\n                name: d.key,\n                dataList: d.values\n            };\n        });\n\n        var layerNum = layData.length;\n        var largestLayer = -1;\n        var index = -1;\n        for (var i = 0; i < layerNum; ++i) {\n            var len = layData[i].dataList.length;\n            if (len > largestLayer) {\n                largestLayer = len;\n                index = i;\n            }\n        }\n\n        for (var k = 0; k < layerNum; ++k) {\n            if (k === index) {\n                continue;\n            }\n            var name = layData[k].name;\n            for (var j = 0; j < largestLayer; ++j) {\n                var timeValue = layData[index].dataList[j][0];\n                var length = layData[k].dataList.length;\n                var keyIndex = -1;\n                for (var l = 0; l < length; ++l) {\n                    var value = layData[k].dataList[l][0];\n                    if (value === timeValue) {\n                        keyIndex = l;\n                        break;\n                    }\n                }\n                if (keyIndex === -1) {\n                    data[rawDataLength] = [];\n                    data[rawDataLength][0] = timeValue;\n                    data[rawDataLength][1] = 0;\n                    data[rawDataLength][2] = name;\n                    rawDataLength++;\n\n                }\n            }\n        }\n        return data;\n    },\n\n    /**\n     * @override\n     * @param  {Object} option  the initial option that user gived\n     * @param  {module:echarts/model/Model} ecModel  the model object for themeRiver option\n     * @return {module:echarts/data/List}\n     */\n    getInitialData: function (option, ecModel) {\n\n        var singleAxisModel = ecModel.queryComponents({\n            mainType: 'singleAxis',\n            index: this.get('singleAxisIndex'),\n            id: this.get('singleAxisId')\n        })[0];\n\n        var axisType = singleAxisModel.get('type');\n\n        // filter the data item with the value of label is undefined\n        var filterData = filter(option.data, function (dataItem) {\n            return dataItem[2] !== undefined;\n        });\n\n        // ??? TODO design a stage to transfer data for themeRiver and lines?\n        var data = this.fixData(filterData || []);\n        var nameList = [];\n        var nameMap = this.nameMap = createHashMap();\n        var count = 0;\n\n        for (var i = 0; i < data.length; ++i) {\n            nameList.push(data[i][DATA_NAME_INDEX]);\n            if (!nameMap.get(data[i][DATA_NAME_INDEX])) {\n                nameMap.set(data[i][DATA_NAME_INDEX], count);\n                count++;\n            }\n        }\n\n        var dimensionsInfo = createDimensions(data, {\n            coordDimensions: ['single'],\n            dimensionsDefine: [\n                {\n                    name: 'time',\n                    type: getDimensionTypeByAxis(axisType)\n                },\n                {\n                    name: 'value',\n                    type: 'float'\n                },\n                {\n                    name: 'name',\n                    type: 'ordinal'\n                }\n            ],\n            encodeDefine: {\n                single: 0,\n                value: 1,\n                itemName: 2\n            }\n        });\n\n        var list = new List(dimensionsInfo, this);\n        list.initData(data);\n\n        return list;\n    },\n\n    /**\n     * The raw data is divided into multiple layers and each layer\n     *     has same name.\n     *\n     * @return {Array.<Array.<number>>}\n     */\n    getLayerSeries: function () {\n        var data = this.getData();\n        var lenCount = data.count();\n        var indexArr = [];\n\n        for (var i = 0; i < lenCount; ++i) {\n            indexArr[i] = i;\n        }\n        // data group by name\n        var dataByName = nest()\n            .key(function (index) {\n                return data.get('name', index);\n            })\n            .entries(indexArr);\n\n        var layerSeries = map(dataByName, function (d) {\n            return {\n                name: d.key,\n                indices: d.values\n            };\n        });\n\n        var timeDim = data.mapDimension('single');\n\n        for (var j = 0; j < layerSeries.length; ++j) {\n            layerSeries[j].indices.sort(comparer);\n        }\n\n        function comparer(index1, index2) {\n            return data.get(timeDim, index1) - data.get(timeDim, index2);\n        }\n\n        return layerSeries;\n    },\n\n    /**\n     * Get data indices for show tooltip content\n     *\n     * @param {Array.<string>|string} dim  single coordinate dimension\n     * @param {number} value axis value\n     * @param {module:echarts/coord/single/SingleAxis} baseAxis  single Axis used\n     *     the themeRiver.\n     * @return {Object} {dataIndices, nestestValue}\n     */\n    getAxisTooltipData: function (dim, value, baseAxis) {\n        if (!isArray(dim)) {\n            dim = dim ? [dim] : [];\n        }\n\n        var data = this.getData();\n        var layerSeries = this.getLayerSeries();\n        var indices = [];\n        var layerNum = layerSeries.length;\n        var nestestValue;\n\n        for (var i = 0; i < layerNum; ++i) {\n            var minDist = Number.MAX_VALUE;\n            var nearestIdx = -1;\n            var pointNum = layerSeries[i].indices.length;\n            for (var j = 0; j < pointNum; ++j) {\n                var theValue = data.get(dim[0], layerSeries[i].indices[j]);\n                var dist = Math.abs(theValue - value);\n                if (dist <= minDist) {\n                    nestestValue = theValue;\n                    minDist = dist;\n                    nearestIdx = layerSeries[i].indices[j];\n                }\n            }\n            indices.push(nearestIdx);\n        }\n\n        return {dataIndices: indices, nestestValue: nestestValue};\n    },\n\n    /**\n     * @override\n     * @param {number} dataIndex  index of data\n     */\n    formatTooltip: function (dataIndex) {\n        var data = this.getData();\n        var htmlName = data.getName(dataIndex);\n        var htmlValue = data.get(data.mapDimension('value'), dataIndex);\n        if (isNaN(htmlValue) || htmlValue == null) {\n            htmlValue = '-';\n        }\n        return encodeHTML(htmlName + ' : ' + htmlValue);\n    },\n\n    defaultOption: {\n        zlevel: 0,\n        z: 2,\n\n        coordinateSystem: 'singleAxis',\n\n        // gap in axis's orthogonal orientation\n        boundaryGap: ['10%', '10%'],\n\n        // legendHoverLink: true,\n\n        singleAxisIndex: 0,\n\n        animationEasing: 'linear',\n\n        label: {\n            margin: 4,\n            textAlign: 'right',\n            show: true,\n            position: 'left',\n            color: '#000',\n            fontSize: 11\n        },\n\n        emphasis: {\n            label: {\n                show: true\n            }\n        }\n    }\n});\n\n/**\n * @file  The file used to draw themeRiver view\n * @author  Deqing Li(annong035@gmail.com)\n */\n\nextendChartView({\n\n    type: 'themeRiver',\n\n    init: function () {\n        this._layers = [];\n    },\n\n    render: function (seriesModel, ecModel, api) {\n        var data = seriesModel.getData();\n\n        var group = this.group;\n\n        var layerSeries = seriesModel.getLayerSeries();\n\n        var layoutInfo = data.getLayout('layoutInfo');\n        var rect = layoutInfo.rect;\n        var boundaryGap = layoutInfo.boundaryGap;\n\n        group.attr('position', [0, rect.y + boundaryGap[0]]);\n\n        function keyGetter(item) {\n            return item.name;\n        }\n        var dataDiffer = new DataDiffer(\n            this._layersSeries || [], layerSeries,\n            keyGetter, keyGetter\n        );\n\n        var newLayersGroups = {};\n\n        dataDiffer\n            .add(bind(process, this, 'add'))\n            .update(bind(process, this, 'update'))\n            .remove(bind(process, this, 'remove'))\n            .execute();\n\n        function process(status, idx, oldIdx) {\n            var oldLayersGroups = this._layers;\n            if (status === 'remove') {\n                group.remove(oldLayersGroups[idx]);\n                return;\n            }\n            var points0 = [];\n            var points1 = [];\n            var color;\n            var indices = layerSeries[idx].indices;\n            for (var j = 0; j < indices.length; j++) {\n                var layout = data.getItemLayout(indices[j]);\n                var x = layout.x;\n                var y0 = layout.y0;\n                var y = layout.y;\n\n                points0.push([x, y0]);\n                points1.push([x, y0 + y]);\n\n                color = data.getItemVisual(indices[j], 'color');\n            }\n\n            var polygon;\n            var text;\n            var textLayout = data.getItemLayout(indices[0]);\n            var itemModel = data.getItemModel(indices[j - 1]);\n            var labelModel = itemModel.getModel('label');\n            var margin = labelModel.get('margin');\n            if (status === 'add') {\n                var layerGroup = newLayersGroups[idx] = new Group();\n                polygon = new Polygon$1({\n                    shape: {\n                        points: points0,\n                        stackedOnPoints: points1,\n                        smooth: 0.4,\n                        stackedOnSmooth: 0.4,\n                        smoothConstraint: false\n                    },\n                    z2: 0\n                });\n                text = new Text({\n                    style: {\n                        x: textLayout.x - margin,\n                        y: textLayout.y0 + textLayout.y / 2\n                    }\n                });\n                layerGroup.add(polygon);\n                layerGroup.add(text);\n                group.add(layerGroup);\n\n                polygon.setClipPath(createGridClipShape$3(polygon.getBoundingRect(), seriesModel, function () {\n                    polygon.removeClipPath();\n                }));\n            }\n            else {\n                var layerGroup = oldLayersGroups[oldIdx];\n                polygon = layerGroup.childAt(0);\n                text = layerGroup.childAt(1);\n                group.add(layerGroup);\n\n                newLayersGroups[idx] = layerGroup;\n\n                updateProps(polygon, {\n                    shape: {\n                        points: points0,\n                        stackedOnPoints: points1\n                    }\n                }, seriesModel);\n\n                updateProps(text, {\n                    style: {\n                        x: textLayout.x - margin,\n                        y: textLayout.y0 + textLayout.y / 2\n                    }\n                }, seriesModel);\n            }\n\n            var hoverItemStyleModel = itemModel.getModel('emphasis.itemStyle');\n            var itemStyleModel = itemModel.getModel('itemStyle');\n\n            setTextStyle(text.style, labelModel, {\n                text: labelModel.get('show')\n                    ? seriesModel.getFormattedLabel(indices[j - 1], 'normal')\n                        || data.getName(indices[j - 1])\n                    : null,\n                textVerticalAlign: 'middle'\n            });\n\n            polygon.setStyle(extend({\n                fill: color\n            }, itemStyleModel.getItemStyle(['color'])));\n\n            setHoverStyle(polygon, hoverItemStyleModel.getItemStyle());\n        }\n\n        this._layersSeries = layerSeries;\n        this._layers = newLayersGroups;\n    },\n\n    dispose: function () {}\n});\n\n// add animation to the view\nfunction createGridClipShape$3(rect, seriesModel, cb) {\n    var rectEl = new Rect({\n        shape: {\n            x: rect.x - 10,\n            y: rect.y - 10,\n            width: 0,\n            height: rect.height + 20\n        }\n    });\n    initProps(rectEl, {\n        shape: {\n            width: rect.width + 20,\n            height: rect.height + 20\n        }\n    }, seriesModel, cb);\n\n    return rectEl;\n}\n\n/**\n * @file  Using layout algorithm transform the raw data to layout information.\n * @author Deqing Li(annong035@gmail.com)\n */\n\nvar themeRiverLayout = function (ecModel, api) {\n\n    ecModel.eachSeriesByType('themeRiver', function (seriesModel) {\n\n        var data = seriesModel.getData();\n\n        var single = seriesModel.coordinateSystem;\n\n        var layoutInfo = {};\n\n        // use the axis boundingRect for view\n        var rect = single.getRect();\n\n        layoutInfo.rect = rect;\n\n        var boundaryGap = seriesModel.get('boundaryGap');\n\n        var axis = single.getAxis();\n\n        layoutInfo.boundaryGap = boundaryGap;\n\n        if (axis.orient === 'horizontal') {\n            boundaryGap[0] = parsePercent$1(boundaryGap[0], rect.height);\n            boundaryGap[1] = parsePercent$1(boundaryGap[1], rect.height);\n            var height = rect.height - boundaryGap[0] - boundaryGap[1];\n            themeRiverLayout$1(data, seriesModel, height);\n        }\n        else {\n            boundaryGap[0] = parsePercent$1(boundaryGap[0], rect.width);\n            boundaryGap[1] = parsePercent$1(boundaryGap[1], rect.width);\n            var width = rect.width - boundaryGap[0] - boundaryGap[1];\n            themeRiverLayout$1(data, seriesModel, width);\n        }\n\n        data.setLayout('layoutInfo', layoutInfo);\n    });\n};\n\n/**\n * The layout information about themeriver\n *\n * @param {module:echarts/data/List} data  data in the series\n * @param {module:echarts/model/Series} seriesModel  the model object of themeRiver series\n * @param {number} height  value used to compute every series height\n */\nfunction themeRiverLayout$1(data, seriesModel, height) {\n    if (!data.count()) {\n        return;\n    }\n    var coordSys = seriesModel.coordinateSystem;\n    // the data in each layer are organized into a series.\n    var layerSeries = seriesModel.getLayerSeries();\n\n    // the points in each layer.\n    var timeDim = data.mapDimension('single');\n    var valueDim = data.mapDimension('value');\n    var layerPoints = map(layerSeries, function (singleLayer) {\n        return map(singleLayer.indices, function (idx) {\n            var pt = coordSys.dataToPoint(data.get(timeDim, idx));\n            pt[1] = data.get(valueDim, idx);\n            return pt;\n        });\n    });\n\n    var base = computeBaseline(layerPoints);\n    var baseLine = base.y0;\n    var ky = height / base.max;\n\n    // set layout information for each item.\n    var n = layerSeries.length;\n    var m = layerSeries[0].indices.length;\n    var baseY0;\n    for (var j = 0; j < m; ++j) {\n        baseY0 = baseLine[j] * ky;\n        data.setItemLayout(layerSeries[0].indices[j], {\n            layerIndex: 0,\n            x: layerPoints[0][j][0],\n            y0: baseY0,\n            y: layerPoints[0][j][1] * ky\n        });\n        for (var i = 1; i < n; ++i) {\n            baseY0 += layerPoints[i - 1][j][1] * ky;\n            data.setItemLayout(layerSeries[i].indices[j], {\n                layerIndex: i,\n                x: layerPoints[i][j][0],\n                y0: baseY0,\n                y: layerPoints[i][j][1] * ky\n            });\n        }\n    }\n}\n\n/**\n * Compute the baseLine of the rawdata\n * Inspired by Lee Byron's paper Stacked Graphs - Geometry & Aesthetics\n *\n * @param  {Array.<Array>} data  the points in each layer\n * @return {Object}\n */\nfunction computeBaseline(data) {\n    var layerNum = data.length;\n    var pointNum = data[0].length;\n    var sums = [];\n    var y0 = [];\n    var max = 0;\n    var temp;\n    var base = {};\n\n    for (var i = 0; i < pointNum; ++i) {\n        for (var j = 0, temp = 0; j < layerNum; ++j) {\n            temp += data[j][i][1];\n        }\n        if (temp > max) {\n            max = temp;\n        }\n        sums.push(temp);\n    }\n\n    for (var k = 0; k < pointNum; ++k) {\n        y0[k] = (max - sums[k]) / 2;\n    }\n    max = 0;\n\n    for (var l = 0; l < pointNum; ++l) {\n        var sum = sums[l] + y0[l];\n        if (sum > max) {\n            max = sum;\n        }\n    }\n    base.y0 = y0;\n    base.max = max;\n\n    return base;\n}\n\n/**\n * @file Visual encoding for themeRiver view\n * @author  Deqing Li(annong035@gmail.com)\n */\n\nvar themeRiverVisual = function (ecModel) {\n    ecModel.eachSeriesByType('themeRiver', function (seriesModel) {\n        var data = seriesModel.getData();\n        var rawData = seriesModel.getRawData();\n        var colorList = seriesModel.get('color');\n        var idxMap = createHashMap();\n\n        data.each(function (idx) {\n            idxMap.set(data.getRawIndex(idx), idx);\n        });\n\n        rawData.each(function (rawIndex) {\n            var name = rawData.getName(rawIndex);\n            var color = colorList[(seriesModel.nameMap.get(name) - 1) % colorList.length];\n\n            rawData.setItemVisual(rawIndex, 'color', color);\n\n            var idx = idxMap.get(rawIndex);\n\n            if (idx != null) {\n                data.setItemVisual(idx, 'color', color);\n            }\n        });\n    });\n};\n\nregisterLayout(themeRiverLayout);\nregisterVisual(themeRiverVisual);\nregisterProcessor(dataFilter('themeRiver'));\n\nSeriesModel.extend({\n\n    type: 'series.sunburst',\n\n    /**\n     * @type {module:echarts/data/Tree~Node}\n     */\n    _viewRoot: null,\n\n    getInitialData: function (option, ecModel) {\n        // Create a virtual root.\n        var root = { name: option.name, children: option.data };\n\n        completeTreeValue$1(root);\n\n        var levels = option.levels || [];\n\n        // levels = option.levels = setDefault(levels, ecModel);\n\n        var treeOption = {};\n\n        treeOption.levels = levels;\n\n        // Make sure always a new tree is created when setOption,\n        // in TreemapView, we check whether oldTree === newTree\n        // to choose mappings approach among old shapes and new shapes.\n        return Tree.createTree(root, this, treeOption).data;\n    },\n\n    optionUpdated: function () {\n        this.resetViewRoot();\n    },\n\n    /*\n     * @override\n     */\n    getDataParams: function (dataIndex) {\n        var params = SeriesModel.prototype.getDataParams.apply(this, arguments);\n\n        var node = this.getData().tree.getNodeByDataIndex(dataIndex);\n        params.treePathInfo = wrapTreePathInfo(node, this);\n\n        return params;\n    },\n\n    defaultOption: {\n        zlevel: 0,\n        z: 2,\n\n        // \n        center: ['50%', '50%'],\n        radius: [0, '75%'],\n        // \n        clockwise: true,\n        startAngle: 90,\n        // 0\n        minAngle: 0,\n\n        percentPrecision: 2,\n\n        // If still show when all data zero.\n        stillShowZeroSum: true,\n\n        // Policy of highlighting pieces when hover on one\n        // Valid values: 'none' (for not downplay others), 'descendant',\n        // 'ancestor', 'self'\n        highlightPolicy: 'descendant',\n\n        // 'rootToNode', 'link', or false\n        nodeClick: 'rootToNode',\n\n        renderLabelForZeroData: false,\n\n        label: {\n            // could be: 'radial', 'tangential', or 'none'\n            rotate: 'radial',\n            show: true,\n            opacity: 1,\n            // 'left' is for inner side of inside, and 'right' is for outter\n            // side for inside\n            align: 'center',\n            position: 'inside',\n            distance: 5,\n            silent: true,\n            emphasis: {}\n        },\n        itemStyle: {\n            borderWidth: 1,\n            borderColor: 'white',\n            opacity: 1,\n            emphasis: {},\n            highlight: {\n                opacity: 1\n            },\n            downplay: {\n                opacity: 0.9\n            }\n        },\n\n        // Animation type canbe expansion, scale\n        animationType: 'expansion',\n        animationDuration: 1000,\n        animationDurationUpdate: 500,\n        animationEasing: 'cubicOut',\n\n        data: [],\n\n        levels: [],\n\n        /**\n         * Sort order.\n         *\n         * Valid values: 'desc', 'asc', null, or callback function.\n         * 'desc' and 'asc' for descend and ascendant order;\n         * null for not sorting;\n         * example of callback function:\n         * function(nodeA, nodeB) {\n         *     return nodeA.getValue() - nodeB.getValue();\n         * }\n         */\n        sort: 'desc'\n    },\n\n    getViewRoot: function () {\n        return this._viewRoot;\n    },\n\n    /**\n     * @param {module:echarts/data/Tree~Node} [viewRoot]\n     */\n    resetViewRoot: function (viewRoot) {\n        viewRoot\n            ? (this._viewRoot = viewRoot)\n            : (viewRoot = this._viewRoot);\n\n        var root = this.getRawData().tree.root;\n\n        if (!viewRoot\n            || (viewRoot !== root && !root.contains(viewRoot))\n        ) {\n            this._viewRoot = root;\n        }\n    }\n});\n\n\n\n/**\n * @param {Object} dataNode\n */\nfunction completeTreeValue$1(dataNode) {\n    // Postorder travel tree.\n    // If value of none-leaf node is not set,\n    // calculate it by suming up the value of all children.\n    var sum = 0;\n\n    each$1(dataNode.children, function (child) {\n\n        completeTreeValue$1(child);\n\n        var childValue = child.value;\n        isArray(childValue) && (childValue = childValue[0]);\n\n        sum += childValue;\n    });\n\n    var thisValue = dataNode.value;\n    if (isArray(thisValue)) {\n        thisValue = thisValue[0];\n    }\n\n    if (thisValue == null || isNaN(thisValue)) {\n        thisValue = sum;\n    }\n    // Value should not less than 0.\n    if (thisValue < 0) {\n        thisValue = 0;\n    }\n\n    isArray(dataNode.value)\n        ? (dataNode.value[0] = thisValue)\n        : (dataNode.value = thisValue);\n}\n\nvar NodeHighlightPolicy = {\n    NONE: 'none', // not downplay others\n    DESCENDANT: 'descendant',\n    ANCESTOR: 'ancestor',\n    SELF: 'self'\n};\n\nvar DEFAULT_SECTOR_Z = 2;\nvar DEFAULT_TEXT_Z = 4;\n\n/**\n * Sunburstce of Sunburst including Sector, Label, LabelLine\n * @constructor\n * @extends {module:zrender/graphic/Group}\n */\nfunction SunburstPiece(node, seriesModel, ecModel) {\n\n    Group.call(this);\n\n    var sector = new Sector({\n        z2: DEFAULT_SECTOR_Z\n    });\n    var text = new Text({\n        z2: DEFAULT_TEXT_Z,\n        silent: node.getModel('label').get('silent')\n    });\n    this.add(sector);\n    this.add(text);\n\n    this.updateData(true, node, 'normal', seriesModel, ecModel);\n\n    // Hover to change label and labelLine\n    function onEmphasis() {\n        text.ignore = text.hoverIgnore;\n    }\n    function onNormal() {\n        text.ignore = text.normalIgnore;\n    }\n    this.on('emphasis', onEmphasis)\n        .on('normal', onNormal)\n        .on('mouseover', onEmphasis)\n        .on('mouseout', onNormal);\n}\n\nvar SunburstPieceProto = SunburstPiece.prototype;\n\nSunburstPieceProto.updateData = function (\n    firstCreate,\n    node,\n    state,\n    seriesModel,\n    ecModel\n) {\n    this.node = node;\n    node.piece = this;\n\n    seriesModel = seriesModel || this._seriesModel;\n    ecModel = ecModel || this._ecModel;\n\n    var sector = this.childAt(0);\n    sector.dataIndex = node.dataIndex;\n\n    var itemModel = node.getModel();\n    var layout = node.getLayout();\n    var sectorShape = extend({}, layout);\n    sectorShape.label = null;\n\n    var visualColor = getNodeColor(node, seriesModel, ecModel);\n\n    var normalStyle = itemModel.getModel('itemStyle').getItemStyle();\n    var style;\n    if (state === 'normal') {\n        style = normalStyle;\n    }\n    else {\n        var stateStyle = itemModel.getModel(state + '.itemStyle')\n            .getItemStyle();\n        style = merge(stateStyle, normalStyle);\n    }\n    style = defaults(\n        {\n            lineJoin: 'bevel',\n            fill: style.fill || visualColor\n        },\n        style\n    );\n\n    if (firstCreate) {\n        sector.setShape(sectorShape);\n        sector.shape.r = layout.r0;\n        updateProps(\n            sector,\n            {\n                shape: {\n                    r: layout.r\n                }\n            },\n            seriesModel,\n            node.dataIndex\n        );\n        sector.useStyle(style);\n    }\n    else if (typeof style.fill === 'object' && style.fill.type\n        || typeof sector.style.fill === 'object' && sector.style.fill.type\n    ) {\n        // Disable animation for gradient since no interpolation method\n        // is supported for gradient\n        updateProps(sector, {\n            shape: sectorShape\n        }, seriesModel);\n        sector.useStyle(style);\n    }\n    else {\n        updateProps(sector, {\n            shape: sectorShape,\n            style: style\n        }, seriesModel);\n    }\n\n    this._updateLabel(seriesModel, visualColor, state);\n\n    var cursorStyle = itemModel.getShallow('cursor');\n    cursorStyle && sector.attr('cursor', cursorStyle);\n\n    if (firstCreate) {\n        var highlightPolicy = seriesModel.getShallow('highlightPolicy');\n        this._initEvents(sector, node, seriesModel, highlightPolicy);\n    }\n\n    this._seriesModel = seriesModel || this._seriesModel;\n    this._ecModel = ecModel || this._ecModel;\n};\n\nSunburstPieceProto.onEmphasis = function (highlightPolicy) {\n    var that = this;\n    this.node.hostTree.root.eachNode(function (n) {\n        if (n.piece) {\n            if (that.node === n) {\n                n.piece.updateData(false, n, 'emphasis');\n            }\n            else if (isNodeHighlighted(n, that.node, highlightPolicy)) {\n                n.piece.childAt(0).trigger('highlight');\n            }\n            else if (highlightPolicy !== NodeHighlightPolicy.NONE) {\n                n.piece.childAt(0).trigger('downplay');\n            }\n        }\n    });\n};\n\nSunburstPieceProto.onNormal = function () {\n    this.node.hostTree.root.eachNode(function (n) {\n        if (n.piece) {\n            n.piece.updateData(false, n, 'normal');\n        }\n    });\n};\n\nSunburstPieceProto.onHighlight = function () {\n    this.updateData(false, this.node, 'highlight');\n};\n\nSunburstPieceProto.onDownplay = function () {\n    this.updateData(false, this.node, 'downplay');\n};\n\nSunburstPieceProto._updateLabel = function (seriesModel, visualColor, state) {\n    var itemModel = this.node.getModel();\n    var normalModel = itemModel.getModel('label');\n    var labelModel = state === 'normal' || state === 'emphasis'\n        ? normalModel\n        : itemModel.getModel(state + '.label');\n    var labelHoverModel = itemModel.getModel('emphasis.label');\n\n    var text = retrieve(\n        seriesModel.getFormattedLabel(\n            this.node.dataIndex, 'normal', null, null, 'label'\n        ),\n        this.node.name\n    );\n    if (getLabelAttr('show') === false) {\n        text = '';\n    }\n\n    var layout = this.node.getLayout();\n    var labelMinAngle = labelModel.get('minAngle');\n    if (labelMinAngle == null) {\n        labelMinAngle = normalModel.get('minAngle');\n    }\n    labelMinAngle = labelMinAngle / 180 * Math.PI;\n    var angle = layout.endAngle - layout.startAngle;\n    if (labelMinAngle != null && Math.abs(angle) < labelMinAngle) {\n        // Not displaying text when angle is too small\n        text = '';\n    }\n\n    var label = this.childAt(1);\n\n    setLabelStyle(\n        label.style, label.hoverStyle || {}, normalModel, labelHoverModel,\n        {\n            defaultText: labelModel.getShallow('show') ? text : null,\n            autoColor: visualColor,\n            useInsideStyle: true\n        }\n    );\n\n    var midAngle = (layout.startAngle + layout.endAngle) / 2;\n    var dx = Math.cos(midAngle);\n    var dy = Math.sin(midAngle);\n\n    var r;\n    var labelPosition = getLabelAttr('position');\n    var labelPadding = getLabelAttr('distance') || 0;\n    var textAlign = getLabelAttr('align');\n    if (labelPosition === 'outside') {\n        r = layout.r + labelPadding;\n        textAlign = midAngle > Math.PI / 2 ? 'right' : 'left';\n    }\n    else {\n        if (!textAlign || textAlign === 'center') {\n            r = (layout.r + layout.r0) / 2;\n            textAlign = 'center';\n        }\n        else if (textAlign === 'left') {\n            r = layout.r0 + labelPadding;\n            if (midAngle > Math.PI / 2) {\n                textAlign = 'right';\n            }\n        }\n        else if (textAlign === 'right') {\n            r = layout.r - labelPadding;\n            if (midAngle > Math.PI / 2) {\n                textAlign = 'left';\n            }\n        }\n    }\n\n    label.attr('style', {\n        text: text,\n        textAlign: textAlign,\n        textVerticalAlign: getLabelAttr('verticalAlign') || 'middle',\n        opacity: getLabelAttr('opacity')\n    });\n\n    var textX = r * dx + layout.cx;\n    var textY = r * dy + layout.cy;\n    label.attr('position', [textX, textY]);\n\n    var rotateType = getLabelAttr('rotate');\n    var rotate = 0;\n    if (rotateType === 'radial') {\n        rotate = -midAngle;\n        if (rotate < -Math.PI / 2) {\n            rotate += Math.PI;\n        }\n    }\n    else if (rotateType === 'tangential') {\n        rotate = Math.PI / 2 - midAngle;\n        if (rotate > Math.PI / 2) {\n            rotate -= Math.PI;\n        }\n        else if (rotate < -Math.PI / 2) {\n            rotate += Math.PI;\n        }\n    } else if (typeof rotateType === 'number') {\n        rotate = rotateType * Math.PI / 180;\n    }\n    label.attr('rotation', rotate);\n\n    function getLabelAttr(name) {\n        var stateAttr = labelModel.get(name);\n        if (stateAttr == null) {\n            return normalModel.get(name);\n        }\n        else {\n            return stateAttr;\n        }\n    }\n};\n\nSunburstPieceProto._initEvents = function (\n    sector,\n    node,\n    seriesModel,\n    highlightPolicy\n) {\n    sector.off('mouseover').off('mouseout').off('emphasis').off('normal');\n\n    var that = this;\n    var onEmphasis = function () {\n        that.onEmphasis(highlightPolicy);\n    };\n    var onNormal = function () {\n        that.onNormal();\n    };\n    var onDownplay = function () {\n        that.onDownplay();\n    };\n    var onHighlight = function () {\n        that.onHighlight();\n    };\n\n    if (seriesModel.isAnimationEnabled()) {\n        sector\n            .on('mouseover', onEmphasis)\n            .on('mouseout', onNormal)\n            .on('emphasis', onEmphasis)\n            .on('normal', onNormal)\n            .on('downplay', onDownplay)\n            .on('highlight', onHighlight);\n    }\n};\n\ninherits(SunburstPiece, Group);\n\n/**\n * Get node color\n *\n * @param {TreeNode} node the node to get color\n * @param {module:echarts/model/Series} seriesModel series\n * @param {module:echarts/model/Global} ecModel echarts defaults\n */\nfunction getNodeColor(node, seriesModel, ecModel) {\n    // Color from visualMap\n    var visualColor = node.getVisual('color');\n    var visualMetaList = node.getVisual('visualMeta');\n    if (!visualMetaList || visualMetaList.length === 0) {\n        // Use first-generation color if has no visualMap\n        visualColor = null;\n    }\n\n    // Self color or level color\n    var color = node.getModel('itemStyle').get('color');\n    if (color) {\n        return color;\n    }\n    else if (visualColor) {\n        // Color mapping\n        return visualColor;\n    }\n    else if (node.depth === 0) {\n        // Virtual root node\n        return ecModel.option.color[0];\n    }\n    else {\n        // First-generation color\n        var length = ecModel.option.color.length;\n        color = ecModel.option.color[getRootId(node) % length];\n    }\n    return color;\n}\n\n/**\n * Get index of root in sorted order\n *\n * @param {TreeNode} node current node\n * @return {number} index in root\n */\nfunction getRootId(node) {\n    var ancestor = node;\n    while (ancestor.depth > 1) {\n        ancestor = ancestor.parentNode;\n    }\n\n    var virtualRoot = node.getAncestors()[0];\n    return indexOf(virtualRoot.children, ancestor);\n}\n\nfunction isNodeHighlighted(node, activeNode, policy) {\n    if (policy === NodeHighlightPolicy.NONE) {\n        return false;\n    }\n    else if (policy === NodeHighlightPolicy.SELF) {\n        return node === activeNode;\n    }\n    else if (policy === NodeHighlightPolicy.ANCESTOR) {\n        return node === activeNode || node.isAncestorOf(activeNode);\n    }\n    else {\n        return node === activeNode || node.isDescendantOf(activeNode);\n    }\n}\n\nvar ROOT_TO_NODE_ACTION = 'sunburstRootToNode';\n\nvar SunburstView = Chart.extend({\n\n    type: 'sunburst',\n\n    init: function () {\n    },\n\n    render: function (seriesModel, ecModel, api, payload) {\n        var that = this;\n\n        this.seriesModel = seriesModel;\n        this.api = api;\n        this.ecModel = ecModel;\n\n        var data = seriesModel.getData();\n        var virtualRoot = data.tree.root;\n\n        var newRoot = seriesModel.getViewRoot();\n\n        var group = this.group;\n\n        var renderLabelForZeroData = seriesModel.get('renderLabelForZeroData');\n\n        var newChildren = [];\n        newRoot.eachNode(function (node) {\n            newChildren.push(node);\n        });\n        var oldChildren = this._oldChildren || [];\n\n        dualTravel(newChildren, oldChildren);\n\n        renderRollUp(virtualRoot, newRoot);\n\n        if (payload && payload.highlight && payload.highlight.piece) {\n            var highlightPolicy = seriesModel.getShallow('highlightPolicy');\n            payload.highlight.piece.onEmphasis(highlightPolicy);\n        }\n        else if (payload && payload.unhighlight) {\n            var piece = virtualRoot.piece;\n            if (!piece && virtualRoot.children.length) {\n                piece = virtualRoot.children[0].piece;\n            }\n            if (piece) {\n                piece.onNormal();\n            }\n        }\n\n        this._initEvents();\n\n        this._oldChildren = newChildren;\n\n        function dualTravel(newChildren, oldChildren) {\n            if (newChildren.length === 0 && oldChildren.length === 0) {\n                return;\n            }\n\n            new DataDiffer(oldChildren, newChildren, getKey, getKey)\n                .add(processNode)\n                .update(processNode)\n                .remove(curry(processNode, null))\n                .execute();\n\n            function getKey(node) {\n                return node.getId();\n            }\n\n            function processNode(newId, oldId) {\n                var newNode = newId == null ? null : newChildren[newId];\n                var oldNode = oldId == null ? null : oldChildren[oldId];\n\n                doRenderNode(newNode, oldNode);\n            }\n        }\n\n        function doRenderNode(newNode, oldNode) {\n            if (!renderLabelForZeroData && newNode && !newNode.getValue()) {\n                // Not render data with value 0\n                newNode = null;\n            }\n\n            if (newNode !== virtualRoot && oldNode !== virtualRoot) {\n                if (oldNode && oldNode.piece) {\n                    if (newNode) {\n                        // Update\n                        oldNode.piece.updateData(\n                            false, newNode, 'normal', seriesModel, ecModel);\n\n                        // For tooltip\n                        data.setItemGraphicEl(newNode.dataIndex, oldNode.piece);\n                    }\n                    else {\n                        // Remove\n                        removeNode(oldNode);\n                    }\n                }\n                else if (newNode) {\n                    // Add\n                    var piece = new SunburstPiece(\n                        newNode,\n                        seriesModel,\n                        ecModel\n                    );\n                    group.add(piece);\n\n                    // For tooltip\n                    data.setItemGraphicEl(newNode.dataIndex, piece);\n                }\n            }\n        }\n\n        function removeNode(node) {\n            if (!node) {\n                return;\n            }\n\n            if (node.piece) {\n                group.remove(node.piece);\n                node.piece = null;\n            }\n        }\n\n        function renderRollUp(virtualRoot, viewRoot) {\n            if (viewRoot.depth > 0) {\n                // Render\n                if (virtualRoot.piece) {\n                    // Update\n                    virtualRoot.piece.updateData(\n                        false, virtualRoot, 'normal', seriesModel, ecModel);\n                }\n                else {\n                    // Add\n                    virtualRoot.piece = new SunburstPiece(\n                        virtualRoot,\n                        seriesModel,\n                        ecModel\n                    );\n                    group.add(virtualRoot.piece);\n                }\n\n                if (viewRoot.piece._onclickEvent) {\n                    viewRoot.piece.off('click', viewRoot.piece._onclickEvent);\n                }\n                var event = function (e) {\n                    that._rootToNode(viewRoot.parentNode);\n                };\n                viewRoot.piece._onclickEvent = event;\n                virtualRoot.piece.on('click', event);\n            }\n            else if (virtualRoot.piece) {\n                // Remove\n                group.remove(virtualRoot.piece);\n                virtualRoot.piece = null;\n            }\n        }\n    },\n\n    dispose: function () {\n    },\n\n    /**\n     * @private\n     */\n    _initEvents: function () {\n        var that = this;\n\n        var event = function (e) {\n            var targetFound = false;\n            var viewRoot = that.seriesModel.getViewRoot();\n            viewRoot.eachNode(function (node) {\n                if (!targetFound\n                    && node.piece && node.piece.childAt(0) === e.target\n                ) {\n                    var nodeClick = node.getModel().get('nodeClick');\n                    if (nodeClick === 'rootToNode') {\n                        that._rootToNode(node);\n                    }\n                    else if (nodeClick === 'link') {\n                        var itemModel = node.getModel();\n                        var link = itemModel.get('link');\n                        if (link) {\n                            var linkTarget = itemModel.get('target', true)\n                                || '_blank';\n                            window.open(link, linkTarget);\n                        }\n                    }\n                    targetFound = true;\n                }\n            });\n        };\n\n        if (this.group._onclickEvent) {\n            this.group.off('click', this.group._onclickEvent);\n        }\n        this.group.on('click', event);\n        this.group._onclickEvent = event;\n    },\n\n    /**\n     * @private\n     */\n    _rootToNode: function (node) {\n        if (node !== this.seriesModel.getViewRoot()) {\n            this.api.dispatchAction({\n                type: ROOT_TO_NODE_ACTION,\n                from: this.uid,\n                seriesId: this.seriesModel.id,\n                targetNode: node\n            });\n        }\n    },\n\n    /**\n     * @implement\n     */\n    containPoint: function (point, seriesModel) {\n        var treeRoot = seriesModel.getData();\n        var itemLayout = treeRoot.getItemLayout(0);\n        if (itemLayout) {\n            var dx = point[0] - itemLayout.cx;\n            var dy = point[1] - itemLayout.cy;\n            var radius = Math.sqrt(dx * dx + dy * dy);\n            return radius <= itemLayout.r && radius >= itemLayout.r0;\n        }\n    }\n\n});\n\n/**\n * @file Sunburst action\n */\n\nvar ROOT_TO_NODE_ACTION$1 = 'sunburstRootToNode';\n\nregisterAction(\n    {type: ROOT_TO_NODE_ACTION$1, update: 'updateView'},\n    function (payload, ecModel) {\n\n        ecModel.eachComponent(\n            {mainType: 'series', subType: 'sunburst', query: payload},\n            handleRootToNode\n        );\n\n        function handleRootToNode(model, index) {\n            var targetInfo = retrieveTargetInfo(payload, [ROOT_TO_NODE_ACTION$1], model);\n\n            if (targetInfo) {\n                var originViewRoot = model.getViewRoot();\n                if (originViewRoot) {\n                    payload.direction = aboveViewRoot(originViewRoot, targetInfo.node)\n                        ? 'rollUp' : 'drillDown';\n                }\n                model.resetViewRoot(targetInfo.node);\n            }\n        }\n    }\n);\n\n\nvar HIGHLIGHT_ACTION = 'sunburstHighlight';\n\nregisterAction(\n    {type: HIGHLIGHT_ACTION, update: 'updateView'},\n    function (payload, ecModel) {\n\n        ecModel.eachComponent(\n            {mainType: 'series', subType: 'sunburst', query: payload},\n            handleHighlight\n        );\n\n        function handleHighlight(model, index) {\n            var targetInfo = retrieveTargetInfo(payload, [HIGHLIGHT_ACTION], model);\n\n            if (targetInfo) {\n                payload.highlight = targetInfo.node;\n            }\n        }\n    }\n);\n\n\nvar UNHIGHLIGHT_ACTION = 'sunburstUnhighlight';\n\nregisterAction(\n    {type: UNHIGHLIGHT_ACTION, update: 'updateView'},\n    function (payload, ecModel) {\n\n        ecModel.eachComponent(\n            {mainType: 'series', subType: 'sunburst', query: payload},\n            handleUnhighlight\n        );\n\n        function handleUnhighlight(model, index) {\n            payload.unhighlight = true;\n        }\n    }\n);\n\nvar RADIAN$1 = Math.PI / 180;\n\nvar sunburstLayout = function (seriesType, ecModel, api, payload) {\n    ecModel.eachSeriesByType(seriesType, function (seriesModel) {\n        var center = seriesModel.get('center');\n        var radius = seriesModel.get('radius');\n\n        if (!isArray(radius)) {\n            radius = [0, radius];\n        }\n        if (!isArray(center)) {\n            center = [center, center];\n        }\n\n        var width = api.getWidth();\n        var height = api.getHeight();\n        var size = Math.min(width, height);\n        var cx = parsePercent$1(center[0], width);\n        var cy = parsePercent$1(center[1], height);\n        var r0 = parsePercent$1(radius[0], size / 2);\n        var r = parsePercent$1(radius[1], size / 2);\n\n        var startAngle = -seriesModel.get('startAngle') * RADIAN$1;\n        var minAngle = seriesModel.get('minAngle') * RADIAN$1;\n\n        var virtualRoot = seriesModel.getData().tree.root;\n        var treeRoot = seriesModel.getViewRoot();\n        var rootDepth = treeRoot.depth;\n\n        var sort = seriesModel.get('sort');\n        if (sort != null) {\n            initChildren$1(treeRoot, sort);\n        }\n\n        var validDataCount = 0;\n        each$1(treeRoot.children, function (child) {\n            !isNaN(child.getValue()) && validDataCount++;\n        });\n\n        var sum = treeRoot.getValue();\n        // Sum may be 0\n        var unitRadian = Math.PI / (sum || validDataCount) * 2;\n\n        var renderRollupNode = treeRoot.depth > 0;\n        var levels = treeRoot.height - (renderRollupNode ? -1 : 1);\n        var rPerLevel = (r - r0) / (levels || 1);\n\n        var clockwise = seriesModel.get('clockwise');\n\n        var stillShowZeroSum = seriesModel.get('stillShowZeroSum');\n\n        // In the case some sector angle is smaller than minAngle\n        var dir = clockwise ? 1 : -1;\n\n        /**\n         * Render a tree\n         * @return increased angle\n         */\n        var renderNode = function (node, startAngle) {\n            if (!node) {\n                return;\n            }\n\n            var endAngle = startAngle;\n\n            // Render self\n            if (node !== virtualRoot) {\n                // Tree node is virtual, so it doesn't need to be drawn\n                var value = node.getValue();\n\n                var angle = (sum === 0 && stillShowZeroSum)\n                    ? unitRadian : (value * unitRadian);\n                if (angle < minAngle) {\n                    angle = minAngle;\n                    \n                }\n                else {\n                    \n                }\n\n                endAngle = startAngle + dir * angle;\n\n                var depth = node.depth - rootDepth\n                    - (renderRollupNode ? -1 : 1);\n                var rStart = r0 + rPerLevel * depth;\n                var rEnd = r0 + rPerLevel * (depth + 1);\n\n                var itemModel = node.getModel();\n                if (itemModel.get('r0') != null) {\n                    rStart = parsePercent$1(itemModel.get('r0'), size / 2);\n                }\n                if (itemModel.get('r') != null) {\n                    rEnd = parsePercent$1(itemModel.get('r'), size / 2);\n                }\n\n                node.setLayout({\n                    angle: angle,\n                    startAngle: startAngle,\n                    endAngle: endAngle,\n                    clockwise: clockwise,\n                    cx: cx,\n                    cy: cy,\n                    r0: rStart,\n                    r: rEnd\n                });\n            }\n\n            // Render children\n            if (node.children && node.children.length) {\n                // currentAngle = startAngle;\n                var siblingAngle = 0;\n                each$1(node.children, function (node) {\n                    siblingAngle += renderNode(node, startAngle + siblingAngle);\n                });\n            }\n\n            return endAngle - startAngle;\n        };\n\n        // Virtual root node for roll up\n        if (renderRollupNode) {\n            var rStart = r0;\n            var rEnd = r0 + rPerLevel;\n\n            var angle = Math.PI * 2;\n            virtualRoot.setLayout({\n                angle: angle,\n                startAngle: startAngle,\n                endAngle: startAngle + angle,\n                clockwise: clockwise,\n                cx: cx,\n                cy: cy,\n                r0: rStart,\n                r: rEnd\n            });\n        }\n\n        renderNode(treeRoot, startAngle);\n    });\n};\n\n/**\n * Init node children by order and update visual\n *\n * @param {TreeNode} node  root node\n * @param {boolean}  isAsc if is in ascendant order\n */\nfunction initChildren$1(node, isAsc) {\n    var children = node.children || [];\n\n    node.children = sort$2(children, isAsc);\n\n    // Init children recursively\n    if (children.length) {\n        each$1(node.children, function (child) {\n            initChildren$1(child, isAsc);\n        });\n    }\n}\n\n/**\n * Sort children nodes\n *\n * @param {TreeNode[]}               children children of node to be sorted\n * @param {string | function | null} sort sort method\n *                                   See SunburstSeries.js for details.\n */\nfunction sort$2(children, sortOrder) {\n    if (typeof sortOrder === 'function') {\n        return children.sort(sortOrder);\n    }\n    else {\n        var isAsc = sortOrder === 'asc';\n        return children.sort(function (a, b) {\n            var diff = (a.getValue() - b.getValue()) * (isAsc ? 1 : -1);\n            return diff === 0\n                ? (a.dataIndex - b.dataIndex) * (isAsc ? -1 : 1)\n                : diff;\n        });\n    }\n}\n\nregisterVisual(curry(dataColor, 'sunburst'));\nregisterLayout(curry(sunburstLayout, 'sunburst'));\nregisterProcessor(curry(dataFilter, 'sunburst'));\n\nfunction dataToCoordSize(dataSize, dataItem) {\n    // dataItem is necessary in log axis.\n    dataItem = dataItem || [0, 0];\n    return map(['x', 'y'], function (dim, dimIdx) {\n        var axis = this.getAxis(dim);\n        var val = dataItem[dimIdx];\n        var halfSize = dataSize[dimIdx] / 2;\n        return axis.type === 'category'\n            ? axis.getBandWidth()\n            : Math.abs(axis.dataToCoord(val - halfSize) - axis.dataToCoord(val + halfSize));\n    }, this);\n}\n\nvar prepareCartesian2d = function (coordSys) {\n    var rect = coordSys.grid.getRect();\n    return {\n        coordSys: {\n            // The name exposed to user is always 'cartesian2d' but not 'grid'.\n            type: 'cartesian2d',\n            x: rect.x,\n            y: rect.y,\n            width: rect.width,\n            height: rect.height\n        },\n        api: {\n            coord: function (data) {\n                // do not provide \"out\" param\n                return coordSys.dataToPoint(data);\n            },\n            size: bind(dataToCoordSize, coordSys)\n        }\n    };\n};\n\nfunction dataToCoordSize$1(dataSize, dataItem) {\n    dataItem = dataItem || [0, 0];\n    return map([0, 1], function (dimIdx) {\n        var val = dataItem[dimIdx];\n        var halfSize = dataSize[dimIdx] / 2;\n        var p1 = [];\n        var p2 = [];\n        p1[dimIdx] = val - halfSize;\n        p2[dimIdx] = val + halfSize;\n        p1[1 - dimIdx] = p2[1 - dimIdx] = dataItem[1 - dimIdx];\n        return Math.abs(this.dataToPoint(p1)[dimIdx] - this.dataToPoint(p2)[dimIdx]);\n    }, this);\n}\n\nvar prepareGeo = function (coordSys) {\n    var rect = coordSys.getBoundingRect();\n    return {\n        coordSys: {\n            type: 'geo',\n            x: rect.x,\n            y: rect.y,\n            width: rect.width,\n            height: rect.height\n        },\n        api: {\n            coord: function (data) {\n                // do not provide \"out\" and noRoam param,\n                // Compatible with this usage:\n                // echarts.util.map(item.points, api.coord)\n                return coordSys.dataToPoint(data);\n            },\n            size: bind(dataToCoordSize$1, coordSys)\n        }\n    };\n};\n\nfunction dataToCoordSize$2(dataSize, dataItem) {\n    // dataItem is necessary in log axis.\n    var axis = this.getAxis();\n    var val = dataItem instanceof Array ? dataItem[0] : dataItem;\n    var halfSize = (dataSize instanceof Array ? dataSize[0] : dataSize) / 2;\n    return axis.type === 'category'\n        ? axis.getBandWidth()\n        : Math.abs(axis.dataToCoord(val - halfSize) - axis.dataToCoord(val + halfSize));\n}\n\nvar prepareSingleAxis = function (coordSys) {\n    var rect = coordSys.getRect();\n\n    return {\n        coordSys: {\n            type: 'singleAxis',\n            x: rect.x,\n            y: rect.y,\n            width: rect.width,\n            height: rect.height\n        },\n        api: {\n            coord: function (val) {\n                // do not provide \"out\" param\n                return coordSys.dataToPoint(val);\n            },\n            size: bind(dataToCoordSize$2, coordSys)\n        }\n    };\n};\n\nfunction dataToCoordSize$3(dataSize, dataItem) {\n    // dataItem is necessary in log axis.\n    return map(['Radius', 'Angle'], function (dim, dimIdx) {\n        var axis = this['get' + dim + 'Axis']();\n        var val = dataItem[dimIdx];\n        var halfSize = dataSize[dimIdx] / 2;\n        var method = 'dataTo' + dim;\n\n        var result = axis.type === 'category'\n            ? axis.getBandWidth()\n            : Math.abs(axis[method](val - halfSize) - axis[method](val + halfSize));\n\n        if (dim === 'Angle') {\n            result = result * Math.PI / 180;\n        }\n\n        return result;\n\n    }, this);\n}\n\nvar preparePolar = function (coordSys) {\n    var radiusAxis = coordSys.getRadiusAxis();\n    var angleAxis = coordSys.getAngleAxis();\n    var radius = radiusAxis.getExtent();\n    radius[0] > radius[1] && radius.reverse();\n\n    return {\n        coordSys: {\n            type: 'polar',\n            cx: coordSys.cx,\n            cy: coordSys.cy,\n            r: radius[1],\n            r0: radius[0]\n        },\n        api: {\n            coord: bind(function (data) {\n                var radius = radiusAxis.dataToRadius(data[0]);\n                var angle = angleAxis.dataToAngle(data[1]);\n                var coord = coordSys.coordToPoint([radius, angle]);\n                coord.push(radius, angle * Math.PI / 180);\n                return coord;\n            }),\n            size: bind(dataToCoordSize$3, coordSys)\n        }\n    };\n};\n\nvar prepareCalendar = function (coordSys) {\n    var rect = coordSys.getRect();\n    var rangeInfo = coordSys.getRangeInfo();\n\n    return {\n        coordSys: {\n            type: 'calendar',\n            x: rect.x,\n            y: rect.y,\n            width: rect.width,\n            height: rect.height,\n            cellWidth: coordSys.getCellWidth(),\n            cellHeight: coordSys.getCellHeight(),\n            rangeInfo: {\n                start: rangeInfo.start,\n                end: rangeInfo.end,\n                weeks: rangeInfo.weeks,\n                dayCount: rangeInfo.allDay\n            }\n        },\n        api: {\n            coord: function (data, clamp) {\n                return coordSys.dataToPoint(data, clamp);\n            }\n        }\n    };\n};\n\nvar ITEM_STYLE_NORMAL_PATH = ['itemStyle'];\nvar ITEM_STYLE_EMPHASIS_PATH = ['emphasis', 'itemStyle'];\nvar LABEL_NORMAL = ['label'];\nvar LABEL_EMPHASIS = ['emphasis', 'label'];\n// Use prefix to avoid index to be the same as el.name,\n// which will cause weird udpate animation.\nvar GROUP_DIFF_PREFIX = 'e\\0\\0';\n\n/**\n * To reduce total package size of each coordinate systems, the modules `prepareCustom`\n * of each coordinate systems are not required by each coordinate systems directly, but\n * required by the module `custom`.\n *\n * prepareInfoForCustomSeries {Function}: optional\n *     @return {Object} {coordSys: {...}, api: {\n *         coord: function (data, clamp) {}, // return point in global.\n *         size: function (dataSize, dataItem) {} // return size of each axis in coordSys.\n *     }}\n */\nvar prepareCustoms = {\n    cartesian2d: prepareCartesian2d,\n    geo: prepareGeo,\n    singleAxis: prepareSingleAxis,\n    polar: preparePolar,\n    calendar: prepareCalendar\n};\n\n// ------\n// Model\n// ------\n\nextendSeriesModel({\n\n    type: 'series.custom',\n\n    dependencies: ['grid', 'polar', 'geo', 'singleAxis', 'calendar'],\n\n    defaultOption: {\n        coordinateSystem: 'cartesian2d', // Can be set as 'none'\n        zlevel: 0,\n        z: 2,\n        legendHoverLink: true\n\n        // Cartesian coordinate system\n        // xAxisIndex: 0,\n        // yAxisIndex: 0,\n\n        // Polar coordinate system\n        // polarIndex: 0,\n\n        // Geo coordinate system\n        // geoIndex: 0,\n\n        // label: {}\n        // itemStyle: {}\n    },\n\n    getInitialData: function (option, ecModel) {\n        return createListFromArray(this.getSource(), this);\n    }\n});\n\n// -----\n// View\n// -----\n\nextendChartView({\n\n    type: 'custom',\n\n    /**\n     * @private\n     * @type {module:echarts/data/List}\n     */\n    _data: null,\n\n    /**\n     * @override\n     */\n    render: function (customSeries, ecModel, api) {\n        var oldData = this._data;\n        var data = customSeries.getData();\n        var group = this.group;\n        var renderItem = makeRenderItem(customSeries, data, ecModel, api);\n\n        this.group.removeAll();\n\n        data.diff(oldData)\n            .add(function (newIdx) {\n                createOrUpdate$1(\n                    null, newIdx, renderItem(newIdx), customSeries, group, data\n                );\n            })\n            .update(function (newIdx, oldIdx) {\n                var el = oldData.getItemGraphicEl(oldIdx);\n                createOrUpdate$1(\n                    el, newIdx, renderItem(newIdx), customSeries, group, data\n                );\n            })\n            .remove(function (oldIdx) {\n                var el = oldData.getItemGraphicEl(oldIdx);\n                el && group.remove(el);\n            })\n            .execute();\n\n        this._data = data;\n    },\n\n    incrementalPrepareRender: function (customSeries, ecModel, api) {\n        this.group.removeAll();\n        this._data = null;\n    },\n\n    incrementalRender: function (params, customSeries, ecModel, api) {\n        var data = customSeries.getData();\n        var renderItem = makeRenderItem(customSeries, data, ecModel, api);\n        function setIncrementalAndHoverLayer(el) {\n            if (!el.isGroup) {\n                el.incremental = true;\n                el.useHoverLayer = true;\n            }\n        }\n        for (var idx = params.start; idx < params.end; idx++) {\n            var el = createOrUpdate$1(null, idx, renderItem(idx), customSeries, this.group, data);\n            el.traverse(setIncrementalAndHoverLayer);\n        }\n    },\n\n    /**\n     * @override\n     */\n    dispose: noop\n});\n\n\nfunction createEl(elOption) {\n    var graphicType = elOption.type;\n    var el;\n\n    if (graphicType === 'path') {\n        var shape = elOption.shape;\n        el = makePath(\n            shape.pathData,\n            null,\n            {\n                x: shape.x || 0,\n                y: shape.y || 0,\n                width: shape.width || 0,\n                height: shape.height || 0\n            },\n            'center'\n        );\n        el.__customPathData = elOption.pathData;\n    }\n    else if (graphicType === 'image') {\n        el = new ZImage({\n        });\n        el.__customImagePath = elOption.style.image;\n    }\n    else if (graphicType === 'text') {\n        el = new Text({\n        });\n        el.__customText = elOption.style.text;\n    }\n    else {\n        var Clz = graphic[graphicType.charAt(0).toUpperCase() + graphicType.slice(1)];\n\n        if (__DEV__) {\n            assert$1(Clz, 'graphic type \"' + graphicType + '\" can not be found.');\n        }\n\n        el = new Clz();\n    }\n\n    el.__customGraphicType = graphicType;\n    el.name = elOption.name;\n\n    return el;\n}\n\nfunction updateEl(el, dataIndex, elOption, animatableModel, data, isInit) {\n    var targetProps = {};\n    var elOptionStyle = elOption.style || {};\n\n    elOption.shape && (targetProps.shape = clone(elOption.shape));\n    elOption.position && (targetProps.position = elOption.position.slice());\n    elOption.scale && (targetProps.scale = elOption.scale.slice());\n    elOption.origin && (targetProps.origin = elOption.origin.slice());\n    elOption.rotation && (targetProps.rotation = elOption.rotation);\n\n    if (el.type === 'image' && elOption.style) {\n        var targetStyle = targetProps.style = {};\n        each$1(['x', 'y', 'width', 'height'], function (prop) {\n            prepareStyleTransition(prop, targetStyle, elOptionStyle, el.style, isInit);\n        });\n    }\n\n    if (el.type === 'text' && elOption.style) {\n        var targetStyle = targetProps.style = {};\n        each$1(['x', 'y'], function (prop) {\n            prepareStyleTransition(prop, targetStyle, elOptionStyle, el.style, isInit);\n        });\n        // Compatible with previous: both support\n        // textFill and fill, textStroke and stroke in 'text' element.\n        !elOptionStyle.hasOwnProperty('textFill') && elOptionStyle.fill && (\n            elOptionStyle.textFill = elOptionStyle.fill\n        );\n        !elOptionStyle.hasOwnProperty('textStroke') && elOptionStyle.stroke && (\n            elOptionStyle.textStroke = elOptionStyle.stroke\n        );\n    }\n\n    if (el.type !== 'group') {\n        el.useStyle(elOptionStyle);\n\n        // Init animation.\n        if (isInit) {\n            el.style.opacity = 0;\n            var targetOpacity = elOptionStyle.opacity;\n            targetOpacity == null && (targetOpacity = 1);\n            initProps(el, {style: {opacity: targetOpacity}}, animatableModel, dataIndex);\n        }\n    }\n\n    if (isInit) {\n        el.attr(targetProps);\n    }\n    else {\n        updateProps(el, targetProps, animatableModel, dataIndex);\n    }\n\n    // z2 must not be null/undefined, otherwise sort error may occur.\n    el.attr({z2: elOption.z2 || 0, silent: elOption.silent});\n\n    elOption.styleEmphasis !== false && setHoverStyle(el, elOption.styleEmphasis);\n}\n\nfunction prepareStyleTransition(prop, targetStyle, elOptionStyle, oldElStyle, isInit) {\n    if (elOptionStyle[prop] != null && !isInit) {\n        targetStyle[prop] = elOptionStyle[prop];\n        elOptionStyle[prop] = oldElStyle[prop];\n    }\n}\n\nfunction makeRenderItem(customSeries, data, ecModel, api) {\n    var renderItem = customSeries.get('renderItem');\n    var coordSys = customSeries.coordinateSystem;\n    var prepareResult = {};\n\n    if (coordSys) {\n        if (__DEV__) {\n            assert$1(renderItem, 'series.render is required.');\n            assert$1(\n                coordSys.prepareCustoms || prepareCustoms[coordSys.type],\n                'This coordSys does not support custom series.'\n            );\n        }\n\n        prepareResult = coordSys.prepareCustoms\n            ? coordSys.prepareCustoms()\n            : prepareCustoms[coordSys.type](coordSys);\n    }\n\n    var userAPI = defaults({\n        getWidth: api.getWidth,\n        getHeight: api.getHeight,\n        getZr: api.getZr,\n        getDevicePixelRatio: api.getDevicePixelRatio,\n        value: value,\n        style: style,\n        styleEmphasis: styleEmphasis,\n        visual: visual,\n        barLayout: barLayout,\n        currentSeriesIndices: currentSeriesIndices,\n        font: font\n    }, prepareResult.api || {});\n\n    var userParams = {\n        context: {},\n        seriesId: customSeries.id,\n        seriesName: customSeries.name,\n        seriesIndex: customSeries.seriesIndex,\n        coordSys: prepareResult.coordSys,\n        dataInsideLength: data.count(),\n        encode: wrapEncodeDef(customSeries.getData())\n    };\n\n    // Do not support call `api` asynchronously without dataIndexInside input.\n    var currDataIndexInside;\n    var currDirty = true;\n    var currItemModel;\n    var currLabelNormalModel;\n    var currLabelEmphasisModel;\n    var currVisualColor;\n\n    return function (dataIndexInside) {\n        currDataIndexInside = dataIndexInside;\n        currDirty = true;\n        return renderItem && renderItem(\n            defaults({\n                dataIndexInside: dataIndexInside,\n                dataIndex: data.getRawIndex(dataIndexInside)\n            }, userParams),\n            userAPI\n        ) || {};\n    };\n\n    // Do not update cache until api called.\n    function updateCache(dataIndexInside) {\n        dataIndexInside == null && (dataIndexInside = currDataIndexInside);\n        if (currDirty) {\n            currItemModel = data.getItemModel(dataIndexInside);\n            currLabelNormalModel = currItemModel.getModel(LABEL_NORMAL);\n            currLabelEmphasisModel = currItemModel.getModel(LABEL_EMPHASIS);\n            currVisualColor = data.getItemVisual(dataIndexInside, 'color');\n\n            currDirty = false;\n        }\n    }\n\n    /**\n     * @public\n     * @param {number|string} dim\n     * @param {number} [dataIndexInside=currDataIndexInside]\n     * @return {number|string} value\n     */\n    function value(dim, dataIndexInside) {\n        dataIndexInside == null && (dataIndexInside = currDataIndexInside);\n        return data.get(data.getDimension(dim || 0), dataIndexInside);\n    }\n\n    /**\n     * By default, `visual` is applied to style (to support visualMap).\n     * `visual.color` is applied at `fill`. If user want apply visual.color on `stroke`,\n     * it can be implemented as:\n     * `api.style({stroke: api.visual('color'), fill: null})`;\n     * @public\n     * @param {Object} [extra]\n     * @param {number} [dataIndexInside=currDataIndexInside]\n     */\n    function style(extra, dataIndexInside) {\n        dataIndexInside == null && (dataIndexInside = currDataIndexInside);\n        updateCache(dataIndexInside);\n\n        var itemStyle = currItemModel.getModel(ITEM_STYLE_NORMAL_PATH).getItemStyle();\n\n        currVisualColor != null && (itemStyle.fill = currVisualColor);\n        var opacity = data.getItemVisual(dataIndexInside, 'opacity');\n        opacity != null && (itemStyle.opacity = opacity);\n\n        setTextStyle(itemStyle, currLabelNormalModel, null, {\n            autoColor: currVisualColor,\n            isRectText: true\n        });\n\n        itemStyle.text = currLabelNormalModel.getShallow('show')\n            ? retrieve2(\n                customSeries.getFormattedLabel(dataIndexInside, 'normal'),\n                getDefaultLabel(data, dataIndexInside)\n            )\n            : null;\n\n        extra && extend(itemStyle, extra);\n        return itemStyle;\n    }\n\n    /**\n     * @public\n     * @param {Object} [extra]\n     * @param {number} [dataIndexInside=currDataIndexInside]\n     */\n    function styleEmphasis(extra, dataIndexInside) {\n        dataIndexInside == null && (dataIndexInside = currDataIndexInside);\n        updateCache(dataIndexInside);\n\n        var itemStyle = currItemModel.getModel(ITEM_STYLE_EMPHASIS_PATH).getItemStyle();\n\n        setTextStyle(itemStyle, currLabelEmphasisModel, null, {\n            isRectText: true\n        }, true);\n\n        itemStyle.text = currLabelEmphasisModel.getShallow('show')\n            ? retrieve3(\n                customSeries.getFormattedLabel(dataIndexInside, 'emphasis'),\n                customSeries.getFormattedLabel(dataIndexInside, 'normal'),\n                getDefaultLabel(data, dataIndexInside)\n            )\n            : null;\n\n        extra && extend(itemStyle, extra);\n        return itemStyle;\n    }\n\n    /**\n     * @public\n     * @param {string} visualType\n     * @param {number} [dataIndexInside=currDataIndexInside]\n     */\n    function visual(visualType, dataIndexInside) {\n        dataIndexInside == null && (dataIndexInside = currDataIndexInside);\n        return data.getItemVisual(dataIndexInside, visualType);\n    }\n\n    /**\n     * @public\n     * @param {number} opt.count Positive interger.\n     * @param {number} [opt.barWidth]\n     * @param {number} [opt.barMaxWidth]\n     * @param {number} [opt.barGap]\n     * @param {number} [opt.barCategoryGap]\n     * @return {Object} {width, offset, offsetCenter} is not support, return undefined.\n     */\n    function barLayout(opt) {\n        if (coordSys.getBaseAxis) {\n            var baseAxis = coordSys.getBaseAxis();\n            return getLayoutOnAxis(defaults({axis: baseAxis}, opt), api);\n        }\n    }\n\n    /**\n     * @public\n     * @return {Array.<number>}\n     */\n    function currentSeriesIndices() {\n        return ecModel.getCurrentSeriesIndices();\n    }\n\n    /**\n     * @public\n     * @param {Object} opt\n     * @param {string} [opt.fontStyle]\n     * @param {number} [opt.fontWeight]\n     * @param {number} [opt.fontSize]\n     * @param {string} [opt.fontFamily]\n     * @return {string} font string\n     */\n    function font(opt) {\n        return getFont(opt, ecModel);\n    }\n}\n\nfunction wrapEncodeDef(data) {\n    var encodeDef = {};\n    each$1(data.dimensions, function (dimName, dataDimIndex) {\n        var dimInfo = data.getDimensionInfo(dimName);\n        if (!dimInfo.isExtraCoord) {\n            var coordDim = dimInfo.coordDim;\n            var dataDims = encodeDef[coordDim] = encodeDef[coordDim] || [];\n            dataDims[dimInfo.coordDimIndex] = dataDimIndex;\n        }\n    });\n    return encodeDef;\n}\n\nfunction createOrUpdate$1(el, dataIndex, elOption, animatableModel, group, data) {\n    el = doCreateOrUpdate(el, dataIndex, elOption, animatableModel, group, data);\n    el && data.setItemGraphicEl(dataIndex, el);\n\n    return el;\n}\n\nfunction doCreateOrUpdate(el, dataIndex, elOption, animatableModel, group, data) {\n    var elOptionType = elOption.type;\n    if (el\n        && elOptionType !== el.__customGraphicType\n        && (elOptionType !== 'path' || elOption.pathData !== el.__customPathData)\n        && (elOptionType !== 'image' || elOption.style.image !== el.__customImagePath)\n        && (elOptionType !== 'text' || elOption.style.text !== el.__customText)\n    ) {\n        group.remove(el);\n        el = null;\n    }\n\n    // `elOption.type` is undefined when `renderItem` returns nothing.\n    if (elOptionType == null) {\n        return;\n    }\n\n    var isInit = !el;\n    !el && (el = createEl(elOption));\n    updateEl(el, dataIndex, elOption, animatableModel, data, isInit);\n\n    if (elOptionType === 'group') {\n        var oldChildren = el.children() || [];\n        var newChildren = elOption.children || [];\n\n        if (elOption.diffChildrenByName) {\n            // lower performance.\n            diffGroupChildren({\n                oldChildren: oldChildren,\n                newChildren: newChildren,\n                dataIndex: dataIndex,\n                animatableModel: animatableModel,\n                group: el,\n                data: data\n            });\n        }\n        else {\n            // better performance.\n            var index = 0;\n            for (; index < newChildren.length; index++) {\n                doCreateOrUpdate(\n                    el.childAt(index),\n                    dataIndex,\n                    newChildren[index],\n                    animatableModel,\n                    el,\n                    data\n                );\n            }\n            for (; index < oldChildren.length; index++) {\n                oldChildren[index] && el.remove(oldChildren[index]);\n            }\n        }\n    }\n\n    group.add(el);\n\n    return el;\n}\n\nfunction diffGroupChildren(context) {\n    (new DataDiffer(\n        context.oldChildren,\n        context.newChildren,\n        getKey,\n        getKey,\n        context\n    ))\n        .add(processAddUpdate)\n        .update(processAddUpdate)\n        .remove(processRemove)\n        .execute();\n}\n\nfunction getKey(item, idx) {\n    var name = item && item.name;\n    return name != null ? name : GROUP_DIFF_PREFIX + idx;\n}\n\nfunction processAddUpdate(newIndex, oldIndex) {\n    var context = this.context;\n    var childOption = newIndex != null ? context.newChildren[newIndex] : null;\n    var child = oldIndex != null ? context.oldChildren[oldIndex] : null;\n\n    doCreateOrUpdate(\n        child,\n        context.dataIndex,\n        childOption,\n        context.animatableModel,\n        context.group,\n        context.data\n    );\n}\n\nfunction processRemove(oldIndex) {\n    var context = this.context;\n    var child = context.oldChildren[oldIndex];\n    child && context.group.remove(child);\n}\n\n// -------------\n// Preprocessor\n// -------------\n\nregisterPreprocessor(function (option) {\n    var graphicOption = option.graphic;\n\n    // Convert\n    // {graphic: [{left: 10, type: 'circle'}, ...]}\n    // or\n    // {graphic: {left: 10, type: 'circle'}}\n    // to\n    // {graphic: [{elements: [{left: 10, type: 'circle'}, ...]}]}\n    if (isArray(graphicOption)) {\n        if (!graphicOption[0] || !graphicOption[0].elements) {\n            option.graphic = [{elements: graphicOption}];\n        }\n        else {\n            // Only one graphic instance can be instantiated. (We dont\n            // want that too many views are created in echarts._viewMap)\n            option.graphic = [option.graphic[0]];\n        }\n    }\n    else if (graphicOption && !graphicOption.elements) {\n        option.graphic = [{elements: [graphicOption]}];\n    }\n});\n\n// ------\n// Model\n// ------\n\nvar GraphicModel = extendComponentModel({\n\n    type: 'graphic',\n\n    defaultOption: {\n\n        // Extra properties for each elements:\n        //\n        // left/right/top/bottom: (like 12, '22%', 'center', default undefined)\n        //      If left/rigth is set, shape.x/shape.cx/position will not be used.\n        //      If top/bottom is set, shape.y/shape.cy/position will not be used.\n        //      This mechanism is useful when you want to position a group/element\n        //      against the right side or the center of this container.\n        //\n        // width/height: (can only be pixel value, default 0)\n        //      Only be used to specify contianer(group) size, if needed. And\n        //      can not be percentage value (like '33%'). See the reason in the\n        //      layout algorithm below.\n        //\n        // bounding: (enum: 'all' (default) | 'raw')\n        //      Specify how to calculate boundingRect when locating.\n        //      'all': Get uioned and transformed boundingRect\n        //          from both itself and its descendants.\n        //          This mode simplies confining a group of elements in the bounding\n        //          of their ancester container (e.g., using 'right: 0').\n        //      'raw': Only use the boundingRect of itself and before transformed.\n        //          This mode is similar to css behavior, which is useful when you\n        //          want an element to be able to overflow its container. (Consider\n        //          a rotated circle needs to be located in a corner.)\n\n        // Note: elements is always behind its ancestors in this elements array.\n        elements: [],\n        parentId: null\n    },\n\n    /**\n     * Save el options for the sake of the performance (only update modified graphics).\n     * The order is the same as those in option. (ancesters -> descendants)\n     *\n     * @private\n     * @type {Array.<Object>}\n     */\n    _elOptionsToUpdate: null,\n\n    /**\n     * @override\n     */\n    mergeOption: function (option) {\n        // Prevent default merge to elements\n        var elements = this.option.elements;\n        this.option.elements = null;\n\n        GraphicModel.superApply(this, 'mergeOption', arguments);\n\n        this.option.elements = elements;\n    },\n\n    /**\n     * @override\n     */\n    optionUpdated: function (newOption, isInit) {\n        var thisOption = this.option;\n        var newList = (isInit ? thisOption : newOption).elements;\n        var existList = thisOption.elements = isInit ? [] : thisOption.elements;\n\n        var flattenedList = [];\n        this._flatten(newList, flattenedList);\n\n        var mappingResult = mappingToExists(existList, flattenedList);\n        makeIdAndName(mappingResult);\n\n        // Clear elOptionsToUpdate\n        var elOptionsToUpdate = this._elOptionsToUpdate = [];\n\n        each$1(mappingResult, function (resultItem, index) {\n            var newElOption = resultItem.option;\n\n            if (__DEV__) {\n                assert$1(\n                    isObject$1(newElOption) || resultItem.exist,\n                    'Empty graphic option definition'\n                );\n            }\n\n            if (!newElOption) {\n                return;\n            }\n\n            elOptionsToUpdate.push(newElOption);\n\n            setKeyInfoToNewElOption(resultItem, newElOption);\n\n            mergeNewElOptionToExist(existList, index, newElOption);\n\n            setLayoutInfoToExist(existList[index], newElOption);\n\n        }, this);\n\n        // Clean\n        for (var i = existList.length - 1; i >= 0; i--) {\n            if (existList[i] == null) {\n                existList.splice(i, 1);\n            }\n            else {\n                // $action should be volatile, otherwise option gotten from\n                // `getOption` will contain unexpected $action.\n                delete existList[i].$action;\n            }\n        }\n    },\n\n    /**\n     * Convert\n     * [{\n     *  type: 'group',\n     *  id: 'xx',\n     *  children: [{type: 'circle'}, {type: 'polygon'}]\n     * }]\n     * to\n     * [\n     *  {type: 'group', id: 'xx'},\n     *  {type: 'circle', parentId: 'xx'},\n     *  {type: 'polygon', parentId: 'xx'}\n     * ]\n     *\n     * @private\n     * @param {Array.<Object>} optionList option list\n     * @param {Array.<Object>} result result of flatten\n     * @param {Object} parentOption parent option\n     */\n    _flatten: function (optionList, result, parentOption) {\n        each$1(optionList, function (option) {\n            if (!option) {\n                return;\n            }\n\n            if (parentOption) {\n                option.parentOption = parentOption;\n            }\n\n            result.push(option);\n\n            var children = option.children;\n            if (option.type === 'group' && children) {\n                this._flatten(children, result, option);\n            }\n            // Deleting for JSON output, and for not affecting group creation.\n            delete option.children;\n        }, this);\n    },\n\n    // FIXME\n    // Pass to view using payload? setOption has a payload?\n    useElOptionsToUpdate: function () {\n        var els = this._elOptionsToUpdate;\n        // Clear to avoid render duplicately when zooming.\n        this._elOptionsToUpdate = null;\n        return els;\n    }\n});\n\n// -----\n// View\n// -----\n\nextendComponentView({\n\n    type: 'graphic',\n\n    /**\n     * @override\n     */\n    init: function (ecModel, api) {\n\n        /**\n         * @private\n         * @type {module:zrender/core/util.HashMap}\n         */\n        this._elMap = createHashMap();\n\n        /**\n         * @private\n         * @type {module:echarts/graphic/GraphicModel}\n         */\n        this._lastGraphicModel;\n    },\n\n    /**\n     * @override\n     */\n    render: function (graphicModel, ecModel, api) {\n\n        // Having leveraged between use cases and algorithm complexity, a very\n        // simple layout mechanism is used:\n        // The size(width/height) can be determined by itself or its parent (not\n        // implemented yet), but can not by its children. (Top-down travel)\n        // The location(x/y) can be determined by the bounding rect of itself\n        // (can including its descendants or not) and the size of its parent.\n        // (Bottom-up travel)\n\n        // When `chart.clear()` or `chart.setOption({...}, true)` with the same id,\n        // view will be reused.\n        if (graphicModel !== this._lastGraphicModel) {\n            this._clear();\n        }\n        this._lastGraphicModel = graphicModel;\n\n        this._updateElements(graphicModel, api);\n        this._relocate(graphicModel, api);\n    },\n\n    /**\n     * Update graphic elements.\n     *\n     * @private\n     * @param {Object} graphicModel graphic model\n     * @param {module:echarts/ExtensionAPI} api extension API\n     */\n    _updateElements: function (graphicModel, api) {\n        var elOptionsToUpdate = graphicModel.useElOptionsToUpdate();\n\n        if (!elOptionsToUpdate) {\n            return;\n        }\n\n        var elMap = this._elMap;\n        var rootGroup = this.group;\n\n        // Top-down tranverse to assign graphic settings to each elements.\n        each$1(elOptionsToUpdate, function (elOption) {\n            var $action = elOption.$action;\n            var id = elOption.id;\n            var existEl = elMap.get(id);\n            var parentId = elOption.parentId;\n            var targetElParent = parentId != null ? elMap.get(parentId) : rootGroup;\n\n            if (elOption.type === 'text') {\n                var elOptionStyle = elOption.style;\n\n                // In top/bottom mode, textVerticalAlign should not be used, which cause\n                // inaccurately locating.\n                if (elOption.hv && elOption.hv[1]) {\n                    elOptionStyle.textVerticalAlign = elOptionStyle.textBaseline = null;\n                }\n\n                // Compatible with previous setting: both support fill and textFill,\n                // stroke and textStroke.\n                !elOptionStyle.hasOwnProperty('textFill') && elOptionStyle.fill && (\n                    elOptionStyle.textFill = elOptionStyle.fill\n                );\n                !elOptionStyle.hasOwnProperty('textStroke') && elOptionStyle.stroke && (\n                    elOptionStyle.textStroke = elOptionStyle.stroke\n                );\n            }\n\n            // Remove unnecessary props to avoid potential problems.\n            var elOptionCleaned = getCleanedElOption(elOption);\n\n            // For simple, do not support parent change, otherwise reorder is needed.\n            if (__DEV__) {\n                existEl && assert$1(\n                    targetElParent === existEl.parent,\n                    'Changing parent is not supported.'\n                );\n            }\n\n            if (!$action || $action === 'merge') {\n                existEl\n                    ? existEl.attr(elOptionCleaned)\n                    : createEl$1(id, targetElParent, elOptionCleaned, elMap);\n            }\n            else if ($action === 'replace') {\n                removeEl(existEl, elMap);\n                createEl$1(id, targetElParent, elOptionCleaned, elMap);\n            }\n            else if ($action === 'remove') {\n                removeEl(existEl, elMap);\n            }\n\n            var el = elMap.get(id);\n            if (el) {\n                el.__ecGraphicWidth = elOption.width;\n                el.__ecGraphicHeight = elOption.height;\n            }\n        });\n    },\n\n    /**\n     * Locate graphic elements.\n     *\n     * @private\n     * @param {Object} graphicModel graphic model\n     * @param {module:echarts/ExtensionAPI} api extension API\n     */\n    _relocate: function (graphicModel, api) {\n        var elOptions = graphicModel.option.elements;\n        var rootGroup = this.group;\n        var elMap = this._elMap;\n\n        // Bottom-up tranvese all elements (consider ec resize) to locate elements.\n        for (var i = elOptions.length - 1; i >= 0; i--) {\n            var elOption = elOptions[i];\n            var el = elMap.get(elOption.id);\n\n            if (!el) {\n                continue;\n            }\n\n            var parentEl = el.parent;\n            var containerInfo = parentEl === rootGroup\n                ? {\n                    width: api.getWidth(),\n                    height: api.getHeight()\n                }\n                : { // Like 'position:absolut' in css, default 0.\n                    width: parentEl.__ecGraphicWidth || 0,\n                    height: parentEl.__ecGraphicHeight || 0\n                };\n\n            positionElement(\n                el, elOption, containerInfo, null,\n                {hv: elOption.hv, boundingMode: elOption.bounding}\n            );\n        }\n    },\n\n    /**\n     * Clear all elements.\n     *\n     * @private\n     */\n    _clear: function () {\n        var elMap = this._elMap;\n        elMap.each(function (el) {\n            removeEl(el, elMap);\n        });\n        this._elMap = createHashMap();\n    },\n\n    /**\n     * @override\n     */\n    dispose: function () {\n        this._clear();\n    }\n});\n\nfunction createEl$1(id, targetElParent, elOption, elMap) {\n    var graphicType = elOption.type;\n\n    if (__DEV__) {\n        assert$1(graphicType, 'graphic type MUST be set');\n    }\n\n    var Clz = graphic[graphicType.charAt(0).toUpperCase() + graphicType.slice(1)];\n\n    if (__DEV__) {\n        assert$1(Clz, 'graphic type can not be found');\n    }\n\n    var el = new Clz(elOption);\n    targetElParent.add(el);\n    elMap.set(id, el);\n    el.__ecGraphicId = id;\n}\n\nfunction removeEl(existEl, elMap) {\n    var existElParent = existEl && existEl.parent;\n    if (existElParent) {\n        existEl.type === 'group' && existEl.traverse(function (el) {\n            removeEl(el, elMap);\n        });\n        elMap.removeKey(existEl.__ecGraphicId);\n        existElParent.remove(existEl);\n    }\n}\n\n// Remove unnecessary props to avoid potential problems.\nfunction getCleanedElOption(elOption) {\n    elOption = extend({}, elOption);\n    each$1(\n        ['id', 'parentId', '$action', 'hv', 'bounding'].concat(LOCATION_PARAMS),\n        function (name) {\n            delete elOption[name];\n        }\n    );\n    return elOption;\n}\n\nfunction isSetLoc(obj, props) {\n    var isSet;\n    each$1(props, function (prop) {\n        obj[prop] != null && obj[prop] !== 'auto' && (isSet = true);\n    });\n    return isSet;\n}\n\nfunction setKeyInfoToNewElOption(resultItem, newElOption) {\n    var existElOption = resultItem.exist;\n\n    // Set id and type after id assigned.\n    newElOption.id = resultItem.keyInfo.id;\n    !newElOption.type && existElOption && (newElOption.type = existElOption.type);\n\n    // Set parent id if not specified\n    if (newElOption.parentId == null) {\n        var newElParentOption = newElOption.parentOption;\n        if (newElParentOption) {\n            newElOption.parentId = newElParentOption.id;\n        }\n        else if (existElOption) {\n            newElOption.parentId = existElOption.parentId;\n        }\n    }\n\n    // Clear\n    newElOption.parentOption = null;\n}\n\nfunction mergeNewElOptionToExist(existList, index, newElOption) {\n    // Update existing options, for `getOption` feature.\n    var newElOptCopy = extend({}, newElOption);\n    var existElOption = existList[index];\n\n    var $action = newElOption.$action || 'merge';\n    if ($action === 'merge') {\n        if (existElOption) {\n\n            if (__DEV__) {\n                var newType = newElOption.type;\n                assert$1(\n                    !newType || existElOption.type === newType,\n                    'Please set $action: \"replace\" to change `type`'\n                );\n            }\n\n            // We can ensure that newElOptCopy and existElOption are not\n            // the same object, so `merge` will not change newElOptCopy.\n            merge(existElOption, newElOptCopy, true);\n            // Rigid body, use ignoreSize.\n            mergeLayoutParam(existElOption, newElOptCopy, {ignoreSize: true});\n            // Will be used in render.\n            copyLayoutParams(newElOption, existElOption);\n        }\n        else {\n            existList[index] = newElOptCopy;\n        }\n    }\n    else if ($action === 'replace') {\n        existList[index] = newElOptCopy;\n    }\n    else if ($action === 'remove') {\n        // null will be cleaned later.\n        existElOption && (existList[index] = null);\n    }\n}\n\nfunction setLayoutInfoToExist(existItem, newElOption) {\n    if (!existItem) {\n        return;\n    }\n    existItem.hv = newElOption.hv = [\n        // Rigid body, dont care `width`.\n        isSetLoc(newElOption, ['left', 'right']),\n        // Rigid body, dont care `height`.\n        isSetLoc(newElOption, ['top', 'bottom'])\n    ];\n    // Give default group size. Otherwise layout error may occur.\n    if (existItem.type === 'group') {\n        existItem.width == null && (existItem.width = newElOption.width = 0);\n        existItem.height == null && (existItem.height = newElOption.height = 0);\n    }\n}\n\nvar LegendModel = extendComponentModel({\n\n    type: 'legend.plain',\n\n    dependencies: ['series'],\n\n    layoutMode: {\n        type: 'box',\n        // legend.width/height are maxWidth/maxHeight actually,\n        // whereas realy width/height is calculated by its content.\n        // (Setting {left: 10, right: 10} does not make sense).\n        // So consider the case:\n        // `setOption({legend: {left: 10});`\n        // then `setOption({legend: {right: 10});`\n        // The previous `left` should be cleared by setting `ignoreSize`.\n        ignoreSize: true\n    },\n\n    init: function (option, parentModel, ecModel) {\n        this.mergeDefaultAndTheme(option, ecModel);\n\n        option.selected = option.selected || {};\n    },\n\n    mergeOption: function (option) {\n        LegendModel.superCall(this, 'mergeOption', option);\n    },\n\n    optionUpdated: function () {\n        this._updateData(this.ecModel);\n\n        var legendData = this._data;\n\n        // If selectedMode is single, try to select one\n        if (legendData[0] && this.get('selectedMode') === 'single') {\n            var hasSelected = false;\n            // If has any selected in option.selected\n            for (var i = 0; i < legendData.length; i++) {\n                var name = legendData[i].get('name');\n                if (this.isSelected(name)) {\n                    // Force to unselect others\n                    this.select(name);\n                    hasSelected = true;\n                    break;\n                }\n            }\n            // Try select the first if selectedMode is single\n            !hasSelected && this.select(legendData[0].get('name'));\n        }\n    },\n\n    _updateData: function (ecModel) {\n        var potentialData = [];\n        var availableNames = [];\n\n        ecModel.eachRawSeries(function (seriesModel) {\n            var seriesName = seriesModel.name;\n            availableNames.push(seriesName);\n            var isPotential;\n\n            if (seriesModel.legendDataProvider) {\n                var data = seriesModel.legendDataProvider();\n                var names = data.mapArray(data.getName);\n\n                if (!ecModel.isSeriesFiltered(seriesModel)) {\n                    availableNames = availableNames.concat(names);\n                }\n\n                if (names.length) {\n                    potentialData = potentialData.concat(names);\n                }\n                else {\n                    isPotential = true;\n                }\n            }\n            else {\n                isPotential = true;\n            }\n\n            if (isPotential && isNameSpecified(seriesModel)) {\n                potentialData.push(seriesModel.name);\n            }\n        });\n\n        /**\n         * @type {Array.<string>}\n         * @private\n         */\n        this._availableNames = availableNames;\n\n        // If legend.data not specified in option, use availableNames as data,\n        // which is convinient for user preparing option.\n        var rawData = this.get('data') || potentialData;\n\n        var legendData = map(rawData, function (dataItem) {\n            // Can be string or number\n            if (typeof dataItem === 'string' || typeof dataItem === 'number') {\n                dataItem = {\n                    name: dataItem\n                };\n            }\n            return new Model(dataItem, this, this.ecModel);\n        }, this);\n\n        /**\n         * @type {Array.<module:echarts/model/Model>}\n         * @private\n         */\n        this._data = legendData;\n    },\n\n    /**\n     * @return {Array.<module:echarts/model/Model>}\n     */\n    getData: function () {\n        return this._data;\n    },\n\n    /**\n     * @param {string} name\n     */\n    select: function (name) {\n        var selected = this.option.selected;\n        var selectedMode = this.get('selectedMode');\n        if (selectedMode === 'single') {\n            var data = this._data;\n            each$1(data, function (dataItem) {\n                selected[dataItem.get('name')] = false;\n            });\n        }\n        selected[name] = true;\n    },\n\n    /**\n     * @param {string} name\n     */\n    unSelect: function (name) {\n        if (this.get('selectedMode') !== 'single') {\n            this.option.selected[name] = false;\n        }\n    },\n\n    /**\n     * @param {string} name\n     */\n    toggleSelected: function (name) {\n        var selected = this.option.selected;\n        // Default is true\n        if (!selected.hasOwnProperty(name)) {\n            selected[name] = true;\n        }\n        this[selected[name] ? 'unSelect' : 'select'](name);\n    },\n\n    /**\n     * @param {string} name\n     */\n    isSelected: function (name) {\n        var selected = this.option.selected;\n        return !(selected.hasOwnProperty(name) && !selected[name])\n            && indexOf(this._availableNames, name) >= 0;\n    },\n\n    defaultOption: {\n        // \n        zlevel: 0,\n        // \n        z: 4,\n        show: true,\n\n        // \n        // 'horizontal' | 'vertical'\n        orient: 'horizontal',\n\n        left: 'center',\n        // right: 'center',\n\n        top: 0,\n        // bottom: null,\n\n        // \n        // 'auto' | 'left' | 'right'\n        //  'auto',  x \n        align: 'auto',\n\n        backgroundColor: 'rgba(0,0,0,0)',\n        // \n        borderColor: '#ccc',\n        borderRadius: 0,\n        // px0\n        borderWidth: 0,\n        // px5\n        // css\n        padding: 5,\n        // itempx10\n        // \n        itemGap: 10,\n        // \n        itemWidth: 25,\n        // \n        itemHeight: 14,\n\n        // \n        inactiveColor: '#ccc',\n\n        textStyle: {\n            // \n            color: '#333'\n        },\n        // formatter: '',\n        // \n        selectedMode: true,\n        // LEGEND.SELECTED\n        // selected: null,\n        // legend.dataitem\n        // data: [],\n\n        // Tooltip \n        tooltip: {\n            show: false\n        }\n    }\n});\n\nfunction legendSelectActionHandler(methodName, payload, ecModel) {\n    var selectedMap = {};\n    var isToggleSelect = methodName === 'toggleSelected';\n    var isSelected;\n    // Update all legend components\n    ecModel.eachComponent('legend', function (legendModel) {\n        if (isToggleSelect && isSelected != null) {\n            // Force other legend has same selected status\n            // Or the first is toggled to true and other are toggled to false\n            // In the case one legend has some item unSelected in option. And if other legend\n            // doesn't has the item, they will assume it is selected.\n            legendModel[isSelected ? 'select' : 'unSelect'](payload.name);\n        }\n        else {\n            legendModel[methodName](payload.name);\n            isSelected = legendModel.isSelected(payload.name);\n        }\n        var legendData = legendModel.getData();\n        each$1(legendData, function (model) {\n            var name = model.get('name');\n            // Wrap element\n            if (name === '\\n' || name === '') {\n                return;\n            }\n            var isItemSelected = legendModel.isSelected(name);\n            if (selectedMap.hasOwnProperty(name)) {\n                // Unselected if any legend is unselected\n                selectedMap[name] = selectedMap[name] && isItemSelected;\n            }\n            else {\n                selectedMap[name] = isItemSelected;\n            }\n        });\n    });\n    // Return the event explicitly\n    return {\n        name: payload.name,\n        selected: selectedMap\n    };\n}\n/**\n * @event legendToggleSelect\n * @type {Object}\n * @property {string} type 'legendToggleSelect'\n * @property {string} [from]\n * @property {string} name Series name or data item name\n */\nregisterAction(\n    'legendToggleSelect', 'legendselectchanged',\n    curry(legendSelectActionHandler, 'toggleSelected')\n);\n\n/**\n * @event legendSelect\n * @type {Object}\n * @property {string} type 'legendSelect'\n * @property {string} name Series name or data item name\n */\nregisterAction(\n    'legendSelect', 'legendselected',\n    curry(legendSelectActionHandler, 'select')\n);\n\n/**\n * @event legendUnSelect\n * @type {Object}\n * @property {string} type 'legendUnSelect'\n * @property {string} name Series name or data item name\n */\nregisterAction(\n    'legendUnSelect', 'legendunselected',\n    curry(legendSelectActionHandler, 'unSelect')\n);\n\n/**\n * Layout list like component.\n * It will box layout each items in group of component and then position the whole group in the viewport\n * @param {module:zrender/group/Group} group\n * @param {module:echarts/model/Component} componentModel\n * @param {module:echarts/ExtensionAPI}\n */\nfunction layout$3(group, componentModel, api) {\n    var boxLayoutParams = componentModel.getBoxLayoutParams();\n    var padding = componentModel.get('padding');\n    var viewportSize = {width: api.getWidth(), height: api.getHeight()};\n\n    var rect = getLayoutRect(\n        boxLayoutParams,\n        viewportSize,\n        padding\n    );\n\n    box(\n        componentModel.get('orient'),\n        group,\n        componentModel.get('itemGap'),\n        rect.width,\n        rect.height\n    );\n\n    positionElement(\n        group,\n        boxLayoutParams,\n        viewportSize,\n        padding\n    );\n}\n\nfunction makeBackground(rect, componentModel) {\n    var padding = normalizeCssArray$1(\n        componentModel.get('padding')\n    );\n    var style = componentModel.getItemStyle(['color', 'opacity']);\n    style.fill = componentModel.get('backgroundColor');\n    var rect = new Rect({\n        shape: {\n            x: rect.x - padding[3],\n            y: rect.y - padding[0],\n            width: rect.width + padding[1] + padding[3],\n            height: rect.height + padding[0] + padding[2],\n            r: componentModel.get('borderRadius')\n        },\n        style: style,\n        silent: true,\n        z2: -1\n    });\n    // FIXME\n    // `subPixelOptimizeRect` may bring some gap between edge of viewpart\n    // and background rect when setting like `left: 0`, `top: 0`.\n    // graphic.subPixelOptimizeRect(rect);\n\n    return rect;\n}\n\nvar curry$4 = curry;\nvar each$17 = each$1;\nvar Group$3 = Group;\n\nvar LegendView = extendComponentView({\n\n    type: 'legend.plain',\n\n    newlineDisabled: false,\n\n    /**\n     * @override\n     */\n    init: function () {\n\n        /**\n         * @private\n         * @type {module:zrender/container/Group}\n         */\n        this.group.add(this._contentGroup = new Group$3());\n\n        /**\n         * @private\n         * @type {module:zrender/Element}\n         */\n        this._backgroundEl;\n    },\n\n    /**\n     * @protected\n     */\n    getContentGroup: function () {\n        return this._contentGroup;\n    },\n\n    /**\n     * @override\n     */\n    render: function (legendModel, ecModel, api) {\n\n        this.resetInner();\n\n        if (!legendModel.get('show', true)) {\n            return;\n        }\n\n        var itemAlign = legendModel.get('align');\n        if (!itemAlign || itemAlign === 'auto') {\n            itemAlign = (\n                legendModel.get('left') === 'right'\n                && legendModel.get('orient') === 'vertical'\n            ) ? 'right' : 'left';\n        }\n\n        this.renderInner(itemAlign, legendModel, ecModel, api);\n\n        // Perform layout.\n        var positionInfo = legendModel.getBoxLayoutParams();\n        var viewportSize = {width: api.getWidth(), height: api.getHeight()};\n        var padding = legendModel.get('padding');\n\n        var maxSize = getLayoutRect(positionInfo, viewportSize, padding);\n        var mainRect = this.layoutInner(legendModel, itemAlign, maxSize);\n\n        // Place mainGroup, based on the calculated `mainRect`.\n        var layoutRect = getLayoutRect(\n            defaults({width: mainRect.width, height: mainRect.height}, positionInfo),\n            viewportSize,\n            padding\n        );\n        this.group.attr('position', [layoutRect.x - mainRect.x, layoutRect.y - mainRect.y]);\n\n        // Render background after group is layout.\n        this.group.add(\n            this._backgroundEl = makeBackground(mainRect, legendModel)\n        );\n    },\n\n    /**\n     * @protected\n     */\n    resetInner: function () {\n        this.getContentGroup().removeAll();\n        this._backgroundEl && this.group.remove(this._backgroundEl);\n    },\n\n    /**\n     * @protected\n     */\n    renderInner: function (itemAlign, legendModel, ecModel, api) {\n        var contentGroup = this.getContentGroup();\n        var legendDrawnMap = createHashMap();\n        var selectMode = legendModel.get('selectedMode');\n\n        each$17(legendModel.getData(), function (itemModel, dataIndex) {\n            var name = itemModel.get('name');\n\n            // Use empty string or \\n as a newline string\n            if (!this.newlineDisabled && (name === '' || name === '\\n')) {\n                contentGroup.add(new Group$3({\n                    newline: true\n                }));\n                return;\n            }\n\n            var seriesModel = ecModel.getSeriesByName(name)[0];\n\n            if (legendDrawnMap.get(name)) {\n                // Have been drawed\n                return;\n            }\n\n            // Series legend\n            if (seriesModel) {\n                var data = seriesModel.getData();\n                var color = data.getVisual('color');\n\n                // If color is a callback function\n                if (typeof color === 'function') {\n                    // Use the first data\n                    color = color(seriesModel.getDataParams(0));\n                }\n\n                // Using rect symbol defaultly\n                var legendSymbolType = data.getVisual('legendSymbol') || 'roundRect';\n                var symbolType = data.getVisual('symbol');\n\n                var itemGroup = this._createItem(\n                    name, dataIndex, itemModel, legendModel,\n                    legendSymbolType, symbolType,\n                    itemAlign, color,\n                    selectMode\n                );\n\n                itemGroup.on('click', curry$4(dispatchSelectAction, name, api))\n                    .on('mouseover', curry$4(dispatchHighlightAction, seriesModel, null, api))\n                    .on('mouseout', curry$4(dispatchDownplayAction, seriesModel, null, api));\n\n                legendDrawnMap.set(name, true);\n            }\n            else {\n                // Data legend of pie, funnel\n                ecModel.eachRawSeries(function (seriesModel) {\n                    // In case multiple series has same data name\n                    if (legendDrawnMap.get(name)) {\n                        return;\n                    }\n                    if (seriesModel.legendDataProvider) {\n                        var data = seriesModel.legendDataProvider();\n                        var idx = data.indexOfName(name);\n                        if (idx < 0) {\n                            return;\n                        }\n\n                        var color = data.getItemVisual(idx, 'color');\n\n                        var legendSymbolType = 'roundRect';\n\n                        var itemGroup = this._createItem(\n                            name, dataIndex, itemModel, legendModel,\n                            legendSymbolType, null,\n                            itemAlign, color,\n                            selectMode\n                        );\n\n                        itemGroup.on('click', curry$4(dispatchSelectAction, name, api))\n                            // FIXME Should not specify the series name\n                            .on('mouseover', curry$4(dispatchHighlightAction, seriesModel, name, api))\n                            .on('mouseout', curry$4(dispatchDownplayAction, seriesModel, name, api));\n\n                        legendDrawnMap.set(name, true);\n                    }\n                }, this);\n            }\n\n            if (__DEV__) {\n                if (!legendDrawnMap.get(name)) {\n                    console.warn(name + ' series not exists. Legend data should be same with series name or data name.');\n                }\n            }\n        }, this);\n    },\n\n    _createItem: function (\n        name, dataIndex, itemModel, legendModel,\n        legendSymbolType, symbolType,\n        itemAlign, color, selectMode\n    ) {\n        var itemWidth = legendModel.get('itemWidth');\n        var itemHeight = legendModel.get('itemHeight');\n        var inactiveColor = legendModel.get('inactiveColor');\n\n        var isSelected = legendModel.isSelected(name);\n        var itemGroup = new Group$3();\n\n        var textStyleModel = itemModel.getModel('textStyle');\n\n        var itemIcon = itemModel.get('icon');\n\n        var tooltipModel = itemModel.getModel('tooltip');\n        var legendGlobalTooltipModel = tooltipModel.parentModel;\n\n        // Use user given icon first\n        legendSymbolType = itemIcon || legendSymbolType;\n        itemGroup.add(createSymbol(\n            legendSymbolType,\n            0,\n            0,\n            itemWidth,\n            itemHeight,\n            isSelected ? color : inactiveColor,\n            true\n        ));\n\n        // Compose symbols\n        // PENDING\n        if (!itemIcon && symbolType\n            // At least show one symbol, can't be all none\n            && ((symbolType !== legendSymbolType) || symbolType == 'none')\n        ) {\n            var size = itemHeight * 0.8;\n            if (symbolType === 'none') {\n                symbolType = 'circle';\n            }\n            // Put symbol in the center\n            itemGroup.add(createSymbol(\n                symbolType, (itemWidth - size) / 2, (itemHeight - size) / 2, size, size,\n                isSelected ? color : inactiveColor\n            ));\n        }\n\n        var textX = itemAlign === 'left' ? itemWidth + 5 : -5;\n        var textAlign = itemAlign;\n\n        var formatter = legendModel.get('formatter');\n        var content = name;\n        if (typeof formatter === 'string' && formatter) {\n            content = formatter.replace('{name}', name != null ? name : '');\n        }\n        else if (typeof formatter === 'function') {\n            content = formatter(name);\n        }\n\n        itemGroup.add(new Text({\n            style: setTextStyle({}, textStyleModel, {\n                text: content,\n                x: textX,\n                y: itemHeight / 2,\n                textFill: isSelected ? textStyleModel.getTextColor() : inactiveColor,\n                textAlign: textAlign,\n                textVerticalAlign: 'middle'\n            })\n        }));\n\n        // Add a invisible rect to increase the area of mouse hover\n        var hitRect = new Rect({\n            shape: itemGroup.getBoundingRect(),\n            invisible: true,\n            tooltip: tooltipModel.get('show') ? extend({\n                content: name,\n                // Defaul formatter\n                formatter: legendGlobalTooltipModel.get('formatter', true) || function () {\n                    return name;\n                },\n                formatterParams: {\n                    componentType: 'legend',\n                    legendIndex: legendModel.componentIndex,\n                    name: name,\n                    $vars: ['name']\n                }\n            }, tooltipModel.option) : null\n        });\n        itemGroup.add(hitRect);\n\n        itemGroup.eachChild(function (child) {\n            child.silent = true;\n        });\n\n        hitRect.silent = !selectMode;\n\n        this.getContentGroup().add(itemGroup);\n\n        setHoverStyle(itemGroup);\n\n        itemGroup.__legendDataIndex = dataIndex;\n\n        return itemGroup;\n    },\n\n    /**\n     * @protected\n     */\n    layoutInner: function (legendModel, itemAlign, maxSize) {\n        var contentGroup = this.getContentGroup();\n\n        // Place items in contentGroup.\n        box(\n            legendModel.get('orient'),\n            contentGroup,\n            legendModel.get('itemGap'),\n            maxSize.width,\n            maxSize.height\n        );\n\n        var contentRect = contentGroup.getBoundingRect();\n        contentGroup.attr('position', [-contentRect.x, -contentRect.y]);\n\n        return this.group.getBoundingRect();\n    }\n\n});\n\nfunction dispatchSelectAction(name, api) {\n    api.dispatchAction({\n        type: 'legendToggleSelect',\n        name: name\n    });\n}\n\nfunction dispatchHighlightAction(seriesModel, dataName, api) {\n    // If element hover will move to a hoverLayer.\n    var el = api.getZr().storage.getDisplayList()[0];\n    if (!(el && el.useHoverLayer)) {\n        seriesModel.get('legendHoverLink') && api.dispatchAction({\n            type: 'highlight',\n            seriesName: seriesModel.name,\n            name: dataName\n        });\n    }\n}\n\nfunction dispatchDownplayAction(seriesModel, dataName, api) {\n    // If element hover will move to a hoverLayer.\n    var el = api.getZr().storage.getDisplayList()[0];\n    if (!(el && el.useHoverLayer)) {\n        seriesModel.get('legendHoverLink') && api.dispatchAction({\n            type: 'downplay',\n            seriesName: seriesModel.name,\n            name: dataName\n        });\n    }\n}\n\nvar legendFilter = function (ecModel) {\n\n    var legendModels = ecModel.findComponents({\n        mainType: 'legend'\n    });\n    if (legendModels && legendModels.length) {\n        ecModel.filterSeries(function (series) {\n            // If in any legend component the status is not selected.\n            // Because in legend series is assumed selected when it is not in the legend data.\n            for (var i = 0; i < legendModels.length; i++) {\n                if (!legendModels[i].isSelected(series.name)) {\n                    return false;\n                }\n            }\n            return true;\n        });\n    }\n\n};\n\n// Do not contain scrollable legend, for sake of file size.\n\n// Series Filter\nregisterProcessor(legendFilter);\n\nComponentModel.registerSubTypeDefaulter('legend', function () {\n    // Default 'plain' when no type specified.\n    return 'plain';\n});\n\nvar ScrollableLegendModel = LegendModel.extend({\n\n    type: 'legend.scroll',\n\n    /**\n     * @param {number} scrollDataIndex\n     */\n    setScrollDataIndex: function (scrollDataIndex) {\n        this.option.scrollDataIndex = scrollDataIndex;\n    },\n\n    defaultOption: {\n        scrollDataIndex: 0,\n        pageButtonItemGap: 5,\n        pageButtonGap: null,\n        pageButtonPosition: 'end', // 'start' or 'end'\n        pageFormatter: '{current}/{total}', // If null/undefined, do not show page.\n        pageIcons: {\n            horizontal: ['M0,0L12,-10L12,10z', 'M0,0L-12,-10L-12,10z'],\n            vertical: ['M0,0L20,0L10,-20z', 'M0,0L20,0L10,20z']\n        },\n        pageIconColor: '#2f4554',\n        pageIconInactiveColor: '#aaa',\n        pageIconSize: 15, // Can be [10, 3], which represents [width, height]\n        pageTextStyle: {\n            color: '#333'\n        },\n\n        animationDurationUpdate: 800\n    },\n\n    /**\n     * @override\n     */\n    init: function (option, parentModel, ecModel, extraOpt) {\n        var inputPositionParams = getLayoutParams(option);\n\n        ScrollableLegendModel.superCall(this, 'init', option, parentModel, ecModel, extraOpt);\n\n        mergeAndNormalizeLayoutParams(this, option, inputPositionParams);\n    },\n\n    /**\n     * @override\n     */\n    mergeOption: function (option, extraOpt) {\n        ScrollableLegendModel.superCall(this, 'mergeOption', option, extraOpt);\n\n        mergeAndNormalizeLayoutParams(this, this.option, option);\n    },\n\n    getOrient: function () {\n        return this.get('orient') === 'vertical'\n            ? {index: 1, name: 'vertical'}\n            : {index: 0, name: 'horizontal'};\n    }\n\n});\n\n// Do not `ignoreSize` to enable setting {left: 10, right: 10}.\nfunction mergeAndNormalizeLayoutParams(legendModel, target, raw) {\n    var orient = legendModel.getOrient();\n    var ignoreSize = [1, 1];\n    ignoreSize[orient.index] = 0;\n    mergeLayoutParam(target, raw, {\n        type: 'box', ignoreSize: ignoreSize\n    });\n}\n\n/**\n * Separate legend and scrollable legend to reduce package size.\n */\n\nvar Group$4 = Group;\n\nvar WH$1 = ['width', 'height'];\nvar XY$1 = ['x', 'y'];\n\nvar ScrollableLegendView = LegendView.extend({\n\n    type: 'legend.scroll',\n\n    newlineDisabled: true,\n\n    init: function () {\n\n        ScrollableLegendView.superCall(this, 'init');\n\n        /**\n         * @private\n         * @type {number} For `scroll`.\n         */\n        this._currentIndex = 0;\n\n        /**\n         * @private\n         * @type {module:zrender/container/Group}\n         */\n        this.group.add(this._containerGroup = new Group$4());\n        this._containerGroup.add(this.getContentGroup());\n\n        /**\n         * @private\n         * @type {module:zrender/container/Group}\n         */\n        this.group.add(this._controllerGroup = new Group$4());\n\n        /**\n         *\n         * @private\n         */\n        this._showController;\n    },\n\n    /**\n     * @override\n     */\n    resetInner: function () {\n        ScrollableLegendView.superCall(this, 'resetInner');\n\n        this._controllerGroup.removeAll();\n        this._containerGroup.removeClipPath();\n        this._containerGroup.__rectSize = null;\n    },\n\n    /**\n     * @override\n     */\n    renderInner: function (itemAlign, legendModel, ecModel, api) {\n        var me = this;\n\n        // Render content items.\n        ScrollableLegendView.superCall(this, 'renderInner', itemAlign, legendModel, ecModel, api);\n\n        var controllerGroup = this._controllerGroup;\n\n        var pageIconSize = legendModel.get('pageIconSize', true);\n        if (!isArray(pageIconSize)) {\n            pageIconSize = [pageIconSize, pageIconSize];\n        }\n\n        createPageButton('pagePrev', 0);\n\n        var pageTextStyleModel = legendModel.getModel('pageTextStyle');\n        controllerGroup.add(new Text({\n            name: 'pageText',\n            style: {\n                textFill: pageTextStyleModel.getTextColor(),\n                font: pageTextStyleModel.getFont(),\n                textVerticalAlign: 'middle',\n                textAlign: 'center'\n            },\n            silent: true\n        }));\n\n        createPageButton('pageNext', 1);\n\n        function createPageButton(name, iconIdx) {\n            var pageDataIndexName = name + 'DataIndex';\n            var icon = createIcon(\n                legendModel.get('pageIcons', true)[legendModel.getOrient().name][iconIdx],\n                {\n                    // Buttons will be created in each render, so we do not need\n                    // to worry about avoiding using legendModel kept in scope.\n                    onclick: bind(\n                        me._pageGo, me, pageDataIndexName, legendModel, api\n                    )\n                },\n                {\n                    x: -pageIconSize[0] / 2,\n                    y: -pageIconSize[1] / 2,\n                    width: pageIconSize[0],\n                    height: pageIconSize[1]\n                }\n            );\n            icon.name = name;\n            controllerGroup.add(icon);\n        }\n    },\n\n    /**\n     * @override\n     */\n    layoutInner: function (legendModel, itemAlign, maxSize) {\n        var contentGroup = this.getContentGroup();\n        var containerGroup = this._containerGroup;\n        var controllerGroup = this._controllerGroup;\n\n        var orientIdx = legendModel.getOrient().index;\n        var wh = WH$1[orientIdx];\n        var hw = WH$1[1 - orientIdx];\n        var yx = XY$1[1 - orientIdx];\n\n        // Place items in contentGroup.\n        box(\n            legendModel.get('orient'),\n            contentGroup,\n            legendModel.get('itemGap'),\n            !orientIdx ? null : maxSize.width,\n            orientIdx ? null : maxSize.height\n        );\n\n        box(\n            // Buttons in controller are layout always horizontally.\n            'horizontal',\n            controllerGroup,\n            legendModel.get('pageButtonItemGap', true)\n        );\n\n        var contentRect = contentGroup.getBoundingRect();\n        var controllerRect = controllerGroup.getBoundingRect();\n        var showController = this._showController = contentRect[wh] > maxSize[wh];\n\n        var contentPos = [-contentRect.x, -contentRect.y];\n        // Remain contentPos when scroll animation perfroming.\n        contentPos[orientIdx] = contentGroup.position[orientIdx];\n\n        // Layout container group based on 0.\n        var containerPos = [0, 0];\n        var controllerPos = [-controllerRect.x, -controllerRect.y];\n        var pageButtonGap = retrieve2(\n            legendModel.get('pageButtonGap', true), legendModel.get('itemGap', true)\n        );\n\n        // Place containerGroup and controllerGroup and contentGroup.\n        if (showController) {\n            var pageButtonPosition = legendModel.get('pageButtonPosition', true);\n            // controller is on the right / bottom.\n            if (pageButtonPosition === 'end') {\n                controllerPos[orientIdx] += maxSize[wh] - controllerRect[wh];\n            }\n            // controller is on the left / top.\n            else {\n                containerPos[orientIdx] += controllerRect[wh] + pageButtonGap;\n            }\n        }\n\n        // Always align controller to content as 'middle'.\n        controllerPos[1 - orientIdx] += contentRect[hw] / 2 - controllerRect[hw] / 2;\n\n        contentGroup.attr('position', contentPos);\n        containerGroup.attr('position', containerPos);\n        controllerGroup.attr('position', controllerPos);\n\n        // Calculate `mainRect` and set `clipPath`.\n        // mainRect should not be calculated by `this.group.getBoundingRect()`\n        // for sake of the overflow.\n        var mainRect = this.group.getBoundingRect();\n        var mainRect = {x: 0, y: 0};\n        // Consider content may be overflow (should be clipped).\n        mainRect[wh] = showController ? maxSize[wh] : contentRect[wh];\n        mainRect[hw] = Math.max(contentRect[hw], controllerRect[hw]);\n        // `containerRect[yx] + containerPos[1 - orientIdx]` is 0.\n        mainRect[yx] = Math.min(0, controllerRect[yx] + controllerPos[1 - orientIdx]);\n\n        containerGroup.__rectSize = maxSize[wh];\n        if (showController) {\n            var clipShape = {x: 0, y: 0};\n            clipShape[wh] = Math.max(maxSize[wh] - controllerRect[wh] - pageButtonGap, 0);\n            clipShape[hw] = mainRect[hw];\n            containerGroup.setClipPath(new Rect({shape: clipShape}));\n            // Consider content may be larger than container, container rect\n            // can not be obtained from `containerGroup.getBoundingRect()`.\n            containerGroup.__rectSize = clipShape[wh];\n        }\n        else {\n            // Do not remove or ignore controller. Keep them set as place holders.\n            controllerGroup.eachChild(function (child) {\n                child.attr({invisible: true, silent: true});\n            });\n        }\n\n        // Content translate animation.\n        var pageInfo = this._getPageInfo(legendModel);\n        pageInfo.pageIndex != null && updateProps(\n            contentGroup,\n            {position: pageInfo.contentPosition},\n            // When switch from \"show controller\" to \"not show controller\", view should be\n            // updated immediately without animation, otherwise causes weird efffect.\n            showController ? legendModel : false\n        );\n\n        this._updatePageInfoView(legendModel, pageInfo);\n\n        return mainRect;\n    },\n\n    _pageGo: function (to, legendModel, api) {\n        var scrollDataIndex = this._getPageInfo(legendModel)[to];\n\n        scrollDataIndex != null && api.dispatchAction({\n            type: 'legendScroll',\n            scrollDataIndex: scrollDataIndex,\n            legendId: legendModel.id\n        });\n    },\n\n    _updatePageInfoView: function (legendModel, pageInfo) {\n        var controllerGroup = this._controllerGroup;\n\n        each$1(['pagePrev', 'pageNext'], function (name) {\n            var canJump = pageInfo[name + 'DataIndex'] != null;\n            var icon = controllerGroup.childOfName(name);\n            if (icon) {\n                icon.setStyle(\n                    'fill',\n                    canJump\n                        ? legendModel.get('pageIconColor', true)\n                        : legendModel.get('pageIconInactiveColor', true)\n                );\n                icon.cursor = canJump ? 'pointer' : 'default';\n            }\n        });\n\n        var pageText = controllerGroup.childOfName('pageText');\n        var pageFormatter = legendModel.get('pageFormatter');\n        var pageIndex = pageInfo.pageIndex;\n        var current = pageIndex != null ? pageIndex + 1 : 0;\n        var total = pageInfo.pageCount;\n\n        pageText && pageFormatter && pageText.setStyle(\n            'text',\n            isString(pageFormatter)\n                ? pageFormatter.replace('{current}', current).replace('{total}', total)\n                : pageFormatter({current: current, total: total})\n        );\n    },\n\n    /**\n     * @param {module:echarts/model/Model} legendModel\n     * @return {Object} {\n     *  contentPosition: Array.<number>, null when data item not found.\n     *  pageIndex: number, null when data item not found.\n     *  pageCount: number, always be a number, can be 0.\n     *  pagePrevDataIndex: number, null when no next page.\n     *  pageNextDataIndex: number, null when no previous page.\n     * }\n     */\n    _getPageInfo: function (legendModel) {\n        // Align left or top by the current dataIndex.\n        var currDataIndex = legendModel.get('scrollDataIndex', true);\n        var contentGroup = this.getContentGroup();\n        var contentRect = contentGroup.getBoundingRect();\n        var containerRectSize = this._containerGroup.__rectSize;\n\n        var orientIdx = legendModel.getOrient().index;\n        var wh = WH$1[orientIdx];\n        var hw = WH$1[1 - orientIdx];\n        var xy = XY$1[orientIdx];\n        var contentPos = contentGroup.position.slice();\n\n        var pageIndex;\n        var pagePrevDataIndex;\n        var pageNextDataIndex;\n\n        var targetItemGroup;\n        if (this._showController) {\n            contentGroup.eachChild(function (child) {\n                if (child.__legendDataIndex === currDataIndex) {\n                    targetItemGroup = child;\n                }\n            });\n        }\n        else {\n            targetItemGroup = contentGroup.childAt(0);\n        }\n\n        var pageCount = containerRectSize ? Math.ceil(contentRect[wh] / containerRectSize) : 0;\n\n        if (targetItemGroup) {\n            var itemRect = targetItemGroup.getBoundingRect();\n            var itemLoc = targetItemGroup.position[orientIdx] + itemRect[xy];\n            contentPos[orientIdx] = -itemLoc - contentRect[xy];\n            pageIndex = Math.floor(\n                pageCount * (itemLoc + itemRect[xy] + containerRectSize / 2) / contentRect[wh]\n            );\n            pageIndex = (contentRect[wh] && pageCount)\n                ? Math.max(0, Math.min(pageCount - 1, pageIndex))\n                : -1;\n\n            var winRect = {x: 0, y: 0};\n            winRect[wh] = containerRectSize;\n            winRect[hw] = contentRect[hw];\n            winRect[xy] = -contentPos[orientIdx] - contentRect[xy];\n\n            var startIdx;\n            var children = contentGroup.children();\n\n            contentGroup.eachChild(function (child, index) {\n                var itemRect = getItemRect(child);\n\n                if (itemRect.intersect(winRect)) {\n                    startIdx == null && (startIdx = index);\n                    // It is user-friendly that the last item shown in the\n                    // current window is shown at the begining of next window.\n                    pageNextDataIndex = child.__legendDataIndex;\n                }\n\n                // If the last item is shown entirely, no next page.\n                if (index === children.length - 1\n                    && itemRect[xy] + itemRect[wh] <= winRect[xy] + winRect[wh]\n                ) {\n                    pageNextDataIndex = null;\n                }\n            });\n\n            // Always align based on the left/top most item, so the left/top most\n            // item in the previous window is needed to be found here.\n            if (startIdx != null) {\n                var startItem = children[startIdx];\n                var startRect = getItemRect(startItem);\n                winRect[xy] = startRect[xy] + startRect[wh] - winRect[wh];\n\n                // If the first item is shown entirely, no previous page.\n                if (startIdx <= 0 && startRect[xy] >= winRect[xy]) {\n                    pagePrevDataIndex = null;\n                }\n                else {\n                    while (startIdx > 0 && getItemRect(children[startIdx - 1]).intersect(winRect)) {\n                        startIdx--;\n                    }\n                    pagePrevDataIndex = children[startIdx].__legendDataIndex;\n                }\n            }\n        }\n\n        return {\n            contentPosition: contentPos,\n            pageIndex: pageIndex,\n            pageCount: pageCount,\n            pagePrevDataIndex: pagePrevDataIndex,\n            pageNextDataIndex: pageNextDataIndex\n        };\n\n        function getItemRect(el) {\n            var itemRect = el.getBoundingRect().clone();\n            itemRect[xy] += el.position[orientIdx];\n            return itemRect;\n        }\n    }\n\n});\n\n/**\n * @event legendScroll\n * @type {Object}\n * @property {string} type 'legendScroll'\n * @property {string} scrollDataIndex\n */\nregisterAction(\n    'legendScroll', 'legendscroll',\n    function (payload, ecModel) {\n        var scrollDataIndex = payload.scrollDataIndex;\n\n        scrollDataIndex != null && ecModel.eachComponent(\n            {mainType: 'legend', subType: 'scroll', query: payload},\n            function (legendModel) {\n                legendModel.setScrollDataIndex(scrollDataIndex);\n            }\n        );\n    }\n);\n\n/**\n * Legend component entry file8\n */\n\nextendComponentModel({\n\n    type: 'tooltip',\n\n    dependencies: ['axisPointer'],\n\n    defaultOption: {\n        zlevel: 0,\n\n        z: 8,\n\n        show: true,\n\n        // tooltip\n        showContent: true,\n\n        // 'trigger' only works on coordinate system.\n        // 'item' | 'axis' | 'none'\n        trigger: 'item',\n\n        // 'click' | 'mousemove' | 'none'\n        triggerOn: 'mousemove|click',\n\n        alwaysShowContent: false,\n\n        displayMode: 'single', // 'single' | 'multipleByCoordSys'\n\n        //  {Array} | {Function}\n        // position: null\n        // Consider triggered from axisPointer handle, verticalAlign should be 'middle'\n        // align: null,\n        // verticalAlign: null,\n\n        //  content  viewRect  false \n        confine: false,\n\n        // {string}Template  {Function}\n        // formatter: null\n\n        showDelay: 0,\n\n        // ms\n        hideDelay: 100,\n\n        // s\n        transitionDuration: 0.4,\n\n        enterable: false,\n\n        // 0.7\n        backgroundColor: 'rgba(50,50,50,0.7)',\n\n        // \n        borderColor: '#333',\n\n        // px4\n        borderRadius: 4,\n\n        // px0\n        borderWidth: 0,\n\n        // px5\n        // css\n        padding: 5,\n\n        // Extra css text\n        extraCssText: '',\n\n        // \n        axisPointer: {\n            // \n            // 'line' | 'shadow' | 'cross'\n            type: 'line',\n\n            // type  line  tooltip line \n            //  'x' | 'y' | 'angle' | 'radius' | 'auto'\n            //  'auto' category  x \n            //  angle \n            axis: 'auto',\n\n            animation: 'auto',\n            animationDurationUpdate: 200,\n            animationEasingUpdate: 'exponentialOut',\n\n            crossStyle: {\n                color: '#999',\n                width: 1,\n                type: 'dashed',\n\n                // TODO formatter\n                textStyle: {}\n            }\n\n            // lineStyle and shadowStyle should not be specified here,\n            // otherwise it will always override those styles on option.axisPointer.\n        },\n        textStyle: {\n            color: '#fff',\n            fontSize: 14\n        }\n    }\n});\n\nvar each$19 = each$1;\nvar toCamelCase$1 = toCamelCase;\n\nvar vendors = ['', '-webkit-', '-moz-', '-o-'];\n\nvar gCssText = 'position:absolute;display:block;border-style:solid;white-space:nowrap;z-index:9999999;';\n\n/**\n * @param {number} duration\n * @return {string}\n * @inner\n */\nfunction assembleTransition(duration) {\n    var transitionCurve = 'cubic-bezier(0.23, 1, 0.32, 1)';\n    var transitionText = 'left ' + duration + 's ' + transitionCurve + ','\n                        + 'top ' + duration + 's ' + transitionCurve;\n    return map(vendors, function (vendorPrefix) {\n        return vendorPrefix + 'transition:' + transitionText;\n    }).join(';');\n}\n\n/**\n * @param {Object} textStyle\n * @return {string}\n * @inner\n */\nfunction assembleFont(textStyleModel) {\n    var cssText = [];\n\n    var fontSize = textStyleModel.get('fontSize');\n    var color = textStyleModel.getTextColor();\n\n    color && cssText.push('color:' + color);\n\n    cssText.push('font:' + textStyleModel.getFont());\n\n    fontSize &&\n        cssText.push('line-height:' + Math.round(fontSize * 3 / 2) + 'px');\n\n    each$19(['decoration', 'align'], function (name) {\n        var val = textStyleModel.get(name);\n        val && cssText.push('text-' + name + ':' + val);\n    });\n\n    return cssText.join(';');\n}\n\n/**\n * @param {Object} tooltipModel\n * @return {string}\n * @inner\n */\nfunction assembleCssText(tooltipModel) {\n\n    var cssText = [];\n\n    var transitionDuration = tooltipModel.get('transitionDuration');\n    var backgroundColor = tooltipModel.get('backgroundColor');\n    var textStyleModel = tooltipModel.getModel('textStyle');\n    var padding = tooltipModel.get('padding');\n\n    // Animation transition. Do not animate when transitionDuration is 0.\n    transitionDuration &&\n        cssText.push(assembleTransition(transitionDuration));\n\n    if (backgroundColor) {\n        if (env$1.canvasSupported) {\n            cssText.push('background-Color:' + backgroundColor);\n        }\n        else {\n            // for ie\n            cssText.push(\n                'background-Color:#' + toHex(backgroundColor)\n            );\n            cssText.push('filter:alpha(opacity=70)');\n        }\n    }\n\n    // Border style\n    each$19(['width', 'color', 'radius'], function (name) {\n        var borderName = 'border-' + name;\n        var camelCase = toCamelCase$1(borderName);\n        var val = tooltipModel.get(camelCase);\n        val != null &&\n            cssText.push(borderName + ':' + val + (name === 'color' ? '' : 'px'));\n    });\n\n    // Text style\n    cssText.push(assembleFont(textStyleModel));\n\n    // Padding\n    if (padding != null) {\n        cssText.push('padding:' + normalizeCssArray$1(padding).join('px ') + 'px');\n    }\n\n    return cssText.join(';') + ';';\n}\n\n/**\n * @alias module:echarts/component/tooltip/TooltipContent\n * @constructor\n */\nfunction TooltipContent(container, api) {\n    if (env$1.wxa) {\n        return null;\n    }\n\n    var el = document.createElement('div');\n    var zr = this._zr = api.getZr();\n\n    this.el = el;\n\n    this._x = api.getWidth() / 2;\n    this._y = api.getHeight() / 2;\n\n    container.appendChild(el);\n\n    this._container = container;\n\n    this._show = false;\n\n    /**\n     * @private\n     */\n    this._hideTimeout;\n\n    var self = this;\n    el.onmouseenter = function () {\n        // clear the timeout in hideLater and keep showing tooltip\n        if (self._enterable) {\n            clearTimeout(self._hideTimeout);\n            self._show = true;\n        }\n        self._inContent = true;\n    };\n    el.onmousemove = function (e) {\n        e = e || window.event;\n        if (!self._enterable) {\n            // Try trigger zrender event to avoid mouse\n            // in and out shape too frequently\n            var handler = zr.handler;\n            normalizeEvent(container, e, true);\n            handler.dispatch('mousemove', e);\n        }\n    };\n    el.onmouseleave = function () {\n        if (self._enterable) {\n            if (self._show) {\n                self.hideLater(self._hideDelay);\n            }\n        }\n        self._inContent = false;\n    };\n}\n\nTooltipContent.prototype = {\n\n    constructor: TooltipContent,\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    _enterable: true,\n\n    /**\n     * Update when tooltip is rendered\n     */\n    update: function () {\n        // FIXME\n        // Move this logic to ec main?\n        var container = this._container;\n        var stl = container.currentStyle\n            || document.defaultView.getComputedStyle(container);\n        var domStyle = container.style;\n        if (domStyle.position !== 'absolute' && stl.position !== 'absolute') {\n            domStyle.position = 'relative';\n        }\n        // Hide the tooltip\n        // PENDING\n        // this.hide();\n    },\n\n    show: function (tooltipModel) {\n        clearTimeout(this._hideTimeout);\n        var el = this.el;\n\n        el.style.cssText = gCssText + assembleCssText(tooltipModel)\n            // http://stackoverflow.com/questions/21125587/css3-transition-not-working-in-chrome-anymore\n            + ';left:' + this._x + 'px;top:' + this._y + 'px;'\n            + (tooltipModel.get('extraCssText') || '');\n\n        el.style.display = el.innerHTML ?  'block' : 'none';\n\n        this._show = true;\n    },\n\n    setContent: function (content) {\n        this.el.innerHTML = content == null ? '' : content;\n    },\n\n    setEnterable: function (enterable) {\n        this._enterable = enterable;\n    },\n\n    getSize: function () {\n        var el = this.el;\n        return [el.clientWidth, el.clientHeight];\n    },\n\n    moveTo: function (x, y) {\n        // xy should be based on canvas root. But tooltipContent is\n        // the sibling of canvas root. So padding of ec container\n        // should be considered here.\n        var zr = this._zr;\n        var viewportRootOffset;\n        if (zr && zr.painter && (viewportRootOffset = zr.painter.getViewportRootOffset())) {\n            x += viewportRootOffset.offsetLeft;\n            y += viewportRootOffset.offsetTop;\n        }\n\n        var style = this.el.style;\n        style.left = x + 'px';\n        style.top = y + 'px';\n\n        this._x = x;\n        this._y = y;\n    },\n\n    hide: function () {\n        this.el.style.display = 'none';\n        this._show = false;\n    },\n\n    hideLater: function (time) {\n        if (this._show && !(this._inContent && this._enterable)) {\n            if (time) {\n                this._hideDelay = time;\n                // Set show false to avoid invoke hideLater mutiple times\n                this._show = false;\n                this._hideTimeout = setTimeout(bind(this.hide, this), time);\n            }\n            else {\n                this.hide();\n            }\n        }\n    },\n\n    isShow: function () {\n        return this._show;\n    }\n};\n\nvar bind$3 = bind;\nvar each$18 = each$1;\nvar parsePercent$2 = parsePercent$1;\n\nvar proxyRect = new Rect({\n    shape: {x: -1, y: -1, width: 2, height: 2}\n});\n\nextendComponentView({\n\n    type: 'tooltip',\n\n    init: function (ecModel, api) {\n        if (env$1.node) {\n            return;\n        }\n        var tooltipContent = new TooltipContent(api.getDom(), api);\n        this._tooltipContent = tooltipContent;\n    },\n\n    render: function (tooltipModel, ecModel, api) {\n        if (env$1.node || env$1.wxa) {\n            return;\n        }\n\n        // Reset\n        this.group.removeAll();\n\n        /**\n         * @private\n         * @type {module:echarts/component/tooltip/TooltipModel}\n         */\n        this._tooltipModel = tooltipModel;\n\n        /**\n         * @private\n         * @type {module:echarts/model/Global}\n         */\n        this._ecModel = ecModel;\n\n        /**\n         * @private\n         * @type {module:echarts/ExtensionAPI}\n         */\n        this._api = api;\n\n        /**\n         * Should be cleaned when render.\n         * @private\n         * @type {Array.<Array.<Object>>}\n         */\n        this._lastDataByCoordSys = null;\n\n        /**\n         * @private\n         * @type {boolean}\n         */\n        this._alwaysShowContent = tooltipModel.get('alwaysShowContent');\n\n        var tooltipContent = this._tooltipContent;\n        tooltipContent.update();\n        tooltipContent.setEnterable(tooltipModel.get('enterable'));\n\n        this._initGlobalListener();\n\n        this._keepShow();\n    },\n\n    _initGlobalListener: function () {\n        var tooltipModel = this._tooltipModel;\n        var triggerOn = tooltipModel.get('triggerOn');\n\n        register(\n            'itemTooltip',\n            this._api,\n            bind$3(function (currTrigger, e, dispatchAction) {\n                // If 'none', it is not controlled by mouse totally.\n                if (triggerOn !== 'none') {\n                    if (triggerOn.indexOf(currTrigger) >= 0) {\n                        this._tryShow(e, dispatchAction);\n                    }\n                    else if (currTrigger === 'leave') {\n                        this._hide(dispatchAction);\n                    }\n                }\n            }, this)\n        );\n    },\n\n    _keepShow: function () {\n        var tooltipModel = this._tooltipModel;\n        var ecModel = this._ecModel;\n        var api = this._api;\n\n        // Try to keep the tooltip show when refreshing\n        if (this._lastX != null\n            && this._lastY != null\n            // When user is willing to control tooltip totally using API,\n            // self.manuallyShowTip({x, y}) might cause tooltip hide,\n            // which is not expected.\n            && tooltipModel.get('triggerOn') !== 'none'\n        ) {\n            var self = this;\n            clearTimeout(this._refreshUpdateTimeout);\n            this._refreshUpdateTimeout = setTimeout(function () {\n                // Show tip next tick after other charts are rendered\n                // In case highlight action has wrong result\n                // FIXME\n                self.manuallyShowTip(tooltipModel, ecModel, api, {\n                    x: self._lastX,\n                    y: self._lastY\n                });\n            });\n        }\n    },\n\n    /**\n     * Show tip manually by\n     * dispatchAction({\n     *     type: 'showTip',\n     *     x: 10,\n     *     y: 10\n     * });\n     * Or\n     * dispatchAction({\n     *      type: 'showTip',\n     *      seriesIndex: 0,\n     *      dataIndex or dataIndexInside or name\n     * });\n     *\n     *  TODO Batch\n     */\n    manuallyShowTip: function (tooltipModel, ecModel, api, payload) {\n        if (payload.from === this.uid || env$1.node) {\n            return;\n        }\n\n        var dispatchAction = makeDispatchAction$1(payload, api);\n\n        // Reset ticket\n        this._ticket = '';\n\n        // When triggered from axisPointer.\n        var dataByCoordSys = payload.dataByCoordSys;\n\n        if (payload.tooltip && payload.x != null && payload.y != null) {\n            var el = proxyRect;\n            el.position = [payload.x, payload.y];\n            el.update();\n            el.tooltip = payload.tooltip;\n            // Manually show tooltip while view is not using zrender elements.\n            this._tryShow({\n                offsetX: payload.x,\n                offsetY: payload.y,\n                target: el\n            }, dispatchAction);\n        }\n        else if (dataByCoordSys) {\n            this._tryShow({\n                offsetX: payload.x,\n                offsetY: payload.y,\n                position: payload.position,\n                event: {},\n                dataByCoordSys: payload.dataByCoordSys,\n                tooltipOption: payload.tooltipOption\n            }, dispatchAction);\n        }\n        else if (payload.seriesIndex != null) {\n\n            if (this._manuallyAxisShowTip(tooltipModel, ecModel, api, payload)) {\n                return;\n            }\n\n            var pointInfo = findPointFromSeries(payload, ecModel);\n            var cx = pointInfo.point[0];\n            var cy = pointInfo.point[1];\n            if (cx != null && cy != null) {\n                this._tryShow({\n                    offsetX: cx,\n                    offsetY: cy,\n                    position: payload.position,\n                    target: pointInfo.el,\n                    event: {}\n                }, dispatchAction);\n            }\n        }\n        else if (payload.x != null && payload.y != null) {\n            // FIXME\n            // should wrap dispatchAction like `axisPointer/globalListener` ?\n            api.dispatchAction({\n                type: 'updateAxisPointer',\n                x: payload.x,\n                y: payload.y\n            });\n\n            this._tryShow({\n                offsetX: payload.x,\n                offsetY: payload.y,\n                position: payload.position,\n                target: api.getZr().findHover(payload.x, payload.y).target,\n                event: {}\n            }, dispatchAction);\n        }\n    },\n\n    manuallyHideTip: function (tooltipModel, ecModel, api, payload) {\n        var tooltipContent = this._tooltipContent;\n\n        if (!this._alwaysShowContent && this._tooltipModel) {\n            tooltipContent.hideLater(this._tooltipModel.get('hideDelay'));\n        }\n\n        this._lastX = this._lastY = null;\n\n        if (payload.from !== this.uid) {\n            this._hide(makeDispatchAction$1(payload, api));\n        }\n    },\n\n    // Be compatible with previous design, that is, when tooltip.type is 'axis' and\n    // dispatchAction 'showTip' with seriesIndex and dataIndex will trigger axis pointer\n    // and tooltip.\n    _manuallyAxisShowTip: function (tooltipModel, ecModel, api, payload) {\n        var seriesIndex = payload.seriesIndex;\n        var dataIndex = payload.dataIndex;\n        var coordSysAxesInfo = ecModel.getComponent('axisPointer').coordSysAxesInfo;\n\n        if (seriesIndex == null || dataIndex == null || coordSysAxesInfo == null) {\n            return;\n        }\n\n        var seriesModel = ecModel.getSeriesByIndex(seriesIndex);\n        if (!seriesModel) {\n            return;\n        }\n\n        var data = seriesModel.getData();\n        var tooltipModel = buildTooltipModel([\n            data.getItemModel(dataIndex),\n            seriesModel,\n            (seriesModel.coordinateSystem || {}).model,\n            tooltipModel\n        ]);\n\n        if (tooltipModel.get('trigger') !== 'axis') {\n            return;\n        }\n\n        api.dispatchAction({\n            type: 'updateAxisPointer',\n            seriesIndex: seriesIndex,\n            dataIndex: dataIndex,\n            position: payload.position\n        });\n\n        return true;\n    },\n\n    _tryShow: function (e, dispatchAction) {\n        var el = e.target;\n        var tooltipModel = this._tooltipModel;\n\n        if (!tooltipModel) {\n            return;\n        }\n\n        // Save mouse x, mouse y. So we can try to keep showing the tip if chart is refreshed\n        this._lastX = e.offsetX;\n        this._lastY = e.offsetY;\n\n        var dataByCoordSys = e.dataByCoordSys;\n        if (dataByCoordSys && dataByCoordSys.length) {\n            this._showAxisTooltip(dataByCoordSys, e);\n        }\n        // Always show item tooltip if mouse is on the element with dataIndex\n        else if (el && el.dataIndex != null) {\n            this._lastDataByCoordSys = null;\n            this._showSeriesItemTooltip(e, el, dispatchAction);\n        }\n        // Tooltip provided directly. Like legend.\n        else if (el && el.tooltip) {\n            this._lastDataByCoordSys = null;\n            this._showComponentItemTooltip(e, el, dispatchAction);\n        }\n        else {\n            this._lastDataByCoordSys = null;\n            this._hide(dispatchAction);\n        }\n    },\n\n    _showOrMove: function (tooltipModel, cb) {\n        // showDelay is used in this case: tooltip.enterable is set\n        // as true. User intent to move mouse into tooltip and click\n        // something. `showDelay` makes it easyer to enter the content\n        // but tooltip do not move immediately.\n        var delay = tooltipModel.get('showDelay');\n        cb = bind(cb, this);\n        clearTimeout(this._showTimout);\n        delay > 0\n            ? (this._showTimout = setTimeout(cb, delay))\n            : cb();\n    },\n\n    _showAxisTooltip: function (dataByCoordSys, e) {\n        var ecModel = this._ecModel;\n        var globalTooltipModel = this._tooltipModel;\n        var point = [e.offsetX, e.offsetY];\n        var singleDefaultHTML = [];\n        var singleParamsList = [];\n        var singleTooltipModel = buildTooltipModel([\n            e.tooltipOption,\n            globalTooltipModel\n        ]);\n\n        each$18(dataByCoordSys, function (itemCoordSys) {\n            // var coordParamList = [];\n            // var coordDefaultHTML = [];\n            // var coordTooltipModel = buildTooltipModel([\n            //     e.tooltipOption,\n            //     itemCoordSys.tooltipOption,\n            //     ecModel.getComponent(itemCoordSys.coordSysMainType, itemCoordSys.coordSysIndex),\n            //     globalTooltipModel\n            // ]);\n            // var displayMode = coordTooltipModel.get('displayMode');\n            // var paramsList = displayMode === 'single' ? singleParamsList : [];\n\n            each$18(itemCoordSys.dataByAxis, function (item) {\n                var axisModel = ecModel.getComponent(item.axisDim + 'Axis', item.axisIndex);\n                var axisValue = item.value;\n                var seriesDefaultHTML = [];\n\n                if (!axisModel || axisValue == null) {\n                    return;\n                }\n\n                var valueLabel = getValueLabel(\n                    axisValue, axisModel.axis, ecModel,\n                    item.seriesDataIndices,\n                    item.valueLabelOpt\n                );\n\n                each$1(item.seriesDataIndices, function (idxItem) {\n                    var series = ecModel.getSeriesByIndex(idxItem.seriesIndex);\n                    var dataIndex = idxItem.dataIndexInside;\n                    var dataParams = series && series.getDataParams(dataIndex);\n                    dataParams.axisDim = item.axisDim;\n                    dataParams.axisIndex = item.axisIndex;\n                    dataParams.axisType = item.axisType;\n                    dataParams.axisId = item.axisId;\n                    dataParams.axisValue = getAxisRawValue(axisModel.axis, axisValue);\n                    dataParams.axisValueLabel = valueLabel;\n\n                    if (dataParams) {\n                        singleParamsList.push(dataParams);\n                        seriesDefaultHTML.push(series.formatTooltip(dataIndex, true));\n                    }\n                });\n\n                // Default tooltip content\n                // FIXME\n                // (1) shold be the first data which has name?\n                // (2) themeRiver, firstDataIndex is array, and first line is unnecessary.\n                var firstLine = valueLabel;\n                singleDefaultHTML.push(\n                    (firstLine ? encodeHTML(firstLine) + '<br />' : '')\n                    + seriesDefaultHTML.join('<br />')\n                );\n            });\n        }, this);\n\n        // In most case, the second axis is shown upper than the first one.\n        singleDefaultHTML.reverse();\n        singleDefaultHTML = singleDefaultHTML.join('<br /><br />');\n\n        var positionExpr = e.position;\n        this._showOrMove(singleTooltipModel, function () {\n            if (this._updateContentNotChangedOnAxis(dataByCoordSys)) {\n                this._updatePosition(\n                    singleTooltipModel,\n                    positionExpr,\n                    point[0], point[1],\n                    this._tooltipContent,\n                    singleParamsList\n                );\n            }\n            else {\n                this._showTooltipContent(\n                    singleTooltipModel, singleDefaultHTML, singleParamsList, Math.random(),\n                    point[0], point[1], positionExpr\n                );\n            }\n        });\n\n        // Do not trigger events here, because this branch only be entered\n        // from dispatchAction.\n    },\n\n    _showSeriesItemTooltip: function (e, el, dispatchAction) {\n        var ecModel = this._ecModel;\n        // Use dataModel in element if possible\n        // Used when mouseover on a element like markPoint or edge\n        // In which case, the data is not main data in series.\n        var seriesIndex = el.seriesIndex;\n        var seriesModel = ecModel.getSeriesByIndex(seriesIndex);\n\n        // For example, graph link.\n        var dataModel = el.dataModel || seriesModel;\n        var dataIndex = el.dataIndex;\n        var dataType = el.dataType;\n        var data = dataModel.getData();\n\n        var tooltipModel = buildTooltipModel([\n            data.getItemModel(dataIndex),\n            dataModel,\n            seriesModel && (seriesModel.coordinateSystem || {}).model,\n            this._tooltipModel\n        ]);\n\n        var tooltipTrigger = tooltipModel.get('trigger');\n        if (tooltipTrigger != null && tooltipTrigger !== 'item') {\n            return;\n        }\n\n        var params = dataModel.getDataParams(dataIndex, dataType);\n        var defaultHtml = dataModel.formatTooltip(dataIndex, false, dataType);\n        var asyncTicket = 'item_' + dataModel.name + '_' + dataIndex;\n\n        this._showOrMove(tooltipModel, function () {\n            this._showTooltipContent(\n                tooltipModel, defaultHtml, params, asyncTicket,\n                e.offsetX, e.offsetY, e.position, e.target\n            );\n        });\n\n        // FIXME\n        // duplicated showtip if manuallyShowTip is called from dispatchAction.\n        dispatchAction({\n            type: 'showTip',\n            dataIndexInside: dataIndex,\n            dataIndex: data.getRawIndex(dataIndex),\n            seriesIndex: seriesIndex,\n            from: this.uid\n        });\n    },\n\n    _showComponentItemTooltip: function (e, el, dispatchAction) {\n        var tooltipOpt = el.tooltip;\n        if (typeof tooltipOpt === 'string') {\n            var content = tooltipOpt;\n            tooltipOpt = {\n                content: content,\n                // Fixed formatter\n                formatter: content\n            };\n        }\n        var subTooltipModel = new Model(tooltipOpt, this._tooltipModel, this._ecModel);\n        var defaultHtml = subTooltipModel.get('content');\n        var asyncTicket = Math.random();\n\n        // Do not check whether `trigger` is 'none' here, because `trigger`\n        // only works on cooridinate system. In fact, we have not found case\n        // that requires setting `trigger` nothing on component yet.\n\n        this._showOrMove(subTooltipModel, function () {\n            this._showTooltipContent(\n                subTooltipModel, defaultHtml, subTooltipModel.get('formatterParams') || {},\n                asyncTicket, e.offsetX, e.offsetY, e.position, el\n            );\n        });\n\n        // If not dispatch showTip, tip may be hide triggered by axis.\n        dispatchAction({\n            type: 'showTip',\n            from: this.uid\n        });\n    },\n\n    _showTooltipContent: function (\n        tooltipModel, defaultHtml, params, asyncTicket, x, y, positionExpr, el\n    ) {\n        // Reset ticket\n        this._ticket = '';\n\n        if (!tooltipModel.get('showContent') || !tooltipModel.get('show')) {\n            return;\n        }\n\n        var tooltipContent = this._tooltipContent;\n\n        var formatter = tooltipModel.get('formatter');\n        positionExpr = positionExpr || tooltipModel.get('position');\n        var html = defaultHtml;\n\n        if (formatter && typeof formatter === 'string') {\n            html = formatTpl(formatter, params, true);\n        }\n        else if (typeof formatter === 'function') {\n            var callback = bind$3(function (cbTicket, html) {\n                if (cbTicket === this._ticket) {\n                    tooltipContent.setContent(html);\n                    this._updatePosition(\n                        tooltipModel, positionExpr, x, y, tooltipContent, params, el\n                    );\n                }\n            }, this);\n            this._ticket = asyncTicket;\n            html = formatter(params, asyncTicket, callback);\n        }\n\n        tooltipContent.setContent(html);\n        tooltipContent.show(tooltipModel);\n\n        this._updatePosition(\n            tooltipModel, positionExpr, x, y, tooltipContent, params, el\n        );\n    },\n\n    /**\n     * @param  {string|Function|Array.<number>|Object} positionExpr\n     * @param  {number} x Mouse x\n     * @param  {number} y Mouse y\n     * @param  {boolean} confine Whether confine tooltip content in view rect.\n     * @param  {Object|<Array.<Object>} params\n     * @param  {module:zrender/Element} el target element\n     * @param  {module:echarts/ExtensionAPI} api\n     * @return {Array.<number>}\n     */\n    _updatePosition: function (tooltipModel, positionExpr, x, y, content, params, el) {\n        var viewWidth = this._api.getWidth();\n        var viewHeight = this._api.getHeight();\n        positionExpr = positionExpr || tooltipModel.get('position');\n\n        var contentSize = content.getSize();\n        var align = tooltipModel.get('align');\n        var vAlign = tooltipModel.get('verticalAlign');\n        var rect = el && el.getBoundingRect().clone();\n        el && rect.applyTransform(el.transform);\n\n        if (typeof positionExpr === 'function') {\n            // Callback of position can be an array or a string specify the position\n            positionExpr = positionExpr([x, y], params, content.el, rect, {\n                viewSize: [viewWidth, viewHeight],\n                contentSize: contentSize.slice()\n            });\n        }\n\n        if (isArray(positionExpr)) {\n            x = parsePercent$2(positionExpr[0], viewWidth);\n            y = parsePercent$2(positionExpr[1], viewHeight);\n        }\n        else if (isObject$1(positionExpr)) {\n            positionExpr.width = contentSize[0];\n            positionExpr.height = contentSize[1];\n            var layoutRect = getLayoutRect(\n                positionExpr, {width: viewWidth, height: viewHeight}\n            );\n            x = layoutRect.x;\n            y = layoutRect.y;\n            align = null;\n            // When positionExpr is left/top/right/bottom,\n            // align and verticalAlign will not work.\n            vAlign = null;\n        }\n        // Specify tooltip position by string 'top' 'bottom' 'left' 'right' around graphic element\n        else if (typeof positionExpr === 'string' && el) {\n            var pos = calcTooltipPosition(\n                positionExpr, rect, contentSize\n            );\n            x = pos[0];\n            y = pos[1];\n        }\n        else {\n            var pos = refixTooltipPosition(\n                x, y, content.el, viewWidth, viewHeight, align ? null : 20, vAlign ? null : 20\n            );\n            x = pos[0];\n            y = pos[1];\n        }\n\n        align && (x -= isCenterAlign(align) ? contentSize[0] / 2 : align === 'right' ? contentSize[0] : 0);\n        vAlign && (y -= isCenterAlign(vAlign) ? contentSize[1] / 2 : vAlign === 'bottom' ? contentSize[1] : 0);\n\n        if (tooltipModel.get('confine')) {\n            var pos = confineTooltipPosition(\n                x, y, content.el, viewWidth, viewHeight\n            );\n            x = pos[0];\n            y = pos[1];\n        }\n\n        content.moveTo(x, y);\n    },\n\n    // FIXME\n    // Should we remove this but leave this to user?\n    _updateContentNotChangedOnAxis: function (dataByCoordSys) {\n        var lastCoordSys = this._lastDataByCoordSys;\n        var contentNotChanged = !!lastCoordSys\n            && lastCoordSys.length === dataByCoordSys.length;\n\n        contentNotChanged && each$18(lastCoordSys, function (lastItemCoordSys, indexCoordSys) {\n            var lastDataByAxis = lastItemCoordSys.dataByAxis || {};\n            var thisItemCoordSys = dataByCoordSys[indexCoordSys] || {};\n            var thisDataByAxis = thisItemCoordSys.dataByAxis || [];\n            contentNotChanged &= lastDataByAxis.length === thisDataByAxis.length;\n\n            contentNotChanged && each$18(lastDataByAxis, function (lastItem, indexAxis) {\n                var thisItem = thisDataByAxis[indexAxis] || {};\n                var lastIndices = lastItem.seriesDataIndices || [];\n                var newIndices = thisItem.seriesDataIndices || [];\n\n                contentNotChanged &=\n                    lastItem.value === thisItem.value\n                    && lastItem.axisType === thisItem.axisType\n                    && lastItem.axisId === thisItem.axisId\n                    && lastIndices.length === newIndices.length;\n\n                contentNotChanged && each$18(lastIndices, function (lastIdxItem, j) {\n                    var newIdxItem = newIndices[j];\n                    contentNotChanged &=\n                        lastIdxItem.seriesIndex === newIdxItem.seriesIndex\n                        && lastIdxItem.dataIndex === newIdxItem.dataIndex;\n                });\n            });\n        });\n\n        this._lastDataByCoordSys = dataByCoordSys;\n\n        return !!contentNotChanged;\n    },\n\n    _hide: function (dispatchAction) {\n        // Do not directly hideLater here, because this behavior may be prevented\n        // in dispatchAction when showTip is dispatched.\n\n        // FIXME\n        // duplicated hideTip if manuallyHideTip is called from dispatchAction.\n        this._lastDataByCoordSys = null;\n        dispatchAction({\n            type: 'hideTip',\n            from: this.uid\n        });\n    },\n\n    dispose: function (ecModel, api) {\n        if (env$1.node) {\n            return;\n        }\n        this._tooltipContent.hide();\n        unregister('itemTooltip', api);\n    }\n});\n\n\n/**\n * @param {Array.<Object|module:echarts/model/Model>} modelCascade\n * From top to bottom. (the last one should be globalTooltipModel);\n */\nfunction buildTooltipModel(modelCascade) {\n    var resultModel = modelCascade.pop();\n    while (modelCascade.length) {\n        var tooltipOpt = modelCascade.pop();\n        if (tooltipOpt) {\n            if (Model.isInstance(tooltipOpt)) {\n                tooltipOpt = tooltipOpt.get('tooltip', true);\n            }\n            // In each data item tooltip can be simply write:\n            // {\n            //  value: 10,\n            //  tooltip: 'Something you need to know'\n            // }\n            if (typeof tooltipOpt === 'string') {\n                tooltipOpt = {formatter: tooltipOpt};\n            }\n            resultModel = new Model(tooltipOpt, resultModel, resultModel.ecModel);\n        }\n    }\n    return resultModel;\n}\n\nfunction makeDispatchAction$1(payload, api) {\n    return payload.dispatchAction || bind(api.dispatchAction, api);\n}\n\nfunction refixTooltipPosition(x, y, el, viewWidth, viewHeight, gapH, gapV) {\n    var size = getOuterSize(el);\n    var width = size.width;\n    var height = size.height;\n\n    if (gapH != null) {\n        if (x + width + gapH > viewWidth) {\n            x -= width + gapH;\n        }\n        else {\n            x += gapH;\n        }\n    }\n    if (gapV != null) {\n        if (y + height + gapV > viewHeight) {\n            y -= height + gapV;\n        }\n        else {\n            y += gapV;\n        }\n    }\n    return [x, y];\n}\n\nfunction confineTooltipPosition(x, y, el, viewWidth, viewHeight) {\n    var size = getOuterSize(el);\n    var width = size.width;\n    var height = size.height;\n\n    x = Math.min(x + width, viewWidth) - width;\n    y = Math.min(y + height, viewHeight) - height;\n    x = Math.max(x, 0);\n    y = Math.max(y, 0);\n\n    return [x, y];\n}\n\nfunction getOuterSize(el) {\n    var width = el.clientWidth;\n    var height = el.clientHeight;\n\n    // Consider browser compatibility.\n    // IE8 does not support getComputedStyle.\n    if (document.defaultView && document.defaultView.getComputedStyle) {\n        var stl = document.defaultView.getComputedStyle(el);\n        if (stl) {\n            width += parseInt(stl.paddingLeft, 10) + parseInt(stl.paddingRight, 10)\n                + parseInt(stl.borderLeftWidth, 10) + parseInt(stl.borderRightWidth, 10);\n            height += parseInt(stl.paddingTop, 10) + parseInt(stl.paddingBottom, 10)\n                + parseInt(stl.borderTopWidth, 10) + parseInt(stl.borderBottomWidth, 10);\n        }\n    }\n\n    return {width: width, height: height};\n}\n\nfunction calcTooltipPosition(position, rect, contentSize) {\n    var domWidth = contentSize[0];\n    var domHeight = contentSize[1];\n    var gap = 5;\n    var x = 0;\n    var y = 0;\n    var rectWidth = rect.width;\n    var rectHeight = rect.height;\n    switch (position) {\n        case 'inside':\n            x = rect.x + rectWidth / 2 - domWidth / 2;\n            y = rect.y + rectHeight / 2 - domHeight / 2;\n            break;\n        case 'top':\n            x = rect.x + rectWidth / 2 - domWidth / 2;\n            y = rect.y - domHeight - gap;\n            break;\n        case 'bottom':\n            x = rect.x + rectWidth / 2 - domWidth / 2;\n            y = rect.y + rectHeight + gap;\n            break;\n        case 'left':\n            x = rect.x - domWidth - gap;\n            y = rect.y + rectHeight / 2 - domHeight / 2;\n            break;\n        case 'right':\n            x = rect.x + rectWidth + gap;\n            y = rect.y + rectHeight / 2 - domHeight / 2;\n    }\n    return [x, y];\n}\n\nfunction isCenterAlign(align) {\n    return align === 'center' || align === 'middle';\n}\n\n// FIXME Better way to pack data in graphic element\n\n/**\n * @action\n * @property {string} type\n * @property {number} seriesIndex\n * @property {number} dataIndex\n * @property {number} [x]\n * @property {number} [y]\n */\nregisterAction(\n    {\n        type: 'showTip',\n        event: 'showTip',\n        update: 'tooltip:manuallyShowTip'\n    },\n    // noop\n    function () {}\n);\n\nregisterAction(\n    {\n        type: 'hideTip',\n        event: 'hideTip',\n        update: 'tooltip:manuallyHideTip'\n    },\n    // noop\n    function () {}\n);\n\nfunction getSeriesStackId$1(seriesModel) {\n    return seriesModel.get('stack')\n        || '__ec_stack_' + seriesModel.seriesIndex;\n}\n\nfunction getAxisKey$1(axis) {\n    return axis.dim;\n}\n\n/**\n * @param {string} seriesType\n * @param {module:echarts/model/Global} ecModel\n * @param {module:echarts/ExtensionAPI} api\n */\nfunction barLayoutPolar(seriesType, ecModel, api) {\n\n    var width = api.getWidth();\n    var height = api.getHeight();\n\n    var lastStackCoords = {};\n\n    var barWidthAndOffset = calRadialBar(\n        filter(\n            ecModel.getSeriesByType(seriesType),\n            function (seriesModel) {\n                return !ecModel.isSeriesFiltered(seriesModel)\n                    && seriesModel.coordinateSystem\n                    && seriesModel.coordinateSystem.type === 'polar';\n            }\n        )\n    );\n\n    ecModel.eachSeriesByType(seriesType, function (seriesModel) {\n        // Check series coordinate, do layout for polar only\n        if (seriesModel.coordinateSystem.type !== 'polar') {\n            return;\n        }\n\n        var data = seriesModel.getData();\n        var polar = seriesModel.coordinateSystem;\n        var baseAxis = polar.getBaseAxis();\n\n        var stackId = getSeriesStackId$1(seriesModel);\n        var columnLayoutInfo\n            = barWidthAndOffset[getAxisKey$1(baseAxis)][stackId];\n        var columnOffset = columnLayoutInfo.offset;\n        var columnWidth = columnLayoutInfo.width;\n        var valueAxis = polar.getOtherAxis(baseAxis);\n\n        var center = seriesModel.get('center') || ['50%', '50%'];\n        var cx = parsePercent$1(center[0], width);\n        var cy = parsePercent$1(center[1], height);\n\n        var barMinHeight = seriesModel.get('barMinHeight') || 0;\n        var barMinAngle = seriesModel.get('barMinAngle') || 0;\n\n        lastStackCoords[stackId] = lastStackCoords[stackId] || [];\n\n        var valueDim = data.mapDimension(valueAxis.dim);\n        var baseDim = data.mapDimension(baseAxis.dim);\n        var stacked = isDimensionStacked(data, valueDim, baseDim);\n\n        var valueAxisStart = valueAxis.getExtent()[0];\n\n        for (var idx = 0, len = data.count(); idx < len; idx++) {\n            var value = data.get(valueDim, idx);\n            var baseValue = data.get(baseDim, idx);\n\n            if (isNaN(value)) {\n                continue;\n            }\n\n            var sign = value >= 0 ? 'p' : 'n';\n            var baseCoord = valueAxisStart;\n\n            // Because of the barMinHeight, we can not use the value in\n            // stackResultDimension directly.\n            // Only ordinal axis can be stacked.\n            if (stacked) {\n                if (!lastStackCoords[stackId][baseValue]) {\n                    lastStackCoords[stackId][baseValue] = {\n                        p: valueAxisStart, // Positive stack\n                        n: valueAxisStart  // Negative stack\n                    };\n                }\n                // Should also consider #4243\n                baseCoord = lastStackCoords[stackId][baseValue][sign];\n            }\n\n            var r0;\n            var r;\n            var startAngle;\n            var endAngle;\n\n            // radial sector\n            if (valueAxis.dim === 'radius') {\n                var radiusSpan = valueAxis.dataToRadius(value) - valueAxisStart;\n                var angle = baseAxis.dataToAngle(baseValue);\n\n                if (Math.abs(radiusSpan) < barMinHeight) {\n                    radiusSpan = (radiusSpan < 0 ? -1 : 1) * barMinHeight;\n                }\n\n                r0 = baseCoord;\n                r = baseCoord + radiusSpan;\n                startAngle = angle - columnOffset;\n                endAngle = startAngle - columnWidth;\n\n                stacked && (lastStackCoords[stackId][baseValue][sign] = r);\n            }\n            // tangential sector\n            else {\n                // angleAxis must be clamped.\n                var angleSpan = valueAxis.dataToAngle(value, true) - valueAxisStart;\n                var radius = baseAxis.dataToRadius(baseValue);\n\n                if (Math.abs(angleSpan) < barMinAngle) {\n                    angleSpan = (angleSpan < 0 ? -1 : 1) * barMinAngle;\n                }\n\n                r0 = radius + columnOffset;\n                r = r0 + columnWidth;\n                startAngle = baseCoord;\n                endAngle = baseCoord + angleSpan;\n\n                // if the previous stack is at the end of the ring,\n                // add a round to differentiate it from origin\n                // var extent = angleAxis.getExtent();\n                // var stackCoord = angle;\n                // if (stackCoord === extent[0] && value > 0) {\n                //     stackCoord = extent[1];\n                // }\n                // else if (stackCoord === extent[1] && value < 0) {\n                //     stackCoord = extent[0];\n                // }\n                stacked && (lastStackCoords[stackId][baseValue][sign] = endAngle);\n            }\n\n            data.setItemLayout(idx, {\n                cx: cx,\n                cy: cy,\n                r0: r0,\n                r: r,\n                // Consider that positive angle is anti-clockwise,\n                // while positive radian of sector is clockwise\n                startAngle: -startAngle * Math.PI / 180,\n                endAngle: -endAngle * Math.PI / 180\n            });\n\n        }\n\n    }, this);\n\n}\n\n/**\n * Calculate bar width and offset for radial bar charts\n */\nfunction calRadialBar(barSeries, api) {\n    // Columns info on each category axis. Key is polar name\n    var columnsMap = {};\n\n    each$1(barSeries, function (seriesModel, idx) {\n        var data = seriesModel.getData();\n        var polar = seriesModel.coordinateSystem;\n\n        var baseAxis = polar.getBaseAxis();\n\n        var axisExtent = baseAxis.getExtent();\n        var bandWidth = baseAxis.type === 'category'\n            ? baseAxis.getBandWidth()\n            : (Math.abs(axisExtent[1] - axisExtent[0]) / data.count());\n\n        var columnsOnAxis = columnsMap[getAxisKey$1(baseAxis)] || {\n            bandWidth: bandWidth,\n            remainedWidth: bandWidth,\n            autoWidthCount: 0,\n            categoryGap: '20%',\n            gap: '30%',\n            stacks: {}\n        };\n        var stacks = columnsOnAxis.stacks;\n        columnsMap[getAxisKey$1(baseAxis)] = columnsOnAxis;\n\n        var stackId = getSeriesStackId$1(seriesModel);\n\n        if (!stacks[stackId]) {\n            columnsOnAxis.autoWidthCount++;\n        }\n        stacks[stackId] = stacks[stackId] || {\n            width: 0,\n            maxWidth: 0\n        };\n\n        var barWidth = parsePercent$1(\n            seriesModel.get('barWidth'),\n            bandWidth\n        );\n        var barMaxWidth = parsePercent$1(\n            seriesModel.get('barMaxWidth'),\n            bandWidth\n        );\n        var barGap = seriesModel.get('barGap');\n        var barCategoryGap = seriesModel.get('barCategoryGap');\n\n        if (barWidth && !stacks[stackId].width) {\n            barWidth = Math.min(columnsOnAxis.remainedWidth, barWidth);\n            stacks[stackId].width = barWidth;\n            columnsOnAxis.remainedWidth -= barWidth;\n        }\n\n        barMaxWidth && (stacks[stackId].maxWidth = barMaxWidth);\n        (barGap != null) && (columnsOnAxis.gap = barGap);\n        (barCategoryGap != null) && (columnsOnAxis.categoryGap = barCategoryGap);\n    });\n\n\n    var result = {};\n\n    each$1(columnsMap, function (columnsOnAxis, coordSysName) {\n\n        result[coordSysName] = {};\n\n        var stacks = columnsOnAxis.stacks;\n        var bandWidth = columnsOnAxis.bandWidth;\n        var categoryGap = parsePercent$1(columnsOnAxis.categoryGap, bandWidth);\n        var barGapPercent = parsePercent$1(columnsOnAxis.gap, 1);\n\n        var remainedWidth = columnsOnAxis.remainedWidth;\n        var autoWidthCount = columnsOnAxis.autoWidthCount;\n        var autoWidth = (remainedWidth - categoryGap)\n            / (autoWidthCount + (autoWidthCount - 1) * barGapPercent);\n        autoWidth = Math.max(autoWidth, 0);\n\n        // Find if any auto calculated bar exceeded maxBarWidth\n        each$1(stacks, function (column, stack) {\n            var maxWidth = column.maxWidth;\n            if (maxWidth && maxWidth < autoWidth) {\n                maxWidth = Math.min(maxWidth, remainedWidth);\n                if (column.width) {\n                    maxWidth = Math.min(maxWidth, column.width);\n                }\n                remainedWidth -= maxWidth;\n                column.width = maxWidth;\n                autoWidthCount--;\n            }\n        });\n\n        // Recalculate width again\n        autoWidth = (remainedWidth - categoryGap)\n            / (autoWidthCount + (autoWidthCount - 1) * barGapPercent);\n        autoWidth = Math.max(autoWidth, 0);\n\n        var widthSum = 0;\n        var lastColumn;\n        each$1(stacks, function (column, idx) {\n            if (!column.width) {\n                column.width = autoWidth;\n            }\n            lastColumn = column;\n            widthSum += column.width * (1 + barGapPercent);\n        });\n        if (lastColumn) {\n            widthSum -= lastColumn.width * barGapPercent;\n        }\n\n        var offset = -widthSum / 2;\n        each$1(stacks, function (column, stackId) {\n            result[coordSysName][stackId] = result[coordSysName][stackId] || {\n                offset: offset,\n                width: column.width\n            };\n\n            offset += column.width * (1 + barGapPercent);\n        });\n    });\n\n    return result;\n}\n\nfunction RadiusAxis(scale, radiusExtent) {\n\n    Axis.call(this, 'radius', scale, radiusExtent);\n\n    /**\n     * Axis type\n     *  - 'category'\n     *  - 'value'\n     *  - 'time'\n     *  - 'log'\n     * @type {string}\n     */\n    this.type = 'category';\n}\n\nRadiusAxis.prototype = {\n\n    constructor: RadiusAxis,\n\n    /**\n     * @override\n     */\n    pointToData: function (point, clamp) {\n        return this.polar.pointToData(point, clamp)[this.dim === 'radius' ? 0 : 1];\n    },\n\n    dataToRadius: Axis.prototype.dataToCoord,\n\n    radiusToData: Axis.prototype.coordToData\n};\n\ninherits(RadiusAxis, Axis);\n\nfunction AngleAxis(scale, angleExtent) {\n\n    angleExtent = angleExtent || [0, 360];\n\n    Axis.call(this, 'angle', scale, angleExtent);\n\n    /**\n     * Axis type\n     *  - 'category'\n     *  - 'value'\n     *  - 'time'\n     *  - 'log'\n     * @type {string}\n     */\n    this.type = 'category';\n}\n\nAngleAxis.prototype = {\n\n    constructor: AngleAxis,\n\n    /**\n     * @override\n     */\n    pointToData: function (point, clamp) {\n        return this.polar.pointToData(point, clamp)[this.dim === 'radius' ? 0 : 1];\n    },\n\n    dataToAngle: Axis.prototype.dataToCoord,\n\n    angleToData: Axis.prototype.coordToData\n};\n\ninherits(AngleAxis, Axis);\n\n/**\n * @module echarts/coord/polar/Polar\n */\n\n/**\n * @alias {module:echarts/coord/polar/Polar}\n * @constructor\n * @param {string} name\n */\nvar Polar = function (name) {\n\n    /**\n     * @type {string}\n     */\n    this.name = name || '';\n\n    /**\n     * x of polar center\n     * @type {number}\n     */\n    this.cx = 0;\n\n    /**\n     * y of polar center\n     * @type {number}\n     */\n    this.cy = 0;\n\n    /**\n     * @type {module:echarts/coord/polar/RadiusAxis}\n     * @private\n     */\n    this._radiusAxis = new RadiusAxis();\n\n    /**\n     * @type {module:echarts/coord/polar/AngleAxis}\n     * @private\n     */\n    this._angleAxis = new AngleAxis();\n\n    this._radiusAxis.polar = this._angleAxis.polar = this;\n};\n\nPolar.prototype = {\n\n    type: 'polar',\n\n    axisPointerEnabled: true,\n\n    constructor: Polar,\n\n    /**\n     * @param {Array.<string>}\n     * @readOnly\n     */\n    dimensions: ['radius', 'angle'],\n\n    /**\n     * @type {module:echarts/coord/PolarModel}\n     */\n    model: null,\n\n    /**\n     * If contain coord\n     * @param {Array.<number>} point\n     * @return {boolean}\n     */\n    containPoint: function (point) {\n        var coord = this.pointToCoord(point);\n        return this._radiusAxis.contain(coord[0])\n            && this._angleAxis.contain(coord[1]);\n    },\n\n    /**\n     * If contain data\n     * @param {Array.<number>} data\n     * @return {boolean}\n     */\n    containData: function (data) {\n        return this._radiusAxis.containData(data[0])\n            && this._angleAxis.containData(data[1]);\n    },\n\n    /**\n     * @param {string} dim\n     * @return {module:echarts/coord/polar/AngleAxis|module:echarts/coord/polar/RadiusAxis}\n     */\n    getAxis: function (dim) {\n        return this['_' + dim + 'Axis'];\n    },\n\n    /**\n     * @return {Array.<module:echarts/coord/Axis>}\n     */\n    getAxes: function () {\n        return [this._radiusAxis, this._angleAxis];\n    },\n\n    /**\n     * Get axes by type of scale\n     * @param {string} scaleType\n     * @return {module:echarts/coord/polar/AngleAxis|module:echarts/coord/polar/RadiusAxis}\n     */\n    getAxesByScale: function (scaleType) {\n        var axes = [];\n        var angleAxis = this._angleAxis;\n        var radiusAxis = this._radiusAxis;\n        angleAxis.scale.type === scaleType && axes.push(angleAxis);\n        radiusAxis.scale.type === scaleType && axes.push(radiusAxis);\n\n        return axes;\n    },\n\n    /**\n     * @return {module:echarts/coord/polar/AngleAxis}\n     */\n    getAngleAxis: function () {\n        return this._angleAxis;\n    },\n\n    /**\n     * @return {module:echarts/coord/polar/RadiusAxis}\n     */\n    getRadiusAxis: function () {\n        return this._radiusAxis;\n    },\n\n    /**\n     * @param {module:echarts/coord/polar/Axis}\n     * @return {module:echarts/coord/polar/Axis}\n     */\n    getOtherAxis: function (axis) {\n        var angleAxis = this._angleAxis;\n        return axis === angleAxis ? this._radiusAxis : angleAxis;\n    },\n\n    /**\n     * Base axis will be used on stacking.\n     *\n     * @return {module:echarts/coord/polar/Axis}\n     */\n    getBaseAxis: function () {\n        return this.getAxesByScale('ordinal')[0]\n            || this.getAxesByScale('time')[0]\n            || this.getAngleAxis();\n    },\n\n    /**\n     * @param {string} [dim] 'radius' or 'angle' or 'auto' or null/undefined\n     * @return {Object} {baseAxes: [], otherAxes: []}\n     */\n    getTooltipAxes: function (dim) {\n        var baseAxis = (dim != null && dim !== 'auto')\n            ? this.getAxis(dim) : this.getBaseAxis();\n        return {\n            baseAxes: [baseAxis],\n            otherAxes: [this.getOtherAxis(baseAxis)]\n        };\n    },\n\n    /**\n     * Convert a single data item to (x, y) point.\n     * Parameter data is an array which the first element is radius and the second is angle\n     * @param {Array.<number>} data\n     * @param {boolean} [clamp=false]\n     * @return {Array.<number>}\n     */\n    dataToPoint: function (data, clamp) {\n        return this.coordToPoint([\n            this._radiusAxis.dataToRadius(data[0], clamp),\n            this._angleAxis.dataToAngle(data[1], clamp)\n        ]);\n    },\n\n    /**\n     * Convert a (x, y) point to data\n     * @param {Array.<number>} point\n     * @param {boolean} [clamp=false]\n     * @return {Array.<number>}\n     */\n    pointToData: function (point, clamp) {\n        var coord = this.pointToCoord(point);\n        return [\n            this._radiusAxis.radiusToData(coord[0], clamp),\n            this._angleAxis.angleToData(coord[1], clamp)\n        ];\n    },\n\n    /**\n     * Convert a (x, y) point to (radius, angle) coord\n     * @param {Array.<number>} point\n     * @return {Array.<number>}\n     */\n    pointToCoord: function (point) {\n        var dx = point[0] - this.cx;\n        var dy = point[1] - this.cy;\n        var angleAxis = this.getAngleAxis();\n        var extent = angleAxis.getExtent();\n        var minAngle = Math.min(extent[0], extent[1]);\n        var maxAngle = Math.max(extent[0], extent[1]);\n        // Fix fixed extent in polarCreator\n        // FIXME\n        angleAxis.inverse\n            ? (minAngle = maxAngle - 360)\n            : (maxAngle = minAngle + 360);\n\n        var radius = Math.sqrt(dx * dx + dy * dy);\n        dx /= radius;\n        dy /= radius;\n\n        var radian = Math.atan2(-dy, dx) / Math.PI * 180;\n\n        // move to angleExtent\n        var dir = radian < minAngle ? 1 : -1;\n        while (radian < minAngle || radian > maxAngle) {\n            radian += dir * 360;\n        }\n\n        return [radius, radian];\n    },\n\n    /**\n     * Convert a (radius, angle) coord to (x, y) point\n     * @param {Array.<number>} coord\n     * @return {Array.<number>}\n     */\n    coordToPoint: function (coord) {\n        var radius = coord[0];\n        var radian = coord[1] / 180 * Math.PI;\n        var x = Math.cos(radian) * radius + this.cx;\n        // Inverse the y\n        var y = -Math.sin(radian) * radius + this.cy;\n\n        return [x, y];\n    }\n\n};\n\nvar PolarAxisModel = ComponentModel.extend({\n\n    type: 'polarAxis',\n\n    /**\n     * @type {module:echarts/coord/polar/AngleAxis|module:echarts/coord/polar/RadiusAxis}\n     */\n    axis: null,\n\n    /**\n     * @override\n     */\n    getCoordSysModel: function () {\n        return this.ecModel.queryComponents({\n            mainType: 'polar',\n            index: this.option.polarIndex,\n            id: this.option.polarId\n        })[0];\n    }\n\n});\n\nmerge(PolarAxisModel.prototype, axisModelCommonMixin);\n\nvar polarAxisDefaultExtendedOption = {\n    angle: {\n        // polarIndex: 0,\n        // polarId: '',\n\n        startAngle: 90,\n\n        clockwise: true,\n\n        splitNumber: 12,\n\n        axisLabel: {\n            rotate: false\n        }\n    },\n    radius: {\n        // polarIndex: 0,\n        // polarId: '',\n\n        splitNumber: 5\n    }\n};\n\nfunction getAxisType$3(axisDim, option) {\n    // Default axis with data is category axis\n    return option.type || (option.data ? 'category' : 'value');\n}\n\naxisModelCreator('angle', PolarAxisModel, getAxisType$3, polarAxisDefaultExtendedOption.angle);\naxisModelCreator('radius', PolarAxisModel, getAxisType$3, polarAxisDefaultExtendedOption.radius);\n\nextendComponentModel({\n\n    type: 'polar',\n\n    dependencies: ['polarAxis', 'angleAxis'],\n\n    /**\n     * @type {module:echarts/coord/polar/Polar}\n     */\n    coordinateSystem: null,\n\n    /**\n     * @param {string} axisType\n     * @return {module:echarts/coord/polar/AxisModel}\n     */\n    findAxisModel: function (axisType) {\n        var foundAxisModel;\n        var ecModel = this.ecModel;\n\n        ecModel.eachComponent(axisType, function (axisModel) {\n            if (axisModel.getCoordSysModel() === this) {\n                foundAxisModel = axisModel;\n            }\n        }, this);\n        return foundAxisModel;\n    },\n\n    defaultOption: {\n\n        zlevel: 0,\n\n        z: 0,\n\n        center: ['50%', '50%'],\n\n        radius: '80%'\n    }\n});\n\n// TODO Axis scale\n\n//  PolarModel \n/**\n * Resize method bound to the polar\n * @param {module:echarts/coord/polar/PolarModel} polarModel\n * @param {module:echarts/ExtensionAPI} api\n */\nfunction resizePolar(polar, polarModel, api) {\n    var center = polarModel.get('center');\n    var width = api.getWidth();\n    var height = api.getHeight();\n\n    polar.cx = parsePercent$1(center[0], width);\n    polar.cy = parsePercent$1(center[1], height);\n\n    var radiusAxis = polar.getRadiusAxis();\n    var size = Math.min(width, height) / 2;\n    var radius = parsePercent$1(polarModel.get('radius'), size);\n    radiusAxis.inverse\n        ? radiusAxis.setExtent(radius, 0)\n        : radiusAxis.setExtent(0, radius);\n}\n\n/**\n * Update polar\n */\nfunction updatePolarScale(ecModel, api) {\n    var polar = this;\n    var angleAxis = polar.getAngleAxis();\n    var radiusAxis = polar.getRadiusAxis();\n    // Reset scale\n    angleAxis.scale.setExtent(Infinity, -Infinity);\n    radiusAxis.scale.setExtent(Infinity, -Infinity);\n\n    ecModel.eachSeries(function (seriesModel) {\n        if (seriesModel.coordinateSystem === polar) {\n            var data = seriesModel.getData();\n            each$1(data.mapDimension('radius', true), function (dim) {\n                radiusAxis.scale.unionExtentFromData(data, dim);\n            });\n            each$1(data.mapDimension('angle', true), function (dim) {\n                angleAxis.scale.unionExtentFromData(data, dim);\n            });\n        }\n    });\n\n    niceScaleExtent(angleAxis.scale, angleAxis.model);\n    niceScaleExtent(radiusAxis.scale, radiusAxis.model);\n\n    // Fix extent of category angle axis\n    if (angleAxis.type === 'category' && !angleAxis.onBand) {\n        var extent = angleAxis.getExtent();\n        var diff = 360 / angleAxis.scale.count();\n        angleAxis.inverse ? (extent[1] += diff) : (extent[1] -= diff);\n        angleAxis.setExtent(extent[0], extent[1]);\n    }\n}\n\n/**\n * Set common axis properties\n * @param {module:echarts/coord/polar/AngleAxis|module:echarts/coord/polar/RadiusAxis}\n * @param {module:echarts/coord/polar/AxisModel}\n * @inner\n */\nfunction setAxis(axis, axisModel) {\n    axis.type = axisModel.get('type');\n    axis.scale = createScaleByModel(axisModel);\n    axis.onBand = axisModel.get('boundaryGap') && axis.type === 'category';\n    axis.inverse = axisModel.get('inverse');\n\n    if (axisModel.mainType === 'angleAxis') {\n        axis.inverse ^= axisModel.get('clockwise');\n        var startAngle = axisModel.get('startAngle');\n        axis.setExtent(startAngle, startAngle + (axis.inverse ? -360 : 360));\n    }\n\n    // Inject axis instance\n    axisModel.axis = axis;\n    axis.model = axisModel;\n}\n\n\nvar polarCreator = {\n\n    dimensions: Polar.prototype.dimensions,\n\n    create: function (ecModel, api) {\n        var polarList = [];\n        ecModel.eachComponent('polar', function (polarModel, idx) {\n            var polar = new Polar(idx);\n            // Inject resize and update method\n            polar.update = updatePolarScale;\n\n            var radiusAxis = polar.getRadiusAxis();\n            var angleAxis = polar.getAngleAxis();\n\n            var radiusAxisModel = polarModel.findAxisModel('radiusAxis');\n            var angleAxisModel = polarModel.findAxisModel('angleAxis');\n\n            setAxis(radiusAxis, radiusAxisModel);\n            setAxis(angleAxis, angleAxisModel);\n\n            resizePolar(polar, polarModel, api);\n\n            polarList.push(polar);\n\n            polarModel.coordinateSystem = polar;\n            polar.model = polarModel;\n        });\n        // Inject coordinateSystem to series\n        ecModel.eachSeries(function (seriesModel) {\n            if (seriesModel.get('coordinateSystem') === 'polar') {\n                var polarModel = ecModel.queryComponents({\n                    mainType: 'polar',\n                    index: seriesModel.get('polarIndex'),\n                    id: seriesModel.get('polarId')\n                })[0];\n\n                if (__DEV__) {\n                    if (!polarModel) {\n                        throw new Error(\n                            'Polar \"' + retrieve(\n                                seriesModel.get('polarIndex'),\n                                seriesModel.get('polarId'),\n                                0\n                            ) + '\" not found'\n                        );\n                    }\n                }\n                seriesModel.coordinateSystem = polarModel.coordinateSystem;\n            }\n        });\n\n        return polarList;\n    }\n};\n\nCoordinateSystemManager.register('polar', polarCreator);\n\nvar elementList$1 = ['axisLine', 'axisLabel', 'axisTick', 'splitLine', 'splitArea'];\n\nfunction getAxisLineShape(polar, rExtent, angle) {\n    rExtent[1] > rExtent[0] && (rExtent = rExtent.slice().reverse());\n    var start = polar.coordToPoint([rExtent[0], angle]);\n    var end = polar.coordToPoint([rExtent[1], angle]);\n\n    return {\n        x1: start[0],\n        y1: start[1],\n        x2: end[0],\n        y2: end[1]\n    };\n}\n\nfunction getRadiusIdx(polar) {\n    var radiusAxis = polar.getRadiusAxis();\n    return radiusAxis.inverse ? 0 : 1;\n}\n\nAxisView.extend({\n\n    type: 'angleAxis',\n\n    axisPointerClass: 'PolarAxisPointer',\n\n    render: function (angleAxisModel, ecModel) {\n        this.group.removeAll();\n        if (!angleAxisModel.get('show')) {\n            return;\n        }\n\n        var angleAxis = angleAxisModel.axis;\n        var polar = angleAxis.polar;\n        var radiusExtent = polar.getRadiusAxis().getExtent();\n        var ticksAngles = angleAxis.getTicksCoords();\n\n        if (angleAxis.type !== 'category') {\n            // Remove the last tick which will overlap the first tick\n            ticksAngles.pop();\n        }\n\n        each$1(elementList$1, function (name) {\n            if (angleAxisModel.get(name +'.show')\n                && (!angleAxis.scale.isBlank() || name === 'axisLine')\n            ) {\n                this['_' + name](angleAxisModel, polar, ticksAngles, radiusExtent);\n            }\n        }, this);\n    },\n\n    /**\n     * @private\n     */\n    _axisLine: function (angleAxisModel, polar, ticksAngles, radiusExtent) {\n        var lineStyleModel = angleAxisModel.getModel('axisLine.lineStyle');\n\n        var circle = new Circle({\n            shape: {\n                cx: polar.cx,\n                cy: polar.cy,\n                r: radiusExtent[getRadiusIdx(polar)]\n            },\n            style: lineStyleModel.getLineStyle(),\n            z2: 1,\n            silent: true\n        });\n        circle.style.fill = null;\n\n        this.group.add(circle);\n    },\n\n    /**\n     * @private\n     */\n    _axisTick: function (angleAxisModel, polar, ticksAngles, radiusExtent) {\n        var tickModel = angleAxisModel.getModel('axisTick');\n\n        var tickLen = (tickModel.get('inside') ? -1 : 1) * tickModel.get('length');\n        var radius = radiusExtent[getRadiusIdx(polar)];\n\n        var lines = map(ticksAngles, function (tickAngle) {\n            return new Line({\n                shape: getAxisLineShape(polar, [radius, radius + tickLen], tickAngle)\n            });\n        });\n        this.group.add(mergePath(\n            lines, {\n                style: defaults(\n                    tickModel.getModel('lineStyle').getLineStyle(),\n                    {\n                        stroke: angleAxisModel.get('axisLine.lineStyle.color')\n                    }\n                )\n            }\n        ));\n    },\n\n    /**\n     * @private\n     */\n    _axisLabel: function (angleAxisModel, polar, ticksAngles, radiusExtent) {\n        var axis = angleAxisModel.axis;\n\n        var categoryData = angleAxisModel.getCategories();\n\n        var labelModel = angleAxisModel.getModel('axisLabel');\n        var labels = angleAxisModel.getFormattedLabels();\n\n        var labelMargin = labelModel.get('margin');\n        var labelsAngles = axis.getLabelsCoords();\n\n        // Use length of ticksAngles because it may remove the last tick to avoid overlapping\n        for (var i = 0; i < ticksAngles.length; i++) {\n            var r = radiusExtent[getRadiusIdx(polar)];\n            var p = polar.coordToPoint([r + labelMargin, labelsAngles[i]]);\n            var cx = polar.cx;\n            var cy = polar.cy;\n\n            var labelTextAlign = Math.abs(p[0] - cx) / r < 0.3\n                ? 'center' : (p[0] > cx ? 'left' : 'right');\n            var labelTextVerticalAlign = Math.abs(p[1] - cy) / r < 0.3\n                ? 'middle' : (p[1] > cy ? 'top' : 'bottom');\n\n            if (categoryData && categoryData[i] && categoryData[i].textStyle) {\n                labelModel = new Model(categoryData[i].textStyle, labelModel, labelModel.ecModel);\n            }\n\n            var textEl = new Text({silent: true});\n            this.group.add(textEl);\n            setTextStyle(textEl.style, labelModel, {\n                x: p[0],\n                y: p[1],\n                textFill: labelModel.getTextColor() || angleAxisModel.get('axisLine.lineStyle.color'),\n                text: labels[i],\n                textAlign: labelTextAlign,\n                textVerticalAlign: labelTextVerticalAlign\n            });\n        }\n    },\n\n    /**\n     * @private\n     */\n    _splitLine: function (angleAxisModel, polar, ticksAngles, radiusExtent) {\n        var splitLineModel = angleAxisModel.getModel('splitLine');\n        var lineStyleModel = splitLineModel.getModel('lineStyle');\n        var lineColors = lineStyleModel.get('color');\n        var lineCount = 0;\n\n        lineColors = lineColors instanceof Array ? lineColors : [lineColors];\n\n        var splitLines = [];\n\n        for (var i = 0; i < ticksAngles.length; i++) {\n            var colorIndex = (lineCount++) % lineColors.length;\n            splitLines[colorIndex] = splitLines[colorIndex] || [];\n            splitLines[colorIndex].push(new Line({\n                shape: getAxisLineShape(polar, radiusExtent, ticksAngles[i])\n            }));\n        }\n\n        // Simple optimization\n        // Batching the lines if color are the same\n        for (var i = 0; i < splitLines.length; i++) {\n            this.group.add(mergePath(splitLines[i], {\n                style: defaults({\n                    stroke: lineColors[i % lineColors.length]\n                }, lineStyleModel.getLineStyle()),\n                silent: true,\n                z: angleAxisModel.get('z')\n            }));\n        }\n    },\n\n    /**\n     * @private\n     */\n    _splitArea: function (angleAxisModel, polar, ticksAngles, radiusExtent) {\n\n        var splitAreaModel = angleAxisModel.getModel('splitArea');\n        var areaStyleModel = splitAreaModel.getModel('areaStyle');\n        var areaColors = areaStyleModel.get('color');\n        var lineCount = 0;\n\n        areaColors = areaColors instanceof Array ? areaColors : [areaColors];\n\n        var splitAreas = [];\n\n        var RADIAN = Math.PI / 180;\n        var prevAngle = -ticksAngles[0] * RADIAN;\n        var r0 = Math.min(radiusExtent[0], radiusExtent[1]);\n        var r1 = Math.max(radiusExtent[0], radiusExtent[1]);\n\n        var clockwise = angleAxisModel.get('clockwise');\n\n        for (var i = 1; i < ticksAngles.length; i++) {\n            var colorIndex = (lineCount++) % areaColors.length;\n            splitAreas[colorIndex] = splitAreas[colorIndex] || [];\n            splitAreas[colorIndex].push(new Sector({\n                shape: {\n                    cx: polar.cx,\n                    cy: polar.cy,\n                    r0: r0,\n                    r: r1,\n                    startAngle: prevAngle,\n                    endAngle: -ticksAngles[i] * RADIAN,\n                    clockwise: clockwise\n                },\n                silent: true\n            }));\n            prevAngle = -ticksAngles[i] * RADIAN;\n        }\n\n        // Simple optimization\n        // Batching the lines if color are the same\n        for (var i = 0; i < splitAreas.length; i++) {\n            this.group.add(mergePath(splitAreas[i], {\n                style: defaults({\n                    fill: areaColors[i % areaColors.length]\n                }, areaStyleModel.getAreaStyle()),\n                silent: true\n            }));\n        }\n    }\n});\n\nvar axisBuilderAttrs$3 = [\n    'axisLine', 'axisTickLabel', 'axisName'\n];\nvar selfBuilderAttrs$1 = [\n    'splitLine', 'splitArea'\n];\n\nAxisView.extend({\n\n    type: 'radiusAxis',\n\n    axisPointerClass: 'PolarAxisPointer',\n\n    render: function (radiusAxisModel, ecModel) {\n        this.group.removeAll();\n        if (!radiusAxisModel.get('show')) {\n            return;\n        }\n        var radiusAxis = radiusAxisModel.axis;\n        var polar = radiusAxis.polar;\n        var angleAxis = polar.getAngleAxis();\n        var ticksCoords = radiusAxis.getTicksCoords();\n        var axisAngle = angleAxis.getExtent()[0];\n        var radiusExtent = radiusAxis.getExtent();\n\n        var layout = layoutAxis(polar, radiusAxisModel, axisAngle);\n        var axisBuilder = new AxisBuilder(radiusAxisModel, layout);\n        each$1(axisBuilderAttrs$3, axisBuilder.add, axisBuilder);\n        this.group.add(axisBuilder.getGroup());\n\n        each$1(selfBuilderAttrs$1, function (name) {\n            if (radiusAxisModel.get(name +'.show') && !radiusAxis.scale.isBlank()) {\n                this['_' + name](radiusAxisModel, polar, axisAngle, radiusExtent, ticksCoords);\n            }\n        }, this);\n    },\n\n    /**\n     * @private\n     */\n    _splitLine: function (radiusAxisModel, polar, axisAngle, radiusExtent, ticksCoords) {\n        var splitLineModel = radiusAxisModel.getModel('splitLine');\n        var lineStyleModel = splitLineModel.getModel('lineStyle');\n        var lineColors = lineStyleModel.get('color');\n        var lineCount = 0;\n\n        lineColors = lineColors instanceof Array ? lineColors : [lineColors];\n\n        var splitLines = [];\n\n        for (var i = 0; i < ticksCoords.length; i++) {\n            var colorIndex = (lineCount++) % lineColors.length;\n            splitLines[colorIndex] = splitLines[colorIndex] || [];\n            splitLines[colorIndex].push(new Circle({\n                shape: {\n                    cx: polar.cx,\n                    cy: polar.cy,\n                    r: ticksCoords[i]\n                },\n                silent: true\n            }));\n        }\n\n        // Simple optimization\n        // Batching the lines if color are the same\n        for (var i = 0; i < splitLines.length; i++) {\n            this.group.add(mergePath(splitLines[i], {\n                style: defaults({\n                    stroke: lineColors[i % lineColors.length],\n                    fill: null\n                }, lineStyleModel.getLineStyle()),\n                silent: true\n            }));\n        }\n    },\n\n    /**\n     * @private\n     */\n    _splitArea: function (radiusAxisModel, polar, axisAngle, radiusExtent, ticksCoords) {\n\n        var splitAreaModel = radiusAxisModel.getModel('splitArea');\n        var areaStyleModel = splitAreaModel.getModel('areaStyle');\n        var areaColors = areaStyleModel.get('color');\n        var lineCount = 0;\n\n        areaColors = areaColors instanceof Array ? areaColors : [areaColors];\n\n        var splitAreas = [];\n\n        var prevRadius = ticksCoords[0];\n        for (var i = 1; i < ticksCoords.length; i++) {\n            var colorIndex = (lineCount++) % areaColors.length;\n            splitAreas[colorIndex] = splitAreas[colorIndex] || [];\n            splitAreas[colorIndex].push(new Sector({\n                shape: {\n                    cx: polar.cx,\n                    cy: polar.cy,\n                    r0: prevRadius,\n                    r: ticksCoords[i],\n                    startAngle: 0,\n                    endAngle: Math.PI * 2\n                },\n                silent: true\n            }));\n            prevRadius = ticksCoords[i];\n        }\n\n        // Simple optimization\n        // Batching the lines if color are the same\n        for (var i = 0; i < splitAreas.length; i++) {\n            this.group.add(mergePath(splitAreas[i], {\n                style: defaults({\n                    fill: areaColors[i % areaColors.length]\n                }, areaStyleModel.getAreaStyle()),\n                silent: true\n            }));\n        }\n    }\n});\n\n/**\n * @inner\n */\nfunction layoutAxis(polar, radiusAxisModel, axisAngle) {\n    return {\n        position: [polar.cx, polar.cy],\n        rotation: axisAngle / 180 * Math.PI,\n        labelDirection: -1,\n        tickDirection: -1,\n        nameDirection: 1,\n        labelRotate: radiusAxisModel.getModel('axisLabel').get('rotate'),\n        // Over splitLine and splitArea\n        z2: 1\n    };\n}\n\nvar PolarAxisPointer = BaseAxisPointer.extend({\n\n    /**\n     * @override\n     */\n    makeElOption: function (elOption, value, axisModel, axisPointerModel, api) {\n        var axis = axisModel.axis;\n\n        if (axis.dim === 'angle') {\n            this.animationThreshold = Math.PI / 18;\n        }\n\n        var polar = axis.polar;\n        var otherAxis = polar.getOtherAxis(axis);\n        var otherExtent = otherAxis.getExtent();\n\n        var coordValue;\n        coordValue = axis['dataTo' + capitalFirst(axis.dim)](value);\n\n        var axisPointerType = axisPointerModel.get('type');\n        if (axisPointerType && axisPointerType !== 'none') {\n            var elStyle = buildElStyle(axisPointerModel);\n            var pointerOption = pointerShapeBuilder$2[axisPointerType](\n                axis, polar, coordValue, otherExtent, elStyle\n            );\n            pointerOption.style = elStyle;\n            elOption.graphicKey = pointerOption.type;\n            elOption.pointer = pointerOption;\n        }\n\n        var labelMargin = axisPointerModel.get('label.margin');\n        var labelPos = getLabelPosition(value, axisModel, axisPointerModel, polar, labelMargin);\n        buildLabelElOption(elOption, axisModel, axisPointerModel, api, labelPos);\n    }\n\n    // Do not support handle, utill any user requires it.\n\n});\n\nfunction getLabelPosition(value, axisModel, axisPointerModel, polar, labelMargin) {\n    var axis = axisModel.axis;\n    var coord = axis.dataToCoord(value);\n    var axisAngle = polar.getAngleAxis().getExtent()[0];\n    axisAngle = axisAngle / 180 * Math.PI;\n    var radiusExtent = polar.getRadiusAxis().getExtent();\n    var position;\n    var align;\n    var verticalAlign;\n\n    if (axis.dim === 'radius') {\n        var transform = create$1();\n        rotate(transform, transform, axisAngle);\n        translate(transform, transform, [polar.cx, polar.cy]);\n        position = applyTransform$1([coord, -labelMargin], transform);\n\n        var labelRotation = axisModel.getModel('axisLabel').get('rotate') || 0;\n        var labelLayout = AxisBuilder.innerTextLayout(\n            axisAngle, labelRotation * Math.PI / 180, -1\n        );\n        align = labelLayout.textAlign;\n        verticalAlign = labelLayout.textVerticalAlign;\n    }\n    else { // angle axis\n        var r = radiusExtent[1];\n        position = polar.coordToPoint([r + labelMargin, coord]);\n        var cx = polar.cx;\n        var cy = polar.cy;\n        align = Math.abs(position[0] - cx) / r < 0.3\n            ? 'center' : (position[0] > cx ? 'left' : 'right');\n        verticalAlign = Math.abs(position[1] - cy) / r < 0.3\n            ? 'middle' : (position[1] > cy ? 'top' : 'bottom');\n    }\n\n    return {\n        position: position,\n        align: align,\n        verticalAlign: verticalAlign\n    };\n}\n\n\nvar pointerShapeBuilder$2 = {\n\n    line: function (axis, polar, coordValue, otherExtent, elStyle) {\n        return axis.dim === 'angle'\n            ? {\n                type: 'Line',\n                shape: makeLineShape(\n                    polar.coordToPoint([otherExtent[0], coordValue]),\n                    polar.coordToPoint([otherExtent[1], coordValue])\n                )\n            }\n            : {\n                type: 'Circle',\n                shape: {\n                    cx: polar.cx,\n                    cy: polar.cy,\n                    r: coordValue\n                }\n            };\n    },\n\n    shadow: function (axis, polar, coordValue, otherExtent, elStyle) {\n        var bandWidth = axis.getBandWidth();\n        var radian = Math.PI / 180;\n\n        return axis.dim === 'angle'\n            ? {\n                type: 'Sector',\n                shape: makeSectorShape(\n                    polar.cx, polar.cy,\n                    otherExtent[0], otherExtent[1],\n                    // In ECharts y is negative if angle is positive\n                    (-coordValue - bandWidth / 2) * radian,\n                    (-coordValue + bandWidth / 2) * radian\n                )\n            }\n            : {\n                type: 'Sector',\n                shape: makeSectorShape(\n                    polar.cx, polar.cy,\n                    coordValue - bandWidth / 2,\n                    coordValue + bandWidth / 2,\n                    0, Math.PI * 2\n                )\n            };\n    }\n};\n\nAxisView.registerAxisPointerClass('PolarAxisPointer', PolarAxisPointer);\n\n// For reducing size of echarts.min, barLayoutPolar is required by polar.\nregisterLayout(curry(barLayoutPolar, 'bar'));\n\n// Polar view\nextendComponentView({\n    type: 'polar'\n});\n\nvar GeoModel = ComponentModel.extend({\n\n    type: 'geo',\n\n    /**\n     * @type {module:echarts/coord/geo/Geo}\n     */\n    coordinateSystem: null,\n\n    layoutMode: 'box',\n\n    init: function (option) {\n        ComponentModel.prototype.init.apply(this, arguments);\n\n        // Default label emphasis `show`\n        defaultEmphasis(option, 'label', ['show']);\n    },\n\n    optionUpdated: function () {\n        var option = this.option;\n        var self = this;\n\n        option.regions = geoCreator.getFilledRegions(option.regions, option.map, option.nameMap);\n\n        this._optionModelMap = reduce(option.regions || [], function (optionModelMap, regionOpt) {\n            if (regionOpt.name) {\n                optionModelMap.set(regionOpt.name, new Model(regionOpt, self));\n            }\n            return optionModelMap;\n        }, createHashMap());\n\n        this.updateSelectedMap(option.regions);\n    },\n\n    defaultOption: {\n\n        zlevel: 0,\n\n        z: 0,\n\n        show: true,\n\n        left: 'center',\n\n        top: 'center',\n\n\n        // width:,\n        // height:,\n        // right\n        // bottom\n\n        // Aspect is width / height. Inited to be geoJson bbox aspect\n        // This parameter is used for scale this aspect\n        aspectScale: 0.75,\n\n        ///// Layout with center and size\n        // If you wan't to put map in a fixed size box with right aspect ratio\n        // This two properties may more conveninet\n        // layoutCenter: [50%, 50%]\n        // layoutSize: 100\n\n\n        silent: false,\n\n        // Map type\n        map: '',\n\n        // Define left-top, right-bottom coords to control view\n        // For example, [ [180, 90], [-180, -90] ]\n        boundingCoords: null,\n\n        // Default on center of map\n        center: null,\n\n        zoom: 1,\n\n        scaleLimit: null,\n\n        // selectedMode: false\n\n        label: {\n            show: false,\n            color: '#000'\n        },\n\n        itemStyle: {\n            // color: ,\n            borderWidth: 0.5,\n            borderColor: '#444',\n            color: '#eee'\n        },\n\n        emphasis: {\n            label: {\n                show: true,\n                color: 'rgb(100,0,0)'\n            },\n            itemStyle: {\n                color: 'rgba(255,215,0,0.8)'\n            }\n        },\n\n        regions: []\n    },\n\n    /**\n     * Get model of region\n     * @param  {string} name\n     * @return {module:echarts/model/Model}\n     */\n    getRegionModel: function (name) {\n        return this._optionModelMap.get(name) || new Model(null, this, this.ecModel);\n    },\n\n    /**\n     * Format label\n     * @param {string} name Region name\n     * @param {string} [status='normal'] 'normal' or 'emphasis'\n     * @return {string}\n     */\n    getFormattedLabel: function (name, status) {\n        var regionModel = this.getRegionModel(name);\n        var formatter = regionModel.get('label.' + status + '.formatter');\n        var params = {\n            name: name\n        };\n        if (typeof formatter === 'function') {\n            params.status = status;\n            return formatter(params);\n        }\n        else if (typeof formatter === 'string') {\n            return formatter.replace('{a}', name != null ? name : '');\n        }\n    },\n\n    setZoom: function (zoom) {\n        this.option.zoom = zoom;\n    },\n\n    setCenter: function (center) {\n        this.option.center = center;\n    }\n});\n\nmixin(GeoModel, selectableMixin);\n\nextendComponentView({\n\n    type: 'geo',\n\n    init: function (ecModel, api) {\n        var mapDraw = new MapDraw(api, true);\n        this._mapDraw = mapDraw;\n\n        this.group.add(mapDraw.group);\n    },\n\n    render: function (geoModel, ecModel, api, payload) {\n        // Not render if it is an toggleSelect action from self\n        if (payload && payload.type === 'geoToggleSelect'\n            && payload.from === this.uid\n        ) {\n            return;\n        }\n\n        var mapDraw = this._mapDraw;\n        if (geoModel.get('show')) {\n            mapDraw.draw(geoModel, ecModel, api, this, payload);\n        }\n        else {\n            this._mapDraw.group.removeAll();\n        }\n\n        this.group.silent = geoModel.get('silent');\n    },\n\n    dispose: function () {\n        this._mapDraw && this._mapDraw.remove();\n    }\n\n});\n\nfunction makeAction(method, actionInfo) {\n    actionInfo.update = 'updateView';\n    registerAction(actionInfo, function (payload, ecModel) {\n        var selected = {};\n\n        ecModel.eachComponent(\n            { mainType: 'geo', query: payload},\n            function (geoModel) {\n                geoModel[method](payload.name);\n                var geo = geoModel.coordinateSystem;\n                each$1(geo.regions, function (region) {\n                    selected[region.name] = geoModel.isSelected(region.name) || false;\n                });\n            }\n        );\n\n        return {\n            selected: selected,\n            name: payload.name\n        };\n    });\n}\n\nmakeAction('toggleSelected', {\n    type: 'geoToggleSelect',\n    event: 'geoselectchanged'\n});\nmakeAction('select', {\n    type: 'geoSelect',\n    event: 'geoselected'\n});\nmakeAction('unSelect', {\n    type: 'geoUnSelect',\n    event: 'geounselected'\n});\n\nvar DEFAULT_TOOLBOX_BTNS = ['rect', 'polygon', 'keep', 'clear'];\n\nvar preprocessor$1 = function (option, isNew) {\n    var brushComponents = option && option.brush;\n    if (!isArray(brushComponents)) {\n        brushComponents = brushComponents ? [brushComponents] : [];\n    }\n\n    if (!brushComponents.length) {\n        return;\n    }\n\n    var brushComponentSpecifiedBtns = [];\n\n    each$1(brushComponents, function (brushOpt) {\n        var tbs = brushOpt.hasOwnProperty('toolbox')\n            ? brushOpt.toolbox : [];\n\n        if (tbs instanceof Array) {\n            brushComponentSpecifiedBtns = brushComponentSpecifiedBtns.concat(tbs);\n        }\n    });\n\n    var toolbox = option && option.toolbox;\n\n    if (isArray(toolbox)) {\n        toolbox = toolbox[0];\n    }\n    if (!toolbox) {\n        toolbox = {feature: {}};\n        option.toolbox = [toolbox];\n    }\n\n    var toolboxFeature = (toolbox.feature || (toolbox.feature = {}));\n    var toolboxBrush = toolboxFeature.brush || (toolboxFeature.brush = {});\n    var brushTypes = toolboxBrush.type || (toolboxBrush.type = []);\n\n    brushTypes.push.apply(brushTypes, brushComponentSpecifiedBtns);\n\n    removeDuplicate(brushTypes);\n\n    if (isNew && !brushTypes.length) {\n        brushTypes.push.apply(brushTypes, DEFAULT_TOOLBOX_BTNS);\n    }\n};\n\nfunction removeDuplicate(arr) {\n    var map$$1 = {};\n    each$1(arr, function (val) {\n        map$$1[val] = 1;\n    });\n    arr.length = 0;\n    each$1(map$$1, function (flag, val) {\n        arr.push(val);\n    });\n}\n\n/**\n * @file Visual solution, for consistent option specification.\n */\n\nvar each$20 = each$1;\n\nfunction hasKeys(obj) {\n    if (obj) {\n        for (var name in obj){\n            if (obj.hasOwnProperty(name)) {\n                return true;\n            }\n        }\n    }\n}\n\n/**\n * @param {Object} option\n * @param {Array.<string>} stateList\n * @param {Function} [supplementVisualOption]\n * @return {Object} visualMappings <state, <visualType, module:echarts/visual/VisualMapping>>\n */\nfunction createVisualMappings(option, stateList, supplementVisualOption) {\n    var visualMappings = {};\n\n    each$20(stateList, function (state) {\n        var mappings = visualMappings[state] = createMappings();\n\n        each$20(option[state], function (visualData, visualType) {\n            if (!VisualMapping.isValidType(visualType)) {\n                return;\n            }\n            var mappingOption = {\n                type: visualType,\n                visual: visualData\n            };\n            supplementVisualOption && supplementVisualOption(mappingOption, state);\n            mappings[visualType] = new VisualMapping(mappingOption);\n\n            // Prepare a alpha for opacity, for some case that opacity\n            // is not supported, such as rendering using gradient color.\n            if (visualType === 'opacity') {\n                mappingOption = clone(mappingOption);\n                mappingOption.type = 'colorAlpha';\n                mappings.__hidden.__alphaForOpacity = new VisualMapping(mappingOption);\n            }\n        });\n    });\n\n    return visualMappings;\n\n    function createMappings() {\n        var Creater = function () {};\n        // Make sure hidden fields will not be visited by\n        // object iteration (with hasOwnProperty checking).\n        Creater.prototype.__hidden = Creater.prototype;\n        var obj = new Creater();\n        return obj;\n    }\n}\n\n/**\n * @param {Object} thisOption\n * @param {Object} newOption\n * @param {Array.<string>} keys\n */\nfunction replaceVisualOption(thisOption, newOption, keys) {\n    // Visual attributes merge is not supported, otherwise it\n    // brings overcomplicated merge logic. See #2853. So if\n    // newOption has anyone of these keys, all of these keys\n    // will be reset. Otherwise, all keys remain.\n    var has;\n    each$1(keys, function (key) {\n        if (newOption.hasOwnProperty(key) && hasKeys(newOption[key])) {\n            has = true;\n        }\n    });\n    has && each$1(keys, function (key) {\n        if (newOption.hasOwnProperty(key) && hasKeys(newOption[key])) {\n            thisOption[key] = clone(newOption[key]);\n        }\n        else {\n            delete thisOption[key];\n        }\n    });\n}\n\n/**\n * @param {Array.<string>} stateList\n * @param {Object} visualMappings <state, Object.<visualType, module:echarts/visual/VisualMapping>>\n * @param {module:echarts/data/List} list\n * @param {Function} getValueState param: valueOrIndex, return: state.\n * @param {object} [scope] Scope for getValueState\n * @param {string} [dimension] Concrete dimension, if used.\n */\n// ???! handle brush?\nfunction applyVisual(stateList, visualMappings, data, getValueState, scope, dimension) {\n    var visualTypesMap = {};\n    each$1(stateList, function (state) {\n        var visualTypes = VisualMapping.prepareVisualTypes(visualMappings[state]);\n        visualTypesMap[state] = visualTypes;\n    });\n\n    var dataIndex;\n\n    function getVisual(key) {\n        return data.getItemVisual(dataIndex, key);\n    }\n\n    function setVisual(key, value) {\n        data.setItemVisual(dataIndex, key, value);\n    }\n\n    if (dimension == null) {\n        data.each(eachItem);\n    }\n    else {\n        data.each([dimension], eachItem);\n    }\n\n    function eachItem(valueOrIndex, index) {\n        dataIndex = dimension == null ? valueOrIndex : index;\n\n        var rawDataItem = data.getRawDataItem(dataIndex);\n        // Consider performance\n        if (rawDataItem && rawDataItem.visualMap === false) {\n            return;\n        }\n\n        var valueState = getValueState.call(scope, valueOrIndex);\n        var mappings = visualMappings[valueState];\n        var visualTypes = visualTypesMap[valueState];\n\n        for (var i = 0, len = visualTypes.length; i < len; i++) {\n            var type = visualTypes[i];\n            mappings[type] && mappings[type].applyVisual(\n                valueOrIndex, getVisual, setVisual\n            );\n        }\n    }\n}\n\n/**\n * @param {module:echarts/data/List} data\n * @param {Array.<string>} stateList\n * @param {Object} visualMappings <state, Object.<visualType, module:echarts/visual/VisualMapping>>\n * @param {Function} getValueState param: valueOrIndex, return: state.\n * @param {number} [dim] dimension or dimension index.\n */\nfunction incrementalApplyVisual(stateList, visualMappings, getValueState, dim) {\n    var visualTypesMap = {};\n    each$1(stateList, function (state) {\n        var visualTypes = VisualMapping.prepareVisualTypes(visualMappings[state]);\n        visualTypesMap[state] = visualTypes;\n    });\n\n    function progress(params, data) {\n        if (dim != null) {\n            dim = data.getDimension(dim);\n        }\n\n        function getVisual(key) {\n            return data.getItemVisual(dataIndex, key);\n        }\n\n        function setVisual(key, value) {\n            data.setItemVisual(dataIndex, key, value);\n        }\n\n        for (var dataIndex = params.start; dataIndex < params.end; dataIndex++) {\n            var rawDataItem = data.getRawDataItem(dataIndex);\n\n            // Consider performance\n            if (rawDataItem && rawDataItem.visualMap === false) {\n                return;\n            }\n\n            var value = dim != null\n                ? data.get(dim, dataIndex, true)\n                : dataIndex;\n\n            var valueState = getValueState(value);\n            var mappings = visualMappings[valueState];\n            var visualTypes = visualTypesMap[valueState];\n\n            for (var i = 0, len = visualTypes.length; i < len; i++) {\n                var type = visualTypes[i];\n                mappings[type] && mappings[type].applyVisual(value, getVisual, setVisual);\n            }\n        }\n    }\n\n    return {progress: progress};\n}\n\n// Key of the first level is brushType: `line`, `rect`, `polygon`.\n// Key of the second level is chart element type: `point`, `rect`.\n// See moudule:echarts/component/helper/BrushController\n// function param:\n//      {Object} itemLayout fetch from data.getItemLayout(dataIndex)\n//      {Object} selectors {point: selector, rect: selector, ...}\n//      {Object} area {range: [[], [], ..], boudingRect}\n// function return:\n//      {boolean} Whether in the given brush.\nvar selector = {\n    lineX: getLineSelectors(0),\n    lineY: getLineSelectors(1),\n    rect: {\n        point: function (itemLayout, selectors, area) {\n            return itemLayout && area.boundingRect.contain(itemLayout[0], itemLayout[1]);\n        },\n        rect: function (itemLayout, selectors, area) {\n            return itemLayout && area.boundingRect.intersect(itemLayout);\n        }\n    },\n    polygon: {\n        point: function (itemLayout, selectors, area) {\n            return itemLayout\n                && area.boundingRect.contain(itemLayout[0], itemLayout[1])\n                && contain$1(area.range, itemLayout[0], itemLayout[1]);\n        },\n        rect: function (itemLayout, selectors, area) {\n            var points = area.range;\n\n            if (!itemLayout || points.length <= 1) {\n                return false;\n            }\n\n            var x = itemLayout.x;\n            var y = itemLayout.y;\n            var width = itemLayout.width;\n            var height = itemLayout.height;\n            var p = points[0];\n\n            if (contain$1(points, x, y)\n                || contain$1(points, x + width, y)\n                || contain$1(points, x, y + height)\n                || contain$1(points, x + width, y + height)\n                || BoundingRect.create(itemLayout).contain(p[0], p[1])\n                || lineIntersectPolygon(x, y, x + width, y, points)\n                || lineIntersectPolygon(x, y, x, y + height, points)\n                || lineIntersectPolygon(x + width, y, x + width, y + height, points)\n                || lineIntersectPolygon(x, y + height, x + width, y + height, points)\n            ) {\n                return true;\n            }\n        }\n    }\n};\n\nfunction getLineSelectors(xyIndex) {\n    var xy = ['x', 'y'];\n    var wh = ['width', 'height'];\n\n    return {\n        point: function (itemLayout, selectors, area) {\n            if (itemLayout) {\n                var range = area.range;\n                var p = itemLayout[xyIndex];\n                return inLineRange(p, range);\n            }\n        },\n        rect: function (itemLayout, selectors, area) {\n            if (itemLayout) {\n                var range = area.range;\n                var layoutRange = [\n                    itemLayout[xy[xyIndex]],\n                    itemLayout[xy[xyIndex]] + itemLayout[wh[xyIndex]]\n                ];\n                layoutRange[1] < layoutRange[0] && layoutRange.reverse();\n                return inLineRange(layoutRange[0], range)\n                    || inLineRange(layoutRange[1], range)\n                    || inLineRange(range[0], layoutRange)\n                    || inLineRange(range[1], layoutRange);\n            }\n        }\n    };\n}\n\nfunction inLineRange(p, range) {\n    return range[0] <= p && p <= range[1];\n}\n\nfunction lineIntersectPolygon(lx, ly, l2x, l2y, points) {\n    for (var i = 0, p2 = points[points.length - 1]; i < points.length; i++) {\n        var p = points[i];\n        if (lineIntersect(lx, ly, l2x, l2y, p[0], p[1], p2[0], p2[1])) {\n            return true;\n        }\n        p2 = p;\n    }\n}\n\n// Code from <http://blog.csdn.net/rickliuxiao/article/details/6259322> with some fix.\n// See <https://en.wikipedia.org/wiki/Line%E2%80%93line_intersection>\nfunction lineIntersect(a1x, a1y, a2x, a2y, b1x, b1y, b2x, b2y) {\n    var delta = determinant(a2x - a1x, b1x - b2x, a2y - a1y, b1y - b2y);\n    if (nearZero(delta)) { // parallel\n        return false;\n    }\n    var namenda = determinant(b1x - a1x, b1x - b2x, b1y - a1y, b1y - b2y) / delta;\n    if (namenda < 0 || namenda > 1) {\n        return false;\n    }\n    var miu = determinant(a2x - a1x, b1x - a1x, a2y - a1y, b1y - a1y) / delta;\n    if (miu < 0 || miu > 1) {\n        return false;\n    }\n    return true;\n}\n\nfunction nearZero(val) {\n    return val <= (1e-6) && val >= -(1e-6);\n}\n\nfunction determinant(v1, v2, v3, v4) {\n    return v1 * v4 - v2 * v3;\n}\n\nvar each$21 = each$1;\nvar indexOf$1 = indexOf;\nvar curry$5 = curry;\n\nvar COORD_CONVERTS = ['dataToPoint', 'pointToData'];\n\n// FIXME\n// how to genarialize to more coordinate systems.\nvar INCLUDE_FINDER_MAIN_TYPES = [\n    'grid', 'xAxis', 'yAxis', 'geo', 'graph',\n    'polar', 'radiusAxis', 'angleAxis', 'bmap'\n];\n\n/**\n * [option in constructor]:\n * {\n *     Index/Id/Name of geo, xAxis, yAxis, grid: See util/model#parseFinder.\n * }\n *\n *\n * [targetInfo]:\n *\n * There can be multiple axes in a single targetInfo. Consider the case\n * of `grid` component, a targetInfo represents a grid which contains one or more\n * cartesian and one or more axes. And consider the case of parallel system,\n * which has multiple axes in a coordinate system.\n * Can be {\n *     panelId: ...,\n *     coordSys: <a representitive cartesian in grid (first cartesian by default)>,\n *     coordSyses: all cartesians.\n *     gridModel: <grid component>\n *     xAxes: correspond to coordSyses on index\n *     yAxes: correspond to coordSyses on index\n * }\n * or {\n *     panelId: ...,\n *     coordSys: <geo coord sys>\n *     coordSyses: [<geo coord sys>]\n *     geoModel: <geo component>\n * }\n *\n *\n * [panelOpt]:\n *\n * Make from targetInfo. Input to BrushController.\n * {\n *     panelId: ...,\n *     rect: ...\n * }\n *\n *\n * [area]:\n *\n * Generated by BrushController or user input.\n * {\n *     panelId: Used to locate coordInfo directly. If user inpput, no panelId.\n *     brushType: determine how to convert to/from coord('rect' or 'polygon' or 'lineX/Y').\n *     Index/Id/Name of geo, xAxis, yAxis, grid: See util/model#parseFinder.\n *     range: pixel range.\n *     coordRange: representitive coord range (the first one of coordRanges).\n *     coordRanges: <Array> coord ranges, used in multiple cartesian in one grid.\n * }\n */\n\n/**\n * @param {Object} option contains Index/Id/Name of xAxis/yAxis/geo/grid\n *        Each can be {number|Array.<number>}. like: {xAxisIndex: [3, 4]}\n * @param {module:echarts/model/Global} ecModel\n * @param {Object} [opt]\n * @param {Array.<string>} [opt.include] include coordinate system types.\n */\nfunction BrushTargetManager(option, ecModel, opt) {\n    /**\n     * @private\n     * @type {Array.<Object>}\n     */\n    var targetInfoList = this._targetInfoList = [];\n    var info = {};\n    var foundCpts = parseFinder$1(ecModel, option);\n\n    each$21(targetInfoBuilders, function (builder, type) {\n        if (!opt || !opt.include || indexOf$1(opt.include, type) >= 0) {\n            builder(foundCpts, targetInfoList, info);\n        }\n    });\n}\n\nvar proto$2 = BrushTargetManager.prototype;\n\nproto$2.setOutputRanges = function (areas, ecModel) {\n    this.matchOutputRanges(areas, ecModel, function (area, coordRange, coordSys) {\n        (area.coordRanges || (area.coordRanges = [])).push(coordRange);\n        // area.coordRange is the first of area.coordRanges\n        if (!area.coordRange) {\n            area.coordRange = coordRange;\n            // In 'category' axis, coord to pixel is not reversible, so we can not\n            // rebuild range by coordRange accrately, which may bring trouble when\n            // brushing only one item. So we use __rangeOffset to rebuilding range\n            // by coordRange. And this it only used in brush component so it is no\n            // need to be adapted to coordRanges.\n            var result = coordConvert[area.brushType](0, coordSys, coordRange);\n            area.__rangeOffset = {\n                offset: diffProcessor[area.brushType](result.values, area.range, [1, 1]),\n                xyMinMax: result.xyMinMax\n            };\n        }\n    });\n};\n\nproto$2.matchOutputRanges = function (areas, ecModel, cb) {\n    each$21(areas, function (area) {\n        var targetInfo = this.findTargetInfo(area, ecModel);\n\n        if (targetInfo && targetInfo !== true) {\n            each$1(\n                targetInfo.coordSyses,\n                function (coordSys) {\n                    var result = coordConvert[area.brushType](1, coordSys, area.range);\n                    cb(area, result.values, coordSys, ecModel);\n                }\n            );\n        }\n    }, this);\n};\n\nproto$2.setInputRanges = function (areas, ecModel) {\n    each$21(areas, function (area) {\n        var targetInfo = this.findTargetInfo(area, ecModel);\n\n        if (__DEV__) {\n            assert$1(\n                !targetInfo || targetInfo === true || area.coordRange,\n                'coordRange must be specified when coord index specified.'\n            );\n            assert$1(\n                !targetInfo || targetInfo !== true || area.range,\n                'range must be specified in global brush.'\n            );\n        }\n\n        area.range = area.range || [];\n\n        // convert coordRange to global range and set panelId.\n        if (targetInfo && targetInfo !== true) {\n            area.panelId = targetInfo.panelId;\n            // (1) area.range shoule always be calculate from coordRange but does\n            // not keep its original value, for the sake of the dataZoom scenario,\n            // where area.coordRange remains unchanged but area.range may be changed.\n            // (2) Only support converting one coordRange to pixel range in brush\n            // component. So do not consider `coordRanges`.\n            // (3) About __rangeOffset, see comment above.\n            var result = coordConvert[area.brushType](0, targetInfo.coordSys, area.coordRange);\n            var rangeOffset = area.__rangeOffset;\n            area.range = rangeOffset\n                ? diffProcessor[area.brushType](\n                    result.values,\n                    rangeOffset.offset,\n                    getScales(result.xyMinMax, rangeOffset.xyMinMax)\n                )\n                : result.values;\n        }\n    }, this);\n};\n\nproto$2.makePanelOpts = function (api, getDefaultBrushType) {\n    return map(this._targetInfoList, function (targetInfo) {\n        var rect = targetInfo.getPanelRect();\n        return {\n            panelId: targetInfo.panelId,\n            defaultBrushType: getDefaultBrushType && getDefaultBrushType(targetInfo),\n            clipPath: makeRectPanelClipPath(rect),\n            isTargetByCursor: makeRectIsTargetByCursor(\n                rect, api, targetInfo.coordSysModel\n            ),\n            getLinearBrushOtherExtent: makeLinearBrushOtherExtent(rect)\n        };\n    });\n};\n\nproto$2.controlSeries = function (area, seriesModel, ecModel) {\n    // Check whether area is bound in coord, and series do not belong to that coord.\n    // If do not do this check, some brush (like lineX) will controll all axes.\n    var targetInfo = this.findTargetInfo(area, ecModel);\n    return targetInfo === true || (\n        targetInfo && indexOf$1(targetInfo.coordSyses, seriesModel.coordinateSystem) >= 0\n    );\n};\n\n/**\n * If return Object, a coord found.\n * If reutrn true, global found.\n * Otherwise nothing found.\n *\n * @param {Object} area\n * @param {Array} targetInfoList\n * @return {Object|boolean}\n */\nproto$2.findTargetInfo = function (area, ecModel) {\n    var targetInfoList = this._targetInfoList;\n    var foundCpts = parseFinder$1(ecModel, area);\n\n    for (var i = 0; i < targetInfoList.length; i++) {\n        var targetInfo = targetInfoList[i];\n        var areaPanelId = area.panelId;\n        if (areaPanelId) {\n            if (targetInfo.panelId === areaPanelId) {\n                return targetInfo;\n            }\n        }\n        else {\n            for (var i = 0; i < targetInfoMatchers.length; i++) {\n                if (targetInfoMatchers[i](foundCpts, targetInfo)) {\n                    return targetInfo;\n                }\n            }\n        }\n    }\n\n    return true;\n};\n\nfunction formatMinMax(minMax) {\n    minMax[0] > minMax[1] && minMax.reverse();\n    return minMax;\n}\n\nfunction parseFinder$1(ecModel, option) {\n    return parseFinder(\n        ecModel, option, {includeMainTypes: INCLUDE_FINDER_MAIN_TYPES}\n    );\n}\n\nvar targetInfoBuilders = {\n\n    grid: function (foundCpts, targetInfoList) {\n        var xAxisModels = foundCpts.xAxisModels;\n        var yAxisModels = foundCpts.yAxisModels;\n        var gridModels = foundCpts.gridModels;\n        // Remove duplicated.\n        var gridModelMap = createHashMap();\n        var xAxesHas = {};\n        var yAxesHas = {};\n\n        if (!xAxisModels && !yAxisModels && !gridModels) {\n            return;\n        }\n\n        each$21(xAxisModels, function (axisModel) {\n            var gridModel = axisModel.axis.grid.model;\n            gridModelMap.set(gridModel.id, gridModel);\n            xAxesHas[gridModel.id] = true;\n        });\n        each$21(yAxisModels, function (axisModel) {\n            var gridModel = axisModel.axis.grid.model;\n            gridModelMap.set(gridModel.id, gridModel);\n            yAxesHas[gridModel.id] = true;\n        });\n        each$21(gridModels, function (gridModel) {\n            gridModelMap.set(gridModel.id, gridModel);\n            xAxesHas[gridModel.id] = true;\n            yAxesHas[gridModel.id] = true;\n        });\n\n        gridModelMap.each(function (gridModel) {\n            var grid = gridModel.coordinateSystem;\n            var cartesians = [];\n\n            each$21(grid.getCartesians(), function (cartesian, index) {\n                if (indexOf$1(xAxisModels, cartesian.getAxis('x').model) >= 0\n                    || indexOf$1(yAxisModels, cartesian.getAxis('y').model) >= 0\n                ) {\n                    cartesians.push(cartesian);\n                }\n            });\n            targetInfoList.push({\n                panelId: 'grid--' + gridModel.id,\n                gridModel: gridModel,\n                coordSysModel: gridModel,\n                // Use the first one as the representitive coordSys.\n                coordSys: cartesians[0],\n                coordSyses: cartesians,\n                getPanelRect: panelRectBuilder.grid,\n                xAxisDeclared: xAxesHas[gridModel.id],\n                yAxisDeclared: yAxesHas[gridModel.id]\n            });\n        });\n    },\n\n    geo: function (foundCpts, targetInfoList) {\n        each$21(foundCpts.geoModels, function (geoModel) {\n            var coordSys = geoModel.coordinateSystem;\n            targetInfoList.push({\n                panelId: 'geo--' + geoModel.id,\n                geoModel: geoModel,\n                coordSysModel: geoModel,\n                coordSys: coordSys,\n                coordSyses: [coordSys],\n                getPanelRect: panelRectBuilder.geo\n            });\n        });\n    }\n};\n\nvar targetInfoMatchers = [\n\n    // grid\n    function (foundCpts, targetInfo) {\n        var xAxisModel = foundCpts.xAxisModel;\n        var yAxisModel = foundCpts.yAxisModel;\n        var gridModel = foundCpts.gridModel;\n\n        !gridModel && xAxisModel && (gridModel = xAxisModel.axis.grid.model);\n        !gridModel && yAxisModel && (gridModel = yAxisModel.axis.grid.model);\n\n        return gridModel && gridModel === targetInfo.gridModel;\n    },\n\n    // geo\n    function (foundCpts, targetInfo) {\n        var geoModel = foundCpts.geoModel;\n        return geoModel && geoModel === targetInfo.geoModel;\n    }\n];\n\nvar panelRectBuilder = {\n\n    grid: function () {\n        // grid is not Transformable.\n        return this.coordSys.grid.getRect().clone();\n    },\n\n    geo: function () {\n        var coordSys = this.coordSys;\n        var rect = coordSys.getBoundingRect().clone();\n        // geo roam and zoom transform\n        rect.applyTransform(getTransform(coordSys));\n        return rect;\n    }\n};\n\nvar coordConvert = {\n\n    lineX: curry$5(axisConvert, 0),\n\n    lineY: curry$5(axisConvert, 1),\n\n    rect: function (to, coordSys, rangeOrCoordRange) {\n        var xminymin = coordSys[COORD_CONVERTS[to]]([rangeOrCoordRange[0][0], rangeOrCoordRange[1][0]]);\n        var xmaxymax = coordSys[COORD_CONVERTS[to]]([rangeOrCoordRange[0][1], rangeOrCoordRange[1][1]]);\n        var values = [\n            formatMinMax([xminymin[0], xmaxymax[0]]),\n            formatMinMax([xminymin[1], xmaxymax[1]])\n        ];\n        return {values: values, xyMinMax: values};\n    },\n\n    polygon: function (to, coordSys, rangeOrCoordRange) {\n        var xyMinMax = [[Infinity, -Infinity], [Infinity, -Infinity]];\n        var values = map(rangeOrCoordRange, function (item) {\n            var p = coordSys[COORD_CONVERTS[to]](item);\n            xyMinMax[0][0] = Math.min(xyMinMax[0][0], p[0]);\n            xyMinMax[1][0] = Math.min(xyMinMax[1][0], p[1]);\n            xyMinMax[0][1] = Math.max(xyMinMax[0][1], p[0]);\n            xyMinMax[1][1] = Math.max(xyMinMax[1][1], p[1]);\n            return p;\n        });\n        return {values: values, xyMinMax: xyMinMax};\n    }\n};\n\nfunction axisConvert(axisNameIndex, to, coordSys, rangeOrCoordRange) {\n    if (__DEV__) {\n        assert$1(\n            coordSys.type === 'cartesian2d',\n            'lineX/lineY brush is available only in cartesian2d.'\n        );\n    }\n\n    var axis = coordSys.getAxis(['x', 'y'][axisNameIndex]);\n    var values = formatMinMax(map([0, 1], function (i) {\n        return to\n            ? axis.coordToData(axis.toLocalCoord(rangeOrCoordRange[i]))\n            : axis.toGlobalCoord(axis.dataToCoord(rangeOrCoordRange[i]));\n    }));\n    var xyMinMax = [];\n    xyMinMax[axisNameIndex] = values;\n    xyMinMax[1 - axisNameIndex] = [NaN, NaN];\n\n    return {values: values, xyMinMax: xyMinMax};\n}\n\nvar diffProcessor = {\n    lineX: curry$5(axisDiffProcessor, 0),\n\n    lineY: curry$5(axisDiffProcessor, 1),\n\n    rect: function (values, refer, scales) {\n        return [\n            [values[0][0] - scales[0] * refer[0][0], values[0][1] - scales[0] * refer[0][1]],\n            [values[1][0] - scales[1] * refer[1][0], values[1][1] - scales[1] * refer[1][1]]\n        ];\n    },\n\n    polygon: function (values, refer, scales) {\n        return map(values, function (item, idx) {\n            return [item[0] - scales[0] * refer[idx][0], item[1] - scales[1] * refer[idx][1]];\n        });\n    }\n};\n\nfunction axisDiffProcessor(axisNameIndex, values, refer, scales) {\n    return [\n        values[0] - scales[axisNameIndex] * refer[0],\n        values[1] - scales[axisNameIndex] * refer[1]\n    ];\n}\n\n// We have to process scale caused by dataZoom manually,\n// although it might be not accurate.\nfunction getScales(xyMinMaxCurr, xyMinMaxOrigin) {\n    var sizeCurr = getSize(xyMinMaxCurr);\n    var sizeOrigin = getSize(xyMinMaxOrigin);\n    var scales = [sizeCurr[0] / sizeOrigin[0], sizeCurr[1] / sizeOrigin[1]];\n    isNaN(scales[0]) && (scales[0] = 1);\n    isNaN(scales[1]) && (scales[1] = 1);\n    return scales;\n}\n\nfunction getSize(xyMinMax) {\n    return xyMinMax\n        ? [xyMinMax[0][1] - xyMinMax[0][0], xyMinMax[1][1] - xyMinMax[1][0]]\n        : [NaN, NaN];\n}\n\nvar STATE_LIST = ['inBrush', 'outOfBrush'];\nvar DISPATCH_METHOD = '__ecBrushSelect';\nvar DISPATCH_FLAG = '__ecInBrushSelectEvent';\nvar PRIORITY_BRUSH = PRIORITY.VISUAL.BRUSH;\n\n/**\n * Layout for visual, the priority higher than other layout, and before brush visual.\n */\nregisterLayout(PRIORITY_BRUSH, function (ecModel, api, payload) {\n    ecModel.eachComponent({mainType: 'brush'}, function (brushModel) {\n\n        payload && payload.type === 'takeGlobalCursor' && brushModel.setBrushOption(\n            payload.key === 'brush' ? payload.brushOption : {brushType: false}\n        );\n\n        var brushTargetManager = brushModel.brushTargetManager = new BrushTargetManager(brushModel.option, ecModel);\n\n        brushTargetManager.setInputRanges(brushModel.areas, ecModel);\n    });\n});\n\n/**\n * Register the visual encoding if this modules required.\n */\nregisterVisual(PRIORITY_BRUSH, function (ecModel, api, payload) {\n\n    var brushSelected = [];\n    var throttleType;\n    var throttleDelay;\n\n    ecModel.eachComponent({mainType: 'brush'}, function (brushModel, brushIndex) {\n\n        var thisBrushSelected = {\n            brushId: brushModel.id,\n            brushIndex: brushIndex,\n            brushName: brushModel.name,\n            areas: clone(brushModel.areas),\n            selected: []\n        };\n        // Every brush component exists in event params, convenient\n        // for user to find by index.\n        brushSelected.push(thisBrushSelected);\n\n        var brushOption = brushModel.option;\n        var brushLink = brushOption.brushLink;\n        var linkedSeriesMap = [];\n        var selectedDataIndexForLink = [];\n        var rangeInfoBySeries = [];\n        var hasBrushExists = 0;\n\n        if (!brushIndex) { // Only the first throttle setting works.\n            throttleType = brushOption.throttleType;\n            throttleDelay = brushOption.throttleDelay;\n        }\n\n        // Add boundingRect and selectors to range.\n        var areas = map(brushModel.areas, function (area) {\n            return bindSelector(\n                defaults(\n                    {boundingRect: boundingRectBuilders[area.brushType](area)},\n                    area\n                )\n            );\n        });\n\n        var visualMappings = createVisualMappings(\n            brushModel.option, STATE_LIST, function (mappingOption) {\n                mappingOption.mappingMethod = 'fixed';\n            }\n        );\n\n        isArray(brushLink) && each$1(brushLink, function (seriesIndex) {\n            linkedSeriesMap[seriesIndex] = 1;\n        });\n\n        function linkOthers(seriesIndex) {\n            return brushLink === 'all' || linkedSeriesMap[seriesIndex];\n        }\n\n        // If no supported brush or no brush on the series,\n        // all visuals should be in original state.\n        function brushed(rangeInfoList) {\n            return !!rangeInfoList.length;\n        }\n\n        /**\n         * Logic for each series: (If the logic has to be modified one day, do it carefully!)\n         *\n         * ( brushed  && hasBrushExist  && linkOthers  ) => StepA: record,  StepB: visualByRecord.\n         *   !brushed    hasBrushExist                             nothing,        visualByRecord.\n         *                !hasBrushExist                                              nothing.\n         * ( !brushed  && hasBrushExist  && linkOthers  ) => StepA:  nothing,  StepB: visualByRecord.\n         *                !hasBrushExist                                              nothing.\n         * ( brushed  &&                     !linkOthers ) => StepA:  nothing,  StepB: visualByCheck.\n         *   !brushed                                                                  nothing.\n         * ( !brushed  &&                     !linkOthers ) => StepA:  nothing,  StepB:  nothing.\n         */\n\n        // Step A\n        ecModel.eachSeries(function (seriesModel, seriesIndex) {\n            var rangeInfoList = rangeInfoBySeries[seriesIndex] = [];\n\n            seriesModel.subType === 'parallel'\n                ? stepAParallel(seriesModel, seriesIndex, rangeInfoList)\n                : stepAOthers(seriesModel, seriesIndex, rangeInfoList);\n        });\n\n        function stepAParallel(seriesModel, seriesIndex) {\n            var coordSys = seriesModel.coordinateSystem;\n            hasBrushExists |= coordSys.hasAxisBrushed();\n\n            linkOthers(seriesIndex) && coordSys.eachActiveState(\n                seriesModel.getData(),\n                function (activeState, dataIndex) {\n                    activeState === 'active' && (selectedDataIndexForLink[dataIndex] = 1);\n                }\n            );\n        }\n\n        function stepAOthers(seriesModel, seriesIndex, rangeInfoList) {\n            var selectorsByBrushType = getSelectorsByBrushType(seriesModel);\n            if (!selectorsByBrushType || brushModelNotControll(brushModel, seriesIndex)) {\n                return;\n            }\n\n            each$1(areas, function (area) {\n                selectorsByBrushType[area.brushType]\n                    && brushModel.brushTargetManager.controlSeries(area, seriesModel, ecModel)\n                    && rangeInfoList.push(area);\n                hasBrushExists |= brushed(rangeInfoList);\n            });\n\n            if (linkOthers(seriesIndex) && brushed(rangeInfoList)) {\n                var data = seriesModel.getData();\n                data.each(function (dataIndex) {\n                    if (checkInRange(selectorsByBrushType, rangeInfoList, data, dataIndex)) {\n                        selectedDataIndexForLink[dataIndex] = 1;\n                    }\n                });\n            }\n        }\n\n        // Step B\n        ecModel.eachSeries(function (seriesModel, seriesIndex) {\n            var seriesBrushSelected = {\n                seriesId: seriesModel.id,\n                seriesIndex: seriesIndex,\n                seriesName: seriesModel.name,\n                dataIndex: []\n            };\n            // Every series exists in event params, convenient\n            // for user to find series by seriesIndex.\n            thisBrushSelected.selected.push(seriesBrushSelected);\n\n            var selectorsByBrushType = getSelectorsByBrushType(seriesModel);\n            var rangeInfoList = rangeInfoBySeries[seriesIndex];\n\n            var data = seriesModel.getData();\n            var getValueState = linkOthers(seriesIndex)\n                ? function (dataIndex) {\n                    return selectedDataIndexForLink[dataIndex]\n                        ? (seriesBrushSelected.dataIndex.push(data.getRawIndex(dataIndex)), 'inBrush')\n                        : 'outOfBrush';\n                }\n                : function (dataIndex) {\n                    return checkInRange(selectorsByBrushType, rangeInfoList, data, dataIndex)\n                        ? (seriesBrushSelected.dataIndex.push(data.getRawIndex(dataIndex)), 'inBrush')\n                        : 'outOfBrush';\n                };\n\n            // If no supported brush or no brush, all visuals are in original state.\n            (linkOthers(seriesIndex) ? hasBrushExists : brushed(rangeInfoList))\n                && applyVisual(\n                    STATE_LIST, visualMappings, data, getValueState\n                );\n        });\n\n    });\n\n    dispatchAction(api, throttleType, throttleDelay, brushSelected, payload);\n});\n\nfunction dispatchAction(api, throttleType, throttleDelay, brushSelected, payload) {\n    // This event will not be triggered when `setOpion`, otherwise dead lock may\n    // triggered when do `setOption` in event listener, which we do not find\n    // satisfactory way to solve yet. Some considered resolutions:\n    // (a) Diff with prevoius selected data ant only trigger event when changed.\n    // But store previous data and diff precisely (i.e., not only by dataIndex, but\n    // also detect value changes in selected data) might bring complexity or fragility.\n    // (b) Use spectial param like `silent` to suppress event triggering.\n    // But such kind of volatile param may be weird in `setOption`.\n    if (!payload) {\n        return;\n    }\n\n    var zr = api.getZr();\n    if (zr[DISPATCH_FLAG]) {\n        return;\n    }\n\n    if (!zr[DISPATCH_METHOD]) {\n        zr[DISPATCH_METHOD] = doDispatch;\n    }\n\n    var fn = createOrUpdate(zr, DISPATCH_METHOD, throttleDelay, throttleType);\n\n    fn(api, brushSelected);\n}\n\nfunction doDispatch(api, brushSelected) {\n    if (!api.isDisposed()) {\n        var zr = api.getZr();\n        zr[DISPATCH_FLAG] = true;\n        api.dispatchAction({\n            type: 'brushSelect',\n            batch: brushSelected\n        });\n        zr[DISPATCH_FLAG] = false;\n    }\n}\n\nfunction checkInRange(selectorsByBrushType, rangeInfoList, data, dataIndex) {\n    for (var i = 0, len = rangeInfoList.length; i < len; i++) {\n        var area = rangeInfoList[i];\n        if (selectorsByBrushType[area.brushType](\n            dataIndex, data, area.selectors, area\n        )) {\n            return true;\n        }\n    }\n}\n\nfunction getSelectorsByBrushType(seriesModel) {\n    var brushSelector = seriesModel.brushSelector;\n    if (isString(brushSelector)) {\n        var sels = [];\n        each$1(selector, function (selectorsByElementType, brushType) {\n            sels[brushType] = function (dataIndex, data, selectors, area) {\n                var itemLayout = data.getItemLayout(dataIndex);\n                return selectorsByElementType[brushSelector](itemLayout, selectors, area);\n            };\n        });\n        return sels;\n    }\n    else if (isFunction$1(brushSelector)) {\n        var bSelector = {};\n        each$1(selector, function (sel, brushType) {\n            bSelector[brushType] = brushSelector;\n        });\n        return bSelector;\n    }\n    return brushSelector;\n}\n\nfunction brushModelNotControll(brushModel, seriesIndex) {\n    var seriesIndices = brushModel.option.seriesIndex;\n    return seriesIndices != null\n        && seriesIndices !== 'all'\n        && (\n            isArray(seriesIndices)\n            ? indexOf(seriesIndices, seriesIndex) < 0\n            : seriesIndex !== seriesIndices\n        );\n}\n\nfunction bindSelector(area) {\n    var selectors = area.selectors = {};\n    each$1(selector[area.brushType], function (selFn, elType) {\n        // Do not use function binding or curry for performance.\n        selectors[elType] = function (itemLayout) {\n            return selFn(itemLayout, selectors, area);\n        };\n    });\n    return area;\n}\n\nvar boundingRectBuilders = {\n\n    lineX: noop,\n\n    lineY: noop,\n\n    rect: function (area) {\n        return getBoundingRectFromMinMax(area.range);\n    },\n\n    polygon: function (area) {\n        var minMax;\n        var range = area.range;\n\n        for (var i = 0, len = range.length; i < len; i++) {\n            minMax = minMax || [[Infinity, -Infinity], [Infinity, -Infinity]];\n            var rg = range[i];\n            rg[0] < minMax[0][0] && (minMax[0][0] = rg[0]);\n            rg[0] > minMax[0][1] && (minMax[0][1] = rg[0]);\n            rg[1] < minMax[1][0] && (minMax[1][0] = rg[1]);\n            rg[1] > minMax[1][1] && (minMax[1][1] = rg[1]);\n        }\n\n        return minMax && getBoundingRectFromMinMax(minMax);\n    }\n};\n\nfunction getBoundingRectFromMinMax(minMax) {\n    return new BoundingRect(\n        minMax[0][0],\n        minMax[1][0],\n        minMax[0][1] - minMax[0][0],\n        minMax[1][1] - minMax[1][0]\n    );\n}\n\nvar DEFAULT_OUT_OF_BRUSH_COLOR = ['#ddd'];\n\nvar BrushModel = extendComponentModel({\n\n    type: 'brush',\n\n    dependencies: ['geo', 'grid', 'xAxis', 'yAxis', 'parallel', 'series'],\n\n    /**\n     * @protected\n     */\n    defaultOption: {\n        // inBrush: null,\n        // outOfBrush: null,\n        toolbox: null,          // Default value see preprocessor.\n        brushLink: null,        // Series indices array, broadcast using dataIndex.\n                                // or 'all', which means all series. 'none' or null means no series.\n        seriesIndex: 'all',     // seriesIndex array, specify series controlled by this brush component.\n        geoIndex: null,         //\n        xAxisIndex: null,\n        yAxisIndex: null,\n\n        brushType: 'rect',      // Default brushType, see BrushController.\n        brushMode: 'single',    // Default brushMode, 'single' or 'multiple'\n        transformable: true,    // Default transformable.\n        brushStyle: {           // Default brushStyle\n            borderWidth: 1,\n            color: 'rgba(120,140,180,0.3)',\n            borderColor: 'rgba(120,140,180,0.8)'\n        },\n\n        throttleType: 'fixRate',// Throttle in brushSelected event. 'fixRate' or 'debounce'.\n                                // If null, no throttle. Valid only in the first brush component\n        throttleDelay: 0,       // Unit: ms, 0 means every event will be triggered.\n\n        // FIXME\n        // \n        removeOnClick: true,\n\n        z: 10000\n    },\n\n    /**\n     * @readOnly\n     * @type {Array.<Object>}\n     */\n    areas: [],\n\n    /**\n     * Current activated brush type.\n     * If null, brush is inactived.\n     * see module:echarts/component/helper/BrushController\n     * @readOnly\n     * @type {string}\n     */\n    brushType: null,\n\n    /**\n     * Current brush opt.\n     * see module:echarts/component/helper/BrushController\n     * @readOnly\n     * @type {Object}\n     */\n    brushOption: {},\n\n    /**\n     * @readOnly\n     * @type {Array.<Object>}\n     */\n    coordInfoList: [],\n\n    optionUpdated: function (newOption, isInit) {\n        var thisOption = this.option;\n\n        !isInit && replaceVisualOption(\n            thisOption, newOption, ['inBrush', 'outOfBrush']\n        );\n\n        thisOption.inBrush = thisOption.inBrush || {};\n        // Always give default visual, consider setOption at the second time.\n        thisOption.outOfBrush = thisOption.outOfBrush || {color: DEFAULT_OUT_OF_BRUSH_COLOR};\n    },\n\n    /**\n     * If ranges is null/undefined, range state remain.\n     *\n     * @param {Array.<Object>} [ranges]\n     */\n    setAreas: function (areas) {\n        if (__DEV__) {\n            assert$1(isArray(areas));\n            each$1(areas, function (area) {\n                assert$1(area.brushType, 'Illegal areas');\n            });\n        }\n\n        // If ranges is null/undefined, range state remain.\n        // This helps user to dispatchAction({type: 'brush'}) with no areas\n        // set but just want to get the current brush select info from a `brush` event.\n        if (!areas) {\n            return;\n        }\n\n        this.areas = map(areas, function (area) {\n            return generateBrushOption(this.option, area);\n        }, this);\n    },\n\n    /**\n     * see module:echarts/component/helper/BrushController\n     * @param {Object} brushOption\n     */\n    setBrushOption: function (brushOption) {\n        this.brushOption = generateBrushOption(this.option, brushOption);\n        this.brushType = this.brushOption.brushType;\n    }\n\n});\n\nfunction generateBrushOption(option, brushOption) {\n    return merge(\n        {\n            brushType: option.brushType,\n            brushMode: option.brushMode,\n            transformable: option.transformable,\n            brushStyle: new Model(option.brushStyle).getItemStyle(),\n            removeOnClick: option.removeOnClick,\n            z: option.z\n        },\n        brushOption,\n        true\n    );\n}\n\nextendComponentView({\n\n    type: 'brush',\n\n    init: function (ecModel, api) {\n\n        /**\n         * @readOnly\n         * @type {module:echarts/model/Global}\n         */\n        this.ecModel = ecModel;\n\n        /**\n         * @readOnly\n         * @type {module:echarts/ExtensionAPI}\n         */\n        this.api = api;\n\n        /**\n         * @readOnly\n         * @type {module:echarts/component/brush/BrushModel}\n         */\n        this.model;\n\n        /**\n         * @private\n         * @type {module:echarts/component/helper/BrushController}\n         */\n        (this._brushController = new BrushController(api.getZr()))\n            .on('brush', bind(this._onBrush, this))\n            .mount();\n    },\n\n    /**\n     * @override\n     */\n    render: function (brushModel) {\n        this.model = brushModel;\n        return updateController.apply(this, arguments);\n    },\n\n    /**\n     * @override\n     */\n    updateTransform: updateController,\n\n    /**\n     * @override\n     */\n    updateView: updateController,\n\n    // /**\n    //  * @override\n    //  */\n    // updateLayout: updateController,\n\n    // /**\n    //  * @override\n    //  */\n    // updateVisual: updateController,\n\n    /**\n     * @override\n     */\n    dispose: function () {\n        this._brushController.dispose();\n    },\n\n    /**\n     * @private\n     */\n    _onBrush: function (areas, opt) {\n        var modelId = this.model.id;\n\n        this.model.brushTargetManager.setOutputRanges(areas, this.ecModel);\n\n        // Action is not dispatched on drag end, because the drag end\n        // emits the same params with the last drag move event, and\n        // may have some delay when using touch pad, which makes\n        // animation not smooth (when using debounce).\n        (!opt.isEnd || opt.removeOnClick) && this.api.dispatchAction({\n            type: 'brush',\n            brushId: modelId,\n            areas: clone(areas),\n            $from: modelId\n        });\n    }\n\n});\n\nfunction updateController(brushModel, ecModel, api, payload) {\n    // Do not update controller when drawing.\n    (!payload || payload.$from !== brushModel.id) && this._brushController\n        .setPanels(brushModel.brushTargetManager.makePanelOpts(api))\n        .enableBrush(brushModel.brushOption)\n        .updateCovers(brushModel.areas.slice());\n}\n\n/**\n * payload: {\n *      brushIndex: number, or,\n *      brushId: string, or,\n *      brushName: string,\n *      globalRanges: Array\n * }\n */\nregisterAction(\n        {type: 'brush', event: 'brush' /*, update: 'updateView' */},\n    function (payload, ecModel) {\n        ecModel.eachComponent({mainType: 'brush', query: payload}, function (brushModel) {\n            brushModel.setAreas(payload.areas);\n        });\n    }\n);\n\n/**\n * payload: {\n *      brushComponents: [\n *          {\n *              brushId,\n *              brushIndex,\n *              brushName,\n *              series: [\n *                  {\n *                      seriesId,\n *                      seriesIndex,\n *                      seriesName,\n *                      rawIndices: [21, 34, ...]\n *                  },\n *                  ...\n *              ]\n *          },\n *          ...\n *      ]\n * }\n */\nregisterAction(\n        {type: 'brushSelect', event: 'brushSelected', update: 'none'},\n    function () {}\n);\n\nvar features = {};\n\nfunction register$1(name, ctor) {\n    features[name] = ctor;\n}\n\nfunction get$1(name) {\n    return features[name];\n}\n\nvar brushLang = lang.toolbox.brush;\n\nfunction Brush(model, ecModel, api) {\n    this.model = model;\n    this.ecModel = ecModel;\n    this.api = api;\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this._brushType;\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this._brushMode;\n}\n\nBrush.defaultOption = {\n    show: true,\n    type: ['rect', 'polygon', 'lineX', 'lineY', 'keep', 'clear'],\n    icon: {\n        rect: 'M7.3,34.7 M0.4,10V-0.2h9.8 M89.6,10V-0.2h-9.8 M0.4,60v10.2h9.8 M89.6,60v10.2h-9.8 M12.3,22.4V10.5h13.1 M33.6,10.5h7.8 M49.1,10.5h7.8 M77.5,22.4V10.5h-13 M12.3,31.1v8.2 M77.7,31.1v8.2 M12.3,47.6v11.9h13.1 M33.6,59.5h7.6 M49.1,59.5 h7.7 M77.5,47.6v11.9h-13', // jshint ignore:line\n        polygon: 'M55.2,34.9c1.7,0,3.1,1.4,3.1,3.1s-1.4,3.1-3.1,3.1 s-3.1-1.4-3.1-3.1S53.5,34.9,55.2,34.9z M50.4,51c1.7,0,3.1,1.4,3.1,3.1c0,1.7-1.4,3.1-3.1,3.1c-1.7,0-3.1-1.4-3.1-3.1 C47.3,52.4,48.7,51,50.4,51z M55.6,37.1l1.5-7.8 M60.1,13.5l1.6-8.7l-7.8,4 M59,19l-1,5.3 M24,16.1l6.4,4.9l6.4-3.3 M48.5,11.6 l-5.9,3.1 M19.1,12.8L9.7,5.1l1.1,7.7 M13.4,29.8l1,7.3l6.6,1.6 M11.6,18.4l1,6.1 M32.8,41.9 M26.6,40.4 M27.3,40.2l6.1,1.6 M49.9,52.1l-5.6-7.6l-4.9-1.2', // jshint ignore:line\n        lineX: 'M15.2,30 M19.7,15.6V1.9H29 M34.8,1.9H40.4 M55.3,15.6V1.9H45.9 M19.7,44.4V58.1H29 M34.8,58.1H40.4 M55.3,44.4 V58.1H45.9 M12.5,20.3l-9.4,9.6l9.6,9.8 M3.1,29.9h16.5 M62.5,20.3l9.4,9.6L62.3,39.7 M71.9,29.9H55.4', // jshint ignore:line\n        lineY: 'M38.8,7.7 M52.7,12h13.2v9 M65.9,26.6V32 M52.7,46.3h13.2v-9 M24.9,12H11.8v9 M11.8,26.6V32 M24.9,46.3H11.8v-9 M48.2,5.1l-9.3-9l-9.4,9.2 M38.9-3.9V12 M48.2,53.3l-9.3,9l-9.4-9.2 M38.9,62.3V46.4', // jshint ignore:line\n        keep: 'M4,10.5V1h10.3 M20.7,1h6.1 M33,1h6.1 M55.4,10.5V1H45.2 M4,17.3v6.6 M55.6,17.3v6.6 M4,30.5V40h10.3 M20.7,40 h6.1 M33,40h6.1 M55.4,30.5V40H45.2 M21,18.9h62.9v48.6H21V18.9z', // jshint ignore:line\n        clear: 'M22,14.7l30.9,31 M52.9,14.7L22,45.7 M4.7,16.8V4.2h13.1 M26,4.2h7.8 M41.6,4.2h7.8 M70.3,16.8V4.2H57.2 M4.7,25.9v8.6 M70.3,25.9v8.6 M4.7,43.2v12.6h13.1 M26,55.8h7.8 M41.6,55.8h7.8 M70.3,43.2v12.6H57.2' // jshint ignore:line\n    },\n    // `rect`, `polygon`, `lineX`, `lineY`, `keep`, `clear`\n    title: clone(brushLang.title)\n};\n\nvar proto$3 = Brush.prototype;\n\n// proto.updateLayout = function (featureModel, ecModel, api) {\nproto$3.render =\nproto$3.updateView = function (featureModel, ecModel, api) {\n    var brushType;\n    var brushMode;\n    var isBrushed;\n\n    ecModel.eachComponent({mainType: 'brush'}, function (brushModel) {\n        brushType = brushModel.brushType;\n        brushMode = brushModel.brushOption.brushMode || 'single';\n        isBrushed |= brushModel.areas.length;\n    });\n    this._brushType = brushType;\n    this._brushMode = brushMode;\n\n    each$1(featureModel.get('type', true), function (type) {\n        featureModel.setIconStatus(\n            type,\n            (\n                type === 'keep'\n                ? brushMode === 'multiple'\n                : type === 'clear'\n                ? isBrushed\n                : type === brushType\n            ) ? 'emphasis' : 'normal'\n        );\n    });\n};\n\nproto$3.getIcons = function () {\n    var model = this.model;\n    var availableIcons = model.get('icon', true);\n    var icons = {};\n    each$1(model.get('type', true), function (type) {\n        if (availableIcons[type]) {\n            icons[type] = availableIcons[type];\n        }\n    });\n    return icons;\n};\n\nproto$3.onclick = function (ecModel, api, type) {\n    var brushType = this._brushType;\n    var brushMode = this._brushMode;\n\n    if (type === 'clear') {\n        // Trigger parallel action firstly\n        api.dispatchAction({\n            type: 'axisAreaSelect',\n            intervals: []\n        });\n\n        api.dispatchAction({\n            type: 'brush',\n            command: 'clear',\n            // Clear all areas of all brush components.\n            areas: []\n        });\n    }\n    else {\n        api.dispatchAction({\n            type: 'takeGlobalCursor',\n            key: 'brush',\n            brushOption: {\n                brushType: type === 'keep'\n                    ? brushType\n                    : (brushType === type ? false : type),\n                brushMode: type === 'keep'\n                    ? (brushMode === 'multiple' ? 'single' : 'multiple')\n                    : brushMode\n            }\n        });\n    }\n};\n\nregister$1('brush', Brush);\n\n/**\n * Brush component entry\n */\n\nregisterPreprocessor(preprocessor$1);\n\n// (24*60*60*1000)\nvar PROXIMATE_ONE_DAY = 86400000;\n\n/**\n * Calendar\n *\n * @constructor\n *\n * @param {Object} calendarModel calendarModel\n * @param {Object} ecModel       ecModel\n * @param {Object} api           api\n */\nfunction Calendar(calendarModel, ecModel, api) {\n    this._model = calendarModel;\n}\n\nCalendar.prototype = {\n\n    constructor: Calendar,\n\n    type: 'calendar',\n\n    dimensions: ['time', 'value'],\n\n    // Required in createListFromData\n    getDimensionsInfo: function () {\n        return [{name: 'time', type: 'time'}, 'value'];\n    },\n\n    getRangeInfo: function () {\n        return this._rangeInfo;\n    },\n\n    getModel: function () {\n        return this._model;\n    },\n\n    getRect: function () {\n        return this._rect;\n    },\n\n    getCellWidth: function () {\n        return this._sw;\n    },\n\n    getCellHeight: function () {\n        return this._sh;\n    },\n\n    getOrient: function () {\n        return this._orient;\n    },\n\n    /**\n     * getFirstDayOfWeek\n     *\n     * @example\n     *     0 : start at Sunday\n     *     1 : start at Monday\n     *\n     * @return {number}\n     */\n    getFirstDayOfWeek: function () {\n        return this._firstDayOfWeek;\n    },\n\n    /**\n     * get date info\n     *\n     * @param  {string|number} date date\n     * @return {Object}\n     * {\n     *      y: string, local full year, eg., '1940',\n     *      m: string, local month, from '01' ot '12',\n     *      d: string, local date, from '01' to '31' (if exists),\n     *      day: It is not date.getDay(). It is the location of the cell in a week, from 0 to 6,\n     *      time: timestamp,\n     *      formatedDate: string, yyyy-MM-dd,\n     *      date: original date object.\n     * }\n     */\n    getDateInfo: function (date) {\n\n        date = parseDate(date);\n\n        var y = date.getFullYear();\n\n        var m = date.getMonth() + 1;\n        m = m < 10 ? '0' + m : m;\n\n        var d = date.getDate();\n        d = d < 10 ? '0' + d : d;\n\n        var day = date.getDay();\n\n        day = Math.abs((day + 7 - this.getFirstDayOfWeek()) % 7);\n\n        return {\n            y: y,\n            m: m,\n            d: d,\n            day: day,\n            time: date.getTime(),\n            formatedDate: y + '-' + m + '-' + d,\n            date: date\n        };\n    },\n\n    getNextNDay: function (date, n) {\n        n = n || 0;\n        if (n === 0) {\n            return this.getDateInfo(date);\n        }\n\n        date = new Date(this.getDateInfo(date).time);\n        date.setDate(date.getDate() + n);\n\n        return this.getDateInfo(date);\n    },\n\n    update: function (ecModel, api) {\n\n        this._firstDayOfWeek = +this._model.getModel('dayLabel').get('firstDay');\n        this._orient = this._model.get('orient');\n        this._lineWidth = this._model.getModel('itemStyle').getItemStyle().lineWidth || 0;\n\n\n        this._rangeInfo = this._getRangeInfo(this._initRangeOption());\n        var weeks = this._rangeInfo.weeks || 1;\n        var whNames = ['width', 'height'];\n        var cellSize = this._model.get('cellSize').slice();\n        var layoutParams = this._model.getBoxLayoutParams();\n        var cellNumbers = this._orient === 'horizontal' ? [weeks, 7] : [7, weeks];\n\n        each$1([0, 1], function (idx) {\n            if (cellSizeSpecified(cellSize, idx)) {\n                layoutParams[whNames[idx]] = cellSize[idx] * cellNumbers[idx];\n            }\n        });\n\n        var whGlobal = {\n            width: api.getWidth(),\n            height: api.getHeight()\n        };\n        var calendarRect = this._rect = getLayoutRect(layoutParams, whGlobal);\n\n        each$1([0, 1], function (idx) {\n            if (!cellSizeSpecified(cellSize, idx)) {\n                cellSize[idx] = calendarRect[whNames[idx]] / cellNumbers[idx];\n            }\n        });\n\n        function cellSizeSpecified(cellSize, idx) {\n            return cellSize[idx] != null && cellSize[idx] !== 'auto';\n        }\n\n        this._sw = cellSize[0];\n        this._sh = cellSize[1];\n    },\n\n\n    /**\n     * Convert a time data(time, value) item to (x, y) point.\n     *\n     * @override\n     * @param  {Array|number} data data\n     * @param  {boolean} [clamp=true] out of range\n     * @return {Array} point\n     */\n    dataToPoint: function (data, clamp) {\n        isArray(data) && (data = data[0]);\n        clamp == null && (clamp = true);\n\n        var dayInfo = this.getDateInfo(data);\n        var range = this._rangeInfo;\n        var date = dayInfo.formatedDate;\n\n        // if not in range return [NaN, NaN]\n        if (clamp && !(dayInfo.time >= range.start.time && dayInfo.time <= range.end.time)) {\n            return [NaN, NaN];\n        }\n\n        var week = dayInfo.day;\n        var nthWeek = this._getRangeInfo([range.start.time, date]).nthWeek;\n\n        if (this._orient === 'vertical') {\n            return [\n                this._rect.x + week * this._sw + this._sw / 2,\n                this._rect.y + nthWeek * this._sh + this._sh / 2\n            ];\n\n        }\n\n        return [\n            this._rect.x + nthWeek * this._sw + this._sw / 2,\n            this._rect.y + week * this._sh + this._sh / 2\n        ];\n\n    },\n\n    /**\n     * Convert a (x, y) point to time data\n     *\n     * @override\n     * @param  {string} point point\n     * @return {string}       data\n     */\n    pointToData: function (point) {\n\n        var date = this.pointToDate(point);\n\n        return date && date.time;\n    },\n\n    /**\n     * Convert a time date item to (x, y) four point.\n     *\n     * @param  {Array} data  date[0] is date\n     * @param  {boolean} [clamp=true]  out of range\n     * @return {Object}       point\n     */\n    dataToRect: function (data, clamp) {\n        var point = this.dataToPoint(data, clamp);\n\n        return {\n            contentShape: {\n                x: point[0] - (this._sw - this._lineWidth) / 2,\n                y: point[1] - (this._sh - this._lineWidth) / 2,\n                width: this._sw - this._lineWidth,\n                height: this._sh - this._lineWidth\n            },\n\n            center: point,\n\n            tl: [\n                point[0] - this._sw / 2,\n                point[1] - this._sh / 2\n            ],\n\n            tr: [\n                point[0] + this._sw / 2,\n                point[1] - this._sh / 2\n            ],\n\n            br: [\n                point[0] + this._sw / 2,\n                point[1] + this._sh / 2\n            ],\n\n            bl: [\n                point[0] - this._sw / 2,\n                point[1] + this._sh / 2\n            ]\n\n        };\n    },\n\n    /**\n     * Convert a (x, y) point to time date\n     *\n     * @param  {Array} point point\n     * @return {Object}       date\n     */\n    pointToDate: function (point) {\n        var nthX = Math.floor((point[0] - this._rect.x) / this._sw) + 1;\n        var nthY = Math.floor((point[1] - this._rect.y) / this._sh) + 1;\n        var range = this._rangeInfo.range;\n\n        if (this._orient === 'vertical') {\n            return this._getDateByWeeksAndDay(nthY, nthX - 1, range);\n        }\n\n        return this._getDateByWeeksAndDay(nthX, nthY - 1, range);\n    },\n\n    /**\n     * @inheritDoc\n     */\n    convertToPixel: curry(doConvert$2, 'dataToPoint'),\n\n    /**\n     * @inheritDoc\n     */\n    convertFromPixel: curry(doConvert$2, 'pointToData'),\n\n    /**\n     * initRange\n     *\n     * @private\n     * @return {Array} [start, end]\n     */\n    _initRangeOption: function () {\n        var range = this._model.get('range');\n\n        var rg = range;\n\n        if (isArray(rg) && rg.length === 1) {\n            rg = rg[0];\n        }\n\n        if (/^\\d{4}$/.test(rg)) {\n            range = [rg + '-01-01', rg + '-12-31'];\n        }\n\n        if (/^\\d{4}[\\/|-]\\d{1,2}$/.test(rg)) {\n\n            var start = this.getDateInfo(rg);\n            var firstDay = start.date;\n            firstDay.setMonth(firstDay.getMonth() + 1);\n\n            var end = this.getNextNDay(firstDay, -1);\n            range = [start.formatedDate, end.formatedDate];\n        }\n\n        if (/^\\d{4}[\\/|-]\\d{1,2}[\\/|-]\\d{1,2}$/.test(rg)) {\n            range = [rg, rg];\n        }\n\n        var tmp = this._getRangeInfo(range);\n\n        if (tmp.start.time > tmp.end.time) {\n            range.reverse();\n        }\n\n        return range;\n    },\n\n    /**\n     * range info\n     *\n     * @private\n     * @param  {Array} range range ['2017-01-01', '2017-07-08']\n     *  If range[0] > range[1], they will not be reversed.\n     * @return {Object}       obj\n     */\n    _getRangeInfo: function (range) {\n        range = [\n            this.getDateInfo(range[0]),\n            this.getDateInfo(range[1])\n        ];\n\n        var reversed;\n        if (range[0].time > range[1].time) {\n            reversed = true;\n            range.reverse();\n        }\n\n        var allDay = Math.floor(range[1].time / PROXIMATE_ONE_DAY)\n            - Math.floor(range[0].time / PROXIMATE_ONE_DAY) + 1;\n\n        // Consider case:\n        // Firstly set system timezone as \"Time Zone: America/Toronto\",\n        // ```\n        // var first = new Date(1478412000000 - 3600 * 1000 * 2.5);\n        // var second = new Date(1478412000000);\n        // var allDays = Math.floor(second / ONE_DAY) - Math.floor(first / ONE_DAY) + 1;\n        // ```\n        // will get wrong result because of DST. So we should fix it.\n        var date = new Date(range[0].time);\n        var startDateNum = date.getDate();\n        var endDateNum = range[1].date.getDate();\n        date.setDate(startDateNum + allDay - 1);\n        // The bias can not over a month, so just compare date.\n        if (date.getDate() !== endDateNum) {\n            var sign = date.getTime() - range[1].time > 0 ? 1 : -1;\n            while (date.getDate() !== endDateNum && (date.getTime() - range[1].time) * sign > 0) {\n                allDay -= sign;\n                date.setDate(startDateNum + allDay - 1);\n            }\n        }\n\n        var weeks = Math.floor((allDay + range[0].day + 6) / 7);\n        var nthWeek = reversed ? -weeks + 1: weeks - 1;\n\n        reversed && range.reverse();\n\n        return {\n            range: [range[0].formatedDate, range[1].formatedDate],\n            start: range[0],\n            end: range[1],\n            allDay: allDay,\n            weeks: weeks,\n            // From 0.\n            nthWeek: nthWeek,\n            fweek: range[0].day,\n            lweek: range[1].day\n        };\n    },\n\n    /**\n     * get date by nthWeeks and week day in range\n     *\n     * @private\n     * @param  {number} nthWeek the week\n     * @param  {number} day   the week day\n     * @param  {Array} range [d1, d2]\n     * @return {Object}\n     */\n    _getDateByWeeksAndDay: function (nthWeek, day, range) {\n        var rangeInfo = this._getRangeInfo(range);\n\n        if (nthWeek > rangeInfo.weeks\n            || (nthWeek === 0 && day < rangeInfo.fweek)\n            || (nthWeek === rangeInfo.weeks && day > rangeInfo.lweek)\n        ) {\n            return false;\n        }\n\n        var nthDay = (nthWeek - 1) * 7 - rangeInfo.fweek + day;\n        var date = new Date(rangeInfo.start.time);\n        date.setDate(rangeInfo.start.d + nthDay);\n\n        return this.getDateInfo(date);\n    }\n};\n\nCalendar.dimensions =  Calendar.prototype.dimensions;\n\nCalendar.getDimensionsInfo =  Calendar.prototype.getDimensionsInfo;\n\nCalendar.create = function (ecModel, api) {\n    var calendarList = [];\n\n    ecModel.eachComponent('calendar', function (calendarModel) {\n        var calendar = new Calendar(calendarModel, ecModel, api);\n        calendarList.push(calendar);\n        calendarModel.coordinateSystem = calendar;\n    });\n\n    ecModel.eachSeries(function (calendarSeries) {\n        if (calendarSeries.get('coordinateSystem') === 'calendar') {\n            // Inject coordinate system\n            calendarSeries.coordinateSystem = calendarList[calendarSeries.get('calendarIndex') || 0];\n        }\n    });\n    return calendarList;\n};\n\nfunction doConvert$2(methodName, ecModel, finder, value) {\n    var calendarModel = finder.calendarModel;\n    var seriesModel = finder.seriesModel;\n\n    var coordSys = calendarModel\n        ? calendarModel.coordinateSystem\n        : seriesModel\n        ? seriesModel.coordinateSystem\n        : null;\n\n    return coordSys === this ? coordSys[methodName](value) : null;\n}\n\nCoordinateSystemManager.register('calendar', Calendar);\n\nvar CalendarModel = ComponentModel.extend({\n\n    type: 'calendar',\n\n    /**\n     * @type {module:echarts/coord/calendar/Calendar}\n     */\n    coordinateSystem: null,\n\n    defaultOption: {\n        zlevel: 0,\n        z: 2,\n        left: 80,\n        top: 60,\n\n        cellSize: 20,\n\n        // horizontal vertical\n        orient: 'horizontal',\n\n        // month separate line style\n        splitLine: {\n            show: true,\n            lineStyle: {\n                color: '#000',\n                width: 1,\n                type: 'solid'\n            }\n        },\n\n        // rect style  temporarily unused emphasis\n        itemStyle: {\n            color: '#fff',\n            borderWidth: 1,\n            borderColor: '#ccc'\n        },\n\n        // week text style\n        dayLabel: {\n            show: true,\n\n            // a week first day\n            firstDay: 0,\n\n            // start end\n            position: 'start',\n            margin: '50%', // 50% of cellSize\n            nameMap: 'en',\n            color: '#000'\n        },\n\n        // month text style\n        monthLabel: {\n            show: true,\n\n            // start end\n            position: 'start',\n            margin: 5,\n\n            // center or left\n            align: 'center',\n\n            // cn en []\n            nameMap: 'en',\n            formatter: null,\n            color: '#000'\n        },\n\n        // year text style\n        yearLabel: {\n            show: true,\n\n            // top bottom left right\n            position: null,\n            margin: 30,\n            formatter: null,\n            color: '#ccc',\n            fontFamily: 'sans-serif',\n            fontWeight: 'bolder',\n            fontSize: 20\n        }\n    },\n\n    /**\n     * @override\n     */\n    init: function (option, parentModel, ecModel, extraOpt) {\n        var inputPositionParams = getLayoutParams(option);\n\n        CalendarModel.superApply(this, 'init', arguments);\n\n        mergeAndNormalizeLayoutParams$1(option, inputPositionParams);\n    },\n\n    /**\n     * @override\n     */\n    mergeOption: function (option, extraOpt) {\n        CalendarModel.superApply(this, 'mergeOption', arguments);\n\n        mergeAndNormalizeLayoutParams$1(this.option, option);\n    }\n});\n\nfunction mergeAndNormalizeLayoutParams$1(target, raw) {\n    // Normalize cellSize\n    var cellSize = target.cellSize;\n\n    if (!isArray(cellSize)) {\n        cellSize = target.cellSize = [cellSize, cellSize];\n    }\n    else if (cellSize.length === 1) {\n        cellSize[1] = cellSize[0];\n    }\n\n    var ignoreSize = map([0, 1], function (hvIdx) {\n        // If user have set `width` or both `left` and `right`, cellSize\n        // will be automatically set to 'auto', otherwise the default\n        // setting of cellSize will make `width` setting not work.\n        if (sizeCalculable(raw, hvIdx)) {\n            cellSize[hvIdx] = 'auto';\n        }\n        return cellSize[hvIdx] != null && cellSize[hvIdx] !== 'auto';\n    });\n\n    mergeLayoutParam(target, raw, {\n        type: 'box', ignoreSize: ignoreSize\n    });\n}\n\nvar MONTH_TEXT = {\n    EN: [\n        'Jan', 'Feb', 'Mar',\n        'Apr', 'May', 'Jun',\n        'Jul', 'Aug', 'Sep',\n        'Oct', 'Nov', 'Dec'\n    ],\n    CN: [\n        '', '', '',\n        '', '', '',\n        '', '', '',\n        '', '', ''\n    ]\n};\n\nvar WEEK_TEXT = {\n    EN: ['S', 'M', 'T', 'W', 'T', 'F', 'S'],\n    CN: ['', '', '', '', '', '', '']\n};\n\nextendComponentView({\n\n    type: 'calendar',\n\n    /**\n     * top/left line points\n     *  @private\n     */\n    _tlpoints: null,\n\n    /**\n     * bottom/right line points\n     *  @private\n     */\n    _blpoints: null,\n\n    /**\n     * first day of month\n     *  @private\n     */\n    _firstDayOfMonth: null,\n\n    /**\n     * first day point of month\n     *  @private\n     */\n    _firstDayPoints: null,\n\n    render: function (calendarModel, ecModel, api) {\n\n        var group = this.group;\n\n        group.removeAll();\n\n        var coordSys = calendarModel.coordinateSystem;\n\n        // range info\n        var rangeData = coordSys.getRangeInfo();\n        var orient = coordSys.getOrient();\n\n        this._renderDayRect(calendarModel, rangeData, group);\n\n        // _renderLines must be called prior to following function\n        this._renderLines(calendarModel, rangeData, orient, group);\n\n        this._renderYearText(calendarModel, rangeData, orient, group);\n\n        this._renderMonthText(calendarModel, orient, group);\n\n        this._renderWeekText(calendarModel, rangeData, orient, group);\n    },\n\n    // render day rect\n    _renderDayRect: function (calendarModel, rangeData, group) {\n        var coordSys = calendarModel.coordinateSystem;\n        var itemRectStyleModel = calendarModel.getModel('itemStyle').getItemStyle();\n        var sw = coordSys.getCellWidth();\n        var sh = coordSys.getCellHeight();\n\n        for (var i = rangeData.start.time;\n            i <= rangeData.end.time;\n            i = coordSys.getNextNDay(i, 1).time\n        ) {\n\n            var point = coordSys.dataToRect([i], false).tl;\n\n            // every rect\n            var rect = new Rect({\n                shape: {\n                    x: point[0],\n                    y: point[1],\n                    width: sw,\n                    height: sh\n                },\n                cursor: 'default',\n                style: itemRectStyleModel\n            });\n\n            group.add(rect);\n        }\n\n    },\n\n    // render separate line\n    _renderLines: function (calendarModel, rangeData, orient, group) {\n\n        var self = this;\n\n        var coordSys = calendarModel.coordinateSystem;\n\n        var lineStyleModel = calendarModel.getModel('splitLine.lineStyle').getLineStyle();\n        var show = calendarModel.get('splitLine.show');\n\n        var lineWidth = lineStyleModel.lineWidth;\n\n        this._tlpoints = [];\n        this._blpoints = [];\n        this._firstDayOfMonth = [];\n        this._firstDayPoints = [];\n\n\n        var firstDay = rangeData.start;\n\n        for (var i = 0; firstDay.time <= rangeData.end.time; i++) {\n            addPoints(firstDay.formatedDate);\n\n            if (i === 0) {\n                firstDay = coordSys.getDateInfo(rangeData.start.y + '-' + rangeData.start.m);\n            }\n\n            var date = firstDay.date;\n            date.setMonth(date.getMonth() + 1);\n            firstDay = coordSys.getDateInfo(date);\n        }\n\n        addPoints(coordSys.getNextNDay(rangeData.end.time, 1).formatedDate);\n\n        function addPoints(date) {\n\n            self._firstDayOfMonth.push(coordSys.getDateInfo(date));\n            self._firstDayPoints.push(coordSys.dataToRect([date], false).tl);\n\n            var points = self._getLinePointsOfOneWeek(calendarModel, date, orient);\n\n            self._tlpoints.push(points[0]);\n            self._blpoints.push(points[points.length - 1]);\n\n            show && self._drawSplitline(points, lineStyleModel, group);\n        }\n\n\n        // render top/left line\n        show && this._drawSplitline(self._getEdgesPoints(self._tlpoints, lineWidth, orient), lineStyleModel, group);\n\n        // render bottom/right line\n        show && this._drawSplitline(self._getEdgesPoints(self._blpoints, lineWidth, orient), lineStyleModel, group);\n\n    },\n\n    // get points at both ends\n    _getEdgesPoints: function (points, lineWidth, orient) {\n        var rs = [points[0].slice(), points[points.length - 1].slice()];\n        var idx = orient === 'horizontal' ? 0 : 1;\n\n        // both ends of the line are extend half lineWidth\n        rs[0][idx] = rs[0][idx] - lineWidth / 2;\n        rs[1][idx] = rs[1][idx] + lineWidth / 2;\n\n        return rs;\n    },\n\n    // render split line\n    _drawSplitline: function (points, lineStyleModel, group) {\n\n        var poyline = new Polyline({\n            z2: 20,\n            shape: {\n                points: points\n            },\n            style: lineStyleModel\n        });\n\n        group.add(poyline);\n    },\n\n    // render month line of one week points\n    _getLinePointsOfOneWeek: function (calendarModel, date, orient) {\n\n        var coordSys = calendarModel.coordinateSystem;\n        date = coordSys.getDateInfo(date);\n\n        var points = [];\n\n        for (var i = 0; i < 7; i++) {\n\n            var tmpD = coordSys.getNextNDay(date.time, i);\n            var point = coordSys.dataToRect([tmpD.time], false);\n\n            points[2 * tmpD.day] = point.tl;\n            points[2 * tmpD.day + 1] = point[orient === 'horizontal' ? 'bl' : 'tr'];\n        }\n\n        return points;\n\n    },\n\n    _formatterLabel: function (formatter, params) {\n\n        if (typeof formatter === 'string' && formatter) {\n            return formatTplSimple(formatter, params);\n        }\n\n        if (typeof formatter === 'function') {\n            return formatter(params);\n        }\n\n        return params.nameMap;\n\n    },\n\n    _yearTextPositionControl: function (textEl, point, orient, position, margin) {\n\n        point = point.slice();\n        var aligns = ['center', 'bottom'];\n\n        if (position === 'bottom') {\n            point[1] += margin;\n            aligns = ['center', 'top'];\n        }\n        else if (position === 'left') {\n            point[0] -= margin;\n        }\n        else if (position === 'right') {\n            point[0] += margin;\n            aligns = ['center', 'top'];\n        }\n        else { // top\n            point[1] -= margin;\n        }\n\n        var rotate = 0;\n        if (position === 'left' || position === 'right') {\n            rotate = Math.PI / 2;\n        }\n\n        return {\n            rotation: rotate,\n            position: point,\n            style: {\n                textAlign: aligns[0],\n                textVerticalAlign: aligns[1]\n            }\n        };\n    },\n\n    // render year\n    _renderYearText: function (calendarModel, rangeData, orient, group) {\n        var yearLabel = calendarModel.getModel('yearLabel');\n\n        if (!yearLabel.get('show')) {\n            return;\n        }\n\n        var margin = yearLabel.get('margin');\n        var pos = yearLabel.get('position');\n\n        if (!pos) {\n            pos = orient !== 'horizontal' ? 'top' : 'left';\n        }\n\n        var points = [this._tlpoints[this._tlpoints.length - 1], this._blpoints[0]];\n        var xc = (points[0][0] + points[1][0]) / 2;\n        var yc = (points[0][1] + points[1][1]) / 2;\n\n        var idx = orient === 'horizontal' ? 0 : 1;\n\n        var posPoints = {\n            top: [xc, points[idx][1]],\n            bottom: [xc, points[1 - idx][1]],\n            left: [points[1 - idx][0], yc],\n            right: [points[idx][0], yc]\n        };\n\n        var name = rangeData.start.y;\n\n        if (+rangeData.end.y > +rangeData.start.y) {\n            name = name + '-' + rangeData.end.y;\n        }\n\n        var formatter = yearLabel.get('formatter');\n\n        var params = {\n            start: rangeData.start.y,\n            end: rangeData.end.y,\n            nameMap: name\n        };\n\n        var content = this._formatterLabel(formatter, params);\n\n        var yearText = new Text({z2: 30});\n        setTextStyle(yearText.style, yearLabel, {text: content}),\n        yearText.attr(this._yearTextPositionControl(yearText, posPoints[pos], orient, pos, margin));\n\n        group.add(yearText);\n    },\n\n    _monthTextPositionControl: function (point, isCenter, orient, position, margin) {\n        var align = 'left';\n        var vAlign = 'top';\n        var x = point[0];\n        var y = point[1];\n\n        if (orient === 'horizontal') {\n            y = y + margin;\n\n            if (isCenter) {\n                align = 'center';\n            }\n\n            if (position === 'start') {\n                vAlign = 'bottom';\n            }\n        }\n        else {\n            x = x + margin;\n\n            if (isCenter) {\n                vAlign = 'middle';\n            }\n\n            if (position === 'start') {\n                align = 'right';\n            }\n        }\n\n        return {\n            x: x,\n            y: y,\n            textAlign: align,\n            textVerticalAlign: vAlign\n        };\n    },\n\n    // render month and year text\n    _renderMonthText: function (calendarModel, orient, group) {\n        var monthLabel = calendarModel.getModel('monthLabel');\n\n        if (!monthLabel.get('show')) {\n            return;\n        }\n\n        var nameMap = monthLabel.get('nameMap');\n        var margin = monthLabel.get('margin');\n        var pos = monthLabel.get('position');\n        var align = monthLabel.get('align');\n\n        var termPoints = [this._tlpoints, this._blpoints];\n\n        if (isString(nameMap)) {\n            nameMap = MONTH_TEXT[nameMap.toUpperCase()] || [];\n        }\n\n        var idx = pos === 'start' ? 0 : 1;\n        var axis = orient === 'horizontal' ? 0 : 1;\n        margin = pos === 'start' ? -margin : margin;\n        var isCenter = (align === 'center');\n\n        for (var i = 0; i < termPoints[idx].length - 1; i++) {\n\n            var tmp = termPoints[idx][i].slice();\n            var firstDay = this._firstDayOfMonth[i];\n\n            if (isCenter) {\n                var firstDayPoints = this._firstDayPoints[i];\n                tmp[axis] = (firstDayPoints[axis] + termPoints[0][i + 1][axis]) / 2;\n            }\n\n            var formatter = monthLabel.get('formatter');\n            var name = nameMap[+firstDay.m - 1];\n            var params = {\n                yyyy: firstDay.y,\n                yy: (firstDay.y + '').slice(2),\n                MM: firstDay.m,\n                M: +firstDay.m,\n                nameMap: name\n            };\n\n            var content = this._formatterLabel(formatter, params);\n\n            var monthText = new Text({z2: 30});\n            extend(\n                setTextStyle(monthText.style, monthLabel, {text: content}),\n                this._monthTextPositionControl(tmp, isCenter, orient, pos, margin)\n            );\n\n            group.add(monthText);\n        }\n    },\n\n    _weekTextPositionControl: function (point, orient, position, margin, cellSize) {\n        var align = 'center';\n        var vAlign = 'middle';\n        var x = point[0];\n        var y = point[1];\n        var isStart = position === 'start';\n\n        if (orient === 'horizontal') {\n            x = x + margin + (isStart ? 1 : -1) * cellSize[0] / 2;\n            align = isStart ? 'right' : 'left';\n        }\n        else {\n            y = y + margin + (isStart ? 1 : -1) * cellSize[1] / 2;\n            vAlign = isStart ? 'bottom' : 'top';\n        }\n\n        return {\n            x: x,\n            y: y,\n            textAlign: align,\n            textVerticalAlign: vAlign\n        };\n    },\n\n    // render weeks\n    _renderWeekText: function (calendarModel, rangeData, orient, group) {\n        var dayLabel = calendarModel.getModel('dayLabel');\n\n        if (!dayLabel.get('show')) {\n            return;\n        }\n\n        var coordSys = calendarModel.coordinateSystem;\n        var pos = dayLabel.get('position');\n        var nameMap = dayLabel.get('nameMap');\n        var margin = dayLabel.get('margin');\n        var firstDayOfWeek = coordSys.getFirstDayOfWeek();\n\n        if (isString(nameMap)) {\n            nameMap = WEEK_TEXT[nameMap.toUpperCase()] || [];\n        }\n\n        var start = coordSys.getNextNDay(\n            rangeData.end.time, (7 - rangeData.lweek)\n        ).time;\n\n        var cellSize = [coordSys.getCellWidth(), coordSys.getCellHeight()];\n        margin = parsePercent$1(margin, cellSize[orient === 'horizontal' ? 0 : 1]);\n\n        if (pos === 'start') {\n            start = coordSys.getNextNDay(\n                rangeData.start.time, -(7 + rangeData.fweek)\n            ).time;\n            margin = -margin;\n        }\n\n        for (var i = 0; i < 7; i++) {\n\n            var tmpD = coordSys.getNextNDay(start, i);\n            var point = coordSys.dataToRect([tmpD.time], false).center;\n            var day = i;\n            day = Math.abs((i + firstDayOfWeek) % 7);\n            var weekText = new Text({z2: 30});\n\n            extend(\n                setTextStyle(weekText.style, dayLabel, {text: nameMap[day]}),\n                this._weekTextPositionControl(point, orient, pos, margin, cellSize)\n            );\n            group.add(weekText);\n        }\n    }\n});\n\n/**\n * @file calendar.js\n * @author dxh\n */\n\n// Model\nextendComponentModel({\n\n    type: 'title',\n\n    layoutMode: {type: 'box', ignoreSize: true},\n\n    defaultOption: {\n        // \n        zlevel: 0,\n        // \n        z: 6,\n        show: true,\n\n        text: '',\n        // \n        // link: null,\n        // self | blank\n        target: 'blank',\n        subtext: '',\n\n        // \n        // sublink: null,\n        // self | blank\n        subtarget: 'blank',\n\n        // 'center'  'left'  'right'\n        //  {number}xpx\n        left: 0,\n        // 'top'  'bottom'  'center'\n        //  {number}ypx\n        top: 0,\n\n        // \n        // 'auto' | 'left' | 'right' | 'center'\n        //  left \n        // textAlign: null\n        //\n        // \n        // 'auto' | 'top' | 'bottom' | 'middle'\n        //  top \n        // textBaseline: null\n\n        backgroundColor: 'rgba(0,0,0,0)',\n\n        // \n        borderColor: '#ccc',\n\n        // px0\n        borderWidth: 0,\n\n        // px5\n        // css\n        padding: 5,\n\n        // px10\n        itemGap: 10,\n        textStyle: {\n            fontSize: 18,\n            fontWeight: 'bolder',\n            color: '#333'\n        },\n        subtextStyle: {\n            color: '#aaa'\n        }\n    }\n});\n\n// View\nextendComponentView({\n\n    type: 'title',\n\n    render: function (titleModel, ecModel, api) {\n        this.group.removeAll();\n\n        if (!titleModel.get('show')) {\n            return;\n        }\n\n        var group = this.group;\n\n        var textStyleModel = titleModel.getModel('textStyle');\n        var subtextStyleModel = titleModel.getModel('subtextStyle');\n\n        var textAlign = titleModel.get('textAlign');\n        var textBaseline = titleModel.get('textBaseline');\n\n        var textEl = new Text({\n            style: setTextStyle({}, textStyleModel, {\n                text: titleModel.get('text'),\n                textFill: textStyleModel.getTextColor()\n            }, {disableBox: true}),\n            z2: 10\n        });\n\n        var textRect = textEl.getBoundingRect();\n\n        var subText = titleModel.get('subtext');\n        var subTextEl = new Text({\n            style: setTextStyle({}, subtextStyleModel, {\n                text: subText,\n                textFill: subtextStyleModel.getTextColor(),\n                y: textRect.height + titleModel.get('itemGap'),\n                textVerticalAlign: 'top'\n            }, {disableBox: true}),\n            z2: 10\n        });\n\n        var link = titleModel.get('link');\n        var sublink = titleModel.get('sublink');\n\n        textEl.silent = !link;\n        subTextEl.silent = !sublink;\n\n        if (link) {\n            textEl.on('click', function () {\n                window.open(link, '_' + titleModel.get('target'));\n            });\n        }\n        if (sublink) {\n            subTextEl.on('click', function () {\n                window.open(sublink, '_' + titleModel.get('subtarget'));\n            });\n        }\n\n        group.add(textEl);\n        subText && group.add(subTextEl);\n        // If no subText, but add subTextEl, there will be an empty line.\n\n        var groupRect = group.getBoundingRect();\n        var layoutOption = titleModel.getBoxLayoutParams();\n        layoutOption.width = groupRect.width;\n        layoutOption.height = groupRect.height;\n        var layoutRect = getLayoutRect(\n            layoutOption, {\n                width: api.getWidth(),\n                height: api.getHeight()\n            }, titleModel.get('padding')\n        );\n        // Adjust text align based on position\n        if (!textAlign) {\n            // Align left if title is on the left. center and right is same\n            textAlign = titleModel.get('left') || titleModel.get('right');\n            if (textAlign === 'middle') {\n                textAlign = 'center';\n            }\n            // Adjust layout by text align\n            if (textAlign === 'right') {\n                layoutRect.x += layoutRect.width;\n            }\n            else if (textAlign === 'center') {\n                layoutRect.x += layoutRect.width / 2;\n            }\n        }\n        if (!textBaseline) {\n            textBaseline = titleModel.get('top') || titleModel.get('bottom');\n            if (textBaseline === 'center') {\n                textBaseline = 'middle';\n            }\n            if (textBaseline === 'bottom') {\n                layoutRect.y += layoutRect.height;\n            }\n            else if (textBaseline === 'middle') {\n                layoutRect.y += layoutRect.height / 2;\n            }\n\n            textBaseline = textBaseline || 'top';\n        }\n\n        group.attr('position', [layoutRect.x, layoutRect.y]);\n        var alignStyle = {\n            textAlign: textAlign,\n            textVerticalAlign: textBaseline\n        };\n        textEl.setStyle(alignStyle);\n        subTextEl.setStyle(alignStyle);\n\n        // Render background\n        // Get groupRect again because textAlign has been changed\n        groupRect = group.getBoundingRect();\n        var padding = layoutRect.margin;\n        var style = titleModel.getItemStyle(['color', 'opacity']);\n        style.fill = titleModel.get('backgroundColor');\n        var rect = new Rect({\n            shape: {\n                x: groupRect.x - padding[3],\n                y: groupRect.y - padding[0],\n                width: groupRect.width + padding[1] + padding[3],\n                height: groupRect.height + padding[0] + padding[2],\n                r: titleModel.get('borderRadius')\n            },\n            style: style,\n            silent: true\n        });\n        subPixelOptimizeRect(rect);\n\n        group.add(rect);\n    }\n});\n\nComponentModel.registerSubTypeDefaulter('dataZoom', function () {\n    // Default 'slider' when no type specified.\n    return 'slider';\n});\n\nvar AXIS_DIMS = ['x', 'y', 'z', 'radius', 'angle', 'single'];\n// Supported coords.\nvar COORDS = ['cartesian2d', 'polar', 'singleAxis'];\n\n/**\n * @param {string} coordType\n * @return {boolean}\n */\nfunction isCoordSupported(coordType) {\n    return indexOf(COORDS, coordType) >= 0;\n}\n\n/**\n * Create \"each\" method to iterate names.\n *\n * @pubilc\n * @param  {Array.<string>} names\n * @param  {Array.<string>=} attrs\n * @return {Function}\n */\nfunction createNameEach(names, attrs) {\n    names = names.slice();\n    var capitalNames = map(names, capitalFirst);\n    attrs = (attrs || []).slice();\n    var capitalAttrs = map(attrs, capitalFirst);\n\n    return function (callback, context) {\n        each$1(names, function (name, index) {\n            var nameObj = {name: name, capital: capitalNames[index]};\n\n            for (var j = 0; j < attrs.length; j++) {\n                nameObj[attrs[j]] = name + capitalAttrs[j];\n            }\n\n            callback.call(context, nameObj);\n        });\n    };\n}\n\n/**\n * Iterate each dimension name.\n *\n * @public\n * @param {Function} callback The parameter is like:\n *                            {\n *                                name: 'angle',\n *                                capital: 'Angle',\n *                                axis: 'angleAxis',\n *                                axisIndex: 'angleAixs',\n *                                index: 'angleIndex'\n *                            }\n * @param {Object} context\n */\nvar eachAxisDim$1 = createNameEach(AXIS_DIMS, ['axisIndex', 'axis', 'index', 'id']);\n\n/**\n * If tow dataZoomModels has the same axis controlled, we say that they are 'linked'.\n * dataZoomModels and 'links' make up one or more graphics.\n * This function finds the graphic where the source dataZoomModel is in.\n *\n * @public\n * @param {Function} forEachNode Node iterator.\n * @param {Function} forEachEdgeType edgeType iterator\n * @param {Function} edgeIdGetter Giving node and edgeType, return an array of edge id.\n * @return {Function} Input: sourceNode, Output: Like {nodes: [], dims: {}}\n */\nfunction createLinkedNodesFinder(forEachNode, forEachEdgeType, edgeIdGetter) {\n\n    return function (sourceNode) {\n        var result = {\n            nodes: [],\n            records: {} // key: edgeType.name, value: Object (key: edge id, value: boolean).\n        };\n\n        forEachEdgeType(function (edgeType) {\n            result.records[edgeType.name] = {};\n        });\n\n        if (!sourceNode) {\n            return result;\n        }\n\n        absorb(sourceNode, result);\n\n        var existsLink;\n        do {\n            existsLink = false;\n            forEachNode(processSingleNode);\n        }\n        while (existsLink);\n\n        function processSingleNode(node) {\n            if (!isNodeAbsorded(node, result) && isLinked(node, result)) {\n                absorb(node, result);\n                existsLink = true;\n            }\n        }\n\n        return result;\n    };\n\n    function isNodeAbsorded(node, result) {\n        return indexOf(result.nodes, node) >= 0;\n    }\n\n    function isLinked(node, result) {\n        var hasLink = false;\n        forEachEdgeType(function (edgeType) {\n            each$1(edgeIdGetter(node, edgeType) || [], function (edgeId) {\n                result.records[edgeType.name][edgeId] && (hasLink = true);\n            });\n        });\n        return hasLink;\n    }\n\n    function absorb(node, result) {\n        result.nodes.push(node);\n        forEachEdgeType(function (edgeType) {\n            each$1(edgeIdGetter(node, edgeType) || [], function (edgeId) {\n                result.records[edgeType.name][edgeId] = true;\n            });\n        });\n    }\n}\n\nvar each$23 = each$1;\nvar asc$1 = asc;\n\n/**\n * Operate single axis.\n * One axis can only operated by one axis operator.\n * Different dataZoomModels may be defined to operate the same axis.\n * (i.e. 'inside' data zoom and 'slider' data zoom components)\n * So dataZoomModels share one axisProxy in that case.\n *\n * @class\n */\nvar AxisProxy = function (dimName, axisIndex, dataZoomModel, ecModel) {\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this._dimName = dimName;\n\n    /**\n     * @private\n     */\n    this._axisIndex = axisIndex;\n\n    /**\n     * @private\n     * @type {Array.<number>}\n     */\n    this._valueWindow;\n\n    /**\n     * @private\n     * @type {Array.<number>}\n     */\n    this._percentWindow;\n\n    /**\n     * @private\n     * @type {Array.<number>}\n     */\n    this._dataExtent;\n\n    /**\n     * {minSpan, maxSpan, minValueSpan, maxValueSpan}\n     * @private\n     * @type {Object}\n     */\n    this._minMaxSpan;\n\n    /**\n     * @readOnly\n     * @type {module: echarts/model/Global}\n     */\n    this.ecModel = ecModel;\n\n    /**\n     * @private\n     * @type {module: echarts/component/dataZoom/DataZoomModel}\n     */\n    this._dataZoomModel = dataZoomModel;\n\n    // /**\n    //  * @readOnly\n    //  * @private\n    //  */\n    // this.hasSeriesStacked;\n};\n\nAxisProxy.prototype = {\n\n    constructor: AxisProxy,\n\n    /**\n     * Whether the axisProxy is hosted by dataZoomModel.\n     *\n     * @public\n     * @param {module: echarts/component/dataZoom/DataZoomModel} dataZoomModel\n     * @return {boolean}\n     */\n    hostedBy: function (dataZoomModel) {\n        return this._dataZoomModel === dataZoomModel;\n    },\n\n    /**\n     * @return {Array.<number>} Value can only be NaN or finite value.\n     */\n    getDataValueWindow: function () {\n        return this._valueWindow.slice();\n    },\n\n    /**\n     * @return {Array.<number>}\n     */\n    getDataPercentWindow: function () {\n        return this._percentWindow.slice();\n    },\n\n    /**\n     * @public\n     * @param {number} axisIndex\n     * @return {Array} seriesModels\n     */\n    getTargetSeriesModels: function () {\n        var seriesModels = [];\n        var ecModel = this.ecModel;\n\n        ecModel.eachSeries(function (seriesModel) {\n            if (isCoordSupported(seriesModel.get('coordinateSystem'))) {\n                var dimName = this._dimName;\n                var axisModel = ecModel.queryComponents({\n                    mainType: dimName + 'Axis',\n                    index: seriesModel.get(dimName + 'AxisIndex'),\n                    id: seriesModel.get(dimName + 'AxisId')\n                })[0];\n                if (this._axisIndex === (axisModel && axisModel.componentIndex)) {\n                    seriesModels.push(seriesModel);\n                }\n            }\n        }, this);\n\n        return seriesModels;\n    },\n\n    getAxisModel: function () {\n        return this.ecModel.getComponent(this._dimName + 'Axis', this._axisIndex);\n    },\n\n    getOtherAxisModel: function () {\n        var axisDim = this._dimName;\n        var ecModel = this.ecModel;\n        var axisModel = this.getAxisModel();\n        var isCartesian = axisDim === 'x' || axisDim === 'y';\n        var otherAxisDim;\n        var coordSysIndexName;\n        if (isCartesian) {\n            coordSysIndexName = 'gridIndex';\n            otherAxisDim = axisDim === 'x' ? 'y' : 'x';\n        }\n        else {\n            coordSysIndexName = 'polarIndex';\n            otherAxisDim = axisDim === 'angle' ? 'radius' : 'angle';\n        }\n        var foundOtherAxisModel;\n        ecModel.eachComponent(otherAxisDim + 'Axis', function (otherAxisModel) {\n            if ((otherAxisModel.get(coordSysIndexName) || 0)\n                === (axisModel.get(coordSysIndexName) || 0)\n            ) {\n                foundOtherAxisModel = otherAxisModel;\n            }\n        });\n        return foundOtherAxisModel;\n    },\n\n    getMinMaxSpan: function () {\n        return clone(this._minMaxSpan);\n    },\n\n    /**\n     * Only calculate by given range and this._dataExtent, do not change anything.\n     *\n     * @param {Object} opt\n     * @param {number} [opt.start]\n     * @param {number} [opt.end]\n     * @param {number} [opt.startValue]\n     * @param {number} [opt.endValue]\n     */\n    calculateDataWindow: function (opt) {\n        var dataExtent = this._dataExtent;\n        var axisModel = this.getAxisModel();\n        var scale = axisModel.axis.scale;\n        var rangePropMode = this._dataZoomModel.getRangePropMode();\n        var percentExtent = [0, 100];\n        var percentWindow = [\n            opt.start,\n            opt.end\n        ];\n        var valueWindow = [];\n\n        each$23(['startValue', 'endValue'], function (prop) {\n            valueWindow.push(opt[prop] != null ? scale.parse(opt[prop]) : null);\n        });\n\n        // Normalize bound.\n        each$23([0, 1], function (idx) {\n            var boundValue = valueWindow[idx];\n            var boundPercent = percentWindow[idx];\n\n            // Notice: dataZoom is based either on `percentProp` ('start', 'end') or\n            // on `valueProp` ('startValue', 'endValue'). The former one is suitable\n            // for cases that a dataZoom component controls multiple axes with different\n            // unit or extent, and the latter one is suitable for accurate zoom by pixel\n            // (e.g., in dataZoomSelect). `valueProp` can be calculated from `percentProp`,\n            // but it is awkward that `percentProp` can not be obtained from `valueProp`\n            // accurately (because all of values that are overflow the `dataExtent` will\n            // be calculated to percent '100%'). So we have to use\n            // `dataZoom.getRangePropMode()` to mark which prop is used.\n            // `rangePropMode` is updated only when setOption or dispatchAction, otherwise\n            // it remains its original value.\n\n            if (rangePropMode[idx] === 'percent') {\n                if (boundPercent == null) {\n                    boundPercent = percentExtent[idx];\n                }\n                // Use scale.parse to math round for category or time axis.\n                boundValue = scale.parse(linearMap(\n                    boundPercent, percentExtent, dataExtent, true\n                ));\n            }\n            else {\n                // Calculating `percent` from `value` may be not accurate, because\n                // This calculation can not be inversed, because all of values that\n                // are overflow the `dataExtent` will be calculated to percent '100%'\n                boundPercent = linearMap(\n                    boundValue, dataExtent, percentExtent, true\n                );\n            }\n\n            // valueWindow[idx] = round(boundValue);\n            // percentWindow[idx] = round(boundPercent);\n            valueWindow[idx] = boundValue;\n            percentWindow[idx] = boundPercent;\n        });\n\n        return {\n            valueWindow: asc$1(valueWindow),\n            percentWindow: asc$1(percentWindow)\n        };\n    },\n\n    /**\n     * Notice: reset should not be called before series.restoreData() called,\n     * so it is recommanded to be called in \"process stage\" but not \"model init\n     * stage\".\n     *\n     * @param {module: echarts/component/dataZoom/DataZoomModel} dataZoomModel\n     */\n    reset: function (dataZoomModel) {\n        if (dataZoomModel !== this._dataZoomModel) {\n            return;\n        }\n\n        var targetSeries = this.getTargetSeriesModels();\n        // Culculate data window and data extent, and record them.\n        this._dataExtent = calculateDataExtent(this, this._dimName, targetSeries);\n\n        // this.hasSeriesStacked = false;\n        // each(targetSeries, function (series) {\n            // var data = series.getData();\n            // var dataDim = data.mapDimension(this._dimName);\n            // var stackedDimension = data.getCalculationInfo('stackedDimension');\n            // if (stackedDimension && stackedDimension === dataDim) {\n                // this.hasSeriesStacked = true;\n            // }\n        // }, this);\n\n        var dataWindow = this.calculateDataWindow(dataZoomModel.option);\n\n        this._valueWindow = dataWindow.valueWindow;\n        this._percentWindow = dataWindow.percentWindow;\n\n        setMinMaxSpan(this);\n\n        // Update axis setting then.\n        setAxisModel(this);\n    },\n\n    /**\n     * @param {module: echarts/component/dataZoom/DataZoomModel} dataZoomModel\n     */\n    restore: function (dataZoomModel) {\n        if (dataZoomModel !== this._dataZoomModel) {\n            return;\n        }\n\n        this._valueWindow = this._percentWindow = null;\n        setAxisModel(this, true);\n    },\n\n    /**\n     * @param {module: echarts/component/dataZoom/DataZoomModel} dataZoomModel\n     */\n    filterData: function (dataZoomModel, api) {\n        if (dataZoomModel !== this._dataZoomModel) {\n            return;\n        }\n\n        var axisDim = this._dimName;\n        var seriesModels = this.getTargetSeriesModels();\n        var filterMode = dataZoomModel.get('filterMode');\n        var valueWindow = this._valueWindow;\n\n        if (filterMode === 'none') {\n            return;\n        }\n\n        // FIXME\n        // Toolbox may has dataZoom injected. And if there are stacked bar chart\n        // with NaN data, NaN will be filtered and stack will be wrong.\n        // So we need to force the mode to be set empty.\n        // In fect, it is not a big deal that do not support filterMode-'filter'\n        // when using toolbox#dataZoom, utill tooltip#dataZoom support \"single axis\n        // selection\" some day, which might need \"adapt to data extent on the\n        // otherAxis\", which is disabled by filterMode-'empty'.\n        // But currently, stack has been fixed to based on value but not index,\n        // so this is not an issue any more.\n        // var otherAxisModel = this.getOtherAxisModel();\n        // if (dataZoomModel.get('$fromToolbox')\n        //     && otherAxisModel\n        //     && otherAxisModel.hasSeriesStacked\n        // ) {\n        //     filterMode = 'empty';\n        // }\n\n        // TODO\n        // filterMode 'weakFilter' and 'empty' is not optimized for huge data yet.\n\n        // Process series data\n        each$23(seriesModels, function (seriesModel) {\n            var seriesData = seriesModel.getData();\n            var dataDims = seriesData.mapDimension(axisDim, true);\n\n            if (filterMode === 'weakFilter') {\n                seriesData.filterSelf(function (dataIndex) {\n                    var leftOut;\n                    var rightOut;\n                    var hasValue;\n                    for (var i = 0; i < dataDims.length; i++) {\n                        var value = seriesData.get(dataDims[i], dataIndex);\n                        var thisHasValue = !isNaN(value);\n                        var thisLeftOut = value < valueWindow[0];\n                        var thisRightOut = value > valueWindow[1];\n                        if (thisHasValue && !thisLeftOut && !thisRightOut) {\n                            return true;\n                        }\n                        thisHasValue && (hasValue = true);\n                        thisLeftOut && (leftOut = true);\n                        thisRightOut && (rightOut = true);\n                    }\n                    // If both left out and right out, do not filter.\n                    return hasValue && leftOut && rightOut;\n                });\n            }\n            else {\n                each$23(dataDims, function (dim) {\n                    if (filterMode === 'empty') {\n                        seriesModel.setData(\n                            seriesData.map(dim, function (value) {\n                                return !isInWindow(value) ? NaN : value;\n                            })\n                        );\n                    }\n                    else {\n                        var range = {};\n                        range[dim] = valueWindow;\n\n                        // console.time('select');\n                        seriesData.selectRange(range);\n                        // console.timeEnd('select');\n                    }\n                });\n            }\n\n            each$23(dataDims, function (dim) {\n                seriesData.setApproximateExtent(valueWindow, dim);\n            });\n        });\n\n        function isInWindow(value) {\n            return value >= valueWindow[0] && value <= valueWindow[1];\n        }\n    }\n};\n\nfunction calculateDataExtent(axisProxy, axisDim, seriesModels) {\n    var dataExtent = [Infinity, -Infinity];\n\n    each$23(seriesModels, function (seriesModel) {\n        var seriesData = seriesModel.getData();\n        if (seriesData) {\n            each$23(seriesData.mapDimension(axisDim, true), function (dim) {\n                var seriesExtent = seriesData.getApproximateExtent(dim);\n                seriesExtent[0] < dataExtent[0] && (dataExtent[0] = seriesExtent[0]);\n                seriesExtent[1] > dataExtent[1] && (dataExtent[1] = seriesExtent[1]);\n            });\n        }\n    });\n\n    if (dataExtent[1] < dataExtent[0]) {\n        dataExtent = [NaN, NaN];\n    }\n\n    // It is important to get \"consistent\" extent when more then one axes is\n    // controlled by a `dataZoom`, otherwise those axes will not be synchronized\n    // when zooming. But it is difficult to know what is \"consistent\", considering\n    // axes have different type or even different meanings (For example, two\n    // time axes are used to compare data of the same date in different years).\n    // So basically dataZoom just obtains extent by series.data (in category axis\n    // extent can be obtained from axis.data).\n    // Nevertheless, user can set min/max/scale on axes to make extent of axes\n    // consistent.\n    fixExtentByAxis(axisProxy, dataExtent);\n\n    return dataExtent;\n}\n\nfunction fixExtentByAxis(axisProxy, dataExtent) {\n    var axisModel = axisProxy.getAxisModel();\n    var min = axisModel.getMin(true);\n\n    // For category axis, if min/max/scale are not set, extent is determined\n    // by axis.data by default.\n    var isCategoryAxis = axisModel.get('type') === 'category';\n    var axisDataLen = isCategoryAxis && axisModel.getCategories().length;\n\n    if (min != null && min !== 'dataMin' && typeof min !== 'function') {\n        dataExtent[0] = min;\n    }\n    else if (isCategoryAxis) {\n        dataExtent[0] = axisDataLen > 0 ? 0 : NaN;\n    }\n\n    var max = axisModel.getMax(true);\n    if (max != null && max !== 'dataMax' && typeof max !== 'function') {\n        dataExtent[1] = max;\n    }\n    else if (isCategoryAxis) {\n        dataExtent[1] = axisDataLen > 0 ? axisDataLen - 1 : NaN;\n    }\n\n    if (!axisModel.get('scale', true)) {\n        dataExtent[0] > 0 && (dataExtent[0] = 0);\n        dataExtent[1] < 0 && (dataExtent[1] = 0);\n    }\n\n    // For value axis, if min/max/scale are not set, we just use the extent obtained\n    // by series data, which may be a little different from the extent calculated by\n    // `axisHelper.getScaleExtent`. But the different just affects the experience a\n    // little when zooming. So it will not be fixed until some users require it strongly.\n\n    return dataExtent;\n}\n\nfunction setAxisModel(axisProxy, isRestore) {\n    var axisModel = axisProxy.getAxisModel();\n\n    var percentWindow = axisProxy._percentWindow;\n    var valueWindow = axisProxy._valueWindow;\n\n    if (!percentWindow) {\n        return;\n    }\n\n    // [0, 500]: arbitrary value, guess axis extent.\n    var precision = getPixelPrecision(valueWindow, [0, 500]);\n    precision = Math.min(precision, 20);\n    // isRestore or isFull\n    var useOrigin = isRestore || (percentWindow[0] === 0 && percentWindow[1] === 100);\n\n    axisModel.setRange(\n        useOrigin ? null : +valueWindow[0].toFixed(precision),\n        useOrigin ? null : +valueWindow[1].toFixed(precision)\n    );\n}\n\nfunction setMinMaxSpan(axisProxy) {\n    var minMaxSpan = axisProxy._minMaxSpan = {};\n    var dataZoomModel = axisProxy._dataZoomModel;\n\n    each$23(['min', 'max'], function (minMax) {\n        minMaxSpan[minMax + 'Span'] = dataZoomModel.get(minMax + 'Span');\n\n        // minValueSpan and maxValueSpan has higher priority than minSpan and maxSpan\n        var valueSpan = dataZoomModel.get(minMax + 'ValueSpan');\n\n        if (valueSpan != null) {\n            minMaxSpan[minMax + 'ValueSpan'] = valueSpan;\n            valueSpan = axisProxy.getAxisModel().axis.scale.parse(valueSpan);\n\n            if (valueSpan != null) {\n                var dataExtent = axisProxy._dataExtent;\n                minMaxSpan[minMax + 'Span'] = linearMap(\n                    dataExtent[0] + valueSpan, dataExtent, [0, 100], true\n                );\n            }\n        }\n    });\n}\n\nvar each$22 = each$1;\nvar eachAxisDim = eachAxisDim$1;\n\nvar DataZoomModel = extendComponentModel({\n\n    type: 'dataZoom',\n\n    dependencies: [\n        'xAxis', 'yAxis', 'zAxis', 'radiusAxis', 'angleAxis', 'singleAxis', 'series'\n    ],\n\n    /**\n     * @protected\n     */\n    defaultOption: {\n        zlevel: 0,\n        z: 4,                   // Higher than normal component (z: 2).\n        orient: null,           // Default auto by axisIndex. Possible value: 'horizontal', 'vertical'.\n        xAxisIndex: null,       // Default the first horizontal category axis.\n        yAxisIndex: null,       // Default the first vertical category axis.\n\n        filterMode: 'filter',   // Possible values: 'filter' or 'empty' or 'weakFilter'.\n                                // 'filter': data items which are out of window will be removed. This option is\n                                //          applicable when filtering outliers. For each data item, it will be\n                                //          filtered if one of the relevant dimensions is out of the window.\n                                // 'weakFilter': data items which are out of window will be removed. This option\n                                //          is applicable when filtering outliers. For each data item, it will be\n                                //          filtered only if all  of the relevant dimensions are out of the same\n                                //          side of the window.\n                                // 'empty': data items which are out of window will be set to empty.\n                                //          This option is applicable when user should not neglect\n                                //          that there are some data items out of window.\n                                // 'none': Do not filter.\n                                // Taking line chart as an example, line will be broken in\n                                // the filtered points when filterModel is set to 'empty', but\n                                // be connected when set to 'filter'.\n\n        throttle: null,         // Dispatch action by the fixed rate, avoid frequency.\n                                // default 100. Do not throttle when use null/undefined.\n                                // If animation === true and animationDurationUpdate > 0,\n                                // default value is 100, otherwise 20.\n        start: 0,               // Start percent. 0 ~ 100\n        end: 100,               // End percent. 0 ~ 100\n        startValue: null,       // Start value. If startValue specified, start is ignored.\n        endValue: null,         // End value. If endValue specified, end is ignored.\n        minSpan: null,          // 0 ~ 100\n        maxSpan: null,          // 0 ~ 100\n        minValueSpan: null,     // The range of dataZoom can not be smaller than that.\n        maxValueSpan: null,     // The range of dataZoom can not be larger than that.\n        rangeMode: null         // Array, can be 'value' or 'percent'.\n    },\n\n    /**\n     * @override\n     */\n    init: function (option, parentModel, ecModel) {\n\n        /**\n         * key like x_0, y_1\n         * @private\n         * @type {Object}\n         */\n        this._dataIntervalByAxis = {};\n\n        /**\n         * @private\n         */\n        this._dataInfo = {};\n\n        /**\n         * key like x_0, y_1\n         * @private\n         */\n        this._axisProxies = {};\n\n        /**\n         * @readOnly\n         */\n        this.textStyleModel;\n\n        /**\n         * @private\n         */\n        this._autoThrottle = true;\n\n        /**\n         * 'percent' or 'value'\n         * @private\n         */\n        this._rangePropMode = ['percent', 'percent'];\n\n        var rawOption = retrieveRaw(option);\n\n        this.mergeDefaultAndTheme(option, ecModel);\n\n        this.doInit(rawOption);\n    },\n\n    /**\n     * @override\n     */\n    mergeOption: function (newOption) {\n        var rawOption = retrieveRaw(newOption);\n\n        //FIX #2591\n        merge(this.option, newOption, true);\n\n        this.doInit(rawOption);\n    },\n\n    /**\n     * @protected\n     */\n    doInit: function (rawOption) {\n        var thisOption = this.option;\n\n        // Disable realtime view update if canvas is not supported.\n        if (!env$1.canvasSupported) {\n            thisOption.realtime = false;\n        }\n\n        this._setDefaultThrottle(rawOption);\n\n        updateRangeUse(this, rawOption);\n\n        each$22([['start', 'startValue'], ['end', 'endValue']], function (names, index) {\n            // start/end has higher priority over startValue/endValue if they\n            // both set, but we should make chart.setOption({endValue: 1000})\n            // effective, rather than chart.setOption({endValue: 1000, end: null}).\n            if (this._rangePropMode[index] === 'value') {\n                thisOption[names[0]] = null;\n            }\n            // Otherwise do nothing and use the merge result.\n        }, this);\n\n        this.textStyleModel = this.getModel('textStyle');\n\n        this._resetTarget();\n\n        this._giveAxisProxies();\n    },\n\n    /**\n     * @private\n     */\n    _giveAxisProxies: function () {\n        var axisProxies = this._axisProxies;\n\n        this.eachTargetAxis(function (dimNames, axisIndex, dataZoomModel, ecModel) {\n            var axisModel = this.dependentModels[dimNames.axis][axisIndex];\n\n            // If exists, share axisProxy with other dataZoomModels.\n            var axisProxy = axisModel.__dzAxisProxy || (\n                // Use the first dataZoomModel as the main model of axisProxy.\n                axisModel.__dzAxisProxy = new AxisProxy(\n                    dimNames.name, axisIndex, this, ecModel\n                )\n            );\n            // FIXME\n            // dispose __dzAxisProxy\n\n            axisProxies[dimNames.name + '_' + axisIndex] = axisProxy;\n        }, this);\n    },\n\n    /**\n     * @private\n     */\n    _resetTarget: function () {\n        var thisOption = this.option;\n\n        var autoMode = this._judgeAutoMode();\n\n        eachAxisDim(function (dimNames) {\n            var axisIndexName = dimNames.axisIndex;\n            thisOption[axisIndexName] = normalizeToArray(\n                thisOption[axisIndexName]\n            );\n        }, this);\n\n        if (autoMode === 'axisIndex') {\n            this._autoSetAxisIndex();\n        }\n        else if (autoMode === 'orient') {\n            this._autoSetOrient();\n        }\n    },\n\n    /**\n     * @private\n     */\n    _judgeAutoMode: function () {\n        // Auto set only works for setOption at the first time.\n        // The following is user's reponsibility. So using merged\n        // option is OK.\n        var thisOption = this.option;\n\n        var hasIndexSpecified = false;\n        eachAxisDim(function (dimNames) {\n            // When user set axisIndex as a empty array, we think that user specify axisIndex\n            // but do not want use auto mode. Because empty array may be encountered when\n            // some error occured.\n            if (thisOption[dimNames.axisIndex] != null) {\n                hasIndexSpecified = true;\n            }\n        }, this);\n\n        var orient = thisOption.orient;\n\n        if (orient == null && hasIndexSpecified) {\n            return 'orient';\n        }\n        else if (!hasIndexSpecified) {\n            if (orient == null) {\n                thisOption.orient = 'horizontal';\n            }\n            return 'axisIndex';\n        }\n    },\n\n    /**\n     * @private\n     */\n    _autoSetAxisIndex: function () {\n        var autoAxisIndex = true;\n        var orient = this.get('orient', true);\n        var thisOption = this.option;\n        var dependentModels = this.dependentModels;\n\n        if (autoAxisIndex) {\n            // Find axis that parallel to dataZoom as default.\n            var dimName = orient === 'vertical' ? 'y' : 'x';\n\n            if (dependentModels[dimName + 'Axis'].length) {\n                thisOption[dimName + 'AxisIndex'] = [0];\n                autoAxisIndex = false;\n            }\n            else {\n                each$22(dependentModels.singleAxis, function (singleAxisModel) {\n                    if (autoAxisIndex && singleAxisModel.get('orient', true) === orient) {\n                        thisOption.singleAxisIndex = [singleAxisModel.componentIndex];\n                        autoAxisIndex = false;\n                    }\n                });\n            }\n        }\n\n        if (autoAxisIndex) {\n            // Find the first category axis as default. (consider polar)\n            eachAxisDim(function (dimNames) {\n                if (!autoAxisIndex) {\n                    return;\n                }\n                var axisIndices = [];\n                var axisModels = this.dependentModels[dimNames.axis];\n                if (axisModels.length && !axisIndices.length) {\n                    for (var i = 0, len = axisModels.length; i < len; i++) {\n                        if (axisModels[i].get('type') === 'category') {\n                            axisIndices.push(i);\n                        }\n                    }\n                }\n                thisOption[dimNames.axisIndex] = axisIndices;\n                if (axisIndices.length) {\n                    autoAxisIndex = false;\n                }\n            }, this);\n        }\n\n        if (autoAxisIndex) {\n            // FIXME\n            // ec2xAxisIndexyAxisIndexscatterdataZoom\n            // Grid.js#getScaleByOptiontimelogaxis type\n\n            // If both dataZoom.xAxisIndex and dataZoom.yAxisIndex is not specified,\n            // dataZoom component auto adopts series that reference to\n            // both xAxis and yAxis which type is 'value'.\n            this.ecModel.eachSeries(function (seriesModel) {\n                if (this._isSeriesHasAllAxesTypeOf(seriesModel, 'value')) {\n                    eachAxisDim(function (dimNames) {\n                        var axisIndices = thisOption[dimNames.axisIndex];\n\n                        var axisIndex = seriesModel.get(dimNames.axisIndex);\n                        var axisId = seriesModel.get(dimNames.axisId);\n\n                        var axisModel = seriesModel.ecModel.queryComponents({\n                            mainType: dimNames.axis,\n                            index: axisIndex,\n                            id: axisId\n                        })[0];\n\n                        if (__DEV__) {\n                            if (!axisModel) {\n                                throw new Error(\n                                    dimNames.axis + ' \"' + retrieve(\n                                        axisIndex,\n                                        axisId,\n                                        0\n                                    ) + '\" not found'\n                                );\n                            }\n                        }\n                        axisIndex = axisModel.componentIndex;\n\n                        if (indexOf(axisIndices, axisIndex) < 0) {\n                            axisIndices.push(axisIndex);\n                        }\n                    });\n                }\n            }, this);\n        }\n    },\n\n    /**\n     * @private\n     */\n    _autoSetOrient: function () {\n        var dim;\n\n        // Find the first axis\n        this.eachTargetAxis(function (dimNames) {\n            !dim && (dim = dimNames.name);\n        }, this);\n\n        this.option.orient = dim === 'y' ? 'vertical' : 'horizontal';\n    },\n\n    /**\n     * @private\n     */\n    _isSeriesHasAllAxesTypeOf: function (seriesModel, axisType) {\n        // FIXME\n        // seriesxAxisIndexyAxisIndex\n        // series.type === scatter\n\n        var is = true;\n        eachAxisDim(function (dimNames) {\n            var seriesAxisIndex = seriesModel.get(dimNames.axisIndex);\n            var axisModel = this.dependentModels[dimNames.axis][seriesAxisIndex];\n\n            if (!axisModel || axisModel.get('type') !== axisType) {\n                is = false;\n            }\n        }, this);\n        return is;\n    },\n\n    /**\n     * @private\n     */\n    _setDefaultThrottle: function (rawOption) {\n        // When first time user set throttle, auto throttle ends.\n        if (rawOption.hasOwnProperty('throttle')) {\n            this._autoThrottle = false;\n        }\n        if (this._autoThrottle) {\n            var globalOption = this.ecModel.option;\n            this.option.throttle =\n                (globalOption.animation && globalOption.animationDurationUpdate > 0)\n                ? 100 : 20;\n        }\n    },\n\n    /**\n     * @public\n     */\n    getFirstTargetAxisModel: function () {\n        var firstAxisModel;\n        eachAxisDim(function (dimNames) {\n            if (firstAxisModel == null) {\n                var indices = this.get(dimNames.axisIndex);\n                if (indices.length) {\n                    firstAxisModel = this.dependentModels[dimNames.axis][indices[0]];\n                }\n            }\n        }, this);\n\n        return firstAxisModel;\n    },\n\n    /**\n     * @public\n     * @param {Function} callback param: axisModel, dimNames, axisIndex, dataZoomModel, ecModel\n     */\n    eachTargetAxis: function (callback, context) {\n        var ecModel = this.ecModel;\n        eachAxisDim(function (dimNames) {\n            each$22(\n                this.get(dimNames.axisIndex),\n                function (axisIndex) {\n                    callback.call(context, dimNames, axisIndex, this, ecModel);\n                },\n                this\n            );\n        }, this);\n    },\n\n    /**\n     * @param {string} dimName\n     * @param {number} axisIndex\n     * @return {module:echarts/component/dataZoom/AxisProxy} If not found, return null/undefined.\n     */\n    getAxisProxy: function (dimName, axisIndex) {\n        return this._axisProxies[dimName + '_' + axisIndex];\n    },\n\n    /**\n     * @param {string} dimName\n     * @param {number} axisIndex\n     * @return {module:echarts/model/Model} If not found, return null/undefined.\n     */\n    getAxisModel: function (dimName, axisIndex) {\n        var axisProxy = this.getAxisProxy(dimName, axisIndex);\n        return axisProxy && axisProxy.getAxisModel();\n    },\n\n    /**\n     * If not specified, set to undefined.\n     *\n     * @public\n     * @param {Object} opt\n     * @param {number} [opt.start]\n     * @param {number} [opt.end]\n     * @param {number} [opt.startValue]\n     * @param {number} [opt.endValue]\n     * @param {boolean} [ignoreUpdateRangeUsg=false]\n     */\n    setRawRange: function (opt, ignoreUpdateRangeUsg) {\n        var option = this.option;\n        each$22([['start', 'startValue'], ['end', 'endValue']], function (names) {\n            // If only one of 'start' and 'startValue' is not null/undefined, the other\n            // should be cleared, which enable clear the option.\n            // If both of them are not set, keep option with the original value, which\n            // enable use only set start but not set end when calling `dispatchAction`.\n            // The same as 'end' and 'endValue'.\n            if (opt[names[0]] != null || opt[names[1]] != null) {\n                option[names[0]] = opt[names[0]];\n                option[names[1]] = opt[names[1]];\n            }\n        }, this);\n\n        !ignoreUpdateRangeUsg && updateRangeUse(this, opt);\n    },\n\n    /**\n     * @public\n     * @return {Array.<number>} [startPercent, endPercent]\n     */\n    getPercentRange: function () {\n        var axisProxy = this.findRepresentativeAxisProxy();\n        if (axisProxy) {\n            return axisProxy.getDataPercentWindow();\n        }\n    },\n\n    /**\n     * @public\n     * For example, chart.getModel().getComponent('dataZoom').getValueRange('y', 0);\n     *\n     * @param {string} [axisDimName]\n     * @param {number} [axisIndex]\n     * @return {Array.<number>} [startValue, endValue] value can only be '-' or finite number.\n     */\n    getValueRange: function (axisDimName, axisIndex) {\n        if (axisDimName == null && axisIndex == null) {\n            var axisProxy = this.findRepresentativeAxisProxy();\n            if (axisProxy) {\n                return axisProxy.getDataValueWindow();\n            }\n        }\n        else {\n            return this.getAxisProxy(axisDimName, axisIndex).getDataValueWindow();\n        }\n    },\n\n    /**\n     * @public\n     * @param {module:echarts/model/Model} [axisModel] If axisModel given, find axisProxy\n     *      corresponding to the axisModel\n     * @return {module:echarts/component/dataZoom/AxisProxy}\n     */\n    findRepresentativeAxisProxy: function (axisModel) {\n        if (axisModel) {\n            return axisModel.__dzAxisProxy;\n        }\n\n        // Find the first hosted axisProxy\n        var axisProxies = this._axisProxies;\n        for (var key in axisProxies) {\n            if (axisProxies.hasOwnProperty(key) && axisProxies[key].hostedBy(this)) {\n                return axisProxies[key];\n            }\n        }\n\n        // If no hosted axis find not hosted axisProxy.\n        // Consider this case: dataZoomModel1 and dataZoomModel2 control the same axis,\n        // and the option.start or option.end settings are different. The percentRange\n        // should follow axisProxy.\n        // (We encounter this problem in toolbox data zoom.)\n        for (var key in axisProxies) {\n            if (axisProxies.hasOwnProperty(key) && !axisProxies[key].hostedBy(this)) {\n                return axisProxies[key];\n            }\n        }\n    },\n\n    /**\n     * @return {Array.<string>}\n     */\n    getRangePropMode: function () {\n        return this._rangePropMode.slice();\n    }\n\n});\n\nfunction retrieveRaw(option) {\n    var ret = {};\n    each$22(\n        ['start', 'end', 'startValue', 'endValue', 'throttle'],\n        function (name) {\n            option.hasOwnProperty(name) && (ret[name] = option[name]);\n        }\n    );\n    return ret;\n}\n\nfunction updateRangeUse(dataZoomModel, rawOption) {\n    var rangePropMode = dataZoomModel._rangePropMode;\n    var rangeModeInOption = dataZoomModel.get('rangeMode');\n\n    each$22([['start', 'startValue'], ['end', 'endValue']], function (names, index) {\n        var percentSpecified = rawOption[names[0]] != null;\n        var valueSpecified = rawOption[names[1]] != null;\n        if (percentSpecified && !valueSpecified) {\n            rangePropMode[index] = 'percent';\n        }\n        else if (!percentSpecified && valueSpecified) {\n            rangePropMode[index] = 'value';\n        }\n        else if (rangeModeInOption) {\n            rangePropMode[index] = rangeModeInOption[index];\n        }\n        else if (percentSpecified) { // percentSpecified && valueSpecified\n            rangePropMode[index] = 'percent';\n        }\n        // else remain its original setting.\n    });\n}\n\nvar DataZoomView = Component.extend({\n\n    type: 'dataZoom',\n\n    render: function (dataZoomModel, ecModel, api, payload) {\n        this.dataZoomModel = dataZoomModel;\n        this.ecModel = ecModel;\n        this.api = api;\n    },\n\n    /**\n     * Find the first target coordinate system.\n     *\n     * @protected\n     * @return {Object} {\n     *                   grid: [\n     *                       {model: coord0, axisModels: [axis1, axis3], coordIndex: 1},\n     *                       {model: coord1, axisModels: [axis0, axis2], coordIndex: 0},\n     *                       ...\n     *                   ],  // cartesians must not be null/undefined.\n     *                   polar: [\n     *                       {model: coord0, axisModels: [axis4], coordIndex: 0},\n     *                       ...\n     *                   ],  // polars must not be null/undefined.\n     *                   singleAxis: [\n     *                       {model: coord0, axisModels: [], coordIndex: 0}\n     *                   ]\n     */\n    getTargetCoordInfo: function () {\n        var dataZoomModel = this.dataZoomModel;\n        var ecModel = this.ecModel;\n        var coordSysLists = {};\n\n        dataZoomModel.eachTargetAxis(function (dimNames, axisIndex) {\n            var axisModel = ecModel.getComponent(dimNames.axis, axisIndex);\n            if (axisModel) {\n                var coordModel = axisModel.getCoordSysModel();\n                coordModel && save(\n                    coordModel,\n                    axisModel,\n                    coordSysLists[coordModel.mainType] || (coordSysLists[coordModel.mainType] = []),\n                    coordModel.componentIndex\n                );\n            }\n        }, this);\n\n        function save(coordModel, axisModel, store, coordIndex) {\n            var item;\n            for (var i = 0; i < store.length; i++) {\n                if (store[i].model === coordModel) {\n                    item = store[i];\n                    break;\n                }\n            }\n            if (!item) {\n                store.push(item = {\n                    model: coordModel, axisModels: [], coordIndex: coordIndex\n                });\n            }\n            item.axisModels.push(axisModel);\n        }\n\n        return coordSysLists;\n    }\n\n});\n\nvar SliderZoomModel = DataZoomModel.extend({\n\n    type: 'dataZoom.slider',\n\n    layoutMode: 'box',\n\n    /**\n     * @protected\n     */\n    defaultOption: {\n        show: true,\n\n        // ph => placeholder. Using placehoder here because\n        // deault value can only be drived in view stage.\n        right: 'ph',  // Default align to grid rect.\n        top: 'ph',    // Default align to grid rect.\n        width: 'ph',  // Default align to grid rect.\n        height: 'ph', // Default align to grid rect.\n        left: null,   // Default align to grid rect.\n        bottom: null, // Default align to grid rect.\n\n        backgroundColor: 'rgba(47,69,84,0)',    // Background of slider zoom component.\n        // dataBackgroundColor: '#ddd',         // Background coor of data shadow and border of box,\n                                                // highest priority, remain for compatibility of\n                                                // previous version, but not recommended any more.\n        dataBackground: {\n            lineStyle: {\n                color: '#2f4554',\n                width: 0.5,\n                opacity: 0.3\n            },\n            areaStyle: {\n                color: 'rgba(47,69,84,0.3)',\n                opacity: 0.3\n            }\n        },\n        borderColor: '#ddd',                    // border color of the box. For compatibility,\n                                                // if dataBackgroundColor is set, borderColor\n                                                // is ignored.\n\n        fillerColor: 'rgba(167,183,204,0.4)',     // Color of selected area.\n        // handleColor: 'rgba(89,170,216,0.95)',     // Color of handle.\n        // handleIcon: 'path://M4.9,17.8c0-1.4,4.5-10.5,5.5-12.4c0-0.1,0.6-1.1,0.9-1.1c0.4,0,0.9,1,0.9,1.1c1.1,2.2,5.4,11,5.4,12.4v17.8c0,1.5-0.6,2.1-1.3,2.1H6.1c-0.7,0-1.3-0.6-1.3-2.1V17.8z',\n        handleIcon: 'M8.2,13.6V3.9H6.3v9.7H3.1v14.9h3.3v9.7h1.8v-9.7h3.3V13.6H8.2z M9.7,24.4H4.8v-1.4h4.9V24.4z M9.7,19.1H4.8v-1.4h4.9V19.1z',\n        // Percent of the slider height\n        handleSize: '100%',\n\n        handleStyle: {\n            color: '#a7b7cc'\n        },\n\n        labelPrecision: null,\n        labelFormatter: null,\n        showDetail: true,\n        showDataShadow: 'auto',                 // Default auto decision.\n        realtime: true,\n        zoomLock: false,                        // Whether disable zoom.\n        textStyle: {\n            color: '#333'\n        }\n    }\n\n});\n\nvar Rect$2 = Rect;\nvar linearMap$2 = linearMap;\nvar asc$2 = asc;\nvar bind$4 = bind;\nvar each$24 = each$1;\n\n// Constants\nvar DEFAULT_LOCATION_EDGE_GAP = 7;\nvar DEFAULT_FRAME_BORDER_WIDTH = 1;\nvar DEFAULT_FILLER_SIZE = 30;\nvar HORIZONTAL = 'horizontal';\nvar VERTICAL = 'vertical';\nvar LABEL_GAP = 5;\nvar SHOW_DATA_SHADOW_SERIES_TYPE = ['line', 'bar', 'candlestick', 'scatter'];\n\nvar SliderZoomView = DataZoomView.extend({\n\n    type: 'dataZoom.slider',\n\n    init: function (ecModel, api) {\n\n        /**\n         * @private\n         * @type {Object}\n         */\n        this._displayables = {};\n\n        /**\n         * @private\n         * @type {string}\n         */\n        this._orient;\n\n        /**\n         * [0, 100]\n         * @private\n         */\n        this._range;\n\n        /**\n         * [coord of the first handle, coord of the second handle]\n         * @private\n         */\n        this._handleEnds;\n\n        /**\n         * [length, thick]\n         * @private\n         * @type {Array.<number>}\n         */\n        this._size;\n\n        /**\n         * @private\n         * @type {number}\n         */\n        this._handleWidth;\n\n        /**\n         * @private\n         * @type {number}\n         */\n        this._handleHeight;\n\n        /**\n         * @private\n         */\n        this._location;\n\n        /**\n         * @private\n         */\n        this._dragging;\n\n        /**\n         * @private\n         */\n        this._dataShadowInfo;\n\n        this.api = api;\n    },\n\n    /**\n     * @override\n     */\n    render: function (dataZoomModel, ecModel, api, payload) {\n        SliderZoomView.superApply(this, 'render', arguments);\n\n        createOrUpdate(\n            this,\n            '_dispatchZoomAction',\n            this.dataZoomModel.get('throttle'),\n            'fixRate'\n        );\n\n        this._orient = dataZoomModel.get('orient');\n\n        if (this.dataZoomModel.get('show') === false) {\n            this.group.removeAll();\n            return;\n        }\n\n        // Notice: this._resetInterval() should not be executed when payload.type\n        // is 'dataZoom', origin this._range should be maintained, otherwise 'pan'\n        // or 'zoom' info will be missed because of 'throttle' of this.dispatchAction,\n        if (!payload || payload.type !== 'dataZoom' || payload.from !== this.uid) {\n            this._buildView();\n        }\n\n        this._updateView();\n    },\n\n    /**\n     * @override\n     */\n    remove: function () {\n        SliderZoomView.superApply(this, 'remove', arguments);\n        clear(this, '_dispatchZoomAction');\n    },\n\n    /**\n     * @override\n     */\n    dispose: function () {\n        SliderZoomView.superApply(this, 'dispose', arguments);\n        clear(this, '_dispatchZoomAction');\n    },\n\n    _buildView: function () {\n        var thisGroup = this.group;\n\n        thisGroup.removeAll();\n\n        this._resetLocation();\n        this._resetInterval();\n\n        var barGroup = this._displayables.barGroup = new Group();\n\n        this._renderBackground();\n\n        this._renderHandle();\n\n        this._renderDataShadow();\n\n        thisGroup.add(barGroup);\n\n        this._positionGroup();\n    },\n\n    /**\n     * @private\n     */\n    _resetLocation: function () {\n        var dataZoomModel = this.dataZoomModel;\n        var api = this.api;\n\n        // If some of x/y/width/height are not specified,\n        // auto-adapt according to target grid.\n        var coordRect = this._findCoordRect();\n        var ecSize = {width: api.getWidth(), height: api.getHeight()};\n        // Default align by coordinate system rect.\n        var positionInfo = this._orient === HORIZONTAL\n            ? {\n                // Why using 'right', because right should be used in vertical,\n                // and it is better to be consistent for dealing with position param merge.\n                right: ecSize.width - coordRect.x - coordRect.width,\n                top: (ecSize.height - DEFAULT_FILLER_SIZE - DEFAULT_LOCATION_EDGE_GAP),\n                width: coordRect.width,\n                height: DEFAULT_FILLER_SIZE\n            }\n            : { // vertical\n                right: DEFAULT_LOCATION_EDGE_GAP,\n                top: coordRect.y,\n                width: DEFAULT_FILLER_SIZE,\n                height: coordRect.height\n            };\n\n        // Do not write back to option and replace value 'ph', because\n        // the 'ph' value should be recalculated when resize.\n        var layoutParams = getLayoutParams(dataZoomModel.option);\n\n        // Replace the placeholder value.\n        each$1(['right', 'top', 'width', 'height'], function (name) {\n            if (layoutParams[name] === 'ph') {\n                layoutParams[name] = positionInfo[name];\n            }\n        });\n\n        var layoutRect = getLayoutRect(\n            layoutParams,\n            ecSize,\n            dataZoomModel.padding\n        );\n\n        this._location = {x: layoutRect.x, y: layoutRect.y};\n        this._size = [layoutRect.width, layoutRect.height];\n        this._orient === VERTICAL && this._size.reverse();\n    },\n\n    /**\n     * @private\n     */\n    _positionGroup: function () {\n        var thisGroup = this.group;\n        var location = this._location;\n        var orient = this._orient;\n\n        // Just use the first axis to determine mapping.\n        var targetAxisModel = this.dataZoomModel.getFirstTargetAxisModel();\n        var inverse = targetAxisModel && targetAxisModel.get('inverse');\n\n        var barGroup = this._displayables.barGroup;\n        var otherAxisInverse = (this._dataShadowInfo || {}).otherAxisInverse;\n\n        // Transform barGroup.\n        barGroup.attr(\n            (orient === HORIZONTAL && !inverse)\n            ? {scale: otherAxisInverse ? [1, 1] : [1, -1]}\n            : (orient === HORIZONTAL && inverse)\n            ? {scale: otherAxisInverse ? [-1, 1] : [-1, -1]}\n            : (orient === VERTICAL && !inverse)\n            ? {scale: otherAxisInverse ? [1, -1] : [1, 1], rotation: Math.PI / 2}\n            // Dont use Math.PI, considering shadow direction.\n            : {scale: otherAxisInverse ? [-1, -1] : [-1, 1], rotation: Math.PI / 2}\n        );\n\n        // Position barGroup\n        var rect = thisGroup.getBoundingRect([barGroup]);\n        thisGroup.attr('position', [location.x - rect.x, location.y - rect.y]);\n    },\n\n    /**\n     * @private\n     */\n    _getViewExtent: function () {\n        return [0, this._size[0]];\n    },\n\n    _renderBackground: function () {\n        var dataZoomModel = this.dataZoomModel;\n        var size = this._size;\n        var barGroup = this._displayables.barGroup;\n\n        barGroup.add(new Rect$2({\n            silent: true,\n            shape: {\n                x: 0, y: 0, width: size[0], height: size[1]\n            },\n            style: {\n                fill: dataZoomModel.get('backgroundColor')\n            },\n            z2: -40\n        }));\n\n        // Click panel, over shadow, below handles.\n        barGroup.add(new Rect$2({\n            shape: {\n                x: 0, y: 0, width: size[0], height: size[1]\n            },\n            style: {\n                fill: 'transparent'\n            },\n            z2: 0,\n            onclick: bind(this._onClickPanelClick, this)\n        }));\n    },\n\n    _renderDataShadow: function () {\n        var info = this._dataShadowInfo = this._prepareDataShadowInfo();\n\n        if (!info) {\n            return;\n        }\n\n        var size = this._size;\n        var seriesModel = info.series;\n        var data = seriesModel.getRawData();\n\n        var otherDim = seriesModel.getShadowDim\n            ? seriesModel.getShadowDim() // @see candlestick\n            : info.otherDim;\n\n        if (otherDim == null) {\n            return;\n        }\n\n        var otherDataExtent = data.getDataExtent(otherDim);\n        // Nice extent.\n        var otherOffset = (otherDataExtent[1] - otherDataExtent[0]) * 0.3;\n        otherDataExtent = [\n            otherDataExtent[0] - otherOffset,\n            otherDataExtent[1] + otherOffset\n        ];\n        var otherShadowExtent = [0, size[1]];\n\n        var thisShadowExtent = [0, size[0]];\n\n        var areaPoints = [[size[0], 0], [0, 0]];\n        var linePoints = [];\n        var step = thisShadowExtent[1] / (data.count() - 1);\n        var thisCoord = 0;\n\n        // Optimize for large data shadow\n        var stride = Math.round(data.count() / size[0]);\n        var lastIsEmpty;\n        data.each([otherDim], function (value, index) {\n            if (stride > 0 && (index % stride)) {\n                thisCoord += step;\n                return;\n            }\n\n            // FIXME\n            // Should consider axis.min/axis.max when drawing dataShadow.\n\n            // FIXME\n            // list\n            var isEmpty = value == null || isNaN(value) || value === '';\n            // See #4235.\n            var otherCoord = isEmpty\n                ? 0 : linearMap$2(value, otherDataExtent, otherShadowExtent, true);\n\n            // Attempt to draw data shadow precisely when there are empty value.\n            if (isEmpty && !lastIsEmpty && index) {\n                areaPoints.push([areaPoints[areaPoints.length - 1][0], 0]);\n                linePoints.push([linePoints[linePoints.length - 1][0], 0]);\n            }\n            else if (!isEmpty && lastIsEmpty) {\n                areaPoints.push([thisCoord, 0]);\n                linePoints.push([thisCoord, 0]);\n            }\n\n            areaPoints.push([thisCoord, otherCoord]);\n            linePoints.push([thisCoord, otherCoord]);\n\n            thisCoord += step;\n            lastIsEmpty = isEmpty;\n        });\n\n        var dataZoomModel = this.dataZoomModel;\n        // var dataBackgroundModel = dataZoomModel.getModel('dataBackground');\n        this._displayables.barGroup.add(new Polygon({\n            shape: {points: areaPoints},\n            style: defaults(\n                {fill: dataZoomModel.get('dataBackgroundColor')},\n                dataZoomModel.getModel('dataBackground.areaStyle').getAreaStyle()\n            ),\n            silent: true,\n            z2: -20\n        }));\n        this._displayables.barGroup.add(new Polyline({\n            shape: {points: linePoints},\n            style: dataZoomModel.getModel('dataBackground.lineStyle').getLineStyle(),\n            silent: true,\n            z2: -19\n        }));\n    },\n\n    _prepareDataShadowInfo: function () {\n        var dataZoomModel = this.dataZoomModel;\n        var showDataShadow = dataZoomModel.get('showDataShadow');\n\n        if (showDataShadow === false) {\n            return;\n        }\n\n        // Find a representative series.\n        var result;\n        var ecModel = this.ecModel;\n\n        dataZoomModel.eachTargetAxis(function (dimNames, axisIndex) {\n            var seriesModels = dataZoomModel\n                .getAxisProxy(dimNames.name, axisIndex)\n                .getTargetSeriesModels();\n\n            each$1(seriesModels, function (seriesModel) {\n                if (result) {\n                    return;\n                }\n\n                if (showDataShadow !== true && indexOf(\n                        SHOW_DATA_SHADOW_SERIES_TYPE, seriesModel.get('type')\n                    ) < 0\n                ) {\n                    return;\n                }\n\n                var thisAxis = ecModel.getComponent(dimNames.axis, axisIndex).axis;\n                var otherDim = getOtherDim(dimNames.name);\n                var otherAxisInverse;\n                var coordSys = seriesModel.coordinateSystem;\n\n                if (otherDim != null && coordSys.getOtherAxis) {\n                    otherAxisInverse = coordSys.getOtherAxis(thisAxis).inverse;\n                }\n\n                otherDim = seriesModel.getData().mapDimension(otherDim);\n\n                result = {\n                    thisAxis: thisAxis,\n                    series: seriesModel,\n                    thisDim: dimNames.name,\n                    otherDim: otherDim,\n                    otherAxisInverse: otherAxisInverse\n                };\n\n            }, this);\n\n        }, this);\n\n        return result;\n    },\n\n    _renderHandle: function () {\n        var displaybles = this._displayables;\n        var handles = displaybles.handles = [];\n        var handleLabels = displaybles.handleLabels = [];\n        var barGroup = this._displayables.barGroup;\n        var size = this._size;\n        var dataZoomModel = this.dataZoomModel;\n\n        barGroup.add(displaybles.filler = new Rect$2({\n            draggable: true,\n            cursor: getCursor(this._orient),\n            drift: bind$4(this._onDragMove, this, 'all'),\n            onmousemove: function (e) {\n                // Fot mobile devicem, prevent screen slider on the button.\n                stop(e.event);\n            },\n            ondragstart: bind$4(this._showDataInfo, this, true),\n            ondragend: bind$4(this._onDragEnd, this),\n            onmouseover: bind$4(this._showDataInfo, this, true),\n            onmouseout: bind$4(this._showDataInfo, this, false),\n            style: {\n                fill: dataZoomModel.get('fillerColor'),\n                textPosition : 'inside'\n            }\n        }));\n\n        // Frame border.\n        barGroup.add(new Rect$2(subPixelOptimizeRect({\n            silent: true,\n            shape: {\n                x: 0,\n                y: 0,\n                width: size[0],\n                height: size[1]\n            },\n            style: {\n                stroke: dataZoomModel.get('dataBackgroundColor')\n                    || dataZoomModel.get('borderColor'),\n                lineWidth: DEFAULT_FRAME_BORDER_WIDTH,\n                fill: 'rgba(0,0,0,0)'\n            }\n        })));\n\n        each$24([0, 1], function (handleIndex) {\n            var path = createIcon(\n                dataZoomModel.get('handleIcon'),\n                {\n                    cursor: getCursor(this._orient),\n                    draggable: true,\n                    drift: bind$4(this._onDragMove, this, handleIndex),\n                    onmousemove: function (e) {\n                        // Fot mobile devicem, prevent screen slider on the button.\n                        stop(e.event);\n                    },\n                    ondragend: bind$4(this._onDragEnd, this),\n                    onmouseover: bind$4(this._showDataInfo, this, true),\n                    onmouseout: bind$4(this._showDataInfo, this, false)\n                },\n                {x: -1, y: 0, width: 2, height: 2}\n            );\n\n            var bRect = path.getBoundingRect();\n            this._handleHeight = parsePercent$1(dataZoomModel.get('handleSize'), this._size[1]);\n            this._handleWidth = bRect.width / bRect.height * this._handleHeight;\n\n            path.setStyle(dataZoomModel.getModel('handleStyle').getItemStyle());\n            var handleColor = dataZoomModel.get('handleColor');\n            // Compatitable with previous version\n            if (handleColor != null) {\n                path.style.fill = handleColor;\n            }\n\n            barGroup.add(handles[handleIndex] = path);\n\n            var textStyleModel = dataZoomModel.textStyleModel;\n\n            this.group.add(\n                handleLabels[handleIndex] = new Text({\n                silent: true,\n                invisible: true,\n                style: {\n                    x: 0, y: 0, text: '',\n                    textVerticalAlign: 'middle',\n                    textAlign: 'center',\n                    textFill: textStyleModel.getTextColor(),\n                    textFont: textStyleModel.getFont()\n                },\n                z2: 10\n            }));\n\n        }, this);\n    },\n\n    /**\n     * @private\n     */\n    _resetInterval: function () {\n        var range = this._range = this.dataZoomModel.getPercentRange();\n        var viewExtent = this._getViewExtent();\n\n        this._handleEnds = [\n            linearMap$2(range[0], [0, 100], viewExtent, true),\n            linearMap$2(range[1], [0, 100], viewExtent, true)\n        ];\n    },\n\n    /**\n     * @private\n     * @param {(number|string)} handleIndex 0 or 1 or 'all'\n     * @param {number} delta\n     */\n    _updateInterval: function (handleIndex, delta) {\n        var dataZoomModel = this.dataZoomModel;\n        var handleEnds = this._handleEnds;\n        var viewExtend = this._getViewExtent();\n        var minMaxSpan = dataZoomModel.findRepresentativeAxisProxy().getMinMaxSpan();\n        var percentExtent = [0, 100];\n\n        sliderMove(\n            delta,\n            handleEnds,\n            viewExtend,\n            dataZoomModel.get('zoomLock') ? 'all' : handleIndex,\n            minMaxSpan.minSpan != null\n                ? linearMap$2(minMaxSpan.minSpan, percentExtent, viewExtend, true) : null,\n            minMaxSpan.maxSpan != null\n                ? linearMap$2(minMaxSpan.maxSpan, percentExtent, viewExtend, true) : null\n        );\n\n        this._range = asc$2([\n            linearMap$2(handleEnds[0], viewExtend, percentExtent, true),\n            linearMap$2(handleEnds[1], viewExtend, percentExtent, true)\n        ]);\n    },\n\n    /**\n     * @private\n     */\n    _updateView: function (nonRealtime) {\n        var displaybles = this._displayables;\n        var handleEnds = this._handleEnds;\n        var handleInterval = asc$2(handleEnds.slice());\n        var size = this._size;\n\n        each$24([0, 1], function (handleIndex) {\n            // Handles\n            var handle = displaybles.handles[handleIndex];\n            var handleHeight = this._handleHeight;\n            handle.attr({\n                scale: [handleHeight / 2, handleHeight / 2],\n                position: [handleEnds[handleIndex], size[1] / 2 - handleHeight / 2]\n            });\n        }, this);\n\n        // Filler\n        displaybles.filler.setShape({\n            x: handleInterval[0],\n            y: 0,\n            width: handleInterval[1] - handleInterval[0],\n            height: size[1]\n        });\n\n        this._updateDataInfo(nonRealtime);\n    },\n\n    /**\n     * @private\n     */\n    _updateDataInfo: function (nonRealtime) {\n        var dataZoomModel = this.dataZoomModel;\n        var displaybles = this._displayables;\n        var handleLabels = displaybles.handleLabels;\n        var orient = this._orient;\n        var labelTexts = ['', ''];\n\n        // FIXME\n        // dateformatterautoformatterec2 date.getAutoFormatter\n        if (dataZoomModel.get('showDetail')) {\n            var axisProxy = dataZoomModel.findRepresentativeAxisProxy();\n\n            if (axisProxy) {\n                var axis = axisProxy.getAxisModel().axis;\n                var range = this._range;\n\n                var dataInterval = nonRealtime\n                    // See #4434, data and axis are not processed and reset yet in non-realtime mode.\n                    ? axisProxy.calculateDataWindow({\n                        start: range[0], end: range[1]\n                    }).valueWindow\n                    : axisProxy.getDataValueWindow();\n\n                labelTexts = [\n                    this._formatLabel(dataInterval[0], axis),\n                    this._formatLabel(dataInterval[1], axis)\n                ];\n            }\n        }\n\n        var orderedHandleEnds = asc$2(this._handleEnds.slice());\n\n        setLabel.call(this, 0);\n        setLabel.call(this, 1);\n\n        function setLabel(handleIndex) {\n            // Label\n            // Text should not transform by barGroup.\n            // Ignore handlers transform\n            var barTransform = getTransform(\n                displaybles.handles[handleIndex].parent, this.group\n            );\n            var direction = transformDirection(\n                handleIndex === 0 ? 'right' : 'left', barTransform\n            );\n            var offset = this._handleWidth / 2 + LABEL_GAP;\n            var textPoint = applyTransform$1(\n                [\n                    orderedHandleEnds[handleIndex] + (handleIndex === 0 ? -offset : offset),\n                    this._size[1] / 2\n                ],\n                barTransform\n            );\n            handleLabels[handleIndex].setStyle({\n                x: textPoint[0],\n                y: textPoint[1],\n                textVerticalAlign: orient === HORIZONTAL ? 'middle' : direction,\n                textAlign: orient === HORIZONTAL ? direction : 'center',\n                text: labelTexts[handleIndex]\n            });\n        }\n    },\n\n    /**\n     * @private\n     */\n    _formatLabel: function (value, axis) {\n        var dataZoomModel = this.dataZoomModel;\n        var labelFormatter = dataZoomModel.get('labelFormatter');\n\n        var labelPrecision = dataZoomModel.get('labelPrecision');\n        if (labelPrecision == null || labelPrecision === 'auto') {\n            labelPrecision = axis.getPixelPrecision();\n        }\n\n        var valueStr = (value == null || isNaN(value))\n            ? ''\n            // FIXME Glue code\n            : (axis.type === 'category' || axis.type === 'time')\n                ? axis.scale.getLabel(Math.round(value))\n                // param of toFixed should less then 20.\n                : value.toFixed(Math.min(labelPrecision, 20));\n\n        return isFunction$1(labelFormatter)\n            ? labelFormatter(value, valueStr)\n            : isString(labelFormatter)\n            ? labelFormatter.replace('{value}', valueStr)\n            : valueStr;\n    },\n\n    /**\n     * @private\n     * @param {boolean} showOrHide true: show, false: hide\n     */\n    _showDataInfo: function (showOrHide) {\n        // Always show when drgging.\n        showOrHide = this._dragging || showOrHide;\n\n        var handleLabels = this._displayables.handleLabels;\n        handleLabels[0].attr('invisible', !showOrHide);\n        handleLabels[1].attr('invisible', !showOrHide);\n    },\n\n    _onDragMove: function (handleIndex, dx, dy) {\n        this._dragging = true;\n\n        // Transform dx, dy to bar coordination.\n        var barTransform = this._displayables.barGroup.getLocalTransform();\n        var vertex = applyTransform$1([dx, dy], barTransform, true);\n\n        this._updateInterval(handleIndex, vertex[0]);\n\n        var realtime = this.dataZoomModel.get('realtime');\n\n        this._updateView(!realtime);\n\n        realtime && this._dispatchZoomAction();\n    },\n\n    _onDragEnd: function () {\n        this._dragging = false;\n        this._showDataInfo(false);\n\n        // While in realtime mode and stream mode, dispatch action when\n        // drag end will cause the whole view rerender, which is unnecessary.\n        var realtime = this.dataZoomModel.get('realtime');\n        !realtime && this._dispatchZoomAction();\n    },\n\n    _onClickPanelClick: function (e) {\n        var size = this._size;\n        var localPoint = this._displayables.barGroup.transformCoordToLocal(e.offsetX, e.offsetY);\n\n        if (localPoint[0] < 0 || localPoint[0] > size[0]\n            || localPoint[1] < 0 || localPoint[1] > size[1]\n        ) {\n            return;\n        }\n\n        var handleEnds = this._handleEnds;\n        var center = (handleEnds[0] + handleEnds[1]) / 2;\n\n        this._updateInterval('all', localPoint[0] - center);\n        this._updateView();\n        this._dispatchZoomAction();\n    },\n\n    /**\n     * This action will be throttled.\n     * @private\n     */\n    _dispatchZoomAction: function () {\n        var range = this._range;\n\n        this.api.dispatchAction({\n            type: 'dataZoom',\n            from: this.uid,\n            dataZoomId: this.dataZoomModel.id,\n            start: range[0],\n            end: range[1]\n        });\n    },\n\n    /**\n     * @private\n     */\n    _findCoordRect: function () {\n        // Find the grid coresponding to the first axis referred by dataZoom.\n        var rect;\n        each$24(this.getTargetCoordInfo(), function (coordInfoList) {\n            if (!rect && coordInfoList.length) {\n                var coordSys = coordInfoList[0].model.coordinateSystem;\n                rect = coordSys.getRect && coordSys.getRect();\n            }\n        });\n        if (!rect) {\n            var width = this.api.getWidth();\n            var height = this.api.getHeight();\n            rect = {\n                x: width * 0.2,\n                y: height * 0.2,\n                width: width * 0.6,\n                height: height * 0.6\n            };\n        }\n\n        return rect;\n    }\n\n});\n\nfunction getOtherDim(thisDim) {\n    // FIXME\n    // getOtherAxis\n    var map$$1 = {x: 'y', y: 'x', radius: 'angle', angle: 'radius'};\n    return map$$1[thisDim];\n}\n\nfunction getCursor(orient) {\n    return orient === 'vertical' ? 'ns-resize' : 'ew-resize';\n}\n\nDataZoomModel.extend({\n\n    type: 'dataZoom.inside',\n\n    /**\n     * @protected\n     */\n    defaultOption: {\n        disabled: false,   // Whether disable this inside zoom.\n        zoomLock: false,   // Whether disable zoom but only pan.\n        zoomOnMouseWheel: true, // Can be: true / false / 'shift' / 'ctrl' / 'alt'.\n        moveOnMouseMove: true,   // Can be: true / false / 'shift' / 'ctrl' / 'alt'.\n        preventDefaultMouseMove: true\n    }\n});\n\n// Only create one roam controller for each coordinate system.\n// one roam controller might be refered by two inside data zoom\n// components (for example, one for x and one for y). When user\n// pan or zoom, only dispatch one action for those data zoom\n// components.\n\nvar curry$6 = curry;\n\nvar ATTR$1 = '\\0_ec_dataZoom_roams';\n\n\n/**\n * @public\n * @param {module:echarts/ExtensionAPI} api\n * @param {Object} dataZoomInfo\n * @param {string} dataZoomInfo.coordId\n * @param {Function} dataZoomInfo.containsPoint\n * @param {Array.<string>} dataZoomInfo.allCoordIds\n * @param {string} dataZoomInfo.dataZoomId\n * @param {number} dataZoomInfo.throttleRate\n * @param {Function} dataZoomInfo.panGetRange\n * @param {Function} dataZoomInfo.zoomGetRange\n * @param {boolean} [dataZoomInfo.zoomLock]\n * @param {boolean} [dataZoomInfo.disabled]\n */\nfunction register$2(api, dataZoomInfo) {\n    var store = giveStore(api);\n    var theDataZoomId = dataZoomInfo.dataZoomId;\n    var theCoordId = dataZoomInfo.coordId;\n\n    // Do clean when a dataZoom changes its target coordnate system.\n    // Avoid memory leak, dispose all not-used-registered.\n    each$1(store, function (record, coordId) {\n        var dataZoomInfos = record.dataZoomInfos;\n        if (dataZoomInfos[theDataZoomId]\n            && indexOf(dataZoomInfo.allCoordIds, theCoordId) < 0\n        ) {\n            delete dataZoomInfos[theDataZoomId];\n            record.count--;\n        }\n    });\n\n    cleanStore(store);\n\n    var record = store[theCoordId];\n    // Create if needed.\n    if (!record) {\n        record = store[theCoordId] = {\n            coordId: theCoordId,\n            dataZoomInfos: {},\n            count: 0\n        };\n        record.controller = createController(api, record);\n        record.dispatchAction = curry(dispatchAction$1, api);\n    }\n\n    // Update reference of dataZoom.\n    !(record.dataZoomInfos[theDataZoomId]) && record.count++;\n    record.dataZoomInfos[theDataZoomId] = dataZoomInfo;\n\n    var controllerParams = mergeControllerParams(record.dataZoomInfos);\n    record.controller.enable(controllerParams.controlType, controllerParams.opt);\n\n    // Consider resize, area should be always updated.\n    record.controller.setPointerChecker(dataZoomInfo.containsPoint);\n\n    // Update throttle.\n    createOrUpdate(\n        record,\n        'dispatchAction',\n        dataZoomInfo.throttleRate,\n        'fixRate'\n    );\n}\n\n/**\n * @public\n * @param {module:echarts/ExtensionAPI} api\n * @param {string} dataZoomId\n */\nfunction unregister$1(api, dataZoomId) {\n    var store = giveStore(api);\n\n    each$1(store, function (record) {\n        record.controller.dispose();\n        var dataZoomInfos = record.dataZoomInfos;\n        if (dataZoomInfos[dataZoomId]) {\n            delete dataZoomInfos[dataZoomId];\n            record.count--;\n        }\n    });\n\n    cleanStore(store);\n}\n\n/**\n * @public\n */\nfunction shouldRecordRange(payload, dataZoomId) {\n    if (payload && payload.type === 'dataZoom' && payload.batch) {\n        for (var i = 0, len = payload.batch.length; i < len; i++) {\n            if (payload.batch[i].dataZoomId === dataZoomId) {\n                return false;\n            }\n        }\n    }\n    return true;\n}\n\n/**\n * @public\n */\nfunction generateCoordId(coordModel) {\n    return coordModel.type + '\\0_' + coordModel.id;\n}\n\n/**\n * Key: coordId, value: {dataZoomInfos: [], count, controller}\n * @type {Array.<Object>}\n */\nfunction giveStore(api) {\n    // Mount store on zrender instance, so that we do not\n    // need to worry about dispose.\n    var zr = api.getZr();\n    return zr[ATTR$1] || (zr[ATTR$1] = {});\n}\n\nfunction createController(api, newRecord) {\n    var controller = new RoamController(api.getZr());\n    controller.on('pan', curry$6(onPan, newRecord));\n    controller.on('zoom', curry$6(onZoom, newRecord));\n\n    return controller;\n}\n\nfunction cleanStore(store) {\n    each$1(store, function (record, coordId) {\n        if (!record.count) {\n            record.controller.dispose();\n            delete store[coordId];\n        }\n    });\n}\n\nfunction onPan(record, dx, dy, oldX, oldY, newX, newY) {\n    wrapAndDispatch(record, function (info) {\n        return info.panGetRange(record.controller, dx, dy, oldX, oldY, newX, newY);\n    });\n}\n\nfunction onZoom(record, scale, mouseX, mouseY) {\n    wrapAndDispatch(record, function (info) {\n        return info.zoomGetRange(record.controller, scale, mouseX, mouseY);\n    });\n}\n\nfunction wrapAndDispatch(record, getRange) {\n    var batch = [];\n\n    each$1(record.dataZoomInfos, function (info) {\n        var range = getRange(info);\n        !info.disabled && range && batch.push({\n            dataZoomId: info.dataZoomId,\n            start: range[0],\n            end: range[1]\n        });\n    });\n\n    record.dispatchAction(batch);\n}\n\n/**\n * This action will be throttled.\n */\nfunction dispatchAction$1(api, batch) {\n    api.dispatchAction({\n        type: 'dataZoom',\n        batch: batch\n    });\n}\n\n/**\n * Merge roamController settings when multiple dataZooms share one roamController.\n */\nfunction mergeControllerParams(dataZoomInfos) {\n    var controlType;\n    var opt = {};\n    // DO NOT use reserved word (true, false, undefined) as key literally. Even if encapsulated\n    // as string, it is probably revert to reserved word by compress tool. See #7411.\n    var prefix = 'type_';\n    var typePriority = {\n        'type_true': 2,\n        'type_move': 1,\n        'type_false': 0,\n        'type_undefined': -1\n    };\n    each$1(dataZoomInfos, function (dataZoomInfo) {\n        var oneType = dataZoomInfo.disabled ? false : dataZoomInfo.zoomLock ? 'move' : true;\n        if (typePriority[prefix + oneType] > typePriority[prefix + controlType]) {\n            controlType = oneType;\n        }\n        // Do not support that different 'shift'/'ctrl'/'alt' setting used in one coord sys.\n        extend(opt, dataZoomInfo.roamControllerOpt);\n    });\n\n    return {\n        controlType: controlType,\n        opt: opt\n    };\n}\n\nvar bind$5 = bind;\n\nvar InsideZoomView = DataZoomView.extend({\n\n    type: 'dataZoom.inside',\n\n    /**\n     * @override\n     */\n    init: function (ecModel, api) {\n        /**\n         * 'throttle' is used in this.dispatchAction, so we save range\n         * to avoid missing some 'pan' info.\n         * @private\n         * @type {Array.<number>}\n         */\n        this._range;\n    },\n\n    /**\n     * @override\n     */\n    render: function (dataZoomModel, ecModel, api, payload) {\n        InsideZoomView.superApply(this, 'render', arguments);\n\n        // Notice: origin this._range should be maintained, and should not be re-fetched\n        // from dataZoomModel when payload.type is 'dataZoom', otherwise 'pan' or 'zoom'\n        // info will be missed because of 'throttle' of this.dispatchAction.\n        if (shouldRecordRange(payload, dataZoomModel.id)) {\n            this._range = dataZoomModel.getPercentRange();\n        }\n\n        // Reset controllers.\n        each$1(this.getTargetCoordInfo(), function (coordInfoList, coordSysName) {\n\n            var allCoordIds = map(coordInfoList, function (coordInfo) {\n                return generateCoordId(coordInfo.model);\n            });\n\n            each$1(coordInfoList, function (coordInfo) {\n                var coordModel = coordInfo.model;\n                var dataZoomOption = dataZoomModel.option;\n\n                register$2(\n                    api,\n                    {\n                        coordId: generateCoordId(coordModel),\n                        allCoordIds: allCoordIds,\n                        containsPoint: function (e, x, y) {\n                            return coordModel.coordinateSystem.containPoint([x, y]);\n                        },\n                        dataZoomId: dataZoomModel.id,\n                        throttleRate: dataZoomModel.get('throttle', true),\n                        panGetRange: bind$5(this._onPan, this, coordInfo, coordSysName),\n                        zoomGetRange: bind$5(this._onZoom, this, coordInfo, coordSysName),\n                        zoomLock: dataZoomOption.zoomLock,\n                        disabled: dataZoomOption.disabled,\n                        roamControllerOpt: {\n                            zoomOnMouseWheel: dataZoomOption.zoomOnMouseWheel,\n                            moveOnMouseMove: dataZoomOption.moveOnMouseMove,\n                            preventDefaultMouseMove: dataZoomOption.preventDefaultMouseMove\n                        }\n                    }\n                );\n            }, this);\n\n        }, this);\n    },\n\n    /**\n     * @override\n     */\n    dispose: function () {\n        unregister$1(this.api, this.dataZoomModel.id);\n        InsideZoomView.superApply(this, 'dispose', arguments);\n        this._range = null;\n    },\n\n    /**\n     * @private\n     */\n    _onPan: function (coordInfo, coordSysName, controller, dx, dy, oldX, oldY, newX, newY) {\n        var range = this._range.slice();\n\n        // Calculate transform by the first axis.\n        var axisModel = coordInfo.axisModels[0];\n        if (!axisModel) {\n            return;\n        }\n\n        var directionInfo = getDirectionInfo[coordSysName](\n            [oldX, oldY], [newX, newY], axisModel, controller, coordInfo\n        );\n\n        var percentDelta = directionInfo.signal\n            * (range[1] - range[0])\n            * directionInfo.pixel / directionInfo.pixelLength;\n\n        sliderMove(percentDelta, range, [0, 100], 'all');\n\n        return (this._range = range);\n    },\n\n    /**\n     * @private\n     */\n    _onZoom: function (coordInfo, coordSysName, controller, scale, mouseX, mouseY) {\n        var range = this._range.slice();\n\n        // Calculate transform by the first axis.\n        var axisModel = coordInfo.axisModels[0];\n        if (!axisModel) {\n            return;\n        }\n\n        var directionInfo = getDirectionInfo[coordSysName](\n            null, [mouseX, mouseY], axisModel, controller, coordInfo\n        );\n        var percentPoint = (\n            directionInfo.signal > 0\n                ? (directionInfo.pixelStart + directionInfo.pixelLength - directionInfo.pixel)\n                : (directionInfo.pixel - directionInfo.pixelStart)\n            ) / directionInfo.pixelLength * (range[1] - range[0]) + range[0];\n\n        scale = Math.max(1 / scale, 0);\n        range[0] = (range[0] - percentPoint) * scale + percentPoint;\n        range[1] = (range[1] - percentPoint) * scale + percentPoint;\n\n        // Restrict range.\n        var minMaxSpan = this.dataZoomModel.findRepresentativeAxisProxy().getMinMaxSpan();\n\n        sliderMove(0, range, [0, 100], 0, minMaxSpan.minSpan, minMaxSpan.maxSpan);\n\n        return (this._range = range);\n    }\n\n});\n\nvar getDirectionInfo = {\n\n    grid: function (oldPoint, newPoint, axisModel, controller, coordInfo) {\n        var axis = axisModel.axis;\n        var ret = {};\n        var rect = coordInfo.model.coordinateSystem.getRect();\n        oldPoint = oldPoint || [0, 0];\n\n        if (axis.dim === 'x') {\n            ret.pixel = newPoint[0] - oldPoint[0];\n            ret.pixelLength = rect.width;\n            ret.pixelStart = rect.x;\n            ret.signal = axis.inverse ? 1 : -1;\n        }\n        else { // axis.dim === 'y'\n            ret.pixel = newPoint[1] - oldPoint[1];\n            ret.pixelLength = rect.height;\n            ret.pixelStart = rect.y;\n            ret.signal = axis.inverse ? -1 : 1;\n        }\n\n        return ret;\n    },\n\n    polar: function (oldPoint, newPoint, axisModel, controller, coordInfo) {\n        var axis = axisModel.axis;\n        var ret = {};\n        var polar = coordInfo.model.coordinateSystem;\n        var radiusExtent = polar.getRadiusAxis().getExtent();\n        var angleExtent = polar.getAngleAxis().getExtent();\n\n        oldPoint = oldPoint ? polar.pointToCoord(oldPoint) : [0, 0];\n        newPoint = polar.pointToCoord(newPoint);\n\n        if (axisModel.mainType === 'radiusAxis') {\n            ret.pixel = newPoint[0] - oldPoint[0];\n            // ret.pixelLength = Math.abs(radiusExtent[1] - radiusExtent[0]);\n            // ret.pixelStart = Math.min(radiusExtent[0], radiusExtent[1]);\n            ret.pixelLength = radiusExtent[1] - radiusExtent[0];\n            ret.pixelStart = radiusExtent[0];\n            ret.signal = axis.inverse ? 1 : -1;\n        }\n        else { // 'angleAxis'\n            ret.pixel = newPoint[1] - oldPoint[1];\n            // ret.pixelLength = Math.abs(angleExtent[1] - angleExtent[0]);\n            // ret.pixelStart = Math.min(angleExtent[0], angleExtent[1]);\n            ret.pixelLength = angleExtent[1] - angleExtent[0];\n            ret.pixelStart = angleExtent[0];\n            ret.signal = axis.inverse ? -1 : 1;\n        }\n\n        return ret;\n    },\n\n    singleAxis: function (oldPoint, newPoint, axisModel, controller, coordInfo) {\n        var axis = axisModel.axis;\n        var rect = coordInfo.model.coordinateSystem.getRect();\n        var ret = {};\n\n        oldPoint = oldPoint || [0, 0];\n\n        if (axis.orient === 'horizontal') {\n            ret.pixel = newPoint[0] - oldPoint[0];\n            ret.pixelLength = rect.width;\n            ret.pixelStart = rect.x;\n            ret.signal = axis.inverse ? 1 : -1;\n        }\n        else { // 'vertical'\n            ret.pixel = newPoint[1] - oldPoint[1];\n            ret.pixelLength = rect.height;\n            ret.pixelStart = rect.y;\n            ret.signal = axis.inverse ? -1 : 1;\n        }\n\n        return ret;\n    }\n};\n\nregisterProcessor({\n\n    getTargetSeries: function (ecModel) {\n        var seriesModelMap = createHashMap();\n\n        ecModel.eachComponent('dataZoom', function (dataZoomModel) {\n            dataZoomModel.eachTargetAxis(function (dimNames, axisIndex, dataZoomModel) {\n                var axisProxy = dataZoomModel.getAxisProxy(dimNames.name, axisIndex);\n                each$1(axisProxy.getTargetSeriesModels(), function (seriesModel) {\n                    seriesModelMap.set(seriesModel.uid, seriesModel);\n                });\n            });\n        });\n\n        return seriesModelMap;\n    },\n\n    isOverallFilter: true,\n\n    // Consider appendData, where filter should be performed. Because data process is\n    // in block mode currently, it is not need to worry about that the overallProgress\n    // execute every frame.\n    overallReset: function (ecModel, api) {\n        ecModel.eachComponent('dataZoom', function (dataZoomModel) {\n            // We calculate window and reset axis here but not in model\n            // init stage and not after action dispatch handler, because\n            // reset should be called after seriesData.restoreData.\n            dataZoomModel.eachTargetAxis(function (dimNames, axisIndex, dataZoomModel) {\n                dataZoomModel.getAxisProxy(dimNames.name, axisIndex).reset(dataZoomModel, api);\n            });\n\n            // Caution: data zoom filtering is order sensitive when using\n            // percent range and no min/max/scale set on axis.\n            // For example, we have dataZoom definition:\n            // [\n            //      {xAxisIndex: 0, start: 30, end: 70},\n            //      {yAxisIndex: 0, start: 20, end: 80}\n            // ]\n            // In this case, [20, 80] of y-dataZoom should be based on data\n            // that have filtered by x-dataZoom using range of [30, 70],\n            // but should not be based on full raw data. Thus sliding\n            // x-dataZoom will change both ranges of xAxis and yAxis,\n            // while sliding y-dataZoom will only change the range of yAxis.\n            // So we should filter x-axis after reset x-axis immediately,\n            // and then reset y-axis and filter y-axis.\n            dataZoomModel.eachTargetAxis(function (dimNames, axisIndex, dataZoomModel) {\n                dataZoomModel.getAxisProxy(dimNames.name, axisIndex).filterData(dataZoomModel, api);\n            });\n        });\n\n        ecModel.eachComponent('dataZoom', function (dataZoomModel) {\n            // Fullfill all of the range props so that user\n            // is able to get them from chart.getOption().\n            var axisProxy = dataZoomModel.findRepresentativeAxisProxy();\n            var percentRange = axisProxy.getDataPercentWindow();\n            var valueRange = axisProxy.getDataValueWindow();\n\n            dataZoomModel.setRawRange({\n                start: percentRange[0],\n                end: percentRange[1],\n                startValue: valueRange[0],\n                endValue: valueRange[1]\n            }, true);\n        });\n    }\n});\n\nregisterAction('dataZoom', function (payload, ecModel) {\n\n    var linkedNodesFinder = createLinkedNodesFinder(\n        bind(ecModel.eachComponent, ecModel, 'dataZoom'),\n        eachAxisDim$1,\n        function (model, dimNames) {\n            return model.get(dimNames.axisIndex);\n        }\n    );\n\n    var effectedModels = [];\n\n    ecModel.eachComponent(\n        {mainType: 'dataZoom', query: payload},\n        function (model, index) {\n            effectedModels.push.apply(\n                effectedModels, linkedNodesFinder(model).nodes\n            );\n        }\n    );\n\n    each$1(effectedModels, function (dataZoomModel, index) {\n        dataZoomModel.setRawRange({\n            start: payload.start,\n            end: payload.end,\n            startValue: payload.startValue,\n            endValue: payload.endValue\n        });\n    });\n\n});\n\n/**\n * DataZoom component entry\n */\n\nvar each$25 = each$1;\n\nvar preprocessor$2 = function (option) {\n    var visualMap = option && option.visualMap;\n\n    if (!isArray(visualMap)) {\n        visualMap = visualMap ? [visualMap] : [];\n    }\n\n    each$25(visualMap, function (opt) {\n        if (!opt) {\n            return;\n        }\n\n        // rename splitList to pieces\n        if (has$1(opt, 'splitList') && !has$1(opt, 'pieces')) {\n            opt.pieces = opt.splitList;\n            delete opt.splitList;\n        }\n\n        var pieces = opt.pieces;\n        if (pieces && isArray(pieces)) {\n            each$25(pieces, function (piece) {\n                if (isObject$1(piece)) {\n                    if (has$1(piece, 'start') && !has$1(piece, 'min')) {\n                        piece.min = piece.start;\n                    }\n                    if (has$1(piece, 'end') && !has$1(piece, 'max')) {\n                        piece.max = piece.end;\n                    }\n                }\n            });\n        }\n    });\n};\n\nfunction has$1(obj, name) {\n    return obj && obj.hasOwnProperty && obj.hasOwnProperty(name);\n}\n\nComponentModel.registerSubTypeDefaulter('visualMap', function (option) {\n    // Compatible with ec2, when splitNumber === 0, continuous visualMap will be used.\n    return (\n            !option.categories\n            && (\n                !(\n                    option.pieces\n                        ? option.pieces.length > 0\n                        : option.splitNumber > 0\n                )\n                || option.calculable\n            )\n        )\n        ? 'continuous' : 'piecewise';\n});\n\nvar VISUAL_PRIORITY = PRIORITY.VISUAL.COMPONENT;\n\nregisterVisual(VISUAL_PRIORITY, {\n    createOnAllSeries: true,\n    reset: function (seriesModel, ecModel) {\n        var resetDefines = [];\n        ecModel.eachComponent('visualMap', function (visualMapModel) {\n            if (!visualMapModel.isTargetSeries(seriesModel)) {\n                return;\n            }\n\n            resetDefines.push(incrementalApplyVisual(\n                visualMapModel.stateList,\n                visualMapModel.targetVisuals,\n                bind(visualMapModel.getValueState, visualMapModel),\n                visualMapModel.getDataDimension(seriesModel.getData())\n            ));\n        });\n\n        return resetDefines;\n    }\n});\n\n// Only support color.\nregisterVisual(VISUAL_PRIORITY, {\n    createOnAllSeries: true,\n    reset: function (seriesModel, ecModel) {\n        var data = seriesModel.getData();\n        var visualMetaList = [];\n\n        ecModel.eachComponent('visualMap', function (visualMapModel) {\n            if (visualMapModel.isTargetSeries(seriesModel)) {\n                var visualMeta = visualMapModel.getVisualMeta(\n                    bind(getColorVisual, null, seriesModel, visualMapModel)\n                ) || {stops: [], outerColors: []};\n\n                var concreteDim = visualMapModel.getDataDimension(data);\n                var dimInfo = data.getDimensionInfo(concreteDim);\n                if (dimInfo != null) {\n                    // visualMeta.dimension should be dimension index, but not concrete dimension.\n                    visualMeta.dimension = dimInfo.index;\n                    visualMetaList.push(visualMeta);\n                }\n            }\n        });\n\n        // console.log(JSON.stringify(visualMetaList.map(a => a.stops)));\n        seriesModel.getData().setVisual('visualMeta', visualMetaList);\n    }\n});\n\n// FIXME\n// performance and export for heatmap?\n// value can be Infinity or -Infinity\nfunction getColorVisual(seriesModel, visualMapModel, value, valueState) {\n    var mappings = visualMapModel.targetVisuals[valueState];\n    var visualTypes = VisualMapping.prepareVisualTypes(mappings);\n    var resultVisual = {\n        color: seriesModel.getData().getVisual('color') // default color.\n    };\n\n    for (var i = 0, len = visualTypes.length; i < len; i++) {\n        var type = visualTypes[i];\n        var mapping = mappings[\n            type === 'opacity' ? '__alphaForOpacity' : type\n        ];\n        mapping && mapping.applyVisual(value, getVisual, setVisual);\n    }\n\n    return resultVisual.color;\n\n    function getVisual(key) {\n        return resultVisual[key];\n    }\n\n    function setVisual(key, value) {\n        resultVisual[key] = value;\n    }\n}\n\n/**\n * @file Visual mapping.\n */\n\nvar visualDefault = {\n\n    /**\n     * @public\n     */\n    get: function (visualType, key, isCategory) {\n        var value = clone(\n            (defaultOption$3[visualType] || {})[key]\n        );\n\n        return isCategory\n            ? (isArray(value) ? value[value.length - 1] : value)\n            : value;\n    }\n\n};\n\nvar defaultOption$3 = {\n\n    color: {\n        active: ['#006edd', '#e0ffff'],\n        inactive: ['rgba(0,0,0,0)']\n    },\n\n    colorHue: {\n        active: [0, 360],\n        inactive: [0, 0]\n    },\n\n    colorSaturation: {\n        active: [0.3, 1],\n        inactive: [0, 0]\n    },\n\n    colorLightness: {\n        active: [0.9, 0.5],\n        inactive: [0, 0]\n    },\n\n    colorAlpha: {\n        active: [0.3, 1],\n        inactive: [0, 0]\n    },\n\n    opacity: {\n        active: [0.3, 1],\n        inactive: [0, 0]\n    },\n\n    symbol: {\n        active: ['circle', 'roundRect', 'diamond'],\n        inactive: ['none']\n    },\n\n    symbolSize: {\n        active: [10, 50],\n        inactive: [0, 0]\n    }\n};\n\nvar mapVisual$2 = VisualMapping.mapVisual;\nvar eachVisual = VisualMapping.eachVisual;\nvar isArray$3 = isArray;\nvar each$26 = each$1;\nvar asc$3 = asc;\nvar linearMap$3 = linearMap;\nvar noop$2 = noop;\n\nvar VisualMapModel = extendComponentModel({\n\n    type: 'visualMap',\n\n    dependencies: ['series'],\n\n    /**\n     * @readOnly\n     * @type {Array.<string>}\n     */\n    stateList: ['inRange', 'outOfRange'],\n\n    /**\n     * @readOnly\n     * @type {Array.<string>}\n     */\n    replacableOptionKeys: [\n        'inRange', 'outOfRange', 'target', 'controller', 'color'\n    ],\n\n    /**\n     * [lowerBound, upperBound]\n     *\n     * @readOnly\n     * @type {Array.<number>}\n     */\n    dataBound: [-Infinity, Infinity],\n\n    /**\n     * @readOnly\n     * @type {string|Object}\n     */\n    layoutMode: {type: 'box', ignoreSize: true},\n\n    /**\n     * @protected\n     */\n    defaultOption: {\n        show: true,\n\n        zlevel: 0,\n        z: 4,\n\n        seriesIndex: 'all',     // 'all' or null/undefined: all series.\n                                // A number or an array of number: the specified series.\n\n                                // set min: 0, max: 200, only for campatible with ec2.\n                                // In fact min max should not have default value.\n        min: 0,                 // min value, must specified if pieces is not specified.\n        max: 200,               // max value, must specified if pieces is not specified.\n\n        dimension: null,\n        inRange: null,          // 'color', 'colorHue', 'colorSaturation', 'colorLightness', 'colorAlpha',\n                                // 'symbol', 'symbolSize'\n        outOfRange: null,       // 'color', 'colorHue', 'colorSaturation',\n                                // 'colorLightness', 'colorAlpha',\n                                // 'symbol', 'symbolSize'\n\n        left: 0,                // 'center'  'left'  'right'  {number} (px)\n        right: null,            // The same as left.\n        top: null,              // 'top'  'bottom'  'center'  {number} (px)\n        bottom: 0,              // The same as top.\n\n        itemWidth: null,\n        itemHeight: null,\n        inverse: false,\n        orient: 'vertical',        // 'horizontal'  'vertical'\n\n        backgroundColor: 'rgba(0,0,0,0)',\n        borderColor: '#ccc',       // \n        contentColor: '#5793f3',\n        inactiveColor: '#aaa',\n        borderWidth: 0,            // px0\n        padding: 5,                // px5\n                                    // css\n        textGap: 10,               //\n        precision: 0,              // 0\n        color: null,               //deprecatedec2piecesinRange/outOfRange\n\n        formatter: null,\n        text: null,                // ['', '']ec2text[0]text[1]\n        textStyle: {\n            color: '#333'          // \n        }\n    },\n\n    /**\n     * @protected\n     */\n    init: function (option, parentModel, ecModel) {\n\n        /**\n         * @private\n         * @type {Array.<number>}\n         */\n        this._dataExtent;\n\n        /**\n         * @readOnly\n         */\n        this.targetVisuals = {};\n\n        /**\n         * @readOnly\n         */\n        this.controllerVisuals = {};\n\n        /**\n         * @readOnly\n         */\n        this.textStyleModel;\n\n        /**\n         * [width, height]\n         * @readOnly\n         * @type {Array.<number>}\n         */\n        this.itemSize;\n\n        this.mergeDefaultAndTheme(option, ecModel);\n    },\n\n    /**\n     * @protected\n     */\n    optionUpdated: function (newOption, isInit) {\n        var thisOption = this.option;\n\n        // FIXME\n        // necessary?\n        // Disable realtime view update if canvas is not supported.\n        if (!env$1.canvasSupported) {\n            thisOption.realtime = false;\n        }\n\n        !isInit && replaceVisualOption(\n            thisOption, newOption, this.replacableOptionKeys\n        );\n\n        this.textStyleModel = this.getModel('textStyle');\n\n        this.resetItemSize();\n\n        this.completeVisualOption();\n    },\n\n    /**\n     * @protected\n     */\n    resetVisual: function (supplementVisualOption) {\n        var stateList = this.stateList;\n        supplementVisualOption = bind(supplementVisualOption, this);\n\n        this.controllerVisuals = createVisualMappings(\n            this.option.controller, stateList, supplementVisualOption\n        );\n        this.targetVisuals = createVisualMappings(\n            this.option.target, stateList, supplementVisualOption\n        );\n    },\n\n    /**\n     * @protected\n     * @return {Array.<number>} An array of series indices.\n     */\n    getTargetSeriesIndices: function () {\n        var optionSeriesIndex = this.option.seriesIndex;\n        var seriesIndices = [];\n\n        if (optionSeriesIndex == null || optionSeriesIndex === 'all') {\n            this.ecModel.eachSeries(function (seriesModel, index) {\n                seriesIndices.push(index);\n            });\n        }\n        else {\n            seriesIndices = normalizeToArray(optionSeriesIndex);\n        }\n\n        return seriesIndices;\n    },\n\n    /**\n     * @public\n     */\n    eachTargetSeries: function (callback, context) {\n        each$1(this.getTargetSeriesIndices(), function (seriesIndex) {\n            callback.call(context, this.ecModel.getSeriesByIndex(seriesIndex));\n        }, this);\n    },\n\n    /**\n     * @pubilc\n     */\n    isTargetSeries: function (seriesModel) {\n        var is = false;\n        this.eachTargetSeries(function (model) {\n            model === seriesModel && (is = true);\n        });\n        return is;\n    },\n\n    /**\n     * @example\n     * this.formatValueText(someVal); // format single numeric value to text.\n     * this.formatValueText(someVal, true); // format single category value to text.\n     * this.formatValueText([min, max]); // format numeric min-max to text.\n     * this.formatValueText([this.dataBound[0], max]); // using data lower bound.\n     * this.formatValueText([min, this.dataBound[1]]); // using data upper bound.\n     *\n     * @param {number|Array.<number>} value Real value, or this.dataBound[0 or 1].\n     * @param {boolean} [isCategory=false] Only available when value is number.\n     * @param {Array.<string>} edgeSymbols Open-close symbol when value is interval.\n     * @return {string}\n     * @protected\n     */\n    formatValueText: function(value, isCategory, edgeSymbols) {\n        var option = this.option;\n        var precision = option.precision;\n        var dataBound = this.dataBound;\n        var formatter = option.formatter;\n        var isMinMax;\n        var textValue;\n        edgeSymbols = edgeSymbols || ['<', '>'];\n\n        if (isArray(value)) {\n            value = value.slice();\n            isMinMax = true;\n        }\n\n        textValue = isCategory\n            ? value\n            : (isMinMax\n                ? [toFixed(value[0]), toFixed(value[1])]\n                : toFixed(value)\n            );\n\n        if (isString(formatter)) {\n            return formatter\n                .replace('{value}', isMinMax ? textValue[0] : textValue)\n                .replace('{value2}', isMinMax ? textValue[1] : textValue);\n        }\n        else if (isFunction$1(formatter)) {\n            return isMinMax\n                ? formatter(value[0], value[1])\n                : formatter(value);\n        }\n\n        if (isMinMax) {\n            if (value[0] === dataBound[0]) {\n                return edgeSymbols[0] + ' ' + textValue[1];\n            }\n            else if (value[1] === dataBound[1]) {\n                return edgeSymbols[1] + ' ' + textValue[0];\n            }\n            else {\n                return textValue[0] + ' - ' + textValue[1];\n            }\n        }\n        else { // Format single value (includes category case).\n            return textValue;\n        }\n\n        function toFixed(val) {\n            return val === dataBound[0]\n                ? 'min'\n                : val === dataBound[1]\n                ? 'max'\n                : (+val).toFixed(Math.min(precision, 20));\n        }\n    },\n\n    /**\n     * @protected\n     */\n    resetExtent: function () {\n        var thisOption = this.option;\n\n        // Can not calculate data extent by data here.\n        // Because series and data may be modified in processing stage.\n        // So we do not support the feature \"auto min/max\".\n\n        var extent = asc$3([thisOption.min, thisOption.max]);\n\n        this._dataExtent = extent;\n    },\n\n    /**\n     * @public\n     * @param {module:echarts/data/List} list\n     * @return {string} Concrete dimention. If return null/undefined,\n     *                  no dimension used.\n     */\n    getDataDimension: function (list) {\n        var optDim = this.option.dimension;\n        var listDimensions = list.dimensions;\n        if (optDim == null && !listDimensions.length) {\n            return;\n        }\n\n        if (optDim != null) {\n            return list.getDimension(optDim);\n        }\n\n        var dimNames = list.dimensions;\n        for (var i = dimNames.length - 1; i >= 0; i--) {\n            var dimName = dimNames[i];\n            var dimInfo = list.getDimensionInfo(dimName);\n            if (!dimInfo.isCalculationCoord) {\n                return dimName;\n            }\n        }\n    },\n\n    /**\n     * @public\n     * @override\n     */\n    getExtent: function () {\n        return this._dataExtent.slice();\n    },\n\n    /**\n     * @protected\n     */\n    completeVisualOption: function () {\n        var ecModel = this.ecModel;\n        var thisOption = this.option;\n        var base = {inRange: thisOption.inRange, outOfRange: thisOption.outOfRange};\n\n        var target = thisOption.target || (thisOption.target = {});\n        var controller = thisOption.controller || (thisOption.controller = {});\n\n        merge(target, base); // Do not override\n        merge(controller, base); // Do not override\n\n        var isCategory = this.isCategory();\n\n        completeSingle.call(this, target);\n        completeSingle.call(this, controller);\n        completeInactive.call(this, target, 'inRange', 'outOfRange');\n        // completeInactive.call(this, target, 'outOfRange', 'inRange');\n        completeController.call(this, controller);\n\n        function completeSingle(base) {\n            // Compatible with ec2 dataRange.color.\n            // The mapping order of dataRange.color is: [high value, ..., low value]\n            // whereas inRange.color and outOfRange.color is [low value, ..., high value]\n            // Notice: ec2 has no inverse.\n            if (isArray$3(thisOption.color)\n                // If there has been inRange: {symbol: ...}, adding color is a mistake.\n                // So adding color only when no inRange defined.\n                && !base.inRange\n            ) {\n                base.inRange = {color: thisOption.color.slice().reverse()};\n            }\n\n            // Compatible with previous logic, always give a defautl color, otherwise\n            // simple config with no inRange and outOfRange will not work.\n            // Originally we use visualMap.color as the default color, but setOption at\n            // the second time the default color will be erased. So we change to use\n            // constant DEFAULT_COLOR.\n            // If user do not want the defualt color, set inRange: {color: null}.\n            base.inRange = base.inRange || {color: ecModel.get('gradientColor')};\n\n            // If using shortcut like: {inRange: 'symbol'}, complete default value.\n            each$26(this.stateList, function (state) {\n                var visualType = base[state];\n\n                if (isString(visualType)) {\n                    var defa = visualDefault.get(visualType, 'active', isCategory);\n                    if (defa) {\n                        base[state] = {};\n                        base[state][visualType] = defa;\n                    }\n                    else {\n                        // Mark as not specified.\n                        delete base[state];\n                    }\n                }\n            }, this);\n        }\n\n        function completeInactive(base, stateExist, stateAbsent) {\n            var optExist = base[stateExist];\n            var optAbsent = base[stateAbsent];\n\n            if (optExist && !optAbsent) {\n                optAbsent = base[stateAbsent] = {};\n                each$26(optExist, function (visualData, visualType) {\n                    if (!VisualMapping.isValidType(visualType)) {\n                        return;\n                    }\n\n                    var defa = visualDefault.get(visualType, 'inactive', isCategory);\n\n                    if (defa != null) {\n                        optAbsent[visualType] = defa;\n\n                        // Compatibable with ec2:\n                        // Only inactive color to rgba(0,0,0,0) can not\n                        // make label transparent, so use opacity also.\n                        if (visualType === 'color'\n                            && !optAbsent.hasOwnProperty('opacity')\n                            && !optAbsent.hasOwnProperty('colorAlpha')\n                        ) {\n                            optAbsent.opacity = [0, 0];\n                        }\n                    }\n                });\n            }\n        }\n\n        function completeController(controller) {\n            var symbolExists = (controller.inRange || {}).symbol\n                || (controller.outOfRange || {}).symbol;\n            var symbolSizeExists = (controller.inRange || {}).symbolSize\n                || (controller.outOfRange || {}).symbolSize;\n            var inactiveColor = this.get('inactiveColor');\n\n            each$26(this.stateList, function (state) {\n\n                var itemSize = this.itemSize;\n                var visuals = controller[state];\n\n                // Set inactive color for controller if no other color\n                // attr (like colorAlpha) specified.\n                if (!visuals) {\n                    visuals = controller[state] = {\n                        color: isCategory ? inactiveColor : [inactiveColor]\n                    };\n                }\n\n                // Consistent symbol and symbolSize if not specified.\n                if (visuals.symbol == null) {\n                    visuals.symbol = symbolExists\n                        && clone(symbolExists)\n                        || (isCategory ? 'roundRect' : ['roundRect']);\n                }\n                if (visuals.symbolSize == null) {\n                    visuals.symbolSize = symbolSizeExists\n                        && clone(symbolSizeExists)\n                        || (isCategory ? itemSize[0] : [itemSize[0], itemSize[0]]);\n                }\n\n                // Filter square and none.\n                visuals.symbol = mapVisual$2(visuals.symbol, function (symbol) {\n                    return (symbol === 'none' || symbol === 'square') ? 'roundRect' : symbol;\n                });\n\n                // Normalize symbolSize\n                var symbolSize = visuals.symbolSize;\n\n                if (symbolSize != null) {\n                    var max = -Infinity;\n                    // symbolSize can be object when categories defined.\n                    eachVisual(symbolSize, function (value) {\n                        value > max && (max = value);\n                    });\n                    visuals.symbolSize = mapVisual$2(symbolSize, function (value) {\n                        return linearMap$3(value, [0, max], [0, itemSize[0]], true);\n                    });\n                }\n\n            }, this);\n        }\n    },\n\n    /**\n     * @protected\n     */\n    resetItemSize: function () {\n        this.itemSize = [\n            parseFloat(this.get('itemWidth')),\n            parseFloat(this.get('itemHeight'))\n        ];\n    },\n\n    /**\n     * @public\n     */\n    isCategory: function () {\n        return !!this.option.categories;\n    },\n\n    /**\n     * @public\n     * @abstract\n     */\n    setSelected: noop$2,\n\n    /**\n     * @public\n     * @abstract\n     * @param {*|module:echarts/data/List} valueOrData\n     * @param {number} dataIndex\n     * @return {string} state See this.stateList\n     */\n    getValueState: noop$2,\n\n    /**\n     * FIXME\n     * Do not publish to thirt-part-dev temporarily\n     * util the interface is stable. (Should it return\n     * a function but not visual meta?)\n     *\n     * @pubilc\n     * @abstract\n     * @param {Function} getColorVisual\n     *        params: value, valueState\n     *        return: color\n     * @return {Object} visualMeta\n     *        should includes {stops, outerColors}\n     *        outerColor means [colorBeyondMinValue, colorBeyondMaxValue]\n     */\n    getVisualMeta: noop$2\n\n});\n\n// Constant\nvar DEFAULT_BAR_BOUND = [20, 140];\n\nvar ContinuousModel = VisualMapModel.extend({\n\n    type: 'visualMap.continuous',\n\n    /**\n     * @protected\n     */\n    defaultOption: {\n        align: 'auto',          // 'auto', 'left', 'right', 'top', 'bottom'\n        calculable: false,      // This prop effect default component type determine,\n                                // See echarts/component/visualMap/typeDefaulter.\n        range: null,            // selected range. In default case `range` is [min, max]\n                                // and can auto change along with modification of min max,\n                                // util use specifid a range.\n        realtime: true,         // Whether realtime update.\n        itemHeight: null,       // The length of the range control edge.\n        itemWidth: null,        // The length of the other side.\n        hoverLink: true,        // Enable hover highlight.\n        hoverLinkDataSize: null,// The size of hovered data.\n        hoverLinkOnHandle: null // Whether trigger hoverLink when hover handle.\n                                // If not specified, follow the value of `realtime`.\n    },\n\n    /**\n     * @override\n     */\n    optionUpdated: function (newOption, isInit) {\n        ContinuousModel.superApply(this, 'optionUpdated', arguments);\n\n        this.resetExtent();\n\n        this.resetVisual(function (mappingOption) {\n            mappingOption.mappingMethod = 'linear';\n            mappingOption.dataExtent = this.getExtent();\n        });\n\n        this._resetRange();\n    },\n\n    /**\n     * @protected\n     * @override\n     */\n    resetItemSize: function () {\n        ContinuousModel.superApply(this, 'resetItemSize', arguments);\n\n        var itemSize = this.itemSize;\n\n        this._orient === 'horizontal' && itemSize.reverse();\n\n        (itemSize[0] == null || isNaN(itemSize[0])) && (itemSize[0] = DEFAULT_BAR_BOUND[0]);\n        (itemSize[1] == null || isNaN(itemSize[1])) && (itemSize[1] = DEFAULT_BAR_BOUND[1]);\n    },\n\n    /**\n     * @private\n     */\n    _resetRange: function () {\n        var dataExtent = this.getExtent();\n        var range = this.option.range;\n\n        if (!range || range.auto) {\n            // `range` should always be array (so we dont use other\n            // value like 'auto') for user-friend. (consider getOption).\n            dataExtent.auto = 1;\n            this.option.range = dataExtent;\n        }\n        else if (isArray(range)) {\n            if (range[0] > range[1]) {\n                range.reverse();\n            }\n            range[0] = Math.max(range[0], dataExtent[0]);\n            range[1] = Math.min(range[1], dataExtent[1]);\n        }\n    },\n\n    /**\n     * @protected\n     * @override\n     */\n    completeVisualOption: function () {\n        VisualMapModel.prototype.completeVisualOption.apply(this, arguments);\n\n        each$1(this.stateList, function (state) {\n            var symbolSize = this.option.controller[state].symbolSize;\n            if (symbolSize && symbolSize[0] !== symbolSize[1]) {\n                symbolSize[0] = 0; // For good looking.\n            }\n        }, this);\n    },\n\n    /**\n     * @override\n     */\n    setSelected: function (selected) {\n        this.option.range = selected.slice();\n        this._resetRange();\n    },\n\n    /**\n     * @public\n     */\n    getSelected: function () {\n        var dataExtent = this.getExtent();\n\n        var dataInterval = asc(\n            (this.get('range') || []).slice()\n        );\n\n        // Clamp\n        dataInterval[0] > dataExtent[1] && (dataInterval[0] = dataExtent[1]);\n        dataInterval[1] > dataExtent[1] && (dataInterval[1] = dataExtent[1]);\n        dataInterval[0] < dataExtent[0] && (dataInterval[0] = dataExtent[0]);\n        dataInterval[1] < dataExtent[0] && (dataInterval[1] = dataExtent[0]);\n\n        return dataInterval;\n    },\n\n    /**\n     * @override\n     */\n    getValueState: function (value) {\n        var range = this.option.range;\n        var dataExtent = this.getExtent();\n\n        // When range[0] === dataExtent[0], any value larger than dataExtent[0] maps to 'inRange'.\n        // range[1] is processed likewise.\n        return (\n            (range[0] <= dataExtent[0] || range[0] <= value)\n            && (range[1] >= dataExtent[1] || value <= range[1])\n        ) ? 'inRange' : 'outOfRange';\n    },\n\n    /**\n     * @params {Array.<number>} range target value: range[0] <= value && value <= range[1]\n     * @return {Array.<Object>} [{seriesId, dataIndices: <Array.<number>>}, ...]\n     */\n    findTargetDataIndices: function (range) {\n        var result = [];\n\n        this.eachTargetSeries(function (seriesModel) {\n            var dataIndices = [];\n            var data = seriesModel.getData();\n\n            data.each(this.getDataDimension(data), function (value, dataIndex) {\n                range[0] <= value && value <= range[1] && dataIndices.push(dataIndex);\n            }, this);\n\n            result.push({seriesId: seriesModel.id, dataIndex: dataIndices});\n        }, this);\n\n        return result;\n    },\n\n    /**\n     * @implement\n     */\n    getVisualMeta: function (getColorVisual) {\n        var oVals = getColorStopValues(this, 'outOfRange', this.getExtent());\n        var iVals = getColorStopValues(this, 'inRange', this.option.range.slice());\n        var stops = [];\n\n        function setStop(value, valueState) {\n            stops.push({\n                value: value,\n                color: getColorVisual(value, valueState)\n            });\n        }\n\n        // Format to: outOfRange -- inRange -- outOfRange.\n        var iIdx = 0;\n        var oIdx = 0;\n        var iLen = iVals.length;\n        var oLen = oVals.length;\n\n        for (; oIdx < oLen && (!iVals.length || oVals[oIdx] <= iVals[0]); oIdx++) {\n            // If oVal[oIdx] === iVals[iIdx], oVal[oIdx] should be ignored.\n            if (oVals[oIdx] < iVals[iIdx]) {\n                setStop(oVals[oIdx], 'outOfRange');\n            }\n        }\n        for (var first = 1; iIdx < iLen; iIdx++, first = 0) {\n            // If range is full, value beyond min, max will be clamped.\n            // make a singularity\n            first && stops.length && setStop(iVals[iIdx], 'outOfRange');\n            setStop(iVals[iIdx], 'inRange');\n        }\n        for (var first = 1; oIdx < oLen; oIdx++) {\n            if (!iVals.length || iVals[iVals.length - 1] < oVals[oIdx]) {\n                // make a singularity\n                if (first) {\n                    stops.length && setStop(stops[stops.length - 1].value, 'outOfRange');\n                    first = 0;\n                }\n                setStop(oVals[oIdx], 'outOfRange');\n            }\n        }\n\n        var stopsLen = stops.length;\n\n        return {\n            stops: stops,\n            outerColors: [\n                stopsLen ? stops[0].color : 'transparent',\n                stopsLen ? stops[stopsLen - 1].color : 'transparent'\n            ]\n        };\n    }\n\n});\n\nfunction getColorStopValues(visualMapModel, valueState, dataExtent) {\n    if (dataExtent[0] === dataExtent[1]) {\n        return dataExtent.slice();\n    }\n\n    // When using colorHue mapping, it is not linear color any more.\n    // Moreover, canvas gradient seems not to be accurate linear.\n    // FIXME\n    // Should be arbitrary value 100? or based on pixel size?\n    var count = 200;\n    var step = (dataExtent[1] - dataExtent[0]) / count;\n\n    var value = dataExtent[0];\n    var stopValues = [];\n    for (var i = 0; i <= count && value < dataExtent[1]; i++) {\n        stopValues.push(value);\n        value += step;\n    }\n    stopValues.push(dataExtent[1]);\n\n    return stopValues;\n}\n\nvar VisualMapView = extendComponentView({\n\n    type: 'visualMap',\n\n    /**\n     * @readOnly\n     * @type {Object}\n     */\n    autoPositionValues: {left: 1, right: 1, top: 1, bottom: 1},\n\n    init: function (ecModel, api) {\n        /**\n         * @readOnly\n         * @type {module:echarts/model/Global}\n         */\n        this.ecModel = ecModel;\n\n        /**\n         * @readOnly\n         * @type {module:echarts/ExtensionAPI}\n         */\n        this.api = api;\n\n        /**\n         * @readOnly\n         * @type {module:echarts/component/visualMap/visualMapModel}\n         */\n        this.visualMapModel;\n    },\n\n    /**\n     * @protected\n     */\n    render: function (visualMapModel, ecModel, api, payload) {\n        this.visualMapModel = visualMapModel;\n\n        if (visualMapModel.get('show') === false) {\n            this.group.removeAll();\n            return;\n        }\n\n        this.doRender.apply(this, arguments);\n    },\n\n    /**\n     * @protected\n     */\n    renderBackground: function (group) {\n        var visualMapModel = this.visualMapModel;\n        var padding = normalizeCssArray$1(visualMapModel.get('padding') || 0);\n        var rect = group.getBoundingRect();\n\n        group.add(new Rect({\n            z2: -1, // Lay background rect on the lowest layer.\n            silent: true,\n            shape: {\n                x: rect.x - padding[3],\n                y: rect.y - padding[0],\n                width: rect.width + padding[3] + padding[1],\n                height: rect.height + padding[0] + padding[2]\n            },\n            style: {\n                fill: visualMapModel.get('backgroundColor'),\n                stroke: visualMapModel.get('borderColor'),\n                lineWidth: visualMapModel.get('borderWidth')\n            }\n        }));\n    },\n\n    /**\n     * @protected\n     * @param {number} targetValue can be Infinity or -Infinity\n     * @param {string=} visualCluster Only can be 'color' 'opacity' 'symbol' 'symbolSize'\n     * @param {Object} [opts]\n     * @param {string=} [opts.forceState] Specify state, instead of using getValueState method.\n     * @param {string=} [opts.convertOpacityToAlpha=false] For color gradient in controller widget.\n     * @return {*} Visual value.\n     */\n    getControllerVisual: function (targetValue, visualCluster, opts) {\n        opts = opts || {};\n\n        var forceState = opts.forceState;\n        var visualMapModel = this.visualMapModel;\n        var visualObj = {};\n\n        // Default values.\n        if (visualCluster === 'symbol') {\n            visualObj.symbol = visualMapModel.get('itemSymbol');\n        }\n        if (visualCluster === 'color') {\n            var defaultColor = visualMapModel.get('contentColor');\n            visualObj.color = defaultColor;\n        }\n\n        function getter(key) {\n            return visualObj[key];\n        }\n\n        function setter(key, value) {\n            visualObj[key] = value;\n        }\n\n        var mappings = visualMapModel.controllerVisuals[\n            forceState || visualMapModel.getValueState(targetValue)\n        ];\n        var visualTypes = VisualMapping.prepareVisualTypes(mappings);\n\n        each$1(visualTypes, function (type) {\n            var visualMapping = mappings[type];\n            if (opts.convertOpacityToAlpha && type === 'opacity') {\n                type = 'colorAlpha';\n                visualMapping = mappings.__alphaForOpacity;\n            }\n            if (VisualMapping.dependsOn(type, visualCluster)) {\n                visualMapping && visualMapping.applyVisual(\n                    targetValue, getter, setter\n                );\n            }\n        });\n\n        return visualObj[visualCluster];\n    },\n\n    /**\n     * @protected\n     */\n    positionGroup: function (group) {\n        var model = this.visualMapModel;\n        var api = this.api;\n\n        positionElement(\n            group,\n            model.getBoxLayoutParams(),\n            {width: api.getWidth(), height: api.getHeight()}\n        );\n    },\n\n    /**\n     * @protected\n     * @abstract\n     */\n    doRender: noop\n\n});\n\n/**\n * @param {module:echarts/component/visualMap/VisualMapModel} visualMapModel\\\n * @param {module:echarts/ExtensionAPI} api\n * @param {Array.<number>} itemSize always [short, long]\n * @return {string} 'left' or 'right' or 'top' or 'bottom'\n */\nfunction getItemAlign(visualMapModel, api, itemSize) {\n    var modelOption = visualMapModel.option;\n    var itemAlign = modelOption.align;\n\n    if (itemAlign != null && itemAlign !== 'auto') {\n        return itemAlign;\n    }\n\n    // Auto decision align.\n    var ecSize = {width: api.getWidth(), height: api.getHeight()};\n    var realIndex = modelOption.orient === 'horizontal' ? 1 : 0;\n\n    var paramsSet = [\n        ['left', 'right', 'width'],\n        ['top', 'bottom', 'height']\n    ];\n    var reals = paramsSet[realIndex];\n    var fakeValue = [0, null, 10];\n\n    var layoutInput = {};\n    for (var i = 0; i < 3; i++) {\n        layoutInput[paramsSet[1 - realIndex][i]] = fakeValue[i];\n        layoutInput[reals[i]] = i === 2 ? itemSize[0] : modelOption[reals[i]];\n    }\n\n    var rParam = [['x', 'width', 3], ['y', 'height', 0]][realIndex];\n    var rect = getLayoutRect(layoutInput, ecSize, modelOption.padding);\n\n    return reals[\n        (rect.margin[rParam[2]] || 0) + rect[rParam[0]] + rect[rParam[1]] * 0.5\n            < ecSize[rParam[1]] * 0.5 ? 0 : 1\n    ];\n}\n\n/**\n * Prepare dataIndex for outside usage, where dataIndex means rawIndex, and\n * dataIndexInside means filtered index.\n */\nfunction convertDataIndex(batch) {\n    each$1(batch || [], function (batchItem) {\n        if (batch.dataIndex != null) {\n            batch.dataIndexInside = batch.dataIndex;\n            batch.dataIndex = null;\n        }\n    });\n    return batch;\n}\n\nvar linearMap$4 = linearMap;\nvar each$27 = each$1;\nvar mathMin$7 = Math.min;\nvar mathMax$7 = Math.max;\n\n// Arbitrary value\nvar HOVER_LINK_SIZE = 12;\nvar HOVER_LINK_OUT = 6;\n\n// Notice:\n// Any \"interval\" should be by the order of [low, high].\n// \"handle0\" (handleIndex === 0) maps to\n// low data value: this._dataInterval[0] and has low coord.\n// \"handle1\" (handleIndex === 1) maps to\n// high data value: this._dataInterval[1] and has high coord.\n// The logic of transform is implemented in this._createBarGroup.\n\nvar ContinuousView = VisualMapView.extend({\n\n    type: 'visualMap.continuous',\n\n    /**\n     * @override\n     */\n    init: function () {\n\n        ContinuousView.superApply(this, 'init', arguments);\n\n        /**\n         * @private\n         */\n        this._shapes = {};\n\n        /**\n         * @private\n         */\n        this._dataInterval = [];\n\n        /**\n         * @private\n         */\n        this._handleEnds = [];\n\n        /**\n         * @private\n         */\n        this._orient;\n\n        /**\n         * @private\n         */\n        this._useHandle;\n\n        /**\n         * @private\n         */\n        this._hoverLinkDataIndices = [];\n\n        /**\n         * @private\n         */\n        this._dragging;\n\n        /**\n         * @private\n         */\n        this._hovering;\n    },\n\n    /**\n     * @protected\n     * @override\n     */\n    doRender: function (visualMapModel, ecModel, api, payload) {\n        if (!payload || payload.type !== 'selectDataRange' || payload.from !== this.uid) {\n            this._buildView();\n        }\n    },\n\n    /**\n     * @private\n     */\n    _buildView: function () {\n        this.group.removeAll();\n\n        var visualMapModel = this.visualMapModel;\n        var thisGroup = this.group;\n\n        this._orient = visualMapModel.get('orient');\n        this._useHandle = visualMapModel.get('calculable');\n\n        this._resetInterval();\n\n        this._renderBar(thisGroup);\n\n        var dataRangeText = visualMapModel.get('text');\n        this._renderEndsText(thisGroup, dataRangeText, 0);\n        this._renderEndsText(thisGroup, dataRangeText, 1);\n\n        // Do this for background size calculation.\n        this._updateView(true);\n\n        // After updating view, inner shapes is built completely,\n        // and then background can be rendered.\n        this.renderBackground(thisGroup);\n\n        // Real update view\n        this._updateView();\n\n        this._enableHoverLinkToSeries();\n        this._enableHoverLinkFromSeries();\n\n        this.positionGroup(thisGroup);\n    },\n\n    /**\n     * @private\n     */\n    _renderEndsText: function (group, dataRangeText, endsIndex) {\n        if (!dataRangeText) {\n            return;\n        }\n\n        // Compatible with ec2, text[0] map to high value, text[1] map low value.\n        var text = dataRangeText[1 - endsIndex];\n        text = text != null ? text + '' : '';\n\n        var visualMapModel = this.visualMapModel;\n        var textGap = visualMapModel.get('textGap');\n        var itemSize = visualMapModel.itemSize;\n\n        var barGroup = this._shapes.barGroup;\n        var position = this._applyTransform(\n            [\n                itemSize[0] / 2,\n                endsIndex === 0 ? -textGap : itemSize[1] + textGap\n            ],\n            barGroup\n        );\n        var align = this._applyTransform(\n            endsIndex === 0 ? 'bottom' : 'top',\n            barGroup\n        );\n        var orient = this._orient;\n        var textStyleModel = this.visualMapModel.textStyleModel;\n\n        this.group.add(new Text({\n            style: {\n                x: position[0],\n                y: position[1],\n                textVerticalAlign: orient === 'horizontal' ? 'middle' : align,\n                textAlign: orient === 'horizontal' ? align : 'center',\n                text: text,\n                textFont: textStyleModel.getFont(),\n                textFill: textStyleModel.getTextColor()\n            }\n        }));\n    },\n\n    /**\n     * @private\n     */\n    _renderBar: function (targetGroup) {\n        var visualMapModel = this.visualMapModel;\n        var shapes = this._shapes;\n        var itemSize = visualMapModel.itemSize;\n        var orient = this._orient;\n        var useHandle = this._useHandle;\n        var itemAlign = getItemAlign(visualMapModel, this.api, itemSize);\n        var barGroup = shapes.barGroup = this._createBarGroup(itemAlign);\n\n        // Bar\n        barGroup.add(shapes.outOfRange = createPolygon());\n        barGroup.add(shapes.inRange = createPolygon(\n            null,\n            useHandle ? getCursor$1(this._orient) : null,\n            bind(this._dragHandle, this, 'all', false),\n            bind(this._dragHandle, this, 'all', true)\n        ));\n\n        var textRect = visualMapModel.textStyleModel.getTextRect('');\n        var textSize = mathMax$7(textRect.width, textRect.height);\n\n        // Handle\n        if (useHandle) {\n            shapes.handleThumbs = [];\n            shapes.handleLabels = [];\n            shapes.handleLabelPoints = [];\n\n            this._createHandle(barGroup, 0, itemSize, textSize, orient, itemAlign);\n            this._createHandle(barGroup, 1, itemSize, textSize, orient, itemAlign);\n        }\n\n        this._createIndicator(barGroup, itemSize, textSize, orient);\n\n        targetGroup.add(barGroup);\n    },\n\n    /**\n     * @private\n     */\n    _createHandle: function (barGroup, handleIndex, itemSize, textSize, orient) {\n        var onDrift = bind(this._dragHandle, this, handleIndex, false);\n        var onDragEnd = bind(this._dragHandle, this, handleIndex, true);\n        var handleThumb = createPolygon(\n            createHandlePoints(handleIndex, textSize),\n            getCursor$1(this._orient),\n            onDrift,\n            onDragEnd\n        );\n        handleThumb.position[0] = itemSize[0];\n        barGroup.add(handleThumb);\n\n        // Text is always horizontal layout but should not be effected by\n        // transform (orient/inverse). So label is built separately but not\n        // use zrender/graphic/helper/RectText, and is located based on view\n        // group (according to handleLabelPoint) but not barGroup.\n        var textStyleModel = this.visualMapModel.textStyleModel;\n        var handleLabel = new Text({\n            draggable: true,\n            drift: onDrift,\n            onmousemove: function (e) {\n                // Fot mobile devicem, prevent screen slider on the button.\n                stop(e.event);\n            },\n            ondragend: onDragEnd,\n            style: {\n                x: 0, y: 0, text: '',\n                textFont: textStyleModel.getFont(),\n                textFill: textStyleModel.getTextColor()\n            }\n        });\n        this.group.add(handleLabel);\n\n        var handleLabelPoint = [\n            orient === 'horizontal'\n                ? textSize / 2\n                : textSize * 1.5,\n            orient === 'horizontal'\n                ? (handleIndex === 0 ? -(textSize * 1.5) : (textSize * 1.5))\n                : (handleIndex === 0 ? -textSize / 2 : textSize / 2)\n        ];\n\n        var shapes = this._shapes;\n        shapes.handleThumbs[handleIndex] = handleThumb;\n        shapes.handleLabelPoints[handleIndex] = handleLabelPoint;\n        shapes.handleLabels[handleIndex] = handleLabel;\n    },\n\n    /**\n     * @private\n     */\n    _createIndicator: function (barGroup, itemSize, textSize, orient) {\n        var indicator = createPolygon([[0, 0]], 'move');\n        indicator.position[0] = itemSize[0];\n        indicator.attr({invisible: true, silent: true});\n        barGroup.add(indicator);\n\n        var textStyleModel = this.visualMapModel.textStyleModel;\n        var indicatorLabel = new Text({\n            silent: true,\n            invisible: true,\n            style: {\n                x: 0, y: 0, text: '',\n                textFont: textStyleModel.getFont(),\n                textFill: textStyleModel.getTextColor()\n            }\n        });\n        this.group.add(indicatorLabel);\n\n        var indicatorLabelPoint = [\n            orient === 'horizontal' ? textSize / 2 : HOVER_LINK_OUT + 3,\n            0\n        ];\n\n        var shapes = this._shapes;\n        shapes.indicator = indicator;\n        shapes.indicatorLabel = indicatorLabel;\n        shapes.indicatorLabelPoint = indicatorLabelPoint;\n    },\n\n    /**\n     * @private\n     */\n    _dragHandle: function (handleIndex, isEnd, dx, dy) {\n        if (!this._useHandle) {\n            return;\n        }\n\n        this._dragging = !isEnd;\n\n        if (!isEnd) {\n            // Transform dx, dy to bar coordination.\n            var vertex = this._applyTransform([dx, dy], this._shapes.barGroup, true);\n            this._updateInterval(handleIndex, vertex[1]);\n\n            // Considering realtime, update view should be executed\n            // before dispatch action.\n            this._updateView();\n        }\n\n        // dragEnd do not dispatch action when realtime.\n        if (isEnd === !this.visualMapModel.get('realtime')) { // jshint ignore:line\n            this.api.dispatchAction({\n                type: 'selectDataRange',\n                from: this.uid,\n                visualMapId: this.visualMapModel.id,\n                selected: this._dataInterval.slice()\n            });\n        }\n\n        if (isEnd) {\n            !this._hovering && this._clearHoverLinkToSeries();\n        }\n        else if (useHoverLinkOnHandle(this.visualMapModel)) {\n            this._doHoverLinkToSeries(this._handleEnds[handleIndex], false);\n        }\n    },\n\n    /**\n     * @private\n     */\n    _resetInterval: function () {\n        var visualMapModel = this.visualMapModel;\n\n        var dataInterval = this._dataInterval = visualMapModel.getSelected();\n        var dataExtent = visualMapModel.getExtent();\n        var sizeExtent = [0, visualMapModel.itemSize[1]];\n\n        this._handleEnds = [\n            linearMap$4(dataInterval[0], dataExtent, sizeExtent, true),\n            linearMap$4(dataInterval[1], dataExtent, sizeExtent, true)\n        ];\n    },\n\n    /**\n     * @private\n     * @param {(number|string)} handleIndex 0 or 1 or 'all'\n     * @param {number} dx\n     * @param {number} dy\n     */\n    _updateInterval: function (handleIndex, delta) {\n        delta = delta || 0;\n        var visualMapModel = this.visualMapModel;\n        var handleEnds = this._handleEnds;\n        var sizeExtent = [0, visualMapModel.itemSize[1]];\n\n        sliderMove(\n            delta,\n            handleEnds,\n            sizeExtent,\n            handleIndex,\n            // cross is forbiden\n            0\n        );\n\n        var dataExtent = visualMapModel.getExtent();\n        // Update data interval.\n        this._dataInterval = [\n            linearMap$4(handleEnds[0], sizeExtent, dataExtent, true),\n            linearMap$4(handleEnds[1], sizeExtent, dataExtent, true)\n        ];\n    },\n\n    /**\n     * @private\n     */\n    _updateView: function (forSketch) {\n        var visualMapModel = this.visualMapModel;\n        var dataExtent = visualMapModel.getExtent();\n        var shapes = this._shapes;\n\n        var outOfRangeHandleEnds = [0, visualMapModel.itemSize[1]];\n        var inRangeHandleEnds = forSketch ? outOfRangeHandleEnds : this._handleEnds;\n\n        var visualInRange = this._createBarVisual(\n            this._dataInterval, dataExtent, inRangeHandleEnds, 'inRange'\n        );\n        var visualOutOfRange = this._createBarVisual(\n            dataExtent, dataExtent, outOfRangeHandleEnds, 'outOfRange'\n        );\n\n        shapes.inRange\n            .setStyle({\n                fill: visualInRange.barColor,\n                opacity: visualInRange.opacity\n            })\n            .setShape('points', visualInRange.barPoints);\n        shapes.outOfRange\n            .setStyle({\n                fill: visualOutOfRange.barColor,\n                opacity: visualOutOfRange.opacity\n            })\n            .setShape('points', visualOutOfRange.barPoints);\n\n        this._updateHandle(inRangeHandleEnds, visualInRange);\n    },\n\n    /**\n     * @private\n     */\n    _createBarVisual: function (dataInterval, dataExtent, handleEnds, forceState) {\n        var opts = {\n            forceState: forceState,\n            convertOpacityToAlpha: true\n        };\n        var colorStops = this._makeColorGradient(dataInterval, opts);\n\n        var symbolSizes = [\n            this.getControllerVisual(dataInterval[0], 'symbolSize', opts),\n            this.getControllerVisual(dataInterval[1], 'symbolSize', opts)\n        ];\n        var barPoints = this._createBarPoints(handleEnds, symbolSizes);\n\n        return {\n            barColor: new LinearGradient(0, 0, 0, 1, colorStops),\n            barPoints: barPoints,\n            handlesColor: [\n                colorStops[0].color,\n                colorStops[colorStops.length - 1].color\n            ]\n        };\n    },\n\n    /**\n     * @private\n     */\n    _makeColorGradient: function (dataInterval, opts) {\n        // Considering colorHue, which is not linear, so we have to sample\n        // to calculate gradient color stops, but not only caculate head\n        // and tail.\n        var sampleNumber = 100; // Arbitrary value.\n        var colorStops = [];\n        var step = (dataInterval[1] - dataInterval[0]) / sampleNumber;\n\n        colorStops.push({\n            color: this.getControllerVisual(dataInterval[0], 'color', opts),\n            offset: 0\n        });\n\n        for (var i = 1; i < sampleNumber; i++) {\n            var currValue = dataInterval[0] + step * i;\n            if (currValue > dataInterval[1]) {\n                break;\n            }\n            colorStops.push({\n                color: this.getControllerVisual(currValue, 'color', opts),\n                offset: i / sampleNumber\n            });\n        }\n\n        colorStops.push({\n            color: this.getControllerVisual(dataInterval[1], 'color', opts),\n            offset: 1\n        });\n\n        return colorStops;\n    },\n\n    /**\n     * @private\n     */\n    _createBarPoints: function (handleEnds, symbolSizes) {\n        var itemSize = this.visualMapModel.itemSize;\n\n        return [\n            [itemSize[0] - symbolSizes[0], handleEnds[0]],\n            [itemSize[0], handleEnds[0]],\n            [itemSize[0], handleEnds[1]],\n            [itemSize[0] - symbolSizes[1], handleEnds[1]]\n        ];\n    },\n\n    /**\n     * @private\n     */\n    _createBarGroup: function (itemAlign) {\n        var orient = this._orient;\n        var inverse = this.visualMapModel.get('inverse');\n\n        return new Group(\n            (orient === 'horizontal' && !inverse)\n            ? {scale: itemAlign === 'bottom' ? [1, 1] : [-1, 1], rotation: Math.PI / 2}\n            : (orient === 'horizontal' && inverse)\n            ? {scale: itemAlign === 'bottom' ? [-1, 1] : [1, 1], rotation: -Math.PI / 2}\n            : (orient === 'vertical' && !inverse)\n            ? {scale: itemAlign === 'left' ? [1, -1] : [-1, -1]}\n            : {scale: itemAlign === 'left' ? [1, 1] : [-1, 1]}\n        );\n    },\n\n    /**\n     * @private\n     */\n    _updateHandle: function (handleEnds, visualInRange) {\n        if (!this._useHandle) {\n            return;\n        }\n\n        var shapes = this._shapes;\n        var visualMapModel = this.visualMapModel;\n        var handleThumbs = shapes.handleThumbs;\n        var handleLabels = shapes.handleLabels;\n\n        each$27([0, 1], function (handleIndex) {\n            var handleThumb = handleThumbs[handleIndex];\n            handleThumb.setStyle('fill', visualInRange.handlesColor[handleIndex]);\n            handleThumb.position[1] = handleEnds[handleIndex];\n\n            // Update handle label position.\n            var textPoint = applyTransform$1(\n                shapes.handleLabelPoints[handleIndex],\n                getTransform(handleThumb, this.group)\n            );\n            handleLabels[handleIndex].setStyle({\n                x: textPoint[0],\n                y: textPoint[1],\n                text: visualMapModel.formatValueText(this._dataInterval[handleIndex]),\n                textVerticalAlign: 'middle',\n                textAlign: this._applyTransform(\n                    this._orient === 'horizontal'\n                        ? (handleIndex === 0 ? 'bottom' : 'top')\n                        : 'left',\n                    shapes.barGroup\n                )\n            });\n        }, this);\n    },\n\n    /**\n     * @private\n     * @param {number} cursorValue\n     * @param {number} textValue\n     * @param {string} [rangeSymbol]\n     * @param {number} [halfHoverLinkSize]\n     */\n    _showIndicator: function (cursorValue, textValue, rangeSymbol, halfHoverLinkSize) {\n        var visualMapModel = this.visualMapModel;\n        var dataExtent = visualMapModel.getExtent();\n        var itemSize = visualMapModel.itemSize;\n        var sizeExtent = [0, itemSize[1]];\n        var pos = linearMap$4(cursorValue, dataExtent, sizeExtent, true);\n\n        var shapes = this._shapes;\n        var indicator = shapes.indicator;\n        if (!indicator) {\n            return;\n        }\n\n        indicator.position[1] = pos;\n        indicator.attr('invisible', false);\n        indicator.setShape('points', createIndicatorPoints(\n            !!rangeSymbol, halfHoverLinkSize, pos, itemSize[1]\n        ));\n\n        var opts = {convertOpacityToAlpha: true};\n        var color = this.getControllerVisual(cursorValue, 'color', opts);\n        indicator.setStyle('fill', color);\n\n        // Update handle label position.\n        var textPoint = applyTransform$1(\n            shapes.indicatorLabelPoint,\n            getTransform(indicator, this.group)\n        );\n\n        var indicatorLabel = shapes.indicatorLabel;\n        indicatorLabel.attr('invisible', false);\n        var align = this._applyTransform('left', shapes.barGroup);\n        var orient = this._orient;\n        indicatorLabel.setStyle({\n            text: (rangeSymbol ? rangeSymbol : '') + visualMapModel.formatValueText(textValue),\n            textVerticalAlign: orient === 'horizontal' ? align : 'middle',\n            textAlign: orient === 'horizontal' ? 'center' : align,\n            x: textPoint[0],\n            y: textPoint[1]\n        });\n    },\n\n    /**\n     * @private\n     */\n    _enableHoverLinkToSeries: function () {\n        var self = this;\n        this._shapes.barGroup\n\n            .on('mousemove', function (e) {\n                self._hovering = true;\n\n                if (!self._dragging) {\n                    var itemSize = self.visualMapModel.itemSize;\n                    var pos = self._applyTransform(\n                        [e.offsetX, e.offsetY], self._shapes.barGroup, true, true\n                    );\n                    // For hover link show when hover handle, which might be\n                    // below or upper than sizeExtent.\n                    pos[1] = mathMin$7(mathMax$7(0, pos[1]), itemSize[1]);\n                    self._doHoverLinkToSeries(\n                        pos[1],\n                        0 <= pos[0] && pos[0] <= itemSize[0]\n                    );\n                }\n            })\n\n            .on('mouseout', function () {\n                // When mouse is out of handle, hoverLink still need\n                // to be displayed when realtime is set as false.\n                self._hovering = false;\n                !self._dragging && self._clearHoverLinkToSeries();\n            });\n    },\n\n    /**\n     * @private\n     */\n    _enableHoverLinkFromSeries: function () {\n        var zr = this.api.getZr();\n\n        if (this.visualMapModel.option.hoverLink) {\n            zr.on('mouseover', this._hoverLinkFromSeriesMouseOver, this);\n            zr.on('mouseout', this._hideIndicator, this);\n        }\n        else {\n            this._clearHoverLinkFromSeries();\n        }\n    },\n\n    /**\n     * @private\n     */\n    _doHoverLinkToSeries: function (cursorPos, hoverOnBar) {\n        var visualMapModel = this.visualMapModel;\n        var itemSize = visualMapModel.itemSize;\n\n        if (!visualMapModel.option.hoverLink) {\n            return;\n        }\n\n        var sizeExtent = [0, itemSize[1]];\n        var dataExtent = visualMapModel.getExtent();\n\n        // For hover link show when hover handle, which might be below or upper than sizeExtent.\n        cursorPos = mathMin$7(mathMax$7(sizeExtent[0], cursorPos), sizeExtent[1]);\n\n        var halfHoverLinkSize = getHalfHoverLinkSize(visualMapModel, dataExtent, sizeExtent);\n        var hoverRange = [cursorPos - halfHoverLinkSize, cursorPos + halfHoverLinkSize];\n        var cursorValue = linearMap$4(cursorPos, sizeExtent, dataExtent, true);\n        var valueRange = [\n            linearMap$4(hoverRange[0], sizeExtent, dataExtent, true),\n            linearMap$4(hoverRange[1], sizeExtent, dataExtent, true)\n        ];\n        // Consider data range is out of visualMap range, see test/visualMap-continuous.html,\n        // where china and india has very large population.\n        hoverRange[0] < sizeExtent[0] && (valueRange[0] = -Infinity);\n        hoverRange[1] > sizeExtent[1] && (valueRange[1] = Infinity);\n\n        // Do not show indicator when mouse is over handle,\n        // otherwise labels overlap, especially when dragging.\n        if (hoverOnBar) {\n            if (valueRange[0] === -Infinity) {\n                this._showIndicator(cursorValue, valueRange[1], '< ', halfHoverLinkSize);\n            }\n            else if (valueRange[1] === Infinity) {\n                this._showIndicator(cursorValue, valueRange[0], '> ', halfHoverLinkSize);\n            }\n            else {\n                this._showIndicator(cursorValue, cursorValue, ' ', halfHoverLinkSize);\n            }\n        }\n\n        // When realtime is set as false, handles, which are in barGroup,\n        // also trigger hoverLink, which help user to realize where they\n        // focus on when dragging. (see test/heatmap-large.html)\n        // When realtime is set as true, highlight will not show when hover\n        // handle, because the label on handle, which displays a exact value\n        // but not range, might mislead users.\n        var oldBatch = this._hoverLinkDataIndices;\n        var newBatch = [];\n        if (hoverOnBar || useHoverLinkOnHandle(visualMapModel)) {\n            newBatch = this._hoverLinkDataIndices = visualMapModel.findTargetDataIndices(valueRange);\n        }\n\n        var resultBatches = compressBatches(oldBatch, newBatch);\n\n        this._dispatchHighDown('downplay', convertDataIndex(resultBatches[0]));\n        this._dispatchHighDown('highlight', convertDataIndex(resultBatches[1]));\n    },\n\n    /**\n     * @private\n     */\n    _hoverLinkFromSeriesMouseOver: function (e) {\n        var el = e.target;\n        var visualMapModel = this.visualMapModel;\n\n        if (!el || el.dataIndex == null) {\n            return;\n        }\n\n        var dataModel = this.ecModel.getSeriesByIndex(el.seriesIndex);\n\n        if (!visualMapModel.isTargetSeries(dataModel)) {\n            return;\n        }\n\n        var data = dataModel.getData(el.dataType);\n        var value = data.get(visualMapModel.getDataDimension(data), el.dataIndex, true);\n\n        if (!isNaN(value)) {\n            this._showIndicator(value, value);\n        }\n    },\n\n    /**\n     * @private\n     */\n    _hideIndicator: function () {\n        var shapes = this._shapes;\n        shapes.indicator && shapes.indicator.attr('invisible', true);\n        shapes.indicatorLabel && shapes.indicatorLabel.attr('invisible', true);\n    },\n\n    /**\n     * @private\n     */\n    _clearHoverLinkToSeries: function () {\n        this._hideIndicator();\n\n        var indices = this._hoverLinkDataIndices;\n        this._dispatchHighDown('downplay', convertDataIndex(indices));\n\n        indices.length = 0;\n    },\n\n    /**\n     * @private\n     */\n    _clearHoverLinkFromSeries: function () {\n        this._hideIndicator();\n\n        var zr = this.api.getZr();\n        zr.off('mouseover', this._hoverLinkFromSeriesMouseOver);\n        zr.off('mouseout', this._hideIndicator);\n    },\n\n    /**\n     * @private\n     */\n    _applyTransform: function (vertex, element, inverse, global) {\n        var transform = getTransform(element, global ? null : this.group);\n\n        return graphic[\n            isArray(vertex) ? 'applyTransform' : 'transformDirection'\n        ](vertex, transform, inverse);\n    },\n\n    /**\n     * @private\n     */\n    _dispatchHighDown: function (type, batch) {\n        batch && batch.length && this.api.dispatchAction({\n            type: type,\n            batch: batch\n        });\n    },\n\n    /**\n     * @override\n     */\n    dispose: function () {\n        this._clearHoverLinkFromSeries();\n        this._clearHoverLinkToSeries();\n    },\n\n    /**\n     * @override\n     */\n    remove: function () {\n        this._clearHoverLinkFromSeries();\n        this._clearHoverLinkToSeries();\n    }\n\n});\n\nfunction createPolygon(points, cursor, onDrift, onDragEnd) {\n    return new Polygon({\n        shape: {points: points},\n        draggable: !!onDrift,\n        cursor: cursor,\n        drift: onDrift,\n        onmousemove: function (e) {\n            // Fot mobile devicem, prevent screen slider on the button.\n            stop(e.event);\n        },\n        ondragend: onDragEnd\n    });\n}\n\nfunction createHandlePoints(handleIndex, textSize) {\n    return handleIndex === 0\n        ? [[0, 0], [textSize, 0], [textSize, -textSize]]\n        : [[0, 0], [textSize, 0], [textSize, textSize]];\n}\n\nfunction createIndicatorPoints(isRange, halfHoverLinkSize, pos, extentMax) {\n    return isRange\n        ? [ // indicate range\n            [0, -mathMin$7(halfHoverLinkSize, mathMax$7(pos, 0))],\n            [HOVER_LINK_OUT, 0],\n            [0, mathMin$7(halfHoverLinkSize, mathMax$7(extentMax - pos, 0))]\n        ]\n        : [ // indicate single value\n            [0, 0], [5, -5], [5, 5]\n        ];\n}\n\nfunction getHalfHoverLinkSize(visualMapModel, dataExtent, sizeExtent) {\n    var halfHoverLinkSize = HOVER_LINK_SIZE / 2;\n    var hoverLinkDataSize = visualMapModel.get('hoverLinkDataSize');\n    if (hoverLinkDataSize) {\n        halfHoverLinkSize = linearMap$4(hoverLinkDataSize, dataExtent, sizeExtent, true) / 2;\n    }\n    return halfHoverLinkSize;\n}\n\nfunction useHoverLinkOnHandle(visualMapModel) {\n    var hoverLinkOnHandle = visualMapModel.get('hoverLinkOnHandle');\n    return !!(hoverLinkOnHandle == null ? visualMapModel.get('realtime') : hoverLinkOnHandle);\n}\n\nfunction getCursor$1(orient) {\n    return orient === 'vertical' ? 'ns-resize' : 'ew-resize';\n}\n\nvar actionInfo$2 = {\n    type: 'selectDataRange',\n    event: 'dataRangeSelected',\n    // FIXME use updateView appears wrong\n    update: 'update'\n};\n\nregisterAction(actionInfo$2, function (payload, ecModel) {\n\n    ecModel.eachComponent({mainType: 'visualMap', query: payload}, function (model) {\n        model.setSelected(payload.selected);\n    });\n\n});\n\n/**\n * DataZoom component entry\n */\n\nregisterPreprocessor(preprocessor$2);\n\nvar PiecewiseModel = VisualMapModel.extend({\n\n    type: 'visualMap.piecewise',\n\n    /**\n     * Order Rule:\n     *\n     * option.categories / option.pieces / option.text / option.selected:\n     *     If !option.inverse,\n     *     Order when vertical: ['top', ..., 'bottom'].\n     *     Order when horizontal: ['left', ..., 'right'].\n     *     If option.inverse, the meaning of\n     *     the order should be reversed.\n     *\n     * this._pieceList:\n     *     The order is always [low, ..., high].\n     *\n     * Mapping from location to low-high:\n     *     If !option.inverse\n     *     When vertical, top is high.\n     *     When horizontal, right is high.\n     *     If option.inverse, reverse.\n     */\n\n    /**\n     * @protected\n     */\n    defaultOption: {\n        selected: null,             // Object. If not specified, means selected.\n                                    // When pieces and splitNumber: {'0': true, '5': true}\n                                    // When categories: {'cate1': false, 'cate3': true}\n                                    // When selected === false, means all unselected.\n\n        minOpen: false,             // Whether include values that smaller than `min`.\n        maxOpen: false,             // Whether include values that bigger than `max`.\n\n        align: 'auto',              // 'auto', 'left', 'right'\n        itemWidth: 20,              // When put the controller vertically, it is the length of\n                                    // horizontal side of each item. Otherwise, vertical side.\n        itemHeight: 14,             // When put the controller vertically, it is the length of\n                                    // vertical side of each item. Otherwise, horizontal side.\n        itemSymbol: 'roundRect',\n        pieceList: null,            // Each item is Object, with some of those attrs:\n                                    // {min, max, lt, gt, lte, gte, value,\n                                    // color, colorSaturation, colorAlpha, opacity,\n                                    // symbol, symbolSize}, which customize the range or visual\n                                    // coding of the certain piece. Besides, see \"Order Rule\".\n        categories: null,           // category names, like: ['some1', 'some2', 'some3'].\n                                    // Attr min/max are ignored when categories set. See \"Order Rule\"\n        splitNumber: 5,             // If set to 5, auto split five pieces equally.\n                                    // If set to 0 and component type not set, component type will be\n                                    // determined as \"continuous\". (It is less reasonable but for ec2\n                                    // compatibility, see echarts/component/visualMap/typeDefaulter)\n        selectedMode: 'multiple',   // Can be 'multiple' or 'single'.\n        itemGap: 10,                // The gap between two items, in px.\n        hoverLink: true,            // Enable hover highlight.\n\n        showLabel: null             // By default, when text is used, label will hide (the logic\n                                    // is remained for compatibility reason)\n    },\n\n    /**\n     * @override\n     */\n    optionUpdated: function (newOption, isInit) {\n        PiecewiseModel.superApply(this, 'optionUpdated', arguments);\n\n        /**\n         * The order is always [low, ..., high].\n         * [{text: string, interval: Array.<number>}, ...]\n         * @private\n         * @type {Array.<Object>}\n         */\n        this._pieceList = [];\n\n        this.resetExtent();\n\n        /**\n         * 'pieces', 'categories', 'splitNumber'\n         * @type {string}\n         */\n        var mode = this._mode = this._determineMode();\n\n        resetMethods[this._mode].call(this);\n\n        this._resetSelected(newOption, isInit);\n\n        var categories = this.option.categories;\n\n        this.resetVisual(function (mappingOption, state) {\n            if (mode === 'categories') {\n                mappingOption.mappingMethod = 'category';\n                mappingOption.categories = clone(categories);\n            }\n            else {\n                mappingOption.dataExtent = this.getExtent();\n                mappingOption.mappingMethod = 'piecewise';\n                mappingOption.pieceList = map(this._pieceList, function (piece) {\n                    var piece = clone(piece);\n                    if (state !== 'inRange') {\n                        // FIXME\n                        // outOfRange do not support special visual in pieces.\n                        piece.visual = null;\n                    }\n                    return piece;\n                });\n            }\n        });\n    },\n\n    /**\n     * @protected\n     * @override\n     */\n    completeVisualOption: function () {\n        // Consider this case:\n        // visualMap: {\n        //      pieces: [{symbol: 'circle', lt: 0}, {symbol: 'rect', gte: 0}]\n        // }\n        // where no inRange/outOfRange set but only pieces. So we should make\n        // default inRange/outOfRange for this case, otherwise visuals that only\n        // appear in `pieces` will not be taken into account in visual encoding.\n\n        var option = this.option;\n        var visualTypesInPieces = {};\n        var visualTypes = VisualMapping.listVisualTypes();\n        var isCategory = this.isCategory();\n\n        each$1(option.pieces, function (piece) {\n            each$1(visualTypes, function (visualType) {\n                if (piece.hasOwnProperty(visualType)) {\n                    visualTypesInPieces[visualType] = 1;\n                }\n            });\n        });\n\n        each$1(visualTypesInPieces, function (v, visualType) {\n            var exists = 0;\n            each$1(this.stateList, function (state) {\n                exists |= has(option, state, visualType)\n                    || has(option.target, state, visualType);\n            }, this);\n\n            !exists && each$1(this.stateList, function (state) {\n                (option[state] || (option[state] = {}))[visualType] = visualDefault.get(\n                    visualType, state === 'inRange' ? 'active' : 'inactive', isCategory\n                );\n            });\n        }, this);\n\n        function has(obj, state, visualType) {\n            return obj && obj[state] && (\n                isObject$1(obj[state])\n                    ? obj[state].hasOwnProperty(visualType)\n                    : obj[state] === visualType // e.g., inRange: 'symbol'\n            );\n        }\n\n        VisualMapModel.prototype.completeVisualOption.apply(this, arguments);\n    },\n\n    _resetSelected: function (newOption, isInit) {\n        var thisOption = this.option;\n        var pieceList = this._pieceList;\n\n        // Selected do not merge but all override.\n        var selected = (isInit ? thisOption : newOption).selected || {};\n        thisOption.selected = selected;\n\n        // Consider 'not specified' means true.\n        each$1(pieceList, function (piece, index) {\n            var key = this.getSelectedMapKey(piece);\n            if (!selected.hasOwnProperty(key)) {\n                selected[key] = true;\n            }\n        }, this);\n\n        if (thisOption.selectedMode === 'single') {\n            // Ensure there is only one selected.\n            var hasSel = false;\n\n            each$1(pieceList, function (piece, index) {\n                var key = this.getSelectedMapKey(piece);\n                if (selected[key]) {\n                    hasSel\n                        ? (selected[key] = false)\n                        : (hasSel = true);\n                }\n            }, this);\n        }\n        // thisOption.selectedMode === 'multiple', default: all selected.\n    },\n\n    /**\n     * @public\n     */\n    getSelectedMapKey: function (piece) {\n        return this._mode === 'categories'\n            ? piece.value + '' : piece.index + '';\n    },\n\n    /**\n     * @public\n     */\n    getPieceList: function () {\n        return this._pieceList;\n    },\n\n    /**\n     * @private\n     * @return {string}\n     */\n    _determineMode: function () {\n        var option = this.option;\n\n        return option.pieces && option.pieces.length > 0\n            ? 'pieces'\n            : this.option.categories\n            ? 'categories'\n            : 'splitNumber';\n    },\n\n    /**\n     * @public\n     * @override\n     */\n    setSelected: function (selected) {\n        this.option.selected = clone(selected);\n    },\n\n    /**\n     * @public\n     * @override\n     */\n    getValueState: function (value) {\n        var index = VisualMapping.findPieceIndex(value, this._pieceList);\n\n        return index != null\n            ? (this.option.selected[this.getSelectedMapKey(this._pieceList[index])]\n                ? 'inRange' : 'outOfRange'\n            )\n            : 'outOfRange';\n    },\n\n    /**\n     * @public\n     * @params {number} pieceIndex piece index in visualMapModel.getPieceList()\n     * @return {Array.<Object>} [{seriesId, dataIndices: <Array.<number>>}, ...]\n     */\n    findTargetDataIndices: function (pieceIndex) {\n        var result = [];\n\n        this.eachTargetSeries(function (seriesModel) {\n            var dataIndices = [];\n            var data = seriesModel.getData();\n\n            data.each(this.getDataDimension(data), function (value, dataIndex) {\n                // Should always base on model pieceList, because it is order sensitive.\n                var pIdx = VisualMapping.findPieceIndex(value, this._pieceList);\n                pIdx === pieceIndex && dataIndices.push(dataIndex);\n            }, this);\n\n            result.push({seriesId: seriesModel.id, dataIndex: dataIndices});\n        }, this);\n\n        return result;\n    },\n\n    /**\n     * @private\n     * @param {Object} piece piece.value or piece.interval is required.\n     * @return {number} Can be Infinity or -Infinity\n     */\n    getRepresentValue: function (piece) {\n        var representValue;\n        if (this.isCategory()) {\n            representValue = piece.value;\n        }\n        else {\n            if (piece.value != null) {\n                representValue = piece.value;\n            }\n            else {\n                var pieceInterval = piece.interval || [];\n                representValue = (pieceInterval[0] === -Infinity && pieceInterval[1] === Infinity)\n                    ? 0\n                    : (pieceInterval[0] + pieceInterval[1]) / 2;\n            }\n        }\n        return representValue;\n    },\n\n    getVisualMeta: function (getColorVisual) {\n        // Do not support category. (category axis is ordinal, numerical)\n        if (this.isCategory()) {\n            return;\n        }\n\n        var stops = [];\n        var outerColors = [];\n        var visualMapModel = this;\n\n        function setStop(interval, valueState) {\n            var representValue = visualMapModel.getRepresentValue({interval: interval});\n            if (!valueState) {\n                valueState = visualMapModel.getValueState(representValue);\n            }\n            var color = getColorVisual(representValue, valueState);\n            if (interval[0] === -Infinity) {\n                outerColors[0] = color;\n            }\n            else if (interval[1] === Infinity) {\n                outerColors[1] = color;\n            }\n            else {\n                stops.push(\n                    {value: interval[0], color: color},\n                    {value: interval[1], color: color}\n                );\n            }\n        }\n\n        // Suplement\n        var pieceList = this._pieceList.slice();\n        if (!pieceList.length) {\n            pieceList.push({interval: [-Infinity, Infinity]});\n        }\n        else {\n            var edge = pieceList[0].interval[0];\n            edge !== -Infinity && pieceList.unshift({interval: [-Infinity, edge]});\n            edge = pieceList[pieceList.length - 1].interval[1];\n            edge !== Infinity && pieceList.push({interval: [edge, Infinity]});\n        }\n\n        var curr = -Infinity;\n        each$1(pieceList, function (piece) {\n            var interval = piece.interval;\n            if (interval) {\n                // Fulfill gap.\n                interval[0] > curr && setStop([curr, interval[0]], 'outOfRange');\n                setStop(interval.slice());\n                curr = interval[1];\n            }\n        }, this);\n\n        return {stops: stops, outerColors: outerColors};\n    }\n\n});\n\n/**\n * Key is this._mode\n * @type {Object}\n * @this {module:echarts/component/viusalMap/PiecewiseMode}\n */\nvar resetMethods = {\n\n    splitNumber: function () {\n        var thisOption = this.option;\n        var pieceList = this._pieceList;\n        var precision = Math.min(thisOption.precision, 20);\n        var dataExtent = this.getExtent();\n        var splitNumber = thisOption.splitNumber;\n        splitNumber = Math.max(parseInt(splitNumber, 10), 1);\n        thisOption.splitNumber = splitNumber;\n\n        var splitStep = (dataExtent[1] - dataExtent[0]) / splitNumber;\n        // Precision auto-adaption\n        while (+splitStep.toFixed(precision) !== splitStep && precision < 5) {\n            precision++;\n        }\n        thisOption.precision = precision;\n        splitStep = +splitStep.toFixed(precision);\n\n        var index = 0;\n\n        if (thisOption.minOpen) {\n            pieceList.push({\n                index: index++,\n                interval: [-Infinity, dataExtent[0]],\n                close: [0, 0]\n            });\n        }\n\n        for (\n            var curr = dataExtent[0], len = index + splitNumber;\n            index < len;\n            curr += splitStep\n        ) {\n            var max = index === splitNumber - 1 ? dataExtent[1] : (curr + splitStep);\n\n            pieceList.push({\n                index: index++,\n                interval: [curr, max],\n                close: [1, 1]\n            });\n        }\n\n        if (thisOption.maxOpen) {\n            pieceList.push({\n                index: index++,\n                interval: [dataExtent[1], Infinity],\n                close: [0, 0]\n            });\n        }\n\n        reformIntervals(pieceList);\n\n        each$1(pieceList, function (piece) {\n            piece.text = this.formatValueText(piece.interval);\n        }, this);\n    },\n\n    categories: function () {\n        var thisOption = this.option;\n        each$1(thisOption.categories, function (cate) {\n            // FIXME categorypieceListvisualMappingpieceList\n            // \n            this._pieceList.push({\n                text: this.formatValueText(cate, true),\n                value: cate\n            });\n        }, this);\n\n        // See \"Order Rule\".\n        normalizeReverse(thisOption, this._pieceList);\n    },\n\n    pieces: function () {\n        var thisOption = this.option;\n        var pieceList = this._pieceList;\n\n        each$1(thisOption.pieces, function (pieceListItem, index) {\n\n            if (!isObject$1(pieceListItem)) {\n                pieceListItem = {value: pieceListItem};\n            }\n\n            var item = {text: '', index: index};\n\n            if (pieceListItem.label != null) {\n                item.text = pieceListItem.label;\n            }\n\n            if (pieceListItem.hasOwnProperty('value')) {\n                var value = item.value = pieceListItem.value;\n                item.interval = [value, value];\n                item.close = [1, 1];\n            }\n            else {\n                // `min` `max` is legacy option.\n                // `lt` `gt` `lte` `gte` is recommanded.\n                var interval = item.interval = [];\n                var close = item.close = [0, 0];\n\n                var closeList = [1, 0, 1];\n                var infinityList = [-Infinity, Infinity];\n\n                var useMinMax = [];\n                for (var lg = 0; lg < 2; lg++) {\n                    var names = [['gte', 'gt', 'min'], ['lte', 'lt', 'max']][lg];\n                    for (var i = 0; i < 3 && interval[lg] == null; i++) {\n                        interval[lg] = pieceListItem[names[i]];\n                        close[lg] = closeList[i];\n                        useMinMax[lg] = i === 2;\n                    }\n                    interval[lg] == null && (interval[lg] = infinityList[lg]);\n                }\n                useMinMax[0] && interval[1] === Infinity && (close[0] = 0);\n                useMinMax[1] && interval[0] === -Infinity && (close[1] = 0);\n\n                if (__DEV__) {\n                    if (interval[0] > interval[1]) {\n                        console.warn(\n                            'Piece ' + index + 'is illegal: ' + interval\n                            + ' lower bound should not greater then uppper bound.'\n                        );\n                    }\n                }\n\n                if (interval[0] === interval[1] && close[0] && close[1]) {\n                    // Consider: [{min: 5, max: 5, visual: {...}}, {min: 0, max: 5}],\n                    // we use value to lift the priority when min === max\n                    item.value = interval[0];\n                }\n            }\n\n            item.visual = VisualMapping.retrieveVisuals(pieceListItem);\n\n            pieceList.push(item);\n\n        }, this);\n\n        // See \"Order Rule\".\n        normalizeReverse(thisOption, pieceList);\n        // Only pieces\n        reformIntervals(pieceList);\n\n        each$1(pieceList, function (piece) {\n            var close = piece.close;\n            var edgeSymbols = [['<', ''][close[1]], ['>', ''][close[0]]];\n            piece.text = piece.text || this.formatValueText(\n                piece.value != null ? piece.value : piece.interval,\n                false,\n                edgeSymbols\n            );\n        }, this);\n    }\n};\n\nfunction normalizeReverse(thisOption, pieceList) {\n    var inverse = thisOption.inverse;\n    if (thisOption.orient === 'vertical' ? !inverse : inverse) {\n            pieceList.reverse();\n    }\n}\n\nvar PiecewiseVisualMapView = VisualMapView.extend({\n\n    type: 'visualMap.piecewise',\n\n    /**\n     * @protected\n     * @override\n     */\n    doRender: function () {\n        var thisGroup = this.group;\n\n        thisGroup.removeAll();\n\n        var visualMapModel = this.visualMapModel;\n        var textGap = visualMapModel.get('textGap');\n        var textStyleModel = visualMapModel.textStyleModel;\n        var textFont = textStyleModel.getFont();\n        var textFill = textStyleModel.getTextColor();\n        var itemAlign = this._getItemAlign();\n        var itemSize = visualMapModel.itemSize;\n        var viewData = this._getViewData();\n        var endsText = viewData.endsText;\n        var showLabel = retrieve(visualMapModel.get('showLabel', true), !endsText);\n\n        endsText && this._renderEndsText(\n            thisGroup, endsText[0], itemSize, showLabel, itemAlign\n        );\n\n        each$1(viewData.viewPieceList, renderItem, this);\n\n        endsText && this._renderEndsText(\n            thisGroup, endsText[1], itemSize, showLabel, itemAlign\n        );\n\n        box(\n            visualMapModel.get('orient'), thisGroup, visualMapModel.get('itemGap')\n        );\n\n        this.renderBackground(thisGroup);\n\n        this.positionGroup(thisGroup);\n\n        function renderItem(item) {\n            var piece = item.piece;\n\n            var itemGroup = new Group();\n            itemGroup.onclick = bind(this._onItemClick, this, piece);\n\n            this._enableHoverLink(itemGroup, item.indexInModelPieceList);\n\n            var representValue = visualMapModel.getRepresentValue(piece);\n\n            this._createItemSymbol(\n                itemGroup, representValue, [0, 0, itemSize[0], itemSize[1]]\n            );\n\n            if (showLabel) {\n                var visualState = this.visualMapModel.getValueState(representValue);\n\n                itemGroup.add(new Text({\n                    style: {\n                        x: itemAlign === 'right' ? -textGap : itemSize[0] + textGap,\n                        y: itemSize[1] / 2,\n                        text: piece.text,\n                        textVerticalAlign: 'middle',\n                        textAlign: itemAlign,\n                        textFont: textFont,\n                        textFill: textFill,\n                        opacity: visualState === 'outOfRange' ? 0.5 : 1\n                    }\n                }));\n            }\n\n            thisGroup.add(itemGroup);\n        }\n    },\n\n    /**\n     * @private\n     */\n    _enableHoverLink: function (itemGroup, pieceIndex) {\n        itemGroup\n            .on('mouseover', bind(onHoverLink, this, 'highlight'))\n            .on('mouseout', bind(onHoverLink, this, 'downplay'));\n\n        function onHoverLink(method) {\n            var visualMapModel = this.visualMapModel;\n\n            visualMapModel.option.hoverLink && this.api.dispatchAction({\n                type: method,\n                batch: convertDataIndex(\n                    visualMapModel.findTargetDataIndices(pieceIndex)\n                )\n            });\n        }\n    },\n\n    /**\n     * @private\n     */\n    _getItemAlign: function () {\n        var visualMapModel = this.visualMapModel;\n        var modelOption = visualMapModel.option;\n\n        if (modelOption.orient === 'vertical') {\n            return getItemAlign(\n                visualMapModel, this.api, visualMapModel.itemSize\n            );\n        }\n        else { // horizontal, most case left unless specifying right.\n            var align = modelOption.align;\n            if (!align || align === 'auto') {\n                align = 'left';\n            }\n            return align;\n        }\n    },\n\n    /**\n     * @private\n     */\n    _renderEndsText: function (group, text, itemSize, showLabel, itemAlign) {\n        if (!text) {\n            return;\n        }\n\n        var itemGroup = new Group();\n        var textStyleModel = this.visualMapModel.textStyleModel;\n\n        itemGroup.add(new Text({\n            style: {\n                x: showLabel ? (itemAlign === 'right' ? itemSize[0] : 0) : itemSize[0] / 2,\n                y: itemSize[1] / 2,\n                textVerticalAlign: 'middle',\n                textAlign: showLabel ? itemAlign : 'center',\n                text: text,\n                textFont: textStyleModel.getFont(),\n                textFill: textStyleModel.getTextColor()\n            }\n        }));\n\n        group.add(itemGroup);\n    },\n\n    /**\n     * @private\n     * @return {Object} {peiceList, endsText} The order is the same as screen pixel order.\n     */\n    _getViewData: function () {\n        var visualMapModel = this.visualMapModel;\n\n        var viewPieceList = map(visualMapModel.getPieceList(), function (piece, index) {\n            return {piece: piece, indexInModelPieceList: index};\n        });\n        var endsText = visualMapModel.get('text');\n\n        // Consider orient and inverse.\n        var orient = visualMapModel.get('orient');\n        var inverse = visualMapModel.get('inverse');\n\n        // Order of model pieceList is always [low, ..., high]\n        if (orient === 'horizontal' ? inverse : !inverse) {\n            viewPieceList.reverse();\n        }\n        // Origin order of endsText is [high, low]\n        else if (endsText) {\n            endsText = endsText.slice().reverse();\n        }\n\n        return {viewPieceList: viewPieceList, endsText: endsText};\n    },\n\n    /**\n     * @private\n     */\n    _createItemSymbol: function (group, representValue, shapeParam) {\n        group.add(createSymbol(\n            this.getControllerVisual(representValue, 'symbol'),\n            shapeParam[0], shapeParam[1], shapeParam[2], shapeParam[3],\n            this.getControllerVisual(representValue, 'color')\n        ));\n    },\n\n    /**\n     * @private\n     */\n    _onItemClick: function (piece) {\n        var visualMapModel = this.visualMapModel;\n        var option = visualMapModel.option;\n        var selected = clone(option.selected);\n        var newKey = visualMapModel.getSelectedMapKey(piece);\n\n        if (option.selectedMode === 'single') {\n            selected[newKey] = true;\n            each$1(selected, function (o, key) {\n                selected[key] = key === newKey;\n            });\n        }\n        else {\n            selected[newKey] = !selected[newKey];\n        }\n\n        this.api.dispatchAction({\n            type: 'selectDataRange',\n            from: this.uid,\n            visualMapId: this.visualMapModel.id,\n            selected: selected\n        });\n    }\n});\n\n/**\n * DataZoom component entry\n */\n\nregisterPreprocessor(preprocessor$2);\n\n/**\n * visualMap component entry\n */\n\nvar addCommas$1 = addCommas;\nvar encodeHTML$1 = encodeHTML;\n\nfunction fillLabel(opt) {\n    defaultEmphasis(opt, 'label', ['show']);\n}\nvar MarkerModel = extendComponentModel({\n\n    type: 'marker',\n\n    dependencies: ['series', 'grid', 'polar', 'geo'],\n\n    /**\n     * @overrite\n     */\n    init: function (option, parentModel, ecModel, extraOpt) {\n\n        if (__DEV__) {\n            if (this.type === 'marker') {\n                throw new Error('Marker component is abstract component. Use markLine, markPoint, markArea instead.');\n            }\n        }\n        this.mergeDefaultAndTheme(option, ecModel);\n        this.mergeOption(option, ecModel, extraOpt.createdBySelf, true);\n    },\n\n    /**\n     * @return {boolean}\n     */\n    isAnimationEnabled: function () {\n        if (env$1.node) {\n            return false;\n        }\n\n        var hostSeries = this.__hostSeries;\n        return this.getShallow('animation') && hostSeries && hostSeries.isAnimationEnabled();\n    },\n\n    mergeOption: function (newOpt, ecModel, createdBySelf, isInit) {\n        var MarkerModel = this.constructor;\n        var modelPropName = this.mainType + 'Model';\n        if (!createdBySelf) {\n            ecModel.eachSeries(function (seriesModel) {\n\n                var markerOpt = seriesModel.get(this.mainType);\n\n                var markerModel = seriesModel[modelPropName];\n                if (!markerOpt || !markerOpt.data) {\n                    seriesModel[modelPropName] = null;\n                    return;\n                }\n                if (!markerModel) {\n                    if (isInit) {\n                        // Default label emphasis `position` and `show`\n                        fillLabel(markerOpt);\n                    }\n                    each$1(markerOpt.data, function (item) {\n                        // FIXME Overwrite fillLabel method ?\n                        if (item instanceof Array) {\n                            fillLabel(item[0]);\n                            fillLabel(item[1]);\n                        }\n                        else {\n                            fillLabel(item);\n                        }\n                    });\n\n                    markerModel = new MarkerModel(\n                        markerOpt, this, ecModel\n                    );\n\n                    extend(markerModel, {\n                        mainType: this.mainType,\n                        // Use the same series index and name\n                        seriesIndex: seriesModel.seriesIndex,\n                        name: seriesModel.name,\n                        createdBySelf: true\n                    });\n\n                    markerModel.__hostSeries = seriesModel;\n                }\n                else {\n                    markerModel.mergeOption(markerOpt, ecModel, true);\n                }\n                seriesModel[modelPropName] = markerModel;\n            }, this);\n        }\n    },\n\n    formatTooltip: function (dataIndex) {\n        var data = this.getData();\n        var value = this.getRawValue(dataIndex);\n        var formattedValue = isArray(value)\n            ? map(value, addCommas$1).join(', ') : addCommas$1(value);\n        var name = data.getName(dataIndex);\n        var html = encodeHTML$1(this.name);\n        if (value != null || name) {\n            html += '<br />';\n        }\n        if (name) {\n            html += encodeHTML$1(name);\n            if (value != null) {\n                html += ' : ';\n            }\n        }\n        if (value != null) {\n            html += encodeHTML$1(formattedValue);\n        }\n        return html;\n    },\n\n    getData: function () {\n        return this._data;\n    },\n\n    setData: function (data) {\n        this._data = data;\n    }\n});\n\nmixin(MarkerModel, dataFormatMixin);\n\nMarkerModel.extend({\n\n    type: 'markPoint',\n\n    defaultOption: {\n        zlevel: 0,\n        z: 5,\n        symbol: 'pin',\n        symbolSize: 50,\n        //symbolRotate: 0,\n        //symbolOffset: [0, 0]\n        tooltip: {\n            trigger: 'item'\n        },\n        label: {\n            show: true,\n            position: 'inside'\n        },\n        itemStyle: {\n            borderWidth: 2\n        },\n        emphasis: {\n            label: {\n                show: true\n            }\n        }\n    }\n});\n\nvar indexOf$2 = indexOf;\n\nfunction hasXOrY(item) {\n    return !(isNaN(parseFloat(item.x)) && isNaN(parseFloat(item.y)));\n}\n\nfunction hasXAndY(item) {\n    return !isNaN(parseFloat(item.x)) && !isNaN(parseFloat(item.y));\n}\n\n// Make it simple, do not visit all stacked value to count precision.\n// function getPrecision(data, valueAxisDim, dataIndex) {\n//     var precision = -1;\n//     var stackedDim = data.mapDimension(valueAxisDim);\n//     do {\n//         precision = Math.max(\n//             numberUtil.getPrecision(data.get(stackedDim, dataIndex)),\n//             precision\n//         );\n//         var stackedOnSeries = data.getCalculationInfo('stackedOnSeries');\n//         if (stackedOnSeries) {\n//             var byValue = data.get(data.getCalculationInfo('stackedByDimension'), dataIndex);\n//             data = stackedOnSeries.getData();\n//             dataIndex = data.indexOf(data.getCalculationInfo('stackedByDimension'), byValue);\n//             stackedDim = data.getCalculationInfo('stackedDimension');\n//         }\n//         else {\n//             data = null;\n//         }\n//     } while (data);\n\n//     return precision;\n// }\n\nfunction markerTypeCalculatorWithExtent(\n    mlType, data, otherDataDim, targetDataDim, otherCoordIndex, targetCoordIndex\n) {\n    var coordArr = [];\n\n    var stacked = isDimensionStacked(data, targetDataDim, otherDataDim);\n    var calcDataDim = stacked\n        ? data.getCalculationInfo('stackResultDimension')\n        : targetDataDim;\n\n    var value = numCalculate(data, calcDataDim, mlType);\n\n    var dataIndex = data.indicesOfNearest(calcDataDim, value)[0];\n    coordArr[otherCoordIndex] = data.get(otherDataDim, dataIndex);\n    coordArr[targetCoordIndex] = data.get(targetDataDim, dataIndex);\n\n    // Make it simple, do not visit all stacked value to count precision.\n    var precision = getPrecision(data.get(targetDataDim, dataIndex));\n    precision = Math.min(precision, 20);\n    if (precision >= 0) {\n        coordArr[targetCoordIndex] = +coordArr[targetCoordIndex].toFixed(precision);\n    }\n\n    return coordArr;\n}\n\nvar curry$7 = curry;\n// TODO Specified percent\nvar markerTypeCalculator = {\n    /**\n     * @method\n     * @param {module:echarts/data/List} data\n     * @param {string} baseAxisDim\n     * @param {string} valueAxisDim\n     */\n    min: curry$7(markerTypeCalculatorWithExtent, 'min'),\n    /**\n     * @method\n     * @param {module:echarts/data/List} data\n     * @param {string} baseAxisDim\n     * @param {string} valueAxisDim\n     */\n    max: curry$7(markerTypeCalculatorWithExtent, 'max'),\n\n    /**\n     * @method\n     * @param {module:echarts/data/List} data\n     * @param {string} baseAxisDim\n     * @param {string} valueAxisDim\n     */\n    average: curry$7(markerTypeCalculatorWithExtent, 'average')\n};\n\n/**\n * Transform markPoint data item to format used in List by do the following\n * 1. Calculate statistic like `max`, `min`, `average`\n * 2. Convert `item.xAxis`, `item.yAxis` to `item.coord` array\n * @param  {module:echarts/model/Series} seriesModel\n * @param  {module:echarts/coord/*} [coordSys]\n * @param  {Object} item\n * @return {Object}\n */\nfunction dataTransform(seriesModel, item) {\n    var data = seriesModel.getData();\n    var coordSys = seriesModel.coordinateSystem;\n\n    // 1. If not specify the position with pixel directly\n    // 2. If `coord` is not a data array. Which uses `xAxis`,\n    // `yAxis` to specify the coord on each dimension\n\n    // parseFloat first because item.x and item.y can be percent string like '20%'\n    if (item && !hasXAndY(item) && !isArray(item.coord) && coordSys) {\n        var dims = coordSys.dimensions;\n        var axisInfo = getAxisInfo$1(item, data, coordSys, seriesModel);\n\n        // Clone the option\n        // Transform the properties xAxis, yAxis, radiusAxis, angleAxis, geoCoord to value\n        item = clone(item);\n\n        if (item.type\n            && markerTypeCalculator[item.type]\n            && axisInfo.baseAxis && axisInfo.valueAxis\n        ) {\n            var otherCoordIndex = indexOf$2(dims, axisInfo.baseAxis.dim);\n            var targetCoordIndex = indexOf$2(dims, axisInfo.valueAxis.dim);\n\n            item.coord = markerTypeCalculator[item.type](\n                data, axisInfo.baseDataDim, axisInfo.valueDataDim,\n                otherCoordIndex, targetCoordIndex\n            );\n            // Force to use the value of calculated value.\n            item.value = item.coord[targetCoordIndex];\n        }\n        else {\n            // FIXME Only has one of xAxis and yAxis.\n            var coord = [\n                item.xAxis != null ? item.xAxis : item.radiusAxis,\n                item.yAxis != null ? item.yAxis : item.angleAxis\n            ];\n            // Each coord support max, min, average\n            for (var i = 0; i < 2; i++) {\n                if (markerTypeCalculator[coord[i]]) {\n                    coord[i] = numCalculate(data, data.mapDimension(dims[i]), coord[i]);\n                }\n            }\n            item.coord = coord;\n        }\n    }\n    return item;\n}\n\nfunction getAxisInfo$1(item, data, coordSys, seriesModel) {\n    var ret = {};\n\n    if (item.valueIndex != null || item.valueDim != null) {\n        ret.valueDataDim = item.valueIndex != null\n            ? data.getDimension(item.valueIndex) : item.valueDim;\n        ret.valueAxis = coordSys.getAxis(dataDimToCoordDim(seriesModel, ret.valueDataDim));\n        ret.baseAxis = coordSys.getOtherAxis(ret.valueAxis);\n        ret.baseDataDim = data.mapDimension(ret.baseAxis.dim);\n    }\n    else {\n        ret.baseAxis = seriesModel.getBaseAxis();\n        ret.valueAxis = coordSys.getOtherAxis(ret.baseAxis);\n        ret.baseDataDim = data.mapDimension(ret.baseAxis.dim);\n        ret.valueDataDim = data.mapDimension(ret.valueAxis.dim);\n    }\n\n    return ret;\n}\n\nfunction dataDimToCoordDim(seriesModel, dataDim) {\n    var data = seriesModel.getData();\n    var dimensions = data.dimensions;\n    dataDim = data.getDimension(dataDim);\n    for (var i = 0; i < dimensions.length; i++) {\n        var dimItem = data.getDimensionInfo(dimensions[i]);\n        if (dimItem.name === dataDim) {\n            return dimItem.coordDim;\n        }\n    }\n}\n\n/**\n * Filter data which is out of coordinateSystem range\n * [dataFilter description]\n * @param  {module:echarts/coord/*} [coordSys]\n * @param  {Object} item\n * @return {boolean}\n */\nfunction dataFilter$1(coordSys, item) {\n    // Alwalys return true if there is no coordSys\n    return (coordSys && coordSys.containData && item.coord && !hasXOrY(item))\n        ? coordSys.containData(item.coord) : true;\n}\n\nfunction dimValueGetter(item, dimName, dataIndex, dimIndex) {\n    // x, y, radius, angle\n    if (dimIndex < 2) {\n        return item.coord && item.coord[dimIndex];\n    }\n    return item.value;\n}\n\nfunction numCalculate(data, valueDataDim, type) {\n    if (type === 'average') {\n        var sum = 0;\n        var count = 0;\n        data.each(valueDataDim, function (val, idx) {\n            if (!isNaN(val)) {\n                sum += val;\n                count++;\n            }\n        });\n        return sum / count;\n    }\n    else {\n        return data.getDataExtent(valueDataDim, true)[type === 'max' ? 1 : 0];\n    }\n}\n\nvar MarkerView = extendComponentView({\n\n    type: 'marker',\n\n    init: function () {\n        /**\n         * Markline grouped by series\n         * @private\n         * @type {module:zrender/core/util.HashMap}\n         */\n        this.markerGroupMap = createHashMap();\n    },\n\n    render: function (markerModel, ecModel, api) {\n        var markerGroupMap = this.markerGroupMap;\n        markerGroupMap.each(function (item) {\n            item.__keep = false;\n        });\n\n        var markerModelKey = this.type + 'Model';\n        ecModel.eachSeries(function (seriesModel) {\n            var markerModel = seriesModel[markerModelKey];\n            markerModel && this.renderSeries(seriesModel, markerModel, ecModel, api);\n        }, this);\n\n        markerGroupMap.each(function (item) {\n            !item.__keep && this.group.remove(item.group);\n        }, this);\n    },\n\n    renderSeries: function () {}\n});\n\nfunction updateMarkerLayout(mpData, seriesModel, api) {\n    var coordSys = seriesModel.coordinateSystem;\n    mpData.each(function (idx) {\n        var itemModel = mpData.getItemModel(idx);\n        var point;\n        var xPx = parsePercent$1(itemModel.get('x'), api.getWidth());\n        var yPx = parsePercent$1(itemModel.get('y'), api.getHeight());\n        if (!isNaN(xPx) && !isNaN(yPx)) {\n            point = [xPx, yPx];\n        }\n        // Chart like bar may have there own marker positioning logic\n        else if (seriesModel.getMarkerPosition) {\n            // Use the getMarkerPoisition\n            point = seriesModel.getMarkerPosition(\n                mpData.getValues(mpData.dimensions, idx)\n            );\n        }\n        else if (coordSys) {\n            var x = mpData.get(coordSys.dimensions[0], idx);\n            var y = mpData.get(coordSys.dimensions[1], idx);\n            point = coordSys.dataToPoint([x, y]);\n\n        }\n\n        // Use x, y if has any\n        if (!isNaN(xPx)) {\n            point[0] = xPx;\n        }\n        if (!isNaN(yPx)) {\n            point[1] = yPx;\n        }\n\n        mpData.setItemLayout(idx, point);\n    });\n}\n\nMarkerView.extend({\n\n    type: 'markPoint',\n\n    // updateLayout: function (markPointModel, ecModel, api) {\n    //     ecModel.eachSeries(function (seriesModel) {\n    //         var mpModel = seriesModel.markPointModel;\n    //         if (mpModel) {\n    //             updateMarkerLayout(mpModel.getData(), seriesModel, api);\n    //             this.markerGroupMap.get(seriesModel.id).updateLayout(mpModel);\n    //         }\n    //     }, this);\n    // },\n\n    updateTransform: function (markPointModel, ecModel, api) {\n        ecModel.eachSeries(function (seriesModel) {\n            var mpModel = seriesModel.markPointModel;\n            if (mpModel) {\n                updateMarkerLayout(mpModel.getData(), seriesModel, api);\n                this.markerGroupMap.get(seriesModel.id).updateLayout(mpModel);\n            }\n        }, this);\n    },\n\n    renderSeries: function (seriesModel, mpModel, ecModel, api) {\n        var coordSys = seriesModel.coordinateSystem;\n        var seriesId = seriesModel.id;\n        var seriesData = seriesModel.getData();\n\n        var symbolDrawMap = this.markerGroupMap;\n        var symbolDraw = symbolDrawMap.get(seriesId)\n            || symbolDrawMap.set(seriesId, new SymbolDraw());\n\n        var mpData = createList$1(coordSys, seriesModel, mpModel);\n\n        // FIXME\n        mpModel.setData(mpData);\n\n        updateMarkerLayout(mpModel.getData(), seriesModel, api);\n\n        mpData.each(function (idx) {\n            var itemModel = mpData.getItemModel(idx);\n            var symbolSize = itemModel.getShallow('symbolSize');\n            if (typeof symbolSize === 'function') {\n                // FIXME  ECharts 2.x2.x \n                symbolSize = symbolSize(\n                    mpModel.getRawValue(idx), mpModel.getDataParams(idx)\n                );\n            }\n            mpData.setItemVisual(idx, {\n                symbolSize: symbolSize,\n                color: itemModel.get('itemStyle.color')\n                    || seriesData.getVisual('color'),\n                symbol: itemModel.getShallow('symbol')\n            });\n        });\n\n        // TODO Text are wrong\n        symbolDraw.updateData(mpData);\n        this.group.add(symbolDraw.group);\n\n        // Set host model for tooltip\n        // FIXME\n        mpData.eachItemGraphicEl(function (el) {\n            el.traverse(function (child) {\n                child.dataModel = mpModel;\n            });\n        });\n\n        symbolDraw.__keep = true;\n\n        symbolDraw.group.silent = mpModel.get('silent') || seriesModel.get('silent');\n    }\n});\n\n/**\n * @inner\n * @param {module:echarts/coord/*} [coordSys]\n * @param {module:echarts/model/Series} seriesModel\n * @param {module:echarts/model/Model} mpModel\n */\nfunction createList$1(coordSys, seriesModel, mpModel) {\n    var coordDimsInfos;\n    if (coordSys) {\n        coordDimsInfos = map(coordSys && coordSys.dimensions, function (coordDim) {\n            var info = seriesModel.getData().getDimensionInfo(\n                seriesModel.getData().mapDimension(coordDim)\n            ) || {};\n            // In map series data don't have lng and lat dimension. Fallback to same with coordSys\n            return defaults({name: coordDim}, info);\n        });\n    }\n    else {\n        coordDimsInfos =[{\n            name: 'value',\n            type: 'float'\n        }];\n    }\n\n    var mpData = new List(coordDimsInfos, mpModel);\n    var dataOpt = map(mpModel.get('data'), curry(\n            dataTransform, seriesModel\n        ));\n    if (coordSys) {\n        dataOpt = filter(\n            dataOpt, curry(dataFilter$1, coordSys)\n        );\n    }\n\n    mpData.initData(dataOpt, null,\n        coordSys ? dimValueGetter : function (item) {\n            return item.value;\n        }\n    );\n\n    return mpData;\n}\n\n// HINT Markpoint can't be used too much\nregisterPreprocessor(function (opt) {\n    // Make sure markPoint component is enabled\n    opt.markPoint = opt.markPoint || {};\n});\n\nMarkerModel.extend({\n\n    type: 'markLine',\n\n    defaultOption: {\n        zlevel: 0,\n        z: 5,\n\n        symbol: ['circle', 'arrow'],\n        symbolSize: [8, 16],\n\n        //symbolRotate: 0,\n\n        precision: 2,\n        tooltip: {\n            trigger: 'item'\n        },\n        label: {\n            show: true,\n            position: 'end'\n        },\n        lineStyle: {\n            type: 'dashed'\n        },\n        emphasis: {\n            label: {\n                show: true\n            },\n            lineStyle: {\n                width: 3\n            }\n        },\n        animationEasing: 'linear'\n    }\n});\n\nvar markLineTransform = function (seriesModel, coordSys, mlModel, item) {\n    var data = seriesModel.getData();\n    // Special type markLine like 'min', 'max', 'average'\n    var mlType = item.type;\n\n    if (!isArray(item)\n        && (\n            mlType === 'min' || mlType === 'max' || mlType === 'average'\n            // In case\n            // data: [{\n            //   yAxis: 10\n            // }]\n            || (item.xAxis != null || item.yAxis != null)\n        )\n    ) {\n        var valueAxis;\n        var valueDataDim;\n        var value;\n\n        if (item.yAxis != null || item.xAxis != null) {\n            valueDataDim = item.yAxis != null ? 'y' : 'x';\n            valueAxis = coordSys.getAxis(valueDataDim);\n\n            value = retrieve(item.yAxis, item.xAxis);\n        }\n        else {\n            var axisInfo = getAxisInfo$1(item, data, coordSys, seriesModel);\n            valueDataDim = axisInfo.valueDataDim;\n            valueAxis = axisInfo.valueAxis;\n            value = numCalculate(data, valueDataDim, mlType);\n        }\n        var valueIndex = valueDataDim === 'x' ? 0 : 1;\n        var baseIndex = 1 - valueIndex;\n\n        var mlFrom = clone(item);\n        var mlTo = {};\n\n        mlFrom.type = null;\n\n        mlFrom.coord = [];\n        mlTo.coord = [];\n        mlFrom.coord[baseIndex] = -Infinity;\n        mlTo.coord[baseIndex] = Infinity;\n\n        var precision = mlModel.get('precision');\n        if (precision >= 0 && typeof value === 'number') {\n            value = +value.toFixed(Math.min(precision, 20));\n        }\n\n        mlFrom.coord[valueIndex] = mlTo.coord[valueIndex] = value;\n\n        item = [mlFrom, mlTo, { // Extra option for tooltip and label\n            type: mlType,\n            valueIndex: item.valueIndex,\n            // Force to use the value of calculated value.\n            value: value\n        }];\n    }\n\n    item = [\n        dataTransform(seriesModel, item[0]),\n        dataTransform(seriesModel, item[1]),\n        extend({}, item[2])\n    ];\n\n    // Avoid line data type is extended by from(to) data type\n    item[2].type = item[2].type || '';\n\n    // Merge from option and to option into line option\n    merge(item[2], item[0]);\n    merge(item[2], item[1]);\n\n    return item;\n};\n\nfunction isInifinity(val) {\n    return !isNaN(val) && !isFinite(val);\n}\n\n// If a markLine has one dim\nfunction ifMarkLineHasOnlyDim(dimIndex, fromCoord, toCoord, coordSys) {\n    var otherDimIndex = 1 - dimIndex;\n    var dimName = coordSys.dimensions[dimIndex];\n    return isInifinity(fromCoord[otherDimIndex]) && isInifinity(toCoord[otherDimIndex])\n        && fromCoord[dimIndex] === toCoord[dimIndex] && coordSys.getAxis(dimName).containData(fromCoord[dimIndex]);\n}\n\nfunction markLineFilter(coordSys, item) {\n    if (coordSys.type === 'cartesian2d') {\n        var fromCoord = item[0].coord;\n        var toCoord = item[1].coord;\n        // In case\n        // {\n        //  markLine: {\n        //    data: [{ yAxis: 2 }]\n        //  }\n        // }\n        if (\n            fromCoord && toCoord &&\n            (ifMarkLineHasOnlyDim(1, fromCoord, toCoord, coordSys)\n            || ifMarkLineHasOnlyDim(0, fromCoord, toCoord, coordSys))\n        ) {\n            return true;\n        }\n    }\n    return dataFilter$1(coordSys, item[0])\n        && dataFilter$1(coordSys, item[1]);\n}\n\nfunction updateSingleMarkerEndLayout(\n    data, idx, isFrom, seriesModel, api\n) {\n    var coordSys = seriesModel.coordinateSystem;\n    var itemModel = data.getItemModel(idx);\n\n    var point;\n    var xPx = parsePercent$1(itemModel.get('x'), api.getWidth());\n    var yPx = parsePercent$1(itemModel.get('y'), api.getHeight());\n    if (!isNaN(xPx) && !isNaN(yPx)) {\n        point = [xPx, yPx];\n    }\n    else {\n        // Chart like bar may have there own marker positioning logic\n        if (seriesModel.getMarkerPosition) {\n            // Use the getMarkerPoisition\n            point = seriesModel.getMarkerPosition(\n                data.getValues(data.dimensions, idx)\n            );\n        }\n        else {\n            var dims = coordSys.dimensions;\n            var x = data.get(dims[0], idx);\n            var y = data.get(dims[1], idx);\n            point = coordSys.dataToPoint([x, y]);\n        }\n        // Expand line to the edge of grid if value on one axis is Inifnity\n        // In case\n        //  markLine: {\n        //    data: [{\n        //      yAxis: 2\n        //      // or\n        //      type: 'average'\n        //    }]\n        //  }\n        if (coordSys.type === 'cartesian2d') {\n            var xAxis = coordSys.getAxis('x');\n            var yAxis = coordSys.getAxis('y');\n            var dims = coordSys.dimensions;\n            if (isInifinity(data.get(dims[0], idx))) {\n                point[0] = xAxis.toGlobalCoord(xAxis.getExtent()[isFrom ? 0 : 1]);\n            }\n            else if (isInifinity(data.get(dims[1], idx))) {\n                point[1] = yAxis.toGlobalCoord(yAxis.getExtent()[isFrom ? 0 : 1]);\n            }\n        }\n\n        // Use x, y if has any\n        if (!isNaN(xPx)) {\n            point[0] = xPx;\n        }\n        if (!isNaN(yPx)) {\n            point[1] = yPx;\n        }\n    }\n\n    data.setItemLayout(idx, point);\n}\n\nMarkerView.extend({\n\n    type: 'markLine',\n\n    // updateLayout: function (markLineModel, ecModel, api) {\n    //     ecModel.eachSeries(function (seriesModel) {\n    //         var mlModel = seriesModel.markLineModel;\n    //         if (mlModel) {\n    //             var mlData = mlModel.getData();\n    //             var fromData = mlModel.__from;\n    //             var toData = mlModel.__to;\n    //             // Update visual and layout of from symbol and to symbol\n    //             fromData.each(function (idx) {\n    //                 updateSingleMarkerEndLayout(fromData, idx, true, seriesModel, api);\n    //                 updateSingleMarkerEndLayout(toData, idx, false, seriesModel, api);\n    //             });\n    //             // Update layout of line\n    //             mlData.each(function (idx) {\n    //                 mlData.setItemLayout(idx, [\n    //                     fromData.getItemLayout(idx),\n    //                     toData.getItemLayout(idx)\n    //                 ]);\n    //             });\n\n    //             this.markerGroupMap.get(seriesModel.id).updateLayout();\n\n    //         }\n    //     }, this);\n    // },\n\n    updateTransform: function (markLineModel, ecModel, api) {\n        ecModel.eachSeries(function (seriesModel) {\n            var mlModel = seriesModel.markLineModel;\n            if (mlModel) {\n                var mlData = mlModel.getData();\n                var fromData = mlModel.__from;\n                var toData = mlModel.__to;\n                // Update visual and layout of from symbol and to symbol\n                fromData.each(function (idx) {\n                    updateSingleMarkerEndLayout(fromData, idx, true, seriesModel, api);\n                    updateSingleMarkerEndLayout(toData, idx, false, seriesModel, api);\n                });\n                // Update layout of line\n                mlData.each(function (idx) {\n                    mlData.setItemLayout(idx, [\n                        fromData.getItemLayout(idx),\n                        toData.getItemLayout(idx)\n                    ]);\n                });\n\n                this.markerGroupMap.get(seriesModel.id).updateLayout();\n\n            }\n        }, this);\n    },\n\n    renderSeries: function (seriesModel, mlModel, ecModel, api) {\n        var coordSys = seriesModel.coordinateSystem;\n        var seriesId = seriesModel.id;\n        var seriesData = seriesModel.getData();\n\n        var lineDrawMap = this.markerGroupMap;\n        var lineDraw = lineDrawMap.get(seriesId)\n            || lineDrawMap.set(seriesId, new LineDraw());\n        this.group.add(lineDraw.group);\n\n        var mlData = createList$2(coordSys, seriesModel, mlModel);\n\n        var fromData = mlData.from;\n        var toData = mlData.to;\n        var lineData = mlData.line;\n\n        mlModel.__from = fromData;\n        mlModel.__to = toData;\n        // Line data for tooltip and formatter\n        mlModel.setData(lineData);\n\n        var symbolType = mlModel.get('symbol');\n        var symbolSize = mlModel.get('symbolSize');\n        if (!isArray(symbolType)) {\n            symbolType = [symbolType, symbolType];\n        }\n        if (typeof symbolSize === 'number') {\n            symbolSize = [symbolSize, symbolSize];\n        }\n\n        // Update visual and layout of from symbol and to symbol\n        mlData.from.each(function (idx) {\n            updateDataVisualAndLayout(fromData, idx, true);\n            updateDataVisualAndLayout(toData, idx, false);\n        });\n\n        // Update visual and layout of line\n        lineData.each(function (idx) {\n            var lineColor = lineData.getItemModel(idx).get('lineStyle.color');\n            lineData.setItemVisual(idx, {\n                color: lineColor || fromData.getItemVisual(idx, 'color')\n            });\n            lineData.setItemLayout(idx, [\n                fromData.getItemLayout(idx),\n                toData.getItemLayout(idx)\n            ]);\n\n            lineData.setItemVisual(idx, {\n                'fromSymbolSize': fromData.getItemVisual(idx, 'symbolSize'),\n                'fromSymbol': fromData.getItemVisual(idx, 'symbol'),\n                'toSymbolSize': toData.getItemVisual(idx, 'symbolSize'),\n                'toSymbol': toData.getItemVisual(idx, 'symbol')\n            });\n        });\n\n        lineDraw.updateData(lineData);\n\n        // Set host model for tooltip\n        // FIXME\n        mlData.line.eachItemGraphicEl(function (el, idx) {\n            el.traverse(function (child) {\n                child.dataModel = mlModel;\n            });\n        });\n\n        function updateDataVisualAndLayout(data, idx, isFrom) {\n            var itemModel = data.getItemModel(idx);\n\n            updateSingleMarkerEndLayout(\n                data, idx, isFrom, seriesModel, api\n            );\n\n            data.setItemVisual(idx, {\n                symbolSize: itemModel.get('symbolSize') || symbolSize[isFrom ? 0 : 1],\n                symbol: itemModel.get('symbol', true) || symbolType[isFrom ? 0 : 1],\n                color: itemModel.get('itemStyle.color') || seriesData.getVisual('color')\n            });\n        }\n\n        lineDraw.__keep = true;\n\n        lineDraw.group.silent = mlModel.get('silent') || seriesModel.get('silent');\n    }\n});\n\n/**\n * @inner\n * @param {module:echarts/coord/*} coordSys\n * @param {module:echarts/model/Series} seriesModel\n * @param {module:echarts/model/Model} mpModel\n */\nfunction createList$2(coordSys, seriesModel, mlModel) {\n\n    var coordDimsInfos;\n    if (coordSys) {\n        coordDimsInfos = map(coordSys && coordSys.dimensions, function (coordDim) {\n            var info = seriesModel.getData().getDimensionInfo(\n                seriesModel.getData().mapDimension(coordDim)\n            ) || {};\n            // In map series data don't have lng and lat dimension. Fallback to same with coordSys\n            return defaults({name: coordDim}, info);\n        });\n    }\n    else {\n        coordDimsInfos =[{\n            name: 'value',\n            type: 'float'\n        }];\n    }\n\n    var fromData = new List(coordDimsInfos, mlModel);\n    var toData = new List(coordDimsInfos, mlModel);\n    // No dimensions\n    var lineData = new List([], mlModel);\n\n    var optData = map(mlModel.get('data'), curry(\n        markLineTransform, seriesModel, coordSys, mlModel\n    ));\n    if (coordSys) {\n        optData = filter(\n            optData, curry(markLineFilter, coordSys)\n        );\n    }\n    var dimValueGetter$$1 = coordSys ? dimValueGetter : function (item) {\n        return item.value;\n    };\n    fromData.initData(\n        map(optData, function (item) { return item[0]; }),\n        null, dimValueGetter$$1\n    );\n    toData.initData(\n        map(optData, function (item) { return item[1]; }),\n        null, dimValueGetter$$1\n    );\n    lineData.initData(\n        map(optData, function (item) { return item[2]; })\n    );\n    lineData.hasItemOption = true;\n\n    return {\n        from: fromData,\n        to: toData,\n        line: lineData\n    };\n}\n\nregisterPreprocessor(function (opt) {\n    // Make sure markLine component is enabled\n    opt.markLine = opt.markLine || {};\n});\n\nMarkerModel.extend({\n\n    type: 'markArea',\n\n    defaultOption: {\n        zlevel: 0,\n        // PENDING\n        z: 1,\n        tooltip: {\n            trigger: 'item'\n        },\n        // markArea should fixed on the coordinate system\n        animation: false,\n        label: {\n            show: true,\n            position: 'top'\n        },\n        itemStyle: {\n            // color and borderColor default to use color from series\n            // color: 'auto'\n            // borderColor: 'auto'\n            borderWidth: 0\n        },\n\n        emphasis: {\n            label: {\n                show: true,\n                position: 'top'\n            }\n        }\n    }\n});\n\n// TODO Better on polar\n\nvar markAreaTransform = function (seriesModel, coordSys, maModel, item) {\n    var lt = dataTransform(seriesModel, item[0]);\n    var rb = dataTransform(seriesModel, item[1]);\n    var retrieve$$1 = retrieve;\n\n    // FIXME make sure lt is less than rb\n    var ltCoord = lt.coord;\n    var rbCoord = rb.coord;\n    ltCoord[0] = retrieve$$1(ltCoord[0], -Infinity);\n    ltCoord[1] = retrieve$$1(ltCoord[1], -Infinity);\n\n    rbCoord[0] = retrieve$$1(rbCoord[0], Infinity);\n    rbCoord[1] = retrieve$$1(rbCoord[1], Infinity);\n\n    // Merge option into one\n    var result = mergeAll([{}, lt, rb]);\n\n    result.coord = [\n        lt.coord, rb.coord\n    ];\n    result.x0 = lt.x;\n    result.y0 = lt.y;\n    result.x1 = rb.x;\n    result.y1 = rb.y;\n    return result;\n};\n\nfunction isInifinity$1(val) {\n    return !isNaN(val) && !isFinite(val);\n}\n\n// If a markArea has one dim\nfunction ifMarkLineHasOnlyDim$1(dimIndex, fromCoord, toCoord, coordSys) {\n    var otherDimIndex = 1 - dimIndex;\n    return isInifinity$1(fromCoord[otherDimIndex]) && isInifinity$1(toCoord[otherDimIndex]);\n}\n\nfunction markAreaFilter(coordSys, item) {\n    var fromCoord = item.coord[0];\n    var toCoord = item.coord[1];\n    if (coordSys.type === 'cartesian2d') {\n        // In case\n        // {\n        //  markArea: {\n        //    data: [{ yAxis: 2 }]\n        //  }\n        // }\n        if (\n            fromCoord && toCoord &&\n            (ifMarkLineHasOnlyDim$1(1, fromCoord, toCoord, coordSys)\n            || ifMarkLineHasOnlyDim$1(0, fromCoord, toCoord, coordSys))\n        ) {\n            return true;\n        }\n    }\n    return dataFilter$1(coordSys, {\n            coord: fromCoord,\n            x: item.x0,\n            y: item.y0\n        })\n        || dataFilter$1(coordSys, {\n            coord: toCoord,\n            x: item.x1,\n            y: item.y1\n        });\n}\n\n// dims can be ['x0', 'y0'], ['x1', 'y1'], ['x0', 'y1'], ['x1', 'y0']\nfunction getSingleMarkerEndPoint(data, idx, dims, seriesModel, api) {\n    var coordSys = seriesModel.coordinateSystem;\n    var itemModel = data.getItemModel(idx);\n\n    var point;\n    var xPx = parsePercent$1(itemModel.get(dims[0]), api.getWidth());\n    var yPx = parsePercent$1(itemModel.get(dims[1]), api.getHeight());\n    if (!isNaN(xPx) && !isNaN(yPx)) {\n        point = [xPx, yPx];\n    }\n    else {\n        // Chart like bar may have there own marker positioning logic\n        if (seriesModel.getMarkerPosition) {\n            // Use the getMarkerPoisition\n            point = seriesModel.getMarkerPosition(\n                data.getValues(dims, idx)\n            );\n        }\n        else {\n            var x = data.get(dims[0], idx);\n            var y = data.get(dims[1], idx);\n            var pt = [x, y];\n            coordSys.clampData && coordSys.clampData(pt, pt);\n            point = coordSys.dataToPoint(pt, true);\n        }\n        if (coordSys.type === 'cartesian2d') {\n            var xAxis = coordSys.getAxis('x');\n            var yAxis = coordSys.getAxis('y');\n            var x = data.get(dims[0], idx);\n            var y = data.get(dims[1], idx);\n            if (isInifinity$1(x)) {\n                point[0] = xAxis.toGlobalCoord(xAxis.getExtent()[dims[0] === 'x0' ? 0 : 1]);\n            }\n            else if (isInifinity$1(y)) {\n                point[1] = yAxis.toGlobalCoord(yAxis.getExtent()[dims[1] === 'y0' ? 0 : 1]);\n            }\n        }\n\n        // Use x, y if has any\n        if (!isNaN(xPx)) {\n            point[0] = xPx;\n        }\n        if (!isNaN(yPx)) {\n            point[1] = yPx;\n        }\n    }\n\n    return point;\n}\n\nvar dimPermutations = [['x0', 'y0'], ['x1', 'y0'], ['x1', 'y1'], ['x0', 'y1']];\n\nMarkerView.extend({\n\n    type: 'markArea',\n\n    // updateLayout: function (markAreaModel, ecModel, api) {\n    //     ecModel.eachSeries(function (seriesModel) {\n    //         var maModel = seriesModel.markAreaModel;\n    //         if (maModel) {\n    //             var areaData = maModel.getData();\n    //             areaData.each(function (idx) {\n    //                 var points = zrUtil.map(dimPermutations, function (dim) {\n    //                     return getSingleMarkerEndPoint(areaData, idx, dim, seriesModel, api);\n    //                 });\n    //                 // Layout\n    //                 areaData.setItemLayout(idx, points);\n    //                 var el = areaData.getItemGraphicEl(idx);\n    //                 el.setShape('points', points);\n    //             });\n    //         }\n    //     }, this);\n    // },\n\n    updateTransform: function (markAreaModel, ecModel, api) {\n        ecModel.eachSeries(function (seriesModel) {\n            var maModel = seriesModel.markAreaModel;\n            if (maModel) {\n                var areaData = maModel.getData();\n                areaData.each(function (idx) {\n                    var points = map(dimPermutations, function (dim) {\n                        return getSingleMarkerEndPoint(areaData, idx, dim, seriesModel, api);\n                    });\n                    // Layout\n                    areaData.setItemLayout(idx, points);\n                    var el = areaData.getItemGraphicEl(idx);\n                    el.setShape('points', points);\n                });\n            }\n        }, this);\n    },\n\n    renderSeries: function (seriesModel, maModel, ecModel, api) {\n        var coordSys = seriesModel.coordinateSystem;\n        var seriesName = seriesModel.name;\n        var seriesData = seriesModel.getData();\n\n        var areaGroupMap = this.markerGroupMap;\n        var polygonGroup = areaGroupMap.get(seriesName)\n            || areaGroupMap.set(seriesName, {group: new Group()});\n\n        this.group.add(polygonGroup.group);\n        polygonGroup.__keep = true;\n\n        var areaData = createList$3(coordSys, seriesModel, maModel);\n\n        // Line data for tooltip and formatter\n        maModel.setData(areaData);\n\n        // Update visual and layout of line\n        areaData.each(function (idx) {\n            // Layout\n            areaData.setItemLayout(idx, map(dimPermutations, function (dim) {\n                return getSingleMarkerEndPoint(areaData, idx, dim, seriesModel, api);\n            }));\n\n            // Visual\n            areaData.setItemVisual(idx, {\n                color: seriesData.getVisual('color')\n            });\n        });\n\n\n        areaData.diff(polygonGroup.__data)\n            .add(function (idx) {\n                var polygon = new Polygon({\n                    shape: {\n                        points: areaData.getItemLayout(idx)\n                    }\n                });\n                areaData.setItemGraphicEl(idx, polygon);\n                polygonGroup.group.add(polygon);\n            })\n            .update(function (newIdx, oldIdx) {\n                var polygon = polygonGroup.__data.getItemGraphicEl(oldIdx);\n                updateProps(polygon, {\n                    shape: {\n                        points: areaData.getItemLayout(newIdx)\n                    }\n                }, maModel, newIdx);\n                polygonGroup.group.add(polygon);\n                areaData.setItemGraphicEl(newIdx, polygon);\n            })\n            .remove(function (idx) {\n                var polygon = polygonGroup.__data.getItemGraphicEl(idx);\n                polygonGroup.group.remove(polygon);\n            })\n            .execute();\n\n        areaData.eachItemGraphicEl(function (polygon, idx) {\n            var itemModel = areaData.getItemModel(idx);\n            var labelModel = itemModel.getModel('label');\n            var labelHoverModel = itemModel.getModel('emphasis.label');\n            var color = areaData.getItemVisual(idx, 'color');\n            polygon.useStyle(\n                defaults(\n                    itemModel.getModel('itemStyle').getItemStyle(),\n                    {\n                        fill: modifyAlpha(color, 0.4),\n                        stroke: color\n                    }\n                )\n            );\n\n            polygon.hoverStyle = itemModel.getModel('emphasis.itemStyle').getItemStyle();\n\n            setLabelStyle(\n                polygon.style, polygon.hoverStyle, labelModel, labelHoverModel,\n                {\n                    labelFetcher: maModel,\n                    labelDataIndex: idx,\n                    defaultText: areaData.getName(idx) || '',\n                    isRectText: true,\n                    autoColor: color\n                }\n            );\n\n            setHoverStyle(polygon, {});\n\n            polygon.dataModel = maModel;\n        });\n\n        polygonGroup.__data = areaData;\n\n        polygonGroup.group.silent = maModel.get('silent') || seriesModel.get('silent');\n    }\n});\n\n/**\n * @inner\n * @param {module:echarts/coord/*} coordSys\n * @param {module:echarts/model/Series} seriesModel\n * @param {module:echarts/model/Model} mpModel\n */\nfunction createList$3(coordSys, seriesModel, maModel) {\n\n    var coordDimsInfos;\n    var areaData;\n    var dims = ['x0', 'y0', 'x1', 'y1'];\n    if (coordSys) {\n        coordDimsInfos = map(coordSys && coordSys.dimensions, function (coordDim) {\n            var data = seriesModel.getData();\n            var info = data.getDimensionInfo(\n                data.mapDimension(coordDim)\n            ) || {};\n            // In map series data don't have lng and lat dimension. Fallback to same with coordSys\n            return defaults({name: coordDim}, info);\n        });\n        areaData = new List(map(dims, function (dim, idx) {\n            return {\n                name: dim,\n                type: coordDimsInfos[idx % 2].type\n            };\n        }), maModel);\n    }\n    else {\n        coordDimsInfos =[{\n            name: 'value',\n            type: 'float'\n        }];\n        areaData = new List(coordDimsInfos, maModel);\n    }\n\n    var optData = map(maModel.get('data'), curry(\n        markAreaTransform, seriesModel, coordSys, maModel\n    ));\n    if (coordSys) {\n        optData = filter(\n            optData, curry(markAreaFilter, coordSys)\n        );\n    }\n\n    var dimValueGetter$$1 = coordSys ? function (item, dimName, dataIndex, dimIndex) {\n        return item.coord[Math.floor(dimIndex / 2)][dimIndex % 2];\n    } : function (item) {\n        return item.value;\n    };\n    areaData.initData(optData, null, dimValueGetter$$1);\n    areaData.hasItemOption = true;\n    return areaData;\n}\n\nregisterPreprocessor(function (opt) {\n    // Make sure markArea component is enabled\n    opt.markArea = opt.markArea || {};\n});\n\nvar preprocessor$3 = function (option) {\n    var timelineOpt = option && option.timeline;\n\n    if (!isArray(timelineOpt)) {\n        timelineOpt = timelineOpt ? [timelineOpt] : [];\n    }\n\n    each$1(timelineOpt, function (opt) {\n        if (!opt) {\n            return;\n        }\n\n        compatibleEC2(opt);\n    });\n};\n\nfunction compatibleEC2(opt) {\n    var type = opt.type;\n\n    var ec2Types = {'number': 'value', 'time': 'time'};\n\n    // Compatible with ec2\n    if (ec2Types[type]) {\n        opt.axisType = ec2Types[type];\n        delete opt.type;\n    }\n\n    transferItem(opt);\n\n    if (has$2(opt, 'controlPosition')) {\n        var controlStyle = opt.controlStyle || (opt.controlStyle = {});\n        if (!has$2(controlStyle, 'position')) {\n            controlStyle.position = opt.controlPosition;\n        }\n        if (controlStyle.position === 'none' && !has$2(controlStyle, 'show')) {\n            controlStyle.show = false;\n            delete controlStyle.position;\n        }\n        delete opt.controlPosition;\n    }\n\n    each$1(opt.data || [], function (dataItem) {\n        if (isObject$1(dataItem) && !isArray(dataItem)) {\n            if (!has$2(dataItem, 'value') && has$2(dataItem, 'name')) {\n                // In ec2, using name as value.\n                dataItem.value = dataItem.name;\n            }\n            transferItem(dataItem);\n        }\n    });\n}\n\nfunction transferItem(opt) {\n    var itemStyle = opt.itemStyle || (opt.itemStyle = {});\n\n    var itemStyleEmphasis = itemStyle.emphasis || (itemStyle.emphasis = {});\n\n    // Transfer label out\n    var label = opt.label || (opt.label || {});\n    var labelNormal = label.normal || (label.normal = {});\n    var excludeLabelAttr = {normal: 1, emphasis: 1};\n\n    each$1(label, function (value, name) {\n        if (!excludeLabelAttr[name] && !has$2(labelNormal, name)) {\n            labelNormal[name] = value;\n        }\n    });\n\n    if (itemStyleEmphasis.label && !has$2(label, 'emphasis')) {\n        label.emphasis = itemStyleEmphasis.label;\n        delete itemStyleEmphasis.label;\n    }\n}\n\nfunction has$2(obj, attr) {\n    return obj.hasOwnProperty(attr);\n}\n\nComponentModel.registerSubTypeDefaulter('timeline', function () {\n    // Only slider now.\n    return 'slider';\n});\n\nregisterAction(\n\n    {type: 'timelineChange', event: 'timelineChanged', update: 'prepareAndUpdate'},\n\n    function (payload, ecModel) {\n\n        var timelineModel = ecModel.getComponent('timeline');\n        if (timelineModel && payload.currentIndex != null) {\n            timelineModel.setCurrentIndex(payload.currentIndex);\n\n            if (!timelineModel.get('loop', true) && timelineModel.isIndexMax()) {\n                timelineModel.setPlayState(false);\n            }\n        }\n\n        // Set normalized currentIndex to payload.\n        ecModel.resetOption('timeline');\n\n        return defaults({\n            currentIndex: timelineModel.option.currentIndex\n        }, payload);\n    }\n);\n\nregisterAction(\n\n    {type: 'timelinePlayChange', event: 'timelinePlayChanged', update: 'update'},\n\n    function (payload, ecModel) {\n        var timelineModel = ecModel.getComponent('timeline');\n        if (timelineModel && payload.playState != null) {\n            timelineModel.setPlayState(payload.playState);\n        }\n    }\n);\n\nvar TimelineModel = ComponentModel.extend({\n\n    type: 'timeline',\n\n    layoutMode: 'box',\n\n    /**\n     * @protected\n     */\n    defaultOption: {\n\n        zlevel: 0,                  // \n        z: 4,                       // \n        show: true,\n\n        axisType: 'time',  //  value, category\n\n        realtime: true,\n\n        left: '20%',\n        top: null,\n        right: '20%',\n        bottom: 0,\n        width: null,\n        height: 40,\n        padding: 5,\n\n        controlPosition: 'left',           // 'left' 'right' 'top' 'bottom' 'none'\n        autoPlay: false,\n        rewind: false,                     // \n        loop: true,\n        playInterval: 2000,                // ms\n\n        currentIndex: 0,\n\n        itemStyle: {},\n        label: {\n            color: '#000'\n        },\n\n        data: []\n    },\n\n    /**\n     * @override\n     */\n    init: function (option, parentModel, ecModel) {\n\n        /**\n         * @private\n         * @type {module:echarts/data/List}\n         */\n        this._data;\n\n        /**\n         * @private\n         * @type {Array.<string>}\n         */\n        this._names;\n\n        this.mergeDefaultAndTheme(option, ecModel);\n        this._initData();\n    },\n\n    /**\n     * @override\n     */\n    mergeOption: function (option) {\n        TimelineModel.superApply(this, 'mergeOption', arguments);\n        this._initData();\n    },\n\n    /**\n     * @param {number} [currentIndex]\n     */\n    setCurrentIndex: function (currentIndex) {\n        if (currentIndex == null) {\n            currentIndex = this.option.currentIndex;\n        }\n        var count = this._data.count();\n\n        if (this.option.loop) {\n            currentIndex = (currentIndex % count + count) % count;\n        }\n        else {\n            currentIndex >= count && (currentIndex = count - 1);\n            currentIndex < 0 && (currentIndex = 0);\n        }\n\n        this.option.currentIndex = currentIndex;\n    },\n\n    /**\n     * @return {number} currentIndex\n     */\n    getCurrentIndex: function () {\n        return this.option.currentIndex;\n    },\n\n    /**\n     * @return {boolean}\n     */\n    isIndexMax: function () {\n        return this.getCurrentIndex() >= this._data.count() - 1;\n    },\n\n    /**\n     * @param {boolean} state true: play, false: stop\n     */\n    setPlayState: function (state) {\n        this.option.autoPlay = !!state;\n    },\n\n    /**\n     * @return {boolean} true: play, false: stop\n     */\n    getPlayState: function () {\n        return !!this.option.autoPlay;\n    },\n\n    /**\n     * @private\n     */\n    _initData: function () {\n        var thisOption = this.option;\n        var dataArr = thisOption.data || [];\n        var axisType = thisOption.axisType;\n        var names = this._names = [];\n\n        if (axisType === 'category') {\n            var idxArr = [];\n            each$1(dataArr, function (item, index) {\n                var value = getDataItemValue(item);\n                var newItem;\n\n                if (isObject$1(item)) {\n                    newItem = clone(item);\n                    newItem.value = index;\n                }\n                else {\n                    newItem = index;\n                }\n\n                idxArr.push(newItem);\n\n                if (!isString(value) && (value == null || isNaN(value))) {\n                    value = '';\n                }\n\n                names.push(value + '');\n            });\n            dataArr = idxArr;\n        }\n\n        var dimType = ({category: 'ordinal', time: 'time'})[axisType] || 'number';\n\n        var data = this._data = new List([{name: 'value', type: dimType}], this);\n\n        data.initData(dataArr, names);\n    },\n\n    getData: function () {\n        return this._data;\n    },\n\n    /**\n     * @public\n     * @return {Array.<string>} categoreis\n     */\n    getCategories: function () {\n        if (this.get('axisType') === 'category') {\n            return this._names.slice();\n        }\n    }\n\n});\n\nvar SliderTimelineModel = TimelineModel.extend({\n\n    type: 'timeline.slider',\n\n    /**\n     * @protected\n     */\n    defaultOption: {\n\n        backgroundColor: 'rgba(0,0,0,0)',   // \n        borderColor: '#ccc',               // \n        borderWidth: 0,                    // px0\n\n        orient: 'horizontal',              // 'vertical'\n        inverse: false,\n\n        tooltip: {                          // boolean or Object\n            trigger: 'item'                 // data item may also have tootip attr.\n        },\n\n        symbol: 'emptyCircle',\n        symbolSize: 10,\n\n        lineStyle: {\n            show: true,\n            width: 2,\n            color: '#304654'\n        },\n        label: {                            // \n            position: 'auto',           // auto left right top bottom\n                                        // When using number, label position is not\n                                        // restricted by viewRect.\n                                        // positive: right/bottom, negative: left/top\n            show: true,\n            interval: 'auto',\n            rotate: 0,\n            // formatter: null,\n            // TEXTSTYLE\n            color: '#304654'\n        },\n        itemStyle: {\n            color: '#304654',\n            borderWidth: 1\n        },\n\n        checkpointStyle: {\n            symbol: 'circle',\n            symbolSize: 13,\n            color: '#c23531',\n            borderWidth: 5,\n            borderColor: 'rgba(194,53,49, 0.5)',\n            animation: true,\n            animationDuration: 300,\n            animationEasing: 'quinticInOut'\n        },\n\n        controlStyle: {\n            show: true,\n            showPlayBtn: true,\n            showPrevBtn: true,\n            showNextBtn: true,\n            itemSize: 22,\n            itemGap: 12,\n            position: 'left',  // 'left' 'right' 'top' 'bottom'\n            playIcon: 'path://M31.6,53C17.5,53,6,41.5,6,27.4S17.5,1.8,31.6,1.8C45.7,1.8,57.2,13.3,57.2,27.4S45.7,53,31.6,53z M31.6,3.3 C18.4,3.3,7.5,14.1,7.5,27.4c0,13.3,10.8,24.1,24.1,24.1C44.9,51.5,55.7,40.7,55.7,27.4C55.7,14.1,44.9,3.3,31.6,3.3z M24.9,21.3 c0-2.2,1.6-3.1,3.5-2l10.5,6.1c1.899,1.1,1.899,2.9,0,4l-10.5,6.1c-1.9,1.1-3.5,0.2-3.5-2V21.3z', // jshint ignore:line\n            stopIcon: 'path://M30.9,53.2C16.8,53.2,5.3,41.7,5.3,27.6S16.8,2,30.9,2C45,2,56.4,13.5,56.4,27.6S45,53.2,30.9,53.2z M30.9,3.5C17.6,3.5,6.8,14.4,6.8,27.6c0,13.3,10.8,24.1,24.101,24.1C44.2,51.7,55,40.9,55,27.6C54.9,14.4,44.1,3.5,30.9,3.5z M36.9,35.8c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H36c0.5,0,0.9,0.4,0.9,1V35.8z M27.8,35.8 c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H27c0.5,0,0.9,0.4,0.9,1L27.8,35.8L27.8,35.8z', // jshint ignore:line\n            nextIcon: 'path://M18.6,50.8l22.5-22.5c0.2-0.2,0.3-0.4,0.3-0.7c0-0.3-0.1-0.5-0.3-0.7L18.7,4.4c-0.1-0.1-0.2-0.3-0.2-0.5 c0-0.4,0.3-0.8,0.8-0.8c0.2,0,0.5,0.1,0.6,0.3l23.5,23.5l0,0c0.2,0.2,0.3,0.4,0.3,0.7c0,0.3-0.1,0.5-0.3,0.7l-0.1,0.1L19.7,52 c-0.1,0.1-0.3,0.2-0.5,0.2c-0.4,0-0.8-0.3-0.8-0.8C18.4,51.2,18.5,51,18.6,50.8z', // jshint ignore:line\n            prevIcon: 'path://M43,52.8L20.4,30.3c-0.2-0.2-0.3-0.4-0.3-0.7c0-0.3,0.1-0.5,0.3-0.7L42.9,6.4c0.1-0.1,0.2-0.3,0.2-0.5 c0-0.4-0.3-0.8-0.8-0.8c-0.2,0-0.5,0.1-0.6,0.3L18.3,28.8l0,0c-0.2,0.2-0.3,0.4-0.3,0.7c0,0.3,0.1,0.5,0.3,0.7l0.1,0.1L41.9,54 c0.1,0.1,0.3,0.2,0.5,0.2c0.4,0,0.8-0.3,0.8-0.8C43.2,53.2,43.1,53,43,52.8z', // jshint ignore:line\n\n            color: '#304654',\n            borderColor: '#304654',\n            borderWidth: 1\n        },\n\n        emphasis: {\n            label: {\n                show: true,\n                // TEXTSTYLE\n                color: '#c23531'\n            },\n\n            itemStyle: {\n                color: '#c23531'\n            },\n\n            controlStyle: {\n                color: '#c23531',\n                borderColor: '#c23531',\n                borderWidth: 2\n            }\n        },\n        data: []\n    }\n\n});\n\nmixin(SliderTimelineModel, dataFormatMixin);\n\nvar TimelineView = Component.extend({\n    type: 'timeline'\n});\n\n/**\n * Extend axis 2d\n * @constructor module:echarts/coord/cartesian/Axis2D\n * @extends {module:echarts/coord/cartesian/Axis}\n * @param {string} dim\n * @param {*} scale\n * @param {Array.<number>} coordExtent\n * @param {string} axisType\n * @param {string} position\n */\nvar TimelineAxis = function (dim, scale, coordExtent, axisType) {\n\n    Axis.call(this, dim, scale, coordExtent);\n\n    /**\n     * Axis type\n     *  - 'category'\n     *  - 'value'\n     *  - 'time'\n     *  - 'log'\n     * @type {string}\n     */\n    this.type = axisType || 'value';\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this._autoLabelInterval;\n\n    /**\n     * Axis model\n     * @param {module:echarts/component/TimelineModel}\n     */\n    this.model = null;\n};\n\nTimelineAxis.prototype = {\n\n    constructor: TimelineAxis,\n\n    /**\n     * @public\n     * @return {number}\n     */\n    getLabelInterval: function () {\n        var timelineModel = this.model;\n        var labelModel = timelineModel.getModel('label');\n        var labelInterval = labelModel.get('interval');\n\n        if (labelInterval != null && labelInterval != 'auto') {\n            return labelInterval;\n        }\n\n        var labelInterval = this._autoLabelInterval;\n\n        if (!labelInterval) {\n            labelInterval = this._autoLabelInterval = getAxisLabelInterval(\n                map(this.scale.getTicks(), this.dataToCoord, this),\n                getFormattedLabels(this, labelModel.get('formatter')),\n                labelModel.getFont(),\n                timelineModel.get('orient') === 'horizontal' ? 0 : 90,\n                labelModel.get('rotate')\n            );\n        }\n\n        return labelInterval;\n    },\n\n    /**\n     * If label is ignored.\n     * Automatically used when axis is category and label can not be all shown\n     * @public\n     * @param  {number} idx\n     * @return {boolean}\n     */\n    isLabelIgnored: function (idx) {\n        if (this.type === 'category') {\n            var labelInterval = this.getLabelInterval();\n            return ((typeof labelInterval === 'function')\n                && !labelInterval(idx, this.scale.getLabel(idx)))\n                || idx % (labelInterval + 1);\n        }\n    }\n\n};\n\ninherits(TimelineAxis, Axis);\n\nvar bind$6 = bind;\nvar each$28 = each$1;\n\nvar PI$4 = Math.PI;\n\nTimelineView.extend({\n\n    type: 'timeline.slider',\n\n    init: function (ecModel, api) {\n\n        this.api = api;\n\n        /**\n         * @private\n         * @type {module:echarts/component/timeline/TimelineAxis}\n         */\n        this._axis;\n\n        /**\n         * @private\n         * @type {module:zrender/core/BoundingRect}\n         */\n        this._viewRect;\n\n        /**\n         * @type {number}\n         */\n        this._timer;\n\n        /**\n         * @type {module:zrender/Element}\n         */\n        this._currentPointer;\n\n        /**\n         * @type {module:zrender/container/Group}\n         */\n        this._mainGroup;\n\n        /**\n         * @type {module:zrender/container/Group}\n         */\n        this._labelGroup;\n    },\n\n    /**\n     * @override\n     */\n    render: function (timelineModel, ecModel, api, payload) {\n        this.model = timelineModel;\n        this.api = api;\n        this.ecModel = ecModel;\n\n        this.group.removeAll();\n\n        if (timelineModel.get('show', true)) {\n\n            var layoutInfo = this._layout(timelineModel, api);\n            var mainGroup = this._createGroup('mainGroup');\n            var labelGroup = this._createGroup('labelGroup');\n\n            /**\n             * @private\n             * @type {module:echarts/component/timeline/TimelineAxis}\n             */\n            var axis = this._axis = this._createAxis(layoutInfo, timelineModel);\n\n            timelineModel.formatTooltip = function (dataIndex) {\n                return encodeHTML(axis.scale.getLabel(dataIndex));\n            };\n\n            each$28(\n                ['AxisLine', 'AxisTick', 'Control', 'CurrentPointer'],\n                function (name) {\n                    this['_render' + name](layoutInfo, mainGroup, axis, timelineModel);\n                },\n                this\n            );\n\n            this._renderAxisLabel(layoutInfo, labelGroup, axis, timelineModel);\n            this._position(layoutInfo, timelineModel);\n        }\n\n        this._doPlayStop();\n    },\n\n    /**\n     * @override\n     */\n    remove: function () {\n        this._clearTimer();\n        this.group.removeAll();\n    },\n\n    /**\n     * @override\n     */\n    dispose: function () {\n        this._clearTimer();\n    },\n\n    _layout: function (timelineModel, api) {\n        var labelPosOpt = timelineModel.get('label.position');\n        var orient = timelineModel.get('orient');\n        var viewRect = getViewRect$4(timelineModel, api);\n        // Auto label offset.\n        if (labelPosOpt == null || labelPosOpt === 'auto') {\n            labelPosOpt = orient === 'horizontal'\n                ? ((viewRect.y + viewRect.height / 2) < api.getHeight() / 2 ? '-' : '+')\n                : ((viewRect.x + viewRect.width / 2) < api.getWidth() / 2 ? '+' : '-');\n        }\n        else if (isNaN(labelPosOpt)) {\n            labelPosOpt = ({\n                horizontal: {top: '-', bottom: '+'},\n                vertical: {left: '-', right: '+'}\n            })[orient][labelPosOpt];\n        }\n\n        var labelAlignMap = {\n            horizontal: 'center',\n            vertical: (labelPosOpt >= 0 || labelPosOpt === '+') ? 'left' : 'right'\n        };\n\n        var labelBaselineMap = {\n            horizontal: (labelPosOpt >= 0 || labelPosOpt === '+') ? 'top' : 'bottom',\n            vertical: 'middle'\n        };\n        var rotationMap = {\n            horizontal: 0,\n            vertical: PI$4 / 2\n        };\n\n        // Position\n        var mainLength = orient === 'vertical' ? viewRect.height : viewRect.width;\n\n        var controlModel = timelineModel.getModel('controlStyle');\n        var showControl = controlModel.get('show', true);\n        var controlSize = showControl ? controlModel.get('itemSize') : 0;\n        var controlGap = showControl ? controlModel.get('itemGap') : 0;\n        var sizePlusGap = controlSize + controlGap;\n\n        // Special label rotate.\n        var labelRotation = timelineModel.get('label.rotate') || 0;\n        labelRotation = labelRotation * PI$4 / 180; // To radian.\n\n        var playPosition;\n        var prevBtnPosition;\n        var nextBtnPosition;\n        var axisExtent;\n        var controlPosition = controlModel.get('position', true);\n        var showPlayBtn = showControl && controlModel.get('showPlayBtn', true);\n        var showPrevBtn = showControl && controlModel.get('showPrevBtn', true);\n        var showNextBtn = showControl && controlModel.get('showNextBtn', true);\n        var xLeft = 0;\n        var xRight = mainLength;\n\n        // position[0] means left, position[1] means middle.\n        if (controlPosition === 'left' || controlPosition === 'bottom') {\n            showPlayBtn && (playPosition = [0, 0], xLeft += sizePlusGap);\n            showPrevBtn && (prevBtnPosition = [xLeft, 0], xLeft += sizePlusGap);\n            showNextBtn && (nextBtnPosition = [xRight - controlSize, 0], xRight -= sizePlusGap);\n        }\n        else { // 'top' 'right'\n            showPlayBtn && (playPosition = [xRight - controlSize, 0], xRight -= sizePlusGap);\n            showPrevBtn && (prevBtnPosition = [0, 0], xLeft += sizePlusGap);\n            showNextBtn && (nextBtnPosition = [xRight - controlSize, 0], xRight -= sizePlusGap);\n        }\n        axisExtent = [xLeft, xRight];\n\n        if (timelineModel.get('inverse')) {\n            axisExtent.reverse();\n        }\n\n        return {\n            viewRect: viewRect,\n            mainLength: mainLength,\n            orient: orient,\n\n            rotation: rotationMap[orient],\n            labelRotation: labelRotation,\n            labelPosOpt: labelPosOpt,\n            labelAlign: timelineModel.get('label.align') || labelAlignMap[orient],\n            labelBaseline: timelineModel.get('label.verticalAlign')\n                || timelineModel.get('label.baseline')\n                || labelBaselineMap[orient],\n\n            // Based on mainGroup.\n            playPosition: playPosition,\n            prevBtnPosition: prevBtnPosition,\n            nextBtnPosition: nextBtnPosition,\n            axisExtent: axisExtent,\n\n            controlSize: controlSize,\n            controlGap: controlGap\n        };\n    },\n\n    _position: function (layoutInfo, timelineModel) {\n        // Position is be called finally, because bounding rect is needed for\n        // adapt content to fill viewRect (auto adapt offset).\n\n        // Timeline may be not all in the viewRect when 'offset' is specified\n        // as a number, because it is more appropriate that label aligns at\n        // 'offset' but not the other edge defined by viewRect.\n\n        var mainGroup = this._mainGroup;\n        var labelGroup = this._labelGroup;\n\n        var viewRect = layoutInfo.viewRect;\n        if (layoutInfo.orient === 'vertical') {\n            // transform to horizontal, inverse rotate by left-top point.\n            var m = create$1();\n            var rotateOriginX = viewRect.x;\n            var rotateOriginY = viewRect.y + viewRect.height;\n            translate(m, m, [-rotateOriginX, -rotateOriginY]);\n            rotate(m, m, -PI$4 / 2);\n            translate(m, m, [rotateOriginX, rotateOriginY]);\n            viewRect = viewRect.clone();\n            viewRect.applyTransform(m);\n        }\n\n        var viewBound = getBound(viewRect);\n        var mainBound = getBound(mainGroup.getBoundingRect());\n        var labelBound = getBound(labelGroup.getBoundingRect());\n\n        var mainPosition = mainGroup.position;\n        var labelsPosition = labelGroup.position;\n\n        labelsPosition[0] = mainPosition[0] = viewBound[0][0];\n\n        var labelPosOpt = layoutInfo.labelPosOpt;\n\n        if (isNaN(labelPosOpt)) { // '+' or '-'\n            var mainBoundIdx = labelPosOpt === '+' ? 0 : 1;\n            toBound(mainPosition, mainBound, viewBound, 1, mainBoundIdx);\n            toBound(labelsPosition, labelBound, viewBound, 1, 1 - mainBoundIdx);\n        }\n        else {\n            var mainBoundIdx = labelPosOpt >= 0 ? 0 : 1;\n            toBound(mainPosition, mainBound, viewBound, 1, mainBoundIdx);\n            labelsPosition[1] = mainPosition[1] + labelPosOpt;\n        }\n\n        mainGroup.attr('position', mainPosition);\n        labelGroup.attr('position', labelsPosition);\n        mainGroup.rotation = labelGroup.rotation = layoutInfo.rotation;\n\n        setOrigin(mainGroup);\n        setOrigin(labelGroup);\n\n        function setOrigin(targetGroup) {\n            var pos = targetGroup.position;\n            targetGroup.origin = [\n                viewBound[0][0] - pos[0],\n                viewBound[1][0] - pos[1]\n            ];\n        }\n\n        function getBound(rect) {\n            // [[xmin, xmax], [ymin, ymax]]\n            return [\n                [rect.x, rect.x + rect.width],\n                [rect.y, rect.y + rect.height]\n            ];\n        }\n\n        function toBound(fromPos, from, to, dimIdx, boundIdx) {\n            fromPos[dimIdx] += to[dimIdx][boundIdx] - from[dimIdx][boundIdx];\n        }\n    },\n\n    _createAxis: function (layoutInfo, timelineModel) {\n        var data = timelineModel.getData();\n        var axisType = timelineModel.get('axisType');\n\n        var scale = createScaleByModel(timelineModel, axisType);\n        var dataExtent = data.getDataExtent('value');\n        scale.setExtent(dataExtent[0], dataExtent[1]);\n        this._customizeScale(scale, data);\n        scale.niceTicks();\n\n        var axis = new TimelineAxis('value', scale, layoutInfo.axisExtent, axisType);\n        axis.model = timelineModel;\n\n        return axis;\n    },\n\n    _customizeScale: function (scale, data) {\n\n        scale.getTicks = function () {\n            return data.mapArray(['value'], function (value) {\n                return value;\n            });\n        };\n\n        scale.getTicksLabels = function () {\n            return map(this.getTicks(), scale.getLabel, scale);\n        };\n    },\n\n    _createGroup: function (name) {\n        var newGroup = this['_' + name] = new Group();\n        this.group.add(newGroup);\n        return newGroup;\n    },\n\n    _renderAxisLine: function (layoutInfo, group, axis, timelineModel) {\n        var axisExtent = axis.getExtent();\n\n        if (!timelineModel.get('lineStyle.show')) {\n            return;\n        }\n\n        group.add(new Line({\n            shape: {\n                x1: axisExtent[0], y1: 0,\n                x2: axisExtent[1], y2: 0\n            },\n            style: extend(\n                {lineCap: 'round'},\n                timelineModel.getModel('lineStyle').getLineStyle()\n            ),\n            silent: true,\n            z2: 1\n        }));\n    },\n\n    /**\n     * @private\n     */\n    _renderAxisTick: function (layoutInfo, group, axis, timelineModel) {\n        var data = timelineModel.getData();\n        var ticks = axis.scale.getTicks();\n\n        each$28(ticks, function (value, dataIndex) {\n\n            var tickCoord = axis.dataToCoord(value);\n            var itemModel = data.getItemModel(dataIndex);\n            var itemStyleModel = itemModel.getModel('itemStyle');\n            var hoverStyleModel = itemModel.getModel('emphasis.itemStyle');\n            var symbolOpt = {\n                position: [tickCoord, 0],\n                onclick: bind$6(this._changeTimeline, this, dataIndex)\n            };\n            var el = giveSymbol(itemModel, itemStyleModel, group, symbolOpt);\n            setHoverStyle(el, hoverStyleModel.getItemStyle());\n\n            if (itemModel.get('tooltip')) {\n                el.dataIndex = dataIndex;\n                el.dataModel = timelineModel;\n            }\n            else {\n                el.dataIndex = el.dataModel = null;\n            }\n\n        }, this);\n    },\n\n    /**\n     * @private\n     */\n    _renderAxisLabel: function (layoutInfo, group, axis, timelineModel) {\n        var labelModel = timelineModel.getModel('label');\n\n        if (!labelModel.get('show')) {\n            return;\n        }\n\n        var data = timelineModel.getData();\n        var ticks = axis.scale.getTicks();\n        var labels = getFormattedLabels(\n            axis, labelModel.get('formatter')\n        );\n        var labelInterval = axis.getLabelInterval();\n\n        each$28(ticks, function (tick, dataIndex) {\n            if (axis.isLabelIgnored(dataIndex, labelInterval)) {\n                return;\n            }\n\n            var itemModel = data.getItemModel(dataIndex);\n            var normalLabelModel = itemModel.getModel('label');\n            var hoverLabelModel = itemModel.getModel('emphasis.label');\n            var tickCoord = axis.dataToCoord(tick);\n            var textEl = new Text({\n                position: [tickCoord, 0],\n                rotation: layoutInfo.labelRotation - layoutInfo.rotation,\n                onclick: bind$6(this._changeTimeline, this, dataIndex),\n                silent: false\n            });\n            setTextStyle(textEl.style, normalLabelModel, {\n                text: labels[dataIndex],\n                textAlign: layoutInfo.labelAlign,\n                textVerticalAlign: layoutInfo.labelBaseline\n            });\n\n            group.add(textEl);\n            setHoverStyle(\n                textEl, setTextStyle({}, hoverLabelModel)\n            );\n\n        }, this);\n    },\n\n    /**\n     * @private\n     */\n    _renderControl: function (layoutInfo, group, axis, timelineModel) {\n        var controlSize = layoutInfo.controlSize;\n        var rotation = layoutInfo.rotation;\n\n        var itemStyle = timelineModel.getModel('controlStyle').getItemStyle();\n        var hoverStyle = timelineModel.getModel('emphasis.controlStyle').getItemStyle();\n        var rect = [0, -controlSize / 2, controlSize, controlSize];\n        var playState = timelineModel.getPlayState();\n        var inverse = timelineModel.get('inverse', true);\n\n        makeBtn(\n            layoutInfo.nextBtnPosition,\n            'controlStyle.nextIcon',\n            bind$6(this._changeTimeline, this, inverse ? '-' : '+')\n        );\n        makeBtn(\n            layoutInfo.prevBtnPosition,\n            'controlStyle.prevIcon',\n            bind$6(this._changeTimeline, this, inverse ? '+' : '-')\n        );\n        makeBtn(\n            layoutInfo.playPosition,\n            'controlStyle.' + (playState ? 'stopIcon' : 'playIcon'),\n            bind$6(this._handlePlayClick, this, !playState),\n            true\n        );\n\n        function makeBtn(position, iconPath, onclick, willRotate) {\n            if (!position) {\n                return;\n            }\n            var opt = {\n                position: position,\n                origin: [controlSize / 2, 0],\n                rotation: willRotate ? -rotation : 0,\n                rectHover: true,\n                style: itemStyle,\n                onclick: onclick\n            };\n            var btn = makeIcon(timelineModel, iconPath, rect, opt);\n            group.add(btn);\n            setHoverStyle(btn, hoverStyle);\n        }\n    },\n\n    _renderCurrentPointer: function (layoutInfo, group, axis, timelineModel) {\n        var data = timelineModel.getData();\n        var currentIndex = timelineModel.getCurrentIndex();\n        var pointerModel = data.getItemModel(currentIndex).getModel('checkpointStyle');\n        var me = this;\n\n        var callback = {\n            onCreate: function (pointer) {\n                pointer.draggable = true;\n                pointer.drift = bind$6(me._handlePointerDrag, me);\n                pointer.ondragend = bind$6(me._handlePointerDragend, me);\n                pointerMoveTo(pointer, currentIndex, axis, timelineModel, true);\n            },\n            onUpdate: function (pointer) {\n                pointerMoveTo(pointer, currentIndex, axis, timelineModel);\n            }\n        };\n\n        // Reuse when exists, for animation and drag.\n        this._currentPointer = giveSymbol(\n            pointerModel, pointerModel, this._mainGroup, {}, this._currentPointer, callback\n        );\n    },\n\n    _handlePlayClick: function (nextState) {\n        this._clearTimer();\n        this.api.dispatchAction({\n            type: 'timelinePlayChange',\n            playState: nextState,\n            from: this.uid\n        });\n    },\n\n    _handlePointerDrag: function (dx, dy, e) {\n        this._clearTimer();\n        this._pointerChangeTimeline([e.offsetX, e.offsetY]);\n    },\n\n    _handlePointerDragend: function (e) {\n        this._pointerChangeTimeline([e.offsetX, e.offsetY], true);\n    },\n\n    _pointerChangeTimeline: function (mousePos, trigger) {\n        var toCoord = this._toAxisCoord(mousePos)[0];\n\n        var axis = this._axis;\n        var axisExtent = asc(axis.getExtent().slice());\n\n        toCoord > axisExtent[1] && (toCoord = axisExtent[1]);\n        toCoord < axisExtent[0] && (toCoord = axisExtent[0]);\n\n        this._currentPointer.position[0] = toCoord;\n        this._currentPointer.dirty();\n\n        var targetDataIndex = this._findNearestTick(toCoord);\n        var timelineModel = this.model;\n\n        if (trigger || (\n            targetDataIndex !== timelineModel.getCurrentIndex()\n            && timelineModel.get('realtime')\n        )) {\n            this._changeTimeline(targetDataIndex);\n        }\n    },\n\n    _doPlayStop: function () {\n        this._clearTimer();\n\n        if (this.model.getPlayState()) {\n            this._timer = setTimeout(\n                bind$6(handleFrame, this),\n                this.model.get('playInterval')\n            );\n        }\n\n        function handleFrame() {\n            // Do not cache\n            var timelineModel = this.model;\n            this._changeTimeline(\n                timelineModel.getCurrentIndex()\n                + (timelineModel.get('rewind', true) ? -1 : 1)\n            );\n        }\n    },\n\n    _toAxisCoord: function (vertex) {\n        var trans = this._mainGroup.getLocalTransform();\n        return applyTransform$1(vertex, trans, true);\n    },\n\n    _findNearestTick: function (axisCoord) {\n        var data = this.model.getData();\n        var dist = Infinity;\n        var targetDataIndex;\n        var axis = this._axis;\n\n        data.each(['value'], function (value, dataIndex) {\n            var coord = axis.dataToCoord(value);\n            var d = Math.abs(coord - axisCoord);\n            if (d < dist) {\n                dist = d;\n                targetDataIndex = dataIndex;\n            }\n        });\n\n        return targetDataIndex;\n    },\n\n    _clearTimer: function () {\n        if (this._timer) {\n            clearTimeout(this._timer);\n            this._timer = null;\n        }\n    },\n\n    _changeTimeline: function (nextIndex) {\n        var currentIndex = this.model.getCurrentIndex();\n\n        if (nextIndex === '+') {\n            nextIndex = currentIndex + 1;\n        }\n        else if (nextIndex === '-') {\n            nextIndex = currentIndex - 1;\n        }\n\n        this.api.dispatchAction({\n            type: 'timelineChange',\n            currentIndex: nextIndex,\n            from: this.uid\n        });\n    }\n\n});\n\nfunction getViewRect$4(model, api) {\n    return getLayoutRect(\n        model.getBoxLayoutParams(),\n        {\n            width: api.getWidth(),\n            height: api.getHeight()\n        },\n        model.get('padding')\n    );\n}\n\nfunction makeIcon(timelineModel, objPath, rect, opts) {\n    var icon = makePath(\n        timelineModel.get(objPath).replace(/^path:\\/\\//, ''),\n        clone(opts || {}),\n        new BoundingRect(rect[0], rect[1], rect[2], rect[3]),\n        'center'\n    );\n\n    return icon;\n}\n\n/**\n * Create symbol or update symbol\n * opt: basic position and event handlers\n */\nfunction giveSymbol(hostModel, itemStyleModel, group, opt, symbol, callback) {\n    var color = itemStyleModel.get('color');\n\n    if (!symbol) {\n        var symbolType = hostModel.get('symbol');\n        symbol = createSymbol(symbolType, -1, -1, 2, 2, color);\n        symbol.setStyle('strokeNoScale', true);\n        group.add(symbol);\n        callback && callback.onCreate(symbol);\n    }\n    else {\n        symbol.setColor(color);\n        group.add(symbol); // Group may be new, also need to add.\n        callback && callback.onUpdate(symbol);\n    }\n\n    // Style\n    var itemStyle = itemStyleModel.getItemStyle(['color', 'symbol', 'symbolSize']);\n    symbol.setStyle(itemStyle);\n\n    // Transform and events.\n    opt = merge({\n        rectHover: true,\n        z2: 100\n    }, opt, true);\n\n    var symbolSize = hostModel.get('symbolSize');\n    symbolSize = symbolSize instanceof Array\n        ? symbolSize.slice()\n        : [+symbolSize, +symbolSize];\n    symbolSize[0] /= 2;\n    symbolSize[1] /= 2;\n    opt.scale = symbolSize;\n\n    var symbolOffset = hostModel.get('symbolOffset');\n    if (symbolOffset) {\n        var pos = opt.position = opt.position || [0, 0];\n        pos[0] += parsePercent$1(symbolOffset[0], symbolSize[0]);\n        pos[1] += parsePercent$1(symbolOffset[1], symbolSize[1]);\n    }\n\n    var symbolRotate = hostModel.get('symbolRotate');\n    opt.rotation = (symbolRotate || 0) * Math.PI / 180 || 0;\n\n    symbol.attr(opt);\n\n    // FIXME\n    // (1) When symbol.style.strokeNoScale is true and updateTransform is not performed,\n    // getBoundingRect will return wrong result.\n    // (This is supposed to be resolved in zrender, but it is a little difficult to\n    // leverage performance and auto updateTransform)\n    // (2) All of ancesters of symbol do not scale, so we can just updateTransform symbol.\n    symbol.updateTransform();\n\n    return symbol;\n}\n\nfunction pointerMoveTo(pointer, dataIndex, axis, timelineModel, noAnimation) {\n    if (pointer.dragging) {\n        return;\n    }\n\n    var pointerModel = timelineModel.getModel('checkpointStyle');\n    var toCoord = axis.dataToCoord(timelineModel.getData().get(['value'], dataIndex));\n\n    if (noAnimation || !pointerModel.get('animation', true)) {\n        pointer.attr({position: [toCoord, 0]});\n    }\n    else {\n        pointer.stopAnimation(true);\n        pointer.animateTo(\n            {position: [toCoord, 0]},\n            pointerModel.get('animationDuration', true),\n            pointerModel.get('animationEasing', true)\n        );\n    }\n}\n\n/**\n * DataZoom component entry\n */\n\nregisterPreprocessor(preprocessor$3);\n\nvar ToolboxModel = extendComponentModel({\n\n    type: 'toolbox',\n\n    layoutMode: {\n        type: 'box',\n        ignoreSize: true\n    },\n\n    mergeDefaultAndTheme: function (option) {\n        ToolboxModel.superApply(this, 'mergeDefaultAndTheme', arguments);\n\n        each$1(this.option.feature, function (featureOpt, featureName) {\n            var Feature = get$1(featureName);\n            Feature && merge(featureOpt, Feature.defaultOption);\n        });\n    },\n\n    defaultOption: {\n\n        show: true,\n\n        z: 6,\n\n        zlevel: 0,\n\n        orient: 'horizontal',\n\n        left: 'right',\n\n        top: 'top',\n\n        // right\n        // bottom\n\n        backgroundColor: 'transparent',\n\n        borderColor: '#ccc',\n\n        borderRadius: 0,\n\n        borderWidth: 0,\n\n        padding: 5,\n\n        itemSize: 15,\n\n        itemGap: 8,\n\n        showTitle: true,\n\n        iconStyle: {\n            borderColor: '#666',\n            color: 'none'\n        },\n        emphasis: {\n            iconStyle: {\n                borderColor: '#3E98C5'\n            }\n        }\n        // textStyle: {},\n\n        // feature\n    }\n});\n\nextendComponentView({\n\n    type: 'toolbox',\n\n    render: function (toolboxModel, ecModel, api, payload) {\n        var group = this.group;\n        group.removeAll();\n\n        if (!toolboxModel.get('show')) {\n            return;\n        }\n\n        var itemSize = +toolboxModel.get('itemSize');\n        var featureOpts = toolboxModel.get('feature') || {};\n        var features = this._features || (this._features = {});\n\n        var featureNames = [];\n        each$1(featureOpts, function (opt, name) {\n            featureNames.push(name);\n        });\n\n        (new DataDiffer(this._featureNames || [], featureNames))\n            .add(processFeature)\n            .update(processFeature)\n            .remove(curry(processFeature, null))\n            .execute();\n\n        // Keep for diff.\n        this._featureNames = featureNames;\n\n        function processFeature(newIndex, oldIndex) {\n            var featureName = featureNames[newIndex];\n            var oldName = featureNames[oldIndex];\n            var featureOpt = featureOpts[featureName];\n            var featureModel = new Model(featureOpt, toolboxModel, toolboxModel.ecModel);\n            var feature;\n\n            if (featureName && !oldName) { // Create\n                if (isUserFeatureName(featureName)) {\n                    feature = {\n                        model: featureModel,\n                        onclick: featureModel.option.onclick,\n                        featureName: featureName\n                    };\n                }\n                else {\n                    var Feature = get$1(featureName);\n                    if (!Feature) {\n                        return;\n                    }\n                    feature = new Feature(featureModel, ecModel, api);\n                }\n                features[featureName] = feature;\n            }\n            else {\n                feature = features[oldName];\n                // If feature does not exsit.\n                if (!feature) {\n                    return;\n                }\n                feature.model = featureModel;\n                feature.ecModel = ecModel;\n                feature.api = api;\n            }\n\n            if (!featureName && oldName) {\n                feature.dispose && feature.dispose(ecModel, api);\n                return;\n            }\n\n            if (!featureModel.get('show') || feature.unusable) {\n                feature.remove && feature.remove(ecModel, api);\n                return;\n            }\n\n            createIconPaths(featureModel, feature, featureName);\n\n            featureModel.setIconStatus = function (iconName, status) {\n                var option = this.option;\n                var iconPaths = this.iconPaths;\n                option.iconStatus = option.iconStatus || {};\n                option.iconStatus[iconName] = status;\n                // FIXME\n                iconPaths[iconName] && iconPaths[iconName].trigger(status);\n            };\n\n            if (feature.render) {\n                feature.render(featureModel, ecModel, api, payload);\n            }\n        }\n\n        function createIconPaths(featureModel, feature, featureName) {\n            var iconStyleModel = featureModel.getModel('iconStyle');\n            var iconStyleEmphasisModel = featureModel.getModel('emphasis.iconStyle');\n\n            // If one feature has mutiple icon. they are orginaized as\n            // {\n            //     icon: {\n            //         foo: '',\n            //         bar: ''\n            //     },\n            //     title: {\n            //         foo: '',\n            //         bar: ''\n            //     }\n            // }\n            var icons = feature.getIcons ? feature.getIcons() : featureModel.get('icon');\n            var titles = featureModel.get('title') || {};\n            if (typeof icons === 'string') {\n                var icon = icons;\n                var title = titles;\n                icons = {};\n                titles = {};\n                icons[featureName] = icon;\n                titles[featureName] = title;\n            }\n            var iconPaths = featureModel.iconPaths = {};\n            each$1(icons, function (iconStr, iconName) {\n                var path = createIcon(\n                    iconStr,\n                    {},\n                    {\n                        x: -itemSize / 2,\n                        y: -itemSize / 2,\n                        width: itemSize,\n                        height: itemSize\n                    }\n                );\n                path.setStyle(iconStyleModel.getItemStyle());\n                path.hoverStyle = iconStyleEmphasisModel.getItemStyle();\n\n                setHoverStyle(path);\n\n                if (toolboxModel.get('showTitle')) {\n                    path.__title = titles[iconName];\n                    path.on('mouseover', function () {\n                            // Should not reuse above hoverStyle, which might be modified.\n                            var hoverStyle = iconStyleEmphasisModel.getItemStyle();\n                            path.setStyle({\n                                text: titles[iconName],\n                                textPosition: hoverStyle.textPosition || 'bottom',\n                                textFill: hoverStyle.fill || hoverStyle.stroke || '#000',\n                                textAlign: hoverStyle.textAlign || 'center'\n                            });\n                        })\n                        .on('mouseout', function () {\n                            path.setStyle({\n                                textFill: null\n                            });\n                        });\n                }\n                path.trigger(featureModel.get('iconStatus.' + iconName) || 'normal');\n\n                group.add(path);\n                path.on('click', bind(\n                    feature.onclick, feature, ecModel, api, iconName\n                ));\n\n                iconPaths[iconName] = path;\n            });\n        }\n\n        layout$3(group, toolboxModel, api);\n        // Render background after group is layout\n        // FIXME\n        group.add(makeBackground(group.getBoundingRect(), toolboxModel));\n\n        // Adjust icon title positions to avoid them out of screen\n        group.eachChild(function (icon) {\n            var titleText = icon.__title;\n            var hoverStyle = icon.hoverStyle;\n            // May be background element\n            if (hoverStyle && titleText) {\n                var rect = getBoundingRect(\n                    titleText, makeFont(hoverStyle)\n                );\n                var offsetX = icon.position[0] + group.position[0];\n                var offsetY = icon.position[1] + group.position[1] + itemSize;\n\n                var needPutOnTop = false;\n                if (offsetY + rect.height > api.getHeight()) {\n                    hoverStyle.textPosition = 'top';\n                    needPutOnTop = true;\n                }\n                var topOffset = needPutOnTop ? (-5 - rect.height) : (itemSize + 8);\n                if (offsetX + rect.width /  2 > api.getWidth()) {\n                    hoverStyle.textPosition = ['100%', topOffset];\n                    hoverStyle.textAlign = 'right';\n                }\n                else if (offsetX - rect.width / 2 < 0) {\n                    hoverStyle.textPosition = [0, topOffset];\n                    hoverStyle.textAlign = 'left';\n                }\n            }\n        });\n    },\n\n    updateView: function (toolboxModel, ecModel, api, payload) {\n        each$1(this._features, function (feature) {\n            feature.updateView && feature.updateView(feature.model, ecModel, api, payload);\n        });\n    },\n\n    // updateLayout: function (toolboxModel, ecModel, api, payload) {\n    //     zrUtil.each(this._features, function (feature) {\n    //         feature.updateLayout && feature.updateLayout(feature.model, ecModel, api, payload);\n    //     });\n    // },\n\n    remove: function (ecModel, api) {\n        each$1(this._features, function (feature) {\n            feature.remove && feature.remove(ecModel, api);\n        });\n        this.group.removeAll();\n    },\n\n    dispose: function (ecModel, api) {\n        each$1(this._features, function (feature) {\n            feature.dispose && feature.dispose(ecModel, api);\n        });\n    }\n});\n\nfunction isUserFeatureName(featureName) {\n    return featureName.indexOf('my') === 0;\n}\n\nvar saveAsImageLang = lang.toolbox.saveAsImage;\n\nfunction SaveAsImage(model) {\n    this.model = model;\n}\n\nSaveAsImage.defaultOption = {\n    show: true,\n    icon: 'M4.7,22.9L29.3,45.5L54.7,23.4M4.6,43.6L4.6,58L53.8,58L53.8,43.6M29.2,45.1L29.2,0',\n    title: saveAsImageLang.title,\n    type: 'png',\n    // Default use option.backgroundColor\n    // backgroundColor: '#fff',\n    name: '',\n    excludeComponents: ['toolbox'],\n    pixelRatio: 1,\n    lang: saveAsImageLang.lang.slice()\n};\n\nSaveAsImage.prototype.unusable = !env$1.canvasSupported;\n\nvar proto$4 = SaveAsImage.prototype;\n\nproto$4.onclick = function (ecModel, api) {\n    var model = this.model;\n    var title = model.get('name') || ecModel.get('title.0.text') || 'echarts';\n    var $a = document.createElement('a');\n    var type = model.get('type', true) || 'png';\n    $a.download = title + '.' + type;\n    $a.target = '_blank';\n    var url = api.getConnectedDataURL({\n        type: type,\n        backgroundColor: model.get('backgroundColor', true)\n            || ecModel.get('backgroundColor') || '#fff',\n        excludeComponents: model.get('excludeComponents'),\n        pixelRatio: model.get('pixelRatio')\n    });\n    $a.href = url;\n    // Chrome and Firefox\n    if (typeof MouseEvent === 'function' && !env$1.browser.ie && !env$1.browser.edge) {\n        var evt = new MouseEvent('click', {\n            view: window,\n            bubbles: true,\n            cancelable: false\n        });\n        $a.dispatchEvent(evt);\n    }\n    // IE\n    else {\n        if (window.navigator.msSaveOrOpenBlob) {\n            var bstr = atob(url.split(',')[1]);\n            var n = bstr.length;\n            var u8arr = new Uint8Array(n);\n            while(n--) {\n                u8arr[n] = bstr.charCodeAt(n);\n            }\n            var blob = new Blob([u8arr]);\n            window.navigator.msSaveOrOpenBlob(blob, title + '.' + type);\n        }\n        else {\n            var lang$$1 = model.get('lang');\n            var html = '' +\n                '<body style=\"margin:0;\">' +\n                '<img src=\"' + url + '\" style=\"max-width:100%;\" title=\"' + ((lang$$1 && lang$$1[0]) || '') + '\" />' +\n                '</body>';\n            var tab = window.open();\n            tab.document.write(html);\n        }\n    }\n};\n\nregister$1(\n    'saveAsImage', SaveAsImage\n);\n\nvar magicTypeLang = lang.toolbox.magicType;\n\nfunction MagicType(model) {\n    this.model = model;\n}\n\nMagicType.defaultOption = {\n    show: true,\n    type: [],\n    // Icon group\n    icon: {\n        line: 'M4.1,28.9h7.1l9.3-22l7.4,38l9.7-19.7l3,12.8h14.9M4.1,58h51.4',\n        bar: 'M6.7,22.9h10V48h-10V22.9zM24.9,13h10v35h-10V13zM43.2,2h10v46h-10V2zM3.1,58h53.7',\n        stack: 'M8.2,38.4l-8.4,4.1l30.6,15.3L60,42.5l-8.1-4.1l-21.5,11L8.2,38.4z M51.9,30l-8.1,4.2l-13.4,6.9l-13.9-6.9L8.2,30l-8.4,4.2l8.4,4.2l22.2,11l21.5-11l8.1-4.2L51.9,30z M51.9,21.7l-8.1,4.2L35.7,30l-5.3,2.8L24.9,30l-8.4-4.1l-8.3-4.2l-8.4,4.2L8.2,30l8.3,4.2l13.9,6.9l13.4-6.9l8.1-4.2l8.1-4.1L51.9,21.7zM30.4,2.2L-0.2,17.5l8.4,4.1l8.3,4.2l8.4,4.2l5.5,2.7l5.3-2.7l8.1-4.2l8.1-4.2l8.1-4.1L30.4,2.2z', // jshint ignore:line\n        tiled: 'M2.3,2.2h22.8V25H2.3V2.2z M35,2.2h22.8V25H35V2.2zM2.3,35h22.8v22.8H2.3V35z M35,35h22.8v22.8H35V35z'\n    },\n    // `line`, `bar`, `stack`, `tiled`\n    title: clone(magicTypeLang.title),\n    option: {},\n    seriesIndex: {}\n};\n\nvar proto$5 = MagicType.prototype;\n\nproto$5.getIcons = function () {\n    var model = this.model;\n    var availableIcons = model.get('icon');\n    var icons = {};\n    each$1(model.get('type'), function (type) {\n        if (availableIcons[type]) {\n            icons[type] = availableIcons[type];\n        }\n    });\n    return icons;\n};\n\nvar seriesOptGenreator = {\n    'line': function (seriesType, seriesId, seriesModel, model) {\n        if (seriesType === 'bar') {\n            return merge({\n                id: seriesId,\n                type: 'line',\n                // Preserve data related option\n                data: seriesModel.get('data'),\n                stack: seriesModel.get('stack'),\n                markPoint: seriesModel.get('markPoint'),\n                markLine: seriesModel.get('markLine')\n            }, model.get('option.line') || {}, true);\n        }\n    },\n    'bar': function (seriesType, seriesId, seriesModel, model) {\n        if (seriesType === 'line') {\n            return merge({\n                id: seriesId,\n                type: 'bar',\n                // Preserve data related option\n                data: seriesModel.get('data'),\n                stack: seriesModel.get('stack'),\n                markPoint: seriesModel.get('markPoint'),\n                markLine: seriesModel.get('markLine')\n            }, model.get('option.bar') || {}, true);\n        }\n    },\n    'stack': function (seriesType, seriesId, seriesModel, model) {\n        if (seriesType === 'line' || seriesType === 'bar') {\n            return merge({\n                id: seriesId,\n                stack: '__ec_magicType_stack__'\n            }, model.get('option.stack') || {}, true);\n        }\n    },\n    'tiled': function (seriesType, seriesId, seriesModel, model) {\n        if (seriesType === 'line' || seriesType === 'bar') {\n            return merge({\n                id: seriesId,\n                stack: ''\n            }, model.get('option.tiled') || {}, true);\n        }\n    }\n};\n\nvar radioTypes = [\n    ['line', 'bar'],\n    ['stack', 'tiled']\n];\n\nproto$5.onclick = function (ecModel, api, type) {\n    var model = this.model;\n    var seriesIndex = model.get('seriesIndex.' + type);\n    // Not supported magicType\n    if (!seriesOptGenreator[type]) {\n        return;\n    }\n    var newOption = {\n        series: []\n    };\n    var generateNewSeriesTypes = function (seriesModel) {\n        var seriesType = seriesModel.subType;\n        var seriesId = seriesModel.id;\n        var newSeriesOpt = seriesOptGenreator[type](\n            seriesType, seriesId, seriesModel, model\n        );\n        if (newSeriesOpt) {\n            // PENDING If merge original option?\n            defaults(newSeriesOpt, seriesModel.option);\n            newOption.series.push(newSeriesOpt);\n        }\n        // Modify boundaryGap\n        var coordSys = seriesModel.coordinateSystem;\n        if (coordSys && coordSys.type === 'cartesian2d' && (type === 'line' || type === 'bar')) {\n            var categoryAxis = coordSys.getAxesByScale('ordinal')[0];\n            if (categoryAxis) {\n                var axisDim = categoryAxis.dim;\n                var axisType = axisDim + 'Axis';\n                var axisModel = ecModel.queryComponents({\n                    mainType: axisType,\n                    index: seriesModel.get(name + 'Index'),\n                    id: seriesModel.get(name + 'Id')\n                })[0];\n                var axisIndex = axisModel.componentIndex;\n\n                newOption[axisType] = newOption[axisType] || [];\n                for (var i = 0; i <= axisIndex; i++) {\n                    newOption[axisType][axisIndex] = newOption[axisType][axisIndex] || {};\n                }\n                newOption[axisType][axisIndex].boundaryGap = type === 'bar' ? true : false;\n            }\n        }\n    };\n\n    each$1(radioTypes, function (radio) {\n        if (indexOf(radio, type) >= 0) {\n            each$1(radio, function (item) {\n                model.setIconStatus(item, 'normal');\n            });\n        }\n    });\n\n    model.setIconStatus(type, 'emphasis');\n\n    ecModel.eachComponent(\n        {\n            mainType: 'series',\n            query: seriesIndex == null ? null : {\n                seriesIndex: seriesIndex\n            }\n        }, generateNewSeriesTypes\n    );\n    api.dispatchAction({\n        type: 'changeMagicType',\n        currentType: type,\n        newOption: newOption\n    });\n};\n\nregisterAction({\n    type: 'changeMagicType',\n    event: 'magicTypeChanged',\n    update: 'prepareAndUpdate'\n}, function (payload, ecModel) {\n    ecModel.mergeOption(payload.newOption);\n});\n\nregister$1('magicType', MagicType);\n\nvar dataViewLang = lang.toolbox.dataView;\n\nvar BLOCK_SPLITER = new Array(60).join('-');\nvar ITEM_SPLITER = '\\t';\n/**\n * Group series into two types\n *  1. on category axis, like line, bar\n *  2. others, like scatter, pie\n * @param {module:echarts/model/Global} ecModel\n * @return {Object}\n * @inner\n */\nfunction groupSeries(ecModel) {\n    var seriesGroupByCategoryAxis = {};\n    var otherSeries = [];\n    var meta = [];\n    ecModel.eachRawSeries(function (seriesModel) {\n        var coordSys = seriesModel.coordinateSystem;\n\n        if (coordSys && (coordSys.type === 'cartesian2d' || coordSys.type === 'polar')) {\n            var baseAxis = coordSys.getBaseAxis();\n            if (baseAxis.type === 'category') {\n                var key = baseAxis.dim + '_' + baseAxis.index;\n                if (!seriesGroupByCategoryAxis[key]) {\n                    seriesGroupByCategoryAxis[key] = {\n                        categoryAxis: baseAxis,\n                        valueAxis: coordSys.getOtherAxis(baseAxis),\n                        series: []\n                    };\n                    meta.push({\n                        axisDim: baseAxis.dim,\n                        axisIndex: baseAxis.index\n                    });\n                }\n                seriesGroupByCategoryAxis[key].series.push(seriesModel);\n            }\n            else {\n                otherSeries.push(seriesModel);\n            }\n        }\n        else {\n            otherSeries.push(seriesModel);\n        }\n    });\n\n    return {\n        seriesGroupByCategoryAxis: seriesGroupByCategoryAxis,\n        other: otherSeries,\n        meta: meta\n    };\n}\n\n/**\n * Assemble content of series on cateogory axis\n * @param {Array.<module:echarts/model/Series>} series\n * @return {string}\n * @inner\n */\nfunction assembleSeriesWithCategoryAxis(series) {\n    var tables = [];\n    each$1(series, function (group, key) {\n        var categoryAxis = group.categoryAxis;\n        var valueAxis = group.valueAxis;\n        var valueAxisDim = valueAxis.dim;\n\n        var headers = [' '].concat(map(group.series, function (series) {\n            return series.name;\n        }));\n        var columns = [categoryAxis.model.getCategories()];\n        each$1(group.series, function (series) {\n            columns.push(series.getRawData().mapArray(valueAxisDim, function (val) {\n                return val;\n            }));\n        });\n        // Assemble table content\n        var lines = [headers.join(ITEM_SPLITER)];\n        for (var i = 0; i < columns[0].length; i++) {\n            var items = [];\n            for (var j = 0; j < columns.length; j++) {\n                items.push(columns[j][i]);\n            }\n            lines.push(items.join(ITEM_SPLITER));\n        }\n        tables.push(lines.join('\\n'));\n    });\n    return tables.join('\\n\\n' +  BLOCK_SPLITER + '\\n\\n');\n}\n\n/**\n * Assemble content of other series\n * @param {Array.<module:echarts/model/Series>} series\n * @return {string}\n * @inner\n */\nfunction assembleOtherSeries(series) {\n    return map(series, function (series) {\n        var data = series.getRawData();\n        var lines = [series.name];\n        var vals = [];\n        data.each(data.dimensions, function () {\n            var argLen = arguments.length;\n            var dataIndex = arguments[argLen - 1];\n            var name = data.getName(dataIndex);\n            for (var i = 0; i < argLen - 1; i++) {\n                vals[i] = arguments[i];\n            }\n            lines.push((name ? (name + ITEM_SPLITER) : '') + vals.join(ITEM_SPLITER));\n        });\n        return lines.join('\\n');\n    }).join('\\n\\n' + BLOCK_SPLITER + '\\n\\n');\n}\n\n/**\n * @param {module:echarts/model/Global}\n * @return {Object}\n * @inner\n */\nfunction getContentFromModel(ecModel) {\n\n    var result = groupSeries(ecModel);\n\n    return {\n        value: filter([\n                assembleSeriesWithCategoryAxis(result.seriesGroupByCategoryAxis),\n                assembleOtherSeries(result.other)\n            ], function (str) {\n                return str.replace(/[\\n\\t\\s]/g, '');\n            }).join('\\n\\n' + BLOCK_SPLITER + '\\n\\n'),\n\n        meta: result.meta\n    };\n}\n\n\nfunction trim$1(str) {\n    return str.replace(/^\\s\\s*/, '').replace(/\\s\\s*$/, '');\n}\n/**\n * If a block is tsv format\n */\nfunction isTSVFormat(block) {\n    // Simple method to find out if a block is tsv format\n    var firstLine = block.slice(0, block.indexOf('\\n'));\n    if (firstLine.indexOf(ITEM_SPLITER) >= 0) {\n        return true;\n    }\n}\n\nvar itemSplitRegex = new RegExp('[' + ITEM_SPLITER + ']+', 'g');\n/**\n * @param {string} tsv\n * @return {Object}\n */\nfunction parseTSVContents(tsv) {\n    var tsvLines = tsv.split(/\\n+/g);\n    var headers = trim$1(tsvLines.shift()).split(itemSplitRegex);\n\n    var categories = [];\n    var series = map(headers, function (header) {\n        return {\n            name: header,\n            data: []\n        };\n    });\n    for (var i = 0; i < tsvLines.length; i++) {\n        var items = trim$1(tsvLines[i]).split(itemSplitRegex);\n        categories.push(items.shift());\n        for (var j = 0; j < items.length; j++) {\n            series[j] && (series[j].data[i] = items[j]);\n        }\n    }\n    return {\n        series: series,\n        categories: categories\n    };\n}\n\n/**\n * @param {string} str\n * @return {Array.<Object>}\n * @inner\n */\nfunction parseListContents(str) {\n    var lines = str.split(/\\n+/g);\n    var seriesName = trim$1(lines.shift());\n\n    var data = [];\n    for (var i = 0; i < lines.length; i++) {\n        var items = trim$1(lines[i]).split(itemSplitRegex);\n        var name = '';\n        var value;\n        var hasName = false;\n        if (isNaN(items[0])) { // First item is name\n            hasName = true;\n            name = items[0];\n            items = items.slice(1);\n            data[i] = {\n                name: name,\n                value: []\n            };\n            value = data[i].value;\n        }\n        else {\n            value = data[i] = [];\n        }\n        for (var j = 0; j < items.length; j++) {\n            value.push(+items[j]);\n        }\n        if (value.length === 1) {\n            hasName ? (data[i].value = value[0]) : (data[i] = value[0]);\n        }\n    }\n\n    return {\n        name: seriesName,\n        data: data\n    };\n}\n\n/**\n * @param {string} str\n * @param {Array.<Object>} blockMetaList\n * @return {Object}\n * @inner\n */\nfunction parseContents(str, blockMetaList) {\n    var blocks = str.split(new RegExp('\\n*' + BLOCK_SPLITER + '\\n*', 'g'));\n    var newOption = {\n        series: []\n    };\n    each$1(blocks, function (block, idx) {\n        if (isTSVFormat(block)) {\n            var result = parseTSVContents(block);\n            var blockMeta = blockMetaList[idx];\n            var axisKey = blockMeta.axisDim + 'Axis';\n\n            if (blockMeta) {\n                newOption[axisKey] = newOption[axisKey] || [];\n                newOption[axisKey][blockMeta.axisIndex] = {\n                    data: result.categories\n                };\n                newOption.series = newOption.series.concat(result.series);\n            }\n        }\n        else {\n            var result = parseListContents(block);\n            newOption.series.push(result);\n        }\n    });\n    return newOption;\n}\n\n/**\n * @alias {module:echarts/component/toolbox/feature/DataView}\n * @constructor\n * @param {module:echarts/model/Model} model\n */\nfunction DataView(model) {\n\n    this._dom = null;\n\n    this.model = model;\n}\n\nDataView.defaultOption = {\n    show: true,\n    readOnly: false,\n    optionToContent: null,\n    contentToOption: null,\n\n    icon: 'M17.5,17.3H33 M17.5,17.3H33 M45.4,29.5h-28 M11.5,2v56H51V14.8L38.4,2H11.5z M38.4,2.2v12.7H51 M45.4,41.7h-28',\n    title: clone(dataViewLang.title),\n    lang: clone(dataViewLang.lang),\n    backgroundColor: '#fff',\n    textColor: '#000',\n    textareaColor: '#fff',\n    textareaBorderColor: '#333',\n    buttonColor: '#c23531',\n    buttonTextColor: '#fff'\n};\n\nDataView.prototype.onclick = function (ecModel, api) {\n    var container = api.getDom();\n    var model = this.model;\n    if (this._dom) {\n        container.removeChild(this._dom);\n    }\n    var root = document.createElement('div');\n    root.style.cssText = 'position:absolute;left:5px;top:5px;bottom:5px;right:5px;';\n    root.style.backgroundColor = model.get('backgroundColor') || '#fff';\n\n    // Create elements\n    var header = document.createElement('h4');\n    var lang$$1 = model.get('lang') || [];\n    header.innerHTML = lang$$1[0] || model.get('title');\n    header.style.cssText = 'margin: 10px 20px;';\n    header.style.color = model.get('textColor');\n\n    var viewMain = document.createElement('div');\n    var textarea = document.createElement('textarea');\n    viewMain.style.cssText = 'display:block;width:100%;overflow:auto;';\n\n    var optionToContent = model.get('optionToContent');\n    var contentToOption = model.get('contentToOption');\n    var result = getContentFromModel(ecModel);\n    if (typeof optionToContent === 'function') {\n        var htmlOrDom = optionToContent(api.getOption());\n        if (typeof htmlOrDom === 'string') {\n            viewMain.innerHTML = htmlOrDom;\n        }\n        else if (isDom(htmlOrDom)) {\n            viewMain.appendChild(htmlOrDom);\n        }\n    }\n    else {\n        // Use default textarea\n        viewMain.appendChild(textarea);\n        textarea.readOnly = model.get('readOnly');\n        textarea.style.cssText = 'width:100%;height:100%;font-family:monospace;font-size:14px;line-height:1.6rem;';\n        textarea.style.color = model.get('textColor');\n        textarea.style.borderColor = model.get('textareaBorderColor');\n        textarea.style.backgroundColor = model.get('textareaColor');\n        textarea.value = result.value;\n    }\n\n    var blockMetaList = result.meta;\n\n    var buttonContainer = document.createElement('div');\n    buttonContainer.style.cssText = 'position:absolute;bottom:0;left:0;right:0;';\n\n    var buttonStyle = 'float:right;margin-right:20px;border:none;'\n        + 'cursor:pointer;padding:2px 5px;font-size:12px;border-radius:3px';\n    var closeButton = document.createElement('div');\n    var refreshButton = document.createElement('div');\n\n    buttonStyle += ';background-color:' + model.get('buttonColor');\n    buttonStyle += ';color:' + model.get('buttonTextColor');\n\n    var self = this;\n\n    function close() {\n        container.removeChild(root);\n        self._dom = null;\n    }\n    addEventListener(closeButton, 'click', close);\n\n    addEventListener(refreshButton, 'click', function () {\n        var newOption;\n        try {\n            if (typeof contentToOption === 'function') {\n                newOption = contentToOption(viewMain, api.getOption());\n            }\n            else {\n                newOption = parseContents(textarea.value, blockMetaList);\n            }\n        }\n        catch (e) {\n            close();\n            throw new Error('Data view format error ' + e);\n        }\n        if (newOption) {\n            api.dispatchAction({\n                type: 'changeDataView',\n                newOption: newOption\n            });\n        }\n\n        close();\n    });\n\n    closeButton.innerHTML = lang$$1[1];\n    refreshButton.innerHTML = lang$$1[2];\n    refreshButton.style.cssText = buttonStyle;\n    closeButton.style.cssText = buttonStyle;\n\n    !model.get('readOnly') && buttonContainer.appendChild(refreshButton);\n    buttonContainer.appendChild(closeButton);\n\n    // http://stackoverflow.com/questions/6637341/use-tab-to-indent-in-textarea\n    addEventListener(textarea, 'keydown', function (e) {\n        if ((e.keyCode || e.which) === 9) {\n            // get caret position/selection\n            var val = this.value;\n            var start = this.selectionStart;\n            var end = this.selectionEnd;\n\n            // set textarea value to: text before caret + tab + text after caret\n            this.value = val.substring(0, start) + ITEM_SPLITER + val.substring(end);\n\n            // put caret at right position again\n            this.selectionStart = this.selectionEnd = start + 1;\n\n            // prevent the focus lose\n            stop(e);\n        }\n    });\n\n    root.appendChild(header);\n    root.appendChild(viewMain);\n    root.appendChild(buttonContainer);\n\n    viewMain.style.height = (container.clientHeight - 80) + 'px';\n\n    container.appendChild(root);\n    this._dom = root;\n};\n\nDataView.prototype.remove = function (ecModel, api) {\n    this._dom && api.getDom().removeChild(this._dom);\n};\n\nDataView.prototype.dispose = function (ecModel, api) {\n    this.remove(ecModel, api);\n};\n\n/**\n * @inner\n */\nfunction tryMergeDataOption(newData, originalData) {\n    return map(newData, function (newVal, idx) {\n        var original = originalData && originalData[idx];\n        if (isObject$1(original) && !isArray(original)) {\n            if (isObject$1(newVal) && !isArray(newVal)) {\n                newVal = newVal.value;\n            }\n            // Original data has option\n            return defaults({\n                value: newVal\n            }, original);\n        }\n        else {\n            return newVal;\n        }\n    });\n}\n\nregister$1('dataView', DataView);\n\nregisterAction({\n    type: 'changeDataView',\n    event: 'dataViewChanged',\n    update: 'prepareAndUpdate'\n}, function (payload, ecModel) {\n    var newSeriesOptList = [];\n    each$1(payload.newOption.series, function (seriesOpt) {\n        var seriesModel = ecModel.getSeriesByName(seriesOpt.name)[0];\n        if (!seriesModel) {\n            // New created series\n            // Geuss the series type\n            newSeriesOptList.push(extend({\n                // Default is scatter\n                type: 'scatter'\n            }, seriesOpt));\n        }\n        else {\n            var originalData = seriesModel.get('data');\n            newSeriesOptList.push({\n                name: seriesOpt.name,\n                data: tryMergeDataOption(seriesOpt.data, originalData)\n            });\n        }\n    });\n\n    ecModel.mergeOption(defaults({\n        series: newSeriesOptList\n    }, payload.newOption));\n});\n\nvar each$30 = each$1;\n\nvar ATTR$2 = '\\0_ec_hist_store';\n\n/**\n * @param {module:echarts/model/Global} ecModel\n * @param {Object} newSnapshot {dataZoomId, batch: [payloadInfo, ...]}\n */\nfunction push(ecModel, newSnapshot) {\n    var store = giveStore$1(ecModel);\n\n    // If previous dataZoom can not be found,\n    // complete an range with current range.\n    each$30(newSnapshot, function (batchItem, dataZoomId) {\n        var i = store.length - 1;\n        for (; i >= 0; i--) {\n            var snapshot = store[i];\n            if (snapshot[dataZoomId]) {\n                break;\n            }\n        }\n        if (i < 0) {\n            // No origin range set, create one by current range.\n            var dataZoomModel = ecModel.queryComponents(\n                {mainType: 'dataZoom', subType: 'select', id: dataZoomId}\n            )[0];\n            if (dataZoomModel) {\n                var percentRange = dataZoomModel.getPercentRange();\n                store[0][dataZoomId] = {\n                    dataZoomId: dataZoomId,\n                    start: percentRange[0],\n                    end: percentRange[1]\n                };\n            }\n        }\n    });\n\n    store.push(newSnapshot);\n}\n\n/**\n * @param {module:echarts/model/Global} ecModel\n * @return {Object} snapshot\n */\nfunction pop(ecModel) {\n    var store = giveStore$1(ecModel);\n    var head = store[store.length - 1];\n    store.length > 1 && store.pop();\n\n    // Find top for all dataZoom.\n    var snapshot = {};\n    each$30(head, function (batchItem, dataZoomId) {\n        for (var i = store.length - 1; i >= 0; i--) {\n            var batchItem = store[i][dataZoomId];\n            if (batchItem) {\n                snapshot[dataZoomId] = batchItem;\n                break;\n            }\n        }\n    });\n\n    return snapshot;\n}\n\n/**\n * @param {module:echarts/model/Global} ecModel\n */\nfunction clear$1(ecModel) {\n    ecModel[ATTR$2] = null;\n}\n\n/**\n * @param {module:echarts/model/Global} ecModel\n * @return {number} records. always >= 1.\n */\nfunction count(ecModel) {\n    return giveStore$1(ecModel).length;\n}\n\n/**\n * [{key: dataZoomId, value: {dataZoomId, range}}, ...]\n * History length of each dataZoom may be different.\n * this._history[0] is used to store origin range.\n * @type {Array.<Object>}\n */\nfunction giveStore$1(ecModel) {\n    var store = ecModel[ATTR$2];\n    if (!store) {\n        store = ecModel[ATTR$2] = [{}];\n    }\n    return store;\n}\n\nDataZoomModel.extend({\n    type: 'dataZoom.select'\n});\n\nDataZoomView.extend({\n    type: 'dataZoom.select'\n});\n\n/**\n * DataZoom component entry\n */\n\n// Use dataZoomSelect\nvar dataZoomLang = lang.toolbox.dataZoom;\nvar each$29 = each$1;\n\n// Spectial component id start with \\0ec\\0, see echarts/model/Global.js~hasInnerId\nvar DATA_ZOOM_ID_BASE = '\\0_ec_\\0toolbox-dataZoom_';\n\nfunction DataZoom(model, ecModel, api) {\n\n    /**\n     * @private\n     * @type {module:echarts/component/helper/BrushController}\n     */\n    (this._brushController = new BrushController(api.getZr()))\n        .on('brush', bind(this._onBrush, this))\n        .mount();\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this._isZoomActive;\n}\n\nDataZoom.defaultOption = {\n    show: true,\n    // Icon group\n    icon: {\n        zoom: 'M0,13.5h26.9 M13.5,26.9V0 M32.1,13.5H58V58H13.5 V32.1',\n        back: 'M22,1.4L9.9,13.5l12.3,12.3 M10.3,13.5H54.9v44.6 H10.3v-26'\n    },\n    // `zoom`, `back`\n    title: clone(dataZoomLang.title)\n};\n\nvar proto$6 = DataZoom.prototype;\n\nproto$6.render = function (featureModel, ecModel, api, payload) {\n    this.model = featureModel;\n    this.ecModel = ecModel;\n    this.api = api;\n\n    updateZoomBtnStatus(featureModel, ecModel, this, payload, api);\n    updateBackBtnStatus(featureModel, ecModel);\n};\n\nproto$6.onclick = function (ecModel, api, type) {\n    handlers$1[type].call(this);\n};\n\nproto$6.remove = function (ecModel, api) {\n    this._brushController.unmount();\n};\n\nproto$6.dispose = function (ecModel, api) {\n    this._brushController.dispose();\n};\n\n/**\n * @private\n */\nvar handlers$1 = {\n\n    zoom: function () {\n        var nextActive = !this._isZoomActive;\n\n        this.api.dispatchAction({\n            type: 'takeGlobalCursor',\n            key: 'dataZoomSelect',\n            dataZoomSelectActive: nextActive\n        });\n    },\n\n    back: function () {\n        this._dispatchZoomAction(pop(this.ecModel));\n    }\n};\n\n/**\n * @private\n */\nproto$6._onBrush = function (areas, opt) {\n    if (!opt.isEnd || !areas.length) {\n        return;\n    }\n    var snapshot = {};\n    var ecModel = this.ecModel;\n\n    this._brushController.updateCovers([]); // remove cover\n\n    var brushTargetManager = new BrushTargetManager(\n        retrieveAxisSetting(this.model.option), ecModel, {include: ['grid']}\n    );\n    brushTargetManager.matchOutputRanges(areas, ecModel, function (area, coordRange, coordSys) {\n        if (coordSys.type !== 'cartesian2d') {\n            return;\n        }\n\n        var brushType = area.brushType;\n        if (brushType === 'rect') {\n            setBatch('x', coordSys, coordRange[0]);\n            setBatch('y', coordSys, coordRange[1]);\n        }\n        else {\n            setBatch(({lineX: 'x', lineY: 'y'})[brushType], coordSys, coordRange);\n        }\n    });\n\n    push(ecModel, snapshot);\n\n    this._dispatchZoomAction(snapshot);\n\n    function setBatch(dimName, coordSys, minMax) {\n        var axis = coordSys.getAxis(dimName);\n        var axisModel = axis.model;\n        var dataZoomModel = findDataZoom(dimName, axisModel, ecModel);\n\n        // Restrict range.\n        var minMaxSpan = dataZoomModel.findRepresentativeAxisProxy(axisModel).getMinMaxSpan();\n        if (minMaxSpan.minValueSpan != null || minMaxSpan.maxValueSpan != null) {\n            minMax = sliderMove(\n                0, minMax.slice(), axis.scale.getExtent(), 0,\n                minMaxSpan.minValueSpan, minMaxSpan.maxValueSpan\n            );\n        }\n\n        dataZoomModel && (snapshot[dataZoomModel.id] = {\n            dataZoomId: dataZoomModel.id,\n            startValue: minMax[0],\n            endValue: minMax[1]\n        });\n    }\n\n    function findDataZoom(dimName, axisModel, ecModel) {\n        var found;\n        ecModel.eachComponent({mainType: 'dataZoom', subType: 'select'}, function (dzModel) {\n            var has = dzModel.getAxisModel(dimName, axisModel.componentIndex);\n            has && (found = dzModel);\n        });\n        return found;\n    }\n};\n\n/**\n * @private\n */\nproto$6._dispatchZoomAction = function (snapshot) {\n    var batch = [];\n\n    // Convert from hash map to array.\n    each$29(snapshot, function (batchItem, dataZoomId) {\n        batch.push(clone(batchItem));\n    });\n\n    batch.length && this.api.dispatchAction({\n        type: 'dataZoom',\n        from: this.uid,\n        batch: batch\n    });\n};\n\nfunction retrieveAxisSetting(option) {\n    var setting = {};\n    // Compatible with previous setting: null => all axis, false => no axis.\n    each$1(['xAxisIndex', 'yAxisIndex'], function (name) {\n        setting[name] = option[name];\n        setting[name] == null && (setting[name] = 'all');\n        (setting[name] === false || setting[name] === 'none') && (setting[name] = []);\n    });\n    return setting;\n}\n\nfunction updateBackBtnStatus(featureModel, ecModel) {\n    featureModel.setIconStatus(\n        'back',\n        count(ecModel) > 1 ? 'emphasis' : 'normal'\n    );\n}\n\nfunction updateZoomBtnStatus(featureModel, ecModel, view, payload, api) {\n    var zoomActive = view._isZoomActive;\n\n    if (payload && payload.type === 'takeGlobalCursor') {\n        zoomActive = payload.key === 'dataZoomSelect'\n            ? payload.dataZoomSelectActive : false;\n    }\n\n    view._isZoomActive = zoomActive;\n\n    featureModel.setIconStatus('zoom', zoomActive ? 'emphasis' : 'normal');\n\n    var brushTargetManager = new BrushTargetManager(\n        retrieveAxisSetting(featureModel.option), ecModel, {include: ['grid']}\n    );\n\n    view._brushController\n        .setPanels(brushTargetManager.makePanelOpts(api, function (targetInfo) {\n            return (targetInfo.xAxisDeclared && !targetInfo.yAxisDeclared)\n                ? 'lineX'\n                : (!targetInfo.xAxisDeclared && targetInfo.yAxisDeclared)\n                ? 'lineY'\n                : 'rect';\n        }))\n        .enableBrush(\n            zoomActive\n            ? {\n                brushType: 'auto',\n                brushStyle: {\n                    // FIXME user customized?\n                    lineWidth: 0,\n                    fill: 'rgba(0,0,0,0.2)'\n                }\n            }\n            : false\n        );\n}\n\n\nregister$1('dataZoom', DataZoom);\n\n\n// Create special dataZoom option for select\nregisterPreprocessor(function (option) {\n    if (!option) {\n        return;\n    }\n\n    var dataZoomOpts = option.dataZoom || (option.dataZoom = []);\n    if (!isArray(dataZoomOpts)) {\n        option.dataZoom = dataZoomOpts = [dataZoomOpts];\n    }\n\n    var toolboxOpt = option.toolbox;\n    if (toolboxOpt) {\n        // Assume there is only one toolbox\n        if (isArray(toolboxOpt)) {\n            toolboxOpt = toolboxOpt[0];\n        }\n\n        if (toolboxOpt && toolboxOpt.feature) {\n            var dataZoomOpt = toolboxOpt.feature.dataZoom;\n            addForAxis('xAxis', dataZoomOpt);\n            addForAxis('yAxis', dataZoomOpt);\n        }\n    }\n\n    function addForAxis(axisName, dataZoomOpt) {\n        if (!dataZoomOpt) {\n            return;\n        }\n\n        // Try not to modify model, because it is not merged yet.\n        var axisIndicesName = axisName + 'Index';\n        var givenAxisIndices = dataZoomOpt[axisIndicesName];\n        if (givenAxisIndices != null\n            && givenAxisIndices != 'all'\n            && !isArray(givenAxisIndices)\n        ) {\n            givenAxisIndices = (givenAxisIndices === false || givenAxisIndices === 'none') ? [] : [givenAxisIndices];\n        }\n\n        forEachComponent(axisName, function (axisOpt, axisIndex) {\n            if (givenAxisIndices != null\n                && givenAxisIndices != 'all'\n                && indexOf(givenAxisIndices, axisIndex) === -1\n            ) {\n                return;\n            }\n            var newOpt = {\n                type: 'select',\n                $fromToolbox: true,\n                // Id for merge mapping.\n                id: DATA_ZOOM_ID_BASE + axisName + axisIndex\n            };\n            // FIXME\n            // Only support one axis now.\n            newOpt[axisIndicesName] = axisIndex;\n            dataZoomOpts.push(newOpt);\n        });\n    }\n\n    function forEachComponent(mainType, cb) {\n        var opts = option[mainType];\n        if (!isArray(opts)) {\n            opts = opts ? [opts] : [];\n        }\n        each$29(opts, cb);\n    }\n});\n\nvar restoreLang = lang.toolbox.restore;\n\nfunction Restore(model) {\n    this.model = model;\n}\n\nRestore.defaultOption = {\n    show: true,\n    icon: 'M3.8,33.4 M47,18.9h9.8V8.7 M56.3,20.1 C52.1,9,40.5,0.6,26.8,2.1C12.6,3.7,1.6,16.2,2.1,30.6 M13,41.1H3.1v10.2 M3.7,39.9c4.2,11.1,15.8,19.5,29.5,18 c14.2-1.6,25.2-14.1,24.7-28.5',\n    title: restoreLang.title\n};\n\nvar proto$7 = Restore.prototype;\n\nproto$7.onclick = function (ecModel, api, type) {\n    clear$1(ecModel);\n\n    api.dispatchAction({\n        type: 'restore',\n        from: this.uid\n    });\n};\n\nregister$1('restore', Restore);\n\nregisterAction(\n    {type: 'restore', event: 'restore', update: 'prepareAndUpdate'},\n    function (payload, ecModel) {\n        ecModel.resetOption('recreate');\n    }\n);\n\nvar urn = 'urn:schemas-microsoft-com:vml';\nvar win = typeof window === 'undefined' ? null : window;\n\nvar vmlInited = false;\n\nvar doc = win && win.document;\n\nfunction createNode(tagName) {\n    return doCreateNode(tagName);\n}\n\n// Avoid assign to an exported variable, for transforming to cjs.\nvar doCreateNode;\n\nif (doc && !env$1.canvasSupported) {\n    try {\n        !doc.namespaces.zrvml && doc.namespaces.add('zrvml', urn);\n        doCreateNode = function (tagName) {\n            return doc.createElement('<zrvml:' + tagName + ' class=\"zrvml\">');\n        };\n    }\n    catch (e) {\n        doCreateNode = function (tagName) {\n            return doc.createElement('<' + tagName + ' xmlns=\"' + urn + '\" class=\"zrvml\">');\n        };\n    }\n}\n\n// From raphael\nfunction initVML() {\n    if (vmlInited || !doc) {\n        return;\n    }\n    vmlInited = true;\n\n    var styleSheets = doc.styleSheets;\n    if (styleSheets.length < 31) {\n        doc.createStyleSheet().addRule('.zrvml', 'behavior:url(#default#VML)');\n    }\n    else {\n        // http://msdn.microsoft.com/en-us/library/ms531194%28VS.85%29.aspx\n        styleSheets[0].addRule('.zrvml', 'behavior:url(#default#VML)');\n    }\n}\n\n// http://www.w3.org/TR/NOTE-VML\n// TODO Use proxy like svg instead of overwrite brush methods\n\nvar CMD$3 = PathProxy.CMD;\nvar round$3 = Math.round;\nvar sqrt = Math.sqrt;\nvar abs$1 = Math.abs;\nvar cos = Math.cos;\nvar sin = Math.sin;\nvar mathMax$8 = Math.max;\n\nif (!env$1.canvasSupported) {\n\n    var comma = ',';\n    var imageTransformPrefix = 'progid:DXImageTransform.Microsoft';\n\n    var Z = 21600;\n    var Z2 = Z / 2;\n\n    var ZLEVEL_BASE = 100000;\n    var Z_BASE$1 = 1000;\n\n    var initRootElStyle = function (el) {\n        el.style.cssText = 'position:absolute;left:0;top:0;width:1px;height:1px;';\n        el.coordsize = Z + ','  + Z;\n        el.coordorigin = '0,0';\n    };\n\n    var encodeHtmlAttribute = function (s) {\n        return String(s).replace(/&/g, '&amp;').replace(/\"/g, '&quot;');\n    };\n\n    var rgb2Str = function (r, g, b) {\n        return 'rgb(' + [r, g, b].join(',') + ')';\n    };\n\n    var append = function (parent, child) {\n        if (child && parent && child.parentNode !== parent) {\n            parent.appendChild(child);\n        }\n    };\n\n    var remove = function (parent, child) {\n        if (child && parent && child.parentNode === parent) {\n            parent.removeChild(child);\n        }\n    };\n\n    var getZIndex = function (zlevel, z, z2) {\n        // z  [0, 1000]\n        return (parseFloat(zlevel) || 0) * ZLEVEL_BASE + (parseFloat(z) || 0) * Z_BASE$1 + z2;\n    };\n\n    var parsePercent$3 = function (value, maxValue) {\n        if (typeof value === 'string') {\n            if (value.lastIndexOf('%') >= 0) {\n                return parseFloat(value) / 100 * maxValue;\n            }\n            return parseFloat(value);\n        }\n        return value;\n    };\n\n    /***************************************************\n     * PATH\n     **************************************************/\n\n    var setColorAndOpacity = function (el, color, opacity) {\n        var colorArr = parse(color);\n        opacity = +opacity;\n        if (isNaN(opacity)) {\n            opacity = 1;\n        }\n        if (colorArr) {\n            el.color = rgb2Str(colorArr[0], colorArr[1], colorArr[2]);\n            el.opacity = opacity * colorArr[3];\n        }\n    };\n\n    var getColorAndAlpha = function (color) {\n        var colorArr = parse(color);\n        return [\n            rgb2Str(colorArr[0], colorArr[1], colorArr[2]),\n            colorArr[3]\n        ];\n    };\n\n    var updateFillNode = function (el, style, zrEl) {\n        // TODO pattern\n        var fill = style.fill;\n        if (fill != null) {\n            // Modified from excanvas\n            if (fill instanceof Gradient) {\n                var gradientType;\n                var angle = 0;\n                var focus = [0, 0];\n                // additional offset\n                var shift = 0;\n                // scale factor for offset\n                var expansion = 1;\n                var rect = zrEl.getBoundingRect();\n                var rectWidth = rect.width;\n                var rectHeight = rect.height;\n                if (fill.type === 'linear') {\n                    gradientType = 'gradient';\n                    var transform = zrEl.transform;\n                    var p0 = [fill.x * rectWidth, fill.y * rectHeight];\n                    var p1 = [fill.x2 * rectWidth, fill.y2 * rectHeight];\n                    if (transform) {\n                        applyTransform(p0, p0, transform);\n                        applyTransform(p1, p1, transform);\n                    }\n                    var dx = p1[0] - p0[0];\n                    var dy = p1[1] - p0[1];\n                    angle = Math.atan2(dx, dy) * 180 / Math.PI;\n                    // The angle should be a non-negative number.\n                    if (angle < 0) {\n                        angle += 360;\n                    }\n\n                    // Very small angles produce an unexpected result because they are\n                    // converted to a scientific notation string.\n                    if (angle < 1e-6) {\n                        angle = 0;\n                    }\n                }\n                else {\n                    gradientType = 'gradientradial';\n                    var p0 = [fill.x * rectWidth, fill.y * rectHeight];\n                    var transform = zrEl.transform;\n                    var scale$$1 = zrEl.scale;\n                    var width = rectWidth;\n                    var height = rectHeight;\n                    focus = [\n                        // Percent in bounding rect\n                        (p0[0] - rect.x) / width,\n                        (p0[1] - rect.y) / height\n                    ];\n                    if (transform) {\n                        applyTransform(p0, p0, transform);\n                    }\n\n                    width /= scale$$1[0] * Z;\n                    height /= scale$$1[1] * Z;\n                    var dimension = mathMax$8(width, height);\n                    shift = 2 * 0 / dimension;\n                    expansion = 2 * fill.r / dimension - shift;\n                }\n\n                // We need to sort the color stops in ascending order by offset,\n                // otherwise IE won't interpret it correctly.\n                var stops = fill.colorStops.slice();\n                stops.sort(function(cs1, cs2) {\n                    return cs1.offset - cs2.offset;\n                });\n\n                var length$$1 = stops.length;\n                // Color and alpha list of first and last stop\n                var colorAndAlphaList = [];\n                var colors = [];\n                for (var i = 0; i < length$$1; i++) {\n                    var stop = stops[i];\n                    var colorAndAlpha = getColorAndAlpha(stop.color);\n                    colors.push(stop.offset * expansion + shift + ' ' + colorAndAlpha[0]);\n                    if (i === 0 || i === length$$1 - 1) {\n                        colorAndAlphaList.push(colorAndAlpha);\n                    }\n                }\n\n                if (length$$1 >= 2) {\n                    var color1 = colorAndAlphaList[0][0];\n                    var color2 = colorAndAlphaList[1][0];\n                    var opacity1 = colorAndAlphaList[0][1] * style.opacity;\n                    var opacity2 = colorAndAlphaList[1][1] * style.opacity;\n\n                    el.type = gradientType;\n                    el.method = 'none';\n                    el.focus = '100%';\n                    el.angle = angle;\n                    el.color = color1;\n                    el.color2 = color2;\n                    el.colors = colors.join(',');\n                    // When colors attribute is used, the meanings of opacity and o:opacity2\n                    // are reversed.\n                    el.opacity = opacity2;\n                    // FIXME g_o_:opacity ?\n                    el.opacity2 = opacity1;\n                }\n                if (gradientType === 'radial') {\n                    el.focusposition = focus.join(',');\n                }\n            }\n            else {\n                // FIXME Change from Gradient fill to color fill\n                setColorAndOpacity(el, fill, style.opacity);\n            }\n        }\n    };\n\n    var updateStrokeNode = function (el, style) {\n        // if (style.lineJoin != null) {\n        //     el.joinstyle = style.lineJoin;\n        // }\n        // if (style.miterLimit != null) {\n        //     el.miterlimit = style.miterLimit * Z;\n        // }\n        // if (style.lineCap != null) {\n        //     el.endcap = style.lineCap;\n        // }\n        if (style.lineDash != null) {\n            el.dashstyle = style.lineDash.join(' ');\n        }\n        if (style.stroke != null && !(style.stroke instanceof Gradient)) {\n            setColorAndOpacity(el, style.stroke, style.opacity);\n        }\n    };\n\n    var updateFillAndStroke = function (vmlEl, type, style, zrEl) {\n        var isFill = type == 'fill';\n        var el = vmlEl.getElementsByTagName(type)[0];\n        // Stroke must have lineWidth\n        if (style[type] != null && style[type] !== 'none' && (isFill || (!isFill && style.lineWidth))) {\n            vmlEl[isFill ? 'filled' : 'stroked'] = 'true';\n            // FIXME Remove before updating, or set `colors` will throw error\n            if (style[type] instanceof Gradient) {\n                remove(vmlEl, el);\n            }\n            if (!el) {\n                el = createNode(type);\n            }\n\n            isFill ? updateFillNode(el, style, zrEl) : updateStrokeNode(el, style);\n            append(vmlEl, el);\n        }\n        else {\n            vmlEl[isFill ? 'filled' : 'stroked'] = 'false';\n            remove(vmlEl, el);\n        }\n    };\n\n    var points$3 = [[], [], []];\n    var pathDataToString = function (path, m) {\n        var M = CMD$3.M;\n        var C = CMD$3.C;\n        var L = CMD$3.L;\n        var A = CMD$3.A;\n        var Q = CMD$3.Q;\n\n        var str = [];\n        var nPoint;\n        var cmdStr;\n        var cmd;\n        var i;\n        var xi;\n        var yi;\n        var data = path.data;\n        var dataLength = path.len();\n        for (i = 0; i < dataLength;) {\n            cmd = data[i++];\n            cmdStr = '';\n            nPoint = 0;\n            switch (cmd) {\n                case M:\n                    cmdStr = ' m ';\n                    nPoint = 1;\n                    xi = data[i++];\n                    yi = data[i++];\n                    points$3[0][0] = xi;\n                    points$3[0][1] = yi;\n                    break;\n                case L:\n                    cmdStr = ' l ';\n                    nPoint = 1;\n                    xi = data[i++];\n                    yi = data[i++];\n                    points$3[0][0] = xi;\n                    points$3[0][1] = yi;\n                    break;\n                case Q:\n                case C:\n                    cmdStr = ' c ';\n                    nPoint = 3;\n                    var x1 = data[i++];\n                    var y1 = data[i++];\n                    var x2 = data[i++];\n                    var y2 = data[i++];\n                    var x3;\n                    var y3;\n                    if (cmd === Q) {\n                        // Convert quadratic to cubic using degree elevation\n                        x3 = x2;\n                        y3 = y2;\n                        x2 = (x2 + 2 * x1) / 3;\n                        y2 = (y2 + 2 * y1) / 3;\n                        x1 = (xi + 2 * x1) / 3;\n                        y1 = (yi + 2 * y1) / 3;\n                    }\n                    else {\n                        x3 = data[i++];\n                        y3 = data[i++];\n                    }\n                    points$3[0][0] = x1;\n                    points$3[0][1] = y1;\n                    points$3[1][0] = x2;\n                    points$3[1][1] = y2;\n                    points$3[2][0] = x3;\n                    points$3[2][1] = y3;\n\n                    xi = x3;\n                    yi = y3;\n                    break;\n                case A:\n                    var x = 0;\n                    var y = 0;\n                    var sx = 1;\n                    var sy = 1;\n                    var angle = 0;\n                    if (m) {\n                        // Extract SRT from matrix\n                        x = m[4];\n                        y = m[5];\n                        sx = sqrt(m[0] * m[0] + m[1] * m[1]);\n                        sy = sqrt(m[2] * m[2] + m[3] * m[3]);\n                        angle = Math.atan2(-m[1] / sy, m[0] / sx);\n                    }\n\n                    var cx = data[i++];\n                    var cy = data[i++];\n                    var rx = data[i++];\n                    var ry = data[i++];\n                    var startAngle = data[i++] + angle;\n                    var endAngle = data[i++] + startAngle + angle;\n                    // FIXME\n                    // var psi = data[i++];\n                    i++;\n                    var clockwise = data[i++];\n\n                    var x0 = cx + cos(startAngle) * rx;\n                    var y0 = cy + sin(startAngle) * ry;\n\n                    var x1 = cx + cos(endAngle) * rx;\n                    var y1 = cy + sin(endAngle) * ry;\n\n                    var type = clockwise ? ' wa ' : ' at ';\n                    if (Math.abs(x0 - x1) < 1e-4) {\n                        // IE won't render arches drawn counter clockwise if x0 == x1.\n                        if (Math.abs(endAngle - startAngle) > 1e-2) {\n                            // Offset x0 by 1/80 of a pixel. Use something\n                            // that can be represented in binary\n                            if (clockwise) {\n                                x0 += 270 / Z;\n                            }\n                        }\n                        else {\n                            // Avoid case draw full circle\n                            if (Math.abs(y0 - cy) < 1e-4) {\n                                if ((clockwise && x0 < cx) || (!clockwise && x0 > cx)) {\n                                    y1 -= 270 / Z;\n                                }\n                                else {\n                                    y1 += 270 / Z;\n                                }\n                            }\n                            else if ((clockwise && y0 < cy) || (!clockwise && y0 > cy)) {\n                                x1 += 270 / Z;\n                            }\n                            else {\n                                x1 -= 270 / Z;\n                            }\n                        }\n                    }\n                    str.push(\n                        type,\n                        round$3(((cx - rx) * sx + x) * Z - Z2), comma,\n                        round$3(((cy - ry) * sy + y) * Z - Z2), comma,\n                        round$3(((cx + rx) * sx + x) * Z - Z2), comma,\n                        round$3(((cy + ry) * sy + y) * Z - Z2), comma,\n                        round$3((x0 * sx + x) * Z - Z2), comma,\n                        round$3((y0 * sy + y) * Z - Z2), comma,\n                        round$3((x1 * sx + x) * Z - Z2), comma,\n                        round$3((y1 * sy + y) * Z - Z2)\n                    );\n\n                    xi = x1;\n                    yi = y1;\n                    break;\n                case CMD$3.R:\n                    var p0 = points$3[0];\n                    var p1 = points$3[1];\n                    // x0, y0\n                    p0[0] = data[i++];\n                    p0[1] = data[i++];\n                    // x1, y1\n                    p1[0] = p0[0] + data[i++];\n                    p1[1] = p0[1] + data[i++];\n\n                    if (m) {\n                        applyTransform(p0, p0, m);\n                        applyTransform(p1, p1, m);\n                    }\n\n                    p0[0] = round$3(p0[0] * Z - Z2);\n                    p1[0] = round$3(p1[0] * Z - Z2);\n                    p0[1] = round$3(p0[1] * Z - Z2);\n                    p1[1] = round$3(p1[1] * Z - Z2);\n                    str.push(\n                        // x0, y0\n                        ' m ', p0[0], comma, p0[1],\n                        // x1, y0\n                        ' l ', p1[0], comma, p0[1],\n                        // x1, y1\n                        ' l ', p1[0], comma, p1[1],\n                        // x0, y1\n                        ' l ', p0[0], comma, p1[1]\n                    );\n                    break;\n                case CMD$3.Z:\n                    // FIXME Update xi, yi\n                    str.push(' x ');\n            }\n\n            if (nPoint > 0) {\n                str.push(cmdStr);\n                for (var k = 0; k < nPoint; k++) {\n                    var p = points$3[k];\n\n                    m && applyTransform(p, p, m);\n                    //  round \n                    str.push(\n                        round$3(p[0] * Z - Z2), comma, round$3(p[1] * Z - Z2),\n                        k < nPoint - 1 ? comma : ''\n                    );\n                }\n            }\n        }\n\n        return str.join('');\n    };\n\n    // Rewrite the original path method\n    Path.prototype.brushVML = function (vmlRoot) {\n        var style = this.style;\n\n        var vmlEl = this._vmlEl;\n        if (!vmlEl) {\n            vmlEl = createNode('shape');\n            initRootElStyle(vmlEl);\n\n            this._vmlEl = vmlEl;\n        }\n\n        updateFillAndStroke(vmlEl, 'fill', style, this);\n        updateFillAndStroke(vmlEl, 'stroke', style, this);\n\n        var m = this.transform;\n        var needTransform = m != null;\n        var strokeEl = vmlEl.getElementsByTagName('stroke')[0];\n        if (strokeEl) {\n            var lineWidth = style.lineWidth;\n            // Get the line scale.\n            // Determinant of this.m_ means how much the area is enlarged by the\n            // transformation. So its square root can be used as a scale factor\n            // for width.\n            if (needTransform && !style.strokeNoScale) {\n                var det = m[0] * m[3] - m[1] * m[2];\n                lineWidth *= sqrt(abs$1(det));\n            }\n            strokeEl.weight = lineWidth + 'px';\n        }\n\n        var path = this.path || (this.path = new PathProxy());\n        if (this.__dirtyPath) {\n            path.beginPath();\n            this.buildPath(path, this.shape);\n            path.toStatic();\n            this.__dirtyPath = false;\n        }\n\n        vmlEl.path = pathDataToString(path, this.transform);\n\n        vmlEl.style.zIndex = getZIndex(this.zlevel, this.z, this.z2);\n\n        // Append to root\n        append(vmlRoot, vmlEl);\n\n        // Text\n        if (style.text != null) {\n            this.drawRectText(vmlRoot, this.getBoundingRect());\n        }\n        else {\n            this.removeRectText(vmlRoot);\n        }\n    };\n\n    Path.prototype.onRemove = function (vmlRoot) {\n        remove(vmlRoot, this._vmlEl);\n        this.removeRectText(vmlRoot);\n    };\n\n    Path.prototype.onAdd = function (vmlRoot) {\n        append(vmlRoot, this._vmlEl);\n        this.appendRectText(vmlRoot);\n    };\n\n    /***************************************************\n     * IMAGE\n     **************************************************/\n    var isImage = function (img) {\n        // FIXME img instanceof Image  img IE8 \n        return (typeof img === 'object') && img.tagName && img.tagName.toUpperCase() === 'IMG';\n        // return img instanceof Image;\n    };\n\n    // Rewrite the original path method\n    ZImage.prototype.brushVML = function (vmlRoot) {\n        var style = this.style;\n        var image = style.image;\n\n        // Image original width, height\n        var ow;\n        var oh;\n\n        if (isImage(image)) {\n            var src = image.src;\n            if (src === this._imageSrc) {\n                ow = this._imageWidth;\n                oh = this._imageHeight;\n            }\n            else {\n                var imageRuntimeStyle = image.runtimeStyle;\n                var oldRuntimeWidth = imageRuntimeStyle.width;\n                var oldRuntimeHeight = imageRuntimeStyle.height;\n                imageRuntimeStyle.width = 'auto';\n                imageRuntimeStyle.height = 'auto';\n\n                // get the original size\n                ow = image.width;\n                oh = image.height;\n\n                // and remove overides\n                imageRuntimeStyle.width = oldRuntimeWidth;\n                imageRuntimeStyle.height = oldRuntimeHeight;\n\n                // Caching image original width, height and src\n                this._imageSrc = src;\n                this._imageWidth = ow;\n                this._imageHeight = oh;\n            }\n            image = src;\n        }\n        else {\n            if (image === this._imageSrc) {\n                ow = this._imageWidth;\n                oh = this._imageHeight;\n            }\n        }\n        if (!image) {\n            return;\n        }\n\n        var x = style.x || 0;\n        var y = style.y || 0;\n\n        var dw = style.width;\n        var dh = style.height;\n\n        var sw = style.sWidth;\n        var sh = style.sHeight;\n        var sx = style.sx || 0;\n        var sy = style.sy || 0;\n\n        var hasCrop = sw && sh;\n\n        var vmlEl = this._vmlEl;\n        if (!vmlEl) {\n            // FIXME  group  left, top  0 \n            // vmlEl = vmlCore.createNode('group');\n            vmlEl = doc.createElement('div');\n            initRootElStyle(vmlEl);\n\n            this._vmlEl = vmlEl;\n        }\n\n        var vmlElStyle = vmlEl.style;\n        var hasRotation = false;\n        var m;\n        var scaleX = 1;\n        var scaleY = 1;\n        if (this.transform) {\n            m = this.transform;\n            scaleX = sqrt(m[0] * m[0] + m[1] * m[1]);\n            scaleY = sqrt(m[2] * m[2] + m[3] * m[3]);\n\n            hasRotation = m[1] || m[2];\n        }\n        if (hasRotation) {\n            // If filters are necessary (rotation exists), create them\n            // filters are bog-slow, so only create them if abbsolutely necessary\n            // The following check doesn't account for skews (which don't exist\n            // in the canvas spec (yet) anyway.\n            // From excanvas\n            var p0 = [x, y];\n            var p1 = [x + dw, y];\n            var p2 = [x, y + dh];\n            var p3 = [x + dw, y + dh];\n            applyTransform(p0, p0, m);\n            applyTransform(p1, p1, m);\n            applyTransform(p2, p2, m);\n            applyTransform(p3, p3, m);\n\n            var maxX = mathMax$8(p0[0], p1[0], p2[0], p3[0]);\n            var maxY = mathMax$8(p0[1], p1[1], p2[1], p3[1]);\n\n            var transformFilter = [];\n            transformFilter.push('M11=', m[0] / scaleX, comma,\n                        'M12=', m[2] / scaleY, comma,\n                        'M21=', m[1] / scaleX, comma,\n                        'M22=', m[3] / scaleY, comma,\n                        'Dx=', round$3(x * scaleX + m[4]), comma,\n                        'Dy=', round$3(y * scaleY + m[5]));\n\n            vmlElStyle.padding = '0 ' + round$3(maxX) + 'px ' + round$3(maxY) + 'px 0';\n            // FIXME DXImageTransform  IE11 \n            vmlElStyle.filter = imageTransformPrefix + '.Matrix('\n                + transformFilter.join('') + ', SizingMethod=clip)';\n\n        }\n        else {\n            if (m) {\n                x = x * scaleX + m[4];\n                y = y * scaleY + m[5];\n            }\n            vmlElStyle.filter = '';\n            vmlElStyle.left = round$3(x) + 'px';\n            vmlElStyle.top = round$3(y) + 'px';\n        }\n\n        var imageEl = this._imageEl;\n        var cropEl = this._cropEl;\n\n        if (!imageEl) {\n            imageEl = doc.createElement('div');\n            this._imageEl = imageEl;\n        }\n        var imageELStyle = imageEl.style;\n        if (hasCrop) {\n            // Needs know image original width and height\n            if (! (ow && oh)) {\n                var tmpImage = new Image();\n                var self = this;\n                tmpImage.onload = function () {\n                    tmpImage.onload = null;\n                    ow = tmpImage.width;\n                    oh = tmpImage.height;\n                    // Adjust image width and height to fit the ratio destinationSize / sourceSize\n                    imageELStyle.width = round$3(scaleX * ow * dw / sw) + 'px';\n                    imageELStyle.height = round$3(scaleY * oh * dh / sh) + 'px';\n\n                    // Caching image original width, height and src\n                    self._imageWidth = ow;\n                    self._imageHeight = oh;\n                    self._imageSrc = image;\n                };\n                tmpImage.src = image;\n            }\n            else {\n                imageELStyle.width = round$3(scaleX * ow * dw / sw) + 'px';\n                imageELStyle.height = round$3(scaleY * oh * dh / sh) + 'px';\n            }\n\n            if (! cropEl) {\n                cropEl = doc.createElement('div');\n                cropEl.style.overflow = 'hidden';\n                this._cropEl = cropEl;\n            }\n            var cropElStyle = cropEl.style;\n            cropElStyle.width = round$3((dw + sx * dw / sw) * scaleX);\n            cropElStyle.height = round$3((dh + sy * dh / sh) * scaleY);\n            cropElStyle.filter = imageTransformPrefix + '.Matrix(Dx='\n                    + (-sx * dw / sw * scaleX) + ',Dy=' + (-sy * dh / sh * scaleY) + ')';\n\n            if (! cropEl.parentNode) {\n                vmlEl.appendChild(cropEl);\n            }\n            if (imageEl.parentNode != cropEl) {\n                cropEl.appendChild(imageEl);\n            }\n        }\n        else {\n            imageELStyle.width = round$3(scaleX * dw) + 'px';\n            imageELStyle.height = round$3(scaleY * dh) + 'px';\n\n            vmlEl.appendChild(imageEl);\n\n            if (cropEl && cropEl.parentNode) {\n                vmlEl.removeChild(cropEl);\n                this._cropEl = null;\n            }\n        }\n\n        var filterStr = '';\n        var alpha = style.opacity;\n        if (alpha < 1) {\n            filterStr += '.Alpha(opacity=' + round$3(alpha * 100) + ') ';\n        }\n        filterStr += imageTransformPrefix + '.AlphaImageLoader(src=' + image + ', SizingMethod=scale)';\n\n        imageELStyle.filter = filterStr;\n\n        vmlEl.style.zIndex = getZIndex(this.zlevel, this.z, this.z2);\n\n        // Append to root\n        append(vmlRoot, vmlEl);\n\n        // Text\n        if (style.text != null) {\n            this.drawRectText(vmlRoot, this.getBoundingRect());\n        }\n    };\n\n    ZImage.prototype.onRemove = function (vmlRoot) {\n        remove(vmlRoot, this._vmlEl);\n\n        this._vmlEl = null;\n        this._cropEl = null;\n        this._imageEl = null;\n\n        this.removeRectText(vmlRoot);\n    };\n\n    ZImage.prototype.onAdd = function (vmlRoot) {\n        append(vmlRoot, this._vmlEl);\n        this.appendRectText(vmlRoot);\n    };\n\n\n    /***************************************************\n     * TEXT\n     **************************************************/\n\n    var DEFAULT_STYLE_NORMAL = 'normal';\n\n    var fontStyleCache = {};\n    var fontStyleCacheCount = 0;\n    var MAX_FONT_CACHE_SIZE = 100;\n    var fontEl = document.createElement('div');\n\n    var getFontStyle = function (fontString) {\n        var fontStyle = fontStyleCache[fontString];\n        if (!fontStyle) {\n            // Clear cache\n            if (fontStyleCacheCount > MAX_FONT_CACHE_SIZE) {\n                fontStyleCacheCount = 0;\n                fontStyleCache = {};\n            }\n\n            var style = fontEl.style;\n            var fontFamily;\n            try {\n                style.font = fontString;\n                fontFamily = style.fontFamily.split(',')[0];\n            }\n            catch (e) {\n            }\n\n            fontStyle = {\n                style: style.fontStyle || DEFAULT_STYLE_NORMAL,\n                variant: style.fontVariant || DEFAULT_STYLE_NORMAL,\n                weight: style.fontWeight || DEFAULT_STYLE_NORMAL,\n                size: parseFloat(style.fontSize || 12) | 0,\n                family: fontFamily || 'Microsoft YaHei'\n            };\n\n            fontStyleCache[fontString] = fontStyle;\n            fontStyleCacheCount++;\n        }\n        return fontStyle;\n    };\n\n    var textMeasureEl;\n    // Overwrite measure text method\n    $override$1('measureText', function (text, textFont) {\n        var doc$$1 = doc;\n        if (!textMeasureEl) {\n            textMeasureEl = doc$$1.createElement('div');\n            textMeasureEl.style.cssText = 'position:absolute;top:-20000px;left:0;'\n                + 'padding:0;margin:0;border:none;white-space:pre;';\n            doc.body.appendChild(textMeasureEl);\n        }\n\n        try {\n            textMeasureEl.style.font = textFont;\n        } catch (ex) {\n            // Ignore failures to set to invalid font.\n        }\n        textMeasureEl.innerHTML = '';\n        // Don't use innerHTML or innerText because they allow markup/whitespace.\n        textMeasureEl.appendChild(doc$$1.createTextNode(text));\n        return {\n            width: textMeasureEl.offsetWidth\n        };\n    });\n\n    var tmpRect$2 = new BoundingRect();\n\n    var drawRectText = function (vmlRoot, rect, textRect, fromTextEl) {\n\n        var style = this.style;\n\n        // Optimize, avoid normalize every time.\n        this.__dirty && normalizeTextStyle(style, true);\n\n        var text = style.text;\n        // Convert to string\n        text != null && (text += '');\n        if (!text) {\n            return;\n        }\n\n        // Convert rich text to plain text. Rich text is not supported in\n        // IE8-, but tags in rich text template will be removed.\n        if (style.rich) {\n            var contentBlock = parseRichText(text, style);\n            text = [];\n            for (var i = 0; i < contentBlock.lines.length; i++) {\n                var tokens = contentBlock.lines[i].tokens;\n                var textLine = [];\n                for (var j = 0; j < tokens.length; j++) {\n                    textLine.push(tokens[j].text);\n                }\n                text.push(textLine.join(''));\n            }\n            text = text.join('\\n');\n        }\n\n        var x;\n        var y;\n        var align = style.textAlign;\n        var verticalAlign = style.textVerticalAlign;\n\n        var fontStyle = getFontStyle(style.font);\n        // FIXME encodeHtmlAttribute ?\n        var font = fontStyle.style + ' ' + fontStyle.variant + ' ' + fontStyle.weight + ' '\n            + fontStyle.size + 'px \"' + fontStyle.family + '\"';\n\n        textRect = textRect || getBoundingRect(text, font, align, verticalAlign);\n\n        // Transform rect to view space\n        var m = this.transform;\n        // Ignore transform for text in other element\n        if (m && !fromTextEl) {\n            tmpRect$2.copy(rect);\n            tmpRect$2.applyTransform(m);\n            rect = tmpRect$2;\n        }\n\n        if (!fromTextEl) {\n            var textPosition = style.textPosition;\n            var distance$$1 = style.textDistance;\n            // Text position represented by coord\n            if (textPosition instanceof Array) {\n                x = rect.x + parsePercent$3(textPosition[0], rect.width);\n                y = rect.y + parsePercent$3(textPosition[1], rect.height);\n\n                align = align || 'left';\n            }\n            else {\n                var res = adjustTextPositionOnRect(\n                    textPosition, rect, distance$$1\n                );\n                x = res.x;\n                y = res.y;\n\n                // Default align and baseline when has textPosition\n                align = align || res.textAlign;\n                verticalAlign = verticalAlign || res.textVerticalAlign;\n            }\n        }\n        else {\n            x = rect.x;\n            y = rect.y;\n        }\n\n        x = adjustTextX(x, textRect.width, align);\n        y = adjustTextY(y, textRect.height, verticalAlign);\n\n        // Force baseline 'middle'\n        y += textRect.height / 2;\n\n        // var fontSize = fontStyle.size;\n        // 1.75 is an arbitrary number, as there is no info about the text baseline\n        // switch (baseline) {\n            // case 'hanging':\n            // case 'top':\n            //     y += fontSize / 1.75;\n            //     break;\n        //     case 'middle':\n        //         break;\n        //     default:\n        //     // case null:\n        //     // case 'alphabetic':\n        //     // case 'ideographic':\n        //     // case 'bottom':\n        //         y -= fontSize / 2.25;\n        //         break;\n        // }\n\n        // switch (align) {\n        //     case 'left':\n        //         break;\n        //     case 'center':\n        //         x -= textRect.width / 2;\n        //         break;\n        //     case 'right':\n        //         x -= textRect.width;\n        //         break;\n            // case 'end':\n                // align = elementStyle.direction == 'ltr' ? 'right' : 'left';\n                // break;\n            // case 'start':\n                // align = elementStyle.direction == 'rtl' ? 'right' : 'left';\n                // break;\n            // default:\n            //     align = 'left';\n        // }\n\n        var createNode$$1 = createNode;\n\n        var textVmlEl = this._textVmlEl;\n        var pathEl;\n        var textPathEl;\n        var skewEl;\n        if (!textVmlEl) {\n            textVmlEl = createNode$$1('line');\n            pathEl = createNode$$1('path');\n            textPathEl = createNode$$1('textpath');\n            skewEl = createNode$$1('skew');\n\n            // FIXME Why here is not cammel case\n            // Align 'center' seems wrong\n            textPathEl.style['v-text-align'] = 'left';\n\n            initRootElStyle(textVmlEl);\n\n            pathEl.textpathok = true;\n            textPathEl.on = true;\n\n            textVmlEl.from = '0 0';\n            textVmlEl.to = '1000 0.05';\n\n            append(textVmlEl, skewEl);\n            append(textVmlEl, pathEl);\n            append(textVmlEl, textPathEl);\n\n            this._textVmlEl = textVmlEl;\n        }\n        else {\n            //  appendChild \n            skewEl = textVmlEl.firstChild;\n            pathEl = skewEl.nextSibling;\n            textPathEl = pathEl.nextSibling;\n        }\n\n        var coords = [x, y];\n        var textVmlElStyle = textVmlEl.style;\n        // Ignore transform for text in other element\n        if (m && fromTextEl) {\n            applyTransform(coords, coords, m);\n\n            skewEl.on = true;\n\n            skewEl.matrix = m[0].toFixed(3) + comma + m[2].toFixed(3) + comma +\n            m[1].toFixed(3) + comma + m[3].toFixed(3) + ',0,0';\n\n            // Text position\n            skewEl.offset = (round$3(coords[0]) || 0) + ',' + (round$3(coords[1]) || 0);\n            // Left top point as origin\n            skewEl.origin = '0 0';\n\n            textVmlElStyle.left = '0px';\n            textVmlElStyle.top = '0px';\n        }\n        else {\n            skewEl.on = false;\n            textVmlElStyle.left = round$3(x) + 'px';\n            textVmlElStyle.top = round$3(y) + 'px';\n        }\n\n        textPathEl.string = encodeHtmlAttribute(text);\n        // TODO\n        try {\n            textPathEl.style.font = font;\n        }\n        // Error font format\n        catch (e) {}\n\n        updateFillAndStroke(textVmlEl, 'fill', {\n            fill: style.textFill,\n            opacity: style.opacity\n        }, this);\n        updateFillAndStroke(textVmlEl, 'stroke', {\n            stroke: style.textStroke,\n            opacity: style.opacity,\n            lineDash: style.lineDash\n        }, this);\n\n        textVmlEl.style.zIndex = getZIndex(this.zlevel, this.z, this.z2);\n\n        // Attached to root\n        append(vmlRoot, textVmlEl);\n    };\n\n    var removeRectText = function (vmlRoot) {\n        remove(vmlRoot, this._textVmlEl);\n        this._textVmlEl = null;\n    };\n\n    var appendRectText = function (vmlRoot) {\n        append(vmlRoot, this._textVmlEl);\n    };\n\n    var list = [RectText, Displayable, ZImage, Path, Text];\n\n    // In case Displayable has been mixed in RectText\n    for (var i$3 = 0; i$3 < list.length; i$3++) {\n        var proto$8 = list[i$3].prototype;\n        proto$8.drawRectText = drawRectText;\n        proto$8.removeRectText = removeRectText;\n        proto$8.appendRectText = appendRectText;\n    }\n\n    Text.prototype.brushVML = function (vmlRoot) {\n        var style = this.style;\n        if (style.text != null) {\n            this.drawRectText(vmlRoot, {\n                x: style.x || 0, y: style.y || 0,\n                width: 0, height: 0\n            }, this.getBoundingRect(), true);\n        }\n        else {\n            this.removeRectText(vmlRoot);\n        }\n    };\n\n    Text.prototype.onRemove = function (vmlRoot) {\n        this.removeRectText(vmlRoot);\n    };\n\n    Text.prototype.onAdd = function (vmlRoot) {\n        this.appendRectText(vmlRoot);\n    };\n}\n\n/**\n * VML Painter.\n *\n * @module zrender/vml/Painter\n */\n\nfunction parseInt10$1(val) {\n    return parseInt(val, 10);\n}\n\n/**\n * @alias module:zrender/vml/Painter\n */\nfunction VMLPainter(root, storage) {\n\n    initVML();\n\n    this.root = root;\n\n    this.storage = storage;\n\n    var vmlViewport = document.createElement('div');\n\n    var vmlRoot = document.createElement('div');\n\n    vmlViewport.style.cssText = 'display:inline-block;overflow:hidden;position:relative;width:300px;height:150px;';\n\n    vmlRoot.style.cssText = 'position:absolute;left:0;top:0;';\n\n    root.appendChild(vmlViewport);\n\n    this._vmlRoot = vmlRoot;\n    this._vmlViewport = vmlViewport;\n\n    this.resize();\n\n    // Modify storage\n    var oldDelFromStorage = storage.delFromStorage;\n    var oldAddToStorage = storage.addToStorage;\n    storage.delFromStorage = function (el) {\n        oldDelFromStorage.call(storage, el);\n\n        if (el) {\n            el.onRemove && el.onRemove(vmlRoot);\n        }\n    };\n\n    storage.addToStorage = function (el) {\n        // Displayable already has a vml node\n        el.onAdd && el.onAdd(vmlRoot);\n\n        oldAddToStorage.call(storage, el);\n    };\n\n    this._firstPaint = true;\n}\n\nVMLPainter.prototype = {\n\n    constructor: VMLPainter,\n\n    getType: function () {\n        return 'vml';\n    },\n\n    /**\n     * @return {HTMLDivElement}\n     */\n    getViewportRoot: function () {\n        return this._vmlViewport;\n    },\n\n    getViewportRootOffset: function () {\n        var viewportRoot = this.getViewportRoot();\n        if (viewportRoot) {\n            return {\n                offsetLeft: viewportRoot.offsetLeft || 0,\n                offsetTop: viewportRoot.offsetTop || 0\n            };\n        }\n    },\n\n    /**\n     * \n     */\n    refresh: function () {\n\n        var list = this.storage.getDisplayList(true, true);\n\n        this._paintList(list);\n    },\n\n    _paintList: function (list) {\n        var vmlRoot = this._vmlRoot;\n        for (var i = 0; i < list.length; i++) {\n            var el = list[i];\n            if (el.invisible || el.ignore) {\n                if (!el.__alreadyNotVisible) {\n                    el.onRemove(vmlRoot);\n                }\n                // Set as already invisible\n                el.__alreadyNotVisible = true;\n            }\n            else {\n                if (el.__alreadyNotVisible) {\n                    el.onAdd(vmlRoot);\n                }\n                el.__alreadyNotVisible = false;\n                if (el.__dirty) {\n                    el.beforeBrush && el.beforeBrush();\n                    (el.brushVML || el.brush).call(el, vmlRoot);\n                    el.afterBrush && el.afterBrush();\n                }\n            }\n            el.__dirty = false;\n        }\n\n        if (this._firstPaint) {\n            // Detached from document at first time\n            // to avoid page refreshing too many times\n\n            // FIXME  removeChild \n            this._vmlViewport.appendChild(vmlRoot);\n            this._firstPaint = false;\n        }\n    },\n\n    resize: function (width, height) {\n        var width = width == null ? this._getWidth() : width;\n        var height = height == null ? this._getHeight() : height;\n\n        if (this._width != width || this._height != height) {\n            this._width = width;\n            this._height = height;\n\n            var vmlViewportStyle = this._vmlViewport.style;\n            vmlViewportStyle.width = width + 'px';\n            vmlViewportStyle.height = height + 'px';\n        }\n    },\n\n    dispose: function () {\n        this.root.innerHTML = '';\n\n        this._vmlRoot =\n        this._vmlViewport =\n        this.storage = null;\n    },\n\n    getWidth: function () {\n        return this._width;\n    },\n\n    getHeight: function () {\n        return this._height;\n    },\n\n    clear: function () {\n        if (this._vmlViewport) {\n            this.root.removeChild(this._vmlViewport);\n        }\n    },\n\n    _getWidth: function () {\n        var root = this.root;\n        var stl = root.currentStyle;\n\n        return ((root.clientWidth || parseInt10$1(stl.width))\n                - parseInt10$1(stl.paddingLeft)\n                - parseInt10$1(stl.paddingRight)) | 0;\n    },\n\n    _getHeight: function () {\n        var root = this.root;\n        var stl = root.currentStyle;\n\n        return ((root.clientHeight || parseInt10$1(stl.height))\n                - parseInt10$1(stl.paddingTop)\n                - parseInt10$1(stl.paddingBottom)) | 0;\n    }\n};\n\n// Not supported methods\nfunction createMethodNotSupport(method) {\n    return function () {\n        zrLog('In IE8.0 VML mode painter not support method \"' + method + '\"');\n    };\n}\n\n// Unsupported methods\neach$1([\n    'getLayer', 'insertLayer', 'eachLayer', 'eachBuiltinLayer', 'eachOtherLayer', 'getLayers',\n    'modLayer', 'delLayer', 'clearLayer', 'toDataURL', 'pathToImage'\n], function (name) {\n    VMLPainter.prototype[name] = createMethodNotSupport(name);\n});\n\nregisterPainter('vml', VMLPainter);\n\nvar svgURI = 'http://www.w3.org/2000/svg';\n\nfunction createElement(name) {\n    return document.createElementNS(svgURI, name);\n}\n\n// TODO\n// 1. shadow\n// 2. Image: sx, sy, sw, sh\n\nvar CMD$4 = PathProxy.CMD;\nvar arrayJoin = Array.prototype.join;\n\nvar NONE = 'none';\nvar mathRound = Math.round;\nvar mathSin$3 = Math.sin;\nvar mathCos$3 = Math.cos;\nvar PI$5 = Math.PI;\nvar PI2$7 = Math.PI * 2;\nvar degree = 180 / PI$5;\n\nvar EPSILON$4 = 1e-4;\n\nfunction round4(val) {\n    return mathRound(val * 1e4) / 1e4;\n}\n\nfunction isAroundZero$1(val) {\n    return val < EPSILON$4 && val > -EPSILON$4;\n}\n\nfunction pathHasFill(style, isText) {\n    var fill = isText ? style.textFill : style.fill;\n    return fill != null && fill !== NONE;\n}\n\nfunction pathHasStroke(style, isText) {\n    var stroke = isText ? style.textStroke : style.stroke;\n    return stroke != null && stroke !== NONE;\n}\n\nfunction setTransform(svgEl, m) {\n    if (m) {\n        attr(svgEl, 'transform', 'matrix(' + arrayJoin.call(m, ',') + ')');\n    }\n}\n\nfunction attr(el, key, val) {\n    if (!val || val.type !== 'linear' && val.type !== 'radial') {\n        // Don't set attribute for gradient, since it need new dom nodes\n        el.setAttribute(key, val);\n    }\n}\n\nfunction attrXLink(el, key, val) {\n    el.setAttributeNS('http://www.w3.org/1999/xlink', key, val);\n}\n\nfunction bindStyle(svgEl, style, isText) {\n    if (pathHasFill(style, isText)) {\n        var fill = isText ? style.textFill : style.fill;\n        fill = fill === 'transparent' ? NONE : fill;\n\n        /**\n         * FIXME:\n         * This is a temporary fix for Chrome's clipping bug\n         * that happens when a clip-path is referring another one.\n         * This fix should be used before Chrome's bug is fixed.\n         * For an element that has clip-path, and fill is none,\n         * set it to be \"rgba(0, 0, 0, 0.002)\" will hide the element.\n         * Otherwise, it will show black fill color.\n         * 0.002 is used because this won't work for alpha values smaller\n         * than 0.002.\n         *\n         * See\n         * https://bugs.chromium.org/p/chromium/issues/detail?id=659790\n         * for more information.\n         */\n        if (svgEl.getAttribute('clip-path') !== 'none' && fill === NONE) {\n            fill = 'rgba(0, 0, 0, 0.002)';\n        }\n\n        attr(svgEl, 'fill', fill);\n        attr(svgEl, 'fill-opacity', style.opacity);\n    }\n    else {\n        attr(svgEl, 'fill', NONE);\n    }\n\n    if (pathHasStroke(style, isText)) {\n        var stroke = isText ? style.textStroke : style.stroke;\n        stroke = stroke === 'transparent' ? NONE : stroke;\n        attr(svgEl, 'stroke', stroke);\n        var strokeWidth = isText\n            ? style.textStrokeWidth\n            : style.lineWidth;\n        var strokeScale = !isText && style.strokeNoScale\n            ? style.host.getLineScale()\n            : 1;\n        attr(svgEl, 'stroke-width', strokeWidth / strokeScale);\n        // stroke then fill for text; fill then stroke for others\n        attr(svgEl, 'paint-order', isText ? 'stroke' : 'fill');\n        attr(svgEl, 'stroke-opacity', style.opacity);\n        var lineDash = style.lineDash;\n        if (lineDash) {\n            attr(svgEl, 'stroke-dasharray', style.lineDash.join(','));\n            attr(svgEl, 'stroke-dashoffset', mathRound(style.lineDashOffset || 0));\n        }\n        else {\n            attr(svgEl, 'stroke-dasharray', '');\n        }\n\n        // PENDING\n        style.lineCap && attr(svgEl, 'stroke-linecap', style.lineCap);\n        style.lineJoin && attr(svgEl, 'stroke-linejoin', style.lineJoin);\n        style.miterLimit && attr(svgEl, 'stroke-miterlimit', style.miterLimit);\n    }\n    else {\n        attr(svgEl, 'stroke', NONE);\n    }\n}\n\n/***************************************************\n * PATH\n **************************************************/\nfunction pathDataToString$1(path) {\n    var str = [];\n    var data = path.data;\n    var dataLength = path.len();\n    for (var i = 0; i < dataLength;) {\n        var cmd = data[i++];\n        var cmdStr = '';\n        var nData = 0;\n        switch (cmd) {\n            case CMD$4.M:\n                cmdStr = 'M';\n                nData = 2;\n                break;\n            case CMD$4.L:\n                cmdStr = 'L';\n                nData = 2;\n                break;\n            case CMD$4.Q:\n                cmdStr = 'Q';\n                nData = 4;\n                break;\n            case CMD$4.C:\n                cmdStr = 'C';\n                nData = 6;\n                break;\n            case CMD$4.A:\n                var cx = data[i++];\n                var cy = data[i++];\n                var rx = data[i++];\n                var ry = data[i++];\n                var theta = data[i++];\n                var dTheta = data[i++];\n                var psi = data[i++];\n                var clockwise = data[i++];\n\n                var dThetaPositive = Math.abs(dTheta);\n                var isCircle = isAroundZero$1(dThetaPositive - PI2$7)\n                    && !isAroundZero$1(dThetaPositive);\n\n                var large = false;\n                if (dThetaPositive >= PI2$7) {\n                    large = true;\n                }\n                else if (isAroundZero$1(dThetaPositive)) {\n                    large = false;\n                }\n                else {\n                    large = (dTheta > -PI$5 && dTheta < 0 || dTheta > PI$5)\n                        === !!clockwise;\n                }\n\n                var x0 = round4(cx + rx * mathCos$3(theta));\n                var y0 = round4(cy + ry * mathSin$3(theta));\n\n                // It will not draw if start point and end point are exactly the same\n                // We need to shift the end point with a small value\n                // FIXME A better way to draw circle ?\n                if (isCircle) {\n                    if (clockwise) {\n                        dTheta = PI2$7 - 1e-4;\n                    }\n                    else {\n                        dTheta = -PI2$7 + 1e-4;\n                    }\n\n                    large = true;\n\n                    if (i === 9) {\n                        // Move to (x0, y0) only when CMD.A comes at the\n                        // first position of a shape.\n                        // For instance, when drawing a ring, CMD.A comes\n                        // after CMD.M, so it's unnecessary to move to\n                        // (x0, y0).\n                        str.push('M', x0, y0);\n                    }\n                }\n\n                var x = round4(cx + rx * mathCos$3(theta + dTheta));\n                var y = round4(cy + ry * mathSin$3(theta + dTheta));\n\n                // FIXME Ellipse\n                str.push('A', round4(rx), round4(ry),\n                    mathRound(psi * degree), +large, +clockwise, x, y);\n                break;\n            case CMD$4.Z:\n                cmdStr = 'Z';\n                break;\n            case CMD$4.R:\n                var x = round4(data[i++]);\n                var y = round4(data[i++]);\n                var w = round4(data[i++]);\n                var h = round4(data[i++]);\n                str.push(\n                    'M', x, y,\n                    'L', x + w, y,\n                    'L', x + w, y + h,\n                    'L', x, y + h,\n                    'L', x, y\n                );\n                break;\n        }\n        cmdStr && str.push(cmdStr);\n        for (var j = 0; j < nData; j++) {\n            // PENDING With scale\n            str.push(round4(data[i++]));\n        }\n    }\n    return str.join(' ');\n}\n\nvar svgPath = {};\nsvgPath.brush = function (el) {\n    var style = el.style;\n\n    var svgEl = el.__svgEl;\n    if (!svgEl) {\n        svgEl = createElement('path');\n        el.__svgEl = svgEl;\n    }\n\n    if (!el.path) {\n        el.createPathProxy();\n    }\n    var path = el.path;\n\n    if (el.__dirtyPath) {\n        path.beginPath();\n        el.buildPath(path, el.shape);\n        el.__dirtyPath = false;\n\n        var pathStr = pathDataToString$1(path);\n        if (pathStr.indexOf('NaN') < 0) {\n            // Ignore illegal path, which may happen such in out-of-range\n            // data in Calendar series.\n            attr(svgEl, 'd', pathStr);\n        }\n    }\n\n    bindStyle(svgEl, style);\n    setTransform(svgEl, el.transform);\n\n    if (style.text != null) {\n        svgTextDrawRectText(el, el.getBoundingRect());\n    }\n};\n\n/***************************************************\n * IMAGE\n **************************************************/\nvar svgImage = {};\nsvgImage.brush = function (el) {\n    var style = el.style;\n    var image = style.image;\n\n    if (image instanceof HTMLImageElement) {\n        var src = image.src;\n        image = src;\n    }\n    if (! image) {\n        return;\n    }\n\n    var x = style.x || 0;\n    var y = style.y || 0;\n\n    var dw = style.width;\n    var dh = style.height;\n\n    var svgEl = el.__svgEl;\n    if (! svgEl) {\n        svgEl = createElement('image');\n        el.__svgEl = svgEl;\n    }\n\n    if (image !== el.__imageSrc) {\n        attrXLink(svgEl, 'href', image);\n        // Caching image src\n        el.__imageSrc = image;\n    }\n\n    attr(svgEl, 'width', dw);\n    attr(svgEl, 'height', dh);\n\n    attr(svgEl, 'x', x);\n    attr(svgEl, 'y', y);\n\n    setTransform(svgEl, el.transform);\n\n    if (style.text != null) {\n        svgTextDrawRectText(el, el.getBoundingRect());\n    }\n};\n\n/***************************************************\n * TEXT\n **************************************************/\nvar svgText = {};\nvar tmpRect$3 = new BoundingRect();\n\nvar svgTextDrawRectText = function (el, rect, textRect) {\n    var style = el.style;\n\n    el.__dirty && normalizeTextStyle(style, true);\n\n    var text = style.text;\n    // Convert to string\n    if (text == null) {\n        // Draw no text only when text is set to null, but not ''\n        return;\n    }\n    else {\n        text += '';\n    }\n\n    var textSvgEl = el.__textSvgEl;\n    if (! textSvgEl) {\n        textSvgEl = createElement('text');\n        el.__textSvgEl = textSvgEl;\n    }\n\n    var x;\n    var y;\n    var textPosition = style.textPosition;\n    var distance = style.textDistance;\n    var align = style.textAlign || 'left';\n\n    if (typeof style.fontSize === 'number') {\n        style.fontSize += 'px';\n    }\n    var font = style.font\n        || [\n            style.fontStyle || '',\n            style.fontWeight || '',\n            style.fontSize || '',\n            style.fontFamily || ''\n        ].join(' ')\n        || DEFAULT_FONT;\n\n    var verticalAlign = getVerticalAlignForSvg(style.textVerticalAlign);\n\n    textRect = getBoundingRect(text, font, align,\n        verticalAlign);\n\n    var lineHeight = textRect.lineHeight;\n    // Text position represented by coord\n    if (textPosition instanceof Array) {\n        x = rect.x + textPosition[0];\n        y = rect.y + textPosition[1];\n    }\n    else {\n        var newPos = adjustTextPositionOnRect(\n            textPosition, rect, distance\n        );\n        x = newPos.x;\n        y = newPos.y;\n        verticalAlign = getVerticalAlignForSvg(newPos.textVerticalAlign);\n        align = newPos.textAlign;\n    }\n\n    attr(textSvgEl, 'alignment-baseline', verticalAlign);\n\n    if (font) {\n        textSvgEl.style.font = font;\n    }\n\n    var textPadding = style.textPadding;\n\n    // Make baseline top\n    attr(textSvgEl, 'x', x);\n    attr(textSvgEl, 'y', y);\n\n    bindStyle(textSvgEl, style, true);\n    if (el instanceof Text || el.style.transformText) {\n        // Transform text with element\n        setTransform(textSvgEl, el.transform);\n    }\n    else {\n        if (el.transform) {\n            tmpRect$3.copy(rect);\n            tmpRect$3.applyTransform(el.transform);\n            rect = tmpRect$3;\n        }\n        else {\n            var pos = el.transformCoordToGlobal(rect.x, rect.y);\n            rect.x = pos[0];\n            rect.y = pos[1];\n        }\n\n        // Text rotation, but no element transform\n        var origin = style.textOrigin;\n        if (origin === 'center') {\n            x = textRect.width / 2 + x;\n            y = textRect.height / 2 + y;\n        }\n        else if (origin) {\n            x = origin[0] + x;\n            y = origin[1] + y;\n        }\n        var rotate = -style.textRotation * 180 / Math.PI;\n        attr(textSvgEl, 'transform', 'rotate(' + rotate + ','\n            + x + ',' + y + ')');\n    }\n\n    var textLines = text.split('\\n');\n    var nTextLines = textLines.length;\n    var textAnchor = align;\n    // PENDING\n    if (textAnchor === 'left')  {\n        textAnchor = 'start';\n        textPadding && (x += textPadding[3]);\n    }\n    else if (textAnchor === 'right') {\n        textAnchor = 'end';\n        textPadding && (x -= textPadding[1]);\n    }\n    else if (textAnchor === 'center') {\n        textAnchor = 'middle';\n        textPadding && (x += (textPadding[3] - textPadding[1]) / 2);\n    }\n\n    var dy = 0;\n    if (verticalAlign === 'baseline') {\n        dy = -textRect.height + lineHeight;\n        textPadding && (dy -= textPadding[2]);\n    }\n    else if (verticalAlign === 'middle') {\n        dy = (-textRect.height + lineHeight) / 2;\n        textPadding && (y += (textPadding[0] - textPadding[2]) / 2);\n    }\n    else {\n        textPadding && (dy += textPadding[0]);\n    }\n\n    // Font may affect position of each tspan elements\n    if (el.__text !== text || el.__textFont !== font) {\n        var tspanList = el.__tspanList || [];\n        el.__tspanList = tspanList;\n        for (var i = 0; i < nTextLines; i++) {\n            // Using cached tspan elements\n            var tspan = tspanList[i];\n            if (! tspan) {\n                tspan = tspanList[i] = createElement('tspan');\n                textSvgEl.appendChild(tspan);\n                attr(tspan, 'alignment-baseline', verticalAlign);\n                attr(tspan, 'text-anchor', textAnchor);\n            }\n            else {\n                tspan.innerHTML = '';\n            }\n            attr(tspan, 'x', x);\n            attr(tspan, 'y', y + i * lineHeight + dy);\n            tspan.appendChild(document.createTextNode(textLines[i]));\n        }\n        // Remove unsed tspan elements\n        for (; i < tspanList.length; i++) {\n            textSvgEl.removeChild(tspanList[i]);\n        }\n        tspanList.length = nTextLines;\n\n        el.__text = text;\n        el.__textFont = font;\n    }\n    else if (el.__tspanList.length) {\n        // Update span x and y\n        var len = el.__tspanList.length;\n        for (var i = 0; i < len; ++i) {\n            var tspan = el.__tspanList[i];\n            if (tspan) {\n                attr(tspan, 'x', x);\n                attr(tspan, 'y', y + i * lineHeight + dy);\n            }\n        }\n    }\n};\n\nfunction getVerticalAlignForSvg(verticalAlign) {\n    if (verticalAlign === 'middle') {\n        return 'middle';\n    }\n    else if (verticalAlign === 'bottom') {\n        return 'baseline';\n    }\n    else {\n        return 'hanging';\n    }\n}\n\nsvgText.drawRectText = svgTextDrawRectText;\n\nsvgText.brush = function (el) {\n    var style = el.style;\n    if (style.text != null) {\n        //  textPosition\n        style.textPosition = [0, 0];\n        svgTextDrawRectText(el, {\n            x: style.x || 0, y: style.y || 0,\n            width: 0, height: 0\n        }, el.getBoundingRect());\n    }\n};\n\n// Myers' Diff Algorithm\n// Modified from https://github.com/kpdecker/jsdiff/blob/master/src/diff/base.js\n\nfunction Diff() {}\n\nDiff.prototype = {\n    diff: function (oldArr, newArr, equals) {\n        if (!equals) {\n            equals = function (a, b) {\n                return a === b;\n            };\n        }\n        this.equals = equals;\n\n        var self = this;\n\n        oldArr = oldArr.slice();\n        newArr = newArr.slice();\n        // Allow subclasses to massage the input prior to running\n        var newLen = newArr.length;\n        var oldLen = oldArr.length;\n        var editLength = 1;\n        var maxEditLength = newLen + oldLen;\n        var bestPath = [{ newPos: -1, components: [] }];\n\n        // Seed editLength = 0, i.e. the content starts with the same values\n        var oldPos = this.extractCommon(bestPath[0], newArr, oldArr, 0);\n        if (bestPath[0].newPos + 1 >= newLen && oldPos + 1 >= oldLen) {\n            var indices = [];\n            for (var i = 0; i < newArr.length; i++) {\n                indices.push(i);\n            }\n            // Identity per the equality and tokenizer\n            return [{\n                indices: indices, count: newArr.length\n            }];\n        }\n\n        // Main worker method. checks all permutations of a given edit length for acceptance.\n        function execEditLength() {\n            for (var diagonalPath = -1 * editLength; diagonalPath <= editLength; diagonalPath += 2) {\n                var basePath;\n                var addPath = bestPath[diagonalPath - 1];\n                var removePath = bestPath[diagonalPath + 1];\n                var oldPos = (removePath ? removePath.newPos : 0) - diagonalPath;\n                if (addPath) {\n                    // No one else is going to attempt to use this value, clear it\n                    bestPath[diagonalPath - 1] = undefined;\n                }\n\n                var canAdd = addPath && addPath.newPos + 1 < newLen;\n                var canRemove = removePath && 0 <= oldPos && oldPos < oldLen;\n                if (!canAdd && !canRemove) {\n                    // If this path is a terminal then prune\n                    bestPath[diagonalPath] = undefined;\n                    continue;\n                }\n\n                // Select the diagonal that we want to branch from. We select the prior\n                // path whose position in the new string is the farthest from the origin\n                // and does not pass the bounds of the diff graph\n                if (!canAdd || (canRemove && addPath.newPos < removePath.newPos)) {\n                    basePath = clonePath(removePath);\n                    self.pushComponent(basePath.components, undefined, true);\n                }\n                else {\n                    basePath = addPath;   // No need to clone, we've pulled it from the list\n                    basePath.newPos++;\n                    self.pushComponent(basePath.components, true, undefined);\n                }\n\n                oldPos = self.extractCommon(basePath, newArr, oldArr, diagonalPath);\n\n                // If we have hit the end of both strings, then we are done\n                if (basePath.newPos + 1 >= newLen && oldPos + 1 >= oldLen) {\n                    return buildValues(self, basePath.components, newArr, oldArr);\n                }\n                else {\n                    // Otherwise track this path as a potential candidate and continue.\n                    bestPath[diagonalPath] = basePath;\n                }\n            }\n\n            editLength++;\n        }\n\n        while (editLength <= maxEditLength) {\n            var ret = execEditLength();\n            if (ret) {\n                return ret;\n            }\n        }\n    },\n\n    pushComponent: function (components, added, removed) {\n        var last = components[components.length - 1];\n        if (last && last.added === added && last.removed === removed) {\n            // We need to clone here as the component clone operation is just\n            // as shallow array clone\n            components[components.length - 1] = {count: last.count + 1, added: added, removed: removed };\n        }\n        else {\n            components.push({count: 1, added: added, removed: removed });\n        }\n    },\n    extractCommon: function (basePath, newArr, oldArr, diagonalPath) {\n        var newLen = newArr.length;\n        var oldLen = oldArr.length;\n        var newPos = basePath.newPos;\n        var oldPos = newPos - diagonalPath;\n        var commonCount = 0;\n\n        while (newPos + 1 < newLen && oldPos + 1 < oldLen && this.equals(newArr[newPos + 1], oldArr[oldPos + 1])) {\n            newPos++;\n            oldPos++;\n            commonCount++;\n        }\n\n        if (commonCount) {\n            basePath.components.push({count: commonCount});\n        }\n\n        basePath.newPos = newPos;\n        return oldPos;\n    },\n    tokenize: function (value) {\n        return value.slice();\n    },\n    join: function (value) {\n        return value.slice();\n    }\n};\n\nfunction buildValues(diff, components, newArr, oldArr) {\n    var componentPos = 0;\n    var componentLen = components.length;\n    var newPos = 0;\n    var oldPos = 0;\n\n    for (; componentPos < componentLen; componentPos++) {\n        var component = components[componentPos];\n        if (!component.removed) {\n            var indices = [];\n            for (var i = newPos; i < newPos + component.count; i++) {\n                indices.push(i);\n            }\n            component.indices = indices;\n            newPos += component.count;\n            // Common case\n            if (!component.added) {\n                oldPos += component.count;\n            }\n        }\n        else {\n            var indices = [];\n            for (var i = oldPos; i < oldPos + component.count; i++) {\n                indices.push(i);\n            }\n            component.indices = indices;\n            oldPos += component.count;\n        }\n    }\n\n    return components;\n}\n\nfunction clonePath(path) {\n    return { newPos: path.newPos, components: path.components.slice(0) };\n}\n\nvar arrayDiff = new Diff();\n\nvar arrayDiff$1 = function (oldArr, newArr, callback) {\n    return arrayDiff.diff(oldArr, newArr, callback);\n};\n\n/**\n * @file Manages elements that can be defined in <defs> in SVG,\n *       e.g., gradients, clip path, etc.\n * @author Zhang Wenli\n */\n\nvar MARK_UNUSED = '0';\nvar MARK_USED = '1';\n\n/**\n * Manages elements that can be defined in <defs> in SVG,\n * e.g., gradients, clip path, etc.\n *\n * @class\n * @param {number}          zrId      zrender instance id\n * @param {SVGElement}      svgRoot   root of SVG document\n * @param {string|string[]} tagNames  possible tag names\n * @param {string}          markLabel label name to make if the element\n *                                    is used\n */\nfunction Definable(\n    zrId,\n    svgRoot,\n    tagNames,\n    markLabel,\n    domName\n) {\n    this._zrId = zrId;\n    this._svgRoot = svgRoot;\n    this._tagNames = typeof tagNames === 'string' ? [tagNames] : tagNames;\n    this._markLabel = markLabel;\n    this._domName = domName || '_dom';\n\n    this.nextId = 0;\n}\n\n\nDefinable.prototype.createElement = createElement;\n\n\n/**\n * Get the <defs> tag for svgRoot; optionally creates one if not exists.\n *\n * @param {boolean} isForceCreating if need to create when not exists\n * @return {SVGDefsElement} SVG <defs> element, null if it doesn't\n * exist and isForceCreating is false\n */\nDefinable.prototype.getDefs = function (isForceCreating) {\n    var svgRoot = this._svgRoot;\n    var defs = this._svgRoot.getElementsByTagName('defs');\n    if (defs.length === 0) {\n        // Not exist\n        if (isForceCreating) {\n            defs = svgRoot.insertBefore(\n                this.createElement('defs'), // Create new tag\n                svgRoot.firstChild // Insert in the front of svg\n            );\n            if (!defs.contains) {\n                // IE doesn't support contains method\n                defs.contains = function (el) {\n                    var children = defs.children;\n                    if (!children) {\n                        return false;\n                    }\n                    for (var i = children.length - 1; i >= 0; --i) {\n                        if (children[i] === el) {\n                            return true;\n                        }\n                    }\n                    return false;\n                };\n            }\n            return defs;\n        }\n        else {\n            return null;\n        }\n    }\n    else {\n        return defs[0];\n    }\n};\n\n\n/**\n * Update DOM element if necessary.\n *\n * @param {Object|string} element style element. e.g., for gradient,\n *                                it may be '#ccc' or {type: 'linear', ...}\n * @param {Function|undefined} onUpdate update callback\n */\nDefinable.prototype.update = function (element, onUpdate) {\n    if (!element) {\n        return;\n    }\n\n    var defs = this.getDefs(false);\n    if (element[this._domName] && defs.contains(element[this._domName])) {\n        // Update DOM\n        if (typeof onUpdate === 'function') {\n            onUpdate(element);\n        }\n    }\n    else {\n        // No previous dom, create new\n        var dom = this.add(element);\n        if (dom) {\n            element[this._domName] = dom;\n        }\n    }\n};\n\n\n/**\n * Add gradient dom to defs\n *\n * @param {SVGElement} dom DOM to be added to <defs>\n */\nDefinable.prototype.addDom = function (dom) {\n    var defs = this.getDefs(true);\n    defs.appendChild(dom);\n};\n\n\n/**\n * Remove DOM of a given element.\n *\n * @param {SVGElement} element element to remove dom\n */\nDefinable.prototype.removeDom = function (element) {\n    var defs = this.getDefs(false);\n    if (defs && element[this._domName]) {\n        defs.removeChild(element[this._domName]);\n        element[this._domName] = null;\n    }\n};\n\n\n/**\n * Get DOMs of this element.\n *\n * @return {HTMLDomElement} doms of this defineable elements in <defs>\n */\nDefinable.prototype.getDoms = function () {\n    var defs = this.getDefs(false);\n    if (!defs) {\n        // No dom when defs is not defined\n        return [];\n    }\n\n    var doms = [];\n    each$1(this._tagNames, function (tagName) {\n        var tags = defs.getElementsByTagName(tagName);\n        // Note that tags is HTMLCollection, which is array-like\n        // rather than real array.\n        // So `doms.concat(tags)` add tags as one object.\n        doms = doms.concat([].slice.call(tags));\n    });\n\n    return doms;\n};\n\n\n/**\n * Mark DOMs to be unused before painting, and clear unused ones at the end\n * of the painting.\n */\nDefinable.prototype.markAllUnused = function () {\n    var doms = this.getDoms();\n    var that = this;\n    each$1(doms, function (dom) {\n        dom[that._markLabel] = MARK_UNUSED;\n    });\n};\n\n\n/**\n * Mark a single DOM to be used.\n *\n * @param {SVGElement} dom DOM to mark\n */\nDefinable.prototype.markUsed = function (dom) {\n    if (dom) {\n        dom[this._markLabel] = MARK_USED;\n    }\n};\n\n\n/**\n * Remove unused DOMs defined in <defs>\n */\nDefinable.prototype.removeUnused = function () {\n    var defs = this.getDefs(false);\n    if (!defs) {\n        // Nothing to remove\n        return;\n    }\n\n    var doms = this.getDoms();\n    var that = this;\n    each$1(doms, function (dom) {\n        if (dom[that._markLabel] !== MARK_USED) {\n            // Remove gradient\n            defs.removeChild(dom);\n        }\n    });\n};\n\n\n/**\n * Get SVG proxy.\n *\n * @param {Displayable} displayable displayable element\n * @return {Path|Image|Text} svg proxy of given element\n */\nDefinable.prototype.getSvgProxy = function (displayable) {\n    if (displayable instanceof Path) {\n        return svgPath;\n    }\n    else if (displayable instanceof ZImage) {\n        return svgImage;\n    }\n    else if (displayable instanceof Text) {\n        return svgText;\n    }\n    else {\n        return svgPath;\n    }\n};\n\n\n/**\n * Get text SVG element.\n *\n * @param {Displayable} displayable displayable element\n * @return {SVGElement} SVG element of text\n */\nDefinable.prototype.getTextSvgElement = function (displayable) {\n    return displayable.__textSvgEl;\n};\n\n\n/**\n * Get SVG element.\n *\n * @param {Displayable} displayable displayable element\n * @return {SVGElement} SVG element\n */\nDefinable.prototype.getSvgElement = function (displayable) {\n    return displayable.__svgEl;\n};\n\n/**\n * @file Manages SVG gradient elements.\n * @author Zhang Wenli\n */\n\n/**\n * Manages SVG gradient elements.\n *\n * @class\n * @extends Definable\n * @param   {number}     zrId    zrender instance id\n * @param   {SVGElement} svgRoot root of SVG document\n */\nfunction GradientManager(zrId, svgRoot) {\n    Definable.call(\n        this,\n        zrId,\n        svgRoot,\n        ['linearGradient', 'radialGradient'],\n        '__gradient_in_use__'\n    );\n}\n\n\ninherits(GradientManager, Definable);\n\n\n/**\n * Create new gradient DOM for fill or stroke if not exist,\n * but will not update gradient if exists.\n *\n * @param {SvgElement}  svgElement   SVG element to paint\n * @param {Displayable} displayable  zrender displayable element\n */\nGradientManager.prototype.addWithoutUpdate = function (\n    svgElement,\n    displayable\n) {\n    if (displayable && displayable.style) {\n        var that = this;\n        each$1(['fill', 'stroke'], function (fillOrStroke) {\n            if (displayable.style[fillOrStroke]\n                && (displayable.style[fillOrStroke].type === 'linear'\n                || displayable.style[fillOrStroke].type === 'radial')\n            ) {\n                var gradient = displayable.style[fillOrStroke];\n                var defs = that.getDefs(true);\n\n                // Create dom in <defs> if not exists\n                var dom;\n                if (gradient._dom) {\n                    // Gradient exists\n                    dom = gradient._dom;\n                    if (!defs.contains(gradient._dom)) {\n                        // _dom is no longer in defs, recreate\n                        that.addDom(dom);\n                    }\n                }\n                else {\n                    // New dom\n                    dom = that.add(gradient);\n                }\n\n                that.markUsed(displayable);\n\n                var id = dom.getAttribute('id');\n                svgElement.setAttribute(fillOrStroke, 'url(#' + id + ')');\n            }\n        });\n    }\n};\n\n\n/**\n * Add a new gradient tag in <defs>\n *\n * @param   {Gradient} gradient zr gradient instance\n * @return {SVGLinearGradientElement | SVGRadialGradientElement}\n *                            created DOM\n */\nGradientManager.prototype.add = function (gradient) {\n    var dom;\n    if (gradient.type === 'linear') {\n        dom = this.createElement('linearGradient');\n    }\n    else if (gradient.type === 'radial') {\n        dom = this.createElement('radialGradient');\n    }\n    else {\n        zrLog('Illegal gradient type.');\n        return null;\n    }\n\n    // Set dom id with gradient id, since each gradient instance\n    // will have no more than one dom element.\n    // id may exists before for those dirty elements, in which case\n    // id should remain the same, and other attributes should be\n    // updated.\n    gradient.id = gradient.id || this.nextId++;\n    dom.setAttribute('id', 'zr' + this._zrId\n        + '-gradient-' + gradient.id);\n\n    this.updateDom(gradient, dom);\n    this.addDom(dom);\n\n    return dom;\n};\n\n\n/**\n * Update gradient.\n *\n * @param {Gradient} gradient zr gradient instance\n */\nGradientManager.prototype.update = function (gradient) {\n    var that = this;\n    Definable.prototype.update.call(this, gradient, function () {\n        var type = gradient.type;\n        var tagName = gradient._dom.tagName;\n        if (type === 'linear' && tagName === 'linearGradient'\n            || type === 'radial' && tagName === 'radialGradient'\n        ) {\n            // Gradient type is not changed, update gradient\n            that.updateDom(gradient, gradient._dom);\n        }\n        else {\n            // Remove and re-create if type is changed\n            that.removeDom(gradient);\n            that.add(gradient);\n        }\n    });\n};\n\n\n/**\n * Update gradient dom\n *\n * @param {Gradient} gradient zr gradient instance\n * @param {SVGLinearGradientElement | SVGRadialGradientElement} dom\n *                            DOM to update\n */\nGradientManager.prototype.updateDom = function (gradient, dom) {\n    if (gradient.type === 'linear') {\n        dom.setAttribute('x1', gradient.x);\n        dom.setAttribute('y1', gradient.y);\n        dom.setAttribute('x2', gradient.x2);\n        dom.setAttribute('y2', gradient.y2);\n    }\n    else if (gradient.type === 'radial') {\n        dom.setAttribute('cx', gradient.x);\n        dom.setAttribute('cy', gradient.y);\n        dom.setAttribute('r', gradient.r);\n    }\n    else {\n        zrLog('Illegal gradient type.');\n        return;\n    }\n\n    if (gradient.global) {\n        // x1, x2, y1, y2 in range of 0 to canvas width or height\n        dom.setAttribute('gradientUnits', 'userSpaceOnUse');\n    }\n    else {\n        // x1, x2, y1, y2 in range of 0 to 1\n        dom.setAttribute('gradientUnits', 'objectBoundingBox');\n    }\n\n    // Remove color stops if exists\n    dom.innerHTML = '';\n\n    // Add color stops\n    var colors = gradient.colorStops;\n    for (var i = 0, len = colors.length; i < len; ++i) {\n        var stop = this.createElement('stop');\n        stop.setAttribute('offset', colors[i].offset * 100 + '%');\n        stop.setAttribute('stop-color', colors[i].color);\n        dom.appendChild(stop);\n    }\n\n    // Store dom element in gradient, to avoid creating multiple\n    // dom instances for the same gradient element\n    gradient._dom = dom;\n};\n\n/**\n * Mark a single gradient to be used\n *\n * @param {Displayable} displayable displayable element\n */\nGradientManager.prototype.markUsed = function (displayable) {\n    if (displayable.style) {\n        var gradient = displayable.style.fill;\n        if (gradient && gradient._dom) {\n            Definable.prototype.markUsed.call(this, gradient._dom);\n        }\n\n        gradient = displayable.style.stroke;\n        if (gradient && gradient._dom) {\n            Definable.prototype.markUsed.call(this, gradient._dom);\n        }\n    }\n};\n\n/**\n * @file Manages SVG clipPath elements.\n * @author Zhang Wenli\n */\n\n/**\n * Manages SVG clipPath elements.\n *\n * @class\n * @extends Definable\n * @param   {number}     zrId    zrender instance id\n * @param   {SVGElement} svgRoot root of SVG document\n */\nfunction ClippathManager(zrId, svgRoot) {\n    Definable.call(this, zrId, svgRoot, 'clipPath', '__clippath_in_use__');\n}\n\n\ninherits(ClippathManager, Definable);\n\n\n/**\n * Update clipPath.\n *\n * @param {Displayable} displayable displayable element\n */\nClippathManager.prototype.update = function (displayable) {\n    var svgEl = this.getSvgElement(displayable);\n    if (svgEl) {\n        this.updateDom(svgEl, displayable.__clipPaths, false);\n    }\n\n    var textEl = this.getTextSvgElement(displayable);\n    if (textEl) {\n        // Make another clipPath for text, since it's transform\n        // matrix is not the same with svgElement\n        this.updateDom(textEl, displayable.__clipPaths, true);\n    }\n\n    this.markUsed(displayable);\n};\n\n\n/**\n * Create an SVGElement of displayable and create a <clipPath> of its\n * clipPath\n *\n * @param {Displayable} parentEl  parent element\n * @param {ClipPath[]}  clipPaths clipPaths of parent element\n * @param {boolean}     isText    if parent element is Text\n */\nClippathManager.prototype.updateDom = function (\n    parentEl,\n    clipPaths,\n    isText\n) {\n    if (clipPaths && clipPaths.length > 0) {\n        // Has clipPath, create <clipPath> with the first clipPath\n        var defs = this.getDefs(true);\n        var clipPath = clipPaths[0];\n        var clipPathEl;\n        var id;\n\n        var dom = isText ? '_textDom' : '_dom';\n\n        if (clipPath[dom]) {\n            // Use a dom that is already in <defs>\n            id = clipPath[dom].getAttribute('id');\n            clipPathEl = clipPath[dom];\n\n            // Use a dom that is already in <defs>\n            if (!defs.contains(clipPathEl)) {\n                // This happens when set old clipPath that has\n                // been previously removed\n                defs.appendChild(clipPathEl);\n            }\n        }\n        else {\n            // New <clipPath>\n            id = 'zr' + this._zrId + '-clip-' + this.nextId;\n            ++this.nextId;\n            clipPathEl = this.createElement('clipPath');\n            clipPathEl.setAttribute('id', id);\n            defs.appendChild(clipPathEl);\n\n            clipPath[dom] = clipPathEl;\n        }\n\n        // Build path and add to <clipPath>\n        var svgProxy = this.getSvgProxy(clipPath);\n        if (clipPath.transform\n            && clipPath.parent.invTransform\n            && !isText\n        ) {\n            /**\n             * If a clipPath has a parent with transform, the transform\n             * of parent should not be considered when setting transform\n             * of clipPath. So we need to transform back from parent's\n             * transform, which is done by multiplying parent's inverse\n             * transform.\n             */\n            // Store old transform\n            var transform = Array.prototype.slice.call(\n                clipPath.transform\n            );\n\n            // Transform back from parent, and brush path\n            mul$1(\n                clipPath.transform,\n                clipPath.parent.invTransform,\n                clipPath.transform\n            );\n            svgProxy.brush(clipPath);\n\n            // Set back transform of clipPath\n            clipPath.transform = transform;\n        }\n        else {\n            svgProxy.brush(clipPath);\n        }\n\n        var pathEl = this.getSvgElement(clipPath);\n\n        clipPathEl.innerHTML = '';\n        /**\n         * Use `cloneNode()` here to appendChild to multiple parents,\n         * which may happend when Text and other shapes are using the same\n         * clipPath. Since Text will create an extra clipPath DOM due to\n         * different transform rules.\n         */\n        clipPathEl.appendChild(pathEl.cloneNode());\n\n        parentEl.setAttribute('clip-path', 'url(#' + id + ')');\n\n        if (clipPaths.length > 1) {\n            // Make the other clipPaths recursively\n            this.updateDom(clipPathEl, clipPaths.slice(1), isText);\n        }\n    }\n    else {\n        // No clipPath\n        if (parentEl) {\n            parentEl.setAttribute('clip-path', 'none');\n        }\n    }\n};\n\n/**\n * Mark a single clipPath to be used\n *\n * @param {Displayable} displayable displayable element\n */\nClippathManager.prototype.markUsed = function (displayable) {\n    var that = this;\n    if (displayable.__clipPaths && displayable.__clipPaths.length > 0) {\n        each$1(displayable.__clipPaths, function (clipPath) {\n            if (clipPath._dom) {\n                Definable.prototype.markUsed.call(that, clipPath._dom);\n            }\n            if (clipPath._textDom) {\n                Definable.prototype.markUsed.call(that, clipPath._textDom);\n            }\n        });\n    }\n};\n\n/**\n * @file Manages SVG shadow elements.\n * @author Zhang Wenli\n */\n\n/**\n * Manages SVG shadow elements.\n *\n * @class\n * @extends Definable\n * @param   {number}     zrId    zrender instance id\n * @param   {SVGElement} svgRoot root of SVG document\n */\nfunction ShadowManager(zrId, svgRoot) {\n    Definable.call(\n        this,\n        zrId,\n        svgRoot,\n        ['filter'],\n        '__filter_in_use__',\n        '_shadowDom'\n    );\n}\n\n\ninherits(ShadowManager, Definable);\n\n\n/**\n * Create new shadow DOM for fill or stroke if not exist,\n * but will not update shadow if exists.\n *\n * @param {SvgElement}  svgElement   SVG element to paint\n * @param {Displayable} displayable  zrender displayable element\n */\nShadowManager.prototype.addWithoutUpdate = function (\n    svgElement,\n    displayable\n) {\n    if (displayable && hasShadow(displayable.style)) {\n        var style = displayable.style;\n\n        // Create dom in <defs> if not exists\n        var dom;\n        if (style._shadowDom) {\n            // Gradient exists\n            dom = style._shadowDom;\n\n            var defs = this.getDefs(true);\n            if (!defs.contains(style._shadowDom)) {\n                // _shadowDom is no longer in defs, recreate\n                this.addDom(dom);\n            }\n        }\n        else {\n            // New dom\n            dom = this.add(displayable);\n        }\n\n        this.markUsed(displayable);\n\n        var id = dom.getAttribute('id');\n        svgElement.style.filter = 'url(#' + id + ')';\n    }\n};\n\n\n/**\n * Add a new shadow tag in <defs>\n *\n * @param {Displayable} displayable  zrender displayable element\n * @return {SVGFilterElement} created DOM\n */\nShadowManager.prototype.add = function (displayable) {\n    var dom = this.createElement('filter');\n    var style = displayable.style;\n\n    // Set dom id with shadow id, since each shadow instance\n    // will have no more than one dom element.\n    // id may exists before for those dirty elements, in which case\n    // id should remain the same, and other attributes should be\n    // updated.\n    style._shadowDomId = style._shadowDomId || this.nextId++;\n    dom.setAttribute('id', 'zr' + this._zrId\n        + '-shadow-' + style._shadowDomId);\n\n    this.updateDom(displayable, dom);\n    this.addDom(dom);\n\n    return dom;\n};\n\n\n/**\n * Update shadow.\n *\n * @param {Displayable} displayable  zrender displayable element\n */\nShadowManager.prototype.update = function (svgElement, displayable) {\n    var style = displayable.style;\n    if (hasShadow(style)) {\n        var that = this;\n        Definable.prototype.update.call(this, displayable, function (style) {\n            that.updateDom(displayable, style._shadowDom);\n        });\n    }\n    else {\n        // Remove shadow\n        this.remove(svgElement, style);\n    }\n};\n\n\n/**\n * Remove DOM and clear parent filter\n */\nShadowManager.prototype.remove = function (svgElement, style) {\n    if (style._shadowDomId != null) {\n        this.removeDom(style);\n        svgElement.style.filter = '';\n    }\n};\n\n\n/**\n * Update shadow dom\n *\n * @param {Displayable} displayable  zrender displayable element\n * @param {SVGFilterElement} dom DOM to update\n */\nShadowManager.prototype.updateDom = function (displayable, dom) {\n    var domChild = dom.getElementsByTagName('feDropShadow');\n    if (domChild.length === 0) {\n        domChild = this.createElement('feDropShadow');\n    }\n    else {\n        domChild = domChild[0];\n    }\n\n    var style = displayable.style;\n    var scaleX = displayable.scale ? (displayable.scale[0] || 1) : 1;\n    var scaleY = displayable.scale ? (displayable.scale[1] || 1) : 1;\n\n    // TODO: textBoxShadowBlur is not supported yet\n    var offsetX, offsetY, blur, color;\n    if (style.shadowBlur || style.shadowOffsetX || style.shadowOffsetY) {\n        offsetX = style.shadowOffsetX || 0;\n        offsetY = style.shadowOffsetY || 0;\n        blur = style.shadowBlur;\n        color = style.shadowColor;\n    }\n    else if (style.textShadowBlur) {\n        offsetX = style.textShadowOffsetX || 0;\n        offsetY = style.textShadowOffsetY || 0;\n        blur = style.textShadowBlur;\n        color = style.textShadowColor;\n    }\n    else {\n        // Remove shadow\n        this.removeDom(dom, style);\n        return;\n    }\n\n    domChild.setAttribute('dx', offsetX / scaleX);\n    domChild.setAttribute('dy', offsetY / scaleY);\n    domChild.setAttribute('flood-color', color);\n\n    // Divide by two here so that it looks the same as in canvas\n    // See: https://html.spec.whatwg.org/multipage/canvas.html#dom-context-2d-shadowblur\n    var stdDx = blur / 2 / scaleX;\n    var stdDy = blur / 2 / scaleY;\n    var stdDeviation = stdDx + ' ' + stdDy;\n    domChild.setAttribute('stdDeviation', stdDeviation);\n\n    // Fix filter clipping problem\n    dom.setAttribute('x', '-100%');\n    dom.setAttribute('y', '-100%');\n    dom.setAttribute('width', Math.ceil(blur / 2 * 200) + '%');\n    dom.setAttribute('height', Math.ceil(blur / 2 * 200) + '%');\n\n    dom.appendChild(domChild);\n\n    // Store dom element in shadow, to avoid creating multiple\n    // dom instances for the same shadow element\n    style._shadowDom = dom;\n};\n\n/**\n * Mark a single shadow to be used\n *\n * @param {Displayable} displayable displayable element\n */\nShadowManager.prototype.markUsed = function (displayable) {\n    var style = displayable.style;\n    if (style && style._shadowDom) {\n        Definable.prototype.markUsed.call(this, style._shadowDom);\n    }\n};\n\nfunction hasShadow(style) {\n    // TODO: textBoxShadowBlur is not supported yet\n    return style\n        && (style.shadowBlur || style.shadowOffsetX || style.shadowOffsetY\n            || style.textShadowBlur || style.textShadowOffsetX\n            || style.textShadowOffsetY);\n}\n\n/**\n * SVG Painter\n * @module zrender/svg/Painter\n */\n\nfunction parseInt10$2(val) {\n    return parseInt(val, 10);\n}\n\nfunction getSvgProxy(el) {\n    if (el instanceof Path) {\n        return svgPath;\n    }\n    else if (el instanceof ZImage) {\n        return svgImage;\n    }\n    else if (el instanceof Text) {\n        return svgText;\n    }\n    else {\n        return svgPath;\n    }\n}\n\nfunction checkParentAvailable(parent, child) {\n    return child && parent && child.parentNode !== parent;\n}\n\nfunction insertAfter(parent, child, prevSibling) {\n    if (checkParentAvailable(parent, child) && prevSibling) {\n        var nextSibling = prevSibling.nextSibling;\n        nextSibling ? parent.insertBefore(child, nextSibling)\n            : parent.appendChild(child);\n    }\n}\n\nfunction prepend(parent, child) {\n    if (checkParentAvailable(parent, child)) {\n        var firstChild = parent.firstChild;\n        firstChild ? parent.insertBefore(child, firstChild)\n            : parent.appendChild(child);\n    }\n}\n\nfunction remove$1(parent, child) {\n    if (child && parent && child.parentNode === parent) {\n        parent.removeChild(child);\n    }\n}\n\nfunction getTextSvgElement(displayable) {\n    return displayable.__textSvgEl;\n}\n\nfunction getSvgElement(displayable) {\n    return displayable.__svgEl;\n}\n\n/**\n * @alias module:zrender/svg/Painter\n * @constructor\n * @param {HTMLElement} root \n * @param {module:zrender/Storage} storage\n * @param {Object} opts\n */\nvar SVGPainter = function (root, storage, opts, zrId) {\n\n    this.root = root;\n    this.storage = storage;\n    this._opts = opts = extend({}, opts || {});\n\n    var svgRoot = createElement('svg');\n    svgRoot.setAttribute('xmlns', 'http://www.w3.org/2000/svg');\n    svgRoot.setAttribute('version', '1.1');\n    svgRoot.setAttribute('baseProfile', 'full');\n    svgRoot.style.cssText = 'user-select:none;position:absolute;left:0;top:0;';\n\n    this.gradientManager = new GradientManager(zrId, svgRoot);\n    this.clipPathManager = new ClippathManager(zrId, svgRoot);\n    this.shadowManager = new ShadowManager(zrId, svgRoot);\n\n    var viewport = document.createElement('div');\n    viewport.style.cssText = 'overflow:hidden;position:relative';\n\n    this._svgRoot = svgRoot;\n    this._viewport = viewport;\n\n    root.appendChild(viewport);\n    viewport.appendChild(svgRoot);\n\n    this.resize(opts.width, opts.height);\n\n    this._visibleList = [];\n};\n\nSVGPainter.prototype = {\n\n    constructor: SVGPainter,\n\n    getType: function () {\n        return 'svg';\n    },\n\n    getViewportRoot: function () {\n        return this._viewport;\n    },\n\n    getViewportRootOffset: function () {\n        var viewportRoot = this.getViewportRoot();\n        if (viewportRoot) {\n            return {\n                offsetLeft: viewportRoot.offsetLeft || 0,\n                offsetTop: viewportRoot.offsetTop || 0\n            };\n        }\n    },\n\n    refresh: function () {\n\n        var list = this.storage.getDisplayList(true);\n\n        this._paintList(list);\n    },\n\n    setBackgroundColor: function (backgroundColor) {\n        // TODO gradient\n        this._viewport.style.background = backgroundColor;\n    },\n\n    _paintList: function (list) {\n        this.gradientManager.markAllUnused();\n        this.clipPathManager.markAllUnused();\n        this.shadowManager.markAllUnused();\n\n        var svgRoot = this._svgRoot;\n        var visibleList = this._visibleList;\n        var listLen = list.length;\n\n        var newVisibleList = [];\n        var i;\n        for (i = 0; i < listLen; i++) {\n            var displayable = list[i];\n            var svgProxy = getSvgProxy(displayable);\n            var svgElement = getSvgElement(displayable)\n                || getTextSvgElement(displayable);\n            if (!displayable.invisible) {\n                if (displayable.__dirty) {\n                    svgProxy && svgProxy.brush(displayable);\n\n                    // Update clipPath\n                    this.clipPathManager.update(displayable);\n\n                    // Update gradient and shadow\n                    if (displayable.style) {\n                        this.gradientManager\n                            .update(displayable.style.fill);\n                        this.gradientManager\n                            .update(displayable.style.stroke);\n\n                        this.shadowManager\n                            .update(svgElement, displayable);\n                    }\n\n                    displayable.__dirty = false;\n                }\n                newVisibleList.push(displayable);\n            }\n        }\n\n        var diff = arrayDiff$1(visibleList, newVisibleList);\n        var prevSvgElement;\n\n        // First do remove, in case element moved to the head and do remove\n        // after add\n        for (i = 0; i < diff.length; i++) {\n            var item = diff[i];\n            if (item.removed) {\n                for (var k = 0; k < item.count; k++) {\n                    var displayable = visibleList[item.indices[k]];\n                    var svgElement = getSvgElement(displayable);\n                    var textSvgElement = getTextSvgElement(displayable);\n                    remove$1(svgRoot, svgElement);\n                    remove$1(svgRoot, textSvgElement);\n                }\n            }\n        }\n        for (i = 0; i < diff.length; i++) {\n            var item = diff[i];\n            if (item.added) {\n                for (var k = 0; k < item.count; k++) {\n                    var displayable = newVisibleList[item.indices[k]];\n                    var svgElement = getSvgElement(displayable);\n                    var textSvgElement = getTextSvgElement(displayable);\n                    prevSvgElement\n                        ? insertAfter(svgRoot, svgElement, prevSvgElement)\n                        : prepend(svgRoot, svgElement);\n                    if (svgElement) {\n                        insertAfter(svgRoot, textSvgElement, svgElement);\n                    }\n                    else if (prevSvgElement) {\n                        insertAfter(\n                            svgRoot, textSvgElement, prevSvgElement\n                        );\n                    }\n                    else {\n                        prepend(svgRoot, textSvgElement);\n                    }\n                    // Insert text\n                    insertAfter(svgRoot, textSvgElement, svgElement);\n                    prevSvgElement = textSvgElement || svgElement\n                        || prevSvgElement;\n\n                    this.gradientManager\n                        .addWithoutUpdate(svgElement, displayable);\n                    this.shadowManager\n                        .addWithoutUpdate(prevSvgElement, displayable);\n                    this.clipPathManager.markUsed(displayable);\n                }\n            }\n            else if (!item.removed) {\n                for (var k = 0; k < item.count; k++) {\n                    var displayable = newVisibleList[item.indices[k]];\n                    prevSvgElement\n                        = svgElement\n                        = getTextSvgElement(displayable)\n                        || getSvgElement(displayable)\n                        || prevSvgElement;\n\n                    this.gradientManager.markUsed(displayable);\n                    this.gradientManager\n                        .addWithoutUpdate(svgElement, displayable);\n\n                    this.shadowManager.markUsed(displayable);\n                    this.shadowManager\n                        .addWithoutUpdate(svgElement, displayable);\n\n                    this.clipPathManager.markUsed(displayable);\n                }\n            }\n        }\n\n        this.gradientManager.removeUnused();\n        this.clipPathManager.removeUnused();\n        this.shadowManager.removeUnused();\n\n        this._visibleList = newVisibleList;\n    },\n\n    _getDefs: function (isForceCreating) {\n        var svgRoot = this._svgRoot;\n        var defs = this._svgRoot.getElementsByTagName('defs');\n        if (defs.length === 0) {\n            // Not exist\n            if (isForceCreating) {\n                var defs = svgRoot.insertBefore(\n                    createElement('defs'), // Create new tag\n                    svgRoot.firstChild // Insert in the front of svg\n                );\n                if (!defs.contains) {\n                    // IE doesn't support contains method\n                    defs.contains = function (el) {\n                        var children = defs.children;\n                        if (!children) {\n                            return false;\n                        }\n                        for (var i = children.length - 1; i >= 0; --i) {\n                            if (children[i] === el) {\n                                return true;\n                            }\n                        }\n                        return false;\n                    };\n                }\n                return defs;\n            }\n            else {\n                return null;\n            }\n        }\n        else {\n            return defs[0];\n        }\n    },\n\n    resize: function (width, height) {\n        var viewport = this._viewport;\n        // FIXME Why ?\n        viewport.style.display = 'none';\n\n        // Save input w/h\n        var opts = this._opts;\n        width != null && (opts.width = width);\n        height != null && (opts.height = height);\n\n        width = this._getSize(0);\n        height = this._getSize(1);\n\n        viewport.style.display = '';\n\n        if (this._width !== width || this._height !== height) {\n            this._width = width;\n            this._height = height;\n\n            var viewportStyle = viewport.style;\n            viewportStyle.width = width + 'px';\n            viewportStyle.height = height + 'px';\n\n            var svgRoot = this._svgRoot;\n            // Set width by 'svgRoot.width = width' is invalid\n            svgRoot.setAttribute('width', width);\n            svgRoot.setAttribute('height', height);\n        }\n    },\n\n    /**\n     * \n     */\n    getWidth: function () {\n        return this._width;\n    },\n\n    /**\n     * \n     */\n    getHeight: function () {\n        return this._height;\n    },\n\n    _getSize: function (whIdx) {\n        var opts = this._opts;\n        var wh = ['width', 'height'][whIdx];\n        var cwh = ['clientWidth', 'clientHeight'][whIdx];\n        var plt = ['paddingLeft', 'paddingTop'][whIdx];\n        var prb = ['paddingRight', 'paddingBottom'][whIdx];\n\n        if (opts[wh] != null && opts[wh] !== 'auto') {\n            return parseFloat(opts[wh]);\n        }\n\n        var root = this.root;\n        // IE8 does not support getComputedStyle, but it use VML.\n        var stl = document.defaultView.getComputedStyle(root);\n\n        return (\n            (root[cwh] || parseInt10$2(stl[wh]) || parseInt10$2(root.style[wh]))\n            - (parseInt10$2(stl[plt]) || 0)\n            - (parseInt10$2(stl[prb]) || 0)\n        ) | 0;\n    },\n\n    dispose: function () {\n        this.root.innerHTML = '';\n\n        this._svgRoot\n            = this._viewport\n            = this.storage\n            = null;\n    },\n\n    clear: function () {\n        if (this._viewport) {\n            this.root.removeChild(this._viewport);\n        }\n    },\n\n    pathToDataUrl: function () {\n        this.refresh();\n        var html = this._svgRoot.outerHTML;\n        return 'data:image/svg+xml;charset=UTF-8,' + html;\n    }\n};\n\n// Not supported methods\nfunction createMethodNotSupport$1(method) {\n    return function () {\n        zrLog('In SVG mode painter not support method \"' + method + '\"');\n    };\n}\n\n// Unsuppoted methods\neach$1([\n    'getLayer', 'insertLayer', 'eachLayer', 'eachBuiltinLayer',\n    'eachOtherLayer', 'getLayers', 'modLayer', 'delLayer', 'clearLayer',\n    'toDataURL', 'pathToImage'\n], function (name) {\n    SVGPainter.prototype[name] = createMethodNotSupport$1(name);\n});\n\nregisterPainter('svg', SVGPainter);\n\n// Import all charts and components\n\nexports.version = version;\nexports.dependencies = dependencies;\nexports.PRIORITY = PRIORITY;\nexports.init = init;\nexports.connect = connect;\nexports.disConnect = disConnect;\nexports.disconnect = disconnect;\nexports.dispose = dispose;\nexports.getInstanceByDom = getInstanceByDom;\nexports.getInstanceById = getInstanceById;\nexports.registerTheme = registerTheme;\nexports.registerPreprocessor = registerPreprocessor;\nexports.registerProcessor = registerProcessor;\nexports.registerPostUpdate = registerPostUpdate;\nexports.registerAction = registerAction;\nexports.registerCoordinateSystem = registerCoordinateSystem;\nexports.getCoordinateSystemDimensions = getCoordinateSystemDimensions;\nexports.registerLayout = registerLayout;\nexports.registerVisual = registerVisual;\nexports.registerLoading = registerLoading;\nexports.extendComponentModel = extendComponentModel;\nexports.extendComponentView = extendComponentView;\nexports.extendSeriesModel = extendSeriesModel;\nexports.extendChartView = extendChartView;\nexports.setCanvasCreator = setCanvasCreator;\nexports.registerMap = registerMap;\nexports.getMap = getMap;\nexports.dataTool = dataTool;\nexports.zrender = zrender;\nexports.graphic = graphic;\nexports.number = number;\nexports.format = format;\nexports.throttle = throttle;\nexports.helper = helper;\nexports.matrix = matrix;\nexports.vector = vector;\nexports.color = color;\nexports.parseGeoJSON = parseGeoJson$1;\nexports.parseGeoJson = parseGeoJson;\nexports.util = ecUtil;\nexports.List = List;\nexports.Model = Model;\nexports.Axis = Axis;\nexports.env = env$1;\n\n})));\n//# sourceMappingURL=echarts.js.map\n"]}